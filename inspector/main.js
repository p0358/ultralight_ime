(function(){const c=["beforecopy","copy","click","dragover","focus"],e=["focus","blur","resize","keydown","keyup","mousemove","pagehide","contextmenu"];function t(w){w.target.classList&&w.target.classList.contains("bypass-event-blocking")||w.stopPropagation()}function i(){for(let w of c)window.addEventListener(w,t,!0);for(let w of e)document.addEventListener(w,t,!0)}function n(){for(let w of c)window.removeEventListener(w,t,!0);for(let w of e)document.removeEventListener(w,t,!0)}function s(w){if(!w)return"";let S=w.lastIndexOf("/");return S===-1?w:w.slice(S+1)}function a(w){f({message:w.message,url:s(w.sourceURL),lineNumber:w.line,columnNumber:w.column,stack:w.stack,details:w.details})}function d(w){f({message:w.message,url:s(w.filename),lineNumber:w.lineno,columnNumber:w.colno,stack:typeof w.error=="object"&&w.error!==null?w.error.stack:null})}function p(w){f({message:w.reason.message,url:s(w.reason.sourceURL),lineNumber:w.reason.line,columnNumber:w.reason.column,stack:w.reason.stack})}function f(w){try{if(!WI.settings.enableUncaughtExceptionReporter.value)return}catch{}window.__uncaughtExceptions||(window.__uncaughtExceptions=[]);const S=window.__frontendCompletedLoad,E=!window.__uncaughtExceptions.length;(!S||E)&&window.__uncaughtExceptions.push(w),E&&i(),E&&!S&&window.InspectorFrontendHost&&InspectorFrontendHost.loaded(),b()}function _(){n(),window.__sheetElement.remove(),window.__sheetElement=null,window.__uncaughtExceptions=[];try{WI.updateWindowTitle()}catch{}}function b(){document.body||document.write("<body></body></html>"),window.InspectorFrontendHost&&InspectorFrontendHost.inspectedURLChanged("Internal Error"),window.__sheetElement&&(window.__sheetElement.remove(),window.__sheetElement=null);const w=window.__frontendCompletedLoad;let S=window.__uncaughtExceptions[0];function E(te){return te.replace(/([\/;:\)\]\}&?])/g,"$1\u200B")}function k(te){te.target.tagName==="A"&&te.target.id==="dismiss-error-sheet"&&_()}function R(te){const ve="    ";let Pe=[`${te.message} (at ${te.url}:${te.lineNumber}:${te.columnNumber})`];if(te.stack){let Be=te.stack.split(/\n/g);for(let qe of Be){let Ue=qe.indexOf("@"),Ge=Math.max(qe.lastIndexOf("/"),Ue),it=qe.substring(0,Ue)||"?",lt=qe.substring(Ge+1,qe.length);Pe.push(`${ve}${it} @ ${lt}`)}}if(te.details){Pe.push(""),Pe.push("Additional Details:");for(let Be in te.details){let qe=te.details[Be];Pe.push(`${ve}${Be} --> ${qe}`)}}return Pe.join(`
`)}let M=null;try{M=WI.networkManager.mainFrame.url}catch{}let L=[`Inspected URL:        ${M||"(unknown)"}`,`Loading completed:    ${!!w}`,`Frontend User Agent:  ${window.navigator.userAgent}`];function V(te){let ve=JSON.stringify(te);return ve.length>500?ve.substr(0,500)+ellipsis:ve}if(window.InspectorBackend&&InspectorBackend.currentDispatchState){let te=InspectorBackend.currentDispatchState;te.event&&(L.push("Dispatch Source:      Protocol Event"),L.push(""),L.push("Protocol Event:"),L.push(V(te.event))),te.response&&(L.push("Dispatch Source:      Protocol Command Response"),L.push(""),L.push("Protocol Command Response:"),L.push(V(te.response))),te.request&&(L.push(""),L.push("Protocol Command Request:"),L.push(V(te.request)))}let H=window.__uncaughtExceptions.map(te=>R(te)),O=H.map(te=>` - ${te}`).join(`
`);L.push(""),L.push("Uncaught Exceptions:"),L.push(O);let z=encodeURIComponent(`-------
${L.join(`
`)}
-------

* STEPS TO REPRODUCE
1. What were you doing? Include setup or other preparations to reproduce the exception.
2. Include explicit, accurate, and minimal steps taken. Do not include extraneous or irrelevant steps.

* NOTES
Document any additional information that might be useful in resolving the problem, such as screen shots or other included attachments.
`),K=encodeURIComponent(`Uncaught Exception: ${S.message}`),Y=`https://bugs.webkit.org/enter_bug.cgi?alias=&assigned_to=webkit-unassigned%40lists.webkit.org&attach_text=&blocked=&bug_file_loc=${encodeURIComponent(M||"http://")}&bug_severity=Normal&bug_status=NEW&comment=${z}&component=Web%20Inspector&contenttypeentry=&contenttypemethod=autodetect&contenttypeselection=text%2Fplain&data=&dependson=&description=&flag_type-1=X&flag_type-3=X&form_name=enter_bug&keywords=&op_sys=All&priority=P2&product=WebKit&rep_platform=All&short_desc=${K}&version=WebKit%20Nightly%20Build`,se=H.map(te=>`<li>${E(te)}</li>`).join(`
`),ce=w?`<dt>A frivolous exception will not stop me!</dt>
        <dd><a class="bypass-event-blocking" id="dismiss-error-sheet">Click to close this view</a> and return
        to the Web Inspector without reloading. However, some things might not work without reloading if the error corrupted the Inspector's internal state.</dd>`:"",le=window.__sheetElement=document.createElement("div");le.classList.add("sheet-container"),le.innerHTML=`<div class="uncaught-exception-sheet">
    <h1>
    <img src="data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='none' stroke='currentColor' d='M 11 2.5 L 14.5 6 L 14.5 11 L 11 14.5 L 6 14.5 L 2.5 11 L 2.5 6 L 6 2.5 L 11 2.5 Z '/%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='square' d='M 8.5 5.5 L 8.5 9.5'/%3e %3crect fill='currentColor' x='8' y='11' width='1' height='1'/%3e %3c/svg%3e">
    Web Inspector encountered an internal error.
    </h1>
    <dl>
        <dd>Usually, this is caused by a syntax error while modifying the Web Inspector
        UI, or running an updated frontend with out-of-date WebKit build.</dt>
        <dt>I didn't do anything...?</dt>
        <dd>If you don't think you caused this error to happen,
        <a href="${Y}" target="_blank">click to file a pre-populated
        bug with this information</a>. It is possible that someone else broke it by accident.</dd>
        <dt>Oops, can I try again?</dt>
        <dd><a href="javascript:InspectorFrontendHost.reopen()">Click to reload the Inspector</a>
        again after making local changes.</dd>
        ${ce}
    </dl>
    <h2>
    <img src="data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect fill='none' stroke='currentColor' x='0.5' y='0.5' width='15' height='15' rx='2'/%3e %3cpath fill='none' stroke='currentColor' d='M 4 4 L 8 8 L 4 12'/%3e %3cpath fill='none' stroke='currentColor' d='M 8 4.5 L 12 4.5'/%3e %3cpath fill='none' stroke='currentColor' d='M 10 8 L 12 8'/%3e %3cpath fill='none' stroke='currentColor' d='M 8 11.5 L 12 11.5'/%3e %3c/svg%3e">
    These uncaught exceptions caused the problem:
    </h2>
    <p><ul>${se}</ul></p>
    </div>`,le.addEventListener("click",k,!0),document.body.appendChild(le)}window.addEventListener("error",d),window.addEventListener("unhandledrejection",p),window.handleInternalException=a})();(function(c,e){typeof exports=="object"&&typeof module<"u"?module.exports=e():typeof define=="function"&&define.amd?define(e):c.CodeMirror=e()})(this,function(){"use strict";var c=navigator.userAgent,e=navigator.platform,t=/gecko\/\d/i.test(c),i=/MSIE \d/.test(c),n=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(c),s=i||n,a=s&&(i?document.documentMode||6:n[1]),d=/WebKit\//.test(c),p=d&&/Qt\/\d+\.\d+/.test(c),f=/Chrome\//.test(c),_=/Opera\//.test(c),b=/Apple Computer/.test(navigator.vendor),w=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(c),S=/PhantomJS/.test(c),E=/AppleWebKit/.test(c)&&/Mobile\/\w+/.test(c),k=E||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(c),R=E||/Mac/.test(e),M=/\bCrOS\b/.test(c),L=/win/i.test(e),V=_&&c.match(/Version\/(\d*\.\d*)/);V&&(V=Number(V[1])),V&&V>=15&&(_=!1,d=!0);var H=R&&(p||_&&(V==null||V<12.11)),O=t||s&&a>=9;function z(l){return new RegExp("(^|\\s)"+l+"(?:$|\\s)\\s*")}var K=function(l,m){var C=l.className,v=z(m).exec(C);if(v){var x=C.slice(v.index+v[0].length);l.className=C.slice(0,v.index)+(x?v[1]+x:"")}};function q(l){for(var m=l.childNodes.length;m>0;--m)l.removeChild(l.firstChild);return l}function Y(l,m){return q(l).appendChild(m)}function se(l,m,C,v){var x=document.createElement(l);if(C&&(x.className=C),v&&(x.style.cssText=v),typeof m=="string")x.appendChild(document.createTextNode(m));else if(m)for(var P=0;P<m.length;++P)x.appendChild(m[P]);return x}var ce;document.createRange?ce=function(l,m,C,v){var x=document.createRange();return x.setEnd(v||l,C),x.setStart(l,m),x}:ce=function(l,m,C){var v=document.body.createTextRange();try{v.moveToElementText(l.parentNode)}catch{return v}return v.collapse(!0),v.moveEnd("character",C),v.moveStart("character",m),v};function le(l,m){if(m.nodeType==3&&(m=m.parentNode),l.contains)return l.contains(m);do if(m.nodeType==11&&(m=m.host),m==l)return!0;while(m=m.parentNode)}function te(){var l;try{l=document.activeElement}catch{l=document.body||null}for(;l&&l.root&&l.root.activeElement;)l=l.root.activeElement;return l}function ve(l,m){var C=l.className;z(m).test(C)||(l.className+=(C?" ":"")+m)}function Pe(l,m){for(var C=l.split(" "),v=0;v<C.length;v++)C[v]&&!z(C[v]).test(m)&&(m+=" "+C[v]);return m}var Be=function(l){l.select()};E?Be=function(l){l.selectionStart=0,l.selectionEnd=l.value.length}:s&&(Be=function(l){try{l.select()}catch{}});function qe(l){var m=Array.prototype.slice.call(arguments,1);return function(){return l.apply(null,m)}}function Ue(l,m,C){m||(m={});for(var v in l)l.hasOwnProperty(v)&&(C!==!1||!m.hasOwnProperty(v))&&(m[v]=l[v]);return m}function Ge(l,m,C,v,x){m==null&&(m=l.search(/[^\s\u00a0]/),m==-1&&(m=l.length));for(var P=v||0,U=x||0;;){var W=l.indexOf("	",P);if(W<0||W>=m)return U+(m-P);U+=W-P,U+=C-U%C,P=W+1}}function it(){this.id=null}it.prototype.set=function(l,m){clearTimeout(this.id),this.id=setTimeout(m,l)};function lt(l,m){for(var C=0;C<l.length;++C)if(l[C]==m)return C;return-1}var bt=30,Yt={toString:function(){return"CodeMirror.Pass"}},ni={scroll:!1},ri={origin:"*mouse"},He={origin:"+move"};function ei(l,m,C){for(var v=0,x=0;;){var P=l.indexOf("	",v);P==-1&&(P=l.length);var U=P-v;if(P==l.length||x+U>=m)return v+Math.min(U,m-x);if(x+=P-v,x+=C-x%C,v=P+1,x>=m)return v}}var ui=[""];function vi(l){for(;ui.length<=l;)ui.push(Xe(ui)+" ");return ui[l]}function Xe(l){return l[l.length-1]}function bi(l,m){for(var C=[],v=0;v<l.length;v++)C[v]=m(l[v],v);return C}function st(l,m,C){for(var v=0,x=C(m);v<l.length&&C(l[v])<=x;)v++;l.splice(v,0,m)}function De(){}function Me(l,m){var C;return Object.create?C=Object.create(l):(De.prototype=l,C=new De),m&&Ue(m,C),C}var Je=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function Ct(l){return/\w/.test(l)||l>"\x80"&&(l.toUpperCase()!=l.toLowerCase()||Je.test(l))}function $e(l,m){return m?m.source.indexOf("\\w")>-1&&Ct(l)?!0:m.test(l):Ct(l)}function pe(l){for(var m in l)if(l.hasOwnProperty(m)&&l[m])return!1;return!0}var ee=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function Ce(l){return l.charCodeAt(0)>=768&&ee.test(l)}function Lt(l,m,C){var v=this;this.input=C,v.scrollbarFiller=se("div",null,"CodeMirror-scrollbar-filler"),v.scrollbarFiller.setAttribute("cm-not-content","true"),v.gutterFiller=se("div",null,"CodeMirror-gutter-filler"),v.gutterFiller.setAttribute("cm-not-content","true"),v.lineDiv=se("div",null,"CodeMirror-code"),v.selectionDiv=se("div",null,null,"position: relative; z-index: 1"),v.cursorDiv=se("div",null,"CodeMirror-cursors"),v.measure=se("div",null,"CodeMirror-measure"),v.lineMeasure=se("div",null,"CodeMirror-measure"),v.lineSpace=se("div",[v.measure,v.lineMeasure,v.selectionDiv,v.cursorDiv,v.lineDiv],null,"position: relative; outline: none"),v.mover=se("div",[se("div",[v.lineSpace],"CodeMirror-lines")],null,"position: relative"),v.sizer=se("div",[v.mover],"CodeMirror-sizer"),v.sizerWidth=null,v.heightForcer=se("div",null,null,"position: absolute; height: "+bt+"px; width: 1px;"),v.gutters=se("div",null,"CodeMirror-gutters"),v.lineGutter=null,v.scroller=se("div",[v.sizer,v.heightForcer,v.gutters],"CodeMirror-scroll"),v.scroller.setAttribute("tabIndex","-1"),v.wrapper=se("div",[v.scrollbarFiller,v.gutterFiller,v.scroller],"CodeMirror"),s&&a<8&&(v.gutters.style.zIndex=-1,v.scroller.style.paddingRight=0),!d&&!(t&&k)&&(v.scroller.draggable=!0),l&&(l.appendChild?l.appendChild(v.wrapper):l(v.wrapper)),v.viewFrom=v.viewTo=m.first,v.reportedViewFrom=v.reportedViewTo=m.first,v.view=[],v.renderedView=null,v.externalMeasured=null,v.viewOffset=0,v.lastWrapHeight=v.lastWrapWidth=0,v.updateLineNumbers=null,v.nativeBarWidth=v.barHeight=v.barWidth=0,v.scrollbarsClipped=!1,v.lineNumWidth=v.lineNumInnerWidth=v.lineNumChars=null,v.alignWidgets=!1,v.cachedCharWidth=v.cachedTextHeight=v.cachedPaddingH=null,v.maxLine=null,v.maxLineLength=0,v.maxLineChanged=!1,v.wheelDX=v.wheelDY=v.wheelStartX=v.wheelStartY=null,v.shift=!1,v.selForContextMenu=null,v.activeTouch=null,C.init(v)}function tt(l,m){if(m-=l.first,m<0||m>=l.size)throw new Error("There is no line "+(m+l.first)+" in the document.");for(var C=l;!C.lines;)for(var v=0;;++v){var x=C.children[v],P=x.chunkSize();if(m<P){C=x;break}m-=P}return C.lines[m]}function yi(l,m,C){var v=[],x=m.line;return l.iter(m.line,C.line+1,function(P){var U=P.text;x==C.line&&(U=U.slice(0,C.ch)),x==m.line&&(U=U.slice(m.ch)),v.push(U),++x}),v}function sn(l,m,C){var v=[];return l.iter(m,C,function(x){v.push(x.text)}),v}function ki(l,m){var C=m-l.height;if(C)for(var v=l;v;v=v.parent)v.height+=C}function ti(l){if(l.parent==null)return null;for(var m=l.parent,C=lt(m.lines,l),v=m.parent;v;m=v,v=v.parent)for(var x=0;v.children[x]!=m;++x)C+=v.children[x].chunkSize();return C+m.first}function On(l,m){var C=l.first;e:do{for(var v=0;v<l.children.length;++v){var x=l.children[v],P=x.height;if(m<P){l=x;continue e}m-=P,C+=x.chunkSize()}return C}while(!l.lines);for(var U=0;U<l.lines.length;++U){var W=l.lines[U],X=W.height;if(m<X)break;m-=X}return C+U}function er(l,m){return m>=l.first&&m<l.first+l.size}function cr(l,m){return String(l.lineNumberFormatter(m+l.firstLineNumber))}function Ye(l,m){if(!(this instanceof Ye))return new Ye(l,m);this.line=l,this.ch=m}function Rt(l,m){return l.line-m.line||l.ch-m.ch}function xi(l){return Ye(l.line,l.ch)}function Vn(l,m){return Rt(l,m)<0?m:l}function Hi(l,m){return Rt(l,m)<0?l:m}function Nr(l,m){return Math.max(l.first,Math.min(m,l.first+l.size-1))}function Ft(l,m){if(m.line<l.first)return Ye(l.first,0);var C=l.first+l.size-1;return m.line>C?Ye(C,tt(l,C).text.length):fn(m,tt(l,m.line).text.length)}function fn(l,m){var C=l.ch;return C==null||C>m?Ye(l.line,m):C<0?Ye(l.line,0):l}function ts(l,m){for(var C=[],v=0;v<m.length;v++)C[v]=Ft(l,m[v]);return C}var wr=!1,gn=!1;function Es(){wr=!0}function Yn(){gn=!0}function Le(l,m,C){this.marker=l,this.from=m,this.to=C}function Ne(l,m){if(l)for(var C=0;C<l.length;++C){var v=l[C];if(v.marker==m)return v}}function et(l,m){for(var C,v=0;v<l.length;++v)l[v]!=m&&(C||(C=[])).push(l[v]);return C}function Gt(l,m){l.markedSpans=l.markedSpans?l.markedSpans.concat([m]):[m],m.marker.attachLine(l)}function Wi(l,m,C){var v;if(l)for(var x=0;x<l.length;++x){var P=l[x],U=P.marker,W=P.from==null||(U.inclusiveLeft?P.from<=m:P.from<m);if(W||P.from==m&&U.type=="bookmark"&&(!C||!P.marker.insertLeft)){var X=P.to==null||(U.inclusiveRight?P.to>=m:P.to>m);(v||(v=[])).push(new Le(U,P.from,X?null:P.to))}}return v}function Pr(l,m,C){var v;if(l)for(var x=0;x<l.length;++x){var P=l[x],U=P.marker,W=P.to==null||(U.inclusiveRight?P.to>=m:P.to>m);if(W||P.from==m&&U.type=="bookmark"&&(!C||P.marker.insertLeft)){var X=P.from==null||(U.inclusiveLeft?P.from<=m:P.from<m);(v||(v=[])).push(new Le(U,X?null:P.from-m,P.to==null?null:P.to-m))}}return v}function is(l,m){if(m.full)return null;var C=er(l,m.from.line)&&tt(l,m.from.line).markedSpans,v=er(l,m.to.line)&&tt(l,m.to.line).markedSpans;if(!C&&!v)return null;var x=m.from.ch,P=m.to.ch,U=Rt(m.from,m.to)==0,W=Wi(C,x,U),X=Pr(v,P,U),J=m.text.length==1,de=Xe(m.text).length+(J?x:0);if(W)for(var _e=0;_e<W.length;++_e){var xe=W[_e];if(xe.to==null){var ze=Ne(X,xe.marker);ze?J&&(xe.to=ze.to==null?null:ze.to+de):xe.to=x}}if(X)for(var Oe=0;Oe<X.length;++Oe){var Ke=X[Oe];if(Ke.to!=null&&(Ke.to+=de),Ke.from==null){var ht=Ne(W,Ke.marker);ht||(Ke.from=de,J&&(W||(W=[])).push(Ke))}else Ke.from+=de,J&&(W||(W=[])).push(Ke)}W&&(W=Ia(W)),X&&X!=W&&(X=Ia(X));var Bt=[W];if(!J){var dt=m.text.length-2,Vt;if(dt>0&&W)for(var Ut=0;Ut<W.length;++Ut)W[Ut].to==null&&(Vt||(Vt=[])).push(new Le(W[Ut].marker,null,null));for(var wt=0;wt<dt;++wt)Bt.push(Vt);Bt.push(X)}return Bt}function Ia(l){for(var m=0;m<l.length;++m){var C=l[m];C.from!=null&&C.from==C.to&&C.marker.clearWhenEmpty!==!1&&l.splice(m--,1)}return l.length?l:null}function Ar(l,m,C){var v=null;if(l.iter(m.line,C.line+1,function(ze){if(ze.markedSpans)for(var Oe=0;Oe<ze.markedSpans.length;++Oe){var Ke=ze.markedSpans[Oe].marker;Ke.readOnly&&(!v||lt(v,Ke)==-1)&&(v||(v=[])).push(Ke)}}),!v)return null;for(var x=[{from:m,to:C}],P=0;P<v.length;++P)for(var U=v[P],W=U.find(0),X=0;X<x.length;++X){var J=x[X];if(!(Rt(J.to,W.from)<0||Rt(J.from,W.to)>0)){var de=[X,1],_e=Rt(J.from,W.from),xe=Rt(J.to,W.to);(_e<0||!U.inclusiveLeft&&!_e)&&de.push({from:J.from,to:W.from}),(xe>0||!U.inclusiveRight&&!xe)&&de.push({from:W.to,to:J.to}),x.splice.apply(x,de),X+=de.length-1}}return x}function Ra(l){var m=l.markedSpans;if(!!m){for(var C=0;C<m.length;++C)m[C].marker.detachLine(l);l.markedSpans=null}}function Tr(l,m){if(!!m){for(var C=0;C<m.length;++C)m[C].marker.attachLine(l);l.markedSpans=m}}function Dn(l){return l.inclusiveLeft?-1:0}function xs(l){return l.inclusiveRight?1:0}function oe(l,m){var C=l.lines.length-m.lines.length;if(C!=0)return C;var v=l.find(),x=m.find(),P=Rt(v.from,x.from)||Dn(l)-Dn(m);if(P)return-P;var U=Rt(v.to,x.to)||xs(l)-xs(m);return U||m.id-l.id}function ke(l,m){var C=gn&&l.markedSpans,v;if(C)for(var x=void 0,P=0;P<C.length;++P)x=C[P],x.marker.collapsed&&(m?x.from:x.to)==null&&(!v||oe(v,x.marker)<0)&&(v=x.marker);return v}function Ze(l){return ke(l,!0)}function We(l){return ke(l,!1)}function $t(l,m,C,v,x){var P=tt(l,m),U=gn&&P.markedSpans;if(U)for(var W=0;W<U.length;++W){var X=U[W];if(!!X.marker.collapsed){var J=X.marker.find(0),de=Rt(J.from,C)||Dn(X.marker)-Dn(x),_e=Rt(J.to,v)||xs(X.marker)-xs(x);if(!(de>=0&&_e<=0||de<=0&&_e>=0)&&(de<=0&&(X.marker.inclusiveRight&&x.inclusiveLeft?Rt(J.to,C)>=0:Rt(J.to,C)>0)||de>=0&&(X.marker.inclusiveRight&&x.inclusiveLeft?Rt(J.from,v)<=0:Rt(J.from,v)<0)))return!0}}}function Jt(l){for(var m;m=Ze(l);)l=m.find(-1,!0).line;return l}function an(l){for(var m,C;m=We(l);)l=m.find(1,!0).line,(C||(C=[])).push(l);return C}function Ki(l,m){var C=tt(l,m),v=Jt(C);return C==v?m:ti(v)}function Rn(l,m){if(m>l.lastLine())return m;var C=tt(l,m),v;if(!tr(l,C))return m;for(;v=We(C);)C=v.find(1,!0).line;return ti(C)+1}function tr(l,m){var C=gn&&m.markedSpans;if(C){for(var v=void 0,x=0;x<C.length;++x)if(v=C[x],!!v.marker.collapsed){if(v.from==null)return!0;if(!v.marker.widgetNode&&v.from==0&&v.marker.inclusiveLeft&&Is(l,m,v))return!0}}}function Is(l,m,C){if(C.to==null){var v=C.marker.find(1,!0);return Is(l,v.line,Ne(v.line.markedSpans,C.marker))}if(C.marker.inclusiveRight&&C.to==m.text.length)return!0;for(var x=void 0,P=0;P<m.markedSpans.length;++P)if(x=m.markedSpans[P],x.marker.collapsed&&!x.marker.widgetNode&&x.from==C.to&&(x.to==null||x.to!=C.from)&&(x.marker.inclusiveLeft||C.marker.inclusiveRight)&&Is(l,m,x))return!0}function ur(l){l=Jt(l);for(var m=0,C=l.parent,v=0;v<C.lines.length;++v){var x=C.lines[v];if(x==l)break;m+=x.height}for(var P=C.parent;P;C=P,P=C.parent)for(var U=0;U<P.children.length;++U){var W=P.children[U];if(W==C)break;m+=W.height}return m}function Ma(l){if(l.height==0)return 0;for(var m=l.text.length,C,v=l;C=Ze(v);){var x=C.find(0,!0);v=x.from.line,m+=x.from.ch-x.to.ch}for(v=l;C=We(v);){var P=C.find(0,!0);m-=v.text.length-P.from.ch,v=P.to.line,m+=v.text.length-P.to.ch}return m}function vo(l){var m=l.display,C=l.doc;m.maxLine=tt(C,C.first),m.maxLineLength=Ma(m.maxLine),m.maxLineChanged=!0,C.iter(function(v){var x=Ma(v);x>m.maxLineLength&&(m.maxLineLength=x,m.maxLine=v)})}function fd(l,m,C,v){if(!l)return v(m,C,"ltr");for(var x=!1,P=0;P<l.length;++P){var U=l[P];(U.from<C&&U.to>m||m==C&&U.to==m)&&(v(Math.max(U.from,m),Math.min(U.to,C),U.level==1?"rtl":"ltr"),x=!0)}x||v(m,C,"ltr")}function yo(l){return l.level%2?l.to:l.from}function So(l){return l.level%2?l.from:l.to}function ka(l){var m=ir(l);return m?yo(m[0]):0}function Da(l){var m=ir(l);return m?So(Xe(m)):l.text.length}function gd(l,m,C){var v=l[0].level;return m==v?!0:C==v?!1:m<C}var Zs=null;function La(l,m){var C;Zs=null;for(var v=0;v<l.length;++v){var x=l[v];if(x.from<m&&x.to>m)return v;if(x.from==m||x.to==m)if(C==null)C=v;else return gd(l,x.level,l[C].level)?(x.from!=x.to&&(Zs=C),v):(x.from!=x.to&&(Zs=v),C)}return C}function bo(l,m,C,v){if(!v)return m+C;do m+=C;while(m>0&&Ce(l.text.charAt(m)));return m}function Co(l,m,C,v){var x=ir(l);if(!x)return ll(l,m,C,v);for(var P=La(x,m),U=x[P],W=bo(l,m,U.level%2?-C:C,v);;){if(W>U.from&&W<U.to)return W;if(W==U.from||W==U.to)return La(x,W)==P?W:(U=x[P+=C],C>0==U.level%2?U.to:U.from);if(U=x[P+=C],!U)return null;C>0==U.level%2?W=bo(l,U.to,-1,v):W=bo(l,U.from,1,v)}}function ll(l,m,C,v){var x=m+C;if(v)for(;x>0&&Ce(l.text.charAt(x));)x+=C;return x<0||x>l.text.length?null:x}var _d=function(){var l="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",m="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function C(de){return de<=247?l.charAt(de):1424<=de&&de<=1524?"R":1536<=de&&de<=1785?m.charAt(de-1536):1774<=de&&de<=2220?"r":8192<=de&&de<=8203?"w":de==8204?"b":"L"}var v=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,x=/[stwN]/,P=/[LRr]/,U=/[Lb1n]/,W=/[1n]/,X="L";function J(de,_e,xe){this.level=de,this.from=_e,this.to=xe}return function(de){if(!v.test(de))return!1;for(var _e=de.length,xe=[],ze=0;ze<_e;++ze)xe.push(C(de.charCodeAt(ze)));for(var Oe=0,Ke=X;Oe<_e;++Oe){var ht=xe[Oe];ht=="m"?xe[Oe]=Ke:Ke=ht}for(var Bt=0,dt=X;Bt<_e;++Bt){var Vt=xe[Bt];Vt=="1"&&dt=="r"?xe[Bt]="n":P.test(Vt)&&(dt=Vt,Vt=="r"&&(xe[Bt]="R"))}for(var Ut=1,wt=xe[0];Ut<_e-1;++Ut){var Ht=xe[Ut];Ht=="+"&&wt=="1"&&xe[Ut+1]=="1"?xe[Ut]="1":Ht==","&&wt==xe[Ut+1]&&(wt=="1"||wt=="n")&&(xe[Ut]=wt),wt=Ht}for(var Kt=0;Kt<_e;++Kt){var gi=xe[Kt];if(gi==",")xe[Kt]="N";else if(gi=="%"){var Ii=void 0;for(Ii=Kt+1;Ii<_e&&xe[Ii]=="%";++Ii);for(var Vi=Kt&&xe[Kt-1]=="!"||Ii<_e&&xe[Ii]=="1"?"1":"N",Qi=Kt;Qi<Ii;++Qi)xe[Qi]=Vi;Kt=Ii-1}}for(var Ti=0,Xi=X;Ti<_e;++Ti){var Pi=xe[Ti];Xi=="L"&&Pi=="1"?xe[Ti]="L":P.test(Pi)&&(Xi=Pi)}for(var Ri=0;Ri<_e;++Ri)if(x.test(xe[Ri])){var Zi=void 0;for(Zi=Ri+1;Zi<_e&&x.test(xe[Zi]);++Zi);for(var Hn=(Ri?xe[Ri-1]:X)=="L",_r=(Zi<_e?xe[Zi]:X)=="L",Mr=Hn||_r?"L":"R",vr=Ri;vr<Zi;++vr)xe[vr]=Mr;Ri=Zi-1}for(var Bi=[],Wn,rn=0;rn<_e;)if(U.test(xe[rn])){var ao=rn;for(++rn;rn<_e&&U.test(xe[rn]);++rn);Bi.push(new J(0,ao,rn))}else{var kr=rn,Ss=Bi.length;for(++rn;rn<_e&&xe[rn]!="L";++rn);for(var Ui=kr;Ui<rn;)if(W.test(xe[Ui])){kr<Ui&&Bi.splice(Ss,0,new J(1,kr,Ui));var Ks=Ui;for(++Ui;Ui<rn&&W.test(xe[Ui]);++Ui);Bi.splice(Ss,0,new J(2,Ks,Ui)),kr=Ui}else++Ui;kr<rn&&Bi.splice(Ss,0,new J(1,kr,rn))}return Bi[0].level==1&&(Wn=de.match(/^\s+/))&&(Bi[0].from=Wn[0].length,Bi.unshift(new J(0,0,Wn[0].length))),Xe(Bi).level==1&&(Wn=de.match(/\s+$/))&&(Xe(Bi).to-=Wn[0].length,Bi.push(new J(0,_e-Wn[0].length,_e))),Bi[0].level==2&&Bi.unshift(new J(1,Bi[0].to,Bi[0].to)),Bi[0].level!=Xe(Bi).level&&Bi.push(new J(Bi[0].level,_e,_e)),Bi}}();function ir(l){var m=l.order;return m==null&&(m=l.order=_d(l.text)),m}var dl=[],qt=function(l,m,C){if(l.addEventListener)l.addEventListener(m,C,!1);else if(l.attachEvent)l.attachEvent("on"+m,C);else{var v=l._handlers||(l._handlers={});v[m]=(v[m]||dl).concat(C)}};function wo(l,m){return l._handlers&&l._handlers[m]||dl}function Ln(l,m,C){if(l.removeEventListener)l.removeEventListener(m,C,!1);else if(l.detachEvent)l.detachEvent("on"+m,C);else{var v=l._handlers,x=v&&v[m];if(x){var P=lt(x,C);P>-1&&(v[m]=x.slice(0,P).concat(x.slice(P+1)))}}}function Oi(l,m){var C=wo(l,m);if(!!C.length)for(var v=Array.prototype.slice.call(arguments,2),x=0;x<C.length;++x)C[x].apply(null,v)}function Ji(l,m,C){return typeof m=="string"&&(m={type:m,preventDefault:function(){this.defaultPrevented=!0}}),Oi(l,C||m.type,l,m),To(m)||m.codemirrorIgnore}function ns(l){var m=l._handlers&&l._handlers.cursorActivity;if(!!m)for(var C=l.curOp.cursorActivityHandlers||(l.curOp.cursorActivityHandlers=[]),v=0;v<m.length;++v)lt(C,m[v])==-1&&C.push(m[v])}function _n(l,m){return wo(l,m).length>0}function Er(l){l.prototype.on=function(m,C){qt(this,m,C)},l.prototype.off=function(m,C){Ln(this,m,C)}}function un(l){l.preventDefault?l.preventDefault():l.returnValue=!1}function hl(l){l.stopPropagation?l.stopPropagation():l.cancelBubble=!0}function To(l){return l.defaultPrevented!=null?l.defaultPrevented:l.returnValue==!1}function Br(l){un(l),hl(l)}function Eo(l){return l.target||l.srcElement}function xo(l){var m=l.which;return m==null&&(l.button&1?m=1:l.button&2?m=3:l.button&4&&(m=2)),R&&l.ctrlKey&&m==1&&(m=3),m}var vd=function(){if(s&&a<9)return!1;var l=se("div");return"draggable"in l||"dragDrop"in l}(),cl;function yd(l){if(cl==null){var m=se("span","\u200B");Y(l,se("span",[m,document.createTextNode("x")])),l.firstChild.offsetHeight!=0&&(cl=m.offsetWidth<=1&&m.offsetHeight>2&&!(s&&a<8))}var C=cl?se("span","\u200B"):se("span","\xA0",null,"display: inline-block; width: 1px; margin-right: -1px");return C.setAttribute("cm-text",""),C}var Io;function Sd(l){if(Io!=null)return Io;var m=Y(l,document.createTextNode("A\u062EA")),C=ce(m,0,1).getBoundingClientRect(),v=ce(m,1,2).getBoundingClientRect();return q(l),!C||C.left==C.right?!1:Io=v.right-C.right<3}var Ro=`

b`.split(/\n/).length!=3?function(l){for(var m=0,C=[],v=l.length;m<=v;){var x=l.indexOf(`
`,m);x==-1&&(x=l.length);var P=l.slice(m,l.charAt(x-1)=="\r"?x-1:x),U=P.indexOf("\r");U!=-1?(C.push(P.slice(0,U)),m+=U+1):(C.push(P),m=x+1)}return C}:function(l){return l.split(/\r\n?|\n/)},bd=window.getSelection?function(l){try{return l.selectionStart!=l.selectionEnd}catch{return!1}}:function(l){var m;try{m=l.ownerDocument.selection.createRange()}catch{}return!m||m.parentElement()!=l?!1:m.compareEndPoints("StartToEnd",m)!=0},Na=function(){var l=se("div");return"oncopy"in l?!0:(l.setAttribute("oncopy","return;"),typeof l.oncopy=="function")}(),Mo=null;function si(l){if(Mo!=null)return Mo;var m=Y(l,se("span","x")),C=m.getBoundingClientRect(),v=ce(m,0,1).getBoundingClientRect();return Mo=Math.abs(C.left-v.left)>1}var rt={},Ot={};function en(l,m){arguments.length>2&&(m.dependencies=Array.prototype.slice.call(arguments,2)),rt[l]=m}function he(l,m){Ot[l]=m}function wn(l){if(typeof l=="string"&&Ot.hasOwnProperty(l))l=Ot[l];else if(l&&typeof l.name=="string"&&Ot.hasOwnProperty(l.name)){var m=Ot[l.name];typeof m=="string"&&(m={name:m}),l=Me(m,l),l.name=m.name}else{if(typeof l=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(l))return wn("application/xml");if(typeof l=="string"&&/^[\w\-]+\/[\w\-]+\+json$/.test(l))return wn("application/json")}return typeof l=="string"?{name:l}:l||{name:"null"}}function ul(l,m){m=wn(m);var C=rt[m.name];if(!C)return ul(l,"text/plain");var v=C(l,m);if(Ci.hasOwnProperty(m.name)){var x=Ci[m.name];for(var P in x)!x.hasOwnProperty(P)||(v.hasOwnProperty(P)&&(v["_"+P]=v[P]),v[P]=x[P])}if(v.name=m.name,m.helperType&&(v.helperType=m.helperType),m.modeProps)for(var U in m.modeProps)v[U]=m.modeProps[U];return v}var Ci={};function wi(l,m){var C=Ci.hasOwnProperty(l)?Ci[l]:Ci[l]={};Ue(m,C)}function Nn(l,m){if(m===!0)return m;if(l.copyState)return l.copyState(m);var C={};for(var v in m){var x=m[v];x instanceof Array&&(x=x.concat([])),C[v]=x}return C}function rs(l,m){for(var C;l.innerMode&&(C=l.innerMode(m),!(!C||C.mode==l));)m=C.state,l=C.mode;return C||{mode:l,state:m}}function ss(l,m,C){return l.startState?l.startState(m,C):!0}var Jn=function(l,m){this.pos=this.start=0,this.string=l,this.tabSize=m||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};Jn.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(l){var m=this.string.charAt(this.pos),C;if(typeof l=="string"?C=m==l:C=m&&(l.test?l.test(m):l(m)),C)return++this.pos,m},eatWhile:function(l){for(var m=this.pos;this.eat(l););return this.pos>m},eatSpace:function(){for(var l=this,m=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++l.pos;return this.pos>m},skipToEnd:function(){this.pos=this.string.length},skipTo:function(l){var m=this.string.indexOf(l,this.pos);if(m>-1)return this.pos=m,!0},backUp:function(l){this.pos-=l},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Ge(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?Ge(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return Ge(this.string,null,this.tabSize)-(this.lineStart?Ge(this.string,this.lineStart,this.tabSize):0)},match:function(l,m,C){if(typeof l=="string"){var v=function(U){return C?U.toLowerCase():U},x=this.string.substr(this.pos,l.length);if(v(x)==v(l))return m!==!1&&(this.pos+=l.length),!0}else{var P=this.string.slice(this.pos).match(l);return P&&P.index>0?null:(P&&m!==!1&&(this.pos+=P[0].length),P)}},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(l,m){this.lineStart+=l;try{return m()}finally{this.lineStart-=l}}};function nr(l,m,C,v){var x=[l.state.modeGen],P={};Ed(l,m.text,l.doc.mode,C,function(X,J){return x.push(X,J)},P,v);for(var U=function(X){var J=l.state.overlays[X],de=1,_e=0;Ed(l,m.text,J.mode,!0,function(xe,ze){for(var Oe=de;_e<xe;){var Ke=x[de];Ke>xe&&x.splice(de,1,xe,x[de+1],Ke),de+=2,_e=Math.min(xe,Ke)}if(!!ze)if(J.opaque)x.splice(Oe,de-Oe,xe,"overlay "+ze),de=Oe+2;else for(;Oe<de;Oe+=2){var ht=x[Oe+1];x[Oe+1]=(ht?ht+" ":"")+"overlay "+ze}},P)},W=0;W<l.state.overlays.length;++W)U(W);return{styles:x,classes:P.bgClass||P.textClass?P:null}}function rr(l,m,C){if(!m.styles||m.styles[0]!=l.state.modeGen){var v=as(l,ti(m)),x=nr(l,m,m.text.length>l.options.maxHighlightLength?Nn(l.doc.mode,v):v);m.stateAfter=v,m.styles=x.styles,x.classes?m.styleClasses=x.classes:m.styleClasses&&(m.styleClasses=null),C===l.doc.frontier&&l.doc.frontier++}return m.styles}function as(l,m,C){var v=l.doc,x=l.display;if(!v.mode.startState)return!0;var P=rc(l,m,C),U=P>v.first&&tt(v,P-1).stateAfter;return U?U=Nn(v.mode,U):U=ss(v.mode),v.iter(P,m,function(W){pl(l,W.text,U);var X=P==m-1||P%5==0||P>=x.viewFrom&&P<x.viewTo;W.stateAfter=X?Nn(v.mode,U):null,++P}),C&&(v.frontier=P),U}function pl(l,m,C,v){var x=l.doc.mode,P=new Jn(m,l.options.tabSize);for(P.start=P.pos=v||0,m==""&&Cd(x,C);!P.eol();)ml(x,P,C),P.start=P.pos}function Cd(l,m){if(l.blankLine)return l.blankLine(m);if(!!l.innerMode){var C=rs(l,m);if(C.mode.blankLine)return C.mode.blankLine(C.state)}}function ml(l,m,C,v){for(var x=0;x<10;x++){v&&(v[0]=rs(l,C).mode);var P=l.token(m,C);if(m.pos>m.start)return P}throw new Error("Mode "+l.name+" failed to advance stream.")}function wd(l,m,C,v){var x=function(xe){return{start:de.start,end:de.pos,string:de.current(),type:W||null,state:xe?Nn(P.mode,J):J}},P=l.doc,U=P.mode,W;m=Ft(P,m);var X=tt(P,m.line),J=as(l,m.line,C),de=new Jn(X.text,l.options.tabSize),_e;for(v&&(_e=[]);(v||de.pos<m.ch)&&!de.eol();)de.start=de.pos,W=ml(U,de,J),v&&_e.push(x(!0));return v?_e:x()}function Td(l,m){if(l)for(;;){var C=l.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!C)break;l=l.slice(0,C.index)+l.slice(C.index+C[0].length);var v=C[1]?"bgClass":"textClass";m[v]==null?m[v]=C[2]:new RegExp("(?:^|s)"+C[2]+"(?:$|s)").test(m[v])||(m[v]+=" "+C[2])}return l}function Ed(l,m,C,v,x,P,U){var W=C.flattenSpans;W==null&&(W=l.options.flattenSpans);var X=0,J=null,de=new Jn(m,l.options.tabSize),_e,xe=l.options.addModeClass&&[null];for(m==""&&Td(Cd(C,v),P);!de.eol();){if(de.pos>l.options.maxHighlightLength?(W=!1,U&&pl(l,m,v,de.pos),de.pos=m.length,_e=null):_e=Td(ml(C,de,v,xe),P),xe){var ze=xe[0].name;ze&&(_e="m-"+(_e?ze+" "+_e:ze))}if(!W||J!=_e){for(;X<de.start;)X=Math.min(de.start,X+5e3),x(X,J);J=_e}de.start=de.pos}for(;X<de.pos;){var Oe=Math.min(de.pos,X+5e3);x(Oe,J),X=Oe}}function rc(l,m,C){for(var v,x,P=l.doc,U=C?-1:m-(l.doc.mode.innerMode?1e3:100),W=m;W>U;--W){if(W<=P.first)return P.first;var X=tt(P,W-1);if(X.stateAfter&&(!C||W<=P.frontier))return W;var J=Ge(X.text,null,l.options.tabSize);(x==null||v>J)&&(x=W-1,v=J)}return x}function ea(l,m,C){this.text=l,Tr(this,m),this.height=C?C(this):1}Er(ea),ea.prototype.lineNo=function(){return ti(this)};function sc(l,m,C,v){l.text=m,l.stateAfter&&(l.stateAfter=null),l.styles&&(l.styles=null),l.order!=null&&(l.order=null),Ra(l),Tr(l,C);var x=v?v(l):1;x!=l.height&&ki(l,x)}function ac(l){l.parent=null,Ra(l)}var oc={},lc={};function xd(l,m){if(!l||/^\s*$/.test(l))return null;var C=m.addModeClass?lc:oc;return C[l]||(C[l]=l.replace(/\S+/g,"cm-$&"))}function Id(l,m){var C=se("span",null,null,d?"padding-right: .1px":null),v={pre:se("pre",[C],"CodeMirror-line"),content:C,col:0,pos:0,cm:l,trailingSpace:!1,splitSpaces:(s||d)&&l.getOption("lineWrapping")};m.measure={};for(var x=0;x<=(m.rest?m.rest.length:0);x++){var P=x?m.rest[x-1]:m.line,U=void 0;v.pos=0,v.addToken=hc,Sd(l.display.measure)&&(U=ir(P))&&(v.addToken=uc(v.addToken,U)),v.map=[];var W=m!=l.display.externalMeasured&&ti(P);pc(P,v,rr(l,P,W)),P.styleClasses&&(P.styleClasses.bgClass&&(v.bgClass=Pe(P.styleClasses.bgClass,v.bgClass||"")),P.styleClasses.textClass&&(v.textClass=Pe(P.styleClasses.textClass,v.textClass||""))),v.map.length==0&&v.map.push(0,0,v.content.appendChild(yd(l.display.measure))),x==0?(m.measure.map=v.map,m.measure.cache={}):((m.measure.maps||(m.measure.maps=[])).push(v.map),(m.measure.caches||(m.measure.caches=[])).push({}))}if(d){var X=v.content.lastChild;(/\bcm-tab\b/.test(X.className)||X.querySelector&&X.querySelector(".cm-tab"))&&(v.content.className="cm-tab-wrap-hack")}return Oi(l,"renderLine",l,m.line,v.pre),v.pre.className&&(v.textClass=Pe(v.pre.className,v.textClass||"")),v}function dc(l){var m=se("span","\u2022","cm-invalidchar");return m.title="\\u"+l.charCodeAt(0).toString(16),m.setAttribute("aria-label",m.title),m}function hc(l,m,C,v,x,P,U){if(!!m){var W=l.splitSpaces?cc(m,l.trailingSpace):m,X=l.cm.state.specialChars,J=!1,de;if(!X.test(m))l.col+=m.length,de=document.createTextNode(W),l.map.push(l.pos,l.pos+m.length,de),s&&a<9&&(J=!0),l.pos+=m.length;else{de=document.createDocumentFragment();for(var _e=0;;){X.lastIndex=_e;var xe=X.exec(m),ze=xe?xe.index-_e:m.length-_e;if(ze){var Oe=document.createTextNode(W.slice(_e,_e+ze));s&&a<9?de.appendChild(se("span",[Oe])):de.appendChild(Oe),l.map.push(l.pos,l.pos+ze,Oe),l.col+=ze,l.pos+=ze}if(!xe)break;_e+=ze+1;var Ke=void 0;if(xe[0]=="	"){var ht=l.cm.options.tabSize,Bt=ht-l.col%ht;Ke=de.appendChild(se("span",vi(Bt),"cm-tab")),Ke.setAttribute("role","presentation"),Ke.setAttribute("cm-text","	"),l.col+=Bt}else xe[0]=="\r"||xe[0]==`
`?(Ke=de.appendChild(se("span",xe[0]=="\r"?"\u240D":"\u2424","cm-invalidchar")),Ke.setAttribute("cm-text",xe[0]),l.col+=1):(Ke=l.cm.options.specialCharPlaceholder(xe[0]),Ke.setAttribute("cm-text",xe[0]),s&&a<9?de.appendChild(se("span",[Ke])):de.appendChild(Ke),l.col+=1);l.map.push(l.pos,l.pos+1,Ke),l.pos++}}if(l.trailingSpace=W.charCodeAt(m.length-1)==32,C||v||x||J||U){var dt=C||"";v&&(dt+=v),x&&(dt+=x);var Vt=se("span",[de],dt,U);return P&&(Vt.title=P),l.content.appendChild(Vt)}l.content.appendChild(de)}}function cc(l,m){if(l.length>1&&!/  /.test(l))return l;for(var C=m,v="",x=0;x<l.length;x++){var P=l.charAt(x);P==" "&&C&&(x==l.length-1||l.charCodeAt(x+1)==32)&&(P="\xA0"),v+=P,C=P==" "}return v}function uc(l,m){return function(C,v,x,P,U,W,X){x=x?x+" cm-force-border":"cm-force-border";for(var J=C.pos,de=J+v.length;;){for(var _e=void 0,xe=0;xe<m.length&&(_e=m[xe],!(_e.to>J&&_e.from<=J));xe++);if(_e.to>=de)return l(C,v,x,P,U,W,X);l(C,v.slice(0,_e.to-J),x,P,null,W,X),P=null,v=v.slice(_e.to-J),J=_e.to}}}function Rd(l,m,C,v){var x=!v&&C.widgetNode;x&&l.map.push(l.pos,l.pos+m,x),!v&&l.cm.display.input.needsContentAttribute&&(x||(x=l.content.appendChild(document.createElement("span"))),x.setAttribute("cm-marker",C.id)),x&&(l.cm.display.input.setUneditable(x),l.content.appendChild(x)),l.pos+=m,l.trailingSpace=!1}function pc(l,m,C){var v=l.markedSpans,x=l.text,P=0;if(!v){for(var U=1;U<C.length;U+=2)m.addToken(m,x.slice(P,P=C[U]),xd(C[U+1],m.cm.options));return}for(var W=x.length,X=0,J=1,de="",_e,xe,ze=0,Oe,Ke,ht,Bt,dt;;){if(ze==X){Oe=Ke=ht=Bt=xe="",dt=null,ze=1/0;for(var Vt=[],Ut=void 0,wt=0;wt<v.length;++wt){var Ht=v[wt],Kt=Ht.marker;Kt.type=="bookmark"&&Ht.from==X&&Kt.widgetNode?Vt.push(Kt):Ht.from<=X&&(Ht.to==null||Ht.to>X||Kt.collapsed&&Ht.to==X&&Ht.from==X)?(Ht.to!=null&&Ht.to!=X&&ze>Ht.to&&(ze=Ht.to,Ke=""),Kt.className&&(Oe+=" "+Kt.className),Kt.css&&(xe=(xe?xe+";":"")+Kt.css),Kt.startStyle&&Ht.from==X&&(ht+=" "+Kt.startStyle),Kt.endStyle&&Ht.to==ze&&(Ut||(Ut=[])).push(Kt.endStyle,Ht.to),Kt.title&&!Bt&&(Bt=Kt.title),Kt.collapsed&&(!dt||oe(dt.marker,Kt)<0)&&(dt=Ht)):Ht.from>X&&ze>Ht.from&&(ze=Ht.from)}if(Ut)for(var gi=0;gi<Ut.length;gi+=2)Ut[gi+1]==ze&&(Ke+=" "+Ut[gi]);if(!dt||dt.from==X)for(var Ii=0;Ii<Vt.length;++Ii)Rd(m,0,Vt[Ii]);if(dt&&(dt.from||0)==X){if(Rd(m,(dt.to==null?W+1:dt.to)-X,dt.marker,dt.from==null),dt.to==null)return;dt.to==X&&(dt=!1)}}if(X>=W)break;for(var Vi=Math.min(W,ze);;){if(de){var Qi=X+de.length;if(!dt){var Ti=Qi>Vi?de.slice(0,Vi-X):de;m.addToken(m,Ti,_e?_e+Oe:Oe,ht,X+Ti.length==ze?Ke:"",Bt,xe)}if(Qi>=Vi){de=de.slice(Vi-X),X=Vi;break}X=Qi,ht=""}de=x.slice(P,P=C[J++]),_e=xd(C[J++],m.cm.options)}}}function Md(l,m,C){this.line=m,this.rest=an(m),this.size=this.rest?ti(Xe(this.rest))-C+1:1,this.node=this.text=null,this.hidden=tr(l,m)}function ko(l,m,C){for(var v=[],x,P=m;P<C;P=x){var U=new Md(l.doc,tt(l.doc,P),P);x=P+U.size,v.push(U)}return v}var ta=null;function mc(l){ta?ta.ops.push(l):l.ownsGroup=ta={ops:[l],delayedCallbacks:[]}}function fc(l){var m=l.delayedCallbacks,C=0;do{for(;C<m.length;C++)m[C].call(null);for(var v=0;v<l.ops.length;v++){var x=l.ops[v];if(x.cursorActivityHandlers)for(;x.cursorActivityCalled<x.cursorActivityHandlers.length;)x.cursorActivityHandlers[x.cursorActivityCalled++].call(null,x.cm)}}while(C<m.length)}function gc(l,m){var C=l.ownsGroup;if(!!C)try{fc(C)}finally{ta=null,m(C)}}var Pa=null;function Un(l,m){var C=wo(l,m);if(!!C.length){var v=Array.prototype.slice.call(arguments,2),x;ta?x=ta.delayedCallbacks:Pa?x=Pa:(x=Pa=[],setTimeout(_c,0));for(var P=function(W){x.push(function(){return C[W].apply(null,v)})},U=0;U<C.length;++U)P(U)}}function _c(){var l=Pa;Pa=null;for(var m=0;m<l.length;++m)l[m]()}function kd(l,m,C,v){for(var x=0;x<m.changes.length;x++){var P=m.changes[x];P=="text"?yc(l,m):P=="gutter"?Ld(l,m,C,v):P=="class"?fl(m):P=="widget"&&Sc(l,m,v)}m.changes=null}function Aa(l){return l.node==l.text&&(l.node=se("div",null,null,"position: relative"),l.text.parentNode&&l.text.parentNode.replaceChild(l.node,l.text),l.node.appendChild(l.text),s&&a<8&&(l.node.style.zIndex=2)),l.node}function vc(l){var m=l.bgClass?l.bgClass+" "+(l.line.bgClass||""):l.line.bgClass;if(m&&(m+=" CodeMirror-linebackground"),l.background)m?l.background.className=m:(l.background.parentNode.removeChild(l.background),l.background=null);else if(m){var C=Aa(l);l.background=C.insertBefore(se("div",null,m),C.firstChild)}}function Dd(l,m){var C=l.display.externalMeasured;return C&&C.line==m.line?(l.display.externalMeasured=null,m.measure=C.measure,C.built):Id(l,m)}function yc(l,m){var C=m.text.className,v=Dd(l,m);m.text==m.node&&(m.node=v.pre),m.text.parentNode.replaceChild(v.pre,m.text),m.text=v.pre,v.bgClass!=m.bgClass||v.textClass!=m.textClass?(m.bgClass=v.bgClass,m.textClass=v.textClass,fl(m)):C&&(m.text.className=C)}function fl(l){vc(l),l.line.wrapClass?Aa(l).className=l.line.wrapClass:l.node!=l.text&&(l.node.className="");var m=l.textClass?l.textClass+" "+(l.line.textClass||""):l.line.textClass;l.text.className=m||""}function Ld(l,m,C,v){if(m.gutter&&(m.node.removeChild(m.gutter),m.gutter=null),m.gutterBackground&&(m.node.removeChild(m.gutterBackground),m.gutterBackground=null),m.line.gutterClass){var x=Aa(m);m.gutterBackground=se("div",null,"CodeMirror-gutter-background "+m.line.gutterClass,"left: "+(l.options.fixedGutter?v.fixedPos:-v.gutterTotalWidth)+"px; width: "+v.gutterTotalWidth+"px"),x.insertBefore(m.gutterBackground,m.text)}var P=m.line.gutterMarkers;if(l.options.lineNumbers||P){var U=Aa(m),W=m.gutter=se("div",null,"CodeMirror-gutter-wrapper","left: "+(l.options.fixedGutter?v.fixedPos:-v.gutterTotalWidth)+"px");if(l.display.input.setUneditable(W),U.insertBefore(W,m.text),m.line.gutterClass&&(W.className+=" "+m.line.gutterClass),l.options.lineNumbers&&(!P||!P["CodeMirror-linenumbers"])&&(m.lineNumber=W.appendChild(se("div",cr(l.options,C),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+v.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+l.display.lineNumInnerWidth+"px"))),P)for(var X=0;X<l.options.gutters.length;++X){var J=l.options.gutters[X],de=P.hasOwnProperty(J)&&P[J];de&&W.appendChild(se("div",[de],"CodeMirror-gutter-elt","left: "+v.gutterLeft[J]+"px; width: "+v.gutterWidth[J]+"px"))}}}function Sc(l,m,C){m.alignable&&(m.alignable=null);for(var v=m.node.firstChild,x=void 0;v;v=x)x=v.nextSibling,v.className=="CodeMirror-linewidget"&&m.node.removeChild(v);Nd(l,m,C)}function bc(l,m,C,v){var x=Dd(l,m);return m.text=m.node=x.pre,x.bgClass&&(m.bgClass=x.bgClass),x.textClass&&(m.textClass=x.textClass),fl(m),Ld(l,m,C,v),Nd(l,m,v),m.node}function Nd(l,m,C){if(Pd(l,m.line,m,C,!0),m.rest)for(var v=0;v<m.rest.length;v++)Pd(l,m.rest[v],m,C,!1)}function Pd(l,m,C,v,x){if(!!m.widgets)for(var P=Aa(C),U=0,W=m.widgets;U<W.length;++U){var X=W[U],J=se("div",[X.node],"CodeMirror-linewidget");X.handleMouseEvents||J.setAttribute("cm-ignore-events","true"),Cc(X,J,C,v),l.display.input.setUneditable(J),x&&X.above?P.insertBefore(J,C.gutter||C.text):P.appendChild(J),Un(X,"redraw")}}function Cc(l,m,C,v){if(l.noHScroll){(C.alignable||(C.alignable=[])).push(m);var x=v.wrapperWidth;m.style.left=v.fixedPos+"px",l.coverGutter||(x-=v.gutterTotalWidth,m.style.paddingLeft=v.gutterTotalWidth+"px"),m.style.width=x+"px"}l.coverGutter&&(m.style.zIndex=5,m.style.position="relative",l.noHScroll||(m.style.marginLeft=-v.gutterTotalWidth+"px"))}function Ba(l){if(l.height!=null)return l.height;var m=l.doc.cm;if(!m)return 0;if(!le(document.body,l.node)){var C="position: relative;";l.coverGutter&&(C+="margin-left: -"+m.display.gutters.offsetWidth+"px;"),l.noHScroll&&(C+="width: "+m.display.wrapper.clientWidth+"px;"),Y(m.display.measure,se("div",[l.node],null,C))}return l.height=l.node.parentNode.offsetHeight}function Fr(l,m){for(var C=Eo(m);C!=l.wrapper;C=C.parentNode)if(!C||C.nodeType==1&&C.getAttribute("cm-ignore-events")=="true"||C.parentNode==l.sizer&&C!=l.mover)return!0}function Do(l){return l.lineSpace.offsetTop}function gl(l){return l.mover.offsetHeight-l.lineSpace.offsetHeight}function Ad(l){if(l.cachedPaddingH)return l.cachedPaddingH;var m=Y(l.measure,se("pre","x")),C=window.getComputedStyle?window.getComputedStyle(m):m.currentStyle,v={left:parseInt(C.paddingLeft),right:parseInt(C.paddingRight)};return!isNaN(v.left)&&!isNaN(v.right)&&(l.cachedPaddingH=v),v}function xr(l){return bt-l.display.nativeBarWidth}function Rs(l){return l.display.scroller.clientWidth-xr(l)-l.display.barWidth}function _l(l){return l.display.scroller.clientHeight-xr(l)-l.display.barHeight}function wc(l,m,C){var v=l.options.lineWrapping,x=v&&Rs(l);if(!m.measure.heights||v&&m.measure.width!=x){var P=m.measure.heights=[];if(v){m.measure.width=x;for(var U=m.text.firstChild.getClientRects(),W=0;W<U.length-1;W++){var X=U[W],J=U[W+1];Math.abs(X.bottom-J.bottom)>2&&P.push((X.bottom+J.top)/2-C.top)}}P.push(C.bottom-C.top)}}function Bd(l,m,C){if(l.line==m)return{map:l.measure.map,cache:l.measure.cache};for(var v=0;v<l.rest.length;v++)if(l.rest[v]==m)return{map:l.measure.maps[v],cache:l.measure.caches[v]};for(var x=0;x<l.rest.length;x++)if(ti(l.rest[x])>C)return{map:l.measure.maps[x],cache:l.measure.caches[x],before:!0}}function Tc(l,m){m=Jt(m);var C=ti(m),v=l.display.externalMeasured=new Md(l.doc,m,C);v.lineN=C;var x=v.built=Id(l,v);return v.text=x.pre,Y(l.display.lineMeasure,x.pre),v}function Fd(l,m,C,v){return Sl(l,yl(l,m),C,v)}function vl(l,m){if(m>=l.display.viewFrom&&m<l.display.viewTo)return l.display.view[Ls(l,m)];var C=l.display.externalMeasured;if(C&&m>=C.lineN&&m<C.lineN+C.size)return C}function yl(l,m){var C=ti(m),v=vl(l,C);v&&!v.text?v=null:v&&v.changes&&(kd(l,v,C,Tl(l)),l.curOp.forceUpdate=!0),v||(v=Tc(l,m));var x=Bd(v,m,C);return{line:m,view:v,rect:null,map:x.map,cache:x.cache,before:x.before,hasHeights:!1}}function Sl(l,m,C,v,x){m.before&&(C=-1);var P=C+(v||""),U;return m.cache.hasOwnProperty(P)?U=m.cache[P]:(m.rect||(m.rect=m.view.text.getBoundingClientRect()),m.hasHeights||(wc(l,m.view,m.rect),m.hasHeights=!0),U=xc(l,m,C,v),U.bogus||(m.cache[P]=U)),{left:U.left,right:U.right,top:x?U.rtop:U.top,bottom:x?U.rbottom:U.bottom}}var Od={left:0,right:0,top:0,bottom:0};function Vd(l,m,C){for(var v,x,P,U,W,X,J=0;J<l.length;J+=3)if(W=l[J],X=l[J+1],m<W?(x=0,P=1,U="left"):m<X?(x=m-W,P=x+1):(J==l.length-3||m==X&&l[J+3]>m)&&(P=X-W,x=P-1,m>=X&&(U="right")),x!=null){if(v=l[J+2],W==X&&C==(v.insertLeft?"left":"right")&&(U=C),C=="left"&&x==0)for(;J&&l[J-2]==l[J-3]&&l[J-1].insertLeft;)v=l[(J-=3)+2],U="left";if(C=="right"&&x==X-W)for(;J<l.length-3&&l[J+3]==l[J+4]&&!l[J+5].insertLeft;)v=l[(J+=3)+2],U="right";break}return{node:v,start:x,end:P,collapse:U,coverStart:W,coverEnd:X}}function Ec(l,m){var C=Od;if(m=="left")for(var v=0;v<l.length&&(C=l[v]).left==C.right;v++);else for(var x=l.length-1;x>=0&&(C=l[x]).left==C.right;x--);return C}function xc(l,m,C,v){var x=Vd(m.map,C,v),P=x.node,U=x.start,W=x.end,X=x.collapse,J;if(P.nodeType==3){for(var de=0;de<4;de++){for(;U&&Ce(m.line.text.charAt(x.coverStart+U));)--U;for(;x.coverStart+W<x.coverEnd&&Ce(m.line.text.charAt(x.coverStart+W));)++W;if(s&&a<9&&U==0&&W==x.coverEnd-x.coverStart?J=P.parentNode.getBoundingClientRect():J=Ec(ce(P,U,W).getClientRects(),v),J.left||J.right||U==0)break;W=U,U=U-1,X="right"}s&&a<11&&(J=Ic(l.display.measure,J))}else{U>0&&(X=v="right");var _e;l.options.lineWrapping&&(_e=P.getClientRects()).length>1?J=_e[v=="right"?_e.length-1:0]:J=P.getBoundingClientRect()}if(s&&a<9&&!U&&(!J||!J.left&&!J.right)){var xe=P.parentNode.getClientRects()[0];xe?J={left:xe.left,right:xe.left+Oa(l.display),top:xe.top,bottom:xe.bottom}:J=Od}for(var ze=J.top-m.rect.top,Oe=J.bottom-m.rect.top,Ke=(ze+Oe)/2,ht=m.view.measure.heights,Bt=0;Bt<ht.length-1&&!(Ke<ht[Bt]);Bt++);var dt=Bt?ht[Bt-1]:0,Vt=ht[Bt],Ut={left:(X=="right"?J.right:J.left)-m.rect.left,right:(X=="left"?J.left:J.right)-m.rect.left,top:dt,bottom:Vt};return!J.left&&!J.right&&(Ut.bogus=!0),l.options.singleCursorHeightPerLine||(Ut.rtop=ze,Ut.rbottom=Oe),Ut}function Ic(l,m){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!si(l))return m;var C=screen.logicalXDPI/screen.deviceXDPI,v=screen.logicalYDPI/screen.deviceYDPI;return{left:m.left*C,right:m.right*C,top:m.top*v,bottom:m.bottom*v}}function Ud(l){if(l.measure&&(l.measure.cache={},l.measure.heights=null,l.rest))for(var m=0;m<l.rest.length;m++)l.measure.caches[m]={}}function zd(l){l.display.externalMeasure=null,q(l.display.lineMeasure);for(var m=0;m<l.display.view.length;m++)Ud(l.display.view[m])}function Fa(l){zd(l),l.display.cachedCharWidth=l.display.cachedTextHeight=l.display.cachedPaddingH=null,l.options.lineWrapping||(l.display.maxLineChanged=!0),l.display.lineNumChars=null}function Gd(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function Hd(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function bl(l,m,C,v,x){if(!x&&m.widgets){for(var P=0;P<m.widgets.length;++P)if(m.widgets[P].above){var U=Ba(m.widgets[P]);C.top+=U,C.bottom+=U}}if(v=="line")return C;v||(v="local");var W=ur(m);if(v=="local"?W+=Do(l.display):W-=l.display.viewOffset,v=="page"||v=="window"){var X=l.display.lineSpace.getBoundingClientRect();W+=X.top+(v=="window"?0:Hd());var J=X.left+(v=="window"?0:Gd());C.left+=J,C.right+=J}return C.top+=W,C.bottom+=W,C}function Wd(l,m,C){if(C=="div")return m;var v=m.left,x=m.top;if(C=="page")v-=Gd(),x-=Hd();else if(C=="local"||!C){var P=l.display.sizer.getBoundingClientRect();v+=P.left,x+=P.top}var U=l.display.lineSpace.getBoundingClientRect();return{left:v-U.left,top:x-U.top}}function Cl(l,m,C,v,x){return v||(v=tt(l.doc,m.line)),bl(l,v,Fd(l,v,m.ch,x),C)}function Or(l,m,C,v,x,P){v=v||tt(l.doc,m.line),x||(x=yl(l,v));function U(xe,ze){var Oe=Sl(l,x,xe,ze?"right":"left",P);return ze?Oe.left=Oe.right:Oe.right=Oe.left,bl(l,v,Oe,C)}function W(xe,ze){var Oe=X[ze],Ke=Oe.level%2;return xe==yo(Oe)&&ze&&Oe.level<X[ze-1].level?(Oe=X[--ze],xe=So(Oe)-(Oe.level%2?0:1),Ke=!0):xe==So(Oe)&&ze<X.length-1&&Oe.level<X[ze+1].level&&(Oe=X[++ze],xe=yo(Oe)-Oe.level%2,Ke=!1),Ke&&xe==Oe.to&&xe>Oe.from?U(xe-1):U(xe,Ke)}var X=ir(v),J=m.ch;if(!X)return U(J);var de=La(X,J),_e=W(J,de);return Zs!=null&&(_e.other=W(J,Zs)),_e}function jd(l,m){var C=0;m=Ft(l.doc,m),l.options.lineWrapping||(C=Oa(l.display)*m.ch);var v=tt(l.doc,m.line),x=ur(v)+Do(l.display);return{left:C,right:C,top:x,bottom:x+v.height}}function Lo(l,m,C,v){var x=Ye(l,m);return x.xRel=v,C&&(x.outside=!0),x}function wl(l,m,C){var v=l.doc;if(C+=l.display.viewOffset,C<0)return Lo(v.first,0,!0,-1);var x=On(v,C),P=v.first+v.size-1;if(x>P)return Lo(v.first+v.size-1,tt(v,P).text.length,!0,1);m<0&&(m=0);for(var U=tt(v,x);;){var W=Rc(l,U,x,m,C),X=We(U),J=X&&X.find(0,!0);if(X&&(W.ch>J.from.ch||W.ch==J.from.ch&&W.xRel>0))x=ti(U=J.to.line);else return W}}function Rc(l,m,C,v,x){var P=x-ur(m),U=!1,W=2*l.display.wrapper.clientWidth,X=yl(l,m);function J(Qi){var Ti=Or(l,Ye(C,Qi),"line",m,X);return U=!0,P>Ti.bottom?Ti.left-W:P<Ti.top?Ti.left+W:(U=!1,Ti.left)}var de=ir(m),_e=m.text.length,xe=ka(m),ze=Da(m),Oe=J(xe),Ke=U,ht=J(ze),Bt=U;if(v>ht)return Lo(C,ze,Bt,1);for(;;){if(de?ze==xe||ze==Co(m,xe,1):ze-xe<=1){var dt=v<Oe||v-Oe<=ht-v?xe:ze,Vt=dt==xe?Ke:Bt,Ut=v-(dt==xe?Oe:ht);if(Bt&&!de&&!/\s/.test(m.text.charAt(dt))&&Ut>0&&dt<m.text.length&&X.view.measure.heights.length>1){var wt=Sl(l,X,dt,"right");P<=wt.bottom&&P>=wt.top&&Math.abs(v-wt.right)<Ut&&(Vt=!1,dt++,Ut=v-wt.right)}for(;Ce(m.text.charAt(dt));)++dt;var Ht=Lo(C,dt,Vt,Ut<-1?-1:Ut>1?1:0);return Ht}var Kt=Math.ceil(_e/2),gi=xe+Kt;if(de){gi=xe;for(var Ii=0;Ii<Kt;++Ii)gi=Co(m,gi,1)}var Vi=J(gi);Vi>v?(ze=gi,ht=Vi,(Bt=U)&&(ht+=1e3),_e=Kt):(xe=gi,Oe=Vi,Ke=U,_e-=Kt)}}var Ms;function ks(l){if(l.cachedTextHeight!=null)return l.cachedTextHeight;if(Ms==null){Ms=se("pre");for(var m=0;m<49;++m)Ms.appendChild(document.createTextNode("x")),Ms.appendChild(se("br"));Ms.appendChild(document.createTextNode("x"))}Y(l.measure,Ms);var C=Ms.offsetHeight/50;return C>3&&(l.cachedTextHeight=C),q(l.measure),C||1}function Oa(l){if(l.cachedCharWidth!=null)return l.cachedCharWidth;var m=se("span","xxxxxxxxxx"),C=se("pre",[m]);Y(l.measure,C);var v=m.getBoundingClientRect(),x=(v.right-v.left)/10;return x>2&&(l.cachedCharWidth=x),x||10}function Tl(l){for(var m=l.display,C={},v={},x=m.gutters.clientLeft,P=m.gutters.firstChild,U=0;P;P=P.nextSibling,++U)C[l.options.gutters[U]]=P.offsetLeft+P.clientLeft+x,v[l.options.gutters[U]]=P.clientWidth;return{fixedPos:El(m),gutterTotalWidth:m.gutters.offsetWidth,gutterLeft:C,gutterWidth:v,wrapperWidth:m.wrapper.clientWidth}}function El(l){return l.scroller.getBoundingClientRect().left-l.sizer.getBoundingClientRect().left}function qd(l){var m=ks(l.display),C=l.options.lineWrapping,v=C&&Math.max(5,l.display.scroller.clientWidth/Oa(l.display)-3);return function(x){if(tr(l.doc,x))return 0;var P=0;if(x.widgets)for(var U=0;U<x.widgets.length;U++)x.widgets[U].height&&(P+=x.widgets[U].height);return C?P+(Math.ceil(x.text.length/v)||1)*m:P+m}}function xl(l){var m=l.doc,C=qd(l);m.iter(function(v){var x=C(v);x!=v.height&&ki(v,x)})}function Ds(l,m,C,v){var x=l.display;if(!C&&Eo(m).getAttribute("cm-not-content")=="true")return null;var P,U,W=x.lineSpace.getBoundingClientRect();try{P=m.clientX-W.left,U=m.clientY-W.top}catch{return null}var X=wl(l,P,U),J;if(v&&X.xRel==1&&(J=tt(l.doc,X.line).text).length==X.ch){var de=Ge(J,J.length,l.options.tabSize)-J.length;X=Ye(X.line,Math.max(0,Math.round((P-Ad(l.display).left)/Oa(l.display))-de))}return X}function Ls(l,m){if(m>=l.display.viewTo||(m-=l.display.viewFrom,m<0))return null;for(var C=l.display.view,v=0;v<C.length;v++)if(m-=C[v].size,m<0)return v}function Va(l){l.display.input.showSelection(l.display.input.prepareSelection())}function Kd(l,m){for(var C=l.doc,v={},x=v.cursors=document.createDocumentFragment(),P=v.selection=document.createDocumentFragment(),U=0;U<C.sel.ranges.length;U++)if(!(m===!1&&U==C.sel.primIndex)){var W=C.sel.ranges[U];if(!(W.from().line>=l.display.viewTo||W.to().line<l.display.viewFrom)){var X=W.empty();(X||l.options.showCursorWhenSelecting)&&Xd(l,W.head,x),X||Mc(l,W,P)}}return v}function Xd(l,m,C){var v=Or(l,m,"div",null,null,!l.options.singleCursorHeightPerLine),x=C.appendChild(se("div","\xA0","CodeMirror-cursor"));if(x.style.left=v.left+"px",x.style.top=v.top+"px",x.style.height=Math.max(0,v.bottom-v.top)*l.options.cursorHeight+"px",v.other){var P=C.appendChild(se("div","\xA0","CodeMirror-cursor CodeMirror-secondarycursor"));P.style.display="",P.style.left=v.other.left+"px",P.style.top=v.other.top+"px",P.style.height=(v.other.bottom-v.other.top)*.85+"px"}}function Mc(l,m,C){var v=l.display,x=l.doc,P=document.createDocumentFragment(),U=Ad(l.display),W=U.left,X=Math.max(v.sizerWidth,Rs(l)-v.sizer.offsetLeft)-U.right;function J(dt,Vt,Ut,wt){Vt<0&&(Vt=0),Vt=Math.round(Vt),wt=Math.round(wt),P.appendChild(se("div",null,"CodeMirror-selected","position: absolute; left: "+dt+`px;
                             top: `+Vt+"px; width: "+(Ut==null?X-dt:Ut)+`px;
                             height: `+(wt-Vt)+"px"))}function de(dt,Vt,Ut){var wt=tt(x,dt),Ht=wt.text.length,Kt,gi;function Ii(Vi,Qi){return Cl(l,Ye(dt,Vi),"div",wt,Qi)}return fd(ir(wt),Vt||0,Ut==null?Ht:Ut,function(Vi,Qi,Ti){var Xi=Ii(Vi,"left"),Pi,Ri,Zi;if(Vi==Qi)Pi=Xi,Ri=Zi=Xi.left;else{if(Pi=Ii(Qi-1,"right"),Ti=="rtl"){var Hn=Xi;Xi=Pi,Pi=Hn}Ri=Xi.left,Zi=Pi.right}Vt==null&&Vi==0&&(Ri=W),Pi.top-Xi.top>3&&(J(Ri,Xi.top,null,Xi.bottom),Ri=W,Xi.bottom<Pi.top&&J(Ri,Xi.bottom,null,Pi.top)),Ut==null&&Qi==Ht&&(Zi=X),(!Kt||Xi.top<Kt.top||Xi.top==Kt.top&&Xi.left<Kt.left)&&(Kt=Xi),(!gi||Pi.bottom>gi.bottom||Pi.bottom==gi.bottom&&Pi.right>gi.right)&&(gi=Pi),Ri<W+1&&(Ri=W),J(Ri,Pi.top,Zi-Ri,Pi.bottom)}),{start:Kt,end:gi}}var _e=m.from(),xe=m.to();if(_e.line==xe.line)de(_e.line,_e.ch,xe.ch);else{var ze=tt(x,_e.line),Oe=tt(x,xe.line),Ke=Jt(ze)==Jt(Oe),ht=de(_e.line,_e.ch,Ke?ze.text.length+1:null).end,Bt=de(xe.line,Ke?0:null,xe.ch).start;Ke&&(ht.top<Bt.top-2?(J(ht.right,ht.top,null,ht.bottom),J(W,Bt.top,Bt.left,Bt.bottom)):J(ht.right,ht.top,Bt.left-ht.right,ht.bottom)),ht.bottom<Bt.top&&J(W,ht.bottom,null,Bt.top)}C.appendChild(P)}function Il(l){if(!!l.state.focused){var m=l.display;clearInterval(m.blinker);var C=!0;m.cursorDiv.style.visibility="",l.options.cursorBlinkRate>0?m.blinker=setInterval(function(){return m.cursorDiv.style.visibility=(C=!C)?"":"hidden"},l.options.cursorBlinkRate):l.options.cursorBlinkRate<0&&(m.cursorDiv.style.visibility="hidden")}}function Yd(l){l.state.focused||(l.display.input.focus(),Rl(l))}function kc(l){l.state.delayingBlurEvent=!0,setTimeout(function(){l.state.delayingBlurEvent&&(l.state.delayingBlurEvent=!1,Ua(l))},100)}function Rl(l,m){l.state.delayingBlurEvent&&(l.state.delayingBlurEvent=!1),l.options.readOnly!="nocursor"&&(l.state.focused||(Oi(l,"focus",l,m),l.state.focused=!0,ve(l.display.wrapper,"CodeMirror-focused"),!l.curOp&&l.display.selForContextMenu!=l.doc.sel&&(l.display.input.reset(),d&&setTimeout(function(){return l.display.input.reset(!0)},20)),l.display.input.receivedFocus()),Il(l))}function Ua(l,m){l.state.delayingBlurEvent||(l.state.focused&&(Oi(l,"blur",l,m),l.state.focused=!1,K(l.display.wrapper,"CodeMirror-focused")),clearInterval(l.display.blinker),setTimeout(function(){l.state.focused||(l.display.shift=!1)},150))}function Ml(l){var m=l.display,C=m.view;if(!(!m.alignWidgets&&(!m.gutters.firstChild||!l.options.fixedGutter))){for(var v=El(m)-m.scroller.scrollLeft+l.doc.scrollLeft,x=m.gutters.offsetWidth,P=v+"px",U=0;U<C.length;U++)if(!C[U].hidden){l.options.fixedGutter&&(C[U].gutter&&(C[U].gutter.style.left=P),C[U].gutterBackground&&(C[U].gutterBackground.style.left=P));var W=C[U].alignable;if(W)for(var X=0;X<W.length;X++)W[X].style.left=P}l.options.fixedGutter&&(m.gutters.style.left=v+x+"px")}}function Jd(l){if(!l.options.lineNumbers)return!1;var m=l.doc,C=cr(l.options,m.first+m.size-1),v=l.display;if(C.length!=v.lineNumChars){var x=v.measure.appendChild(se("div",[se("div",C)],"CodeMirror-linenumber CodeMirror-gutter-elt")),P=x.firstChild.offsetWidth,U=x.offsetWidth-P;return v.lineGutter.style.width="",v.lineNumInnerWidth=Math.max(P,v.lineGutter.offsetWidth-U)+1,v.lineNumWidth=v.lineNumInnerWidth+U,v.lineNumChars=v.lineNumInnerWidth?C.length:-1,v.lineGutter.style.width=v.lineNumWidth+"px",Vr(l),!0}return!1}function No(l){for(var m=l.display,C=m.lineDiv.offsetTop,v=0;v<m.view.length;v++){var x=m.view[v],P=void 0;if(!x.hidden){if(s&&a<8){var U=x.node.offsetTop+x.node.offsetHeight;P=U-C,C=U}else{var W=x.node.getBoundingClientRect();P=W.bottom-W.top}var X=x.line.height-P;if(P<2&&(P=ks(m)),(X>.001||X<-.001)&&(ki(x.line,P),$d(x.line),x.rest))for(var J=0;J<x.rest.length;J++)$d(x.rest[J])}}}function $d(l){if(l.widgets)for(var m=0;m<l.widgets.length;++m)l.widgets[m].height=l.widgets[m].node.parentNode.offsetHeight}function kl(l,m,C){var v=C&&C.top!=null?Math.max(0,C.top):l.scroller.scrollTop;v=Math.floor(v-Do(l));var x=C&&C.bottom!=null?C.bottom:v+l.wrapper.clientHeight,P=On(m,v),U=On(m,x);if(C&&C.ensure){var W=C.ensure.from.line,X=C.ensure.to.line;W<P?(P=W,U=On(m,ur(tt(m,W))+l.wrapper.clientHeight)):Math.min(X,m.lastLine())>=U&&(P=On(m,ur(tt(m,X))-l.wrapper.clientHeight),U=X)}return{from:P,to:Math.max(U,P+1)}}function za(l,m){Math.abs(l.doc.scrollTop-m)<2||(l.doc.scrollTop=m,t||Tt(l,{top:m}),l.display.scroller.scrollTop!=m&&(l.display.scroller.scrollTop=m),l.display.scrollbars.setScrollTop(m),t&&Tt(l),pr(l,100))}function ia(l,m,C){(C?m==l.doc.scrollLeft:Math.abs(l.doc.scrollLeft-m)<2)||(m=Math.min(m,l.display.scroller.scrollWidth-l.display.scroller.clientWidth),l.doc.scrollLeft=m,Ml(l),l.display.scroller.scrollLeft!=m&&(l.display.scroller.scrollLeft=m),l.display.scrollbars.setScrollLeft(m))}var Po=0,$n=null;s?$n=-.53:t?$n=15:f?$n=-.7:b&&($n=-1/3);function Qd(l){var m=l.wheelDeltaX,C=l.wheelDeltaY;return m==null&&l.detail&&l.axis==l.HORIZONTAL_AXIS&&(m=l.detail),C==null&&l.detail&&l.axis==l.VERTICAL_AXIS?C=l.detail:C==null&&(C=l.wheelDelta),{x:m,y:C}}function Dc(l){var m=Qd(l);return m.x*=$n,m.y*=$n,m}function Zd(l,m){var C=Qd(m),v=C.x,x=C.y,P=l.display,U=P.scroller,W=U.scrollWidth>U.clientWidth,X=U.scrollHeight>U.clientHeight;if(!!(v&&W||x&&X)){if(x&&R&&d){e:for(var J=m.target,de=P.view;J!=U;J=J.parentNode)for(var _e=0;_e<de.length;_e++)if(de[_e].node==J){l.display.currentWheelTarget=J;break e}}if(v&&!t&&!_&&$n!=null){x&&X&&za(l,Math.max(0,Math.min(U.scrollTop+x*$n,U.scrollHeight-U.clientHeight))),ia(l,Math.max(0,Math.min(U.scrollLeft+v*$n,U.scrollWidth-U.clientWidth))),(!x||x&&X)&&un(m),P.wheelStartX=null;return}if(x&&$n!=null){var xe=x*$n,ze=l.doc.scrollTop,Oe=ze+P.wrapper.clientHeight;xe<0?ze=Math.max(0,ze+xe-50):Oe=Math.min(l.doc.height,Oe+xe+50),Tt(l,{top:ze,bottom:Oe})}Po<20&&(P.wheelStartX==null?(P.wheelStartX=U.scrollLeft,P.wheelStartY=U.scrollTop,P.wheelDX=v,P.wheelDY=x,setTimeout(function(){if(P.wheelStartX!=null){var Ke=U.scrollLeft-P.wheelStartX,ht=U.scrollTop-P.wheelStartY,Bt=ht&&P.wheelDY&&ht/P.wheelDY||Ke&&P.wheelDX&&Ke/P.wheelDX;P.wheelStartX=P.wheelStartY=null,Bt&&($n=($n*Po+Bt)/(Po+1),++Po)}},200)):(P.wheelDX+=v,P.wheelDY+=x))}}function Ga(l){var m=l.display,C=m.gutters.offsetWidth,v=Math.round(l.doc.height+gl(l.display));return{clientHeight:m.scroller.clientHeight,viewHeight:m.wrapper.clientHeight,scrollWidth:m.scroller.scrollWidth,clientWidth:m.scroller.clientWidth,viewWidth:m.wrapper.clientWidth,barLeft:l.options.fixedGutter?C:0,docHeight:v,scrollHeight:v+xr(l)+m.barHeight,nativeBarWidth:m.nativeBarWidth,gutterWidth:C}}var Ns=function(l,m,C){this.cm=C;var v=this.vert=se("div",[se("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),x=this.horiz=se("div",[se("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");l(v),l(x),qt(v,"scroll",function(){v.clientHeight&&m(v.scrollTop,"vertical")}),qt(x,"scroll",function(){x.clientWidth&&m(x.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,s&&a<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};Ns.prototype.update=function(l){var m=l.scrollWidth>l.clientWidth+1,C=l.scrollHeight>l.clientHeight+1,v=l.nativeBarWidth;if(C){this.vert.style.display="block",this.vert.style.bottom=m?v+"px":"0";var x=l.viewHeight-(m?v:0);this.vert.firstChild.style.height=Math.max(0,l.scrollHeight-l.clientHeight+x)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(m){this.horiz.style.display="block",this.horiz.style.right=C?v+"px":"0",this.horiz.style.left=l.barLeft+"px";var P=l.viewWidth-l.barLeft-(C?v:0);this.horiz.firstChild.style.width=l.scrollWidth-l.clientWidth+P+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&l.clientHeight>0&&(v==0&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:C?v:0,bottom:m?v:0}},Ns.prototype.setScrollLeft=function(l){this.horiz.scrollLeft!=l&&(this.horiz.scrollLeft=l),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz)},Ns.prototype.setScrollTop=function(l){this.vert.scrollTop!=l&&(this.vert.scrollTop=l),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert)},Ns.prototype.zeroWidthHack=function(){var l=R&&!w?"12px":"18px";this.horiz.style.height=this.vert.style.width=l,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new it,this.disableVert=new it},Ns.prototype.enableZeroWidthBar=function(l,m){l.style.pointerEvents="auto";function C(){var v=l.getBoundingClientRect(),x=document.elementFromPoint(v.left+1,v.bottom-1);x!=l?l.style.pointerEvents="none":m.set(1e3,C)}m.set(1e3,C)},Ns.prototype.clear=function(){var l=this.horiz.parentNode;l.removeChild(this.horiz),l.removeChild(this.vert)};var Ha=function(){};Ha.prototype.update=function(){return{bottom:0,right:0}},Ha.prototype.setScrollLeft=function(){},Ha.prototype.setScrollTop=function(){},Ha.prototype.clear=function(){};function na(l,m){m||(m=Ga(l));var C=l.display.barWidth,v=l.display.barHeight;eh(l,m);for(var x=0;x<4&&C!=l.display.barWidth||v!=l.display.barHeight;x++)C!=l.display.barWidth&&l.options.lineWrapping&&No(l),eh(l,Ga(l)),C=l.display.barWidth,v=l.display.barHeight}function eh(l,m){var C=l.display,v=C.scrollbars.update(m);C.sizer.style.paddingRight=(C.barWidth=v.right)+"px",C.sizer.style.paddingBottom=(C.barHeight=v.bottom)+"px",C.heightForcer.style.borderBottom=v.bottom+"px solid transparent",v.right&&v.bottom?(C.scrollbarFiller.style.display="block",C.scrollbarFiller.style.height=v.bottom+"px",C.scrollbarFiller.style.width=v.right+"px"):C.scrollbarFiller.style.display="",v.bottom&&l.options.coverGutterNextToScrollbar&&l.options.fixedGutter?(C.gutterFiller.style.display="block",C.gutterFiller.style.height=v.bottom+"px",C.gutterFiller.style.width=m.gutterWidth+"px"):C.gutterFiller.style.display=""}var th={native:Ns,null:Ha};function ih(l){l.display.scrollbars&&(l.display.scrollbars.clear(),l.display.scrollbars.addClass&&K(l.display.wrapper,l.display.scrollbars.addClass)),l.display.scrollbars=new th[l.options.scrollbarStyle](function(m){l.display.wrapper.insertBefore(m,l.display.scrollbarFiller),qt(m,"mousedown",function(){l.state.focused&&setTimeout(function(){return l.display.input.focus()},0)}),m.setAttribute("cm-not-content","true")},function(m,C){C=="horizontal"?ia(l,m):za(l,m)},l),l.display.scrollbars.addClass&&ve(l.display.wrapper,l.display.scrollbars.addClass)}function Lc(l,m){if(!Ji(l,"scrollCursorIntoView")){var C=l.display,v=C.sizer.getBoundingClientRect(),x=null;if(m.top+v.top<0?x=!0:m.bottom+v.top>(window.innerHeight||document.documentElement.clientHeight)&&(x=!1),x!=null&&!S){var P=se("div","\u200B",null,`position: absolute;
                         top: `+(m.top-C.viewOffset-Do(l.display))+`px;
                         height: `+(m.bottom-m.top+xr(l)+C.barHeight)+`px;
                         left: `+m.left+"px; width: 2px;");l.display.lineSpace.appendChild(P),P.scrollIntoView(x),l.display.lineSpace.removeChild(P)}}}function Nc(l,m,C,v){v==null&&(v=0);for(var x,P=0;P<5;P++){var U=!1;x=Or(l,m);var W=!C||C==m?x:Or(l,C),X=Tn(l,Math.min(x.left,W.left),Math.min(x.top,W.top)-v,Math.max(x.left,W.left),Math.max(x.bottom,W.bottom)+v),J=l.doc.scrollTop,de=l.doc.scrollLeft;if(X.scrollTop!=null&&(za(l,X.scrollTop),Math.abs(l.doc.scrollTop-J)>1&&(U=!0)),X.scrollLeft!=null&&(ia(l,X.scrollLeft),Math.abs(l.doc.scrollLeft-de)>1&&(U=!0)),!U)break}return x}function Si(l,m,C,v,x){var P=Tn(l,m,C,v,x);P.scrollTop!=null&&za(l,P.scrollTop),P.scrollLeft!=null&&ia(l,P.scrollLeft)}function Tn(l,m,C,v,x){var P=l.display,U=ks(l.display);C<0&&(C=0);var W=l.curOp&&l.curOp.scrollTop!=null?l.curOp.scrollTop:P.scroller.scrollTop,X=_l(l),J={};x-C>X&&(x=C+X);var de=l.doc.height+gl(P),_e=C<U,xe=x>de-U;if(C<W)J.scrollTop=_e?0:C;else if(x>W+X){var ze=Math.min(C,(xe?de:x)-X);ze!=W&&(J.scrollTop=ze)}var Oe=l.curOp&&l.curOp.scrollLeft!=null?l.curOp.scrollLeft:P.scroller.scrollLeft,Ke=Rs(l)-(l.options.fixedGutter?P.gutters.offsetWidth:0),ht=v-m>Ke;return ht&&(v=m+Ke),m<10?J.scrollLeft=0:m<Oe?J.scrollLeft=Math.max(0,m-(ht?0:10)):v>Ke+Oe-3&&(J.scrollLeft=v+(ht?0:10)-Ke),J}function Dl(l,m,C){(m!=null||C!=null)&&Pt(l),m!=null&&(l.curOp.scrollLeft=(l.curOp.scrollLeft==null?l.doc.scrollLeft:l.curOp.scrollLeft)+m),C!=null&&(l.curOp.scrollTop=(l.curOp.scrollTop==null?l.doc.scrollTop:l.curOp.scrollTop)+C)}function Mt(l){Pt(l);var m=l.getCursor(),C=m,v=m;l.options.lineWrapping||(C=m.ch?Ye(m.line,m.ch-1):m,v=Ye(m.line,m.ch+1)),l.curOp.scrollToPos={from:C,to:v,margin:l.options.cursorScrollMargin,isCursor:!0}}function Pt(l){var m=l.curOp.scrollToPos;if(m){l.curOp.scrollToPos=null;var C=jd(l,m.from),v=jd(l,m.to),x=Tn(l,Math.min(C.left,v.left),Math.min(C.top,v.top)-m.margin,Math.max(C.right,v.right),Math.max(C.bottom,v.bottom)+m.margin);l.scrollTo(x.scrollLeft,x.scrollTop)}}var Ps=0;function os(l){l.curOp={cm:l,viewChanged:!1,startHeight:l.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Ps},mc(l.curOp)}function ra(l){var m=l.curOp;gc(m,function(C){for(var v=0;v<C.ops.length;v++)C.ops[v].cm.curOp=null;As(C)})}function As(l){for(var m=l.ops,C=0;C<m.length;C++)Ll(m[C]);for(var v=0;v<m.length;v++)Pc(m[v]);for(var x=0;x<m.length;x++)vt(m[x]);for(var P=0;P<m.length;P++)Ir(m[P]);for(var U=0;U<m.length;U++)sa(m[U])}function Ll(l){var m=l.cm,C=m.display;nh(m),l.updateMaxLine&&vo(m),l.mustUpdate=l.viewChanged||l.forceUpdate||l.scrollTop!=null||l.scrollToPos&&(l.scrollToPos.from.line<C.viewFrom||l.scrollToPos.to.line>=C.viewTo)||C.maxLineChanged&&m.options.lineWrapping,l.update=l.mustUpdate&&new ds(m,l.mustUpdate&&{top:l.scrollTop,ensure:l.scrollToPos},l.forceUpdate)}function Pc(l){l.updatedDisplay=l.mustUpdate&&Ao(l.cm,l.update)}function vt(l){var m=l.cm,C=m.display;l.updatedDisplay&&No(m),l.barMeasure=Ga(m),C.maxLineChanged&&!m.options.lineWrapping&&(l.adjustWidthTo=Fd(m,C.maxLine,C.maxLine.text.length).left+3,m.display.sizerWidth=l.adjustWidthTo,l.barMeasure.scrollWidth=Math.max(C.scroller.clientWidth,C.sizer.offsetLeft+l.adjustWidthTo+xr(m)+m.display.barWidth),l.maxScrollLeft=Math.max(0,C.sizer.offsetLeft+l.adjustWidthTo-Rs(m))),(l.updatedDisplay||l.selectionChanged)&&(l.preparedSelection=C.input.prepareSelection(l.focus))}function Ir(l){var m=l.cm;l.adjustWidthTo!=null&&(m.display.sizer.style.minWidth=l.adjustWidthTo+"px",l.maxScrollLeft<m.doc.scrollLeft&&ia(m,Math.min(m.display.scroller.scrollLeft,l.maxScrollLeft),!0),m.display.maxLineChanged=!1);var C=l.focus&&l.focus==te()&&(!document.hasFocus||document.hasFocus());l.preparedSelection&&m.display.input.showSelection(l.preparedSelection,C),(l.updatedDisplay||l.startHeight!=m.doc.height)&&na(m,l.barMeasure),l.updatedDisplay&&Fs(m,l.barMeasure),l.selectionChanged&&Il(m),m.state.focused&&l.updateInput&&m.display.input.reset(l.typing),C&&Yd(l.cm)}function sa(l){var m=l.cm,C=m.display,v=m.doc;if(l.updatedDisplay&&rh(m,l.update),C.wheelStartX!=null&&(l.scrollTop!=null||l.scrollLeft!=null||l.scrollToPos)&&(C.wheelStartX=C.wheelStartY=null),l.scrollTop!=null&&(C.scroller.scrollTop!=l.scrollTop||l.forceScroll)&&(v.scrollTop=Math.max(0,Math.min(C.scroller.scrollHeight-C.scroller.clientHeight,l.scrollTop)),C.scrollbars.setScrollTop(v.scrollTop),C.scroller.scrollTop=v.scrollTop),l.scrollLeft!=null&&(C.scroller.scrollLeft!=l.scrollLeft||l.forceScroll)&&(v.scrollLeft=Math.max(0,Math.min(C.scroller.scrollWidth-C.scroller.clientWidth,l.scrollLeft)),C.scrollbars.setScrollLeft(v.scrollLeft),C.scroller.scrollLeft=v.scrollLeft,Ml(m)),l.scrollToPos){var x=Nc(m,Ft(v,l.scrollToPos.from),Ft(v,l.scrollToPos.to),l.scrollToPos.margin);l.scrollToPos.isCursor&&m.state.focused&&Lc(m,x)}var P=l.maybeHiddenMarkers,U=l.maybeUnhiddenMarkers;if(P)for(var W=0;W<P.length;++W)P[W].lines.length||Oi(P[W],"hide");if(U)for(var X=0;X<U.length;++X)U[X].lines.length&&Oi(U[X],"unhide");C.wrapper.offsetHeight&&(v.scrollTop=m.display.scroller.scrollTop),l.changeObjs&&Oi(m,"changes",m,l.changeObjs),l.update&&l.update.finish()}function tn(l,m){if(l.curOp)return m();os(l);try{return m()}finally{ra(l)}}function pn(l,m){return function(){if(l.curOp)return m.apply(l,arguments);os(l);try{return m.apply(l,arguments)}finally{ra(l)}}}function xt(l){return function(){if(this.curOp)return l.apply(this,arguments);os(this);try{return l.apply(this,arguments)}finally{ra(this)}}}function At(l){return function(){var m=this.cm;if(!m||m.curOp)return l.apply(this,arguments);os(m);try{return l.apply(this,arguments)}finally{ra(m)}}}function on(l,m,C,v){m==null&&(m=l.doc.first),C==null&&(C=l.doc.first+l.doc.size),v||(v=0);var x=l.display;if(v&&C<x.viewTo&&(x.updateLineNumbers==null||x.updateLineNumbers>m)&&(x.updateLineNumbers=m),l.curOp.viewChanged=!0,m>=x.viewTo)gn&&Ki(l.doc,m)<x.viewTo&&ar(l);else if(C<=x.viewFrom)gn&&Rn(l.doc,C+v)>x.viewFrom?ar(l):(x.viewFrom+=v,x.viewTo+=v);else if(m<=x.viewFrom&&C>=x.viewTo)ar(l);else if(m<=x.viewFrom){var P=ls(l,C,C+v,1);P?(x.view=x.view.slice(P.index),x.viewFrom=P.lineN,x.viewTo+=v):ar(l)}else if(C>=x.viewTo){var U=ls(l,m,m,-1);U?(x.view=x.view.slice(0,U.index),x.viewTo=U.lineN):ar(l)}else{var W=ls(l,m,m,-1),X=ls(l,C,C+v,1);W&&X?(x.view=x.view.slice(0,W.index).concat(ko(l,W.lineN,X.lineN)).concat(x.view.slice(X.index)),x.viewTo+=v):ar(l)}var J=x.externalMeasured;J&&(C<J.lineN?J.lineN+=v:m<J.lineN+J.size&&(x.externalMeasured=null))}function sr(l,m,C){l.curOp.viewChanged=!0;var v=l.display,x=l.display.externalMeasured;if(x&&m>=x.lineN&&m<x.lineN+x.size&&(v.externalMeasured=null),!(m<v.viewFrom||m>=v.viewTo)){var P=v.view[Ls(l,m)];if(P.node!=null){var U=P.changes||(P.changes=[]);lt(U,C)==-1&&U.push(C)}}}function ar(l){l.display.viewFrom=l.display.viewTo=l.doc.first,l.display.view=[],l.display.viewOffset=0}function ls(l,m,C,v){var x=Ls(l,m),P,U=l.display.view;if(!gn||C==l.doc.first+l.doc.size)return{index:x,lineN:C};for(var W=l.display.viewFrom,X=0;X<x;X++)W+=U[X].size;if(W!=m){if(v>0){if(x==U.length-1)return null;P=W+U[x].size-m,x++}else P=W-m;m+=P,C+=P}for(;Ki(l.doc,C)!=C;){if(x==(v<0?0:U.length-1))return null;C+=v*U[x-(v<0?1:0)].size,x+=v}return{index:x,lineN:C}}function Bs(l,m,C){var v=l.display,x=v.view;x.length==0||m>=v.viewTo||C<=v.viewFrom?(v.view=ko(l,m,C),v.viewFrom=m):(v.viewFrom>m?v.view=ko(l,m,v.viewFrom).concat(v.view):v.viewFrom<m&&(v.view=v.view.slice(Ls(l,m))),v.viewFrom=m,v.viewTo<C?v.view=v.view.concat(ko(l,v.viewTo,C)):v.viewTo>C&&(v.view=v.view.slice(0,Ls(l,C)))),v.viewTo=C}function aa(l){for(var m=l.display.view,C=0,v=0;v<m.length;v++){var x=m[v];!x.hidden&&(!x.node||x.changes)&&++C}return C}function pr(l,m){l.doc.mode.startState&&l.doc.frontier<l.display.viewTo&&l.state.highlight.set(m,qe(_t,l))}function _t(l){var m=l.doc;if(m.frontier<m.first&&(m.frontier=m.first),!(m.frontier>=l.display.viewTo)){var C=+new Date+l.options.workTime,v=Nn(m.mode,as(l,m.frontier)),x=[];m.iter(m.frontier,Math.min(m.first+m.size,l.display.viewTo+500),function(P){if(m.frontier>=l.display.viewFrom){var U=P.styles,W=P.text.length>l.options.maxHighlightLength,X=nr(l,P,W?Nn(m.mode,v):v,!0);P.styles=X.styles;var J=P.styleClasses,de=X.classes;de?P.styleClasses=de:J&&(P.styleClasses=null);for(var _e=!U||U.length!=P.styles.length||J!=de&&(!J||!de||J.bgClass!=de.bgClass||J.textClass!=de.textClass),xe=0;!_e&&xe<U.length;++xe)_e=U[xe]!=P.styles[xe];_e&&x.push(m.frontier),P.stateAfter=W?v:Nn(m.mode,v)}else P.text.length<=l.options.maxHighlightLength&&pl(l,P.text,v),P.stateAfter=m.frontier%5==0?Nn(m.mode,v):null;if(++m.frontier,+new Date>C)return pr(l,l.options.workDelay),!0}),x.length&&tn(l,function(){for(var P=0;P<x.length;P++)sr(l,x[P],"text")})}}var ds=function(l,m,C){var v=l.display;this.viewport=m,this.visible=kl(v,l.doc,m),this.editorIsHidden=!v.wrapper.offsetWidth,this.wrapperHeight=v.wrapper.clientHeight,this.wrapperWidth=v.wrapper.clientWidth,this.oldDisplayWidth=Rs(l),this.force=C,this.dims=Tl(l),this.events=[]};ds.prototype.signal=function(l,m){_n(l,m)&&this.events.push(arguments)},ds.prototype.finish=function(){for(var l=this,m=0;m<this.events.length;m++)Oi.apply(null,l.events[m])};function nh(l){var m=l.display;!m.scrollbarsClipped&&m.scroller.offsetWidth&&(m.nativeBarWidth=m.scroller.offsetWidth-m.scroller.clientWidth,m.heightForcer.style.height=xr(l)+"px",m.sizer.style.marginBottom=-m.nativeBarWidth+"px",m.sizer.style.borderRightWidth=xr(l)+"px",m.scrollbarsClipped=!0)}function Ao(l,m){var C=l.display,v=l.doc;if(m.editorIsHidden)return ar(l),!1;if(!m.force&&m.visible.from>=C.viewFrom&&m.visible.to<=C.viewTo&&(C.updateLineNumbers==null||C.updateLineNumbers>=C.viewTo)&&C.renderedView==C.view&&aa(l)==0)return!1;Jd(l)&&(ar(l),m.dims=Tl(l));var x=v.first+v.size,P=Math.max(m.visible.from-l.options.viewportMargin,v.first),U=Math.min(x,m.visible.to+l.options.viewportMargin);C.viewFrom<P&&P-C.viewFrom<20&&(P=Math.max(v.first,C.viewFrom)),C.viewTo>U&&C.viewTo-U<20&&(U=Math.min(x,C.viewTo)),gn&&(P=Ki(l.doc,P),U=Rn(l.doc,U));var W=P!=C.viewFrom||U!=C.viewTo||C.lastWrapHeight!=m.wrapperHeight||C.lastWrapWidth!=m.wrapperWidth;Bs(l,P,U),C.viewOffset=ur(tt(l.doc,C.viewFrom)),l.display.mover.style.top=C.viewOffset+"px";var X=aa(l);if(!W&&X==0&&!m.force&&C.renderedView==C.view&&(C.updateLineNumbers==null||C.updateLineNumbers>=C.viewTo))return!1;var J=te();return X>4&&(C.lineDiv.style.display="none"),oa(l,C.updateLineNumbers,m.dims),X>4&&(C.lineDiv.style.display=""),C.renderedView=C.view,J&&te()!=J&&J.offsetHeight&&J.focus(),q(C.cursorDiv),q(C.selectionDiv),C.gutters.style.height=C.sizer.style.minHeight=0,W&&(C.lastWrapHeight=m.wrapperHeight,C.lastWrapWidth=m.wrapperWidth,pr(l,400)),C.updateLineNumbers=null,!0}function rh(l,m){for(var C=m.viewport,v=!0;!((!v||!l.options.lineWrapping||m.oldDisplayWidth==Rs(l))&&(C&&C.top!=null&&(C={top:Math.min(l.doc.height+gl(l.display)-_l(l),C.top)}),m.visible=kl(l.display,l.doc,C),m.visible.from>=l.display.viewFrom&&m.visible.to<=l.display.viewTo)||!Ao(l,m));v=!1){No(l);var x=Ga(l);Va(l),na(l,x),Fs(l,x)}m.signal(l,"update",l),(l.display.viewFrom!=l.display.reportedViewFrom||l.display.viewTo!=l.display.reportedViewTo)&&(m.signal(l,"viewportChange",l,l.display.viewFrom,l.display.viewTo),l.display.reportedViewFrom=l.display.viewFrom,l.display.reportedViewTo=l.display.viewTo)}function Tt(l,m){var C=new ds(l,m);if(Ao(l,C)){No(l),rh(l,C);var v=Ga(l);Va(l),na(l,v),Fs(l,v),C.finish()}}function oa(l,m,C){var v=l.display,x=l.options.lineNumbers,P=v.lineDiv,U=P.firstChild;function W(Oe){var Ke=Oe.nextSibling;return d&&R&&l.display.currentWheelTarget==Oe?Oe.style.display="none":Oe.parentNode.removeChild(Oe),Ke}for(var X=v.view,J=v.viewFrom,de=0;de<X.length;de++){var _e=X[de];if(!_e.hidden)if(!_e.node||_e.node.parentNode!=P){var xe=bc(l,_e,J,C);P.insertBefore(xe,U)}else{for(;U!=_e.node;)U=W(U);var ze=x&&m!=null&&m<=J&&_e.lineNumber;_e.changes&&(lt(_e.changes,"gutter")>-1&&(ze=!1),kd(l,_e,J,C)),ze&&(q(_e.lineNumber),_e.lineNumber.appendChild(document.createTextNode(cr(l.options,J)))),U=_e.node.nextSibling}J+=_e.size}for(;U;)U=W(U)}function Vr(l){var m=l.display.gutters.offsetWidth;l.display.sizer.style.marginLeft=m+"px"}function Fs(l,m){l.display.sizer.style.minHeight=m.docHeight+"px",l.display.heightForcer.style.top=m.docHeight+"px",l.display.gutters.style.height=m.docHeight+l.display.barHeight+xr(l)+"px"}function hs(l){var m=l.display.gutters,C=l.options.gutters;q(m);for(var v=0;v<C.length;++v){var x=C[v],P=m.appendChild(se("div",null,"CodeMirror-gutter "+x));x=="CodeMirror-linenumbers"&&(l.display.lineGutter=P,P.style.width=(l.display.lineNumWidth||1)+"px")}m.style.display=v?"":"none",Vr(l)}function Nl(l){var m=lt(l.gutters,"CodeMirror-linenumbers");m==-1&&l.lineNumbers?l.gutters=l.gutters.concat(["CodeMirror-linenumbers"]):m>-1&&!l.lineNumbers&&(l.gutters=l.gutters.slice(0),l.gutters.splice(m,1))}function Xt(l,m){this.ranges=l,this.primIndex=m}Xt.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(l){var m=this;if(l==this)return!0;if(l.primIndex!=this.primIndex||l.ranges.length!=this.ranges.length)return!1;for(var C=0;C<this.ranges.length;C++){var v=m.ranges[C],x=l.ranges[C];if(Rt(v.anchor,x.anchor)!=0||Rt(v.head,x.head)!=0)return!1}return!0},deepCopy:function(){for(var l=this,m=[],C=0;C<this.ranges.length;C++)m[C]=new ai(xi(l.ranges[C].anchor),xi(l.ranges[C].head));return new Xt(m,this.primIndex)},somethingSelected:function(){for(var l=this,m=0;m<this.ranges.length;m++)if(!l.ranges[m].empty())return!0;return!1},contains:function(l,m){var C=this;m||(m=l);for(var v=0;v<this.ranges.length;v++){var x=C.ranges[v];if(Rt(m,x.from())>=0&&Rt(l,x.to())<=0)return v}return-1}};function ai(l,m){this.anchor=l,this.head=m}ai.prototype={from:function(){return Hi(this.anchor,this.head)},to:function(){return Vn(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};function $i(l,m){var C=l[m];l.sort(function(J,de){return Rt(J.from(),de.from())}),m=lt(l,C);for(var v=1;v<l.length;v++){var x=l[v],P=l[v-1];if(Rt(P.to(),x.from())>=0){var U=Hi(P.from(),x.from()),W=Vn(P.to(),x.to()),X=P.empty()?x.from()==x.head:P.from()==P.head;v<=m&&--m,l.splice(--v,2,new ai(X?W:U,X?U:W))}}return new Xt(l,m)}function zn(l,m){return new Xt([new ai(l,m||l)],0)}function Qn(l){return l.text?Ye(l.from.line+l.text.length-1,Xe(l.text).length+(l.text.length==1?l.from.ch:0)):l.to}function Gn(l,m){if(Rt(l,m.from)<0)return l;if(Rt(l,m.to)<=0)return Qn(m);var C=l.line+m.text.length-(m.to.line-m.from.line)-1,v=l.ch;return l.line==m.to.line&&(v+=Qn(m).ch-m.to.ch),Ye(C,v)}function Mn(l,m){for(var C=[],v=0;v<l.sel.ranges.length;v++){var x=l.sel.ranges[v];C.push(new ai(Gn(x.anchor,m),Gn(x.head,m)))}return $i(C,l.sel.primIndex)}function sh(l,m,C){return l.line==m.line?Ye(C.line,l.ch-m.ch+C.ch):Ye(C.line+(l.line-m.line),l.ch)}function Ac(l,m,C){for(var v=[],x=Ye(l.first,0),P=x,U=0;U<m.length;U++){var W=m[U],X=sh(W.from,x,P),J=sh(Qn(W),x,P);if(x=W.to,P=J,C=="around"){var de=l.sel.ranges[U],_e=Rt(de.head,de.anchor)<0;v[U]=new ai(_e?J:X,_e?X:J)}else v[U]=new ai(X,X)}return new Xt(v,l.sel.primIndex)}function Pl(l){l.doc.mode=ul(l.options,l.doc.modeOption),Wa(l)}function Wa(l){l.doc.iter(function(m){m.stateAfter&&(m.stateAfter=null),m.styles&&(m.styles=null)}),l.doc.frontier=l.doc.first,pr(l,100),l.state.modeGen++,l.curOp&&on(l)}function ah(l,m){return m.from.ch==0&&m.to.ch==0&&Xe(m.text)==""&&(!l.cm||l.cm.options.wholeLineUpdateBefore)}function Al(l,m,C,v){function x(dt){return C?C[dt]:null}function P(dt,Vt,Ut){sc(dt,Vt,Ut,v),Un(dt,"change",dt,m)}function U(dt,Vt){for(var Ut=[],wt=dt;wt<Vt;++wt)Ut.push(new ea(J[wt],x(wt),v));return Ut}var W=m.from,X=m.to,J=m.text,de=tt(l,W.line),_e=tt(l,X.line),xe=Xe(J),ze=x(J.length-1),Oe=X.line-W.line;if(m.full)l.insert(0,U(0,J.length)),l.remove(J.length,l.size-J.length);else if(ah(l,m)){var Ke=U(0,J.length-1);P(_e,_e.text,ze),Oe&&l.remove(W.line,Oe),Ke.length&&l.insert(W.line,Ke)}else if(de==_e)if(J.length==1)P(de,de.text.slice(0,W.ch)+xe+de.text.slice(X.ch),ze);else{var ht=U(1,J.length-1);ht.push(new ea(xe+de.text.slice(X.ch),ze,v)),P(de,de.text.slice(0,W.ch)+J[0],x(0)),l.insert(W.line+1,ht)}else if(J.length==1)P(de,de.text.slice(0,W.ch)+J[0]+_e.text.slice(X.ch),x(0)),l.remove(W.line+1,Oe);else{P(de,de.text.slice(0,W.ch)+J[0],x(0)),P(_e,xe+_e.text.slice(X.ch),ze);var Bt=U(1,J.length-1);Oe>1&&l.remove(W.line+1,Oe-1),l.insert(W.line+1,Bt)}Un(l,"change",l,m)}function Os(l,m,C){function v(x,P,U){if(x.linked)for(var W=0;W<x.linked.length;++W){var X=x.linked[W];if(X.doc!=P){var J=U&&X.sharedHist;C&&!J||(m(X.doc,J),v(X.doc,x,J))}}}v(l,null,!0)}function oh(l,m){if(m.cm)throw new Error("This document is already in use.");l.doc=m,m.cm=l,xl(l),Pl(l),l.options.lineWrapping||vo(l),l.options.mode=m.modeOption,on(l)}function Bo(l){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=l||1}function Bl(l,m){var C={from:xi(m.from),to:Qn(m),text:yi(l,m.from,m.to)};return Ol(l,C,m.from.line,m.to.line+1),Os(l,function(v){return Ol(v,C,m.from.line,m.to.line+1)},!0),C}function lh(l){for(;l.length;){var m=Xe(l);if(m.ranges)l.pop();else break}}function Ur(l,m){if(m)return lh(l.done),Xe(l.done);if(l.done.length&&!Xe(l.done).ranges)return Xe(l.done);if(l.done.length>1&&!l.done[l.done.length-2].ranges)return l.done.pop(),Xe(l.done)}function Fl(l,m,C,v){var x=l.history;x.undone.length=0;var P=+new Date,U,W;if((x.lastOp==v||x.lastOrigin==m.origin&&m.origin&&(m.origin.charAt(0)=="+"&&l.cm&&x.lastModTime>P-l.cm.options.historyEventDelay||m.origin.charAt(0)=="*"))&&(U=Ur(x,x.lastOp==v)))W=Xe(U.changes),Rt(m.from,m.to)==0&&Rt(m.from,W.to)==0?W.to=Qn(m):U.changes.push(Bl(l,m));else{var X=Xe(x.done);for((!X||!X.ranges)&&ja(l.sel,x.done),U={changes:[Bl(l,m)],generation:x.generation},x.done.push(U);x.done.length>x.undoDepth;)x.done.shift(),x.done[0].ranges||x.done.shift()}x.done.push(C),x.generation=++x.maxGeneration,x.lastModTime=x.lastSelTime=P,x.lastOp=x.lastSelOp=v,x.lastOrigin=x.lastSelOrigin=m.origin,W||Oi(l,"historyAdded")}function dh(l,m,C,v){var x=m.charAt(0);return x=="*"||x=="+"&&C.ranges.length==v.ranges.length&&C.somethingSelected()==v.somethingSelected()&&new Date-l.history.lastSelTime<=(l.cm?l.cm.options.historyEventDelay:500)}function hh(l,m,C,v){var x=l.history,P=v&&v.origin;C==x.lastSelOp||P&&x.lastSelOrigin==P&&(x.lastModTime==x.lastSelTime&&x.lastOrigin==P||dh(l,P,Xe(x.done),m))?x.done[x.done.length-1]=m:ja(m,x.done),x.lastSelTime=+new Date,x.lastSelOrigin=P,x.lastSelOp=C,v&&v.clearRedo!==!1&&lh(x.undone)}function ja(l,m){var C=Xe(m);C&&C.ranges&&C.equals(l)||m.push(l)}function Ol(l,m,C,v){var x=m["spans_"+l.id],P=0;l.iter(Math.max(l.first,C),Math.min(l.first+l.size,v),function(U){U.markedSpans&&((x||(x=m["spans_"+l.id]={}))[P]=U.markedSpans),++P})}function ch(l){if(!l)return null;for(var m,C=0;C<l.length;++C)l[C].marker.explicitlyCleared?m||(m=l.slice(0,C)):m&&m.push(l[C]);return m?m.length?m:null:l}function uh(l,m){var C=m["spans_"+l.id];if(!C)return null;for(var v=[],x=0;x<m.text.length;++x)v.push(ch(C[x]));return v}function Vl(l,m){var C=uh(l,m),v=is(l,m);if(!C)return v;if(!v)return C;for(var x=0;x<C.length;++x){var P=C[x],U=v[x];if(P&&U){e:for(var W=0;W<U.length;++W){for(var X=U[W],J=0;J<P.length;++J)if(P[J].marker==X.marker)continue e;P.push(X)}}else U&&(C[x]=U)}return C}function mr(l,m,C){for(var v=[],x=0;x<l.length;++x){var P=l[x];if(P.ranges){v.push(C?Xt.prototype.deepCopy.call(P):P);continue}var U=P.changes,W=[];v.push({changes:W});for(var X=0;X<U.length;++X){var J=U[X],de=void 0;if(W.push({from:J.from,to:J.to,text:J.text}),m)for(var _e in J)(de=_e.match(/^spans_(\d+)$/))&&lt(m,Number(de[1]))>-1&&(Xe(W)[_e]=J[_e],delete J[_e])}}return v}function Ai(l,m,C,v){if(l.cm&&l.cm.display.shift||l.extend){var x=m.anchor;if(v){var P=Rt(C,x)<0;P!=Rt(v,x)<0?(x=C,C=v):P!=Rt(C,v)<0&&(C=v)}return new ai(x,C)}else return new ai(v||C,C)}function ln(l,m,C,v){En(l,new Xt([Ai(l,l.sel.primary(),m,C)],0),v)}function Ul(l,m,C){for(var v=[],x=0;x<l.sel.ranges.length;x++)v[x]=Ai(l,l.sel.ranges[x],m[x],null);var P=$i(v,l.sel.primIndex);En(l,P,C)}function zl(l,m,C,v){var x=l.sel.ranges.slice(0);x[m]=C,En(l,$i(x,l.sel.primIndex),v)}function ph(l,m,C,v){En(l,zn(m,C),v)}function Bc(l,m,C){var v={ranges:m.ranges,update:function(x){var P=this;this.ranges=[];for(var U=0;U<x.length;U++)P.ranges[U]=new ai(Ft(l,x[U].anchor),Ft(l,x[U].head))},origin:C&&C.origin};return Oi(l,"beforeSelectionChange",l,v),l.cm&&Oi(l.cm,"beforeSelectionChange",l.cm,v),v.ranges!=m.ranges?$i(v.ranges,v.ranges.length-1):m}function mh(l,m,C){var v=l.history.done,x=Xe(v);x&&x.ranges?(v[v.length-1]=m,Fo(l,m,C)):En(l,m,C)}function En(l,m,C){Fo(l,m,C),hh(l,l.sel,l.cm?l.cm.curOp.id:NaN,C)}function Fo(l,m,C){(_n(l,"beforeSelectionChange")||l.cm&&_n(l.cm,"beforeSelectionChange"))&&(m=Bc(l,m,C));var v=C&&C.bias||(Rt(m.primary().head,l.sel.primary().head)<0?-1:1);fh(l,_h(l,m,v,!0)),!(C&&C.scroll===!1)&&l.cm&&Mt(l.cm)}function fh(l,m){m.equals(l.sel)||(l.sel=m,l.cm&&(l.cm.curOp.updateInput=l.cm.curOp.selectionChanged=!0,ns(l.cm)),Un(l,"cursorActivity",l))}function gh(l){fh(l,_h(l,l.sel,null,!1),ni)}function _h(l,m,C,v){for(var x,P=0;P<m.ranges.length;P++){var U=m.ranges[P],W=m.ranges.length==l.sel.ranges.length&&l.sel.ranges[P],X=Oo(l,U.anchor,W&&W.anchor,C,v),J=Oo(l,U.head,W&&W.head,C,v);(x||X!=U.anchor||J!=U.head)&&(x||(x=m.ranges.slice(0,P)),x[P]=new ai(X,J))}return x?$i(x,m.primIndex):m}function la(l,m,C,v,x){var P=tt(l,m.line);if(P.markedSpans)for(var U=0;U<P.markedSpans.length;++U){var W=P.markedSpans[U],X=W.marker;if((W.from==null||(X.inclusiveLeft?W.from<=m.ch:W.from<m.ch))&&(W.to==null||(X.inclusiveRight?W.to>=m.ch:W.to>m.ch))){if(x&&(Oi(X,"beforeCursorEnter"),X.explicitlyCleared))if(P.markedSpans){--U;continue}else break;if(!X.atomic)continue;if(C){var J=X.find(v<0?1:-1),de=void 0;if((v<0?X.inclusiveRight:X.inclusiveLeft)&&(J=Gl(l,J,-v,J&&J.line==m.line?P:null)),J&&J.line==m.line&&(de=Rt(J,C))&&(v<0?de<0:de>0))return la(l,J,m,v,x)}var _e=X.find(v<0?-1:1);return(v<0?X.inclusiveLeft:X.inclusiveRight)&&(_e=Gl(l,_e,v,_e.line==m.line?P:null)),_e?la(l,_e,m,v,x):null}}return m}function Oo(l,m,C,v,x){var P=v||1,U=la(l,m,C,P,x)||!x&&la(l,m,C,P,!0)||la(l,m,C,-P,x)||!x&&la(l,m,C,-P,!0);return U||(l.cantEdit=!0,Ye(l.first,0))}function Gl(l,m,C,v){return C<0&&m.ch==0?m.line>l.first?Ft(l,Ye(m.line-1)):null:C>0&&m.ch==(v||tt(l,m.line)).text.length?m.line<l.first+l.size-1?Ye(m.line+1,0):null:new Ye(m.line,m.ch+C)}function Hl(l){l.setSelection(Ye(l.firstLine(),0),Ye(l.lastLine()),ni)}function vh(l,m,C){var v={canceled:!1,from:m.from,to:m.to,text:m.text,origin:m.origin,cancel:function(){return v.canceled=!0}};return C&&(v.update=function(x,P,U,W){x&&(v.from=Ft(l,x)),P&&(v.to=Ft(l,P)),U&&(v.text=U),W!==void 0&&(v.origin=W)}),Oi(l,"beforeChange",l,v),l.cm&&Oi(l.cm,"beforeChange",l.cm,v),v.canceled?null:{from:v.from,to:v.to,text:v.text,origin:v.origin}}function da(l,m,C){if(l.cm){if(!l.cm.curOp)return pn(l.cm,da)(l,m,C);if(l.cm.state.suppressEdits)return}if(!((_n(l,"beforeChange")||l.cm&&_n(l.cm,"beforeChange"))&&(m=vh(l,m,!0),!m))){var v=wr&&!C&&Ar(l,m.from,m.to);if(v)for(var x=v.length-1;x>=0;--x)yh(l,{from:v[x].from,to:v[x].to,text:x?[""]:m.text});else yh(l,m)}}function yh(l,m){if(!(m.text.length==1&&m.text[0]==""&&Rt(m.from,m.to)==0)){var C=Mn(l,m);Fl(l,m,C,l.cm?l.cm.curOp.id:NaN),qa(l,m,C,is(l,m));var v=[];Os(l,function(x,P){!P&&lt(v,x.history)==-1&&(wh(x.history,m),v.push(x.history)),qa(x,m,null,is(x,m))})}}function Vo(l,m,C){if(!(l.cm&&l.cm.state.suppressEdits&&!C)){for(var v=l.history,x,P=l.sel,U=m=="undo"?v.done:v.undone,W=m=="undo"?v.undone:v.done,X=0;X<U.length&&(x=U[X],!(C?x.ranges&&!x.equals(l.sel):!x.ranges));X++);if(X!=U.length){for(v.lastOrigin=v.lastSelOrigin=null;x=U.pop(),x.ranges;){if(ja(x,W),C&&!x.equals(l.sel)){En(l,x,{clearRedo:!1});return}P=x}var J=[];ja(P,W),W.push({changes:J,generation:v.generation}),v.generation=x.generation||++v.maxGeneration;for(var de=_n(l,"beforeChange")||l.cm&&_n(l.cm,"beforeChange"),_e=function(Oe){var Ke=x.changes[Oe];if(Ke.origin=m,de&&!vh(l,Ke,!1))return U.length=0,{};J.push(Bl(l,Ke));var ht=Oe?Mn(l,Ke):Xe(U);qa(l,Ke,ht,Vl(l,Ke)),!Oe&&l.cm&&l.cm.scrollIntoView({from:Ke.from,to:Qn(Ke)});var Bt=[];Os(l,function(dt,Vt){!Vt&&lt(Bt,dt.history)==-1&&(wh(dt.history,Ke),Bt.push(dt.history)),qa(dt,Ke,null,Vl(dt,Ke))})},xe=x.changes.length-1;xe>=0;--xe){var ze=_e(xe);if(ze)return ze.v}}}}function Sh(l,m){if(m!=0&&(l.first+=m,l.sel=new Xt(bi(l.sel.ranges,function(x){return new ai(Ye(x.anchor.line+m,x.anchor.ch),Ye(x.head.line+m,x.head.ch))}),l.sel.primIndex),l.cm)){on(l.cm,l.first,l.first-m,m);for(var C=l.cm.display,v=C.viewFrom;v<C.viewTo;v++)sr(l.cm,v,"gutter")}}function qa(l,m,C,v){if(l.cm&&!l.cm.curOp)return pn(l.cm,qa)(l,m,C,v);if(m.to.line<l.first){Sh(l,m.text.length-1-(m.to.line-m.from.line));return}if(!(m.from.line>l.lastLine())){if(m.from.line<l.first){var x=m.text.length-1-(l.first-m.from.line);Sh(l,x),m={from:Ye(l.first,0),to:Ye(m.to.line+x,m.to.ch),text:[Xe(m.text)],origin:m.origin}}var P=l.lastLine();m.to.line>P&&(m={from:m.from,to:Ye(P,tt(l,P).text.length),text:[m.text[0]],origin:m.origin}),m.removed=yi(l,m.from,m.to),C||(C=Mn(l,m)),l.cm?Fc(l.cm,m,v):Al(l,m,v),Fo(l,C,ni)}}function Fc(l,m,C){var v=l.doc,x=l.display,P=m.from,U=m.to,W=!1,X=P.line;l.options.lineWrapping||(X=ti(Jt(tt(v,P.line))),v.iter(X,U.line+1,function(ze){if(ze==x.maxLine)return W=!0,!0})),v.sel.contains(m.from,m.to)>-1&&ns(l),Al(v,m,C,qd(l)),l.options.lineWrapping||(v.iter(X,P.line+m.text.length,function(ze){var Oe=Ma(ze);Oe>x.maxLineLength&&(x.maxLine=ze,x.maxLineLength=Oe,x.maxLineChanged=!0,W=!1)}),W&&(l.curOp.updateMaxLine=!0)),v.frontier=Math.min(v.frontier,P.line),pr(l,400);var J=m.text.length-(U.line-P.line)-1;m.full?on(l):P.line==U.line&&m.text.length==1&&!ah(l.doc,m)?sr(l,P.line,"text"):on(l,P.line,U.line+1,J);var de=_n(l,"changes"),_e=_n(l,"change");if(_e||de){var xe={from:P,to:U,text:m.text,removed:m.removed,origin:m.origin};_e&&Un(l,"change",l,xe),de&&(l.curOp.changeObjs||(l.curOp.changeObjs=[])).push(xe)}l.display.selForContextMenu=null}function ha(l,m,C,v,x){if(v||(v=C),Rt(v,C)<0){var P=v;v=C,C=P}typeof m=="string"&&(m=l.splitLines(m)),da(l,{from:C,to:v,text:m,origin:x})}function bh(l,m,C,v){C<l.line?l.line+=v:m<l.line&&(l.line=m,l.ch=0)}function Ch(l,m,C,v){for(var x=0;x<l.length;++x){var P=l[x],U=!0;if(P.ranges){P.copied||(P=l[x]=P.deepCopy(),P.copied=!0);for(var W=0;W<P.ranges.length;W++)bh(P.ranges[W].anchor,m,C,v),bh(P.ranges[W].head,m,C,v);continue}for(var X=0;X<P.changes.length;++X){var J=P.changes[X];if(C<J.from.line)J.from=Ye(J.from.line+v,J.from.ch),J.to=Ye(J.to.line+v,J.to.ch);else if(m<=J.to.line){U=!1;break}}U||(l.splice(0,x+1),x=0)}}function wh(l,m){var C=m.from.line,v=m.to.line,x=m.text.length-(v-C)-1;Ch(l.done,C,v,x),Ch(l.undone,C,v,x)}function Ka(l,m,C,v){var x=m,P=m;return typeof m=="number"?P=tt(l,Nr(l,m)):x=ti(m),x==null?null:(v(P,x)&&l.cm&&sr(l.cm,x,C),P)}function Xa(l){var m=this;this.lines=l,this.parent=null;for(var C=0,v=0;v<l.length;++v)l[v].parent=m,C+=l[v].height;this.height=C}Xa.prototype={chunkSize:function(){return this.lines.length},removeInner:function(l,m){for(var C=this,v=l,x=l+m;v<x;++v){var P=C.lines[v];C.height-=P.height,ac(P),Un(P,"delete")}this.lines.splice(l,m)},collapse:function(l){l.push.apply(l,this.lines)},insertInner:function(l,m,C){var v=this;this.height+=C,this.lines=this.lines.slice(0,l).concat(m).concat(this.lines.slice(l));for(var x=0;x<m.length;++x)m[x].parent=v},iterN:function(l,m,C){for(var v=this,x=l+m;l<x;++l)if(C(v.lines[l]))return!0}};function ca(l){var m=this;this.children=l;for(var C=0,v=0,x=0;x<l.length;++x){var P=l[x];C+=P.chunkSize(),v+=P.height,P.parent=m}this.size=C,this.height=v,this.parent=null}ca.prototype={chunkSize:function(){return this.size},removeInner:function(l,m){var C=this;this.size-=m;for(var v=0;v<this.children.length;++v){var x=C.children[v],P=x.chunkSize();if(l<P){var U=Math.min(m,P-l),W=x.height;if(x.removeInner(l,U),C.height-=W-x.height,P==U&&(C.children.splice(v--,1),x.parent=null),(m-=U)==0)break;l=0}else l-=P}if(this.size-m<25&&(this.children.length>1||!(this.children[0]instanceof Xa))){var X=[];this.collapse(X),this.children=[new Xa(X)],this.children[0].parent=this}},collapse:function(l){for(var m=this,C=0;C<this.children.length;++C)m.children[C].collapse(l)},insertInner:function(l,m,C){var v=this;this.size+=m.length,this.height+=C;for(var x=0;x<this.children.length;++x){var P=v.children[x],U=P.chunkSize();if(l<=U){if(P.insertInner(l,m,C),P.lines&&P.lines.length>50){for(var W=P.lines.length%25+25,X=W;X<P.lines.length;){var J=new Xa(P.lines.slice(X,X+=25));P.height-=J.height,v.children.splice(++x,0,J),J.parent=v}P.lines=P.lines.slice(0,W),v.maybeSpill()}break}l-=U}},maybeSpill:function(){if(!(this.children.length<=10)){var l=this;do{var m=l.children.splice(l.children.length-5,5),C=new ca(m);if(l.parent){l.size-=C.size,l.height-=C.height;var x=lt(l.parent.children,l);l.parent.children.splice(x+1,0,C)}else{var v=new ca(l.children);v.parent=l,l.children=[v,C],l=v}C.parent=l.parent}while(l.children.length>10);l.parent.maybeSpill()}},iterN:function(l,m,C){for(var v=this,x=0;x<this.children.length;++x){var P=v.children[x],U=P.chunkSize();if(l<U){var W=Math.min(m,U-l);if(P.iterN(l,W,C))return!0;if((m-=W)==0)break;l=0}else l-=U}}};function ua(l,m,C){var v=this;if(C)for(var x in C)C.hasOwnProperty(x)&&(v[x]=C[x]);this.doc=l,this.node=m}Er(ua);function Uo(l,m,C){ur(m)<(l.curOp&&l.curOp.scrollTop||l.doc.scrollTop)&&Dl(l,null,C)}ua.prototype.clear=function(){var l=this,m=this.doc.cm,C=this.line.widgets,v=this.line,x=ti(v);if(!(x==null||!C)){for(var P=0;P<C.length;++P)C[P]==l&&C.splice(P--,1);C.length||(v.widgets=null);var U=Ba(this);ki(v,Math.max(0,v.height-U)),m&&tn(m,function(){Uo(m,v,-U),sr(m,x,"widget")})}},ua.prototype.changed=function(){var l=this.height,m=this.doc.cm,C=this.line;this.height=null;var v=Ba(this)-l;!v||(ki(C,C.height+v),m&&tn(m,function(){m.curOp.forceUpdate=!0,Uo(m,C,v)}))};function Th(l,m,C,v){var x=new ua(l,C,v),P=l.cm;return P&&x.noHScroll&&(P.display.alignWidgets=!0),Ka(l,m,"widget",function(U){var W=U.widgets||(U.widgets=[]);if(x.insertAt==null?W.push(x):W.splice(Math.min(W.length-1,Math.max(0,x.insertAt)),0,x),x.line=U,P&&!tr(l,U)){var X=ur(U)<l.scrollTop;ki(U,U.height+Ba(x)),X&&Dl(P,null,x.height),P.curOp.forceUpdate=!0}return!0}),x}var Eh=0;function Pn(l,m){this.lines=[],this.type=m,this.doc=l,this.id=++Eh}Er(Pn),Pn.prototype.clear=function(){var l=this;if(!this.explicitlyCleared){var m=this.doc.cm,C=m&&!m.curOp;if(C&&os(m),_n(this,"clear")){var v=this.find();v&&Un(this,"clear",v.from,v.to)}for(var x=null,P=null,U=0;U<this.lines.length;++U){var W=l.lines[U],X=Ne(W.markedSpans,l);m&&!l.collapsed?sr(m,ti(W),"text"):m&&(X.to!=null&&(P=ti(W)),X.from!=null&&(x=ti(W))),W.markedSpans=et(W.markedSpans,X),X.from==null&&l.collapsed&&!tr(l.doc,W)&&m&&ki(W,ks(m.display))}if(m&&this.collapsed&&!m.options.lineWrapping)for(var J=0;J<this.lines.length;++J){var de=Jt(l.lines[J]),_e=Ma(de);_e>m.display.maxLineLength&&(m.display.maxLine=de,m.display.maxLineLength=_e,m.display.maxLineChanged=!0)}x!=null&&m&&this.collapsed&&on(m,x,P+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,m&&gh(m.doc)),m&&Un(m,"markerCleared",m,this),C&&ra(m),this.parent&&this.parent.clear()}},Pn.prototype.find=function(l,m){var C=this;l==null&&this.type=="bookmark"&&(l=1);for(var v,x,P=0;P<this.lines.length;++P){var U=C.lines[P],W=Ne(U.markedSpans,C);if(W.from!=null&&(v=Ye(m?U:ti(U),W.from),l==-1))return v;if(W.to!=null&&(x=Ye(m?U:ti(U),W.to),l==1))return x}return v&&{from:v,to:x}},Pn.prototype.changed=function(){var l=this.find(-1,!0),m=this,C=this.doc.cm;!l||!C||tn(C,function(){var v=l.line,x=ti(l.line),P=vl(C,x);if(P&&(Ud(P),C.curOp.selectionChanged=C.curOp.forceUpdate=!0),C.curOp.updateMaxLine=!0,!tr(m.doc,v)&&m.height!=null){var U=m.height;m.height=null;var W=Ba(m)-U;W&&ki(v,v.height+W)}})},Pn.prototype.attachLine=function(l){if(!this.lines.length&&this.doc.cm){var m=this.doc.cm.curOp;(!m.maybeHiddenMarkers||lt(m.maybeHiddenMarkers,this)==-1)&&(m.maybeUnhiddenMarkers||(m.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(l)},Pn.prototype.detachLine=function(l){if(this.lines.splice(lt(this.lines,l),1),!this.lines.length&&this.doc.cm){var m=this.doc.cm.curOp;(m.maybeHiddenMarkers||(m.maybeHiddenMarkers=[])).push(this)}};function pa(l,m,C,v,x){if(v&&v.shared)return Oc(l,m,C,v,x);if(l.cm&&!l.cm.curOp)return pn(l.cm,pa)(l,m,C,v,x);var P=new Pn(l,x),U=Rt(m,C);if(v&&Ue(v,P,!1),U>0||U==0&&P.clearWhenEmpty!==!1)return P;if(P.replacedWith&&(P.collapsed=!0,P.widgetNode=se("span",[P.replacedWith],"CodeMirror-widget"),v.handleMouseEvents||P.widgetNode.setAttribute("cm-ignore-events","true"),v.insertLeft&&(P.widgetNode.insertLeft=!0)),P.collapsed){if($t(l,m.line,m,C,P)||m.line!=C.line&&$t(l,C.line,m,C,P))throw new Error("Inserting collapsed marker partially overlapping an existing one");Yn()}P.addToHistory&&Fl(l,{from:m,to:C,origin:"markText"},l.sel,NaN);var W=m.line,X=l.cm,J;if(l.iter(W,C.line+1,function(_e){X&&P.collapsed&&!X.options.lineWrapping&&Jt(_e)==X.display.maxLine&&(J=!0),P.collapsed&&W!=m.line&&ki(_e,0),Gt(_e,new Le(P,W==m.line?m.ch:null,W==C.line?C.ch:null)),++W}),P.collapsed&&l.iter(m.line,C.line+1,function(_e){tr(l,_e)&&ki(_e,0)}),P.clearOnEnter&&qt(P,"beforeCursorEnter",function(){return P.clear()}),P.readOnly&&(Es(),(l.history.done.length||l.history.undone.length)&&l.clearHistory()),P.collapsed&&(P.id=++Eh,P.atomic=!0),X){if(J&&(X.curOp.updateMaxLine=!0),P.collapsed)on(X,m.line,C.line+1);else if(P.className||P.title||P.startStyle||P.endStyle||P.css)for(var de=m.line;de<=C.line;de++)sr(X,de,"text");P.atomic&&gh(X.doc),Un(X,"markerAdded",X,P)}return P}function ma(l,m){var C=this;this.markers=l,this.primary=m;for(var v=0;v<l.length;++v)l[v].parent=C}Er(ma),ma.prototype.clear=function(){var l=this;if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var m=0;m<this.markers.length;++m)l.markers[m].clear();Un(this,"clear")}},ma.prototype.find=function(l,m){return this.primary.find(l,m)};function Oc(l,m,C,v,x){v=Ue(v),v.shared=!1;var P=[pa(l,m,C,v,x)],U=P[0],W=v.widgetNode;return Os(l,function(X){W&&(v.widgetNode=W.cloneNode(!0)),P.push(pa(X,Ft(X,m),Ft(X,C),v,x));for(var J=0;J<X.linked.length;++J)if(X.linked[J].isParent)return;U=Xe(P)}),new ma(P,U)}function Wl(l){return l.findMarks(Ye(l.first,0),l.clipPos(Ye(l.lastLine())),function(m){return m.parent})}function jl(l,m){for(var C=0;C<m.length;C++){var v=m[C],x=v.find(),P=l.clipPos(x.from),U=l.clipPos(x.to);if(Rt(P,U)){var W=pa(l,P,U,v.primary,v.primary.type);v.markers.push(W),W.parent=v}}}function Vc(l){for(var m=function(v){var x=l[v],P=[x.primary.doc];Os(x.primary.doc,function(X){return P.push(X)});for(var U=0;U<x.markers.length;U++){var W=x.markers[U];lt(P,W.doc)==-1&&(W.parent=null,x.markers.splice(U--,1))}},C=0;C<l.length;C++)m(C)}var Uc=0,An=function(l,m,C,v){if(!(this instanceof An))return new An(l,m,C,v);C==null&&(C=0),ca.call(this,[new Xa([new ea("",null)])]),this.first=C,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=C;var x=Ye(C,0);this.sel=zn(x),this.history=new Bo(null),this.id=++Uc,this.modeOption=m,this.lineSep=v,this.extend=!1,typeof l=="string"&&(l=this.splitLines(l)),Al(this,{from:x,to:x,text:l}),En(this,zn(x),ni)};An.prototype=Me(ca.prototype,{constructor:An,iter:function(l,m,C){C?this.iterN(l-this.first,m-l,C):this.iterN(this.first,this.first+this.size,l)},insert:function(l,m){for(var C=0,v=0;v<m.length;++v)C+=m[v].height;this.insertInner(l-this.first,m,C)},remove:function(l,m){this.removeInner(l-this.first,m)},getValue:function(l){var m=sn(this,this.first,this.first+this.size);return l===!1?m:m.join(l||this.lineSeparator())},setValue:At(function(l){var m=Ye(this.first,0),C=this.first+this.size-1;da(this,{from:m,to:Ye(C,tt(this,C).text.length),text:this.splitLines(l),origin:"setValue",full:!0},!0),En(this,zn(m))}),replaceRange:function(l,m,C,v){m=Ft(this,m),C=C?Ft(this,C):m,ha(this,l,m,C,v)},getRange:function(l,m,C){var v=yi(this,Ft(this,l),Ft(this,m));return C===!1?v:v.join(C||this.lineSeparator())},getLine:function(l){var m=this.getLineHandle(l);return m&&m.text},getLineHandle:function(l){if(er(this,l))return tt(this,l)},getLineNumber:function(l){return ti(l)},getLineHandleVisualStart:function(l){return typeof l=="number"&&(l=tt(this,l)),Jt(l)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(l){return Ft(this,l)},getCursor:function(l){var m=this.sel.primary(),C;return l==null||l=="head"?C=m.head:l=="anchor"?C=m.anchor:l=="end"||l=="to"||l===!1?C=m.to():C=m.from(),C},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:At(function(l,m,C){ph(this,Ft(this,typeof l=="number"?Ye(l,m||0):l),null,C)}),setSelection:At(function(l,m,C){ph(this,Ft(this,l),Ft(this,m||l),C)}),extendSelection:At(function(l,m,C){ln(this,Ft(this,l),m&&Ft(this,m),C)}),extendSelections:At(function(l,m){Ul(this,ts(this,l),m)}),extendSelectionsBy:At(function(l,m){var C=bi(this.sel.ranges,l);Ul(this,ts(this,C),m)}),setSelections:At(function(l,m,C){var v=this;if(!!l.length){for(var x=[],P=0;P<l.length;P++)x[P]=new ai(Ft(v,l[P].anchor),Ft(v,l[P].head));m==null&&(m=Math.min(l.length-1,this.sel.primIndex)),En(this,$i(x,m),C)}}),addSelection:At(function(l,m,C){var v=this.sel.ranges.slice(0);v.push(new ai(Ft(this,l),Ft(this,m||l))),En(this,$i(v,v.length-1),C)}),getSelection:function(l){for(var m=this,C=this.sel.ranges,v,x=0;x<C.length;x++){var P=yi(m,C[x].from(),C[x].to());v=v?v.concat(P):P}return l===!1?v:v.join(l||this.lineSeparator())},getSelections:function(l){for(var m=this,C=[],v=this.sel.ranges,x=0;x<v.length;x++){var P=yi(m,v[x].from(),v[x].to());l!==!1&&(P=P.join(l||m.lineSeparator())),C[x]=P}return C},replaceSelection:function(l,m,C){for(var v=[],x=0;x<this.sel.ranges.length;x++)v[x]=l;this.replaceSelections(v,m,C||"+input")},replaceSelections:At(function(l,m,C){for(var v=this,x=[],P=this.sel,U=0;U<P.ranges.length;U++){var W=P.ranges[U];x[U]={from:W.from(),to:W.to(),text:v.splitLines(l[U]),origin:C}}for(var X=m&&m!="end"&&Ac(this,x,m),J=x.length-1;J>=0;J--)da(v,x[J]);X?mh(this,X):this.cm&&Mt(this.cm)}),undo:At(function(){Vo(this,"undo")}),redo:At(function(){Vo(this,"redo")}),undoSelection:At(function(){Vo(this,"undo",!0)}),redoSelection:At(function(){Vo(this,"redo",!0)}),setExtending:function(l){this.extend=l},getExtending:function(){return this.extend},historySize:function(){for(var l=this.history,m=0,C=0,v=0;v<l.done.length;v++)l.done[v].ranges||++m;for(var x=0;x<l.undone.length;x++)l.undone[x].ranges||++C;return{undo:m,redo:C}},clearHistory:function(){this.history=new Bo(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(l){return l&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(l){return this.history.generation==(l||this.cleanGeneration)},getHistory:function(){return{done:mr(this.history.done),undone:mr(this.history.undone)}},setHistory:function(l){var m=this.history=new Bo(this.history.maxGeneration);m.done=mr(l.done.slice(0),null,!0),m.undone=mr(l.undone.slice(0),null,!0)},setGutterMarker:At(function(l,m,C){return Ka(this,l,"gutter",function(v){var x=v.gutterMarkers||(v.gutterMarkers={});return x[m]=C,!C&&pe(x)&&(v.gutterMarkers=null),!0})}),clearGutter:At(function(l){var m=this,C=this.first;this.iter(function(v){v.gutterMarkers&&v.gutterMarkers[l]&&Ka(m,v,"gutter",function(){return v.gutterMarkers[l]=null,pe(v.gutterMarkers)&&(v.gutterMarkers=null),!0}),++C})}),lineInfo:function(l){var m;if(typeof l=="number"){if(!er(this,l)||(m=l,l=tt(this,l),!l))return null}else if(m=ti(l),m==null)return null;return{line:m,handle:l,text:l.text,gutterMarkers:l.gutterMarkers,textClass:l.textClass,bgClass:l.bgClass,wrapClass:l.wrapClass,widgets:l.widgets}},addLineClass:At(function(l,m,C){return Ka(this,l,m=="gutter"?"gutter":"class",function(v){var x=m=="text"?"textClass":m=="background"?"bgClass":m=="gutter"?"gutterClass":"wrapClass";if(!v[x])v[x]=C;else{if(z(C).test(v[x]))return!1;v[x]+=" "+C}return!0})}),removeLineClass:At(function(l,m,C){return Ka(this,l,m=="gutter"?"gutter":"class",function(v){var x=m=="text"?"textClass":m=="background"?"bgClass":m=="gutter"?"gutterClass":"wrapClass",P=v[x];if(P)if(C==null)v[x]=null;else{var U=P.match(z(C));if(!U)return!1;var W=U.index+U[0].length;v[x]=P.slice(0,U.index)+(!U.index||W==P.length?"":" ")+P.slice(W)||null}else return!1;return!0})}),addLineWidget:At(function(l,m,C){return Th(this,l,m,C)}),removeLineWidget:function(l){l.clear()},markText:function(l,m,C){return pa(this,Ft(this,l),Ft(this,m),C,C&&C.type||"range")},setBookmark:function(l,m){var C={replacedWith:m&&(m.nodeType==null?m.widget:m),insertLeft:m&&m.insertLeft,clearWhenEmpty:!1,shared:m&&m.shared,handleMouseEvents:m&&m.handleMouseEvents};return l=Ft(this,l),pa(this,l,l,C,"bookmark")},findMarksAt:function(l){l=Ft(this,l);var m=[],C=tt(this,l.line).markedSpans;if(C)for(var v=0;v<C.length;++v){var x=C[v];(x.from==null||x.from<=l.ch)&&(x.to==null||x.to>=l.ch)&&m.push(x.marker.parent||x.marker)}return m},findMarks:function(l,m,C){l=Ft(this,l),m=Ft(this,m);var v=[],x=l.line;return this.iter(l.line,m.line+1,function(P){var U=P.markedSpans;if(U)for(var W=0;W<U.length;W++){var X=U[W];!(X.to!=null&&x==l.line&&l.ch>=X.to||X.from==null&&x!=l.line||X.from!=null&&x==m.line&&X.from>=m.ch)&&(!C||C(X.marker))&&v.push(X.marker.parent||X.marker)}++x}),v},getAllMarks:function(){var l=[];return this.iter(function(m){var C=m.markedSpans;if(C)for(var v=0;v<C.length;++v)C[v].from!=null&&l.push(C[v].marker)}),l},posFromIndex:function(l){var m,C=this.first,v=this.lineSeparator().length;return this.iter(function(x){var P=x.text.length+v;if(P>l)return m=l,!0;l-=P,++C}),Ft(this,Ye(C,m))},indexFromPos:function(l){l=Ft(this,l);var m=l.ch;if(l.line<this.first||l.ch<0)return 0;var C=this.lineSeparator().length;return this.iter(this.first,l.line,function(v){m+=v.text.length+C}),m},copy:function(l){var m=new An(sn(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep);return m.scrollTop=this.scrollTop,m.scrollLeft=this.scrollLeft,m.sel=this.sel,m.extend=!1,l&&(m.history.undoDepth=this.history.undoDepth,m.setHistory(this.getHistory())),m},linkedDoc:function(l){l||(l={});var m=this.first,C=this.first+this.size;l.from!=null&&l.from>m&&(m=l.from),l.to!=null&&l.to<C&&(C=l.to);var v=new An(sn(this,m,C),l.mode||this.modeOption,m,this.lineSep);return l.sharedHist&&(v.history=this.history),(this.linked||(this.linked=[])).push({doc:v,sharedHist:l.sharedHist}),v.linked=[{doc:this,isParent:!0,sharedHist:l.sharedHist}],jl(v,Wl(this)),v},unlinkDoc:function(l){var m=this;if(l instanceof di&&(l=l.doc),this.linked)for(var C=0;C<this.linked.length;++C){var v=m.linked[C];if(v.doc==l){m.linked.splice(C,1),l.unlinkDoc(m),Vc(Wl(m));break}}if(l.history==this.history){var x=[l.id];Os(l,function(P){return x.push(P.id)},!0),l.history=new Bo(null),l.history.done=mr(this.history.done,x),l.history.undone=mr(this.history.undone,x)}},iterLinkedDocs:function(l){Os(this,l)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(l){return this.lineSep?l.split(this.lineSep):Ro(l)},lineSeparator:function(){return this.lineSep||`
`}}),An.prototype.eachLine=An.prototype.iter;var xh=0;function zc(l){var m=this;if(ql(m),!(Ji(m,l)||Fr(m.display,l))){un(l),s&&(xh=+new Date);var C=Ds(m,l,!0),v=l.dataTransfer.files;if(!(!C||m.isReadOnly()))if(v&&v.length&&window.FileReader&&window.File)for(var x=v.length,P=Array(x),U=0,W=function(xe,ze){if(!(m.options.allowDropFileTypes&&lt(m.options.allowDropFileTypes,xe.type)==-1)){var Oe=new FileReader;Oe.onload=pn(m,function(){var Ke=Oe.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(Ke)&&(Ke=""),P[ze]=Ke,++U==x){C=Ft(m.doc,C);var ht={from:C,to:C,text:m.doc.splitLines(P.join(m.doc.lineSeparator())),origin:"paste"};da(m.doc,ht),mh(m.doc,zn(C,Qn(ht)))}}),Oe.readAsText(xe)}},X=0;X<x;++X)W(v[X],X);else{if(m.state.draggingText&&m.doc.sel.contains(C)>-1){m.state.draggingText(l),setTimeout(function(){return m.display.input.focus()},20);return}try{var J=l.dataTransfer.getData("Text");if(J){var de;if(m.state.draggingText&&!m.state.draggingText.copy&&(de=m.listSelections()),Fo(m.doc,zn(C,C)),de)for(var _e=0;_e<de.length;++_e)ha(m.doc,"",de[_e].anchor,de[_e].head,"drag");m.replaceSelection(J,"around","paste"),m.display.input.focus()}}catch{}}}}function Ya(l,m){if(s&&(!l.state.draggingText||+new Date-xh<100)){Br(m);return}if(!(Ji(l,m)||Fr(l.display,m))&&(m.dataTransfer.setData("Text",l.getSelection()),m.dataTransfer.effectAllowed="copyMove",m.dataTransfer.setDragImage&&!b)){var C=se("img",null,null,"position: fixed; left: 0; top: 0;");C.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",_&&(C.width=C.height=1,l.display.wrapper.appendChild(C),C._top=C.offsetTop),m.dataTransfer.setDragImage(C,0,0),_&&C.parentNode.removeChild(C)}}function Ih(l,m){var C=Ds(l,m);if(!!C){var v=document.createDocumentFragment();Xd(l,C,v),l.display.dragCursor||(l.display.dragCursor=se("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),l.display.lineSpace.insertBefore(l.display.dragCursor,l.display.cursorDiv)),Y(l.display.dragCursor,v)}}function ql(l){l.display.dragCursor&&(l.display.lineSpace.removeChild(l.display.dragCursor),l.display.dragCursor=null)}function zo(l){if(!!document.body.getElementsByClassName)for(var m=document.body.getElementsByClassName("CodeMirror"),C=0;C<m.length;C++){var v=m[C].CodeMirror;v&&l(v)}}var Kl=!1;function Gc(){Kl||(Hc(),Kl=!0)}function Hc(){var l;qt(window,"resize",function(){l==null&&(l=setTimeout(function(){l=null,zo(Wc)},100))}),qt(window,"blur",function(){return zo(Ua)})}function Wc(l){var m=l.display;m.lastWrapHeight==m.wrapper.clientHeight&&m.lastWrapWidth==m.wrapper.clientWidth||(m.cachedCharWidth=m.cachedTextHeight=m.cachedPaddingH=null,m.scrollbarsClipped=!1,l.setSize())}for(var cs={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},Ja=0;Ja<10;Ja++)cs[Ja+48]=cs[Ja+96]=String(Ja);for(var Go=65;Go<=90;Go++)cs[Go]=String.fromCharCode(Go);for(var $a=1;$a<=12;$a++)cs[$a+111]=cs[$a+63235]="F"+$a;var zr={};zr.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},zr.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},zr.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},zr.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},zr.default=R?zr.macDefault:zr.pcDefault;function jc(l){var m=l.split(/-(?!$)/);l=m[m.length-1];for(var C,v,x,P,U=0;U<m.length-1;U++){var W=m[U];if(/^(cmd|meta|m)$/i.test(W))P=!0;else if(/^a(lt)?$/i.test(W))C=!0;else if(/^(c|ctrl|control)$/i.test(W))v=!0;else if(/^s(hift)?$/i.test(W))x=!0;else throw new Error("Unrecognized modifier name: "+W)}return C&&(l="Alt-"+l),v&&(l="Ctrl-"+l),P&&(l="Cmd-"+l),x&&(l="Shift-"+l),l}function qc(l){var m={};for(var C in l)if(l.hasOwnProperty(C)){var v=l[C];if(/^(name|fallthrough|(de|at)tach)$/.test(C))continue;if(v=="..."){delete l[C];continue}for(var x=bi(C.split(" "),jc),P=0;P<x.length;P++){var U=void 0,W=void 0;P==x.length-1?(W=x.join(" "),U=v):(W=x.slice(0,P+1).join(" "),U="...");var X=m[W];if(!X)m[W]=U;else if(X!=U)throw new Error("Inconsistent bindings for "+W)}delete l[C]}for(var J in m)l[J]=m[J];return l}function fa(l,m,C,v){m=fr(m);var x=m.call?m.call(l,v):m[l];if(x===!1)return"nothing";if(x==="...")return"multi";if(x!=null&&C(x))return"handled";if(m.fallthrough){if(Object.prototype.toString.call(m.fallthrough)!="[object Array]")return fa(l,m.fallthrough,C,v);for(var P=0;P<m.fallthrough.length;P++){var U=fa(l,m.fallthrough[P],C,v);if(U)return U}}}function Rh(l){var m=typeof l=="string"?l:cs[l.keyCode];return m=="Ctrl"||m=="Alt"||m=="Shift"||m=="Mod"}function Gr(l,m){if(_&&l.keyCode==34&&l.char)return!1;var C=cs[l.keyCode],v=C;return v==null||l.altGraphKey?!1:(l.altKey&&C!="Alt"&&(v="Alt-"+v),(H?l.metaKey:l.ctrlKey)&&C!="Ctrl"&&(v="Ctrl-"+v),(H?l.ctrlKey:l.metaKey)&&C!="Cmd"&&(v="Cmd-"+v),!m&&l.shiftKey&&C!="Shift"&&(v="Shift-"+v),v)}function fr(l){return typeof l=="string"?zr[l]:l}function Vs(l,m){for(var C=l.doc.sel.ranges,v=[],x=0;x<C.length;x++){for(var P=m(C[x]);v.length&&Rt(P.from,Xe(v).to)<=0;){var U=v.pop();if(Rt(U.from,P.from)<0){P.from=U.from;break}}v.push(P)}tn(l,function(){for(var W=v.length-1;W>=0;W--)ha(l.doc,"",v[W].from,v[W].to,"+delete");Mt(l)})}var Hr={selectAll:Hl,singleSelection:function(l){return l.setSelection(l.getCursor("anchor"),l.getCursor("head"),ni)},killLine:function(l){return Vs(l,function(m){if(m.empty()){var C=tt(l.doc,m.head.line).text.length;return m.head.ch==C&&m.head.line<l.lastLine()?{from:m.head,to:Ye(m.head.line+1,0)}:{from:m.head,to:Ye(m.head.line,C)}}else return{from:m.from(),to:m.to()}})},deleteLine:function(l){return Vs(l,function(m){return{from:Ye(m.from().line,0),to:Ft(l.doc,Ye(m.to().line+1,0))}})},delLineLeft:function(l){return Vs(l,function(m){return{from:Ye(m.from().line,0),to:m.from()}})},delWrappedLineLeft:function(l){return Vs(l,function(m){var C=l.charCoords(m.head,"div").top+5,v=l.coordsChar({left:0,top:C},"div");return{from:v,to:m.from()}})},delWrappedLineRight:function(l){return Vs(l,function(m){var C=l.charCoords(m.head,"div").top+5,v=l.coordsChar({left:l.display.lineDiv.offsetWidth+100,top:C},"div");return{from:m.from(),to:v}})},undo:function(l){return l.undo()},redo:function(l){return l.redo()},undoSelection:function(l){return l.undoSelection()},redoSelection:function(l){return l.redoSelection()},goDocStart:function(l){return l.extendSelection(Ye(l.firstLine(),0))},goDocEnd:function(l){return l.extendSelection(Ye(l.lastLine()))},goLineStart:function(l){return l.extendSelectionsBy(function(m){return Mh(l,m.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(l){return l.extendSelectionsBy(function(m){return kh(l,m.head)},{origin:"+move",bias:1})},goLineEnd:function(l){return l.extendSelectionsBy(function(m){return Kc(l,m.head.line)},{origin:"+move",bias:-1})},goLineRight:function(l){return l.extendSelectionsBy(function(m){var C=l.charCoords(m.head,"div").top+5;return l.coordsChar({left:l.display.lineDiv.offsetWidth+100,top:C},"div")},He)},goLineLeft:function(l){return l.extendSelectionsBy(function(m){var C=l.charCoords(m.head,"div").top+5;return l.coordsChar({left:0,top:C},"div")},He)},goLineLeftSmart:function(l){return l.extendSelectionsBy(function(m){var C=l.charCoords(m.head,"div").top+5,v=l.coordsChar({left:0,top:C},"div");return v.ch<l.getLine(v.line).search(/\S/)?kh(l,m.head):v},He)},goLineUp:function(l){return l.moveV(-1,"line")},goLineDown:function(l){return l.moveV(1,"line")},goPageUp:function(l){return l.moveV(-1,"page")},goPageDown:function(l){return l.moveV(1,"page")},goCharLeft:function(l){return l.moveH(-1,"char")},goCharRight:function(l){return l.moveH(1,"char")},goColumnLeft:function(l){return l.moveH(-1,"column")},goColumnRight:function(l){return l.moveH(1,"column")},goWordLeft:function(l){return l.moveH(-1,"word")},goGroupRight:function(l){return l.moveH(1,"group")},goGroupLeft:function(l){return l.moveH(-1,"group")},goWordRight:function(l){return l.moveH(1,"word")},delCharBefore:function(l){return l.deleteH(-1,"char")},delCharAfter:function(l){return l.deleteH(1,"char")},delWordBefore:function(l){return l.deleteH(-1,"word")},delWordAfter:function(l){return l.deleteH(1,"word")},delGroupBefore:function(l){return l.deleteH(-1,"group")},delGroupAfter:function(l){return l.deleteH(1,"group")},indentAuto:function(l){return l.indentSelection("smart")},indentMore:function(l){return l.indentSelection("add")},indentLess:function(l){return l.indentSelection("subtract")},insertTab:function(l){return l.replaceSelection("	")},insertSoftTab:function(l){for(var m=[],C=l.listSelections(),v=l.options.tabSize,x=0;x<C.length;x++){var P=C[x].from(),U=Ge(l.getLine(P.line),P.ch,v);m.push(vi(v-U%v))}l.replaceSelections(m)},defaultTab:function(l){l.somethingSelected()?l.indentSelection("add"):l.execCommand("insertTab")},transposeChars:function(l){return tn(l,function(){for(var m=l.listSelections(),C=[],v=0;v<m.length;v++)if(!!m[v].empty()){var x=m[v].head,P=tt(l.doc,x.line).text;if(P){if(x.ch==P.length&&(x=new Ye(x.line,x.ch-1)),x.ch>0)x=new Ye(x.line,x.ch+1),l.replaceRange(P.charAt(x.ch-1)+P.charAt(x.ch-2),Ye(x.line,x.ch-2),x,"+transpose");else if(x.line>l.doc.first){var U=tt(l.doc,x.line-1).text;U&&(x=new Ye(x.line,1),l.replaceRange(P.charAt(0)+l.doc.lineSeparator()+U.charAt(U.length-1),Ye(x.line-1,U.length-1),x,"+transpose"))}}C.push(new ai(x,x))}l.setSelections(C)})},newlineAndIndent:function(l){return tn(l,function(){for(var m=l.listSelections(),C=m.length-1;C>=0;C--)l.replaceRange(l.doc.lineSeparator(),m[C].anchor,m[C].head,"+input");m=l.listSelections();for(var v=0;v<m.length;v++)l.indentLine(m[v].from().line,null,!0);Mt(l)})},openLine:function(l){return l.replaceSelection(`
`,"start")},toggleOverwrite:function(l){return l.toggleOverwrite()}};function Mh(l,m){var C=tt(l.doc,m),v=Jt(C);v!=C&&(m=ti(v));var x=ir(v),P=x?x[0].level%2?Da(v):ka(v):0;return Ye(m,P)}function Kc(l,m){for(var C,v=tt(l.doc,m);C=We(v);)v=C.find(1,!0).line,m=null;var x=ir(v),P=x?x[0].level%2?ka(v):Da(v):v.text.length;return Ye(m==null?ti(v):m,P)}function kh(l,m){var C=Mh(l,m.line),v=tt(l.doc,C.line),x=ir(v);if(!x||x[0].level==0){var P=Math.max(0,v.text.search(/\S/)),U=m.line==C.line&&m.ch<=P&&m.ch;return Ye(C.line,U?0:P)}return C}function Qa(l,m,C){if(typeof m=="string"&&(m=Hr[m],!m))return!1;l.display.input.ensurePolled();var v=l.display.shift,x=!1;try{l.isReadOnly()&&(l.state.suppressEdits=!0),C&&(l.display.shift=!1),x=m(l)!=Yt}finally{l.display.shift=v,l.state.suppressEdits=!1}return x}function ga(l,m,C){for(var v=0;v<l.state.keyMaps.length;v++){var x=fa(m,l.state.keyMaps[v],C,l);if(x)return x}return l.options.extraKeys&&fa(m,l.options.extraKeys,C,l)||fa(m,l.options.keyMap,C,l)}var nn=new it;function us(l,m,C,v){var x=l.state.keySeq;if(x){if(Rh(m))return"handled";nn.set(50,function(){l.state.keySeq==x&&(l.state.keySeq=null,l.display.input.reset())}),m=x+" "+m}var P=ga(l,m,v);return P=="multi"&&(l.state.keySeq=m),P=="handled"&&Un(l,"keyHandled",l,m,C),(P=="handled"||P=="multi")&&(un(C),Il(l)),x&&!P&&/\'$/.test(m)?(un(C),!0):!!P}function Xl(l,m){var C=Gr(m,!0);return C?m.shiftKey&&!l.state.keySeq?us(l,"Shift-"+C,m,function(v){return Qa(l,v,!0)})||us(l,C,m,function(v){if(typeof v=="string"?/^go[A-Z]/.test(v):v.motion)return Qa(l,v)}):us(l,C,m,function(v){return Qa(l,v)}):!1}function Xc(l,m,C){return us(l,"'"+C+"'",m,function(v){return Qa(l,v,!0)})}var Za=null;function Us(l){var m=this;if(m.curOp.focus=te(),!Ji(m,l)){s&&a<11&&l.keyCode==27&&(l.returnValue=!1);var C=l.keyCode;m.display.shift=C==16||l.shiftKey;var v=Xl(m,l);_&&(Za=v?C:null,!v&&C==88&&!Na&&(R?l.metaKey:l.ctrlKey)&&m.replaceSelection("",null,"cut")),C==18&&!/\bCodeMirror-crosshair\b/.test(m.display.lineDiv.className)&&_a(m)}}function _a(l){var m=l.display.lineDiv;ve(m,"CodeMirror-crosshair");function C(v){(v.keyCode==18||!v.altKey)&&(K(m,"CodeMirror-crosshair"),Ln(document,"keyup",C),Ln(document,"mouseover",C))}qt(document,"keyup",C),qt(document,"mouseover",C)}function eo(l){l.keyCode==16&&(this.doc.sel.shift=!1),Ji(this,l)}function Wr(l){var m=this;if(!(Fr(m.display,l)||Ji(m,l)||l.ctrlKey&&!l.altKey||R&&l.metaKey)){var C=l.keyCode,v=l.charCode;if(_&&C==Za){Za=null,un(l);return}if(!(_&&(!l.which||l.which<10)&&Xl(m,l))){var x=String.fromCharCode(v==null?C:v);x!="\b"&&(Xc(m,l,x)||m.display.input.onKeyPress(l))}}}function to(l){var m=this,C=m.display;if(!(Ji(m,l)||C.activeTouch&&C.input.supportsTouch())){if(C.input.ensurePolled(),C.shift=l.shiftKey,Fr(C,l)){d||(C.scroller.draggable=!1,setTimeout(function(){return C.scroller.draggable=!0},100));return}if(!Li(m,l)){var v=Ds(m,l);switch(window.focus(),xo(l)){case 1:m.state.selectingText?m.state.selectingText(l):v?Ho(m,l,v):Eo(l)==C.scroller&&un(l);break;case 2:d&&(m.state.lastMiddleDown=+new Date),v&&ln(m.doc,v),setTimeout(function(){return C.input.focus()},20),un(l);break;case 3:O?io(m,l):kc(m);break}}}}var ps,ms;function Ho(l,m,C){s?setTimeout(qe(Yd,l),0):l.curOp.focus=te();var v=+new Date,x;ms&&ms.time>v-400&&Rt(ms.pos,C)==0?x="triple":ps&&ps.time>v-400&&Rt(ps.pos,C)==0?(x="double",ms={time:v,pos:C}):(x="single",ps={time:v,pos:C});var P=l.doc.sel,U=R?m.metaKey:m.ctrlKey,W;l.options.dragDrop&&vd&&!l.isReadOnly()&&x=="single"&&(W=P.contains(C))>-1&&(Rt((W=P.ranges[W]).from(),C)<0||C.xRel>0)&&(Rt(W.to(),C)>0||C.xRel<0)?Wo(l,m,C,U):Di(l,m,C,x,U)}function Wo(l,m,C,v){var x=l.display,P=+new Date,U=pn(l,function(W){d&&(x.scroller.draggable=!1),l.state.draggingText=!1,Ln(document,"mouseup",U),Ln(x.scroller,"drop",U),Math.abs(m.clientX-W.clientX)+Math.abs(m.clientY-W.clientY)<10&&(un(W),!v&&+new Date-200<P&&ln(l.doc,C),d||s&&a==9?setTimeout(function(){document.body.focus(),x.input.focus()},20):x.input.focus())});d&&(x.scroller.draggable=!0),l.state.draggingText=U,U.copy=R?m.altKey:m.ctrlKey,x.scroller.dragDrop&&x.scroller.dragDrop(),qt(document,"mouseup",U),qt(x.scroller,"drop",U)}function Di(l,m,C,v,x){var P=l.display,U=l.doc;un(m);var W,X,J=U.sel,de=J.ranges;if(x&&!m.shiftKey?(X=U.sel.contains(C),X>-1?W=de[X]:W=new ai(C,C)):(W=U.sel.primary(),X=U.sel.primIndex),M?m.shiftKey&&m.metaKey:m.altKey)v="rect",x||(W=new ai(C,C)),C=Ds(l,m,!0,!0),X=-1;else if(v=="double"){var _e=l.findWordAt(C);l.display.shift||U.extend?W=Ai(U,W,_e.anchor,_e.head):W=_e}else if(v=="triple"){var xe=new ai(Ye(C.line,0),Ft(U,Ye(C.line+1,0)));l.display.shift||U.extend?W=Ai(U,W,xe.anchor,xe.head):W=xe}else W=Ai(U,W,C);x?X==-1?(X=de.length,En(U,$i(de.concat([W]),X),{scroll:!1,origin:"*mouse"})):de.length>1&&de[X].empty()&&v=="single"&&!m.shiftKey?(En(U,$i(de.slice(0,X).concat(de.slice(X+1)),0),{scroll:!1,origin:"*mouse"}),J=U.sel):zl(U,X,W,ri):(X=0,En(U,new Xt([W],0),ri),J=U.sel);var ze=C;function Oe(wt){if(Rt(ze,wt)!=0)if(ze=wt,v=="rect"){for(var Ht=[],Kt=l.options.tabSize,gi=Ge(tt(U,C.line).text,C.ch,Kt),Ii=Ge(tt(U,wt.line).text,wt.ch,Kt),Vi=Math.min(gi,Ii),Qi=Math.max(gi,Ii),Ti=Math.min(C.line,wt.line),Xi=Math.min(l.lastLine(),Math.max(C.line,wt.line));Ti<=Xi;Ti++){var Pi=tt(U,Ti).text,Ri=ei(Pi,Vi,Kt);Vi==Qi?Ht.push(new ai(Ye(Ti,Ri),Ye(Ti,Ri))):Pi.length>Ri&&Ht.push(new ai(Ye(Ti,Ri),Ye(Ti,ei(Pi,Qi,Kt))))}Ht.length||Ht.push(new ai(C,C)),En(U,$i(J.ranges.slice(0,X).concat(Ht),X),{origin:"*mouse",scroll:!1}),l.scrollIntoView(wt)}else{var Zi=W,Hn=Zi.anchor,_r=wt;if(v!="single"){var Mr;v=="double"?Mr=l.findWordAt(wt):Mr=new ai(Ye(wt.line,0),Ft(U,Ye(wt.line+1,0))),Rt(Mr.anchor,Hn)>0?(_r=Mr.head,Hn=Hi(Zi.from(),Mr.anchor)):(_r=Mr.anchor,Hn=Vn(Zi.to(),Mr.head))}var vr=J.ranges.slice(0);vr[X]=new ai(Ft(U,Hn),_r),En(U,$i(vr,X),ri)}}var Ke=P.wrapper.getBoundingClientRect(),ht=0;function Bt(wt){var Ht=++ht,Kt=Ds(l,wt,!0,v=="rect");if(!!Kt)if(Rt(Kt,ze)!=0){l.curOp.focus=te(),Oe(Kt);var gi=kl(P,U);(Kt.line>=gi.to||Kt.line<gi.from)&&setTimeout(pn(l,function(){ht==Ht&&Bt(wt)}),150)}else{var Ii=wt.clientY<Ke.top?-20:wt.clientY>Ke.bottom?20:0;Ii&&setTimeout(pn(l,function(){ht==Ht&&(P.scroller.scrollTop+=Ii,Bt(wt))}),50)}}function dt(wt){l.state.selectingText=!1,ht=1/0,un(wt),P.input.focus(),Ln(document,"mousemove",Vt),Ln(document,"mouseup",Ut),U.history.lastSelOrigin=null}var Vt=pn(l,function(wt){xo(wt)?Bt(wt):dt(wt)}),Ut=pn(l,dt);l.state.selectingText=Ut,qt(document,"mousemove",Vt),qt(document,"mouseup",Ut)}function Bn(l,m,C,v){var x,P;try{x=m.clientX,P=m.clientY}catch{return!1}if(x>=Math.floor(l.display.gutters.getBoundingClientRect().right))return!1;v&&un(m);var U=l.display,W=U.lineDiv.getBoundingClientRect();if(P>W.bottom||!_n(l,C))return To(m);P-=W.top-U.viewOffset;for(var X=0;X<l.options.gutters.length;++X){var J=U.gutters.childNodes[X];if(J&&J.getBoundingClientRect().right>=x){var de=On(l.doc,P),_e=l.options.gutters[X];return Oi(l,C,l,de,_e,m),To(m)}}}function Li(l,m){return Bn(l,m,"gutterClick",!0)}function io(l,m){Fr(l.display,m)||gr(l,m)||Ji(l,m,"contextmenu")||l.display.input.onContextMenu(m)}function gr(l,m){return _n(l,"gutterContextMenu")?Bn(l,m,"gutterContextMenu",!1):!1}function zs(l){l.display.wrapper.className=l.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+l.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Fa(l)}var fs={toString:function(){return"CodeMirror.Init"}},Gs={},gs={};function va(l){var m=l.optionHandlers;function C(v,x,P,U){l.defaults[v]=x,P&&(m[v]=U?function(W,X,J){J!=fs&&P(W,X,J)}:P)}l.defineOption=C,l.Init=fs,C("value","",function(v,x){return v.setValue(x)},!0),C("mode",null,function(v,x){v.doc.modeOption=x,Pl(v)},!0),C("indentUnit",2,Pl,!0),C("indentWithTabs",!1),C("smartIndent",!0),C("tabSize",4,function(v){Wa(v),Fa(v),on(v)},!0),C("lineSeparator",null,function(v,x){if(v.doc.lineSep=x,!!x){var P=[],U=v.doc.first;v.doc.iter(function(X){for(var J=0;;){var de=X.text.indexOf(x,J);if(de==-1)break;J=de+x.length,P.push(Ye(U,de))}U++});for(var W=P.length-1;W>=0;W--)ha(v.doc,x,P[W],Ye(P[W].line,P[W].ch+x.length))}}),C("specialChars",/[\u0000-\u001f\u007f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff]/g,function(v,x,P){v.state.specialChars=new RegExp(x.source+(x.test("	")?"":"|	"),"g"),P!=fs&&v.refresh()}),C("specialCharPlaceholder",dc,function(v){return v.refresh()},!0),C("electricChars",!0),C("inputStyle",k?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),C("spellcheck",!1,function(v,x){return v.getInputField().spellcheck=x},!0),C("rtlMoveVisually",!L),C("wholeLineUpdateBefore",!0),C("theme","default",function(v){zs(v),jr(v)},!0),C("keyMap","default",function(v,x,P){var U=fr(x),W=P!=fs&&fr(P);W&&W.detach&&W.detach(v,U),U.attach&&U.attach(v,W||null)}),C("extraKeys",null),C("lineWrapping",!1,no,!0),C("gutters",[],function(v){Nl(v.options),jr(v)},!0),C("fixedGutter",!0,function(v,x){v.display.gutters.style.left=x?El(v.display)+"px":"0",v.refresh()},!0),C("coverGutterNextToScrollbar",!1,function(v){return na(v)},!0),C("scrollbarStyle","native",function(v){ih(v),na(v),v.display.scrollbars.setScrollTop(v.doc.scrollTop),v.display.scrollbars.setScrollLeft(v.doc.scrollLeft)},!0),C("lineNumbers",!1,function(v){Nl(v.options),jr(v)},!0),C("firstLineNumber",1,jr,!0),C("lineNumberFormatter",function(v){return v},jr,!0),C("showCursorWhenSelecting",!1,Va,!0),C("resetSelectionOnContextMenu",!0),C("lineWiseCopyCut",!0),C("readOnly",!1,function(v,x){x=="nocursor"?(Ua(v),v.display.input.blur(),v.display.disabled=!0):v.display.disabled=!1,v.display.input.readOnlyChanged(x)}),C("disableInput",!1,function(v,x){x||v.display.input.reset()},!0),C("dragDrop",!0,ya),C("allowDropFileTypes",null),C("cursorBlinkRate",530),C("cursorScrollMargin",0),C("cursorHeight",1,Va,!0),C("singleCursorHeightPerLine",!0,Va,!0),C("workTime",100),C("workDelay",100),C("flattenSpans",!0,Wa,!0),C("addModeClass",!1,Wa,!0),C("pollInterval",100),C("undoDepth",200,function(v,x){return v.doc.history.undoDepth=x}),C("historyEventDelay",1250),C("viewportMargin",10,function(v){return v.refresh()},!0),C("maxHighlightLength",1e4,Wa,!0),C("moveInputWithCursor",!0,function(v,x){x||v.display.input.resetPosition()}),C("tabindex",null,function(v,x){return v.display.input.getField().tabIndex=x||""}),C("autofocus",null)}function jr(l){hs(l),on(l),Ml(l)}function ya(l,m,C){var v=C&&C!=fs;if(!m!=!v){var x=l.display.dragFunctions,P=m?qt:Ln;P(l.display.scroller,"dragstart",x.start),P(l.display.scroller,"dragenter",x.enter),P(l.display.scroller,"dragover",x.over),P(l.display.scroller,"dragleave",x.leave),P(l.display.scroller,"drop",x.drop)}}function no(l){l.options.lineWrapping?(ve(l.display.wrapper,"CodeMirror-wrap"),l.display.sizer.style.minWidth="",l.display.sizerWidth=null):(K(l.display.wrapper,"CodeMirror-wrap"),vo(l)),xl(l),on(l),Fa(l),setTimeout(function(){return na(l)},100)}function di(l,m){var C=this;if(!(this instanceof di))return new di(l,m);this.options=m=m?Ue(m):{},Ue(Gs,m,!1),Nl(m);var v=m.value;typeof v=="string"&&(v=new An(v,m.mode,null,m.lineSeparator)),this.doc=v;var x=new di.inputStyles[m.inputStyle](this),P=this.display=new Lt(l,v,x);P.wrapper.CodeMirror=this,hs(this),zs(this),m.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),ih(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new it,keySeq:null,specialChars:null},m.autofocus&&!k&&P.input.focus(),s&&a<11&&setTimeout(function(){return C.display.input.reset(!0)},20),ro(this),Gc(),os(this),this.curOp.forceUpdate=!0,oh(this,v),m.autofocus&&!k||this.hasFocus()?setTimeout(qe(Rl,this),20):Ua(this);for(var U in gs)gs.hasOwnProperty(U)&&gs[U](C,m[U],fs);Jd(this),m.finishInit&&m.finishInit(this);for(var W=0;W<_s.length;++W)_s[W](C);ra(this),d&&m.lineWrapping&&getComputedStyle(P.lineDiv).textRendering=="optimizelegibility"&&(P.lineDiv.style.textRendering="auto")}di.defaults=Gs,di.optionHandlers=gs;function ro(l){var m=l.display;qt(m.scroller,"mousedown",pn(l,to)),s&&a<11?qt(m.scroller,"dblclick",pn(l,function(X){if(!Ji(l,X)){var J=Ds(l,X);if(!(!J||Li(l,X)||Fr(l.display,X))){un(X);var de=l.findWordAt(J);ln(l.doc,de.anchor,de.head)}}})):qt(m.scroller,"dblclick",function(X){return Ji(l,X)||un(X)}),O||qt(m.scroller,"contextmenu",function(X){return io(l,X)});var C,v={end:0};function x(){m.activeTouch&&(C=setTimeout(function(){return m.activeTouch=null},1e3),v=m.activeTouch,v.end=+new Date)}function P(X){if(X.touches.length!=1)return!1;var J=X.touches[0];return J.radiusX<=1&&J.radiusY<=1}function U(X,J){if(J.left==null)return!0;var de=J.left-X.left,_e=J.top-X.top;return de*de+_e*_e>20*20}qt(m.scroller,"touchstart",function(X){if(!Ji(l,X)&&!P(X)){m.input.ensurePolled(),clearTimeout(C);var J=+new Date;m.activeTouch={start:J,moved:!1,prev:J-v.end<=300?v:null},X.touches.length==1&&(m.activeTouch.left=X.touches[0].pageX,m.activeTouch.top=X.touches[0].pageY)}}),qt(m.scroller,"touchmove",function(){m.activeTouch&&(m.activeTouch.moved=!0)}),qt(m.scroller,"touchend",function(X){var J=m.activeTouch;if(J&&!Fr(m,X)&&J.left!=null&&!J.moved&&new Date-J.start<300){var de=l.coordsChar(m.activeTouch,"page"),_e;!J.prev||U(J,J.prev)?_e=new ai(de,de):!J.prev.prev||U(J,J.prev.prev)?_e=l.findWordAt(de):_e=new ai(Ye(de.line,0),Ft(l.doc,Ye(de.line+1,0))),l.setSelection(_e.anchor,_e.head),l.focus(),un(X)}x()}),qt(m.scroller,"touchcancel",x),qt(m.scroller,"scroll",function(){m.scroller.clientHeight&&(za(l,m.scroller.scrollTop),ia(l,m.scroller.scrollLeft,!0),Oi(l,"scroll",l))}),qt(m.scroller,"mousewheel",function(X){return Zd(l,X)}),qt(m.scroller,"DOMMouseScroll",function(X){return Zd(l,X)}),qt(m.wrapper,"scroll",function(){return m.wrapper.scrollTop=m.wrapper.scrollLeft=0}),m.dragFunctions={enter:function(X){Ji(l,X)||Br(X)},over:function(X){Ji(l,X)||(Ih(l,X),Br(X))},start:function(X){return Ya(l,X)},drop:pn(l,zc),leave:function(X){Ji(l,X)||ql(l)}};var W=m.input.getField();qt(W,"keyup",function(X){return eo.call(l,X)}),qt(W,"keydown",pn(l,Us)),qt(W,"keypress",pn(l,Wr)),qt(W,"focus",function(X){return Rl(l,X)}),qt(W,"blur",function(X){return Ua(l,X)})}var _s=[];di.defineInitHook=function(l){return _s.push(l)};function qr(l,m,C,v){var x=l.doc,P;C==null&&(C="add"),C=="smart"&&(x.mode.indent?P=as(l,m):C="prev");var U=l.options.tabSize,W=tt(x,m),X=Ge(W.text,null,U);W.stateAfter&&(W.stateAfter=null);var J=W.text.match(/^\s*/)[0],de;if(!v&&!/\S/.test(W.text))de=0,C="not";else if(C=="smart"&&(de=x.mode.indent(P,W.text.slice(J.length),W.text),de==Yt||de>150)){if(!v)return;C="prev"}C=="prev"?m>x.first?de=Ge(tt(x,m-1).text,null,U):de=0:C=="add"?de=X+l.options.indentUnit:C=="subtract"?de=X-l.options.indentUnit:typeof C=="number"&&(de=X+C),de=Math.max(0,de);var _e="",xe=0;if(l.options.indentWithTabs)for(var ze=Math.floor(de/U);ze;--ze)xe+=U,_e+="	";if(xe<de&&(_e+=vi(de-xe)),_e!=J)return ha(x,_e,Ye(m,0),Ye(m,J.length),"+input"),W.stateAfter=null,!0;for(var Oe=0;Oe<x.sel.ranges.length;Oe++){var Ke=x.sel.ranges[Oe];if(Ke.head.line==m&&Ke.head.ch<J.length){var ht=Ye(m,J.length);zl(x,Oe,new ai(ht,ht));break}}}var vn=null;function vs(l){vn=l}function ys(l,m,C,v,x){var P=l.doc;l.display.shift=!1,v||(v=P.sel);var U=l.state.pasteIncoming||x=="paste",W=Ro(m),X=null;if(U&&v.ranges.length>1)if(vn&&vn.text.join(`
`)==m){if(v.ranges.length%vn.text.length==0){X=[];for(var J=0;J<vn.text.length;J++)X.push(P.splitLines(vn.text[J]))}}else W.length==v.ranges.length&&(X=bi(W,function(ht){return[ht]}));for(var de,_e=v.ranges.length-1;_e>=0;_e--){var xe=v.ranges[_e],ze=xe.from(),Oe=xe.to();xe.empty()&&(C&&C>0?ze=Ye(ze.line,ze.ch-C):l.state.overwrite&&!U?Oe=Ye(Oe.line,Math.min(tt(P,Oe.line).text.length,Oe.ch+Xe(W).length)):vn&&vn.lineWise&&vn.text.join(`
`)==m&&(ze=Oe=Ye(ze.line,0))),de=l.curOp.updateInput;var Ke={from:ze,to:Oe,text:X?X[_e%X.length]:W,origin:x||(U?"paste":l.state.cutIncoming?"cut":"+input")};da(l.doc,Ke),Un(l,"inputRead",l,Ke)}m&&!U&&Hs(l,m),Mt(l),l.curOp.updateInput=de,l.curOp.typing=!0,l.state.pasteIncoming=l.state.cutIncoming=!1}function Sa(l,m){var C=l.clipboardData&&l.clipboardData.getData("Text");if(C)return l.preventDefault(),!m.isReadOnly()&&!m.options.disableInput&&tn(m,function(){return ys(m,C,0,null,"paste")}),!0}function Hs(l,m){if(!(!l.options.electricChars||!l.options.smartIndent))for(var C=l.doc.sel,v=C.ranges.length-1;v>=0;v--){var x=C.ranges[v];if(!(x.head.ch>100||v&&C.ranges[v-1].head.line==x.head.line)){var P=l.getModeAt(x.head),U=!1;if(P.electricChars){for(var W=0;W<P.electricChars.length;W++)if(m.indexOf(P.electricChars.charAt(W))>-1){U=qr(l,x.head.line,"smart");break}}else P.electricInput&&P.electricInput.test(tt(l.doc,x.head.line).text.slice(0,x.head.ch))&&(U=qr(l,x.head.line,"smart"));U&&Un(l,"electricInput",l,x.head.line)}}}function ba(l){for(var m=[],C=[],v=0;v<l.doc.sel.ranges.length;v++){var x=l.doc.sel.ranges[v].head.line,P={anchor:Ye(x,0),head:Ye(x+1,0)};C.push(P),m.push(l.getRange(P.anchor,P.head))}return{text:m,ranges:C}}function Ws(l,m){l.setAttribute("autocorrect","off"),l.setAttribute("autocapitalize","off"),l.setAttribute("spellcheck",!!m)}function Ca(){var l=se("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),m=se("div",[l],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return d?l.style.width="1000px":l.setAttribute("wrap","off"),E&&(l.style.border="1px solid black"),Ws(l),m}function wa(l){var m=l.optionHandlers,C=l.helpers={};l.prototype={constructor:l,focus:function(){window.focus(),this.display.input.focus()},setOption:function(v,x){var P=this.options,U=P[v];P[v]==x&&v!="mode"||(P[v]=x,m.hasOwnProperty(v)&&pn(this,m[v])(this,x,U),Oi(this,"optionChange",this,v))},getOption:function(v){return this.options[v]},getDoc:function(){return this.doc},addKeyMap:function(v,x){this.state.keyMaps[x?"push":"unshift"](fr(v))},removeKeyMap:function(v){for(var x=this.state.keyMaps,P=0;P<x.length;++P)if(x[P]==v||x[P].name==v)return x.splice(P,1),!0},addOverlay:xt(function(v,x){var P=v.token?v:l.getMode(this.options,v);if(P.startState)throw new Error("Overlays may not be stateful.");st(this.state.overlays,{mode:P,modeSpec:v,opaque:x&&x.opaque,priority:x&&x.priority||0},function(U){return U.priority}),this.state.modeGen++,on(this)}),removeOverlay:xt(function(v){for(var x=this,P=this.state.overlays,U=0;U<P.length;++U){var W=P[U].modeSpec;if(W==v||typeof v=="string"&&W.name==v){P.splice(U,1),x.state.modeGen++,on(x);return}}}),indentLine:xt(function(v,x,P){typeof x!="string"&&typeof x!="number"&&(x==null?x=this.options.smartIndent?"smart":"prev":x=x?"add":"subtract"),er(this.doc,v)&&qr(this,v,x,P)}),indentSelection:xt(function(v){for(var x=this,P=this.doc.sel.ranges,U=-1,W=0;W<P.length;W++){var X=P[W];if(X.empty())X.head.line>U&&(qr(x,X.head.line,v,!0),U=X.head.line,W==x.doc.sel.primIndex&&Mt(x));else{var J=X.from(),de=X.to(),_e=Math.max(U,J.line);U=Math.min(x.lastLine(),de.line-(de.ch?0:1))+1;for(var xe=_e;xe<U;++xe)qr(x,xe,v);var ze=x.doc.sel.ranges;J.ch==0&&P.length==ze.length&&ze[W].from().ch>0&&zl(x.doc,W,new ai(J,ze[W].to()),ni)}}}),getTokenAt:function(v,x){return wd(this,v,x)},getLineTokens:function(v,x){return wd(this,Ye(v),x,!0)},getTokenTypeAt:function(v){v=Ft(this.doc,v);var x=rr(this,tt(this.doc,v.line)),P=0,U=(x.length-1)/2,W=v.ch,X;if(W==0)X=x[2];else for(;;){var J=P+U>>1;if((J?x[J*2-1]:0)>=W)U=J;else if(x[J*2+1]<W)P=J+1;else{X=x[J*2+2];break}}var de=X?X.indexOf("overlay "):-1;return de<0?X:de==0?null:X.slice(0,de-1)},getModeAt:function(v){var x=this.doc.mode;return x.innerMode?l.innerMode(x,this.getTokenAt(v).state).mode:x},getHelper:function(v,x){return this.getHelpers(v,x)[0]},getHelpers:function(v,x){var P=this,U=[];if(!C.hasOwnProperty(x))return U;var W=C[x],X=this.getModeAt(v);if(typeof X[x]=="string")W[X[x]]&&U.push(W[X[x]]);else if(X[x])for(var J=0;J<X[x].length;J++){var de=W[X[x][J]];de&&U.push(de)}else X.helperType&&W[X.helperType]?U.push(W[X.helperType]):W[X.name]&&U.push(W[X.name]);for(var _e=0;_e<W._global.length;_e++){var xe=W._global[_e];xe.pred(X,P)&&lt(U,xe.val)==-1&&U.push(xe.val)}return U},getStateAfter:function(v,x){var P=this.doc;return v=Nr(P,v==null?P.first+P.size-1:v),as(this,v+1,x)},cursorCoords:function(v,x){var P,U=this.doc.sel.primary();return v==null?P=U.head:typeof v=="object"?P=Ft(this.doc,v):P=v?U.from():U.to(),Or(this,P,x||"page")},charCoords:function(v,x){return Cl(this,Ft(this.doc,v),x||"page")},coordsChar:function(v,x){return v=Wd(this,v,x||"page"),wl(this,v.left,v.top)},lineAtHeight:function(v,x){return v=Wd(this,{top:v,left:0},x||"page").top,On(this.doc,v+this.display.viewOffset)},heightAtLine:function(v,x,P){var U=!1,W;if(typeof v=="number"){var X=this.doc.first+this.doc.size-1;v<this.doc.first?v=this.doc.first:v>X&&(v=X,U=!0),W=tt(this.doc,v)}else W=v;return bl(this,W,{top:0,left:0},x||"page",P).top+(U?this.doc.height-ur(W):0)},defaultTextHeight:function(){return ks(this.display)},defaultCharWidth:function(){return Oa(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(v,x,P,U,W){var X=this.display;v=Or(this,Ft(this.doc,v));var J=v.bottom,de=v.left;if(x.style.position="absolute",x.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(x),X.sizer.appendChild(x),U=="over")J=v.top;else if(U=="above"||U=="near"){var _e=Math.max(X.wrapper.clientHeight,this.doc.height),xe=Math.max(X.sizer.clientWidth,X.lineSpace.clientWidth);(U=="above"||v.bottom+x.offsetHeight>_e)&&v.top>x.offsetHeight?J=v.top-x.offsetHeight:v.bottom+x.offsetHeight<=_e&&(J=v.bottom),de+x.offsetWidth>xe&&(de=xe-x.offsetWidth)}x.style.top=J+"px",x.style.left=x.style.right="",W=="right"?(de=X.sizer.clientWidth-x.offsetWidth,x.style.right="0px"):(W=="left"?de=0:W=="middle"&&(de=(X.sizer.clientWidth-x.offsetWidth)/2),x.style.left=de+"px"),P&&Si(this,de,J,de+x.offsetWidth,J+x.offsetHeight)},triggerOnKeyDown:xt(Us),triggerOnKeyPress:xt(Wr),triggerOnKeyUp:eo,execCommand:function(v){if(Hr.hasOwnProperty(v))return Hr[v].call(null,this)},triggerElectric:xt(function(v){Hs(this,v)}),findPosH:function(v,x,P,U){var W=this,X=1;x<0&&(X=-1,x=-x);for(var J=Ft(this.doc,v),de=0;de<x&&(J=js(W.doc,J,X,P,U),!J.hitSide);++de);return J},moveH:xt(function(v,x){var P=this;this.extendSelectionsBy(function(U){return P.display.shift||P.doc.extend||U.empty()?js(P.doc,U.head,v,x,P.options.rtlMoveVisually):v<0?U.from():U.to()},He)}),deleteH:xt(function(v,x){var P=this.doc.sel,U=this.doc;P.somethingSelected()?U.replaceSelection("",null,"+delete"):Vs(this,function(W){var X=js(U,W.head,v,x,!1);return v<0?{from:X,to:W.head}:{from:W.head,to:X}})}),findPosV:function(v,x,P,U){var W=this,X=1,J=U;x<0&&(X=-1,x=-x);for(var de=Ft(this.doc,v),_e=0;_e<x;++_e){var xe=Or(W,de,"div");if(J==null?J=xe.left:xe.left=J,de=qs(W,xe,X,P),de.hitSide)break}return de},moveV:xt(function(v,x){var P=this,U=this.doc,W=[],X=!this.display.shift&&!U.extend&&U.sel.somethingSelected();if(U.extendSelectionsBy(function(de){if(X)return v<0?de.from():de.to();var _e=Or(P,de.head,"div");de.goalColumn!=null&&(_e.left=de.goalColumn),W.push(_e.left);var xe=qs(P,_e,v,x);return x=="page"&&de==U.sel.primary()&&Dl(P,null,Cl(P,xe,"div").top-_e.top),xe},He),W.length)for(var J=0;J<U.sel.ranges.length;J++)U.sel.ranges[J].goalColumn=W[J]}),findWordAt:function(v){var x=this.doc,P=tt(x,v.line).text,U=v.ch,W=v.ch;if(P){var X=this.getHelper(v,"wordChars");(v.xRel<0||W==P.length)&&U?--U:++W;for(var J=P.charAt(U),de=$e(J,X)?function(_e){return $e(_e,X)}:/\s/.test(J)?function(_e){return/\s/.test(_e)}:function(_e){return!/\s/.test(_e)&&!$e(_e)};U>0&&de(P.charAt(U-1));)--U;for(;W<P.length&&de(P.charAt(W));)++W}return new ai(Ye(v.line,U),Ye(v.line,W))},toggleOverwrite:function(v){v!=null&&v==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?ve(this.display.cursorDiv,"CodeMirror-overwrite"):K(this.display.cursorDiv,"CodeMirror-overwrite"),Oi(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==te()},isReadOnly:function(){return!!(this.options.readOnly||this.doc.cantEdit)},scrollTo:xt(function(v,x){(v!=null||x!=null)&&Pt(this),v!=null&&(this.curOp.scrollLeft=v),x!=null&&(this.curOp.scrollTop=x)}),getScrollInfo:function(){var v=this.display.scroller;return{left:v.scrollLeft,top:v.scrollTop,height:v.scrollHeight-xr(this)-this.display.barHeight,width:v.scrollWidth-xr(this)-this.display.barWidth,clientHeight:_l(this),clientWidth:Rs(this)}},scrollIntoView:xt(function(v,x){if(v==null?(v={from:this.doc.sel.primary().head,to:null},x==null&&(x=this.options.cursorScrollMargin)):typeof v=="number"?v={from:Ye(v,0),to:null}:v.from==null&&(v={from:v,to:null}),v.to||(v.to=v.from),v.margin=x||0,v.from.line!=null)Pt(this),this.curOp.scrollToPos=v;else{var P=Tn(this,Math.min(v.from.left,v.to.left),Math.min(v.from.top,v.to.top)-v.margin,Math.max(v.from.right,v.to.right),Math.max(v.from.bottom,v.to.bottom)+v.margin);this.scrollTo(P.scrollLeft,P.scrollTop)}}),setSize:xt(function(v,x){var P=this,U=function(X){return typeof X=="number"||/^\d+$/.test(String(X))?X+"px":X};v!=null&&(this.display.wrapper.style.width=U(v)),x!=null&&(this.display.wrapper.style.height=U(x)),this.options.lineWrapping&&zd(this);var W=this.display.viewFrom;this.doc.iter(W,this.display.viewTo,function(X){if(X.widgets){for(var J=0;J<X.widgets.length;J++)if(X.widgets[J].noHScroll){sr(P,W,"widget");break}}++W}),this.curOp.forceUpdate=!0,Oi(this,"refresh",this)}),operation:function(v){return tn(this,v)},refresh:xt(function(){var v=this.display.cachedTextHeight;on(this),this.curOp.forceUpdate=!0,Fa(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),Vr(this),(v==null||Math.abs(v-ks(this.display))>.5)&&xl(this),Oi(this,"refresh",this)}),swapDoc:xt(function(v){var x=this.doc;return x.cm=null,oh(this,v),Fa(this),this.display.input.reset(),this.scrollTo(v.scrollLeft,v.scrollTop),this.curOp.forceScroll=!0,Un(this,"swapDoc",this,x),x}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Er(l),l.registerHelper=function(v,x,P){C.hasOwnProperty(v)||(C[v]=l[v]={_global:[]}),C[v][x]=P},l.registerGlobalHelper=function(v,x,P,U){l.registerHelper(v,x,U),C[v]._global.push({pred:P,val:U})}}function js(l,m,C,v,x){var P=m.line,U=m.ch,W=C,X=tt(l,P);function J(){var dt=P+C;return dt<l.first||dt>=l.first+l.size?!1:(P=dt,X=tt(l,dt))}function de(dt){var Vt=(x?Co:ll)(X,U,C,!0);if(Vt==null)if(!dt&&J())x?U=(C<0?Da:ka)(X):U=C<0?X.text.length:0;else return!1;else U=Vt;return!0}if(v=="char")de();else if(v=="column")de(!0);else if(v=="word"||v=="group")for(var _e=null,xe=v=="group",ze=l.cm&&l.cm.getHelper(m,"wordChars"),Oe=!0;!(C<0&&!de(!Oe));Oe=!1){var Ke=X.text.charAt(U)||`
`,ht=$e(Ke,ze)?"w":xe&&Ke==`
`?"n":!xe||/\s/.test(Ke)?null:"p";if(xe&&!Oe&&!ht&&(ht="s"),_e&&_e!=ht){C<0&&(C=1,de());break}if(ht&&(_e=ht),C>0&&!de(!Oe))break}var Bt=Oo(l,Ye(P,U),m,W,!0);return Rt(m,Bt)||(Bt.hitSide=!0),Bt}function qs(l,m,C,v){var x=l.doc,P=m.left,U;if(v=="page"){var W=Math.min(l.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),X=Math.max(W-.5*ks(l.display),3);U=(C>0?m.bottom:m.top)+C*X}else v=="line"&&(U=C>0?m.bottom+3:m.top-3);for(var J;J=wl(l,P,U),!!J.outside;){if(C<0?U<=0:U>=x.height){J.hitSide=!0;break}U+=C*5}return J}var Ni=function(l){this.cm=l,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new it,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};Ni.prototype.init=function(l){var m=this,C=this,v=C.cm,x=C.div=l.lineDiv;Ws(x,v.options.spellcheck),qt(x,"paste",function(U){Ji(v,U)||Sa(U,v)||a<=11&&setTimeout(pn(v,function(){C.pollContent()||on(v)}),20)}),qt(x,"compositionstart",function(U){m.composing={data:U.data,done:!1}}),qt(x,"compositionupdate",function(U){m.composing||(m.composing={data:U.data,done:!1})}),qt(x,"compositionend",function(U){m.composing&&(U.data!=m.composing.data&&m.readFromDOMSoon(),m.composing.done=!0)}),qt(x,"touchstart",function(){return C.forceCompositionEnd()}),qt(x,"input",function(){m.composing||m.readFromDOMSoon()});function P(U){if(!Ji(v,U)){if(v.somethingSelected())vs({lineWise:!1,text:v.getSelections()}),U.type=="cut"&&v.replaceSelection("",null,"cut");else if(v.options.lineWiseCopyCut){var W=ba(v);vs({lineWise:!0,text:W.text}),U.type=="cut"&&v.operation(function(){v.setSelections(W.ranges,0,ni),v.replaceSelection("",null,"cut")})}else return;if(U.clipboardData){U.clipboardData.clearData();var X=vn.text.join(`
`);if(U.clipboardData.setData("Text",X),U.clipboardData.getData("Text")==X){U.preventDefault();return}}var J=Ca(),de=J.firstChild;v.display.lineSpace.insertBefore(J,v.display.lineSpace.firstChild),de.value=vn.text.join(`
`);var _e=document.activeElement;Be(de),setTimeout(function(){v.display.lineSpace.removeChild(J),_e.focus(),_e==x&&C.showPrimarySelection()},50)}}qt(x,"copy",P),qt(x,"cut",P)},Ni.prototype.prepareSelection=function(){var l=Kd(this.cm,!1);return l.focus=this.cm.state.focused,l},Ni.prototype.showSelection=function(l,m){!l||!this.cm.display.view.length||((l.focus||m)&&this.showPrimarySelection(),this.showMultipleSelections(l))},Ni.prototype.showPrimarySelection=function(){var l=window.getSelection(),m=this.cm.doc.sel.primary(),C=jo(this.cm,l.anchorNode,l.anchorOffset),v=jo(this.cm,l.focusNode,l.focusOffset);if(!(C&&!C.bad&&v&&!v.bad&&Rt(Hi(C,v),m.from())==0&&Rt(Vn(C,v),m.to())==0)){var x=Yl(this.cm,m.from()),P=Yl(this.cm,m.to());if(!(!x&&!P)){var U=this.cm.display.view,W=l.rangeCount&&l.getRangeAt(0);if(!x)x={node:U[0].measure.map[2],offset:0};else if(!P){var X=U[U.length-1].measure,J=X.maps?X.maps[X.maps.length-1]:X.map;P={node:J[J.length-1],offset:J[J.length-2]-J[J.length-3]}}var de;try{de=ce(x.node,x.offset,P.offset,P.node)}catch{}de&&(!t&&this.cm.state.focused?(l.collapse(x.node,x.offset),de.collapsed||(l.removeAllRanges(),l.addRange(de))):(l.removeAllRanges(),l.addRange(de)),W&&l.anchorNode==null?l.addRange(W):t&&this.startGracePeriod()),this.rememberSelection()}}},Ni.prototype.startGracePeriod=function(){var l=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){l.gracePeriod=!1,l.selectionChanged()&&l.cm.operation(function(){return l.cm.curOp.selectionChanged=!0})},20)},Ni.prototype.showMultipleSelections=function(l){Y(this.cm.display.cursorDiv,l.cursors),Y(this.cm.display.selectionDiv,l.selection)},Ni.prototype.rememberSelection=function(){var l=window.getSelection();this.lastAnchorNode=l.anchorNode,this.lastAnchorOffset=l.anchorOffset,this.lastFocusNode=l.focusNode,this.lastFocusOffset=l.focusOffset},Ni.prototype.selectionInEditor=function(){var l=window.getSelection();if(!l.rangeCount)return!1;var m=l.getRangeAt(0).commonAncestorContainer;return le(this.div,m)},Ni.prototype.focus=function(){this.cm.options.readOnly!="nocursor"&&(this.selectionInEditor()||this.showSelection(this.prepareSelection(),!0),this.div.focus())},Ni.prototype.blur=function(){this.div.blur()},Ni.prototype.getField=function(){return this.div},Ni.prototype.supportsTouch=function(){return!0},Ni.prototype.receivedFocus=function(){var l=this;this.selectionInEditor()?this.pollSelection():tn(this.cm,function(){return l.cm.curOp.selectionChanged=!0});function m(){l.cm.state.focused&&(l.pollSelection(),l.polling.set(l.cm.options.pollInterval,m))}this.polling.set(this.cm.options.pollInterval,m)},Ni.prototype.selectionChanged=function(){var l=window.getSelection();return l.anchorNode!=this.lastAnchorNode||l.anchorOffset!=this.lastAnchorOffset||l.focusNode!=this.lastFocusNode||l.focusOffset!=this.lastFocusOffset},Ni.prototype.pollSelection=function(){if(!this.composing&&this.readDOMTimeout==null&&!this.gracePeriod&&this.selectionChanged()){var l=window.getSelection(),m=this.cm;this.rememberSelection();var C=jo(m,l.anchorNode,l.anchorOffset),v=jo(m,l.focusNode,l.focusOffset);C&&v&&tn(m,function(){En(m.doc,zn(C,v),ni),(C.bad||v.bad)&&(m.curOp.selectionChanged=!0)})}},Ni.prototype.pollContent=function(){this.readDOMTimeout!=null&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var l=this.cm,m=l.display,C=l.doc.sel.primary(),v=C.from(),x=C.to();if(v.ch==0&&v.line>l.firstLine()&&(v=Ye(v.line-1,tt(l.doc,v.line-1).length)),x.ch==tt(l.doc,x.line).text.length&&x.line<l.lastLine()&&(x=Ye(x.line+1,0)),v.line<m.viewFrom||x.line>m.viewTo-1)return!1;var P,U,W;v.line==m.viewFrom||(P=Ls(l,v.line))==0?(U=ti(m.view[0].line),W=m.view[0].node):(U=ti(m.view[P].line),W=m.view[P-1].node.nextSibling);var X=Ls(l,x.line),J,de;if(X==m.view.length-1?(J=m.viewTo-1,de=m.lineDiv.lastChild):(J=ti(m.view[X+1].line)-1,de=m.view[X+1].node.previousSibling),!W)return!1;for(var _e=l.doc.splitLines(so(l,W,de,U,J)),xe=yi(l.doc,Ye(U,0),Ye(J,tt(l.doc,J).text.length));_e.length>1&&xe.length>1;)if(Xe(_e)==Xe(xe))_e.pop(),xe.pop(),J--;else if(_e[0]==xe[0])_e.shift(),xe.shift(),U++;else break;for(var ze=0,Oe=0,Ke=_e[0],ht=xe[0],Bt=Math.min(Ke.length,ht.length);ze<Bt&&Ke.charCodeAt(ze)==ht.charCodeAt(ze);)++ze;for(var dt=Xe(_e),Vt=Xe(xe),Ut=Math.min(dt.length-(_e.length==1?ze:0),Vt.length-(xe.length==1?ze:0));Oe<Ut&&dt.charCodeAt(dt.length-Oe-1)==Vt.charCodeAt(Vt.length-Oe-1);)++Oe;_e[_e.length-1]=dt.slice(0,dt.length-Oe).replace(/^\u200b+/,""),_e[0]=_e[0].slice(ze).replace(/\u200b+$/,"");var wt=Ye(U,ze),Ht=Ye(J,xe.length?Xe(xe).length-Oe:0);if(_e.length>1||_e[0]||Rt(wt,Ht))return ha(l.doc,_e,wt,Ht,"+input"),!0},Ni.prototype.ensurePolled=function(){this.forceCompositionEnd()},Ni.prototype.reset=function(){this.forceCompositionEnd()},Ni.prototype.forceCompositionEnd=function(){!this.composing||(clearTimeout(this.readDOMTimeout),this.composing=null,this.pollContent()||on(this.cm),this.div.blur(),this.div.focus())},Ni.prototype.readFromDOMSoon=function(){var l=this;this.readDOMTimeout==null&&(this.readDOMTimeout=setTimeout(function(){if(l.readDOMTimeout=null,l.composing)if(l.composing.done)l.composing=null;else return;(l.cm.isReadOnly()||!l.pollContent())&&tn(l.cm,function(){return on(l.cm)})},80))},Ni.prototype.setUneditable=function(l){l.contentEditable="false"},Ni.prototype.onKeyPress=function(l){l.preventDefault(),this.cm.isReadOnly()||pn(this.cm,ys)(this.cm,String.fromCharCode(l.charCode==null?l.keyCode:l.charCode),0)},Ni.prototype.readOnlyChanged=function(l){this.div.contentEditable=String(l!="nocursor")},Ni.prototype.onContextMenu=function(){},Ni.prototype.resetPosition=function(){},Ni.prototype.needsContentAttribute=!0;function Yl(l,m){var C=vl(l,m.line);if(!C||C.hidden)return null;var v=tt(l.doc,m.line),x=Bd(C,v,m.line),P=ir(v),U="left";if(P){var W=La(P,m.ch);U=W%2?"right":"left"}var X=Vd(x.map,m.ch,U);return X.offset=X.collapse=="right"?X.end:X.start,X}function Rr(l,m){return m&&(l.bad=!0),l}function so(l,m,C,v,x){var P="",U=!1,W=l.doc.lineSeparator();function X(de){return function(_e){return _e.id==de}}function J(de){if(de.nodeType==1){var _e=de.getAttribute("cm-text");if(_e!=null){_e==""?P+=de.textContent.replace(/\u200b/g,""):P+=_e;return}var xe=de.getAttribute("cm-marker"),ze;if(xe){var Oe=l.findMarks(Ye(v,0),Ye(x+1,0),X(+xe));Oe.length&&(ze=Oe[0].find())&&(P+=yi(l.doc,ze.from,ze.to).join(W));return}if(de.getAttribute("contenteditable")=="false")return;for(var Ke=0;Ke<de.childNodes.length;Ke++)J(de.childNodes[Ke]);/^(pre|div|p)$/i.test(de.nodeName)&&(U=!0)}else if(de.nodeType==3){var ht=de.nodeValue;if(!ht)return;U&&(P+=W,U=!1),P+=ht}}for(;J(m),m!=C;)m=m.nextSibling;return P}function jo(l,m,C){var v;if(m==l.display.lineDiv){if(v=l.display.lineDiv.childNodes[C],!v)return Rr(l.clipPos(Ye(l.display.viewTo-1)),!0);m=null,C=0}else for(v=m;;v=v.parentNode){if(!v||v==l.display.lineDiv)return null;if(v.parentNode&&v.parentNode==l.display.lineDiv)break}for(var x=0;x<l.display.view.length;x++){var P=l.display.view[x];if(P.node==v)return Yc(P,m,C)}}function Yc(l,m,C){var v=l.text.firstChild,x=!1;if(!m||!le(v,m))return Rr(Ye(ti(l.line),0),!0);if(m==v&&(x=!0,m=v.childNodes[C],C=0,!m)){var P=l.rest?Xe(l.rest):l.line;return Rr(Ye(ti(P),P.text.length),x)}var U=m.nodeType==3?m:null,W=m;for(!U&&m.childNodes.length==1&&m.firstChild.nodeType==3&&(U=m.firstChild,C&&(C=U.nodeValue.length));W.parentNode!=v;)W=W.parentNode;var X=l.measure,J=X.maps;function de(ht,Bt,dt){for(var Vt=-1;Vt<(J?J.length:0);Vt++)for(var Ut=Vt<0?X.map:J[Vt],wt=0;wt<Ut.length;wt+=3){var Ht=Ut[wt+2];if(Ht==ht||Ht==Bt){var Kt=ti(Vt<0?l.line:l.rest[Vt]),gi=Ut[wt]+dt;return(dt<0||Ht!=ht)&&(gi=Ut[wt+(dt?1:0)]),Ye(Kt,gi)}}}var _e=de(U,W,C);if(_e)return Rr(_e,x);for(var xe=W.nextSibling,ze=U?U.nodeValue.length-C:0;xe;xe=xe.nextSibling){if(_e=de(xe,xe.firstChild,0),_e)return Rr(Ye(_e.line,_e.ch-ze),x);ze+=xe.textContent.length}for(var Oe=W.previousSibling,Ke=C;Oe;Oe=Oe.previousSibling){if(_e=de(Oe,Oe.firstChild,-1),_e)return Rr(Ye(_e.line,_e.ch+Ke),x);Ke+=Oe.textContent.length}}var dn=function(l){this.cm=l,this.prevInput="",this.pollingFast=!1,this.polling=new it,this.inaccurateSelection=!1,this.hasSelection=!1,this.composing=null};dn.prototype.init=function(l){var m=this,C=this,v=this.cm,x=this.wrapper=Ca(),P=this.textarea=x.firstChild;l.wrapper.insertBefore(x,l.wrapper.firstChild),E&&(P.style.width="0px"),qt(P,"input",function(){s&&a>=9&&m.hasSelection&&(m.hasSelection=null),C.poll()}),qt(P,"paste",function(W){Ji(v,W)||Sa(W,v)||(v.state.pasteIncoming=!0,C.fastPoll())});function U(W){if(!Ji(v,W)){if(v.somethingSelected())vs({lineWise:!1,text:v.getSelections()}),C.inaccurateSelection&&(C.prevInput="",C.inaccurateSelection=!1,P.value=vn.text.join(`
`),Be(P));else if(v.options.lineWiseCopyCut){var X=ba(v);vs({lineWise:!0,text:X.text}),W.type=="cut"?v.setSelections(X.ranges,null,ni):(C.prevInput="",P.value=X.text.join(`
`),Be(P))}else return;W.type=="cut"&&(v.state.cutIncoming=!0)}}qt(P,"cut",U),qt(P,"copy",U),qt(l.scroller,"paste",function(W){Fr(l,W)||Ji(v,W)||(v.state.pasteIncoming=!0,C.focus())}),qt(l.lineSpace,"selectstart",function(W){Fr(l,W)||un(W)}),qt(P,"compositionstart",function(){var W=v.getCursor("from");C.composing&&C.composing.range.clear(),C.composing={start:W,range:v.markText(W,v.getCursor("to"),{className:"CodeMirror-composing"})}}),qt(P,"compositionend",function(){C.composing&&(C.poll(),C.composing.range.clear(),C.composing=null)})},dn.prototype.prepareSelection=function(){var l=this.cm,m=l.display,C=l.doc,v=Kd(l);if(l.options.moveInputWithCursor){var x=Or(l,C.sel.primary().head,"div"),P=m.wrapper.getBoundingClientRect(),U=m.lineDiv.getBoundingClientRect();v.teTop=Math.max(0,Math.min(m.wrapper.clientHeight-10,x.top+U.top-P.top)),v.teLeft=Math.max(0,Math.min(m.wrapper.clientWidth-10,x.left+U.left-P.left))}return v},dn.prototype.showSelection=function(l){var m=this.cm,C=m.display;Y(C.cursorDiv,l.cursors),Y(C.selectionDiv,l.selection),l.teTop!=null&&(this.wrapper.style.top=l.teTop+"px",this.wrapper.style.left=l.teLeft+"px")},dn.prototype.reset=function(l){if(!this.contextMenuPending){var m,C,v=this.cm,x=v.doc;if(v.somethingSelected()){this.prevInput="";var P=x.sel.primary();m=Na&&(P.to().line-P.from().line>100||(C=v.getSelection()).length>1e3);var U=m?"-":C||v.getSelection();this.textarea.value=U,v.state.focused&&Be(this.textarea),s&&a>=9&&(this.hasSelection=U)}else l||(this.prevInput=this.textarea.value="",s&&a>=9&&(this.hasSelection=null));this.inaccurateSelection=m}},dn.prototype.getField=function(){return this.textarea},dn.prototype.supportsTouch=function(){return!1},dn.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"&&(!k||te()!=this.textarea))try{this.textarea.focus()}catch{}},dn.prototype.blur=function(){this.textarea.blur()},dn.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},dn.prototype.receivedFocus=function(){this.slowPoll()},dn.prototype.slowPoll=function(){var l=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){l.poll(),l.cm.state.focused&&l.slowPoll()})},dn.prototype.fastPoll=function(){var l=!1,m=this;m.pollingFast=!0;function C(){var v=m.poll();!v&&!l?(l=!0,m.polling.set(60,C)):(m.pollingFast=!1,m.slowPoll())}m.polling.set(20,C)},dn.prototype.poll=function(){var l=this,m=this.cm,C=this.textarea,v=this.prevInput;if(this.contextMenuPending||!m.state.focused||bd(C)&&!v&&!this.composing||m.isReadOnly()||m.options.disableInput||m.state.keySeq)return!1;var x=C.value;if(x==v&&!m.somethingSelected())return!1;if(s&&a>=9&&this.hasSelection===x||R&&/[\uf700-\uf7ff]/.test(x))return m.display.input.reset(),!1;if(m.doc.sel==m.display.selForContextMenu){var P=x.charCodeAt(0);if(P==8203&&!v&&(v="\u200B"),P==8666)return this.reset(),this.cm.execCommand("undo")}for(var U=0,W=Math.min(v.length,x.length);U<W&&v.charCodeAt(U)==x.charCodeAt(U);)++U;return tn(m,function(){ys(m,x.slice(U),v.length-U,null,l.composing?"*compose":null),x.length>1e3||x.indexOf(`
`)>-1?C.value=l.prevInput="":l.prevInput=x,l.composing&&(l.composing.range.clear(),l.composing.range=m.markText(l.composing.start,m.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},dn.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},dn.prototype.onKeyPress=function(){s&&a>=9&&(this.hasSelection=null),this.fastPoll()},dn.prototype.onContextMenu=function(l){var m=this,C=m.cm,v=C.display,x=m.textarea,P=Ds(C,l),U=v.scroller.scrollTop;if(!P||_)return;var W=C.options.resetSelectionOnContextMenu;W&&C.doc.sel.contains(P)==-1&&pn(C,En)(C.doc,zn(P),ni);var X=x.style.cssText,J=m.wrapper.style.cssText;m.wrapper.style.cssText="position: absolute";var de=m.wrapper.getBoundingClientRect();x.style.cssText=`position: absolute; width: 30px; height: 30px;
      top: `+(l.clientY-de.top-5)+"px; left: "+(l.clientX-de.left-5)+`px;
      z-index: 1000; background: `+(s?"rgba(255, 255, 255, .05)":"transparent")+`;
      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);`;var _e;d&&(_e=window.scrollY),v.input.focus(),d&&window.scrollTo(null,_e),v.input.reset(),C.somethingSelected()||(x.value=m.prevInput=" "),m.contextMenuPending=!0,v.selForContextMenu=C.doc.sel,clearTimeout(v.detectingSelectAll);function xe(){if(x.selectionStart!=null){var Ke=C.somethingSelected(),ht="\u200B"+(Ke?x.value:"");x.value="\u21DA",x.value=ht,m.prevInput=Ke?"":"\u200B",x.selectionStart=1,x.selectionEnd=ht.length,v.selForContextMenu=C.doc.sel}}function ze(){if(m.contextMenuPending=!1,m.wrapper.style.cssText=J,x.style.cssText=X,s&&a<9&&v.scrollbars.setScrollTop(v.scroller.scrollTop=U),x.selectionStart!=null){(!s||s&&a<9)&&xe();var Ke=0,ht=function(){v.selForContextMenu==C.doc.sel&&x.selectionStart==0&&x.selectionEnd>0&&m.prevInput=="\u200B"?pn(C,Hl)(C):Ke++<10?v.detectingSelectAll=setTimeout(ht,500):v.input.reset()};v.detectingSelectAll=setTimeout(ht,200)}}if(s&&a>=9&&xe(),O){Br(l);var Oe=function(){Ln(window,"mouseup",Oe),setTimeout(ze,20)};qt(window,"mouseup",Oe)}else setTimeout(ze,50)},dn.prototype.readOnlyChanged=function(l){l||this.reset()},dn.prototype.setUneditable=function(){},dn.prototype.needsContentAttribute=!1;function Jc(l,m){if(m=m?Ue(m):{},m.value=l.value,!m.tabindex&&l.tabIndex&&(m.tabindex=l.tabIndex),!m.placeholder&&l.placeholder&&(m.placeholder=l.placeholder),m.autofocus==null){var C=te();m.autofocus=C==l||l.getAttribute("autofocus")!=null&&C==document.body}function v(){l.value=W.getValue()}var x;if(l.form&&(qt(l.form,"submit",v),!m.leaveSubmitMethodAlone)){var P=l.form;x=P.submit;try{var U=P.submit=function(){v(),P.submit=x,P.submit(),P.submit=U}}catch{}}m.finishInit=function(X){X.save=v,X.getTextArea=function(){return l},X.toTextArea=function(){X.toTextArea=isNaN,v(),l.parentNode.removeChild(X.getWrapperElement()),l.style.display="",l.form&&(Ln(l.form,"submit",v),typeof l.form.submit=="function"&&(l.form.submit=x))}},l.style.display="none";var W=di(function(X){return l.parentNode.insertBefore(X,l.nextSibling)},m);return W}function $c(l){l.off=Ln,l.on=qt,l.wheelEventPixels=Dc,l.Doc=An,l.splitLines=Ro,l.countColumn=Ge,l.findColumn=ei,l.isWordChar=Ct,l.Pass=Yt,l.signal=Oi,l.Line=ea,l.changeEnd=Qn,l.scrollbarModel=th,l.Pos=Ye,l.cmpPos=Rt,l.modes=rt,l.mimeModes=Ot,l.resolveMode=wn,l.getMode=ul,l.modeExtensions=Ci,l.extendMode=wi,l.copyState=Nn,l.startState=ss,l.innerMode=rs,l.commands=Hr,l.keyMap=zr,l.keyName=Gr,l.isModifierKey=Rh,l.lookupKey=fa,l.normalizeKeyMap=qc,l.StringStream=Jn,l.SharedTextMarker=ma,l.TextMarker=Pn,l.LineWidget=ua,l.e_preventDefault=un,l.e_stopPropagation=hl,l.e_stop=Br,l.addClass=ve,l.contains=le,l.rmClass=K,l.keyNames=cs}va(di),wa(di);var Qc="iter insert remove copy getEditor constructor".split(" ");for(var qo in An.prototype)An.prototype.hasOwnProperty(qo)&&lt(Qc,qo)<0&&(di.prototype[qo]=function(l){return function(){return l.apply(this.doc,arguments)}}(An.prototype[qo]));return Er(An),di.inputStyles={textarea:dn,contenteditable:Ni},di.defineMode=function(l){!di.defaults.mode&&l!="null"&&(di.defaults.mode=l),en.apply(this,arguments)},di.defineMIME=he,di.defineMode("null",function(){return{token:function(l){return l.skipToEnd()}}}),di.defineMIME("text/plain","null"),di.defineExtension=function(l,m){di.prototype[l]=m},di.defineDocExtension=function(l,m){An.prototype[l]=m},di.fromTextArea=Jc,$c(di),di.version="5.21.1",di});(function(c){typeof exports=="object"&&typeof module=="object"?c(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],c):c(CodeMirror)})(function(c){"use strict";function e(z,K,q,Y,se,ce){this.indented=z,this.column=K,this.type=q,this.info=Y,this.align=se,this.prev=ce}function t(z,K,q,Y){var se=z.indented;return z.context&&z.context.type=="statement"&&q!="statement"&&(se=z.context.indented),z.context=new e(se,K,q,Y,null,z.context)}function i(z){var K=z.context.type;return(K==")"||K=="]"||K=="}")&&(z.indented=z.context.indented),z.context=z.context.prev}function n(z,K,q){if(K.prevToken=="variable"||K.prevToken=="variable-3"||/\S(?:[^- ]>|[*\]])\s*$|\*$/.test(z.string.slice(0,q))||K.typeAtEndOfLine&&z.column()==z.indentation())return!0}function s(z){for(;;){if(!z||z.type=="top")return!0;if(z.type=="}"&&z.prev.info!="namespace")return!1;z=z.prev}}c.defineMode("clike",function(z,K){var q=z.indentUnit,Y=K.statementIndentUnit||q,se=K.dontAlignCalls,ce=K.keywords||{},le=K.types||{},te=K.builtin||{},ve=K.blockKeywords||{},Pe=K.defKeywords||{},Be=K.atoms||{},qe=K.hooks||{},Ue=K.multiLineStrings,Ge=K.indentStatements!==!1,it=K.indentSwitch!==!1,lt=K.namespaceSeparator,bt=K.isPunctuationChar||/[\[\]{}\(\),;\:\.]/,Yt=K.numberStart||/[\d\.]/,ni=K.number||/^(?:0x[a-f\d]+|0b[01]+|(?:\d+\.?\d*|\.\d+)(?:e[-+]?\d+)?)(u|ll?|l|f)?/i,ri=K.isOperatorChar||/[+\-*&%=<>!?|\/]/,He,ei;function ui(st,De){var Me=st.next();if(qe[Me]){var Je=qe[Me](st,De);if(Je!==!1)return Je}if(Me=='"'||Me=="'")return De.tokenize=vi(Me),De.tokenize(st,De);if(bt.test(Me))return He=Me,null;if(Yt.test(Me)){if(st.backUp(1),st.match(ni))return"number";st.next()}if(Me=="/"){if(st.eat("*"))return De.tokenize=Xe,Xe(st,De);if(st.eat("/"))return st.skipToEnd(),"comment"}if(ri.test(Me)){for(;!st.match(/^\/[\/*]/,!1)&&st.eat(ri););return"operator"}if(st.eatWhile(/[\w\$_\xa1-\uffff]/),lt)for(;st.match(lt);)st.eatWhile(/[\w\$_\xa1-\uffff]/);var Ct=st.current();return d(ce,Ct)?(d(ve,Ct)&&(He="newstatement"),d(Pe,Ct)&&(ei=!0),"keyword"):d(le,Ct)?"variable-3":d(te,Ct)?(d(ve,Ct)&&(He="newstatement"),"builtin"):d(Be,Ct)?"atom":"variable"}function vi(st){return function(De,Me){for(var Je=!1,Ct,$e=!1;(Ct=De.next())!=null;){if(Ct==st&&!Je){$e=!0;break}Je=!Je&&Ct=="\\"}return($e||!(Je||Ue))&&(Me.tokenize=null),"string"}}function Xe(st,De){for(var Me=!1,Je;Je=st.next();){if(Je=="/"&&Me){De.tokenize=null;break}Me=Je=="*"}return"comment"}function bi(st,De){K.typeFirstDefinitions&&st.eol()&&s(De.context)&&(De.typeAtEndOfLine=n(st,De,st.pos))}return{startState:function(st){return{tokenize:null,context:new e((st||0)-q,0,"top",null,!1),indented:0,startOfLine:!0,prevToken:null}},token:function(st,De){var Me=De.context;if(st.sol()&&(Me.align==null&&(Me.align=!1),De.indented=st.indentation(),De.startOfLine=!0),st.eatSpace())return bi(st,De),null;He=ei=null;var Je=(De.tokenize||ui)(st,De);if(Je=="comment"||Je=="meta")return Je;if(Me.align==null&&(Me.align=!0),He==";"||He==":"||He==","&&st.match(/^\s*(?:\/\/.*)?$/,!1))for(;De.context.type=="statement";)i(De);else if(He=="{")t(De,st.column(),"}");else if(He=="[")t(De,st.column(),"]");else if(He=="(")t(De,st.column(),")");else if(He=="}"){for(;Me.type=="statement";)Me=i(De);for(Me.type=="}"&&(Me=i(De));Me.type=="statement";)Me=i(De)}else He==Me.type?i(De):Ge&&((Me.type=="}"||Me.type=="top")&&He!=";"||Me.type=="statement"&&He=="newstatement")&&t(De,st.column(),"statement",st.current());if(Je=="variable"&&(De.prevToken=="def"||K.typeFirstDefinitions&&n(st,De,st.start)&&s(De.context)&&st.match(/^\s*\(/,!1))&&(Je="def"),qe.token){var Ct=qe.token(st,De,Je);Ct!==void 0&&(Je=Ct)}return Je=="def"&&K.styleDefs===!1&&(Je="variable"),De.startOfLine=!1,De.prevToken=ei?"def":Je||He,bi(st,De),Je},indent:function(st,De){if(st.tokenize!=ui&&st.tokenize!=null||st.typeAtEndOfLine)return c.Pass;var Me=st.context,Je=De&&De.charAt(0);if(Me.type=="statement"&&Je=="}"&&(Me=Me.prev),K.dontIndentStatements)for(;Me.type=="statement"&&K.dontIndentStatements.test(Me.info);)Me=Me.prev;if(qe.indent){var Ct=qe.indent(st,Me,De);if(typeof Ct=="number")return Ct}var $e=Je==Me.type,pe=Me.prev&&Me.prev.info=="switch";if(K.allmanIndentation&&/[{(]/.test(Je)){for(;Me.type!="top"&&Me.type!="}";)Me=Me.prev;return Me.indented}return Me.type=="statement"?Me.indented+(Je=="{"?0:Y):Me.align&&(!se||Me.type!=")")?Me.column+($e?0:1):Me.type==")"&&!$e?Me.indented+Y:Me.indented+($e?0:q)+(!$e&&pe&&!/^(?:case|default)\b/.test(De)?q:0)},electricInput:it?/^\s*(?:case .*?:|default:|\{\}?|\})$/:/^\s*[{}]$/,blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:"//",fold:"brace"}});function a(z){for(var K={},q=z.split(" "),Y=0;Y<q.length;++Y)K[q[Y]]=!0;return K}function d(z,K){return typeof z=="function"?z(K):z.propertyIsEnumerable(K)}var p="auto if break case register continue return default do sizeof static else struct switch extern typedef union for goto while enum const volatile",f="int long char short double float unsigned signed void size_t ptrdiff_t";function _(z,K){if(!K.startOfLine)return!1;for(var q,Y=null;q=z.peek();){if(q=="\\"&&z.match(/^.$/)){Y=_;break}else if(q=="/"&&z.match(/^\/[\/\*]/,!1))break;z.next()}return K.tokenize=Y,"meta"}function b(z,K){return K.prevToken=="variable-3"?"variable-3":!1}function w(z){return z.eatWhile(/[\w\.']/),"number"}function S(z,K){if(z.backUp(1),z.match(/(R|u8R|uR|UR|LR)/)){var q=z.match(/"([^\s\\()]{0,16})\(/);return q?(K.cpp11RawStringDelim=q[1],K.tokenize=R,R(z,K)):!1}return z.match(/(u8|u|U|L)/)?z.match(/["']/,!1)?"string":!1:(z.next(),!1)}function E(z){var K=/(\w+)::(\w+)$/.exec(z);return K&&K[1]==K[2]}function k(z,K){for(var q;(q=z.next())!=null;)if(q=='"'&&!z.eat('"')){K.tokenize=null;break}return"string"}function R(z,K){var q=K.cpp11RawStringDelim.replace(/[^\w\s]/g,"\\$&"),Y=z.match(new RegExp(".*?\\)"+q+'"'));return Y?K.tokenize=null:z.skipToEnd(),"string"}function M(z,K){typeof z=="string"&&(z=[z]);var q=[];function Y(ce){if(ce)for(var le in ce)ce.hasOwnProperty(le)&&q.push(le)}Y(K.keywords),Y(K.types),Y(K.builtin),Y(K.atoms),q.length&&(K.helperType=z[0],c.registerHelper("hintWords",z[0],q));for(var se=0;se<z.length;++se)c.defineMIME(z[se],K)}M(["text/x-csrc","text/x-c","text/x-chdr"],{name:"clike",keywords:a(p),types:a(f+" bool _Complex _Bool float_t double_t intptr_t intmax_t int8_t int16_t int32_t int64_t uintptr_t uintmax_t uint8_t uint16_t uint32_t uint64_t"),blockKeywords:a("case do else for if switch while struct"),defKeywords:a("struct"),typeFirstDefinitions:!0,atoms:a("null true false"),hooks:{"#":_,"*":b},modeProps:{fold:["brace","include"]}}),M(["text/x-c++src","text/x-c++hdr"],{name:"clike",keywords:a(p+" asm dynamic_cast namespace reinterpret_cast try explicit new static_cast typeid catch operator template typename class friend private this using const_cast inline public throw virtual delete mutable protected alignas alignof constexpr decltype nullptr noexcept thread_local final static_assert override"),types:a(f+" bool wchar_t"),blockKeywords:a("catch class do else finally for if struct switch try while"),defKeywords:a("class namespace struct enum union"),typeFirstDefinitions:!0,atoms:a("true false null"),dontIndentStatements:/^template$/,hooks:{"#":_,"*":b,u:S,U:S,L:S,R:S,0:w,1:w,2:w,3:w,4:w,5:w,6:w,7:w,8:w,9:w,token:function(z,K,q){if(q=="variable"&&z.peek()=="("&&(K.prevToken==";"||K.prevToken==null||K.prevToken=="}")&&E(z.current()))return"def"}},namespaceSeparator:"::",modeProps:{fold:["brace","include"]}}),M("text/x-java",{name:"clike",keywords:a("abstract assert break case catch class const continue default do else enum extends final finally float for goto if implements import instanceof interface native new package private protected public return static strictfp super switch synchronized this throw throws transient try volatile while"),types:a("byte short int long float double boolean char void Boolean Byte Character Double Float Integer Long Number Object Short String StringBuffer StringBuilder Void"),blockKeywords:a("catch class do else finally for if switch try while"),defKeywords:a("class interface package enum"),typeFirstDefinitions:!0,atoms:a("true false null"),number:/^(?:0x[a-f\d_]+|0b[01_]+|(?:[\d_]+\.?\d*|\.\d+)(?:e[-+]?[\d_]+)?)(u|ll?|l|f)?/i,hooks:{"@":function(z){return z.eatWhile(/[\w\$_]/),"meta"}},modeProps:{fold:["brace","import"]}}),M("text/x-csharp",{name:"clike",keywords:a("abstract as async await base break case catch checked class const continue default delegate do else enum event explicit extern finally fixed for foreach goto if implicit in interface internal is lock namespace new operator out override params private protected public readonly ref return sealed sizeof stackalloc static struct switch this throw try typeof unchecked unsafe using virtual void volatile while add alias ascending descending dynamic from get global group into join let orderby partial remove select set value var yield"),types:a("Action Boolean Byte Char DateTime DateTimeOffset Decimal Double Func Guid Int16 Int32 Int64 Object SByte Single String Task TimeSpan UInt16 UInt32 UInt64 bool byte char decimal double short int long object sbyte float string ushort uint ulong"),blockKeywords:a("catch class do else finally for foreach if struct switch try while"),defKeywords:a("class interface namespace struct var"),typeFirstDefinitions:!0,atoms:a("true false null"),hooks:{"@":function(z,K){return z.eat('"')?(K.tokenize=k,k(z,K)):(z.eatWhile(/[\w\$_]/),"meta")}}});function L(z,K){for(var q=!1;!z.eol();){if(!q&&z.match('"""')){K.tokenize=null;break}q=z.next()=="\\"&&!q}return"string"}M("text/x-scala",{name:"clike",keywords:a("abstract case catch class def do else extends final finally for forSome if implicit import lazy match new null object override package private protected return sealed super this throw trait try type val var while with yield _ : = => <- <: <% >: # @ assert assume require print println printf readLine readBoolean readByte readShort readChar readInt readLong readFloat readDouble :: #:: "),types:a("AnyVal App Application Array BufferedIterator BigDecimal BigInt Char Console Either Enumeration Equiv Error Exception Fractional Function IndexedSeq Int Integral Iterable Iterator List Map Numeric Nil NotNull Option Ordered Ordering PartialFunction PartialOrdering Product Proxy Range Responder Seq Serializable Set Specializable Stream StringBuilder StringContext Symbol Throwable Traversable TraversableOnce Tuple Unit Vector Boolean Byte Character CharSequence Class ClassLoader Cloneable Comparable Compiler Double Exception Float Integer Long Math Number Object Package Pair Process Runtime Runnable SecurityManager Short StackTraceElement StrictMath String StringBuffer System Thread ThreadGroup ThreadLocal Throwable Triple Void"),multiLineStrings:!0,blockKeywords:a("catch class do else finally for forSome if match switch try while"),defKeywords:a("class def object package trait type val var"),atoms:a("true false null"),indentStatements:!1,indentSwitch:!1,hooks:{"@":function(z){return z.eatWhile(/[\w\$_]/),"meta"},'"':function(z,K){return z.match('""')?(K.tokenize=L,K.tokenize(z,K)):!1},"'":function(z){return z.eatWhile(/[\w\$_\xa1-\uffff]/),"atom"},"=":function(z,K){var q=K.context;return q.type=="}"&&q.align&&z.eat(">")?(K.context=new e(q.indented,q.column,q.type,q.info,null,q.prev),"operator"):!1}},modeProps:{closeBrackets:{triples:'"'}}});function V(z){return function(K,q){for(var Y=!1,se,ce=!1;!K.eol();){if(!z&&!Y&&K.match('"')){ce=!0;break}if(z&&K.match('"""')){ce=!0;break}se=K.next(),!Y&&se=="$"&&K.match("{")&&K.skipTo("}"),Y=!Y&&se=="\\"&&!z}return(ce||!z)&&(q.tokenize=null),"string"}}M("text/x-kotlin",{name:"clike",keywords:a("package as typealias class interface this super val var fun for is in This throw return break continue object if else while do try when !in !is as? file import where by get set abstract enum open inner override private public internal protected catch finally out final vararg reified dynamic companion constructor init sealed field property receiver param sparam lateinit data inline noinline tailrec external annotation crossinline const operator infix"),types:a("Boolean Byte Character CharSequence Class ClassLoader Cloneable Comparable Compiler Double Exception Float Integer Long Math Number Object Package Pair Process Runtime Runnable SecurityManager Short StackTraceElement StrictMath String StringBuffer System Thread ThreadGroup ThreadLocal Throwable Triple Void"),intendSwitch:!1,indentStatements:!1,multiLineStrings:!0,blockKeywords:a("catch class do else finally for if where try while enum"),defKeywords:a("class val var object package interface fun"),atoms:a("true false null this"),hooks:{'"':function(z,K){return K.tokenize=V(z.match('""')),K.tokenize(z,K)}},modeProps:{closeBrackets:{triples:'"'}}}),M(["x-shader/x-vertex","x-shader/x-fragment"],{name:"clike",keywords:a("sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadow const attribute uniform varying break continue discard return for while do if else struct in out inout"),types:a("float int bool void vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 mat2 mat3 mat4"),blockKeywords:a("for while do if else struct"),builtin:a("radians degrees sin cos tan asin acos atan pow exp log exp2 sqrt inversesqrt abs sign floor ceil fract mod min max clamp mix step smoothstep length distance dot cross normalize ftransform faceforward reflect refract matrixCompMult lessThan lessThanEqual greaterThan greaterThanEqual equal notEqual any all not texture1D texture1DProj texture1DLod texture1DProjLod texture2D texture2DProj texture2DLod texture2DProjLod texture3D texture3DProj texture3DLod texture3DProjLod textureCube textureCubeLod shadow1D shadow2D shadow1DProj shadow2DProj shadow1DLod shadow2DLod shadow1DProjLod shadow2DProjLod dFdx dFdy fwidth noise1 noise2 noise3 noise4"),atoms:a("true false gl_FragColor gl_SecondaryColor gl_Normal gl_Vertex gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 gl_FogCoord gl_PointCoord gl_Position gl_PointSize gl_ClipVertex gl_FrontColor gl_BackColor gl_FrontSecondaryColor gl_BackSecondaryColor gl_TexCoord gl_FogFragCoord gl_FragCoord gl_FrontFacing gl_FragData gl_FragDepth gl_ModelViewMatrix gl_ProjectionMatrix gl_ModelViewProjectionMatrix gl_TextureMatrix gl_NormalMatrix gl_ModelViewMatrixInverse gl_ProjectionMatrixInverse gl_ModelViewProjectionMatrixInverse gl_TexureMatrixTranspose gl_ModelViewMatrixInverseTranspose gl_ProjectionMatrixInverseTranspose gl_ModelViewProjectionMatrixInverseTranspose gl_TextureMatrixInverseTranspose gl_NormalScale gl_DepthRange gl_ClipPlane gl_Point gl_FrontMaterial gl_BackMaterial gl_LightSource gl_LightModel gl_FrontLightModelProduct gl_BackLightModelProduct gl_TextureColor gl_EyePlaneS gl_EyePlaneT gl_EyePlaneR gl_EyePlaneQ gl_FogParameters gl_MaxLights gl_MaxClipPlanes gl_MaxTextureUnits gl_MaxTextureCoords gl_MaxVertexAttribs gl_MaxVertexUniformComponents gl_MaxVaryingFloats gl_MaxVertexTextureImageUnits gl_MaxTextureImageUnits gl_MaxFragmentUniformComponents gl_MaxCombineTextureImageUnits gl_MaxDrawBuffers"),indentSwitch:!1,hooks:{"#":_},modeProps:{fold:["brace","include"]}}),M("text/x-nesc",{name:"clike",keywords:a(p+"as atomic async call command component components configuration event generic implementation includes interface module new norace nx_struct nx_union post provides signal task uses abstract extends"),types:a(f),blockKeywords:a("case do else for if switch while struct"),atoms:a("null true false"),hooks:{"#":_},modeProps:{fold:["brace","include"]}}),M("text/x-objectivec",{name:"clike",keywords:a(p+"inline restrict _Bool _Complex _Imaginary BOOL Class bycopy byref id IMP in inout nil oneway out Protocol SEL self super atomic nonatomic retain copy readwrite readonly"),types:a(f),atoms:a("YES NO NULL NILL ON OFF true false"),hooks:{"@":function(z){return z.eatWhile(/[\w\$]/),"keyword"},"#":_,indent:function(z,K,q){if(K.type=="statement"&&/^@\w/.test(q))return K.indented}},modeProps:{fold:"brace"}}),M("text/x-squirrel",{name:"clike",keywords:a("base break clone continue const default delete enum extends function in class foreach local resume return this throw typeof yield constructor instanceof static"),types:a(f),blockKeywords:a("case catch class else for foreach if switch try while"),defKeywords:a("function local class"),typeFirstDefinitions:!0,atoms:a("true false null"),hooks:{"#":_},modeProps:{fold:["brace","include"]}});var H=null;function O(z){return function(K,q){for(var Y=!1,se,ce=!1;!K.eol();){if(!Y&&K.match('"')&&(z=="single"||K.match('""'))){ce=!0;break}if(!Y&&K.match("``")){H=O(z),ce=!0;break}se=K.next(),Y=z=="single"&&!Y&&se=="\\"}return ce&&(q.tokenize=null),"string"}}M("text/x-ceylon",{name:"clike",keywords:a("abstracts alias assembly assert assign break case catch class continue dynamic else exists extends finally for function given if import in interface is let module new nonempty object of out outer package return satisfies super switch then this throw try value void while"),types:function(z){var K=z.charAt(0);return K===K.toUpperCase()&&K!==K.toLowerCase()},blockKeywords:a("case catch class dynamic else finally for function if interface module new object switch try while"),defKeywords:a("class dynamic function interface module object package value"),builtin:a("abstract actual aliased annotation by default deprecated doc final formal late license native optional sealed see serializable shared suppressWarnings tagged throws variable"),isPunctuationChar:/[\[\]{}\(\),;\:\.`]/,isOperatorChar:/[+\-*&%=<>!?|^~:\/]/,numberStart:/[\d#$]/,number:/^(?:#[\da-fA-F_]+|\$[01_]+|[\d_]+[kMGTPmunpf]?|[\d_]+\.[\d_]+(?:[eE][-+]?\d+|[kMGTPmunpf]|)|)/i,multiLineStrings:!0,typeFirstDefinitions:!0,atoms:a("true false null larger smaller equal empty finished"),indentSwitch:!1,styleDefs:!1,hooks:{"@":function(z){return z.eatWhile(/[\w\$_]/),"meta"},'"':function(z,K){return K.tokenize=O(z.match('""')?"triple":"single"),K.tokenize(z,K)},"`":function(z,K){return!H||!z.match("`")?!1:(K.tokenize=H,H=null,K.tokenize(z,K))},"'":function(z){return z.eatWhile(/[\w\$_\xa1-\uffff]/),"atom"},token:function(z,K,q){if((q=="variable"||q=="variable-3")&&K.prevToken==".")return"variable-2"}},modeProps:{fold:["brace","import"],closeBrackets:{triples:'"'}}})});(function(c){typeof exports=="object"&&typeof module=="object"?c(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],c):c(CodeMirror)})(function(c){"use strict";c.defineMode("clojure",function(e){var t="builtin",i="comment",n="string",s="string-2",a="atom",d="number",p="bracket",f="keyword",_="variable",b=e.indentUnit||2,w=e.indentUnit||2;function S(q){for(var Y={},se=q.split(" "),ce=0;ce<se.length;++ce)Y[se[ce]]=!0;return Y}var E=S("true false nil"),k=S("defn defn- def def- defonce defmulti defmethod defmacro defstruct deftype defprotocol defrecord defproject deftest slice defalias defhinted defmacro- defn-memo defnk defnk defonce- defunbound defunbound- defvar defvar- let letfn do case cond condp for loop recur when when-not when-let when-first if if-let if-not . .. -> ->> doto and or dosync doseq dotimes dorun doall load import unimport ns in-ns refer try catch finally throw with-open with-local-vars binding gen-class gen-and-load-class gen-and-save-class handler-case handle"),R=S("* *' *1 *2 *3 *agent* *allow-unresolved-vars* *assert* *clojure-version* *command-line-args* *compile-files* *compile-path* *compiler-options* *data-readers* *e *err* *file* *flush-on-newline* *fn-loader* *in* *math-context* *ns* *out* *print-dup* *print-length* *print-level* *print-meta* *print-readably* *read-eval* *source-path* *unchecked-math* *use-context-classloader* *verbose-defrecords* *warn-on-reflection* + +' - -' -> ->> ->ArrayChunk ->Vec ->VecNode ->VecSeq -cache-protocol-fn -reset-methods .. / < <= = == > >= EMPTY-NODE accessor aclone add-classpath add-watch agent agent-error agent-errors aget alength alias all-ns alter alter-meta! alter-var-root amap ancestors and apply areduce array-map aset aset-boolean aset-byte aset-char aset-double aset-float aset-int aset-long aset-short assert assoc assoc! assoc-in associative? atom await await-for await1 bases bean bigdec bigint biginteger binding bit-and bit-and-not bit-clear bit-flip bit-not bit-or bit-set bit-shift-left bit-shift-right bit-test bit-xor boolean boolean-array booleans bound-fn bound-fn* bound? butlast byte byte-array bytes case cat cast char char-array char-escape-string char-name-string char? chars chunk chunk-append chunk-buffer chunk-cons chunk-first chunk-next chunk-rest chunked-seq? class class? clear-agent-errors clojure-version coll? comment commute comp comparator compare compare-and-set! compile complement completing concat cond condp conj conj! cons constantly construct-proxy contains? count counted? create-ns create-struct cycle dec dec' decimal? declare dedupe default-data-readers definline definterface defmacro defmethod defmulti defn defn- defonce defprotocol defrecord defstruct deftype delay delay? deliver denominator deref derive descendants destructure disj disj! dissoc dissoc! distinct distinct? doall dorun doseq dosync dotimes doto double double-array doubles drop drop-last drop-while eduction empty empty? ensure enumeration-seq error-handler error-mode eval even? every-pred every? ex-data ex-info extend extend-protocol extend-type extenders extends? false? ffirst file-seq filter filterv find find-keyword find-ns find-protocol-impl find-protocol-method find-var first flatten float float-array float? floats flush fn fn? fnext fnil for force format frequencies future future-call future-cancel future-cancelled? future-done? future? gen-class gen-interface gensym get get-in get-method get-proxy-class get-thread-bindings get-validator group-by hash hash-combine hash-map hash-set identical? identity if-let if-not ifn? import in-ns inc inc' init-proxy instance? int int-array integer? interleave intern interpose into into-array ints io! isa? iterate iterator-seq juxt keep keep-indexed key keys keyword keyword? last lazy-cat lazy-seq let letfn line-seq list list* list? load load-file load-reader load-string loaded-libs locking long long-array longs loop macroexpand macroexpand-1 make-array make-hierarchy map map-indexed map? mapcat mapv max max-key memfn memoize merge merge-with meta method-sig methods min min-key mod munge name namespace namespace-munge neg? newline next nfirst nil? nnext not not-any? not-empty not-every? not= ns ns-aliases ns-imports ns-interns ns-map ns-name ns-publics ns-refers ns-resolve ns-unalias ns-unmap nth nthnext nthrest num number? numerator object-array odd? or parents partial partition partition-all partition-by pcalls peek persistent! pmap pop pop! pop-thread-bindings pos? pr pr-str prefer-method prefers primitives-classnames print print-ctor print-dup print-method print-simple print-str printf println println-str prn prn-str promise proxy proxy-call-with-super proxy-mappings proxy-name proxy-super push-thread-bindings pvalues quot rand rand-int rand-nth random-sample range ratio? rational? rationalize re-find re-groups re-matcher re-matches re-pattern re-seq read read-line read-string realized? reduce reduce-kv reductions ref ref-history-count ref-max-history ref-min-history ref-set refer refer-clojure reify release-pending-sends rem remove remove-all-methods remove-method remove-ns remove-watch repeat repeatedly replace replicate require reset! reset-meta! resolve rest restart-agent resultset-seq reverse reversible? rseq rsubseq satisfies? second select-keys send send-off seq seq? seque sequence sequential? set set-error-handler! set-error-mode! set-validator! set? short short-array shorts shuffle shutdown-agents slurp some some-fn sort sort-by sorted-map sorted-map-by sorted-set sorted-set-by sorted? special-symbol? spit split-at split-with str string? struct struct-map subs subseq subvec supers swap! symbol symbol? sync take take-last take-nth take-while test the-ns thread-bound? time to-array to-array-2d trampoline transduce transient tree-seq true? type unchecked-add unchecked-add-int unchecked-byte unchecked-char unchecked-dec unchecked-dec-int unchecked-divide-int unchecked-double unchecked-float unchecked-inc unchecked-inc-int unchecked-int unchecked-long unchecked-multiply unchecked-multiply-int unchecked-negate unchecked-negate-int unchecked-remainder-int unchecked-short unchecked-subtract unchecked-subtract-int underive unquote unquote-splicing update update-in update-proxy use val vals var-get var-set var? vary-meta vec vector vector-of vector? volatile! volatile? vreset! vswap! when when-first when-let when-not while with-bindings with-bindings* with-in-str with-loading-context with-local-vars with-meta with-open with-out-str with-precision with-redefs with-redefs-fn xml-seq zero? zipmap *default-data-reader-fn* as-> cond-> cond->> reduced reduced? send-via set-agent-send-executor! set-agent-send-off-executor! some-> some->>"),M=S("ns fn def defn defmethod bound-fn if if-not case condp when while when-not when-first do future comment doto locking proxy with-open with-precision reify deftype defrecord defprotocol extend extend-protocol extend-type try catch let letfn binding loop for doseq dotimes when-let if-let defstruct struct-map assoc testing deftest handler-case handle dotrace deftrace"),L={digit:/\d/,digit_or_colon:/[\d:]/,hex:/[0-9a-f]/i,sign:/[+-]/,exponent:/e/i,keyword_char:/[^\s\(\[\;\)\]]/,symbol:/[\w*+!\-\._?:<>\/\xa1-\uffff]/,block_indent:/^(?:def|with)[^\/]+$|\/(?:def|with)/};function V(q,Y,se){this.indent=q,this.type=Y,this.prev=se}function H(q,Y,se){q.indentStack=new V(Y,se,q.indentStack)}function O(q){q.indentStack=q.indentStack.prev}function z(q,Y){return q==="0"&&Y.eat(/x/i)?(Y.eatWhile(L.hex),!0):((q=="+"||q=="-")&&L.digit.test(Y.peek())&&(Y.eat(L.sign),q=Y.next()),L.digit.test(q)?(Y.eat(q),Y.eatWhile(L.digit),Y.peek()=="."?(Y.eat("."),Y.eatWhile(L.digit)):Y.peek()=="/"&&(Y.eat("/"),Y.eatWhile(L.digit)),Y.eat(L.exponent)&&(Y.eat(L.sign),Y.eatWhile(L.digit)),!0):!1)}function K(q){var Y=q.next();Y&&Y.match(/[a-z]/)&&q.match(/[a-z]+/,!0)||Y==="u"&&q.match(/[0-9a-z]{4}/i,!0)}return{startState:function(){return{indentStack:null,indentation:0,mode:!1}},token:function(q,Y){if(Y.indentStack==null&&q.sol()&&(Y.indentation=q.indentation()),Y.mode!="string"&&q.eatSpace())return null;var se=null;switch(Y.mode){case"string":for(var ce,le=!1;(ce=q.next())!=null;){if(ce=='"'&&!le){Y.mode=!1;break}le=!le&&ce=="\\"}se=n;break;default:var te=q.next();if(te=='"')Y.mode="string",se=n;else if(te=="\\")K(q),se=s;else if(te=="'"&&!L.digit_or_colon.test(q.peek()))se=a;else if(te==";")q.skipToEnd(),se=i;else if(z(te,q))se=d;else if(te=="("||te=="["||te=="{"){var ve="",Pe=q.column(),Be;if(te=="(")for(;(Be=q.eat(L.keyword_char))!=null;)ve+=Be;ve.length>0&&(M.propertyIsEnumerable(ve)||L.block_indent.test(ve))?H(Y,Pe+b,te):(q.eatSpace(),q.eol()||q.peek()==";"?H(Y,Pe+w,te):H(Y,Pe+q.current().length,te)),q.backUp(q.current().length-1),se=p}else if(te==")"||te=="]"||te=="}")se=p,Y.indentStack!=null&&Y.indentStack.type==(te==")"?"(":te=="]"?"[":"{")&&O(Y);else{if(te==":")return q.eatWhile(L.symbol),a;q.eatWhile(L.symbol),k&&k.propertyIsEnumerable(q.current())?se=f:R&&R.propertyIsEnumerable(q.current())?se=t:E&&E.propertyIsEnumerable(q.current())?se=a:se=_}}return se},indent:function(q){return q.indentStack==null?q.indentation:q.indentStack.indent},closeBrackets:{pairs:'()[]{}""'},lineComment:";;"}}),c.defineMIME("text/x-clojure","clojure"),c.defineMIME("text/x-clojurescript","clojure"),c.defineMIME("application/edn","clojure")});(function(c){typeof exports=="object"&&typeof module=="object"?c(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],c):c(CodeMirror)})(function(c){var e={pairs:`()[]{}''""`,triples:"",explode:"[]{}"},t=c.Pos;c.defineOption("autoCloseBrackets",!1,function(M,L,V){V&&V!=c.Init&&(M.removeKeyMap(s),M.state.closeBrackets=null),L&&(M.state.closeBrackets=L,M.addKeyMap(s))});function i(M,L){return L=="pairs"&&typeof M=="string"?M:typeof M=="object"&&M[L]!=null?M[L]:e[L]}for(var n=e.pairs+"`",s={Backspace:f,Enter:_},a=0;a<n.length;a++)s["'"+n.charAt(a)+"'"]=d(n.charAt(a));function d(M){return function(L){return w(L,M)}}function p(M){var L=M.state.closeBrackets;if(!L)return null;var V=M.getModeAt(M.getCursor());return V.closeBrackets||L}function f(M){var L=p(M);if(!L||M.getOption("disableInput"))return c.Pass;for(var V=i(L,"pairs"),H=M.listSelections(),O=0;O<H.length;O++){if(!H[O].empty())return c.Pass;var z=E(M,H[O].head);if(!z||V.indexOf(z)%2!=0)return c.Pass}for(var O=H.length-1;O>=0;O--){var K=H[O].head;M.replaceRange("",t(K.line,K.ch-1),t(K.line,K.ch+1),"+delete")}}function _(M){var L=p(M),V=L&&i(L,"explode");if(!V||M.getOption("disableInput"))return c.Pass;for(var H=M.listSelections(),O=0;O<H.length;O++){if(!H[O].empty())return c.Pass;var z=E(M,H[O].head);if(!z||V.indexOf(z)%2!=0)return c.Pass}M.operation(function(){M.replaceSelection(`

`,null),M.execCommand("goCharLeft"),H=M.listSelections();for(var K=0;K<H.length;K++){var q=H[K].head.line;M.indentLine(q,null,!0),M.indentLine(q+1,null,!0)}})}function b(M){var L=c.cmpPos(M.anchor,M.head)>0;return{anchor:new t(M.anchor.line,M.anchor.ch+(L?-1:1)),head:new t(M.head.line,M.head.ch+(L?1:-1))}}function w(M,L){var V=p(M);if(!V||M.getOption("disableInput"))return c.Pass;var H=i(V,"pairs"),O=H.indexOf(L);if(O==-1)return c.Pass;for(var z=i(V,"triples"),K=H.charAt(O+1)==L,q=M.listSelections(),Y=O%2==0,se,ce=0;ce<q.length;ce++){var le=q[ce],te=le.head,ve,Pe=M.getRange(te,t(te.line,te.ch+1));if(Y&&!le.empty())ve="surround";else if((K||!Y)&&Pe==L)K&&R(M,te)?ve="both":z.indexOf(L)>=0&&M.getRange(te,t(te.line,te.ch+3))==L+L+L?ve="skipThree":ve="skip";else if(K&&te.ch>1&&z.indexOf(L)>=0&&M.getRange(t(te.line,te.ch-2),te)==L+L&&(te.ch<=2||M.getRange(t(te.line,te.ch-3),t(te.line,te.ch-2))!=L))ve="addFour";else if(K)if(!c.isWordChar(Pe)&&k(M,te,L))ve="both";else return c.Pass;else if(Y&&(M.getLine(te.line).length==te.ch||S(Pe,H)||/\s/.test(Pe)))ve="both";else return c.Pass;if(!se)se=ve;else if(se!=ve)return c.Pass}var Be=O%2?H.charAt(O-1):L,qe=O%2?L:H.charAt(O+1);M.operation(function(){if(se=="skip")M.execCommand("goCharRight");else if(se=="skipThree")for(var Ue=0;Ue<3;Ue++)M.execCommand("goCharRight");else if(se=="surround"){for(var Ge=M.getSelections(),Ue=0;Ue<Ge.length;Ue++)Ge[Ue]=Be+Ge[Ue]+qe;M.replaceSelections(Ge,"around"),Ge=M.listSelections().slice();for(var Ue=0;Ue<Ge.length;Ue++)Ge[Ue]=b(Ge[Ue]);M.setSelections(Ge)}else se=="both"?(M.replaceSelection(Be+qe,null),M.triggerElectric(Be+qe),M.execCommand("goCharLeft")):se=="addFour"&&(M.replaceSelection(Be+Be+Be+Be,"before"),M.execCommand("goCharRight"))})}function S(M,L){var V=L.lastIndexOf(M);return V>-1&&V%2==1}function E(M,L){var V=M.getRange(t(L.line,L.ch-1),t(L.line,L.ch+1));return V.length==2?V:null}function k(M,L,V){var H=M.getLine(L.line),O=M.getTokenAt(L);if(/\bstring2?\b/.test(O.type))return!1;var z=new c.StringStream(H.slice(0,L.ch)+V+H.slice(L.ch),4);for(z.pos=z.start=O.start;;){var K=M.getMode().token(z,O.state);if(z.pos>=L.ch+1)return/\bstring2?\b/.test(K);z.start=z.pos}}function R(M,L){var V=M.getTokenAt(t(L.line,L.ch+1));return/\bstring/.test(V.type)&&V.start==L.ch}});(function(c){typeof exports=="object"&&typeof module=="object"?c(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],c):c(CodeMirror)})(function(c){"use strict";c.defineMode("coffeescript",function(e,t){var i="error";function n(q){return new RegExp("^(("+q.join(")|(")+"))\\b")}var s=/^(?:->|=>|\+[+=]?|-[\-=]?|\*[\*=]?|\/[\/=]?|[=!]=|<[><]?=?|>>?=?|%=?|&=?|\|=?|\^=?|\~|!|\?|(or|and|\|\||&&|\?)=)/,a=/^(?:[()\[\]{},:`=;]|\.\.?\.?)/,d=/^[_A-Za-z$][_A-Za-z$0-9]*/,p=/^@[_A-Za-z$][_A-Za-z$0-9]*/,f=n(["and","or","not","is","isnt","in","instanceof","typeof"]),_=["for","while","loop","if","unless","else","switch","try","catch","finally","class"],b=["break","by","continue","debugger","delete","do","in","of","new","return","then","this","@","throw","when","until","extends"],w=n(_.concat(b));_=n(_);var S=/^('{3}|\"{3}|['\"])/,E=/^(\/{3}|\/)/,k=["Infinity","NaN","undefined","null","true","false","on","off","yes","no"],R=n(k);function M(q,Y){if(q.sol()){Y.scope.align===null&&(Y.scope.align=!1);var se=Y.scope.offset;if(q.eatSpace()){var ce=q.indentation();return ce>se&&Y.scope.type=="coffee"?"indent":ce<se?"dedent":null}else se>0&&O(q,Y)}if(q.eatSpace())return null;var le=q.peek();if(q.match("####"))return q.skipToEnd(),"comment";if(q.match("###"))return Y.tokenize=V,Y.tokenize(q,Y);if(le==="#")return q.skipToEnd(),"comment";if(q.match(/^-?[0-9\.]/,!1)){var te=!1;if(q.match(/^-?\d*\.\d+(e[\+\-]?\d+)?/i)&&(te=!0),q.match(/^-?\d+\.\d*/)&&(te=!0),q.match(/^-?\.\d+/)&&(te=!0),te)return q.peek()=="."&&q.backUp(1),"number";var ve=!1;if(q.match(/^-?0x[0-9a-f]+/i)&&(ve=!0),q.match(/^-?[1-9]\d*(e[\+\-]?\d+)?/)&&(ve=!0),q.match(/^-?0(?![\dx])/i)&&(ve=!0),ve)return"number"}if(q.match(S))return Y.tokenize=L(q.current(),!1,"string"),Y.tokenize(q,Y);if(q.match(E)){if(q.current()!="/"||q.match(/^.*\//,!1))return Y.tokenize=L(q.current(),!0,"string-2"),Y.tokenize(q,Y);q.backUp(1)}return q.match(s)||q.match(f)?"operator":q.match(a)?"punctuation":q.match(R)?"atom":q.match(p)||Y.prop&&q.match(d)?"property":q.match(w)?"keyword":q.match(d)?"variable":(q.next(),i)}function L(q,Y,se){return function(ce,le){for(;!ce.eol();)if(ce.eatWhile(/[^'"\/\\]/),ce.eat("\\")){if(ce.next(),Y&&ce.eol())return se}else{if(ce.match(q))return le.tokenize=M,se;ce.eat(/['"\/]/)}return Y&&(t.singleLineStringErrors?se=i:le.tokenize=M),se}}function V(q,Y){for(;!q.eol();){if(q.eatWhile(/[^#]/),q.match("###")){Y.tokenize=M;break}q.eatWhile("#")}return"comment"}function H(q,Y,se){se=se||"coffee";for(var ce=0,le=!1,te=null,ve=Y.scope;ve;ve=ve.prev)if(ve.type==="coffee"||ve.type=="}"){ce=ve.offset+e.indentUnit;break}se!=="coffee"?(le=null,te=q.column()+q.current().length):Y.scope.align&&(Y.scope.align=!1),Y.scope={offset:ce,type:se,prev:Y.scope,align:le,alignOffset:te}}function O(q,Y){if(!!Y.scope.prev)if(Y.scope.type==="coffee"){for(var se=q.indentation(),ce=!1,le=Y.scope;le;le=le.prev)if(se===le.offset){ce=!0;break}if(!ce)return!0;for(;Y.scope.prev&&Y.scope.offset!==se;)Y.scope=Y.scope.prev;return!1}else return Y.scope=Y.scope.prev,!1}function z(q,Y){var se=Y.tokenize(q,Y),ce=q.current();ce==="return"&&(Y.dedent=!0),((ce==="->"||ce==="=>")&&q.eol()||se==="indent")&&H(q,Y);var le="[({".indexOf(ce);if(le!==-1&&H(q,Y,"])}".slice(le,le+1)),_.exec(ce)&&H(q,Y),ce=="then"&&O(q,Y),se==="dedent"&&O(q,Y))return i;if(le="])}".indexOf(ce),le!==-1){for(;Y.scope.type=="coffee"&&Y.scope.prev;)Y.scope=Y.scope.prev;Y.scope.type==ce&&(Y.scope=Y.scope.prev)}return Y.dedent&&q.eol()&&(Y.scope.type=="coffee"&&Y.scope.prev&&(Y.scope=Y.scope.prev),Y.dedent=!1),se}var K={startState:function(q){return{tokenize:M,scope:{offset:q||0,type:"coffee",prev:null,align:!1},prop:!1,dedent:0}},token:function(q,Y){var se=Y.scope.align===null&&Y.scope;se&&q.sol()&&(se.align=!1);var ce=z(q,Y);return ce&&ce!="comment"&&(se&&(se.align=!0),Y.prop=ce=="punctuation"&&q.current()=="."),ce},indent:function(q,Y){if(q.tokenize!=M)return 0;var se=q.scope,ce=Y&&"])}".indexOf(Y.charAt(0))>-1;if(ce)for(;se.type=="coffee"&&se.prev;)se=se.prev;var le=ce&&se.type===Y.charAt(0);return se.align?se.alignOffset-(le?1:0):(le?se.prev:se).offset},lineComment:"#",fold:"indent"};return K}),c.defineMIME("text/x-coffeescript","coffeescript"),c.defineMIME("text/coffeescript","coffeescript")});(function(c){typeof exports=="object"&&typeof module=="object"?c(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],c):c(CodeMirror)})(function(c){"use strict";var e={},t=/[^\s\u00a0]/,i=c.Pos;function n(a){var d=a.search(t);return d==-1?0:d}c.commands.toggleComment=function(a){a.toggleComment()},c.defineExtension("toggleComment",function(a){a||(a=e);for(var d=this,p=1/0,f=this.listSelections(),_=null,b=f.length-1;b>=0;b--){var w=f[b].from(),S=f[b].to();w.line>=p||(S.line>=p&&(S=i(p,0)),p=w.line,_==null?d.uncomment(w,S,a)?_="un":(d.lineComment(w,S,a),_="line"):_=="un"?d.uncomment(w,S,a):d.lineComment(w,S,a))}});function s(a,d,p){return/\bstring\b/.test(a.getTokenTypeAt(i(d.line,0)))&&!/^[\'\"`]/.test(p)}c.defineExtension("lineComment",function(a,d,p){p||(p=e);var f=this,_=f.getModeAt(a),b=f.getLine(a.line);if(!(b==null||s(f,a,b))){var w=p.lineComment||_.lineComment;if(!w){(p.blockCommentStart||_.blockCommentStart)&&(p.fullLines=!0,f.blockComment(a,d,p));return}var S=Math.min(d.ch!=0||d.line==a.line?d.line+1:d.line,f.lastLine()+1),E=p.padding==null?" ":p.padding,k=p.commentBlankLines||a.line==d.line;f.operation(function(){if(p.indent){for(var R=null,M=a.line;M<S;++M){var L=f.getLine(M),V=L.slice(0,n(L));(R==null||R.length>V.length)&&(R=V)}for(var M=a.line;M<S;++M){var L=f.getLine(M),H=R.length;!k&&!t.test(L)||(L.slice(0,H)!=R&&(H=n(L)),f.replaceRange(R+w+E,i(M,0),i(M,H)))}}else for(var M=a.line;M<S;++M)(k||t.test(f.getLine(M)))&&f.replaceRange(w+E,i(M,0))})}}),c.defineExtension("blockComment",function(a,d,p){p||(p=e);var f=this,_=f.getModeAt(a),b=p.blockCommentStart||_.blockCommentStart,w=p.blockCommentEnd||_.blockCommentEnd;if(!b||!w){(p.lineComment||_.lineComment)&&p.fullLines!=!1&&f.lineComment(a,d,p);return}if(!/\bcomment\b/.test(f.getTokenTypeAt(i(a.line,0)))){var S=Math.min(d.line,f.lastLine());S!=a.line&&d.ch==0&&t.test(f.getLine(S))&&--S;var E=p.padding==null?" ":p.padding;a.line>S||f.operation(function(){if(p.fullLines!=!1){var k=t.test(f.getLine(S));f.replaceRange(E+w,i(S)),f.replaceRange(b+E,i(a.line,0));var R=p.blockCommentLead||_.blockCommentLead;if(R!=null)for(var M=a.line+1;M<=S;++M)(M!=S||k)&&f.replaceRange(R+E,i(M,0))}else f.replaceRange(w,d),f.replaceRange(b,a)})}}),c.defineExtension("uncomment",function(a,d,p){p||(p=e);var f=this,_=f.getModeAt(a),b=Math.min(d.ch!=0||d.line==a.line?d.line:d.line-1,f.lastLine()),w=Math.min(a.line,b),S=p.lineComment||_.lineComment,E=[],k=p.padding==null?" ":p.padding,R;e:{if(!S)break e;for(var M=w;M<=b;++M){var L=f.getLine(M),V=L.indexOf(S);if(V>-1&&!/comment/.test(f.getTokenTypeAt(i(M,V+1)))&&(V=-1),V==-1&&t.test(L)||V>-1&&t.test(L.slice(0,V)))break e;E.push(L)}if(f.operation(function(){for(var ve=w;ve<=b;++ve){var Pe=E[ve-w],Be=Pe.indexOf(S),qe=Be+S.length;Be<0||(Pe.slice(qe,qe+k.length)==k&&(qe+=k.length),R=!0,f.replaceRange("",i(ve,Be),i(ve,qe)))}}),R)return!0}var H=p.blockCommentStart||_.blockCommentStart,O=p.blockCommentEnd||_.blockCommentEnd;if(!H||!O)return!1;var z=p.blockCommentLead||_.blockCommentLead,K=f.getLine(w),q=K.indexOf(H);if(q==-1)return!1;var Y=b==w?K:f.getLine(b),se=Y.indexOf(O,b==w?q+H.length:0);if(se==-1&&w!=b&&(Y=f.getLine(--b),se=Y.indexOf(O)),se==-1||!/comment/.test(f.getTokenTypeAt(i(w,q+1)))||!/comment/.test(f.getTokenTypeAt(i(b,se+1))))return!1;var ce=K.lastIndexOf(H,a.ch),le=ce==-1?-1:K.slice(0,a.ch).indexOf(O,ce+H.length);if(ce!=-1&&le!=-1&&le+O.length!=a.ch)return!1;le=Y.indexOf(O,d.ch);var te=Y.slice(d.ch).lastIndexOf(H,le-d.ch);return ce=le==-1||te==-1?-1:d.ch+te,le!=-1&&ce!=-1&&ce!=d.ch?!1:(f.operation(function(){f.replaceRange("",i(b,se-(k&&Y.slice(se-k.length,se)==k?k.length:0)),i(b,se+O.length));var ve=q+H.length;if(k&&K.slice(ve,ve+k.length)==k&&(ve+=k.length),f.replaceRange("",i(w,q),i(w,ve)),z)for(var Pe=w+1;Pe<=b;++Pe){var Be=f.getLine(Pe),qe=Be.indexOf(z);if(!(qe==-1||t.test(Be.slice(0,qe)))){var Ue=qe+z.length;k&&Be.slice(Ue,Ue+k.length)==k&&(Ue+=k.length),f.replaceRange("",i(Pe,qe),i(Pe,Ue))}}}),!0)})});(function(c){typeof exports=="object"&&typeof module=="object"?c(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],c):c(CodeMirror)})(function(c){"use strict";c.defineMode("css",function(q,Y){var se=Y.inline;Y.propertyKeywords||(Y=c.resolveMode("text/css"));var ce=q.indentUnit,le=Y.tokenHooks,te=Y.documentTypes||{},ve=Y.mediaTypes||{},Pe=Y.mediaFeatures||{},Be=Y.mediaValueKeywords||{},qe=Y.propertyKeywords||{},Ue=Y.nonStandardPropertyKeywords||{},Ge=Y.fontProperties||{},it=Y.counterDescriptors||{},lt=Y.colorKeywords||{},bt=Y.valueKeywords||{},Yt=Y.allowNested,ni=Y.supportsAtComponent===!0,ri,He;function ei(pe,ee){return ri=ee,pe}function ui(pe,ee){var Ce=pe.next();if(le[Ce]){var Lt=le[Ce](pe,ee);if(Lt!==!1)return Lt}if(Ce=="@")return pe.eatWhile(/[\w\\\-]/),ei("def",pe.current());if(Ce=="="||(Ce=="~"||Ce=="|")&&pe.eat("="))return ei(null,"compare");if(Ce=='"'||Ce=="'")return ee.tokenize=vi(Ce),ee.tokenize(pe,ee);if(Ce=="#")return pe.eatWhile(/[\w\\\-]/),ei("atom","hash");if(Ce=="!")return pe.match(/^\s*\w*/),ei("keyword","important");if(/\d/.test(Ce)||Ce=="."&&pe.eat(/\d/))return pe.eatWhile(/[\w.%]/),ei("number","unit");if(Ce==="-"){if(/[\d.]/.test(pe.peek()))return pe.eatWhile(/[\w.%]/),ei("number","unit");if(pe.match(/^-[\w\\\-]+/))return pe.eatWhile(/[\w\\\-]/),pe.match(/^\s*:/,!1)?ei("variable-2","variable-definition"):ei("variable-2","variable");if(pe.match(/^\w+-/))return ei("meta","meta")}else return/[,+>*\/]/.test(Ce)?ei(null,"select-op"):Ce=="."&&pe.match(/^-?[_a-z][_a-z0-9-]*/i)?ei("qualifier","qualifier"):/[:;{}\[\]\(\)]/.test(Ce)?ei(null,Ce):Ce=="u"&&pe.match(/rl(-prefix)?\(/)||Ce=="d"&&pe.match("omain(")||Ce=="r"&&pe.match("egexp(")?(pe.backUp(1),ee.tokenize=Xe,ei("property","word")):/[\w\\\-]/.test(Ce)?(pe.eatWhile(/[\w\\\-]/),ei("property","word")):ei(null,null)}function vi(pe){return function(ee,Ce){for(var Lt=!1,tt;(tt=ee.next())!=null;){if(tt==pe&&!Lt){pe==")"&&ee.backUp(1);break}Lt=!Lt&&tt=="\\"}return(tt==pe||!Lt&&pe!=")")&&(Ce.tokenize=null),ei("string","string")}}function Xe(pe,ee){return pe.next(),pe.match(/\s*[\"\')]/,!1)?ee.tokenize=null:ee.tokenize=vi(")"),ei(null,"(")}function bi(pe,ee,Ce){this.type=pe,this.indent=ee,this.prev=Ce}function st(pe,ee,Ce,Lt){return pe.context=new bi(Ce,ee.indentation()+(Lt===!1?0:ce),pe.context),Ce}function De(pe){return pe.context.prev&&(pe.context=pe.context.prev),pe.context.type}function Me(pe,ee,Ce){return $e[Ce.context.type](pe,ee,Ce)}function Je(pe,ee,Ce,Lt){for(var tt=Lt||1;tt>0;tt--)Ce.context=Ce.context.prev;return Me(pe,ee,Ce)}function Ct(pe){var ee=pe.current().toLowerCase();bt.hasOwnProperty(ee)?He="atom":lt.hasOwnProperty(ee)?He="keyword":He="variable"}var $e={};return $e.top=function(pe,ee,Ce){if(pe=="{")return st(Ce,ee,"block");if(pe=="}"&&Ce.context.prev)return De(Ce);if(ni&&/@component/.test(pe))return st(Ce,ee,"atComponentBlock");if(/^@(-moz-)?document$/.test(pe))return st(Ce,ee,"documentTypes");if(/^@(media|supports|(-moz-)?document|import)$/.test(pe))return st(Ce,ee,"atBlock");if(/^@(font-face|counter-style)/.test(pe))return Ce.stateArg=pe,"restricted_atBlock_before";if(/^@(-(moz|ms|o|webkit)-)?keyframes$/.test(pe))return"keyframes";if(pe&&pe.charAt(0)=="@")return st(Ce,ee,"at");if(pe=="hash")He="builtin";else if(pe=="word")He="tag";else{if(pe=="variable-definition")return"maybeprop";if(pe=="interpolation")return st(Ce,ee,"interpolation");if(pe==":")return"pseudo";if(Yt&&pe=="(")return st(Ce,ee,"parens")}return Ce.context.type},$e.block=function(pe,ee,Ce){if(pe=="word"){var Lt=ee.current().toLowerCase();return qe.hasOwnProperty(Lt)?(He="property","maybeprop"):Ue.hasOwnProperty(Lt)?(He="string-2","maybeprop"):Yt?(He=ee.match(/^\s*:(?:\s|$)/,!1)?"property":"tag","block"):(He+=" error","maybeprop")}else return pe=="meta"?"block":!Yt&&(pe=="hash"||pe=="qualifier")?(He="error","block"):$e.top(pe,ee,Ce)},$e.maybeprop=function(pe,ee,Ce){return pe==":"?st(Ce,ee,"prop"):Me(pe,ee,Ce)},$e.prop=function(pe,ee,Ce){if(pe==";")return De(Ce);if(pe=="{"&&Yt)return st(Ce,ee,"propBlock");if(pe=="}"||pe=="{")return Je(pe,ee,Ce);if(pe=="(")return st(Ce,ee,"parens");if(pe=="hash"&&!/^#([0-9a-fA-f]{3,4}|[0-9a-fA-f]{6}|[0-9a-fA-f]{8})$/.test(ee.current()))He+=" error";else if(pe=="word")Ct(ee);else if(pe=="interpolation")return st(Ce,ee,"interpolation");return"prop"},$e.propBlock=function(pe,ee,Ce){return pe=="}"?De(Ce):pe=="word"?(He="property","maybeprop"):Ce.context.type},$e.parens=function(pe,ee,Ce){return pe=="{"||pe=="}"?Je(pe,ee,Ce):pe==")"?De(Ce):pe=="("?st(Ce,ee,"parens"):pe=="interpolation"?st(Ce,ee,"interpolation"):(pe=="word"&&Ct(ee),"parens")},$e.pseudo=function(pe,ee,Ce){return pe=="word"?(He="variable-3",Ce.context.type):Me(pe,ee,Ce)},$e.documentTypes=function(pe,ee,Ce){return pe=="word"&&te.hasOwnProperty(ee.current())?(He="tag",Ce.context.type):$e.atBlock(pe,ee,Ce)},$e.atBlock=function(pe,ee,Ce){if(pe=="(")return st(Ce,ee,"atBlock_parens");if(pe=="}"||pe==";")return Je(pe,ee,Ce);if(pe=="{")return De(Ce)&&st(Ce,ee,Yt?"block":"top");if(pe=="interpolation")return st(Ce,ee,"interpolation");if(pe=="word"){var Lt=ee.current().toLowerCase();Lt=="only"||Lt=="not"||Lt=="and"||Lt=="or"?He="keyword":ve.hasOwnProperty(Lt)?He="attribute":Pe.hasOwnProperty(Lt)?He="property":Be.hasOwnProperty(Lt)?He="keyword":qe.hasOwnProperty(Lt)?He="property":Ue.hasOwnProperty(Lt)?He="string-2":bt.hasOwnProperty(Lt)?He="atom":lt.hasOwnProperty(Lt)?He="keyword":He="error"}return Ce.context.type},$e.atComponentBlock=function(pe,ee,Ce){return pe=="}"?Je(pe,ee,Ce):pe=="{"?De(Ce)&&st(Ce,ee,Yt?"block":"top",!1):(pe=="word"&&(He="error"),Ce.context.type)},$e.atBlock_parens=function(pe,ee,Ce){return pe==")"?De(Ce):pe=="{"||pe=="}"?Je(pe,ee,Ce,2):$e.atBlock(pe,ee,Ce)},$e.restricted_atBlock_before=function(pe,ee,Ce){return pe=="{"?st(Ce,ee,"restricted_atBlock"):pe=="word"&&Ce.stateArg=="@counter-style"?(He="variable","restricted_atBlock_before"):Me(pe,ee,Ce)},$e.restricted_atBlock=function(pe,ee,Ce){return pe=="}"?(Ce.stateArg=null,De(Ce)):pe=="word"?(Ce.stateArg=="@font-face"&&!Ge.hasOwnProperty(ee.current().toLowerCase())||Ce.stateArg=="@counter-style"&&!it.hasOwnProperty(ee.current().toLowerCase())?He="error":He="property","maybeprop"):"restricted_atBlock"},$e.keyframes=function(pe,ee,Ce){return pe=="word"?(He="variable","keyframes"):pe=="{"?st(Ce,ee,"top"):Me(pe,ee,Ce)},$e.at=function(pe,ee,Ce){return pe==";"?De(Ce):pe=="{"||pe=="}"?Je(pe,ee,Ce):(pe=="word"?He="tag":pe=="hash"&&(He="builtin"),"at")},$e.interpolation=function(pe,ee,Ce){return pe=="}"?De(Ce):pe=="{"||pe==";"?Je(pe,ee,Ce):(pe=="word"?He="variable":pe!="variable"&&pe!="("&&pe!=")"&&(He="error"),"interpolation")},{startState:function(pe){return{tokenize:null,state:se?"block":"top",stateArg:null,context:new bi(se?"block":"top",pe||0,null)}},token:function(pe,ee){if(!ee.tokenize&&pe.eatSpace())return null;var Ce=(ee.tokenize||ui)(pe,ee);return Ce&&typeof Ce=="object"&&(ri=Ce[1],Ce=Ce[0]),He=Ce,ee.state=$e[ee.state](ri,pe,ee),He},indent:function(pe,ee){var Ce=pe.context,Lt=ee&&ee.charAt(0),tt=Ce.indent;return Ce.type=="prop"&&(Lt=="}"||Lt==")")&&(Ce=Ce.prev),Ce.prev&&(Lt=="}"&&(Ce.type=="block"||Ce.type=="top"||Ce.type=="interpolation"||Ce.type=="restricted_atBlock")?(Ce=Ce.prev,tt=Ce.indent):(Lt==")"&&(Ce.type=="parens"||Ce.type=="atBlock_parens")||Lt=="{"&&(Ce.type=="at"||Ce.type=="atBlock"))&&(tt=Math.max(0,Ce.indent-ce),Ce=Ce.prev)),tt},electricChars:"}",blockCommentStart:"/*",blockCommentEnd:"*/",fold:"brace"}});function e(q){for(var Y={},se=0;se<q.length;++se)Y[q[se].toLowerCase()]=!0;return Y}var t=["domain","regexp","url","url-prefix"],i=e(t),n=["all","aural","braille","handheld","print","projection","screen","tty","tv","embossed"],s=e(n),a=["width","min-width","max-width","height","min-height","max-height","device-width","min-device-width","max-device-width","device-height","min-device-height","max-device-height","aspect-ratio","min-aspect-ratio","max-aspect-ratio","device-aspect-ratio","min-device-aspect-ratio","max-device-aspect-ratio","color","min-color","max-color","color-index","min-color-index","max-color-index","monochrome","min-monochrome","max-monochrome","resolution","min-resolution","max-resolution","scan","grid","orientation","device-pixel-ratio","min-device-pixel-ratio","max-device-pixel-ratio","pointer","any-pointer","hover","any-hover"],d=e(a),p=["landscape","portrait","none","coarse","fine","on-demand","hover","interlace","progressive"],f=e(p),_=["align-content","align-items","align-self","alignment-adjust","alignment-baseline","anchor-point","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","azimuth","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","baseline-shift","binding","bleed","bookmark-label","bookmark-level","bookmark-state","bookmark-target","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","clear","clip","color","color-profile","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","content","counter-increment","counter-reset","crop","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","drop-initial-after-adjust","drop-initial-after-align","drop-initial-before-adjust","drop-initial-before-align","drop-initial-size","drop-initial-value","elevation","empty-cells","fit","fit-position","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","float-offset","flow-from","flow-into","font","font-feature-settings","font-family","font-kerning","font-language-override","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-weight","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-gap","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-gap","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","inline-box-align","justify-content","left","letter-spacing","line-break","line-height","line-stacking","line-stacking-ruby","line-stacking-shift","line-stacking-strategy","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marks","marquee-direction","marquee-loop","marquee-play-count","marquee-speed","marquee-style","max-height","max-width","min-height","min-width","move-to","nav-down","nav-index","nav-left","nav-right","nav-up","object-fit","object-position","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-style","overflow-wrap","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","page-policy","pause","pause-after","pause-before","perspective","perspective-origin","pitch","pitch-range","play-during","position","presentation-level","punctuation-trim","quotes","region-break-after","region-break-before","region-break-inside","region-fragment","rendering-intent","resize","rest","rest-after","rest-before","richness","right","rotation","rotation-point","ruby-align","ruby-overhang","ruby-position","ruby-span","shape-image-threshold","shape-inside","shape-margin","shape-outside","size","speak","speak-as","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","string-set","tab-size","table-layout","target","target-name","target-new","target-position","text-align","text-align-last","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-height","text-indent","text-justify","text-outline","text-overflow","text-shadow","text-size-adjust","text-space-collapse","text-transform","text-underline-position","text-wrap","top","transform","transform-box","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","unicode-bidi","user-select","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","volume","white-space","widows","width","will-change","word-break","word-spacing","word-wrap","z-index","clip-path","clip-rule","mask","enable-background","filter","flood-color","flood-opacity","lighting-color","stop-color","stop-opacity","pointer-events","color-interpolation","color-interpolation-filters","color-rendering","fill","fill-opacity","fill-rule","image-rendering","marker","marker-end","marker-mid","marker-start","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-rendering","baseline-shift","dominant-baseline","glyph-orientation-horizontal","glyph-orientation-vertical","text-anchor","writing-mode"],b=e(_),w=["scrollbar-arrow-color","scrollbar-base-color","scrollbar-dark-shadow-color","scrollbar-face-color","scrollbar-highlight-color","scrollbar-shadow-color","scrollbar-3d-light-color","scrollbar-track-color","shape-inside","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","zoom"],S=e(w),E=["font-family","src","unicode-range","font-variant","font-feature-settings","font-stretch","font-weight","font-style"],k=e(E),R=["additive-symbols","fallback","negative","pad","prefix","range","speak-as","suffix","symbols","system"],M=e(R),L=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],V=e(L),H=["above","absolute","activeborder","additive","activecaption","afar","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","amharic","amharic-abegede","antialiased","appworkspace","arabic-indic","armenian","asterisks","attr","auto","avoid","avoid-column","avoid-page","avoid-region","background","backwards","baseline","below","bidi-override","binary","bengali","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","cambodian","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","cjk-earthly-branch","cjk-heavenly-stem","cjk-ideographic","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","color-well","column","column-reverse","compact","condensed","contain","content","contents","content-box","context-menu","continuous","copy","counter","counters","cover","crop","cross","crosshair","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","dense","destination-atop","destination-in","destination-out","destination-over","devanagari","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic","ethiopic-abegede","ethiopic-abegede-am-et","ethiopic-abegede-gez","ethiopic-abegede-ti-er","ethiopic-abegede-ti-et","ethiopic-halehame-aa-er","ethiopic-halehame-aa-et","ethiopic-halehame-am-et","ethiopic-halehame-gez","ethiopic-halehame-om-et","ethiopic-halehame-sid-et","ethiopic-halehame-so-et","ethiopic-halehame-ti-er","ethiopic-halehame-ti-et","ethiopic-halehame-tig","ethiopic-numeric","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fixed","flat","flex","flex-end","flex-start","flow-root","footnotes","forwards","from","geometricPrecision","georgian","graytext","grid","groove","gujarati","gurmukhi","hand","hangul","hangul-consonant","hard-light","hebrew","help","hidden","hide","higher","highlight","highlighttext","hiragana","hiragana-iroha","horizontal","hsl","hsla","hue","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-grid","inline-table","inset","inside","intrinsic","invert","italic","japanese-formal","japanese-informal","justify","kannada","katakana","katakana-iroha","keep-all","khmer","korean-hangul-formal","korean-hanja-formal","korean-hanja-informal","landscape","lao","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","list-button","listitem","local","logical","loud","lower","lower-alpha","lower-armenian","lower-greek","lower-hexadecimal","lower-latin","lower-norwegian","lower-roman","lowercase","ltr","luminosity","malayalam","match","matrix","matrix3d","media-controls-background","media-current-time-display","media-fullscreen-button","media-mute-button","media-play-button","media-return-to-realtime-button","media-rewind-button","media-seek-back-button","media-seek-forward-button","media-slider","media-sliderthumb","media-time-remaining-display","media-volume-slider","media-volume-slider-container","media-volume-sliderthumb","medium","menu","menulist","menulist-button","menulist-text","menulist-textfield","menutext","message-box","middle","min-intrinsic","mix","mongolian","monospace","move","multiple","multiply","myanmar","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","octal","opacity","open-quote","optimizeLegibility","optimizeSpeed","oriya","oromo","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","persian","perspective","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","scroll-position","se-resize","searchfield","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","semi-condensed","semi-expanded","separate","serif","show","sidama","simp-chinese-formal","simp-chinese-informal","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","somali","source-atop","source-in","source-out","source-over","space","space-around","space-between","spell-out","square","square-button","start","static","status-bar","stretch","stroke","sub","subpixel-antialiased","super","sw-resize","symbolic","symbols","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","tamil","telugu","text","text-bottom","text-top","textarea","textfield","thai","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","tibetan","tigre","tigrinya-er","tigrinya-er-abegede","tigrinya-et","tigrinya-et-abegede","to","top","trad-chinese-formal","trad-chinese-informal","transform","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","unset","up","upper-alpha","upper-armenian","upper-greek","upper-hexadecimal","upper-latin","upper-norwegian","upper-roman","uppercase","urdu","url","var","vertical","vertical-text","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"],O=e(H),z=t.concat(n).concat(a).concat(p).concat(_).concat(w).concat(L).concat(H);c.registerHelper("hintWords","css",z);function K(q,Y){for(var se=!1,ce;(ce=q.next())!=null;){if(se&&ce=="/"){Y.tokenize=null;break}se=ce=="*"}return["comment","comment"]}c.defineMIME("text/css",{documentTypes:i,mediaTypes:s,mediaFeatures:d,mediaValueKeywords:f,propertyKeywords:b,nonStandardPropertyKeywords:S,fontProperties:k,counterDescriptors:M,colorKeywords:V,valueKeywords:O,tokenHooks:{"/":function(q,Y){return q.eat("*")?(Y.tokenize=K,K(q,Y)):!1}},name:"css"}),c.defineMIME("text/x-scss",{mediaTypes:s,mediaFeatures:d,mediaValueKeywords:f,propertyKeywords:b,nonStandardPropertyKeywords:S,colorKeywords:V,valueKeywords:O,fontProperties:k,allowNested:!0,tokenHooks:{"/":function(q,Y){return q.eat("/")?(q.skipToEnd(),["comment","comment"]):q.eat("*")?(Y.tokenize=K,K(q,Y)):["operator","operator"]},":":function(q){return q.match(/\s*\{/)?[null,"{"]:!1},$:function(q){return q.match(/^[\w-]+/),q.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"]},"#":function(q){return q.eat("{")?[null,"interpolation"]:!1}},name:"css",helperType:"scss"}),c.defineMIME("text/x-less",{mediaTypes:s,mediaFeatures:d,mediaValueKeywords:f,propertyKeywords:b,nonStandardPropertyKeywords:S,colorKeywords:V,valueKeywords:O,fontProperties:k,allowNested:!0,tokenHooks:{"/":function(q,Y){return q.eat("/")?(q.skipToEnd(),["comment","comment"]):q.eat("*")?(Y.tokenize=K,K(q,Y)):["operator","operator"]},"@":function(q){return q.eat("{")?[null,"interpolation"]:q.match(/^(charset|document|font-face|import|(-(moz|ms|o|webkit)-)?keyframes|media|namespace|page|supports)\b/,!1)?!1:(q.eatWhile(/[\w\\\-]/),q.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"])},"&":function(){return["atom","atom"]}},name:"css",helperType:"less"}),c.defineMIME("text/x-gss",{documentTypes:i,mediaTypes:s,mediaFeatures:d,propertyKeywords:b,nonStandardPropertyKeywords:S,fontProperties:k,counterDescriptors:M,colorKeywords:V,valueKeywords:O,supportsAtComponent:!0,tokenHooks:{"/":function(q,Y){return q.eat("*")?(Y.tokenize=K,K(q,Y)):!1}},name:"css",helperType:"gss"})});(function(c){typeof exports=="object"&&typeof module=="object"?c(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript"),require("../css/css")):typeof define=="function"&&define.amd?define(["../../lib/codemirror","../xml/xml","../javascript/javascript","../css/css"],c):c(CodeMirror)})(function(c){"use strict";var e={script:[["lang",/(javascript|babel)/i,"javascript"],["type",/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^$/i,"javascript"],["type",/./,"text/plain"],[null,null,"javascript"]],style:[["lang",/^css$/i,"css"],["type",/^(text\/)?(x-)?(stylesheet|css)$/i,"css"],["type",/./,"text/plain"],[null,null,"css"]]};function t(f,_,b){var w=f.current(),S=w.search(_);return S>-1?f.backUp(w.length-S):w.match(/<\/?$/)&&(f.backUp(w.length),f.match(_,!1)||f.match(w)),b}var i={};function n(f){var _=i[f];return _||(i[f]=new RegExp("\\s+"+f+`\\s*=\\s*('|")?([^'"]+)('|")?\\s*`))}function s(f,_){var b=f.match(n(_));return b?/^\s*(.*?)\s*$/.exec(b[2])[1]:""}function a(f,_){return new RegExp((_?"^":"")+"</s*"+f+"s*>","i")}function d(f,_){for(var b in f)for(var w=_[b]||(_[b]=[]),S=f[b],E=S.length-1;E>=0;E--)w.unshift(S[E])}function p(f,_){for(var b=0;b<f.length;b++){var w=f[b];if(!w[0]||w[1].test(s(_,w[0])))return w[2]}}c.defineMode("htmlmixed",function(f,_){var b=c.getMode(f,{name:"xml",htmlMode:!0,multilineTagIndentFactor:_.multilineTagIndentFactor,multilineTagIndentPastTag:_.multilineTagIndentPastTag}),w={},S=_&&_.tags,E=_&&_.scriptTypes;if(d(e,w),S&&d(S,w),E)for(var k=E.length-1;k>=0;k--)w.script.unshift(["type",E[k].matches,E[k].mode]);function R(M,L){var V=b.token(M,L.htmlState),H=/\btag\b/.test(V),O;if(H&&!/[<>\s\/]/.test(M.current())&&(O=L.htmlState.tagName&&L.htmlState.tagName.toLowerCase())&&w.hasOwnProperty(O))L.inTag=O+" ";else if(L.inTag&&H&&/>$/.test(M.current())){var z=/^([\S]+) (.*)/.exec(L.inTag);L.inTag=null;var K=M.current()==">"&&p(w[z[1]],z[2]),q=c.getMode(f,K),Y=a(z[1],!0),se=a(z[1],!1);L.token=function(ce,le){return ce.match(Y,!1)?(le.token=R,le.localState=le.localMode=null,null):t(ce,se,le.localMode.token(ce,le.localState))},L.localMode=q,L.localState=c.startState(q,b.indent(L.htmlState,""))}else L.inTag&&(L.inTag+=M.current(),M.eol()&&(L.inTag+=" "));return V}return{startState:function(){var M=c.startState(b);return{token:R,inTag:null,localMode:null,localState:null,htmlState:M}},copyState:function(M){var L;return M.localState&&(L=c.copyState(M.localMode,M.localState)),{token:M.token,inTag:M.inTag,localMode:M.localMode,localState:L,htmlState:c.copyState(b,M.htmlState)}},token:function(M,L){return L.token(M,L)},indent:function(M,L){return!M.localMode||/^\s*<\//.test(L)?b.indent(M.htmlState,L):M.localMode.indent?M.localMode.indent(M.localState,L):c.Pass},innerMode:function(M){return{state:M.localState||M.htmlState,mode:M.localMode||b}}}},"xml","javascript","css"),c.defineMIME("text/html","htmlmixed")});(function(c){typeof exports=="object"&&typeof module=="object"?c(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],c):c(CodeMirror)})(function(c){"use strict";function e(t,i,n){return/^(?:operator|sof|keyword c|case|new|[\[{}\(,;:]|=>)$/.test(i.lastType)||i.lastType=="quasi"&&/\{\s*$/.test(t.string.slice(0,t.pos-(n||0)))}c.defineMode("javascript",function(t,i){var n=t.indentUnit,s=i.statementIndent,a=i.jsonld,d=i.json||a,p=i.typescript,f=i.wordCharacters||/[\w$\xa1-\uffff]/,_=function(){function oe(Is){return{type:Is,style:"keyword"}}var ke=oe("keyword a"),Ze=oe("keyword b"),We=oe("keyword c"),$t=oe("operator"),Jt={type:"atom",style:"atom"},an={if:oe("if"),while:ke,with:ke,else:Ze,do:Ze,try:Ze,finally:Ze,return:We,break:We,continue:We,new:oe("new"),delete:We,throw:We,debugger:We,var:oe("var"),const:oe("var"),let:oe("var"),function:oe("function"),catch:oe("catch"),for:oe("for"),switch:oe("switch"),case:oe("case"),default:oe("default"),in:$t,typeof:$t,instanceof:$t,true:Jt,false:Jt,null:Jt,undefined:Jt,NaN:Jt,Infinity:Jt,this:oe("this"),class:oe("class"),super:oe("atom"),yield:We,export:oe("export"),import:oe("import"),extends:We,await:We,async:oe("async")};if(p){var Ki={type:"variable",style:"variable-3"},Rn={interface:oe("class"),implements:We,namespace:We,module:oe("module"),enum:oe("module"),type:oe("type"),public:oe("modifier"),private:oe("modifier"),protected:oe("modifier"),abstract:oe("modifier"),as:$t,string:Ki,number:Ki,boolean:Ki,any:Ki};for(var tr in Rn)an[tr]=Rn[tr]}return an}(),b=/[+\-*&%=<>!?|~^]/,w=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;function S(oe){for(var ke=!1,Ze,We=!1;(Ze=oe.next())!=null;){if(!ke){if(Ze=="/"&&!We)return;Ze=="["?We=!0:We&&Ze=="]"&&(We=!1)}ke=!ke&&Ze=="\\"}}var E,k;function R(oe,ke,Ze){return E=oe,k=Ze,ke}function M(oe,ke){var Ze=oe.next();if(Ze=='"'||Ze=="'")return ke.tokenize=L(Ze),ke.tokenize(oe,ke);if(Ze=="."&&oe.match(/^\d+(?:[eE][+\-]?\d+)?/))return R("number","number");if(Ze=="."&&oe.match(".."))return R("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(Ze))return R(Ze);if(Ze=="="&&oe.eat(">"))return R("=>","operator");if(Ze=="0"&&oe.eat(/x/i))return oe.eatWhile(/[\da-f]/i),R("number","number");if(Ze=="0"&&oe.eat(/o/i))return oe.eatWhile(/[0-7]/i),R("number","number");if(Ze=="0"&&oe.eat(/b/i))return oe.eatWhile(/[01]/i),R("number","number");if(/\d/.test(Ze))return oe.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),R("number","number");if(Ze=="/")return oe.eat("*")?(ke.tokenize=V,V(oe,ke)):oe.eat("/")?(oe.skipToEnd(),R("comment","comment")):e(oe,ke,1)?(S(oe),oe.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/),R("regexp","string-2")):(oe.eatWhile(b),R("operator","operator",oe.current()));if(Ze=="`")return ke.tokenize=H,H(oe,ke);if(Ze=="#")return oe.skipToEnd(),R("error","error");if(b.test(Ze))return(Ze!=">"||!ke.lexical||ke.lexical.type!=">")&&oe.eatWhile(b),R("operator","operator",oe.current());if(f.test(Ze)){oe.eatWhile(f);var We=oe.current(),$t=_.propertyIsEnumerable(We)&&_[We];return $t&&ke.lastType!="."?R($t.type,$t.style,We):R("variable","variable",We)}}function L(oe){return function(ke,Ze){var We=!1,$t;if(a&&ke.peek()=="@"&&ke.match(w))return Ze.tokenize=M,R("jsonld-keyword","meta");for(;($t=ke.next())!=null&&!($t==oe&&!We);)We=!We&&$t=="\\";return We||(Ze.tokenize=M),R("string","string")}}function V(oe,ke){for(var Ze=!1,We;We=oe.next();){if(We=="/"&&Ze){ke.tokenize=M;break}Ze=We=="*"}return R("comment","comment")}function H(oe,ke){for(var Ze=!1,We;(We=oe.next())!=null;){if(!Ze&&(We=="`"||We=="$"&&oe.eat("{"))){ke.tokenize=M;break}Ze=!Ze&&We=="\\"}return R("quasi","string-2",oe.current())}var O="([{}])";function z(oe,ke){ke.fatArrowAt&&(ke.fatArrowAt=null);var Ze=oe.string.indexOf("=>",oe.start);if(!(Ze<0)){if(p){var We=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(oe.string.slice(oe.start,Ze));We&&(Ze=We.index)}for(var $t=0,Jt=!1,an=Ze-1;an>=0;--an){var Ki=oe.string.charAt(an),Rn=O.indexOf(Ki);if(Rn>=0&&Rn<3){if(!$t){++an;break}if(--$t==0){Ki=="("&&(Jt=!0);break}}else if(Rn>=3&&Rn<6)++$t;else if(f.test(Ki))Jt=!0;else{if(/["'\/]/.test(Ki))return;if(Jt&&!$t){++an;break}}}Jt&&!$t&&(ke.fatArrowAt=an)}}var K={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,"jsonld-keyword":!0};function q(oe,ke,Ze,We,$t,Jt){this.indented=oe,this.column=ke,this.type=Ze,this.prev=$t,this.info=Jt,We!=null&&(this.align=We)}function Y(oe,ke){for(var Ze=oe.localVars;Ze;Ze=Ze.next)if(Ze.name==ke)return!0;for(var We=oe.context;We;We=We.prev)for(var Ze=We.vars;Ze;Ze=Ze.next)if(Ze.name==ke)return!0}function se(oe,ke,Ze,We,$t){var Jt=oe.cc;for(ce.state=oe,ce.stream=$t,ce.marked=null,ce.cc=Jt,ce.style=ke,oe.lexical.hasOwnProperty("align")||(oe.lexical.align=!0);;){var an=Jt.length?Jt.pop():d?bt:lt;if(an(Ze,We)){for(;Jt.length&&Jt[Jt.length-1].lex;)Jt.pop()();return ce.marked?ce.marked:Ze=="variable"&&Y(oe,We)?"variable-2":ke}}}var ce={state:null,column:null,marked:null,cc:null};function le(){for(var oe=arguments.length-1;oe>=0;oe--)ce.cc.push(arguments[oe])}function te(){return le.apply(null,arguments),!0}function ve(oe){function ke(We){for(var $t=We;$t;$t=$t.next)if($t.name==oe)return!0;return!1}var Ze=ce.state;if(ce.marked="def",Ze.context){if(ke(Ze.localVars))return;Ze.localVars={name:oe,next:Ze.localVars}}else{if(ke(Ze.globalVars))return;i.globalVars&&(Ze.globalVars={name:oe,next:Ze.globalVars})}}var Pe={name:"this",next:{name:"arguments"}};function Be(){ce.state.context={prev:ce.state.context,vars:ce.state.localVars},ce.state.localVars=Pe}function qe(){ce.state.localVars=ce.state.context.vars,ce.state.context=ce.state.context.prev}function Ue(oe,ke){var Ze=function(){var We=ce.state,$t=We.indented;if(We.lexical.type=="stat")$t=We.lexical.indented;else for(var Jt=We.lexical;Jt&&Jt.type==")"&&Jt.align;Jt=Jt.prev)$t=Jt.indented;We.lexical=new q($t,ce.stream.column(),oe,null,We.lexical,ke)};return Ze.lex=!0,Ze}function Ge(){var oe=ce.state;oe.lexical.prev&&(oe.lexical.type==")"&&(oe.indented=oe.lexical.indented),oe.lexical=oe.lexical.prev)}Ge.lex=!0;function it(oe){function ke(Ze){return Ze==oe?te():oe==";"?le():te(ke)}return ke}function lt(oe,ke){return oe=="var"?te(Ue("vardef",ke.length),Rt,it(";"),Ge):oe=="keyword a"?te(Ue("form"),ni,lt,Ge):oe=="keyword b"?te(Ue("form"),lt,Ge):oe=="{"?te(Ue("}"),sn,Ge):oe==";"?te():oe=="if"?(ce.state.lexical.info=="else"&&ce.state.cc[ce.state.cc.length-1]==Ge&&ce.state.cc.pop()(),te(Ue("form"),ni,lt,Ge,Ft)):oe=="function"?te(Yn):oe=="for"?te(Ue("form"),fn,lt,Ge):oe=="variable"?te(Ue("stat"),$e):oe=="switch"?te(Ue("form"),ni,Ue("}","switch"),it("{"),sn,Ge,Ge):oe=="case"?te(bt,it(":")):oe=="default"?te(it(":")):oe=="catch"?te(Ue("form"),Be,it("("),Le,it(")"),lt,Ge,qe):oe=="class"?te(Ue("form"),et,Ge):oe=="export"?te(Ue("stat"),is,Ge):oe=="import"?te(Ue("stat"),Ia,Ge):oe=="module"?te(Ue("form"),xi,Ue("}"),it("{"),sn,Ge,Ge):oe=="type"?te(ti,it("operator"),ti,it(";")):oe=="async"?te(lt):le(Ue("stat"),bt,it(";"),Ge)}function bt(oe){return ri(oe,!1)}function Yt(oe){return ri(oe,!0)}function ni(oe){return oe!="("?le():te(Ue(")"),bt,it(")"),Ge)}function ri(oe,ke){if(ce.state.fatArrowAt==ce.stream.start){var Ze=ke?De:st;if(oe=="(")return te(Be,Ue(")"),tt(xi,")"),Ge,it("=>"),Ze,qe);if(oe=="variable")return le(Be,xi,it("=>"),Ze,qe)}var We=ke?vi:ui;return K.hasOwnProperty(oe)?te(We):oe=="function"?te(Yn,We):oe=="class"?te(Ue("form"),Ne,Ge):oe=="keyword c"||oe=="async"?te(ke?ei:He):oe=="("?te(Ue(")"),He,it(")"),Ge,We):oe=="operator"||oe=="spread"?te(ke?Yt:bt):oe=="["?te(Ue("]"),Dn,Ge,We):oe=="{"?yi(ee,"}",null,We):oe=="quasi"?le(Xe,We):oe=="new"?te(Me(ke)):te()}function He(oe){return oe.match(/[;\}\)\],]/)?le():le(bt)}function ei(oe){return oe.match(/[;\}\)\],]/)?le():le(Yt)}function ui(oe,ke){return oe==","?te(bt):vi(oe,ke,!1)}function vi(oe,ke,Ze){var We=Ze==!1?ui:vi,$t=Ze==!1?bt:Yt;if(oe=="=>")return te(Be,Ze?De:st,qe);if(oe=="operator")return/\+\+|--/.test(ke)?te(We):ke=="?"?te(bt,it(":"),$t):te($t);if(oe=="quasi")return le(Xe,We);if(oe!=";"){if(oe=="(")return yi(Yt,")","call",We);if(oe==".")return te(pe,We);if(oe=="[")return te(Ue("]"),He,it("]"),Ge,We)}}function Xe(oe,ke){return oe!="quasi"?le():ke.slice(ke.length-2)!="${"?te(Xe):te(bt,bi)}function bi(oe){if(oe=="}")return ce.marked="string-2",ce.state.tokenize=H,te(Xe)}function st(oe){return z(ce.stream,ce.state),le(oe=="{"?lt:bt)}function De(oe){return z(ce.stream,ce.state),le(oe=="{"?lt:Yt)}function Me(oe){return function(ke){return ke=="."?te(oe?Ct:Je):le(oe?Yt:bt)}}function Je(oe,ke){if(ke=="target")return ce.marked="keyword",te(ui)}function Ct(oe,ke){if(ke=="target")return ce.marked="keyword",te(vi)}function $e(oe){return oe==":"?te(Ge,lt):le(ui,it(";"),Ge)}function pe(oe){if(oe=="variable")return ce.marked="property",te()}function ee(oe,ke){if(oe=="async")return ce.marked="property",te(ee);if(oe=="variable"||ce.style=="keyword")return ce.marked="property",ke=="get"||ke=="set"?te(Ce):te(Lt);if(oe=="number"||oe=="string")return ce.marked=a?"property":ce.style+" property",te(Lt);if(oe=="jsonld-keyword")return te(Lt);if(oe=="modifier")return te(ee);if(oe=="[")return te(bt,it("]"),Lt);if(oe=="spread")return te(bt);if(oe==":")return le(Lt)}function Ce(oe){return oe!="variable"?le(Lt):(ce.marked="property",te(Yn))}function Lt(oe){if(oe==":")return te(Yt);if(oe=="(")return le(Yn)}function tt(oe,ke){function Ze(We,$t){if(We==","){var Jt=ce.state.lexical;return Jt.info=="call"&&(Jt.pos=(Jt.pos||0)+1),te(function(an,Ki){return an==ke||Ki==ke?le():le(oe)},Ze)}return We==ke||$t==ke?te():te(it(ke))}return function(We,$t){return We==ke||$t==ke?te():le(oe,Ze)}}function yi(oe,ke,Ze){for(var We=3;We<arguments.length;We++)ce.cc.push(arguments[We]);return te(Ue(ke,Ze),tt(oe,ke),Ge)}function sn(oe){return oe=="}"?te():le(lt,sn)}function ki(oe,ke){if(p){if(oe==":")return te(ti);if(ke=="?")return te(ki)}}function ti(oe){if(oe=="variable")return ce.marked="variable-3",te(Ye);if(oe=="string"||oe=="number"||oe=="atom")return te(Ye);if(oe=="{")return te(tt(er,"}"));if(oe=="(")return te(tt(cr,")"),On)}function On(oe){if(oe=="=>")return te(ti)}function er(oe){if(oe=="variable"||ce.style=="keyword")return ce.marked="property",te(er);if(oe==":")return te(ti)}function cr(oe){if(oe=="variable")return te(cr);if(oe==":")return te(ti)}function Ye(oe,ke){if(ke=="<")return te(Ue(">"),tt(ti,">"),Ge,Ye);if(ke=="|"||oe==".")return te(ti);if(oe=="[")return te(it("]"),Ye)}function Rt(){return le(xi,ki,Hi,Nr)}function xi(oe,ke){if(oe=="modifier")return te(xi);if(oe=="variable")return ve(ke),te();if(oe=="spread")return te(xi);if(oe=="[")return yi(xi,"]");if(oe=="{")return yi(Vn,"}")}function Vn(oe,ke){return oe=="variable"&&!ce.stream.match(/^\s*:/,!1)?(ve(ke),te(Hi)):(oe=="variable"&&(ce.marked="property"),oe=="spread"?te(xi):oe=="}"?le():te(it(":"),xi,Hi))}function Hi(oe,ke){if(ke=="=")return te(Yt)}function Nr(oe){if(oe==",")return te(Rt)}function Ft(oe,ke){if(oe=="keyword b"&&ke=="else")return te(Ue("form","else"),lt,Ge)}function fn(oe){if(oe=="(")return te(Ue(")"),ts,it(")"),Ge)}function ts(oe){return oe=="var"?te(Rt,it(";"),gn):oe==";"?te(gn):oe=="variable"?te(wr):le(bt,it(";"),gn)}function wr(oe,ke){return ke=="in"||ke=="of"?(ce.marked="keyword",te(bt)):te(ui,gn)}function gn(oe,ke){return oe==";"?te(Es):ke=="in"||ke=="of"?(ce.marked="keyword",te(bt)):le(bt,it(";"),Es)}function Es(oe){oe!=")"&&te(bt)}function Yn(oe,ke){if(ke=="*")return ce.marked="keyword",te(Yn);if(oe=="variable")return ve(ke),te(Yn);if(oe=="(")return te(Be,Ue(")"),tt(Le,")"),Ge,ki,lt,qe)}function Le(oe){return oe=="spread"?te(Le):le(xi,ki,Hi)}function Ne(oe,ke){return oe=="variable"?et(oe,ke):Gt(oe,ke)}function et(oe,ke){if(oe=="variable")return ve(ke),te(Gt)}function Gt(oe,ke){if(ke=="extends"||ke=="implements")return te(p?ti:bt,Gt);if(oe=="{")return te(Ue("}"),Wi,Ge)}function Wi(oe,ke){if(oe=="variable"||ce.style=="keyword")return(ke=="static"||ke=="get"||ke=="set"||p&&(ke=="public"||ke=="private"||ke=="protected"||ke=="readonly"||ke=="abstract"))&&ce.stream.match(/^\s+[\w$\xa1-\uffff]/,!1)?(ce.marked="keyword",te(Wi)):(ce.marked="property",te(p?Pr:Yn,Wi));if(ke=="*")return ce.marked="keyword",te(Wi);if(oe==";")return te(Wi);if(oe=="}")return te()}function Pr(oe,ke){return ke=="?"?te(Pr):oe==":"?te(ti,Hi):le(Yn)}function is(oe,ke){return ke=="*"?(ce.marked="keyword",te(Tr,it(";"))):ke=="default"?(ce.marked="keyword",te(bt,it(";"))):le(lt)}function Ia(oe){return oe=="string"?te():le(Ar,Tr)}function Ar(oe,ke){return oe=="{"?yi(Ar,"}"):(oe=="variable"&&ve(ke),ke=="*"&&(ce.marked="keyword"),te(Ra))}function Ra(oe,ke){if(ke=="as")return ce.marked="keyword",te(Ar)}function Tr(oe,ke){if(ke=="from")return ce.marked="keyword",te(bt)}function Dn(oe){return oe=="]"?te():le(tt(Yt,"]"))}function xs(oe,ke){return oe.lastType=="operator"||oe.lastType==","||b.test(ke.charAt(0))||/[,.]/.test(ke.charAt(0))}return{startState:function(oe){var ke={tokenize:M,lastType:"sof",cc:[],lexical:new q((oe||0)-n,0,"block",!1),localVars:i.localVars,context:i.localVars&&{vars:i.localVars},indented:oe||0};return i.globalVars&&typeof i.globalVars=="object"&&(ke.globalVars=i.globalVars),ke},token:function(oe,ke){if(oe.sol()&&(ke.lexical.hasOwnProperty("align")||(ke.lexical.align=!1),ke.indented=oe.indentation(),z(oe,ke)),ke.tokenize!=V&&oe.eatSpace())return null;var Ze=ke.tokenize(oe,ke);return E=="comment"?Ze:(ke.lastType=E=="operator"&&(k=="++"||k=="--")?"incdec":E,se(ke,Ze,E,k,oe))},indent:function(oe,ke){if(oe.tokenize==V)return c.Pass;if(oe.tokenize!=M)return 0;var Ze=ke&&ke.charAt(0),We=oe.lexical,$t;if(!/^\s*else\b/.test(ke))for(var Jt=oe.cc.length-1;Jt>=0;--Jt){var an=oe.cc[Jt];if(an==Ge)We=We.prev;else if(an!=Ft)break}for(;(We.type=="stat"||We.type=="form")&&(Ze=="}"||($t=oe.cc[oe.cc.length-1])&&($t==ui||$t==vi)&&!/^[,\.=+\-*:?[\(]/.test(ke));)We=We.prev;s&&We.type==")"&&We.prev.type=="stat"&&(We=We.prev);var Ki=We.type,Rn=Ze==Ki;return Ki=="vardef"?We.indented+(oe.lastType=="operator"||oe.lastType==","?We.info+1:0):Ki=="form"&&Ze=="{"?We.indented:Ki=="form"?We.indented+n:Ki=="stat"?We.indented+(xs(oe,ke)?s||n:0):We.info=="switch"&&!Rn&&i.doubleIndentSwitch!=!1?We.indented+(/^(?:case|default)\b/.test(ke)?n:2*n):We.align?We.column+(Rn?0:1):We.indented+(Rn?0:n)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:d?null:"/*",blockCommentEnd:d?null:"*/",lineComment:d?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:d?"json":"javascript",jsonldMode:a,jsonMode:d,expressionAllowed:e,skipExpression:function(oe){var ke=oe.cc[oe.cc.length-1];(ke==bt||ke==Yt)&&oe.cc.pop()}}}),c.registerHelper("wordChars","javascript",/[\w$]/),c.defineMIME("text/javascript","javascript"),c.defineMIME("text/ecmascript","javascript"),c.defineMIME("application/javascript","javascript"),c.defineMIME("application/x-javascript","javascript"),c.defineMIME("application/ecmascript","javascript"),c.defineMIME("application/json",{name:"javascript",json:!0}),c.defineMIME("application/x-json",{name:"javascript",json:!0}),c.defineMIME("application/ld+json",{name:"javascript",jsonld:!0}),c.defineMIME("text/typescript",{name:"javascript",typescript:!0}),c.defineMIME("application/typescript",{name:"javascript",typescript:!0})});(function(c){typeof exports=="object"&&typeof module=="object"?c(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript")):typeof define=="function"&&define.amd?define(["../../lib/codemirror","../xml/xml","../javascript/javascript"],c):c(CodeMirror)})(function(c){"use strict";function e(i,n,s,a){this.state=i,this.mode=n,this.depth=s,this.prev=a}function t(i){return new e(c.copyState(i.mode,i.state),i.mode,i.depth,i.prev&&t(i.prev))}c.defineMode("jsx",function(i,n){var s=c.getMode(i,{name:"xml",allowMissing:!0,multilineTagIndentPastTag:!1,allowMissingTagName:!0}),a=c.getMode(i,n&&n.base||"javascript");function d(b){var w=b.tagName;b.tagName=null;var S=s.indent(b,"");return b.tagName=w,S}function p(b,w){return w.context.mode==s?f(b,w,w.context):_(b,w,w.context)}function f(b,w,S){if(S.depth==2)return b.match(/^.*?\*\//)?S.depth=1:b.skipToEnd(),"comment";if(b.peek()=="{"){s.skipAttribute(S.state);var E=d(S.state),k=S.state.context;if(k&&b.match(/^[^>]*>\s*$/,!1)){for(;k.prev&&!k.startOfLine;)k=k.prev;k.startOfLine?E-=i.indentUnit:S.prev.state.lexical&&(E=S.prev.state.lexical.indented)}else S.depth==1&&(E+=i.indentUnit);return w.context=new e(c.startState(a,E),a,0,w.context),null}if(S.depth==1){if(b.peek()=="<")return s.skipAttribute(S.state),w.context=new e(c.startState(s,d(S.state)),s,0,w.context),null;if(b.match("//"))return b.skipToEnd(),"comment";if(b.match("/*"))return S.depth=2,p(b,w)}var R=s.token(b,S.state),M=b.current(),L;return/\btag\b/.test(R)?/>$/.test(M)?S.state.context?S.depth=0:w.context=w.context.prev:/^</.test(M)&&(S.depth=1):!R&&(L=M.indexOf("{"))>-1&&b.backUp(M.length-L),R}function _(b,w,S){if(b.peek()=="<"&&a.expressionAllowed(b,S.state))return a.skipExpression(S.state),w.context=new e(c.startState(s,a.indent(S.state,"")),s,0,w.context),null;var E=a.token(b,S.state);if(!E&&S.depth!=null){var k=b.current();k=="{"?S.depth++:k=="}"&&--S.depth==0&&(w.context=w.context.prev)}return E}return{startState:function(){return{context:new e(c.startState(a),a)}},copyState:function(b){return{context:t(b.context)}},token:p,indent:function(b,w,S){return b.context.mode.indent(b.context.state,w,S)},innerMode:function(b){return b.context}}},"xml","javascript"),c.defineMIME("text/jsx","jsx"),c.defineMIME("text/typescript-jsx",{name:"jsx",base:{name:"javascript",typescript:!0}})});(function(c){typeof exports=="object"&&typeof module=="object"?c(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],c):c(CodeMirror)})(function(c){"use strict";c.defineMode("livescript",function(){var b=function(S,E){var k=E.next||"start";if(k){E.next=E.next;var R=s[k];if(R.splice){for(var M=0;M<R.length;++M){var L=R[M];if(L.regex&&S.match(L.regex))return E.next=L.next||E.next,L.token}return S.next(),"error"}if(S.match(L=s[k]))return L.regex&&S.match(L.regex)?(E.next=L.next,L.token):(S.next(),"error")}return S.next(),"error"},w={startState:function(){return{next:"start",lastToken:{style:null,indent:0,content:""}}},token:function(S,E){for(;S.pos==S.start;)var k=b(S,E);return E.lastToken={style:k,indent:S.indentation(),content:S.current()},k.replace(/\./g," ")},indent:function(S){var E=S.lastToken.indent;return S.lastToken.content.match(t)&&(E+=2),E}};return w});var e="(?![\\d\\s])[$\\w\\xAA-\\uFFDC](?:(?!\\s)[$\\w\\xAA-\\uFFDC]|-[A-Za-z])*",t=RegExp("(?:[({[=:]|[-~]>|\\b(?:e(?:lse|xport)|d(?:o|efault)|t(?:ry|hen)|finally|import(?:\\s*all)?|const|var|let|new|catch(?:\\s*"+e+")?))\\s*$"),i="(?![$\\w]|-[A-Za-z]|\\s*:(?![:=]))",n={token:"string",regex:".+"},s={start:[{token:"comment.doc",regex:"/\\*",next:"comment"},{token:"comment",regex:"#.*"},{token:"keyword",regex:"(?:t(?:h(?:is|row|en)|ry|ypeof!?)|c(?:on(?:tinue|st)|a(?:se|tch)|lass)|i(?:n(?:stanceof)?|mp(?:ort(?:\\s+all)?|lements)|[fs])|d(?:e(?:fault|lete|bugger)|o)|f(?:or(?:\\s+own)?|inally|unction)|s(?:uper|witch)|e(?:lse|x(?:tends|port)|val)|a(?:nd|rguments)|n(?:ew|ot)|un(?:less|til)|w(?:hile|ith)|o[fr]|return|break|let|var|loop)"+i},{token:"constant.language",regex:"(?:true|false|yes|no|on|off|null|void|undefined)"+i},{token:"invalid.illegal",regex:"(?:p(?:ackage|r(?:ivate|otected)|ublic)|i(?:mplements|nterface)|enum|static|yield)"+i},{token:"language.support.class",regex:"(?:R(?:e(?:gExp|ferenceError)|angeError)|S(?:tring|yntaxError)|E(?:rror|valError)|Array|Boolean|Date|Function|Number|Object|TypeError|URIError)"+i},{token:"language.support.function",regex:"(?:is(?:NaN|Finite)|parse(?:Int|Float)|Math|JSON|(?:en|de)codeURI(?:Component)?)"+i},{token:"variable.language",regex:"(?:t(?:hat|il|o)|f(?:rom|allthrough)|it|by|e)"+i},{token:"identifier",regex:e+"\\s*:(?![:=])"},{token:"variable",regex:e},{token:"keyword.operator",regex:"(?:\\.{3}|\\s+\\?)"},{token:"keyword.variable",regex:"(?:@+|::|\\.\\.)",next:"key"},{token:"keyword.operator",regex:"\\.\\s*",next:"key"},{token:"string",regex:"\\\\\\S[^\\s,;)}\\]]*"},{token:"string.doc",regex:"'''",next:"qdoc"},{token:"string.doc",regex:'"""',next:"qqdoc"},{token:"string",regex:"'",next:"qstring"},{token:"string",regex:'"',next:"qqstring"},{token:"string",regex:"`",next:"js"},{token:"string",regex:"<\\[",next:"words"},{token:"string.regex",regex:"//",next:"heregex"},{token:"string.regex",regex:"\\/(?:[^[\\/\\n\\\\]*(?:(?:\\\\.|\\[[^\\]\\n\\\\]*(?:\\\\.[^\\]\\n\\\\]*)*\\])[^[\\/\\n\\\\]*)*)\\/[gimy$]{0,4}",next:"key"},{token:"constant.numeric",regex:"(?:0x[\\da-fA-F][\\da-fA-F_]*|(?:[2-9]|[12]\\d|3[0-6])r[\\da-zA-Z][\\da-zA-Z_]*|(?:\\d[\\d_]*(?:\\.\\d[\\d_]*)?|\\.\\d[\\d_]*)(?:e[+-]?\\d[\\d_]*)?[\\w$]*)"},{token:"lparen",regex:"[({[]"},{token:"rparen",regex:"[)}\\]]",next:"key"},{token:"keyword.operator",regex:"\\S+"},{token:"text",regex:"\\s+"}],heregex:[{token:"string.regex",regex:".*?//[gimy$?]{0,4}",next:"start"},{token:"string.regex",regex:"\\s*#{"},{token:"comment.regex",regex:"\\s+(?:#.*)?"},{token:"string.regex",regex:"\\S+"}],key:[{token:"keyword.operator",regex:"[.?@!]+"},{token:"identifier",regex:e,next:"start"},{token:"text",regex:"",next:"start"}],comment:[{token:"comment.doc",regex:".*?\\*/",next:"start"},{token:"comment.doc",regex:".+"}],qdoc:[{token:"string",regex:".*?'''",next:"key"},n],qqdoc:[{token:"string",regex:'.*?"""',next:"key"},n],qstring:[{token:"string",regex:"[^\\\\']*(?:\\\\.[^\\\\']*)*'",next:"key"},n],qqstring:[{token:"string",regex:'[^\\\\"]*(?:\\\\.[^\\\\"]*)*"',next:"key"},n],js:[{token:"string",regex:"[^\\\\`]*(?:\\\\.[^\\\\`]*)*`",next:"key"},n],words:[{token:"string",regex:".*?\\]>",next:"key"},n]};for(var a in s){var d=s[a];if(d.splice)for(var p=0,f=d.length;p<f;++p){var _=d[p];typeof _.regex=="string"&&(s[a][p].regex=new RegExp("^"+_.regex))}else typeof _.regex=="string"&&(s[a].regex=new RegExp("^"+d.regex))}c.defineMIME("text/x-livescript","livescript")});(function(c){typeof exports=="object"&&typeof module=="object"?c(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],c):c(CodeMirror)})(function(c){"use strict";c.defineOption("styleSelectedText",!1,function(_,b,w){var S=w&&w!=c.Init;b&&!S?(_.state.markedSelection=[],_.state.markedSelectionStyle=typeof b=="string"?b:"CodeMirror-selectedtext",p(_),_.on("cursorActivity",e),_.on("change",t)):!b&&S&&(_.off("cursorActivity",e),_.off("change",t),d(_),_.state.markedSelection=_.state.markedSelectionStyle=null)});function e(_){_.operation(function(){f(_)})}function t(_){_.state.markedSelection.length&&_.operation(function(){d(_)})}var i=8,n=c.Pos,s=c.cmpPos;function a(_,b,w,S){if(s(b,w)!=0)for(var E=_.state.markedSelection,k=_.state.markedSelectionStyle,R=b.line;;){var M=R==b.line?b:n(R,0),L=R+i,V=L>=w.line,H=V?w:n(L,0),O=_.markText(M,H,{className:k});if(S==null?E.push(O):E.splice(S++,0,O),V)break;R=L}}function d(_){for(var b=_.state.markedSelection,w=0;w<b.length;++w)b[w].clear();b.length=0}function p(_){d(_);for(var b=_.listSelections(),w=0;w<b.length;w++)a(_,b[w].from(),b[w].to())}function f(_){if(!_.somethingSelected())return d(_);if(_.listSelections().length>1)return p(_);var b=_.getCursor("start"),w=_.getCursor("end"),S=_.state.markedSelection;if(!S.length)return a(_,b,w);var E=S[0].find(),k=S[S.length-1].find();if(!E||!k||w.line-b.line<i||s(b,k.to)>=0||s(w,E.from)<=0)return p(_);for(;s(b,E.from)>0;)S.shift().clear(),E=S[0].find();for(s(b,E.from)<0&&(E.to.line-b.line<i?(S.shift().clear(),a(_,b,E.to,0)):a(_,b,E.from,0));s(w,k.to)<0;)S.pop().clear(),k=S[S.length-1].find();s(w,k.to)>0&&(w.line-k.from.line<i?(S.pop().clear(),a(_,k.from,w)):a(_,k.to,w))}});(function(c){typeof exports=="object"&&typeof module=="object"?c(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],c):c(CodeMirror)})(function(c){var e=/MSIE \d/.test(navigator.userAgent)&&(document.documentMode==null||document.documentMode<8),t=c.Pos,i={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"};function n(f,_,b,w){var S=f.getLineHandle(_.line),E=_.ch-1,k=E>=0&&i[S.text.charAt(E)]||i[S.text.charAt(++E)];if(!k)return null;var R=k.charAt(1)==">"?1:-1;if(b&&R>0!=(E==_.ch))return null;var M=f.getTokenTypeAt(t(_.line,E+1)),L=s(f,t(_.line,E+(R>0?1:0)),R,M||null,w);return L==null?null:{from:t(_.line,E),to:L&&L.pos,match:L&&L.ch==k.charAt(0),forward:R>0}}function s(f,_,b,w,S){for(var E=S&&S.maxScanLineLength||1e4,k=S&&S.maxScanLines||1e3,R=[],M=S&&S.bracketRegex?S.bracketRegex:/[(){}[\]]/,L=b>0?Math.min(_.line+k,f.lastLine()+1):Math.max(f.firstLine()-1,_.line-k),V=_.line;V!=L;V+=b){var H=f.getLine(V);if(!!H){var O=b>0?0:H.length-1,z=b>0?H.length:-1;if(!(H.length>E))for(V==_.line&&(O=_.ch-(b<0?1:0));O!=z;O+=b){var K=H.charAt(O);if(M.test(K)&&(w===void 0||f.getTokenTypeAt(t(V,O+1))==w)){var q=i[K];if(q.charAt(1)==">"==b>0)R.push(K);else if(R.length)R.pop();else return{pos:t(V,O),ch:K}}}}}return V-b==(b>0?f.lastLine():f.firstLine())?!1:null}function a(f,_,b){for(var w=f.state.matchBrackets.maxHighlightLineLength||1e3,S=[],E=f.listSelections(),k=0;k<E.length;k++){var R=E[k].empty()&&n(f,E[k].head,!1,b);if(R&&f.getLine(R.from.line).length<=w){var M=R.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";S.push(f.markText(R.from,t(R.from.line,R.from.ch+1),{className:M})),R.to&&f.getLine(R.to.line).length<=w&&S.push(f.markText(R.to,t(R.to.line,R.to.ch+1),{className:M}))}}if(S.length){e&&f.state.focused&&f.focus();var L=function(){f.operation(function(){for(var V=0;V<S.length;V++)S[V].clear()})};if(_)setTimeout(L,800);else return L}}var d=null;function p(f){f.operation(function(){d&&(d(),d=null),d=a(f,!1,f.state.matchBrackets)})}c.defineOption("matchBrackets",!1,function(f,_,b){b&&b!=c.Init&&(f.off("cursorActivity",p),d&&(d(),d=null)),_&&(f.state.matchBrackets=typeof _=="object"?_:{},f.on("cursorActivity",p))}),c.defineExtension("matchBrackets",function(){a(this,!0)}),c.defineExtension("findMatchingBracket",function(f,_,b){return n(this,f,_,b)}),c.defineExtension("scanForBracket",function(f,_,b,w){return s(this,f,_,b,w)})});(function(c){typeof exports=="object"&&typeof module=="object"?c(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],c):c(CodeMirror)})(function(c){"use strict";c.overlayMode=function(e,t,i){return{startState:function(){return{base:c.startState(e),overlay:c.startState(t),basePos:0,baseCur:null,overlayPos:0,overlayCur:null,streamSeen:null}},copyState:function(n){return{base:c.copyState(e,n.base),overlay:c.copyState(t,n.overlay),basePos:n.basePos,baseCur:null,overlayPos:n.overlayPos,overlayCur:null}},token:function(n,s){return(n!=s.streamSeen||Math.min(s.basePos,s.overlayPos)<n.start)&&(s.streamSeen=n,s.basePos=s.overlayPos=n.start),n.start==s.basePos&&(s.baseCur=e.token(n,s.base),s.basePos=n.pos),n.start==s.overlayPos&&(n.pos=n.start,s.overlayCur=t.token(n,s.overlay),s.overlayPos=n.pos),n.pos=Math.min(s.basePos,s.overlayPos),s.overlayCur==null?s.baseCur:s.baseCur!=null&&s.overlay.combineTokens||i&&s.overlay.combineTokens==null?s.baseCur+" "+s.overlayCur:s.overlayCur},indent:e.indent&&function(n,s){return e.indent(n.base,s)},electricChars:e.electricChars,innerMode:function(n){return{state:n.base,mode:e}},blankLine:function(n){var s,a;return e.blankLine&&(s=e.blankLine(n.base)),t.blankLine&&(a=t.blankLine(n.overlay)),a==null?s:i&&s!=null?s+" "+a:a}}}});(function(c){typeof exports=="object"&&typeof module=="object"?c(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],c):c(CodeMirror)})(function(c){c.defineOption("placeholder","",function(a,d,p){var f=p&&p!=c.Init;if(d&&!f)a.on("blur",i),a.on("change",n),a.on("swapDoc",n),n(a);else if(!d&&f){a.off("blur",i),a.off("change",n),a.off("swapDoc",n),e(a);var _=a.getWrapperElement();_.className=_.className.replace(" CodeMirror-empty","")}d&&!a.hasFocus()&&i(a)});function e(a){a.state.placeholder&&(a.state.placeholder.parentNode.removeChild(a.state.placeholder),a.state.placeholder=null)}function t(a){e(a);var d=a.state.placeholder=document.createElement("pre");d.style.cssText="height: 0; overflow: visible",d.className="CodeMirror-placeholder";var p=a.getOption("placeholder");typeof p=="string"&&(p=document.createTextNode(p)),d.appendChild(p),a.display.lineSpace.insertBefore(d,a.display.lineSpace.firstChild)}function i(a){s(a)&&t(a)}function n(a){var d=a.getWrapperElement(),p=s(a);d.className=d.className.replace(" CodeMirror-empty","")+(p?" CodeMirror-empty":""),p?t(a):e(a)}function s(a){return a.lineCount()===1&&a.getLine(0)===""}});(function(c){typeof exports=="object"&&typeof module=="object"?c(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],c):c(CodeMirror)})(function(c){"use strict";c.runMode=function(e,t,i,n){var s=c.getMode(c.defaults,t),a=/MSIE \d/.test(navigator.userAgent),d=a&&(document.documentMode==null||document.documentMode<9);if(i.appendChild){var p=n&&n.tabSize||c.defaults.tabSize,f=i,_=0;f.innerHTML="",i=function(M,L){if(M==`
`){f.appendChild(document.createTextNode(d?"\r":M)),_=0;return}for(var V="",H=0;;){var O=M.indexOf("	",H);if(O==-1){V+=M.slice(H),_+=M.length-H;break}else{_+=O-H,V+=M.slice(H,O);var z=p-_%p;_+=z;for(var K=0;K<z;++K)V+=" ";H=O+1}}if(L){var q=f.appendChild(document.createElement("span"));q.className="cm-"+L.replace(/ +/g," cm-"),q.appendChild(document.createTextNode(V))}else f.appendChild(document.createTextNode(V))}}for(var b=c.splitLines(e),w=n&&n.state||c.startState(s),S=0,E=b.length;S<E;++S){S&&i(`
`);var k=new c.StringStream(b[S]);for(!k.string&&s.blankLine&&s.blankLine(w);!k.eol();){var R=s.token(k,w);i(k.current(),R,S,k.start,w),k.start=k.pos}}}});(function(c){typeof exports=="object"&&typeof module=="object"?c(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],c):c(CodeMirror)})(function(c){"use strict";c.defineMode("sass",function(e){function t(R){return new RegExp("^"+R.join("|"))}var i=["true","false","null","auto"],n=new RegExp("^"+i.join("|")),s=["\\(","\\)","=",">","<","==",">=","<=","\\+","-","\\!=","/","\\*","%","and","or","not",";","\\{","\\}",":"],a=t(s),d=/^::?[a-zA-Z_][\w\-]*/;function p(R,M){var L=R.peek();return L===")"?(R.next(),M.tokenizer=E,"operator"):L==="("?(R.next(),R.eatSpace(),"operator"):L==="'"||L==='"'?(M.tokenizer=_(R.next()),"string"):(M.tokenizer=_(")",!1),"string")}function f(R,M){return function(L,V){return L.sol()&&L.indentation()<=R?(V.tokenizer=E,E(L,V)):(M&&L.skipTo("*/")?(L.next(),L.next(),V.tokenizer=E):L.skipToEnd(),"comment")}}function _(R,M){M==null&&(M=!0);function L(V,H){var O=V.next(),z=V.peek(),K=V.string.charAt(V.pos-2),q=O!=="\\"&&z===R||O===R&&K!=="\\";return q?(O!==R&&M&&V.next(),H.tokenizer=E,"string"):O==="#"&&z==="{"?(H.tokenizer=b(L),V.next(),"operator"):"string"}return L}function b(R){return function(M,L){return M.peek()==="}"?(M.next(),L.tokenizer=R,"operator"):E(M,L)}}function w(R){if(R.indentCount==0){R.indentCount++;var M=R.scopes[0].offset,L=M+e.indentUnit;R.scopes.unshift({offset:L})}}function S(R){R.scopes.length!=1&&R.scopes.shift()}function E(R,M){var L=R.peek();if(R.match("/*"))return M.tokenizer=f(R.indentation(),!0),M.tokenizer(R,M);if(R.match("//"))return M.tokenizer=f(R.indentation(),!1),M.tokenizer(R,M);if(R.match("#{"))return M.tokenizer=b(E),"operator";if(L==='"'||L==="'")return R.next(),M.tokenizer=_(L),"string";if(M.cursorHalf){if(L==="#"&&(R.next(),R.match(/[0-9a-fA-F]{6}|[0-9a-fA-F]{3}/))||R.match(/^-?[0-9\.]+/))return R.peek()||(M.cursorHalf=0),"number";if(R.match(/^(px|em|in)\b/))return R.peek()||(M.cursorHalf=0),"unit";if(R.match(n))return R.peek()||(M.cursorHalf=0),"keyword";if(R.match(/^url/)&&R.peek()==="(")return M.tokenizer=p,R.peek()||(M.cursorHalf=0),"atom";if(L==="$")return R.next(),R.eatWhile(/[\w-]/),R.peek()||(M.cursorHalf=0),"variable-3";if(L==="!")return R.next(),R.peek()||(M.cursorHalf=0),R.match(/^[\w]+/)?"keyword":"operator";if(R.match(a))return R.peek()||(M.cursorHalf=0),"operator";if(R.eatWhile(/[\w-]/))return R.peek()||(M.cursorHalf=0),"attribute";if(!R.peek())return M.cursorHalf=0,null}else{if(L==="."){if(R.next(),R.match(/^[\w-]+/))return w(M),"atom";if(R.peek()==="#")return w(M),"atom"}if(L==="#"&&(R.next(),R.match(/^[\w-]+/)||R.peek()==="#"))return w(M),"atom";if(L==="$")return R.next(),R.eatWhile(/[\w-]/),"variable-2";if(R.match(/^-?[0-9\.]+/))return"number";if(R.match(/^(px|em|in)\b/))return"unit";if(R.match(n))return"keyword";if(R.match(/^url/)&&R.peek()==="(")return M.tokenizer=p,"atom";if(L==="="&&R.match(/^=[\w-]+/))return w(M),"meta";if(L==="+"&&R.match(/^\+[\w-]+/))return"variable-3";if(L==="@"&&R.match(/@extend/)&&(R.match(/\s*[\w]/)||S(M)),R.match(/^@(else if|if|media|else|for|each|while|mixin|function)/))return w(M),"meta";if(L==="@")return R.next(),R.eatWhile(/[\w-]/),"meta";if(R.eatWhile(/[\w-]/))return R.match(/ *: *[\w-\+\$#!\("']/,!1)?"property":R.match(/ *:/,!1)?(w(M),M.cursorHalf=1,"atom"):(R.match(/ *,/,!1)||w(M),"atom");if(L===":")return R.match(d)?"keyword":(R.next(),M.cursorHalf=1,"operator")}return R.match(a)?"operator":(R.next(),null)}function k(R,M){R.sol()&&(M.indentCount=0);var L=M.tokenizer(R,M),V=R.current();if((V==="@return"||V==="}")&&S(M),L!==null){for(var H=R.pos-V.length,O=H+e.indentUnit*M.indentCount,z=[],K=0;K<M.scopes.length;K++){var q=M.scopes[K];q.offset<=O&&z.push(q)}M.scopes=z}return L}return{startState:function(){return{tokenizer:E,scopes:[{offset:0,type:"sass"}],indentCount:0,cursorHalf:0,definedVars:[],definedMixins:[]}},token:function(R,M){var L=k(R,M);return M.lastToken={style:L,content:R.current()},L},indent:function(R){return R.scopes[0].offset}}}),c.defineMIME("text/x-sass","sass")});(function(c){typeof exports=="object"&&typeof module=="object"?c(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],c):c(CodeMirror)})(function(c){"use strict";var e=c.Pos;function t(n,s,a,d){if(this.atOccurrence=!1,this.doc=n,d==null&&typeof s=="string"&&(d=!1),a=a?n.clipPos(a):e(0,0),this.pos={from:a,to:a},typeof s!="string")s.global||(s=new RegExp(s.source,s.ignoreCase?"ig":"g")),this.matches=function(w,S){if(w){s.lastIndex=0;for(var E=n.getLine(S.line).slice(0,S.ch),k=0,R,M;;){s.lastIndex=k;var L=s.exec(E);if(!L||(R=L,M=R.index,k=R.index+(R[0].length||1),k==E.length))break}var V=R&&R[0].length||0;V||(M==0&&E.length==0?R=void 0:M!=n.getLine(S.line).length&&V++)}else{s.lastIndex=S.ch;var E=n.getLine(S.line),R=s.exec(E),V=R&&R[0].length||0,M=R&&R.index;M+V!=E.length&&!V&&(V=1)}if(R&&V)return{from:e(S.line,M),to:e(S.line,M+V),match:R}};else{var p=s;d&&(s=s.toLowerCase());var f=d?function(w){return w.toLowerCase()}:function(w){return w},_=s.split(`
`);if(_.length==1)s.length?this.matches=function(w,S){if(w){var E=n.getLine(S.line).slice(0,S.ch),k=f(E),R=k.lastIndexOf(s);if(R>-1)return R=i(E,k,R),{from:e(S.line,R),to:e(S.line,R+p.length)}}else{var E=n.getLine(S.line).slice(S.ch),k=f(E),R=k.indexOf(s);if(R>-1)return R=i(E,k,R)+S.ch,{from:e(S.line,R),to:e(S.line,R+p.length)}}}:this.matches=function(){};else{var b=p.split(`
`);this.matches=function(w,S){var E=_.length-1;if(w){if(S.line-(_.length-1)<n.firstLine()||f(n.getLine(S.line).slice(0,b[E].length))!=_[_.length-1])return;for(var k=e(S.line,b[E].length),R=S.line-1,M=E-1;M>=1;--M,--R)if(_[M]!=f(n.getLine(R)))return;var L=n.getLine(R),V=L.length-b[0].length;return f(L.slice(V))!=_[0]?void 0:{from:e(R,V),to:k}}else{if(S.line+(_.length-1)>n.lastLine())return;var L=n.getLine(S.line),V=L.length-b[0].length;if(f(L.slice(V))!=_[0])return;for(var H=e(S.line,V),R=S.line+1,M=1;M<E;++M,++R)if(_[M]!=f(n.getLine(R)))return;return f(n.getLine(R).slice(0,b[E].length))!=_[E]?void 0:{from:H,to:e(R,b[E].length)}}}}}}t.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(n){var s=this,a=this.doc.clipPos(n?this.pos.from:this.pos.to);function d(f){var _=e(f,0);return s.pos={from:_,to:_},s.atOccurrence=!1,!1}for(;;){if(this.pos=this.matches(n,a))return this.atOccurrence=!0,this.pos.match||!0;if(n){if(!a.line)return d(0);a=e(a.line-1,this.doc.getLine(a.line-1).length)}else{var p=this.doc.lineCount();if(a.line==p-1)return d(p);a=e(a.line+1,0)}}},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(n,s){if(!!this.atOccurrence){var a=c.splitLines(n);this.doc.replaceRange(a,this.pos.from,this.pos.to,s),this.pos.to=e(this.pos.from.line+a.length-1,a[a.length-1].length+(a.length==1?this.pos.from.ch:0))}}};function i(n,s,a){if(n.length==s.length)return a;for(var d=Math.min(a,n.length);;){var p=n.slice(0,d).toLowerCase().length;if(p<a)++d;else if(p>a)--d;else return d}}c.defineExtension("getSearchCursor",function(n,s,a){return new t(this.doc,n,s,a)}),c.defineDocExtension("getSearchCursor",function(n,s,a){return new t(this,n,s,a)}),c.defineExtension("selectMatches",function(n,s){for(var a=[],d=this.getSearchCursor(n,this.getCursor("from"),s);d.findNext()&&!(c.cmpPos(d.to(),this.getCursor("to"))>0);)a.push({anchor:d.from(),head:d.to()});a.length&&this.setSelections(a,0)})});(function(c){typeof exports=="object"&&typeof module=="object"?c(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],c):c(CodeMirror)})(function(c){"use strict";c.defineMode("sql",function(e,t){"use strict";var i=t.client||{},n=t.atoms||{false:!0,true:!0,null:!0},s=t.builtin||{},a=t.keywords||{},d=t.operatorChars||/^[*+\-%<>!=&|~^]/,p=t.support||{},f=t.hooks||{},_=t.dateSQL||{date:!0,time:!0,timestamp:!0};function b(R,M){var L=R.next();if(f[L]){var V=f[L](R,M);if(V!==!1)return V}if(p.hexNumber&&(L=="0"&&R.match(/^[xX][0-9a-fA-F]+/)||(L=="x"||L=="X")&&R.match(/^'[0-9a-fA-F]+'/)))return"number";if(p.binaryNumber&&((L=="b"||L=="B")&&R.match(/^'[01]+'/)||L=="0"&&R.match(/^b[01]+/)))return"number";if(L.charCodeAt(0)>47&&L.charCodeAt(0)<58)return R.match(/^[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?/),p.decimallessFloat&&R.eat("."),"number";if(L=="?"&&(R.eatSpace()||R.eol()||R.eat(";")))return"variable-3";if(L=="'"||L=='"'&&p.doubleQuote)return M.tokenize=w(L),M.tokenize(R,M);if((p.nCharCast&&(L=="n"||L=="N")||p.charsetCast&&L=="_"&&R.match(/[a-z][a-z0-9]*/i))&&(R.peek()=="'"||R.peek()=='"'))return"keyword";if(/^[\(\),\;\[\]]/.test(L))return null;if(p.commentSlashSlash&&L=="/"&&R.eat("/"))return R.skipToEnd(),"comment";if(p.commentHash&&L=="#"||L=="-"&&R.eat("-")&&(!p.commentSpaceRequired||R.eat(" ")))return R.skipToEnd(),"comment";if(L=="/"&&R.eat("*"))return M.tokenize=S,M.tokenize(R,M);if(L=="."){if(p.zerolessFloat&&R.match(/^(?:\d+(?:e[+-]?\d+)?)/i))return"number";if(p.ODBCdotTable&&R.match(/^[a-zA-Z_]+/))return"variable-2"}else{if(d.test(L))return R.eatWhile(d),null;if(L=="{"&&(R.match(/^( )*(d|D|t|T|ts|TS)( )*'[^']*'( )*}/)||R.match(/^( )*(d|D|t|T|ts|TS)( )*"[^"]*"( )*}/)))return"number";R.eatWhile(/^[_\w\d]/);var H=R.current().toLowerCase();return _.hasOwnProperty(H)&&(R.match(/^( )+'[^']*'/)||R.match(/^( )+"[^"]*"/))?"number":n.hasOwnProperty(H)?"atom":s.hasOwnProperty(H)?"builtin":a.hasOwnProperty(H)?"keyword":i.hasOwnProperty(H)?"string-2":null}}function w(R){return function(M,L){for(var V=!1,H;(H=M.next())!=null;){if(H==R&&!V){L.tokenize=b;break}V=!V&&H=="\\"}return"string"}}function S(R,M){for(;;)if(R.skipTo("*")){if(R.next(),R.eat("/")){M.tokenize=b;break}}else{R.skipToEnd();break}return"comment"}function E(R,M,L){M.context={prev:M.context,indent:R.indentation(),col:R.column(),type:L}}function k(R){R.indent=R.context.indent,R.context=R.context.prev}return{startState:function(){return{tokenize:b,context:null}},token:function(R,M){if(R.sol()&&M.context&&M.context.align==null&&(M.context.align=!1),R.eatSpace())return null;var L=M.tokenize(R,M);if(L=="comment")return L;M.context&&M.context.align==null&&(M.context.align=!0);var V=R.current();return V=="("?E(R,M,")"):V=="["?E(R,M,"]"):M.context&&M.context.type==V&&k(M),L},indent:function(R,M){var L=R.context;if(!L)return c.Pass;var V=M.charAt(0)==L.type;return L.align?L.col+(V?0:1):L.indent+(V?0:e.indentUnit)},blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:p.commentSlashSlash?"//":p.commentHash?"#":null}}),function(){"use strict";function e(a){for(var d;(d=a.next())!=null;)if(d=="`"&&!a.eat("`"))return"variable-2";return a.backUp(a.current().length-1),a.eatWhile(/\w/)?"variable-2":null}function t(a){return a.eat("@")&&(a.match(/^session\./),a.match(/^local\./),a.match(/^global\./)),a.eat("'")?(a.match(/^.*'/),"variable-2"):a.eat('"')?(a.match(/^.*"/),"variable-2"):a.eat("`")?(a.match(/^.*`/),"variable-2"):a.match(/^[0-9a-zA-Z$\.\_]+/)?"variable-2":null}function i(a){return a.eat("N")?"atom":a.match(/^[a-zA-Z.#!?]/)?"variable-2":null}var n="alter and as asc between by count create delete desc distinct drop from group having in insert into is join like not on or order select set table union update values where limit ";function s(a){for(var d={},p=a.split(" "),f=0;f<p.length;++f)d[p[f]]=!0;return d}c.defineMIME("text/x-sql",{name:"sql",keywords:s(n+"begin"),builtin:s("bool boolean bit blob enum long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision real date datetime year unsigned signed decimal numeric"),atoms:s("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:s("date time timestamp"),support:s("ODBCdotTable doubleQuote binaryNumber hexNumber")}),c.defineMIME("text/x-mssql",{name:"sql",client:s("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:s(n+"begin trigger proc view index for add constraint key primary foreign collate clustered nonclustered declare exec"),builtin:s("bigint numeric bit smallint decimal smallmoney int tinyint money float real char varchar text nchar nvarchar ntext binary varbinary image cursor timestamp hierarchyid uniqueidentifier sql_variant xml table "),atoms:s("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:s("date datetimeoffset datetime2 smalldatetime datetime time"),hooks:{"@":t}}),c.defineMIME("text/x-mysql",{name:"sql",client:s("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:s(n+"accessible action add after algorithm all analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general get global grant grants group group_concat handler hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show signal slave slow smallint snapshot soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),builtin:s("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),atoms:s("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^]/,dateSQL:s("date time timestamp"),support:s("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),hooks:{"@":t,"`":e,"\\":i}}),c.defineMIME("text/x-mariadb",{name:"sql",client:s("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:s(n+"accessible action add after algorithm all always analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general generated get global grant grants group groupby_concat handler hard hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password persistent phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show shutdown signal slave slow smallint snapshot soft soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views virtual warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),builtin:s("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),atoms:s("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^]/,dateSQL:s("date time timestamp"),support:s("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),hooks:{"@":t,"`":e,"\\":i}}),c.defineMIME("text/x-cassandra",{name:"sql",client:{},keywords:s("add all allow alter and any apply as asc authorize batch begin by clustering columnfamily compact consistency count create custom delete desc distinct drop each_quorum exists filtering from grant if in index insert into key keyspace keyspaces level limit local_one local_quorum modify nan norecursive nosuperuser not of on one order password permission permissions primary quorum rename revoke schema select set storage superuser table three to token truncate ttl two type unlogged update use user users using values where with writetime"),builtin:s("ascii bigint blob boolean counter decimal double float frozen inet int list map static text timestamp timeuuid tuple uuid varchar varint"),atoms:s("false true infinity NaN"),operatorChars:/^[<>=]/,dateSQL:{},support:s("commentSlashSlash decimallessFloat"),hooks:{}}),c.defineMIME("text/x-plsql",{name:"sql",client:s("appinfo arraysize autocommit autoprint autorecovery autotrace blockterminator break btitle cmdsep colsep compatibility compute concat copycommit copytypecheck define describe echo editfile embedded escape exec execute feedback flagger flush heading headsep instance linesize lno loboffset logsource long longchunksize markup native newpage numformat numwidth pagesize pause pno recsep recsepchar release repfooter repheader serveroutput shiftinout show showmode size spool sqlblanklines sqlcase sqlcode sqlcontinue sqlnumber sqlpluscompatibility sqlprefix sqlprompt sqlterminator suffix tab term termout time timing trimout trimspool ttitle underline verify version wrap"),keywords:s("abort accept access add all alter and any array arraylen as asc assert assign at attributes audit authorization avg base_table begin between binary_integer body boolean by case cast char char_base check close cluster clusters colauth column comment commit compress connect connected constant constraint crash create current currval cursor data_base database date dba deallocate debugoff debugon decimal declare default definition delay delete desc digits dispose distinct do drop else elseif elsif enable end entry escape exception exception_init exchange exclusive exists exit external fast fetch file for force form from function generic goto grant group having identified if immediate in increment index indexes indicator initial initrans insert interface intersect into is key level library like limited local lock log logging long loop master maxextents maxtrans member minextents minus mislabel mode modify multiset new next no noaudit nocompress nologging noparallel not nowait number_base object of off offline on online only open option or order out package parallel partition pctfree pctincrease pctused pls_integer positive positiven pragma primary prior private privileges procedure public raise range raw read rebuild record ref references refresh release rename replace resource restrict return returning returns reverse revoke rollback row rowid rowlabel rownum rows run savepoint schema segment select separate session set share snapshot some space split sql start statement storage subtype successful synonym tabauth table tables tablespace task terminate then to trigger truncate type union unique unlimited unrecoverable unusable update use using validate value values variable view views when whenever where while with work"),builtin:s("abs acos add_months ascii asin atan atan2 average bfile bfilename bigserial bit blob ceil character chartorowid chr clob concat convert cos cosh count dec decode deref dual dump dup_val_on_index empty error exp false float floor found glb greatest hextoraw initcap instr instrb int integer isopen last_day least length lengthb ln lower lpad ltrim lub make_ref max min mlslabel mod months_between natural naturaln nchar nclob new_time next_day nextval nls_charset_decl_len nls_charset_id nls_charset_name nls_initcap nls_lower nls_sort nls_upper nlssort no_data_found notfound null number numeric nvarchar2 nvl others power rawtohex real reftohex round rowcount rowidtochar rowtype rpad rtrim serial sign signtype sin sinh smallint soundex sqlcode sqlerrm sqrt stddev string substr substrb sum sysdate tan tanh to_char text to_date to_label to_multi_byte to_number to_single_byte translate true trunc uid unlogged upper user userenv varchar varchar2 variance varying vsize xml"),operatorChars:/^[*+\-%<>!=~]/,dateSQL:s("date time timestamp"),support:s("doubleQuote nCharCast zerolessFloat binaryNumber hexNumber")}),c.defineMIME("text/x-hive",{name:"sql",keywords:s("select alter $elem$ $key$ $value$ add after all analyze and archive as asc before between binary both bucket buckets by cascade case cast change cluster clustered clusterstatus collection column columns comment compute concatenate continue create cross cursor data database databases dbproperties deferred delete delimited desc describe directory disable distinct distribute drop else enable end escaped exclusive exists explain export extended external false fetch fields fileformat first format formatted from full function functions grant group having hold_ddltime idxproperties if import in index indexes inpath inputdriver inputformat insert intersect into is items join keys lateral left like limit lines load local location lock locks mapjoin materialized minus msck no_drop nocompress not of offline on option or order out outer outputdriver outputformat overwrite partition partitioned partitions percent plus preserve procedure purge range rcfile read readonly reads rebuild recordreader recordwriter recover reduce regexp rename repair replace restrict revoke right rlike row schema schemas semi sequencefile serde serdeproperties set shared show show_database sort sorted ssl statistics stored streamtable table tables tablesample tblproperties temporary terminated textfile then tmp to touch transform trigger true unarchive undo union uniquejoin unlock update use using utc utc_tmestamp view when where while with"),builtin:s("bool boolean long timestamp tinyint smallint bigint int float double date datetime unsigned string array struct map uniontype"),atoms:s("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:s("date timestamp"),support:s("ODBCdotTable doubleQuote binaryNumber hexNumber")}),c.defineMIME("text/x-pgsql",{name:"sql",client:s("source"),keywords:s(n+"a abort abs absent absolute access according action ada add admin after aggregate all allocate also always analyse analyze any are array array_agg array_max_cardinality asensitive assertion assignment asymmetric at atomic attribute attributes authorization avg backward base64 before begin begin_frame begin_partition bernoulli binary bit_length blob blocked bom both breadth c cache call called cardinality cascade cascaded case cast catalog catalog_name ceil ceiling chain characteristics characters character_length character_set_catalog character_set_name character_set_schema char_length check checkpoint class class_origin clob close cluster coalesce cobol collate collation collation_catalog collation_name collation_schema collect column columns column_name command_function command_function_code comment comments commit committed concurrently condition condition_number configuration conflict connect connection connection_name constraint constraints constraint_catalog constraint_name constraint_schema constructor contains content continue control conversion convert copy corr corresponding cost covar_pop covar_samp cross csv cube cume_dist current current_catalog current_date current_default_transform_group current_path current_role current_row current_schema current_time current_timestamp current_transform_group_for_type current_user cursor cursor_name cycle data database datalink datetime_interval_code datetime_interval_precision day db deallocate dec declare default defaults deferrable deferred defined definer degree delimiter delimiters dense_rank depth deref derived describe descriptor deterministic diagnostics dictionary disable discard disconnect dispatch dlnewcopy dlpreviouscopy dlurlcomplete dlurlcompleteonly dlurlcompletewrite dlurlpath dlurlpathonly dlurlpathwrite dlurlscheme dlurlserver dlvalue do document domain dynamic dynamic_function dynamic_function_code each element else empty enable encoding encrypted end end-exec end_frame end_partition enforced enum equals escape event every except exception exclude excluding exclusive exec execute exists exp explain expression extension external extract false family fetch file filter final first first_value flag float floor following for force foreign fortran forward found frame_row free freeze fs full function functions fusion g general generated get global go goto grant granted greatest grouping groups handler header hex hierarchy hold hour id identity if ignore ilike immediate immediately immutable implementation implicit import including increment indent index indexes indicator inherit inherits initially inline inner inout input insensitive instance instantiable instead integrity intersect intersection invoker isnull isolation k key key_member key_type label lag language large last last_value lateral lead leading leakproof least left length level library like_regex link listen ln load local localtime localtimestamp location locator lock locked logged lower m map mapping match matched materialized max maxvalue max_cardinality member merge message_length message_octet_length message_text method min minute minvalue mod mode modifies module month more move multiset mumps name names namespace national natural nchar nclob nesting new next nfc nfd nfkc nfkd nil no none normalize normalized nothing notify notnull nowait nth_value ntile null nullable nullif nulls number object occurrences_regex octets octet_length of off offset oids old only open operator option options ordering ordinality others out outer output over overlaps overlay overriding owned owner p pad parameter parameter_mode parameter_name parameter_ordinal_position parameter_specific_catalog parameter_specific_name parameter_specific_schema parser partial partition pascal passing passthrough password percent percentile_cont percentile_disc percent_rank period permission placing plans pli policy portion position position_regex power precedes preceding prepare prepared preserve primary prior privileges procedural procedure program public quote range rank read reads reassign recheck recovery recursive ref references referencing refresh regr_avgx regr_avgy regr_count regr_intercept regr_r2 regr_slope regr_sxx regr_sxy regr_syy reindex relative release rename repeatable replace replica requiring reset respect restart restore restrict result return returned_cardinality returned_length returned_octet_length returned_sqlstate returning returns revoke right role rollback rollup routine routine_catalog routine_name routine_schema row rows row_count row_number rule savepoint scale schema schema_name scope scope_catalog scope_name scope_schema scroll search second section security selective self sensitive sequence sequences serializable server server_name session session_user setof sets share show similar simple size skip snapshot some source space specific specifictype specific_name sql sqlcode sqlerror sqlexception sqlstate sqlwarning sqrt stable standalone start state statement static statistics stddev_pop stddev_samp stdin stdout storage strict strip structure style subclass_origin submultiset substring substring_regex succeeds sum symmetric sysid system system_time system_user t tables tablesample tablespace table_name temp template temporary then ties timezone_hour timezone_minute to token top_level_count trailing transaction transactions_committed transactions_rolled_back transaction_active transform transforms translate translate_regex translation treat trigger trigger_catalog trigger_name trigger_schema trim trim_array true truncate trusted type types uescape unbounded uncommitted under unencrypted unique unknown unlink unlisten unlogged unnamed unnest until untyped upper uri usage user user_defined_type_catalog user_defined_type_code user_defined_type_name user_defined_type_schema using vacuum valid validate validator value value_of varbinary variadic var_pop var_samp verbose version versioning view views volatile when whenever whitespace width_bucket window within work wrapper write xmlagg xmlattributes xmlbinary xmlcast xmlcomment xmlconcat xmldeclaration xmldocument xmlelement xmlexists xmlforest xmliterate xmlnamespaces xmlparse xmlpi xmlquery xmlroot xmlschema xmlserialize xmltable xmltext xmlvalidate year yes loop repeat"),builtin:s("bigint int8 bigserial serial8 bit varying varbit boolean bool box bytea character char varchar cidr circle date double precision float8 inet integer int int4 interval json jsonb line lseg macaddr money numeric decimal path pg_lsn point polygon real float4 smallint int2 smallserial serial2 serial serial4 text time without zone with timetz timestamp timestamptz tsquery tsvector txid_snapshot uuid xml"),atoms:s("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^\/#@?~]/,dateSQL:s("date time timestamp"),support:s("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber nCharCast charsetCast")}),c.defineMIME("text/x-gql",{name:"sql",keywords:s("ancestor and asc by contains desc descendant distinct from group has in is limit offset on order select superset where"),atoms:s("false true"),builtin:s("blob datetime first key __key__ string integer double boolean null"),operatorChars:/^[*+\-%<>!=]/})}()});(function(c){typeof exports=="object"&&typeof module=="object"?c(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/edit/matchbrackets")):typeof define=="function"&&define.amd?define(["../lib/codemirror","../addon/search/searchcursor","../addon/edit/matchbrackets"],c):c(CodeMirror)})(function(c){"use strict";var e=c.keyMap.sublime={fallthrough:"default"},t=c.commands,i=c.Pos,n=c.keyMap.default==c.keyMap.macDefault,s=n?"Cmd-":"Ctrl-";function a(O,z,K){if(K<0&&z.ch==0)return O.clipPos(i(z.line-1));var q=O.getLine(z.line);if(K>0&&z.ch>=q.length)return O.clipPos(i(z.line+1,0));for(var Y="start",se,ce=z.ch,le=K<0?0:q.length,te=0;ce!=le;ce+=K,te++){var ve=q.charAt(K<0?ce-1:ce),Pe=ve!="_"&&c.isWordChar(ve)?"w":"o";if(Pe=="w"&&ve.toUpperCase()==ve&&(Pe="W"),Y=="start")Pe!="o"&&(Y="in",se=Pe);else if(Y=="in"&&se!=Pe){if(se=="w"&&Pe=="W"&&K<0&&ce--,se=="W"&&Pe=="w"&&K>0){se="w";continue}break}}return i(z.line,ce)}function d(O,z){O.extendSelectionsBy(function(K){return O.display.shift||O.doc.extend||K.empty()?a(O.doc,K.head,z):z<0?K.from():K.to()})}var p=n?"Ctrl-":"Alt-";t[e[p+"Left"]="goSubwordLeft"]=function(O){d(O,-1)},t[e[p+"Right"]="goSubwordRight"]=function(O){d(O,1)},n&&(e["Cmd-Left"]="goLineStartSmart");var f=n?"Ctrl-Alt-":"Ctrl-";t[e[f+"Up"]="scrollLineUp"]=function(O){var z=O.getScrollInfo();if(!O.somethingSelected()){var K=O.lineAtHeight(z.top+z.clientHeight,"local");O.getCursor().line>=K&&O.execCommand("goLineUp")}O.scrollTo(null,z.top-O.defaultTextHeight())},t[e[f+"Down"]="scrollLineDown"]=function(O){var z=O.getScrollInfo();if(!O.somethingSelected()){var K=O.lineAtHeight(z.top,"local")+1;O.getCursor().line<=K&&O.execCommand("goLineDown")}O.scrollTo(null,z.top+O.defaultTextHeight())},t[e["Shift-"+s+"L"]="splitSelectionByLine"]=function(O){for(var z=O.listSelections(),K=[],q=0;q<z.length;q++)for(var Y=z[q].from(),se=z[q].to(),ce=Y.line;ce<=se.line;++ce)se.line>Y.line&&ce==se.line&&se.ch==0||K.push({anchor:ce==Y.line?Y:i(ce,0),head:ce==se.line?se:i(ce)});O.setSelections(K,0)},e["Shift-Tab"]="indentLess",t[e.Esc="singleSelectionTop"]=function(O){var z=O.listSelections()[0];O.setSelection(z.anchor,z.head,{scroll:!1})},t[e[s+"L"]="selectLine"]=function(O){for(var z=O.listSelections(),K=[],q=0;q<z.length;q++){var Y=z[q];K.push({anchor:i(Y.from().line,0),head:i(Y.to().line+1,0)})}O.setSelections(K)},e["Shift-Ctrl-K"]="deleteLine";function _(O,z){if(O.isReadOnly())return c.Pass;O.operation(function(){for(var K=O.listSelections().length,q=[],Y=-1,se=0;se<K;se++){var ce=O.listSelections()[se].head;if(!(ce.line<=Y)){var le=i(ce.line+(z?0:1),0);O.replaceRange(`
`,le,null,"+insertLine"),O.indentLine(le.line,null,!0),q.push({head:le,anchor:le}),Y=ce.line+1}}O.setSelections(q)}),O.execCommand("indentAuto")}t[e[s+"Enter"]="insertLineAfter"]=function(O){return _(O,!1)},t[e["Shift-"+s+"Enter"]="insertLineBefore"]=function(O){return _(O,!0)};function b(O,z){for(var K=z.ch,q=K,Y=O.getLine(z.line);K&&c.isWordChar(Y.charAt(K-1));)--K;for(;q<Y.length&&c.isWordChar(Y.charAt(q));)++q;return{from:i(z.line,K),to:i(z.line,q),word:Y.slice(K,q)}}t[e[s+"D"]="selectNextOccurrence"]=function(O){var z=O.getCursor("from"),K=O.getCursor("to"),q=O.state.sublimeFindFullWord==O.doc.sel;if(c.cmpPos(z,K)==0){var Y=b(O,z);if(!Y.word)return;O.setSelection(Y.from,Y.to),q=!0}else{var se=O.getRange(z,K),ce=q?new RegExp("\\b"+se+"\\b"):se,le=O.getSearchCursor(ce,K);le.findNext()?O.addSelection(le.from(),le.to()):(le=O.getSearchCursor(ce,i(O.firstLine(),0)),le.findNext()&&O.addSelection(le.from(),le.to()))}q&&(O.state.sublimeFindFullWord=O.doc.sel)};var w="(){}[]";function S(O){for(var z=O.listSelections(),K=[],q=0;q<z.length;q++){var Y=z[q],se=Y.head,ce=O.scanForBracket(se,-1);if(!ce)return!1;for(;;){var le=O.scanForBracket(se,1);if(!le)return!1;if(le.ch==w.charAt(w.indexOf(ce.ch)+1)){K.push({anchor:i(ce.pos.line,ce.pos.ch+1),head:le.pos});break}se=i(le.pos.line,le.pos.ch+1)}}return O.setSelections(K),!0}t[e["Shift-"+s+"Space"]="selectScope"]=function(O){S(O)||O.execCommand("selectAll")},t[e["Shift-"+s+"M"]="selectBetweenBrackets"]=function(O){if(!S(O))return c.Pass},t[e[s+"M"]="goToBracket"]=function(O){O.extendSelectionsBy(function(z){var K=O.scanForBracket(z.head,1);if(K&&c.cmpPos(K.pos,z.head)!=0)return K.pos;var q=O.scanForBracket(z.head,-1);return q&&i(q.pos.line,q.pos.ch+1)||z.head})};var E=n?"Cmd-Ctrl-":"Shift-Ctrl-";t[e[E+"Up"]="swapLineUp"]=function(O){if(O.isReadOnly())return c.Pass;for(var z=O.listSelections(),K=[],q=O.firstLine()-1,Y=[],se=0;se<z.length;se++){var ce=z[se],le=ce.from().line-1,te=ce.to().line;Y.push({anchor:i(ce.anchor.line-1,ce.anchor.ch),head:i(ce.head.line-1,ce.head.ch)}),ce.to().ch==0&&!ce.empty()&&--te,le>q?K.push(le,te):K.length&&(K[K.length-1]=te),q=te}O.operation(function(){for(var ve=0;ve<K.length;ve+=2){var Pe=K[ve],Be=K[ve+1],qe=O.getLine(Pe);O.replaceRange("",i(Pe,0),i(Pe+1,0),"+swapLine"),Be>O.lastLine()?O.replaceRange(`
`+qe,i(O.lastLine()),null,"+swapLine"):O.replaceRange(qe+`
`,i(Be,0),null,"+swapLine")}O.setSelections(Y),O.scrollIntoView()})},t[e[E+"Down"]="swapLineDown"]=function(O){if(O.isReadOnly())return c.Pass;for(var z=O.listSelections(),K=[],q=O.lastLine()+1,Y=z.length-1;Y>=0;Y--){var se=z[Y],ce=se.to().line+1,le=se.from().line;se.to().ch==0&&!se.empty()&&ce--,ce<q?K.push(ce,le):K.length&&(K[K.length-1]=le),q=le}O.operation(function(){for(var te=K.length-2;te>=0;te-=2){var ve=K[te],Pe=K[te+1],Be=O.getLine(ve);ve==O.lastLine()?O.replaceRange("",i(ve-1),i(ve),"+swapLine"):O.replaceRange("",i(ve,0),i(ve+1,0),"+swapLine"),O.replaceRange(Be+`
`,i(Pe,0),null,"+swapLine")}O.scrollIntoView()})},t[e[s+"/"]="toggleCommentIndented"]=function(O){O.toggleComment({indent:!0})},t[e[s+"J"]="joinLines"]=function(O){for(var z=O.listSelections(),K=[],q=0;q<z.length;q++){for(var Y=z[q],se=Y.from(),ce=se.line,le=Y.to().line;q<z.length-1&&z[q+1].from().line==le;)le=z[++q].to().line;K.push({start:ce,end:le,anchor:!Y.empty()&&se})}O.operation(function(){for(var te=0,ve=[],Pe=0;Pe<K.length;Pe++){for(var Be=K[Pe],qe=Be.anchor&&i(Be.anchor.line-te,Be.anchor.ch),Ue,Ge=Be.start;Ge<=Be.end;Ge++){var it=Ge-te;Ge==Be.end&&(Ue=i(it,O.getLine(it).length+1)),it<O.lastLine()&&(O.replaceRange(" ",i(it),i(it+1,/^\s*/.exec(O.getLine(it+1))[0].length)),++te)}ve.push({anchor:qe||Ue,head:Ue})}O.setSelections(ve,0)})},t[e["Shift-"+s+"D"]="duplicateLine"]=function(O){O.operation(function(){for(var z=O.listSelections().length,K=0;K<z;K++){var q=O.listSelections()[K];q.empty()?O.replaceRange(O.getLine(q.head.line)+`
`,i(q.head.line,0)):O.replaceRange(O.getRange(q.from(),q.to()),q.from())}O.scrollIntoView()})},n||(e[s+"T"]="transposeChars");function k(O,z){if(O.isReadOnly())return c.Pass;for(var K=O.listSelections(),q=[],Y,se=0;se<K.length;se++){var ce=K[se];if(!ce.empty()){for(var le=ce.from().line,te=ce.to().line;se<K.length-1&&K[se+1].from().line==te;)te=ce[++se].to().line;q.push(le,te)}}q.length?Y=!0:q.push(O.firstLine(),O.lastLine()),O.operation(function(){for(var ve=[],Pe=0;Pe<q.length;Pe+=2){var Be=q[Pe],qe=q[Pe+1],Ue=i(Be,0),Ge=i(qe),it=O.getRange(Ue,Ge,!1);z?it.sort():it.sort(function(lt,bt){var Yt=lt.toUpperCase(),ni=bt.toUpperCase();return Yt!=ni&&(lt=Yt,bt=ni),lt<bt?-1:lt==bt?0:1}),O.replaceRange(it,Ue,Ge),Y&&ve.push({anchor:Ue,head:Ge})}Y&&O.setSelections(ve,0)})}t[e.F9="sortLines"]=function(O){k(O,!0)},t[e[s+"F9"]="sortLinesInsensitive"]=function(O){k(O,!1)},t[e.F2="nextBookmark"]=function(O){var z=O.state.sublimeBookmarks;if(z)for(;z.length;){var K=z.shift(),q=K.find();if(q)return z.push(K),O.setSelection(q.from,q.to)}},t[e["Shift-F2"]="prevBookmark"]=function(O){var z=O.state.sublimeBookmarks;if(z)for(;z.length;){z.unshift(z.pop());var K=z[z.length-1].find();if(!K)z.pop();else return O.setSelection(K.from,K.to)}},t[e[s+"F2"]="toggleBookmark"]=function(O){for(var z=O.listSelections(),K=O.state.sublimeBookmarks||(O.state.sublimeBookmarks=[]),q=0;q<z.length;q++){for(var Y=z[q].from(),se=z[q].to(),ce=O.findMarks(Y,se),le=0;le<ce.length;le++)if(ce[le].sublimeBookmark){ce[le].clear();for(var te=0;te<K.length;te++)K[te]==ce[le]&&K.splice(te--,1);break}le==ce.length&&K.push(O.markText(Y,se,{sublimeBookmark:!0,clearWhenEmpty:!1}))}},t[e["Shift-"+s+"F2"]="clearBookmarks"]=function(O){var z=O.state.sublimeBookmarks;if(z)for(var K=0;K<z.length;K++)z[K].clear();z.length=0},t[e["Alt-F2"]="selectBookmarks"]=function(O){var z=O.state.sublimeBookmarks,K=[];if(z)for(var q=0;q<z.length;q++){var Y=z[q].find();Y?K.push({anchor:Y.from,head:Y.to}):z.splice(q--,0)}K.length&&O.setSelections(K,0)},e["Alt-Q"]="wrapLines";var R=s+"K ";function M(O,z){O.operation(function(){for(var K=O.listSelections(),q=[],Y=[],se=0;se<K.length;se++){var ce=K[se];ce.empty()?(q.push(se),Y.push("")):Y.push(z(O.getRange(ce.from(),ce.to())))}O.replaceSelections(Y,"around","case");for(var se=q.length-1,le;se>=0;se--){var ce=K[q[se]];if(!(le&&c.cmpPos(ce.head,le)>0)){var te=b(O,ce.head);le=te.from,O.replaceRange(z(te.word),te.from,te.to)}}})}e[R+s+"Backspace"]="delLineLeft",t[e.Backspace="smartBackspace"]=function(O){if(O.somethingSelected())return c.Pass;O.operation(function(){for(var z=O.listSelections(),K=O.getOption("indentUnit"),q=z.length-1;q>=0;q--){var Y=z[q].head,se=O.getRange({line:Y.line,ch:0},Y),ce=c.countColumn(se,null,O.getOption("tabSize")),le=O.findPosH(Y,-1,"char",!1);if(se&&!/\S/.test(se)&&ce%K==0){var te=new i(Y.line,c.findColumn(se,ce-K,K));te.ch!=Y.ch&&(le=te)}O.replaceRange("",le,Y,"+delete")}})},t[e[R+s+"K"]="delLineRight"]=function(O){O.operation(function(){for(var z=O.listSelections(),K=z.length-1;K>=0;K--)O.replaceRange("",z[K].anchor,i(z[K].to().line),"+delete");O.scrollIntoView()})},t[e[R+s+"U"]="upcaseAtCursor"]=function(O){M(O,function(z){return z.toUpperCase()})},t[e[R+s+"L"]="downcaseAtCursor"]=function(O){M(O,function(z){return z.toLowerCase()})},t[e[R+s+"Space"]="setSublimeMark"]=function(O){O.state.sublimeMark&&O.state.sublimeMark.clear(),O.state.sublimeMark=O.setBookmark(O.getCursor())},t[e[R+s+"A"]="selectToSublimeMark"]=function(O){var z=O.state.sublimeMark&&O.state.sublimeMark.find();z&&O.setSelection(O.getCursor(),z)},t[e[R+s+"W"]="deleteToSublimeMark"]=function(O){var z=O.state.sublimeMark&&O.state.sublimeMark.find();if(z){var K=O.getCursor(),q=z;if(c.cmpPos(K,q)>0){var Y=q;q=K,K=Y}O.state.sublimeKilled=O.getRange(K,q),O.replaceRange("",K,q)}},t[e[R+s+"X"]="swapWithSublimeMark"]=function(O){var z=O.state.sublimeMark&&O.state.sublimeMark.find();z&&(O.state.sublimeMark.clear(),O.state.sublimeMark=O.setBookmark(O.getCursor()),O.setCursor(z))},t[e[R+s+"Y"]="sublimeYank"]=function(O){O.state.sublimeKilled!=null&&O.replaceSelection(O.state.sublimeKilled,null,"paste")},e[R+s+"G"]="clearBookmarks",t[e[R+s+"C"]="showInCenter"]=function(O){var z=O.cursorCoords(null,"local");O.scrollTo(null,(z.top+z.bottom)/2-O.getScrollInfo().clientHeight/2)};var L=n?"Ctrl-Shift-":"Ctrl-Alt-";t[e[L+"Up"]="selectLinesUpward"]=function(O){O.operation(function(){for(var z=O.listSelections(),K=0;K<z.length;K++){var q=z[K];q.head.line>O.firstLine()&&O.addSelection(i(q.head.line-1,q.head.ch))}})},t[e[L+"Down"]="selectLinesDownward"]=function(O){O.operation(function(){for(var z=O.listSelections(),K=0;K<z.length;K++){var q=z[K];q.head.line<O.lastLine()&&O.addSelection(i(q.head.line+1,q.head.ch))}})};function V(O){var z=O.getCursor("from"),K=O.getCursor("to");if(c.cmpPos(z,K)==0){var q=b(O,z);if(!q.word)return;z=q.from,K=q.to}return{from:z,to:K,query:O.getRange(z,K),word:q}}function H(O,z){var K=V(O);if(!!K){var q=K.query,Y=O.getSearchCursor(q,z?K.to:K.from);(z?Y.findNext():Y.findPrevious())?O.setSelection(Y.from(),Y.to()):(Y=O.getSearchCursor(q,z?i(O.firstLine(),0):O.clipPos(i(O.lastLine()))),(z?Y.findNext():Y.findPrevious())?O.setSelection(Y.from(),Y.to()):K.word&&O.setSelection(K.from,K.to))}}t[e[s+"F3"]="findUnder"]=function(O){H(O,!0)},t[e["Shift-"+s+"F3"]="findUnderPrevious"]=function(O){H(O,!1)},t[e["Alt-F3"]="findAllUnder"]=function(O){var z=V(O);if(!!z){for(var K=O.getSearchCursor(z.query),q=[],Y=-1;K.findNext();)q.push({anchor:K.from(),head:K.to()}),K.from().line<=z.from.line&&K.from().ch<=z.from.ch&&Y++;O.setSelections(q,Y)}},e["Shift-"+s+"["]="fold",e["Shift-"+s+"]"]="unfold",e[R+s+"0"]=e[R+s+"J"]="unfoldAll",e[s+"I"]="findIncremental",e["Shift-"+s+"I"]="findIncrementalReverse",e[s+"H"]="replace",e.F3="findNext",e["Shift-F3"]="findPrev",c.normalizeKeyMap(e)});(function(c){typeof exports=="object"&&typeof module=="object"?c(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],c):c(CodeMirror)})(function(c){"use strict";var e={autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0},t={autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,caseFold:!1};c.defineMode("xml",function(i,n){var s=i.indentUnit,a={},d=n.htmlMode?e:t;for(var p in d)a[p]=d[p];for(var p in n)a[p]=n[p];var f,_;function b(le,te){function ve(qe){return te.tokenize=qe,qe(le,te)}var Pe=le.next();if(Pe=="<")return le.eat("!")?le.eat("[")?le.match("CDATA[")?ve(E("atom","]]>")):null:le.match("--")?ve(E("comment","-->")):le.match("DOCTYPE",!0,!0)?(le.eatWhile(/[\w\._\-]/),ve(k(1))):null:le.eat("?")?(le.eatWhile(/[\w\._\-]/),te.tokenize=E("meta","?>"),"meta"):(f=le.eat("/")?"closeTag":"openTag",te.tokenize=w,"tag bracket");if(Pe=="&"){var Be;return le.eat("#")?le.eat("x")?Be=le.eatWhile(/[a-fA-F\d]/)&&le.eat(";"):Be=le.eatWhile(/[\d]/)&&le.eat(";"):Be=le.eatWhile(/[\w\.\-:]/)&&le.eat(";"),Be?"atom":"error"}else return le.eatWhile(/[^&<]/),null}b.isInText=!0;function w(le,te){var ve=le.next();if(ve==">"||ve=="/"&&le.eat(">"))return te.tokenize=b,f=ve==">"?"endTag":"selfcloseTag","tag bracket";if(ve=="=")return f="equals",null;if(ve=="<"){te.tokenize=b,te.state=V,te.tagName=te.tagStart=null;var Pe=te.tokenize(le,te);return Pe?Pe+" tag error":"tag error"}else return/[\'\"]/.test(ve)?(te.tokenize=S(ve),te.stringStartCol=le.column(),te.tokenize(le,te)):(le.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/),"word")}function S(le){var te=function(ve,Pe){for(;!ve.eol();)if(ve.next()==le){Pe.tokenize=w;break}return"string"};return te.isInAttribute=!0,te}function E(le,te){return function(ve,Pe){for(;!ve.eol();){if(ve.match(te)){Pe.tokenize=b;break}ve.next()}return le}}function k(le){return function(te,ve){for(var Pe;(Pe=te.next())!=null;){if(Pe=="<")return ve.tokenize=k(le+1),ve.tokenize(te,ve);if(Pe==">")if(le==1){ve.tokenize=b;break}else return ve.tokenize=k(le-1),ve.tokenize(te,ve)}return"meta"}}function R(le,te,ve){this.prev=le.context,this.tagName=te,this.indent=le.indented,this.startOfLine=ve,(a.doNotIndent.hasOwnProperty(te)||le.context&&le.context.noIndent)&&(this.noIndent=!0)}function M(le){le.context&&(le.context=le.context.prev)}function L(le,te){for(var ve;;){if(!le.context||(ve=le.context.tagName,!a.contextGrabbers.hasOwnProperty(ve)||!a.contextGrabbers[ve].hasOwnProperty(te)))return;M(le)}}function V(le,te,ve){return le=="openTag"?(ve.tagStart=te.column(),H):le=="closeTag"?O:V}function H(le,te,ve){return le=="word"?(ve.tagName=te.current(),_="tag",q):(_="error",H)}function O(le,te,ve){if(le=="word"){var Pe=te.current();return ve.context&&ve.context.tagName!=Pe&&a.implicitlyClosed.hasOwnProperty(ve.context.tagName)&&M(ve),ve.context&&ve.context.tagName==Pe||a.matchClosing===!1?(_="tag",z):(_="tag error",K)}else return _="error",K}function z(le,te,ve){return le!="endTag"?(_="error",z):(M(ve),V)}function K(le,te,ve){return _="error",z(le,te,ve)}function q(le,te,ve){if(le=="word")return _="attribute",Y;if(le=="endTag"||le=="selfcloseTag"){var Pe=ve.tagName,Be=ve.tagStart;return ve.tagName=ve.tagStart=null,le=="selfcloseTag"||a.autoSelfClosers.hasOwnProperty(Pe)?L(ve,Pe):(L(ve,Pe),ve.context=new R(ve,Pe,Be==ve.indented)),V}return _="error",q}function Y(le,te,ve){return le=="equals"?se:(a.allowMissing||(_="error"),q(le,te,ve))}function se(le,te,ve){return le=="string"?ce:le=="word"&&a.allowUnquoted?(_="string",q):(_="error",q(le,te,ve))}function ce(le,te,ve){return le=="string"?ce:q(le,te,ve)}return{startState:function(le){var te={tokenize:b,state:V,indented:le||0,tagName:null,tagStart:null,context:null};return le!=null&&(te.baseIndent=le),te},token:function(le,te){if(!te.tagName&&le.sol()&&(te.indented=le.indentation()),le.eatSpace())return null;f=null;var ve=te.tokenize(le,te);return(ve||f)&&ve!="comment"&&(_=null,te.state=te.state(f||ve,le,te),_&&(ve=_=="error"?ve+" error":_)),ve},indent:function(le,te,ve){var Pe=le.context;if(le.tokenize.isInAttribute)return le.tagStart==le.indented?le.stringStartCol+1:le.indented+s;if(Pe&&Pe.noIndent)return c.Pass;if(le.tokenize!=w&&le.tokenize!=b)return ve?ve.match(/^(\s*)/)[0].length:0;if(le.tagName)return a.multilineTagIndentPastTag!==!1?le.tagStart+le.tagName.length+2:le.tagStart+s*(a.multilineTagIndentFactor||1);if(a.alignCDATA&&/<!\[CDATA\[/.test(te))return 0;var Be=te&&/^<(\/)?([\w_:\.-]*)/.exec(te);if(Be&&Be[1])for(;Pe;)if(Pe.tagName==Be[2]){Pe=Pe.prev;break}else if(a.implicitlyClosed.hasOwnProperty(Pe.tagName))Pe=Pe.prev;else break;else if(Be)for(;Pe;){var qe=a.contextGrabbers[Pe.tagName];if(qe&&qe.hasOwnProperty(Be[2]))Pe=Pe.prev;else break}for(;Pe&&Pe.prev&&!Pe.startOfLine;)Pe=Pe.prev;return Pe?Pe.indent+s:le.baseIndent||0},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"<!--",blockCommentEnd:"-->",configuration:a.htmlMode?"html":"xml",helperType:a.htmlMode?"html":"xml",skipAttribute:function(le){le.state==se&&(le.state=q)}}}),c.defineMIME("text/xml","xml"),c.defineMIME("application/xml","xml"),c.mimeModes.hasOwnProperty("text/html")||c.defineMIME("text/html",{name:"xml",htmlMode:!0})});(function(e,t){typeof exports=="object"&&typeof module=="object"?module.exports=t():typeof define=="function"&&define.amd?define([],t):typeof exports=="object"?exports.esprima=t():e.esprima=t()})(this,function(){return function(c){var e={};function t(i){if(e[i])return e[i].exports;var n=e[i]={exports:{},id:i,loaded:!1};return c[i].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}return t.m=c,t.c=e,t.p="",t(0)}([function(c,e,t){"use strict";var i=t(1),n=t(3),s=t(8),a=t(15);function d(w,S,E){var k=null,R=function(q,Y){E&&E(q,Y),k&&k.visit(q,Y)},M=typeof E=="function"?R:null,L=!1;if(S){L=typeof S.comment=="boolean"&&S.comment;var V=typeof S.attachComment=="boolean"&&S.attachComment;(L||V)&&(k=new i.CommentHandler,k.attach=V,S.comment=!0,M=R)}var H=!1;S&&typeof S.sourceType=="string"&&(H=S.sourceType==="module");var O;S&&typeof S.jsx=="boolean"&&S.jsx?O=new n.JSXParser(w,S,M):O=new s.Parser(w,S,M);var z=H?O.parseModule():O.parseScript(),K=z;return L&&k&&(K.comments=k.comments),O.config.tokens&&(K.tokens=O.tokens),O.config.tolerant&&(K.errors=O.errorHandler.errors),K}e.parse=d;function p(w,S,E){var k=S||{};return k.sourceType="module",d(w,k,E)}e.parseModule=p;function f(w,S,E){var k=S||{};return k.sourceType="script",d(w,k,E)}e.parseScript=f;function _(w,S,E){var k=new a.Tokenizer(w,S),R;R=[];try{for(;;){var M=k.getNextToken();if(!M)break;E&&(M=E(M)),R.push(M)}}catch(L){k.errorHandler.tolerate(L)}return k.errorHandler.tolerant&&(R.errors=k.errors()),R}e.tokenize=_;var b=t(2);e.Syntax=b.Syntax,e.version="4.0.0-dev"},function(c,e,t){"use strict";var i=t(2),n=function(){function s(){this.attach=!1,this.comments=[],this.stack=[],this.leading=[],this.trailing=[]}return s.prototype.insertInnerComments=function(a,d){if(a.type===i.Syntax.BlockStatement&&a.body.length===0){for(var p=[],f=this.leading.length-1;f>=0;--f){var _=this.leading[f];d.end.offset>=_.start&&(p.unshift(_.comment),this.leading.splice(f,1),this.trailing.splice(f,1))}p.length&&(a.innerComments=p)}},s.prototype.findTrailingComments=function(a){var d=[];if(this.trailing.length>0){for(var p=this.trailing.length-1;p>=0;--p){var f=this.trailing[p];f.start>=a.end.offset&&d.unshift(f.comment)}return this.trailing.length=0,d}var _=this.stack[this.stack.length-1];if(_&&_.node.trailingComments){var b=_.node.trailingComments[0];b&&b.range[0]>=a.end.offset&&(d=_.node.trailingComments,delete _.node.trailingComments)}return d},s.prototype.findLeadingComments=function(a){for(var d=[],p;this.stack.length>0;){var f=this.stack[this.stack.length-1];if(f&&f.start>=a.start.offset)p=f.node,this.stack.pop();else break}if(p){for(var _=p.leadingComments?p.leadingComments.length:0,b=_-1;b>=0;--b){var w=p.leadingComments[b];w.range[1]<=a.start.offset&&(d.unshift(w),p.leadingComments.splice(b,1))}return p.leadingComments&&p.leadingComments.length===0&&delete p.leadingComments,d}for(var b=this.leading.length-1;b>=0;--b){var f=this.leading[b];f.start<=a.start.offset&&(d.unshift(f.comment),this.leading.splice(b,1))}return d},s.prototype.visitNode=function(a,d){if(!(a.type===i.Syntax.Program&&a.body.length>0)){this.insertInnerComments(a,d);var p=this.findTrailingComments(d),f=this.findLeadingComments(d);f.length>0&&(a.leadingComments=f),p.length>0&&(a.trailingComments=p),this.stack.push({node:a,start:d.start.offset})}},s.prototype.visitComment=function(a,d){var p=a.type[0]==="L"?"Line":"Block",f={type:p,value:a.value};if(a.range&&(f.range=a.range),a.loc&&(f.loc=a.loc),this.comments.push(f),this.attach){var _={comment:{type:p,value:a.value,range:[d.start.offset,d.end.offset]},start:d.start.offset};a.loc&&(_.comment.loc=a.loc),a.type=p,this.leading.push(_),this.trailing.push(_)}},s.prototype.visit=function(a,d){a.type==="LineComment"?this.visitComment(a,d):a.type==="BlockComment"?this.visitComment(a,d):this.attach&&this.visitNode(a,d)},s}();e.CommentHandler=n},function(c,e){"use strict";e.Syntax={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForOfStatement:"ForOfStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Import:"Import",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Program:"Program",Property:"Property",RestElement:"RestElement",RestProperty:"RestProperty",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",SpreadProperty:"SpreadProperty",Super:"Super",SwitchCase:"SwitchCase",SwitchStatement:"SwitchStatement",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"}},function(c,e,t){"use strict";var i=this&&this.__extends||function(S,E){for(var k in E)E.hasOwnProperty(k)&&(S[k]=E[k]);function R(){this.constructor=S}S.prototype=E===null?Object.create(E):(R.prototype=E.prototype,new R)},n=t(4),s=t(5),a=t(6),d=t(7),p=t(8),f=t(13),_=t(14);f.TokenName[100]="JSXIdentifier",f.TokenName[101]="JSXText";function b(S){var E;switch(S.type){case a.JSXSyntax.JSXIdentifier:var k=S;E=k.name;break;case a.JSXSyntax.JSXNamespacedName:var R=S;E=b(R.namespace)+":"+b(R.name);break;case a.JSXSyntax.JSXMemberExpression:var M=S;E=b(M.object)+"."+b(M.property);break;default:break}return E}var w=function(S){i(E,S);function E(k,R,M){return S.call(this,k,R,M)||this}return E.prototype.parsePrimaryExpression=function(){return this.match("<")?this.parseJSXRoot():S.prototype.parsePrimaryExpression.call(this)},E.prototype.startJSX=function(){this.scanner.index=this.startMarker.index,this.scanner.lineNumber=this.startMarker.line,this.scanner.lineStart=this.startMarker.index-this.startMarker.column},E.prototype.finishJSX=function(){this.nextToken()},E.prototype.reenterJSX=function(){this.startJSX(),this.expectJSX("}"),this.config.tokens&&this.tokens.pop()},E.prototype.createJSXNode=function(){return this.collectComments(),{index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}},E.prototype.createJSXChildNode=function(){return{index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}},E.prototype.scanXHTMLEntity=function(k){for(var R="&",M=!0,L=!1,V=!1,H=!1;!this.scanner.eof()&&M&&!L;){var O=this.scanner.source[this.scanner.index];if(O===k)break;if(L=O===";",R+=O,++this.scanner.index,!L)switch(R.length){case 2:V=O==="#";break;case 3:V&&(H=O==="x",M=H||n.Character.isDecimalDigit(O.charCodeAt(0)),V=V&&!H);break;default:M=M&&!(V&&!n.Character.isDecimalDigit(O.charCodeAt(0))),M=M&&!(H&&!n.Character.isHexDigit(O.charCodeAt(0)));break}}if(M&&L&&R.length>2){var z=R.substr(1,R.length-2);V&&z.length>1?R=String.fromCharCode(parseInt(z.substr(1),10)):H&&z.length>2?R=String.fromCharCode(parseInt("0"+z.substr(1),16)):!V&&!H&&_.XHTMLEntities[z]&&(R=_.XHTMLEntities[z])}return R},E.prototype.lexJSX=function(){var k=this.scanner.source.charCodeAt(this.scanner.index);if(k===60||k===62||k===47||k===58||k===61||k===123||k===125){var R=this.scanner.source[this.scanner.index++];return{type:7,value:R,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:this.scanner.index-1,end:this.scanner.index}}if(k===34||k===39){for(var M=this.scanner.index,L=this.scanner.source[this.scanner.index++],V="";!this.scanner.eof();){var H=this.scanner.source[this.scanner.index++];if(H===L)break;H==="&"?V+=this.scanXHTMLEntity(L):V+=H}return{type:8,value:V,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:M,end:this.scanner.index}}if(k===46){var O=this.scanner.source.charCodeAt(this.scanner.index+1),z=this.scanner.source.charCodeAt(this.scanner.index+2),R=O===46&&z===46?"...":".",M=this.scanner.index;return this.scanner.index+=R.length,{type:7,value:R,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:M,end:this.scanner.index}}if(k===96)return{type:10,value:"",lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:this.scanner.index,end:this.scanner.index};if(n.Character.isIdentifierStart(k)&&k!==92){var M=this.scanner.index;for(++this.scanner.index;!this.scanner.eof();){var H=this.scanner.source.charCodeAt(this.scanner.index);if(n.Character.isIdentifierPart(H)&&H!==92)++this.scanner.index;else if(H===45)++this.scanner.index;else break}var K=this.scanner.source.slice(M,this.scanner.index);return{type:100,value:K,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:M,end:this.scanner.index}}return this.scanner.throwUnexpectedToken()},E.prototype.nextJSXToken=function(){this.collectComments(),this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart;var k=this.lexJSX();return this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.config.tokens&&this.tokens.push(this.convertToken(k)),k},E.prototype.nextJSXText=function(){this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart;for(var k=this.scanner.index,R="";!this.scanner.eof();){var M=this.scanner.source[this.scanner.index];if(M==="{"||M==="<")break;++this.scanner.index,R+=M,n.Character.isLineTerminator(M.charCodeAt(0))&&(++this.scanner.lineNumber,M==="\r"&&this.scanner.source[this.scanner.index]===`
`&&++this.scanner.index,this.scanner.lineStart=this.scanner.index)}this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart;var L={type:101,value:R,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:k,end:this.scanner.index};return R.length>0&&this.config.tokens&&this.tokens.push(this.convertToken(L)),L},E.prototype.peekJSXToken=function(){var k=this.scanner.saveState();this.scanner.scanComments();var R=this.lexJSX();return this.scanner.restoreState(k),R},E.prototype.expectJSX=function(k){var R=this.nextJSXToken();(R.type!==7||R.value!==k)&&this.throwUnexpectedToken(R)},E.prototype.matchJSX=function(k){var R=this.peekJSXToken();return R.type===7&&R.value===k},E.prototype.parseJSXIdentifier=function(){var k=this.createJSXNode(),R=this.nextJSXToken();return R.type!==100&&this.throwUnexpectedToken(R),this.finalize(k,new s.JSXIdentifier(R.value))},E.prototype.parseJSXElementName=function(){var k=this.createJSXNode(),R=this.parseJSXIdentifier();if(this.matchJSX(":")){var M=R;this.expectJSX(":");var L=this.parseJSXIdentifier();R=this.finalize(k,new s.JSXNamespacedName(M,L))}else if(this.matchJSX("."))for(;this.matchJSX(".");){var V=R;this.expectJSX(".");var H=this.parseJSXIdentifier();R=this.finalize(k,new s.JSXMemberExpression(V,H))}return R},E.prototype.parseJSXAttributeName=function(){var k=this.createJSXNode(),R,M=this.parseJSXIdentifier();if(this.matchJSX(":")){var L=M;this.expectJSX(":");var V=this.parseJSXIdentifier();R=this.finalize(k,new s.JSXNamespacedName(L,V))}else R=M;return R},E.prototype.parseJSXStringLiteralAttribute=function(){var k=this.createJSXNode(),R=this.nextJSXToken();R.type!==8&&this.throwUnexpectedToken(R);var M=this.getTokenRaw(R);return this.finalize(k,new d.Literal(R.value,M))},E.prototype.parseJSXExpressionAttribute=function(){var k=this.createJSXNode();this.expectJSX("{"),this.finishJSX(),this.match("}")&&this.tolerateError("JSX attributes must only be assigned a non-empty expression");var R=this.parseAssignmentExpression();return this.reenterJSX(),this.finalize(k,new s.JSXExpressionContainer(R))},E.prototype.parseJSXAttributeValue=function(){return this.matchJSX("{")?this.parseJSXExpressionAttribute():this.matchJSX("<")?this.parseJSXElement():this.parseJSXStringLiteralAttribute()},E.prototype.parseJSXNameValueAttribute=function(){var k=this.createJSXNode(),R=this.parseJSXAttributeName(),M=null;return this.matchJSX("=")&&(this.expectJSX("="),M=this.parseJSXAttributeValue()),this.finalize(k,new s.JSXAttribute(R,M))},E.prototype.parseJSXSpreadAttribute=function(){var k=this.createJSXNode();this.expectJSX("{"),this.expectJSX("..."),this.finishJSX();var R=this.parseAssignmentExpression();return this.reenterJSX(),this.finalize(k,new s.JSXSpreadAttribute(R))},E.prototype.parseJSXAttributes=function(){for(var k=[];!this.matchJSX("/")&&!this.matchJSX(">");){var R=this.matchJSX("{")?this.parseJSXSpreadAttribute():this.parseJSXNameValueAttribute();k.push(R)}return k},E.prototype.parseJSXOpeningElement=function(){var k=this.createJSXNode();this.expectJSX("<");var R=this.parseJSXElementName(),M=this.parseJSXAttributes(),L=this.matchJSX("/");return L&&this.expectJSX("/"),this.expectJSX(">"),this.finalize(k,new s.JSXOpeningElement(R,L,M))},E.prototype.parseJSXBoundaryElement=function(){var k=this.createJSXNode();if(this.expectJSX("<"),this.matchJSX("/")){this.expectJSX("/");var R=this.parseJSXElementName();return this.expectJSX(">"),this.finalize(k,new s.JSXClosingElement(R))}var M=this.parseJSXElementName(),L=this.parseJSXAttributes(),V=this.matchJSX("/");return V&&this.expectJSX("/"),this.expectJSX(">"),this.finalize(k,new s.JSXOpeningElement(M,V,L))},E.prototype.parseJSXEmptyExpression=function(){var k=this.createJSXChildNode();return this.collectComments(),this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.finalize(k,new s.JSXEmptyExpression)},E.prototype.parseJSXExpressionContainer=function(){var k=this.createJSXNode();this.expectJSX("{");var R;return this.matchJSX("}")?(R=this.parseJSXEmptyExpression(),this.expectJSX("}")):(this.finishJSX(),R=this.parseAssignmentExpression(),this.reenterJSX()),this.finalize(k,new s.JSXExpressionContainer(R))},E.prototype.parseJSXChildren=function(){for(var k=[];!this.scanner.eof();){var R=this.createJSXChildNode(),M=this.nextJSXText();if(M.start<M.end){var L=this.getTokenRaw(M),V=this.finalize(R,new s.JSXText(M.value,L));k.push(V)}if(this.scanner.source[this.scanner.index]==="{"){var H=this.parseJSXExpressionContainer();k.push(H)}else break}return k},E.prototype.parseComplexJSXElement=function(k){for(var R=[];!this.scanner.eof();){k.children=k.children.concat(this.parseJSXChildren());var M=this.createJSXChildNode(),L=this.parseJSXBoundaryElement();if(L.type===a.JSXSyntax.JSXOpeningElement){var V=L;if(V.selfClosing){var H=this.finalize(M,new s.JSXElement(V,[],null));k.children.push(H)}else R.push(k),k={node:M,opening:V,closing:null,children:[]}}if(L.type===a.JSXSyntax.JSXClosingElement){k.closing=L;var O=b(k.opening.name),z=b(k.closing.name);if(O!==z&&this.tolerateError("Expected corresponding JSX closing tag for %0",O),R.length>0){var H=this.finalize(k.node,new s.JSXElement(k.opening,k.children,k.closing));k=R[R.length-1],k.children.push(H),R.pop()}else break}}return k},E.prototype.parseJSXElement=function(){var k=this.createJSXNode(),R=this.parseJSXOpeningElement(),M=[],L=null;if(!R.selfClosing){var V=this.parseComplexJSXElement({node:k,opening:R,closing:L,children:M});M=V.children,L=V.closing}return this.finalize(k,new s.JSXElement(R,M,L))},E.prototype.parseJSXRoot=function(){this.config.tokens&&this.tokens.pop(),this.startJSX();var k=this.parseJSXElement();return this.finishJSX(),k},E}(p.Parser);e.JSXParser=w},function(c,e){"use strict";var t={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFC-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C4\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/};e.Character={fromCodePoint:function(i){return i<65536?String.fromCharCode(i):String.fromCharCode(55296+(i-65536>>10))+String.fromCharCode(56320+(i-65536&1023))},isWhiteSpace:function(i){return i===32||i===9||i===11||i===12||i===160||i>=5760&&[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(i)>=0},isLineTerminator:function(i){return i===10||i===13||i===8232||i===8233},isIdentifierStart:function(i){return i===36||i===95||i>=65&&i<=90||i>=97&&i<=122||i===92||i>=128&&t.NonAsciiIdentifierStart.test(e.Character.fromCodePoint(i))},isIdentifierPart:function(i){return i===36||i===95||i>=65&&i<=90||i>=97&&i<=122||i>=48&&i<=57||i===92||i>=128&&t.NonAsciiIdentifierPart.test(e.Character.fromCodePoint(i))},isDecimalDigit:function(i){return i>=48&&i<=57},isHexDigit:function(i){return i>=48&&i<=57||i>=65&&i<=70||i>=97&&i<=102},isOctalDigit:function(i){return i>=48&&i<=55}}},function(c,e,t){"use strict";var i=t(6),n=function(){function k(R){this.type=i.JSXSyntax.JSXClosingElement,this.name=R}return k}();e.JSXClosingElement=n;var s=function(){function k(R,M,L){this.type=i.JSXSyntax.JSXElement,this.openingElement=R,this.children=M,this.closingElement=L}return k}();e.JSXElement=s;var a=function(){function k(){this.type=i.JSXSyntax.JSXEmptyExpression}return k}();e.JSXEmptyExpression=a;var d=function(){function k(R){this.type=i.JSXSyntax.JSXExpressionContainer,this.expression=R}return k}();e.JSXExpressionContainer=d;var p=function(){function k(R){this.type=i.JSXSyntax.JSXIdentifier,this.name=R}return k}();e.JSXIdentifier=p;var f=function(){function k(R,M){this.type=i.JSXSyntax.JSXMemberExpression,this.object=R,this.property=M}return k}();e.JSXMemberExpression=f;var _=function(){function k(R,M){this.type=i.JSXSyntax.JSXAttribute,this.name=R,this.value=M}return k}();e.JSXAttribute=_;var b=function(){function k(R,M){this.type=i.JSXSyntax.JSXNamespacedName,this.namespace=R,this.name=M}return k}();e.JSXNamespacedName=b;var w=function(){function k(R,M,L){this.type=i.JSXSyntax.JSXOpeningElement,this.name=R,this.selfClosing=M,this.attributes=L}return k}();e.JSXOpeningElement=w;var S=function(){function k(R){this.type=i.JSXSyntax.JSXSpreadAttribute,this.argument=R}return k}();e.JSXSpreadAttribute=S;var E=function(){function k(R,M){this.type=i.JSXSyntax.JSXText,this.value=R,this.raw=M}return k}();e.JSXText=E},function(c,e){"use strict";e.JSXSyntax={JSXAttribute:"JSXAttribute",JSXClosingElement:"JSXClosingElement",JSXElement:"JSXElement",JSXEmptyExpression:"JSXEmptyExpression",JSXExpressionContainer:"JSXExpressionContainer",JSXIdentifier:"JSXIdentifier",JSXMemberExpression:"JSXMemberExpression",JSXNamespacedName:"JSXNamespacedName",JSXOpeningElement:"JSXOpeningElement",JSXSpreadAttribute:"JSXSpreadAttribute",JSXText:"JSXText"}},function(c,e,t){"use strict";var i=t(2),n=function(){function Le(Ne){this.type=i.Syntax.ArrayExpression,this.elements=Ne}return Le}();e.ArrayExpression=n;var s=function(){function Le(Ne){this.type=i.Syntax.ArrayPattern,this.elements=Ne}return Le}();e.ArrayPattern=s;var a=function(){function Le(Ne,et,Gt){this.type=i.Syntax.ArrowFunctionExpression,this.id=null,this.params=Ne,this.body=et,this.generator=!1,this.expression=Gt,this.async=!1}return Le}();e.ArrowFunctionExpression=a;var d=function(){function Le(Ne,et,Gt){this.type=i.Syntax.AssignmentExpression,this.operator=Ne,this.left=et,this.right=Gt}return Le}();e.AssignmentExpression=d;var p=function(){function Le(Ne,et){this.type=i.Syntax.AssignmentPattern,this.left=Ne,this.right=et}return Le}();e.AssignmentPattern=p;var f=function(){function Le(Ne,et,Gt){this.type=i.Syntax.ArrowFunctionExpression,this.id=null,this.params=Ne,this.body=et,this.generator=!1,this.expression=Gt,this.async=!0}return Le}();e.AsyncArrowFunctionExpression=f;var _=function(){function Le(Ne,et,Gt){this.type=i.Syntax.FunctionDeclaration,this.id=Ne,this.params=et,this.body=Gt,this.generator=!1,this.expression=!1,this.async=!0}return Le}();e.AsyncFunctionDeclaration=_;var b=function(){function Le(Ne,et,Gt){this.type=i.Syntax.FunctionExpression,this.id=Ne,this.params=et,this.body=Gt,this.generator=!1,this.expression=!1,this.async=!0}return Le}();e.AsyncFunctionExpression=b;var w=function(){function Le(Ne){this.type=i.Syntax.AwaitExpression,this.argument=Ne}return Le}();e.AwaitExpression=w;var S=function(){function Le(Ne,et,Gt){var Wi=Ne==="||"||Ne==="&&";this.type=Wi?i.Syntax.LogicalExpression:i.Syntax.BinaryExpression,this.operator=Ne,this.left=et,this.right=Gt}return Le}();e.BinaryExpression=S;var E=function(){function Le(Ne){this.type=i.Syntax.BlockStatement,this.body=Ne}return Le}();e.BlockStatement=E;var k=function(){function Le(Ne){this.type=i.Syntax.BreakStatement,this.label=Ne}return Le}();e.BreakStatement=k;var R=function(){function Le(Ne,et){this.type=i.Syntax.CallExpression,this.callee=Ne,this.arguments=et}return Le}();e.CallExpression=R;var M=function(){function Le(Ne,et){this.type=i.Syntax.CatchClause,this.param=Ne,this.body=et}return Le}();e.CatchClause=M;var L=function(){function Le(Ne){this.type=i.Syntax.ClassBody,this.body=Ne}return Le}();e.ClassBody=L;var V=function(){function Le(Ne,et,Gt){this.type=i.Syntax.ClassDeclaration,this.id=Ne,this.superClass=et,this.body=Gt}return Le}();e.ClassDeclaration=V;var H=function(){function Le(Ne,et,Gt){this.type=i.Syntax.ClassExpression,this.id=Ne,this.superClass=et,this.body=Gt}return Le}();e.ClassExpression=H;var O=function(){function Le(Ne,et){this.type=i.Syntax.MemberExpression,this.computed=!0,this.object=Ne,this.property=et}return Le}();e.ComputedMemberExpression=O;var z=function(){function Le(Ne,et,Gt){this.type=i.Syntax.ConditionalExpression,this.test=Ne,this.consequent=et,this.alternate=Gt}return Le}();e.ConditionalExpression=z;var K=function(){function Le(Ne){this.type=i.Syntax.ContinueStatement,this.label=Ne}return Le}();e.ContinueStatement=K;var q=function(){function Le(){this.type=i.Syntax.DebuggerStatement}return Le}();e.DebuggerStatement=q;var Y=function(){function Le(Ne,et){this.type=i.Syntax.ExpressionStatement,this.expression=Ne,this.directive=et}return Le}();e.Directive=Y;var se=function(){function Le(Ne,et){this.type=i.Syntax.DoWhileStatement,this.body=Ne,this.test=et}return Le}();e.DoWhileStatement=se;var ce=function(){function Le(){this.type=i.Syntax.EmptyStatement}return Le}();e.EmptyStatement=ce;var le=function(){function Le(Ne){this.type=i.Syntax.ExportAllDeclaration,this.source=Ne}return Le}();e.ExportAllDeclaration=le;var te=function(){function Le(Ne){this.type=i.Syntax.ExportDefaultDeclaration,this.declaration=Ne}return Le}();e.ExportDefaultDeclaration=te;var ve=function(){function Le(Ne,et,Gt){this.type=i.Syntax.ExportNamedDeclaration,this.declaration=Ne,this.specifiers=et,this.source=Gt}return Le}();e.ExportNamedDeclaration=ve;var Pe=function(){function Le(Ne,et){this.type=i.Syntax.ExportSpecifier,this.exported=et,this.local=Ne}return Le}();e.ExportSpecifier=Pe;var Be=function(){function Le(Ne){this.type=i.Syntax.ExpressionStatement,this.expression=Ne}return Le}();e.ExpressionStatement=Be;var qe=function(){function Le(Ne,et,Gt){this.type=i.Syntax.ForInStatement,this.left=Ne,this.right=et,this.body=Gt,this.each=!1}return Le}();e.ForInStatement=qe;var Ue=function(){function Le(Ne,et,Gt){this.type=i.Syntax.ForOfStatement,this.left=Ne,this.right=et,this.body=Gt}return Le}();e.ForOfStatement=Ue;var Ge=function(){function Le(Ne,et,Gt,Wi){this.type=i.Syntax.ForStatement,this.init=Ne,this.test=et,this.update=Gt,this.body=Wi}return Le}();e.ForStatement=Ge;var it=function(){function Le(Ne,et,Gt,Wi){this.type=i.Syntax.FunctionDeclaration,this.id=Ne,this.params=et,this.body=Gt,this.generator=Wi,this.expression=!1,this.async=!1}return Le}();e.FunctionDeclaration=it;var lt=function(){function Le(Ne,et,Gt,Wi){this.type=i.Syntax.FunctionExpression,this.id=Ne,this.params=et,this.body=Gt,this.generator=Wi,this.expression=!1,this.async=!1}return Le}();e.FunctionExpression=lt;var bt=function(){function Le(Ne){this.type=i.Syntax.Identifier,this.name=Ne}return Le}();e.Identifier=bt;var Yt=function(){function Le(Ne,et,Gt){this.type=i.Syntax.IfStatement,this.test=Ne,this.consequent=et,this.alternate=Gt}return Le}();e.IfStatement=Yt;var ni=function(){function Le(){this.type=i.Syntax.Import}return Le}();e.Import=ni;var ri=function(){function Le(Ne,et){this.type=i.Syntax.ImportDeclaration,this.specifiers=Ne,this.source=et}return Le}();e.ImportDeclaration=ri;var He=function(){function Le(Ne){this.type=i.Syntax.ImportDefaultSpecifier,this.local=Ne}return Le}();e.ImportDefaultSpecifier=He;var ei=function(){function Le(Ne){this.type=i.Syntax.ImportNamespaceSpecifier,this.local=Ne}return Le}();e.ImportNamespaceSpecifier=ei;var ui=function(){function Le(Ne,et){this.type=i.Syntax.ImportSpecifier,this.local=Ne,this.imported=et}return Le}();e.ImportSpecifier=ui;var vi=function(){function Le(Ne,et){this.type=i.Syntax.LabeledStatement,this.label=Ne,this.body=et}return Le}();e.LabeledStatement=vi;var Xe=function(){function Le(Ne,et){this.type=i.Syntax.Literal,this.value=Ne,this.raw=et}return Le}();e.Literal=Xe;var bi=function(){function Le(Ne,et){this.type=i.Syntax.MetaProperty,this.meta=Ne,this.property=et}return Le}();e.MetaProperty=bi;var st=function(){function Le(Ne,et,Gt,Wi,Pr){this.type=i.Syntax.MethodDefinition,this.key=Ne,this.computed=et,this.value=Gt,this.kind=Wi,this.static=Pr}return Le}();e.MethodDefinition=st;var De=function(){function Le(Ne){this.type=i.Syntax.Program,this.body=Ne,this.sourceType="module"}return Le}();e.Module=De;var Me=function(){function Le(Ne,et){this.type=i.Syntax.NewExpression,this.callee=Ne,this.arguments=et}return Le}();e.NewExpression=Me;var Je=function(){function Le(Ne){this.type=i.Syntax.ObjectExpression,this.properties=Ne}return Le}();e.ObjectExpression=Je;var Ct=function(){function Le(Ne){this.type=i.Syntax.ObjectPattern,this.properties=Ne}return Le}();e.ObjectPattern=Ct;var $e=function(){function Le(Ne,et,Gt,Wi,Pr,is){this.type=i.Syntax.Property,this.key=et,this.computed=Gt,this.value=Wi,this.kind=Ne,this.method=Pr,this.shorthand=is}return Le}();e.Property=$e;var pe=function(){function Le(Ne,et,Gt,Wi){this.type=i.Syntax.Literal,this.value=Ne,this.raw=et,this.regex={pattern:Gt,flags:Wi}}return Le}();e.RegexLiteral=pe;var ee=function(){function Le(Ne){this.type=i.Syntax.RestElement,this.argument=Ne}return Le}();e.RestElement=ee;var Ce=function(){function Le(Ne){this.type=i.Syntax.RestProperty,this.argument=Ne}return Le}();e.RestProperty=Ce;var Lt=function(){function Le(Ne){this.type=i.Syntax.ReturnStatement,this.argument=Ne}return Le}();e.ReturnStatement=Lt;var tt=function(){function Le(Ne){this.type=i.Syntax.Program,this.body=Ne,this.sourceType="script"}return Le}();e.Script=tt;var yi=function(){function Le(Ne){this.type=i.Syntax.SequenceExpression,this.expressions=Ne}return Le}();e.SequenceExpression=yi;var sn=function(){function Le(Ne){this.type=i.Syntax.SpreadElement,this.argument=Ne}return Le}();e.SpreadElement=sn;var ki=function(){function Le(Ne){this.type=i.Syntax.SpreadProperty,this.argument=Ne}return Le}();e.SpreadProperty=ki;var ti=function(){function Le(Ne,et){this.type=i.Syntax.MemberExpression,this.computed=!1,this.object=Ne,this.property=et}return Le}();e.StaticMemberExpression=ti;var On=function(){function Le(){this.type=i.Syntax.Super}return Le}();e.Super=On;var er=function(){function Le(Ne,et){this.type=i.Syntax.SwitchCase,this.test=Ne,this.consequent=et}return Le}();e.SwitchCase=er;var cr=function(){function Le(Ne,et){this.type=i.Syntax.SwitchStatement,this.discriminant=Ne,this.cases=et}return Le}();e.SwitchStatement=cr;var Ye=function(){function Le(Ne,et){this.type=i.Syntax.TaggedTemplateExpression,this.tag=Ne,this.quasi=et}return Le}();e.TaggedTemplateExpression=Ye;var Rt=function(){function Le(Ne,et){this.type=i.Syntax.TemplateElement,this.value=Ne,this.tail=et}return Le}();e.TemplateElement=Rt;var xi=function(){function Le(Ne,et){this.type=i.Syntax.TemplateLiteral,this.quasis=Ne,this.expressions=et}return Le}();e.TemplateLiteral=xi;var Vn=function(){function Le(){this.type=i.Syntax.ThisExpression}return Le}();e.ThisExpression=Vn;var Hi=function(){function Le(Ne){this.type=i.Syntax.ThrowStatement,this.argument=Ne}return Le}();e.ThrowStatement=Hi;var Nr=function(){function Le(Ne,et,Gt){this.type=i.Syntax.TryStatement,this.block=Ne,this.handler=et,this.finalizer=Gt}return Le}();e.TryStatement=Nr;var Ft=function(){function Le(Ne,et){this.type=i.Syntax.UnaryExpression,this.operator=Ne,this.argument=et,this.prefix=!0}return Le}();e.UnaryExpression=Ft;var fn=function(){function Le(Ne,et,Gt){this.type=i.Syntax.UpdateExpression,this.operator=Ne,this.argument=et,this.prefix=Gt}return Le}();e.UpdateExpression=fn;var ts=function(){function Le(Ne,et){this.type=i.Syntax.VariableDeclaration,this.declarations=Ne,this.kind=et}return Le}();e.VariableDeclaration=ts;var wr=function(){function Le(Ne,et){this.type=i.Syntax.VariableDeclarator,this.id=Ne,this.init=et}return Le}();e.VariableDeclarator=wr;var gn=function(){function Le(Ne,et){this.type=i.Syntax.WhileStatement,this.test=Ne,this.body=et}return Le}();e.WhileStatement=gn;var Es=function(){function Le(Ne,et){this.type=i.Syntax.WithStatement,this.object=Ne,this.body=et}return Le}();e.WithStatement=Es;var Yn=function(){function Le(Ne,et){this.type=i.Syntax.YieldExpression,this.argument=Ne,this.delegate=et}return Le}();e.YieldExpression=Yn},function(c,e,t){"use strict";var i=t(9),n=t(10),s=t(11),a=t(7),d=t(12),p=t(2),f=t(13),_="ArrowParameterPlaceHolder",b=function(){function w(S,E,k){E===void 0&&(E={}),this.config={range:typeof E.range=="boolean"&&E.range,loc:typeof E.loc=="boolean"&&E.loc,source:null,tokens:typeof E.tokens=="boolean"&&E.tokens,comment:typeof E.comment=="boolean"&&E.comment,tolerant:typeof E.tolerant=="boolean"&&E.tolerant},this.config.loc&&E.source&&E.source!==null&&(this.config.source=String(E.source)),this.delegate=k,this.errorHandler=new n.ErrorHandler,this.errorHandler.tolerant=this.config.tolerant,this.scanner=new d.Scanner(S,this.errorHandler),this.scanner.trackComment=this.config.comment,this.operatorPrecedence={")":0,";":0,",":0,"=":0,"]":0,"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":11,"/":11,"%":11},this.lookahead={type:2,value:"",lineNumber:this.scanner.lineNumber,lineStart:0,start:0,end:0},this.hasLineTerminator=!1,this.context={isModule:!1,await:!1,allowIn:!0,allowStrictDirective:!0,allowYield:!0,firstCoverInitializedNameError:null,isAssignmentTarget:!1,isBindingElement:!1,inFunctionBody:!1,inIteration:!1,inSwitch:!1,labelSet:{},strict:!1},this.tokens=[],this.startMarker={index:0,line:this.scanner.lineNumber,column:0},this.lastMarker={index:0,line:this.scanner.lineNumber,column:0},this.nextToken(),this.lastMarker={index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}}return w.prototype.throwError=function(S){for(var E=[],k=1;k<arguments.length;k++)E[k-1]=arguments[k];var R=Array.prototype.slice.call(arguments,1),M=S.replace(/%(\d)/g,function(O,z){return i.assert(z<R.length,"Message reference must be in range"),R[z]}),L=this.lastMarker.index,V=this.lastMarker.line,H=this.lastMarker.column+1;throw this.errorHandler.createError(L,V,H,M)},w.prototype.tolerateError=function(S){for(var E=[],k=1;k<arguments.length;k++)E[k-1]=arguments[k];var R=Array.prototype.slice.call(arguments,1),M=S.replace(/%(\d)/g,function(O,z){return i.assert(z<R.length,"Message reference must be in range"),R[z]}),L=this.lastMarker.index,V=this.scanner.lineNumber,H=this.lastMarker.column+1;this.errorHandler.tolerateError(L,V,H,M)},w.prototype.unexpectedTokenError=function(S,E){var k=E||s.Messages.UnexpectedToken,R;if(S?(E||(k=S.type===2?s.Messages.UnexpectedEOS:S.type===3?s.Messages.UnexpectedIdentifier:S.type===6?s.Messages.UnexpectedNumber:S.type===8?s.Messages.UnexpectedString:S.type===10?s.Messages.UnexpectedTemplate:s.Messages.UnexpectedToken,S.type===4&&(this.scanner.isFutureReservedWord(S.value)?k=s.Messages.UnexpectedReserved:this.context.strict&&this.scanner.isStrictModeReservedWord(S.value)&&(k=s.Messages.StrictReservedWord))),R=S.value):R="ILLEGAL",k=k.replace("%0",R),S&&typeof S.lineNumber=="number"){var M=S.start,L=S.lineNumber,V=this.lastMarker.index-this.lastMarker.column,H=S.start-V+1;return this.errorHandler.createError(M,L,H,k)}else{var M=this.lastMarker.index,L=this.lastMarker.line,H=this.lastMarker.column+1;return this.errorHandler.createError(M,L,H,k)}},w.prototype.throwUnexpectedToken=function(S,E){throw this.unexpectedTokenError(S,E)},w.prototype.tolerateUnexpectedToken=function(S,E){this.errorHandler.tolerate(this.unexpectedTokenError(S,E))},w.prototype.collectComments=function(){if(!this.config.comment)this.scanner.scanComments();else{var S=this.scanner.scanComments();if(S.length>0&&this.delegate)for(var E=0;E<S.length;++E){var k=S[E],R=void 0;R={type:k.multiLine?"BlockComment":"LineComment",value:this.scanner.source.slice(k.slice[0],k.slice[1])},this.config.range&&(R.range=k.range),this.config.loc&&(R.loc=k.loc);var M={start:{line:k.loc.start.line,column:k.loc.start.column,offset:k.range[0]},end:{line:k.loc.end.line,column:k.loc.end.column,offset:k.range[1]}};this.delegate(R,M)}}},w.prototype.getTokenRaw=function(S){return this.scanner.source.slice(S.start,S.end)},w.prototype.convertToken=function(S){var E={type:f.TokenName[S.type],value:this.getTokenRaw(S)};if(this.config.range&&(E.range=[S.start,S.end]),this.config.loc&&(E.loc={start:{line:this.startMarker.line,column:this.startMarker.column},end:{line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}}),S.type===9){var k=S.pattern,R=S.flags;E.regex={pattern:k,flags:R}}return E},w.prototype.nextToken=function(){var S=this.lookahead;this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.collectComments(),this.scanner.index!==this.startMarker.index&&(this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart);var E=this.scanner.lex();return this.hasLineTerminator=S.lineNumber!==E.lineNumber,E&&this.context.strict&&E.type===3&&this.scanner.isStrictModeReservedWord(E.value)&&(E.type=4),this.lookahead=E,this.config.tokens&&E.type!==2&&this.tokens.push(this.convertToken(E)),S},w.prototype.nextRegexToken=function(){this.collectComments();var S=this.scanner.scanRegExp();return this.config.tokens&&(this.tokens.pop(),this.tokens.push(this.convertToken(S))),this.lookahead=S,this.nextToken(),S},w.prototype.createNode=function(){return{index:this.startMarker.index,line:this.startMarker.line,column:this.startMarker.column}},w.prototype.startNode=function(S){return{index:S.start,line:S.lineNumber,column:S.start-S.lineStart}},w.prototype.finalize=function(S,E){if(this.config.range&&(E.range=[S.index,this.lastMarker.index]),this.config.loc&&(E.loc={start:{line:S.line,column:S.column},end:{line:this.lastMarker.line,column:this.lastMarker.column}},this.config.source&&(E.loc.source=this.config.source)),this.delegate){var k={start:{line:S.line,column:S.column,offset:S.index},end:{line:this.lastMarker.line,column:this.lastMarker.column,offset:this.lastMarker.index}};this.delegate(E,k)}return E},w.prototype.expect=function(S){var E=this.nextToken();(E.type!==7||E.value!==S)&&this.throwUnexpectedToken(E)},w.prototype.expectCommaSeparator=function(){if(this.config.tolerant){var S=this.lookahead;S.type===7&&S.value===","?this.nextToken():S.type===7&&S.value===";"?(this.nextToken(),this.tolerateUnexpectedToken(S)):this.tolerateUnexpectedToken(S,s.Messages.UnexpectedToken)}else this.expect(",")},w.prototype.expectKeyword=function(S){var E=this.nextToken();(E.type!==4||E.value!==S)&&this.throwUnexpectedToken(E)},w.prototype.match=function(S){return this.lookahead.type===7&&this.lookahead.value===S},w.prototype.matchKeyword=function(S){return this.lookahead.type===4&&this.lookahead.value===S},w.prototype.matchContextualKeyword=function(S){return this.lookahead.type===3&&this.lookahead.value===S},w.prototype.matchAssign=function(){if(this.lookahead.type!==7)return!1;var S=this.lookahead.value;return S==="="||S==="*="||S==="**="||S==="/="||S==="%="||S==="+="||S==="-="||S==="<<="||S===">>="||S===">>>="||S==="&="||S==="^="||S==="|="},w.prototype.isolateCoverGrammar=function(S){var E=this.context.isBindingElement,k=this.context.isAssignmentTarget,R=this.context.firstCoverInitializedNameError;this.context.isBindingElement=!0,this.context.isAssignmentTarget=!0,this.context.firstCoverInitializedNameError=null;var M=S.call(this);return this.context.firstCoverInitializedNameError!==null&&this.throwUnexpectedToken(this.context.firstCoverInitializedNameError),this.context.isBindingElement=E,this.context.isAssignmentTarget=k,this.context.firstCoverInitializedNameError=R,M},w.prototype.inheritCoverGrammar=function(S){var E=this.context.isBindingElement,k=this.context.isAssignmentTarget,R=this.context.firstCoverInitializedNameError;this.context.isBindingElement=!0,this.context.isAssignmentTarget=!0,this.context.firstCoverInitializedNameError=null;var M=S.call(this);return this.context.isBindingElement=this.context.isBindingElement&&E,this.context.isAssignmentTarget=this.context.isAssignmentTarget&&k,this.context.firstCoverInitializedNameError=R||this.context.firstCoverInitializedNameError,M},w.prototype.consumeSemicolon=function(){this.match(";")?this.nextToken():this.hasLineTerminator||(this.lookahead.type!==2&&!this.match("}")&&this.throwUnexpectedToken(this.lookahead),this.lastMarker.index=this.startMarker.index,this.lastMarker.line=this.startMarker.line,this.lastMarker.column=this.startMarker.column)},w.prototype.parsePrimaryExpression=function(){var S=this.createNode(),E,k,R;switch(this.lookahead.type){case 3:(this.context.isModule||this.context.await)&&this.lookahead.value==="await"&&this.tolerateUnexpectedToken(this.lookahead),E=this.matchAsyncFunction()?this.parseFunctionExpression():this.finalize(S,new a.Identifier(this.nextToken().value));break;case 6:case 8:this.context.strict&&this.lookahead.octal&&this.tolerateUnexpectedToken(this.lookahead,s.Messages.StrictOctalLiteral),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,k=this.nextToken(),R=this.getTokenRaw(k),E=this.finalize(S,new a.Literal(k.value,R));break;case 1:this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,k=this.nextToken(),R=this.getTokenRaw(k),E=this.finalize(S,new a.Literal(k.value==="true",R));break;case 5:this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,k=this.nextToken(),R=this.getTokenRaw(k),E=this.finalize(S,new a.Literal(null,R));break;case 10:E=this.parseTemplateLiteral();break;case 7:switch(this.lookahead.value){case"(":this.context.isBindingElement=!1,E=this.inheritCoverGrammar(this.parseGroupExpression);break;case"[":E=this.inheritCoverGrammar(this.parseArrayInitializer);break;case"{":E=this.inheritCoverGrammar(this.parseObjectInitializer);break;case"/":case"/=":this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.scanner.index=this.startMarker.index,k=this.nextRegexToken(),R=this.getTokenRaw(k),E=this.finalize(S,new a.RegexLiteral(k.regex,R,k.pattern,k.flags));break;default:E=this.throwUnexpectedToken(this.nextToken())}break;case 4:!this.context.strict&&this.context.allowYield&&this.matchKeyword("yield")?E=this.parseIdentifierName():!this.context.strict&&this.matchKeyword("let")?E=this.finalize(S,new a.Identifier(this.nextToken().value)):(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.matchKeyword("function")?E=this.parseFunctionExpression():this.matchKeyword("this")?(this.nextToken(),E=this.finalize(S,new a.ThisExpression)):this.matchKeyword("class")?E=this.parseClassExpression():this.matchImportCall()?E=this.parseImportCall():E=this.throwUnexpectedToken(this.nextToken()));break;default:E=this.throwUnexpectedToken(this.nextToken())}return E},w.prototype.parseSpreadElement=function(){var S=this.createNode();this.expect("...");var E=this.inheritCoverGrammar(this.parseAssignmentExpression);return this.finalize(S,new a.SpreadElement(E))},w.prototype.parseArrayInitializer=function(){var S=this.createNode(),E=[];for(this.expect("[");!this.match("]");)if(this.match(","))this.nextToken(),E.push(null);else if(this.match("...")){var k=this.parseSpreadElement();this.match("]")||(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.expect(",")),E.push(k)}else E.push(this.inheritCoverGrammar(this.parseAssignmentExpression)),this.match("]")||this.expect(",");return this.expect("]"),this.finalize(S,new a.ArrayExpression(E))},w.prototype.parsePropertyMethod=function(S){this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var E=this.context.strict,k=this.context.allowStrictDirective;this.context.allowStrictDirective=S.simple;var R=this.isolateCoverGrammar(this.parseFunctionSourceElements);return this.context.strict&&S.firstRestricted&&this.tolerateUnexpectedToken(S.firstRestricted,S.message),this.context.strict&&S.stricted&&this.tolerateUnexpectedToken(S.stricted,S.message),this.context.strict=E,this.context.allowStrictDirective=k,R},w.prototype.parsePropertyMethodFunction=function(){var S=!1,E=this.createNode(),k=this.context.allowYield;this.context.allowYield=!1;var R=this.parseFormalParameters(),M=this.parsePropertyMethod(R);return this.context.allowYield=k,this.finalize(E,new a.FunctionExpression(null,R.params,M,S))},w.prototype.parsePropertyMethodAsyncFunction=function(){var S=this.createNode(),E=this.context.allowYield,k=this.context.await;this.context.allowYield=!1,this.context.await=!0;var R=this.parseFormalParameters(),M=this.parsePropertyMethod(R);return this.context.allowYield=E,this.context.await=k,this.finalize(S,new a.AsyncFunctionExpression(null,R.params,M))},w.prototype.parseObjectPropertyKey=function(){var S=this.createNode(),E=this.nextToken(),k;switch(E.type){case 8:case 6:this.context.strict&&E.octal&&this.tolerateUnexpectedToken(E,s.Messages.StrictOctalLiteral);var R=this.getTokenRaw(E);k=this.finalize(S,new a.Literal(E.value,R));break;case 3:case 1:case 5:case 4:k=this.finalize(S,new a.Identifier(E.value));break;case 7:E.value==="["?(k=this.isolateCoverGrammar(this.parseAssignmentExpression),this.expect("]")):k=this.throwUnexpectedToken(E);break;default:k=this.throwUnexpectedToken(E)}return k},w.prototype.isPropertyKey=function(S,E){return S.type===p.Syntax.Identifier&&S.name===E||S.type===p.Syntax.Literal&&S.value===E},w.prototype.parseObjectProperty=function(S){var E=this.createNode(),k=this.lookahead,R,M=null,L=null,V=!1,H=!1,O=!1,z=!1;if(k.type===3){var K=k.value;if(this.nextToken(),K==="async"&&!this.hasLineTerminator)if(V=this.match("["),V)z=!0,M=this.parseObjectPropertyKey();else{var q=this.lookahead.value;q!==":"&&q!=="("&&q!=="*"&&(z=!0,k=this.lookahead,K=k.value,this.nextToken()),M=this.finalize(E,new a.Identifier(K))}else M=this.finalize(E,new a.Identifier(K))}else this.match("*")?this.nextToken():(V=this.match("["),M=this.parseObjectPropertyKey());var Y=this.qualifiedPropertyName(this.lookahead);if(k.type===3&&!z&&k.value==="get"&&Y)R="get",V=this.match("["),M=this.parseObjectPropertyKey(),this.context.allowYield=!1,L=this.parseGetterMethod();else if(k.type===3&&!z&&k.value==="set"&&Y)R="set",V=this.match("["),M=this.parseObjectPropertyKey(),L=this.parseSetterMethod();else if(k.type===7&&k.value==="*"&&Y)R="init",V=this.match("["),M=this.parseObjectPropertyKey(),L=this.parseGeneratorMethod(),H=!0;else if(M||this.throwUnexpectedToken(this.lookahead),R="init",this.match(":")&&!z)!V&&this.isPropertyKey(M,"__proto__")&&(S.value&&this.tolerateError(s.Messages.DuplicateProtoProperty),S.value=!0),this.nextToken(),L=this.inheritCoverGrammar(this.parseAssignmentExpression);else if(this.match("("))L=z?this.parsePropertyMethodAsyncFunction():this.parsePropertyMethodFunction(),H=!0;else if(k.type===3){var K=this.finalize(E,new a.Identifier(k.value));if(this.match("=")){this.context.firstCoverInitializedNameError=this.lookahead,this.nextToken(),O=!0;var se=this.isolateCoverGrammar(this.parseAssignmentExpression);L=this.finalize(E,new a.AssignmentPattern(K,se))}else O=!0,L=K}else this.throwUnexpectedToken(this.nextToken());return this.finalize(E,new a.Property(R,M,V,L,H,O))},w.prototype.parseSpreadProperty=function(){var S=this.createNode();this.expect("...");var E=this.inheritCoverGrammar(this.parseAssignmentExpression);return this.finalize(S,new a.SpreadProperty(E))},w.prototype.parseObjectInitializer=function(){var S=this.createNode();this.expect("{");for(var E=[],k={value:!1};!this.match("}");)E.push(this.match("...")?this.parseSpreadProperty():this.parseObjectProperty(k)),this.match("}")||this.expectCommaSeparator();return this.expect("}"),this.finalize(S,new a.ObjectExpression(E))},w.prototype.parseTemplateHead=function(){i.assert(this.lookahead.head,"Template literal must start with a template head");var S=this.createNode(),E=this.nextToken(),k=E.value,R=E.cooked;return this.finalize(S,new a.TemplateElement({raw:k,cooked:R},E.tail))},w.prototype.parseTemplateElement=function(){this.lookahead.type!==10&&this.throwUnexpectedToken();var S=this.createNode(),E=this.nextToken(),k=E.value,R=E.cooked;return this.finalize(S,new a.TemplateElement({raw:k,cooked:R},E.tail))},w.prototype.parseTemplateLiteral=function(){var S=this.createNode(),E=[],k=[],R=this.parseTemplateHead();for(k.push(R);!R.tail;)E.push(this.parseExpression()),R=this.parseTemplateElement(),k.push(R);return this.finalize(S,new a.TemplateLiteral(k,E))},w.prototype.reinterpretExpressionAsPattern=function(S){switch(S.type){case p.Syntax.Identifier:case p.Syntax.MemberExpression:case p.Syntax.RestElement:case p.Syntax.AssignmentPattern:break;case p.Syntax.SpreadElement:S.type=p.Syntax.RestElement,this.reinterpretExpressionAsPattern(S.argument);break;case p.Syntax.SpreadProperty:S.type=p.Syntax.RestProperty,this.reinterpretExpressionAsPattern(S.argument);break;case p.Syntax.ArrayExpression:S.type=p.Syntax.ArrayPattern;for(var E=0;E<S.elements.length;E++)S.elements[E]!==null&&this.reinterpretExpressionAsPattern(S.elements[E]);break;case p.Syntax.ObjectExpression:S.type=p.Syntax.ObjectPattern;for(var E=0;E<S.properties.length;E++){var k=S.properties[E];this.reinterpretExpressionAsPattern(k.type===p.Syntax.SpreadProperty?k:k.value)}break;case p.Syntax.AssignmentExpression:S.type=p.Syntax.AssignmentPattern,delete S.operator,this.reinterpretExpressionAsPattern(S.left);break;default:break}},w.prototype.parseGroupExpression=function(){var S;if(this.expect("("),this.match(")"))this.nextToken(),this.match("=>")||this.expect("=>"),S={type:_,params:[],async:!1};else{var E=this.lookahead,k=[];if(this.match("..."))S=this.parseRestElement(k),this.expect(")"),this.match("=>")||this.expect("=>"),S={type:_,params:[S],async:!1};else{var R=!1;if(this.context.isBindingElement=!0,S=this.inheritCoverGrammar(this.parseAssignmentExpression),this.match(",")){var M=[];for(this.context.isAssignmentTarget=!1,M.push(S);this.lookahead.type!==2&&this.match(",");){if(this.nextToken(),this.match(")")){this.nextToken();for(var L=0;L<M.length;L++)this.reinterpretExpressionAsPattern(M[L]);R=!0,S={type:_,params:M,async:!1}}else if(this.match("...")){this.context.isBindingElement||this.throwUnexpectedToken(this.lookahead),M.push(this.parseRestElement(k)),this.expect(")"),this.match("=>")||this.expect("=>"),this.context.isBindingElement=!1;for(var L=0;L<M.length;L++)this.reinterpretExpressionAsPattern(M[L]);R=!0,S={type:_,params:M,async:!1}}else M.push(this.inheritCoverGrammar(this.parseAssignmentExpression));if(R)break}R||(S=this.finalize(this.startNode(E),new a.SequenceExpression(M)))}if(!R){if(this.expect(")"),this.match("=>")&&(S.type===p.Syntax.Identifier&&S.name==="yield"&&(R=!0,S={type:_,params:[S],async:!1}),!R)){if(this.context.isBindingElement||this.throwUnexpectedToken(this.lookahead),S.type===p.Syntax.SequenceExpression)for(var L=0;L<S.expressions.length;L++)this.reinterpretExpressionAsPattern(S.expressions[L]);else this.reinterpretExpressionAsPattern(S);var V=S.type===p.Syntax.SequenceExpression?S.expressions:[S];S={type:_,params:V,async:!1}}this.context.isBindingElement=!1}}}return S},w.prototype.parseArguments=function(){this.expect("(");var S=[];if(!this.match(")"))for(;;){var E=this.match("...")?this.parseSpreadElement():this.isolateCoverGrammar(this.parseAssignmentExpression);if(S.push(E),this.match(")")||(this.expectCommaSeparator(),this.match(")")))break}return this.expect(")"),S},w.prototype.isIdentifierName=function(S){return S.type===3||S.type===4||S.type===1||S.type===5},w.prototype.parseIdentifierName=function(){var S=this.createNode(),E=this.nextToken();return this.isIdentifierName(E)||this.throwUnexpectedToken(E),this.finalize(S,new a.Identifier(E.value))},w.prototype.parseNewExpression=function(){var S=this.createNode(),E=this.parseIdentifierName();i.assert(E.name==="new","New expression must start with `new`");var k;if(this.match("."))if(this.nextToken(),this.lookahead.type===3&&this.context.inFunctionBody&&this.lookahead.value==="target"){var R=this.parseIdentifierName();k=new a.MetaProperty(E,R)}else this.throwUnexpectedToken(this.lookahead);else if(this.matchKeyword("import"))this.throwUnexpectedToken(this.lookahead);else{var M=this.isolateCoverGrammar(this.parseLeftHandSideExpression),L=this.match("(")?this.parseArguments():[];k=new a.NewExpression(M,L),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}return this.finalize(S,k)},w.prototype.parseAsyncArgument=function(){var S=this.parseAssignmentExpression();return this.context.firstCoverInitializedNameError=null,S},w.prototype.parseAsyncArguments=function(){this.expect("(");var S=[];if(!this.match(")"))for(;;){var E=this.match("...")?this.parseSpreadElement():this.isolateCoverGrammar(this.parseAsyncArgument);if(S.push(E),this.match(")")||(this.expectCommaSeparator(),this.match(")")))break}return this.expect(")"),S},w.prototype.matchImportCall=function(){var S=this.matchKeyword("import");if(S){var E=this.scanner.saveState();this.scanner.scanComments();var k=this.scanner.lex();this.scanner.restoreState(E),S=k.type===7&&k.value==="("}return S},w.prototype.parseImportCall=function(){var S=this.createNode();return this.expectKeyword("import"),this.finalize(S,new a.Import)},w.prototype.parseLeftHandSideExpressionAllowCall=function(){var S=this.lookahead,E=this.matchContextualKeyword("async"),k=this.context.allowIn;this.context.allowIn=!0;var R;for(this.matchKeyword("super")&&this.context.inFunctionBody?(R=this.createNode(),this.nextToken(),R=this.finalize(R,new a.Super),!this.match("(")&&!this.match(".")&&!this.match("[")&&this.throwUnexpectedToken(this.lookahead)):R=this.inheritCoverGrammar(this.matchKeyword("new")?this.parseNewExpression:this.parsePrimaryExpression);;)if(this.match(".")){this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect(".");var M=this.parseIdentifierName();R=this.finalize(this.startNode(S),new a.StaticMemberExpression(R,M))}else if(this.match("(")){var L=E&&S.lineNumber===this.lookahead.lineNumber;this.context.isBindingElement=!1,this.context.isAssignmentTarget=!1;var V=L?this.parseAsyncArguments():this.parseArguments();R.type===p.Syntax.Import&&V.length!==1&&this.tolerateError(s.Messages.BadImportCallArity),R=this.finalize(this.startNode(S),new a.CallExpression(R,V)),L&&this.match("=>")&&(R={type:_,params:V,async:!0})}else if(this.match("[")){this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect("[");var M=this.isolateCoverGrammar(this.parseExpression);this.expect("]"),R=this.finalize(this.startNode(S),new a.ComputedMemberExpression(R,M))}else if(this.lookahead.type===10&&this.lookahead.head){var H=this.parseTemplateLiteral();R=this.finalize(this.startNode(S),new a.TaggedTemplateExpression(R,H))}else break;return this.context.allowIn=k,R},w.prototype.parseSuper=function(){var S=this.createNode();return this.expectKeyword("super"),!this.match("[")&&!this.match(".")&&this.throwUnexpectedToken(this.lookahead),this.finalize(S,new a.Super)},w.prototype.parseLeftHandSideExpression=function(){i.assert(this.context.allowIn,"callee of new expression always allow in keyword.");for(var S=this.startNode(this.lookahead),E=this.matchKeyword("super")&&this.context.inFunctionBody?this.parseSuper():this.inheritCoverGrammar(this.matchKeyword("new")?this.parseNewExpression:this.parsePrimaryExpression);;)if(this.match("[")){this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect("[");var k=this.isolateCoverGrammar(this.parseExpression);this.expect("]"),E=this.finalize(S,new a.ComputedMemberExpression(E,k))}else if(this.match(".")){this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect(".");var k=this.parseIdentifierName();E=this.finalize(S,new a.StaticMemberExpression(E,k))}else if(this.lookahead.type===10&&this.lookahead.head){var R=this.parseTemplateLiteral();E=this.finalize(S,new a.TaggedTemplateExpression(E,R))}else break;return E},w.prototype.parseUpdateExpression=function(){var S,E=this.lookahead;if(this.match("++")||this.match("--")){var k=this.startNode(E),R=this.nextToken();S=this.inheritCoverGrammar(this.parseUnaryExpression),this.context.strict&&S.type===p.Syntax.Identifier&&this.scanner.isRestrictedWord(S.name)&&this.tolerateError(s.Messages.StrictLHSPrefix),this.context.isAssignmentTarget||this.tolerateError(s.Messages.InvalidLHSInAssignment);var M=!0;S=this.finalize(k,new a.UpdateExpression(R.value,S,M)),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}else if(S=this.inheritCoverGrammar(this.parseLeftHandSideExpressionAllowCall),!this.hasLineTerminator&&this.lookahead.type===7&&(this.match("++")||this.match("--"))){this.context.strict&&S.type===p.Syntax.Identifier&&this.scanner.isRestrictedWord(S.name)&&this.tolerateError(s.Messages.StrictLHSPostfix),this.context.isAssignmentTarget||this.tolerateError(s.Messages.InvalidLHSInAssignment),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var L=this.nextToken().value,M=!1;S=this.finalize(this.startNode(E),new a.UpdateExpression(L,S,M))}return S},w.prototype.parseAwaitExpression=function(){var S=this.createNode();this.nextToken();var E=this.parseUnaryExpression();return this.finalize(S,new a.AwaitExpression(E))},w.prototype.parseUnaryExpression=function(){var S;if(this.match("+")||this.match("-")||this.match("~")||this.match("!")||this.matchKeyword("delete")||this.matchKeyword("void")||this.matchKeyword("typeof")){var E=this.startNode(this.lookahead),k=this.nextToken();S=this.inheritCoverGrammar(this.parseUnaryExpression),S=this.finalize(E,new a.UnaryExpression(k.value,S)),this.context.strict&&S.operator==="delete"&&S.argument.type===p.Syntax.Identifier&&this.tolerateError(s.Messages.StrictDelete),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}else this.context.await&&this.matchContextualKeyword("await")?S=this.parseAwaitExpression():S=this.parseUpdateExpression();return S},w.prototype.parseExponentiationExpression=function(){var S=this.lookahead,E=this.inheritCoverGrammar(this.parseUnaryExpression);if(E.type!==p.Syntax.UnaryExpression&&this.match("**")){this.nextToken(),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var k=E,R=this.isolateCoverGrammar(this.parseExponentiationExpression);E=this.finalize(this.startNode(S),new a.BinaryExpression("**",k,R))}return E},w.prototype.binaryPrecedence=function(S){var E=S.value,k;return S.type===7?k=this.operatorPrecedence[E]||0:S.type===4?k=E==="instanceof"||this.context.allowIn&&E==="in"?7:0:k=0,k},w.prototype.parseBinaryExpression=function(){var S=this.lookahead,E=this.inheritCoverGrammar(this.parseExponentiationExpression),k=this.lookahead,R=this.binaryPrecedence(k);if(R>0){this.nextToken(),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;for(var M=[S,this.lookahead],L=E,V=this.isolateCoverGrammar(this.parseExponentiationExpression),H=[L,k.value,V],O=[R];R=this.binaryPrecedence(this.lookahead),!(R<=0);){for(;H.length>2&&R<=O[O.length-1];){V=H.pop();var z=H.pop();O.pop(),L=H.pop(),M.pop();var K=this.startNode(M[M.length-1]);H.push(this.finalize(K,new a.BinaryExpression(z,L,V)))}H.push(this.nextToken().value),O.push(R),M.push(this.lookahead),H.push(this.isolateCoverGrammar(this.parseExponentiationExpression))}var q=H.length-1;for(E=H[q],M.pop();q>1;){var K=this.startNode(M.pop()),z=H[q-1];E=this.finalize(K,new a.BinaryExpression(z,H[q-2],E)),q-=2}}return E},w.prototype.parseConditionalExpression=function(){var S=this.lookahead,E=this.inheritCoverGrammar(this.parseBinaryExpression);if(this.match("?")){this.nextToken();var k=this.context.allowIn;this.context.allowIn=!0;var R=this.isolateCoverGrammar(this.parseAssignmentExpression);this.context.allowIn=k,this.expect(":");var M=this.isolateCoverGrammar(this.parseAssignmentExpression);E=this.finalize(this.startNode(S),new a.ConditionalExpression(E,R,M)),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}return E},w.prototype.checkPatternParam=function(S,E){switch(E.type){case p.Syntax.Identifier:this.validateParam(S,E,E.name);break;case p.Syntax.RestElement:case p.Syntax.RestProperty:this.checkPatternParam(S,E.argument);break;case p.Syntax.AssignmentPattern:this.checkPatternParam(S,E.left);break;case p.Syntax.ArrayPattern:for(var k=0;k<E.elements.length;k++)E.elements[k]!==null&&this.checkPatternParam(S,E.elements[k]);break;case p.Syntax.ObjectPattern:for(var k=0;k<E.properties.length;k++){var R=E.properties[k];this.checkPatternParam(S,R.type===p.Syntax.RestProperty?R:R.value)}break;default:break}S.simple=S.simple&&E instanceof a.Identifier},w.prototype.reinterpretAsCoverFormalsList=function(S){var E=[S],k,R=!1;switch(S.type){case p.Syntax.Identifier:break;case _:E=S.params,R=S.async;break;default:return null}k={simple:!0,paramSet:{}};for(var M=0;M<E.length;++M){var L=E[M];L.type===p.Syntax.AssignmentPattern?L.right.type===p.Syntax.YieldExpression&&(L.right.argument&&this.throwUnexpectedToken(this.lookahead),L.right.type=p.Syntax.Identifier,L.right.name="yield",delete L.right.argument,delete L.right.delegate):R&&L.type===p.Syntax.Identifier&&L.name==="await"&&this.throwUnexpectedToken(this.lookahead),this.checkPatternParam(k,L),E[M]=L}if(this.context.strict||!this.context.allowYield)for(var M=0;M<E.length;++M){var L=E[M];L.type===p.Syntax.YieldExpression&&this.throwUnexpectedToken(this.lookahead)}if(k.message===s.Messages.StrictParamDupe){var V=this.context.strict?k.stricted:k.firstRestricted;this.throwUnexpectedToken(V,k.message)}return{simple:k.simple,params:E,stricted:k.stricted,firstRestricted:k.firstRestricted,message:k.message}},w.prototype.parseAssignmentExpression=function(){var S;if(!this.context.allowYield&&this.matchKeyword("yield"))S=this.parseYieldExpression();else{var E=this.lookahead,k=E;if(S=this.parseConditionalExpression(),k.type===3&&k.lineNumber===this.lookahead.lineNumber&&k.value==="async"&&this.lookahead.type===3){var R=this.parsePrimaryExpression();S={type:_,params:[R],async:!0}}if(S.type===_||this.match("=>")){this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var M=S.async,L=this.reinterpretAsCoverFormalsList(S);if(L){this.hasLineTerminator&&this.tolerateUnexpectedToken(this.lookahead),this.context.firstCoverInitializedNameError=null;var V=this.context.strict,H=this.context.allowStrictDirective;this.context.allowStrictDirective=L.simple;var O=this.context.allowYield,z=this.context.await;this.context.allowYield=!0,this.context.await=M;var K=this.startNode(E);this.expect("=>");var q=this.match("{")?this.parseFunctionSourceElements():this.isolateCoverGrammar(this.parseAssignmentExpression),Y=q.type!==p.Syntax.BlockStatement;this.context.strict&&L.firstRestricted&&this.throwUnexpectedToken(L.firstRestricted,L.message),this.context.strict&&L.stricted&&this.tolerateUnexpectedToken(L.stricted,L.message),S=M?this.finalize(K,new a.AsyncArrowFunctionExpression(L.params,q,Y)):this.finalize(K,new a.ArrowFunctionExpression(L.params,q,Y)),this.context.strict=V,this.context.allowStrictDirective=H,this.context.allowYield=O,this.context.await=z}}else if(this.matchAssign()){if(this.context.isAssignmentTarget||this.tolerateError(s.Messages.InvalidLHSInAssignment),this.context.strict&&S.type===p.Syntax.Identifier){var se=S;this.scanner.isRestrictedWord(se.name)&&this.tolerateUnexpectedToken(k,s.Messages.StrictLHSAssignment),this.scanner.isStrictModeReservedWord(se.name)&&this.tolerateUnexpectedToken(k,s.Messages.StrictReservedWord)}this.match("=")?this.reinterpretExpressionAsPattern(S):(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1),k=this.nextToken();var ce=k.value,le=this.isolateCoverGrammar(this.parseAssignmentExpression);S=this.finalize(this.startNode(E),new a.AssignmentExpression(ce,S,le)),this.context.firstCoverInitializedNameError=null}}return S},w.prototype.parseExpression=function(){var S=this.lookahead,E=this.isolateCoverGrammar(this.parseAssignmentExpression);if(this.match(",")){var k=[];for(k.push(E);this.lookahead.type!==2&&this.match(",");)this.nextToken(),k.push(this.isolateCoverGrammar(this.parseAssignmentExpression));E=this.finalize(this.startNode(S),new a.SequenceExpression(k))}return E},w.prototype.parseStatementListItem=function(){var S;if(this.context.isAssignmentTarget=!0,this.context.isBindingElement=!0,this.lookahead.type===4)switch(this.lookahead.value){case"export":this.context.isModule||this.tolerateUnexpectedToken(this.lookahead,s.Messages.IllegalExportDeclaration),S=this.parseExportDeclaration();break;case"import":this.matchImportCall()?S=this.parseExpressionStatement():(this.context.isModule||this.tolerateUnexpectedToken(this.lookahead,s.Messages.IllegalImportDeclaration),S=this.parseImportDeclaration());break;case"const":S=this.parseLexicalDeclaration({inFor:!1});break;case"function":S=this.parseFunctionDeclaration();break;case"class":S=this.parseClassDeclaration();break;case"let":S=this.isLexicalDeclaration()?this.parseLexicalDeclaration({inFor:!1}):this.parseStatement();break;default:S=this.parseStatement();break}else S=this.parseStatement();return S},w.prototype.parseBlock=function(){var S=this.createNode();this.expect("{");for(var E=[];!this.match("}");)E.push(this.parseStatementListItem());return this.expect("}"),this.finalize(S,new a.BlockStatement(E))},w.prototype.parseLexicalBinding=function(S,E){var k=this.createNode(),R=[],M=this.parsePattern(R,S);this.context.strict&&M.type===p.Syntax.Identifier&&this.scanner.isRestrictedWord(M.name)&&this.tolerateError(s.Messages.StrictVarName);var L=null;return S==="const"?!this.matchKeyword("in")&&!this.matchContextualKeyword("of")&&(this.match("=")?(this.nextToken(),L=this.isolateCoverGrammar(this.parseAssignmentExpression)):this.throwError(s.Messages.DeclarationMissingInitializer,"const")):(!E.inFor&&M.type!==p.Syntax.Identifier||this.match("="))&&(this.expect("="),L=this.isolateCoverGrammar(this.parseAssignmentExpression)),this.finalize(k,new a.VariableDeclarator(M,L))},w.prototype.parseBindingList=function(S,E){for(var k=[this.parseLexicalBinding(S,E)];this.match(",");)this.nextToken(),k.push(this.parseLexicalBinding(S,E));return k},w.prototype.isLexicalDeclaration=function(){var S=this.scanner.saveState();this.scanner.scanComments();var E=this.scanner.lex();return this.scanner.restoreState(S),E.type===3||E.type===7&&E.value==="["||E.type===7&&E.value==="{"||E.type===4&&E.value==="let"||E.type===4&&E.value==="yield"},w.prototype.parseLexicalDeclaration=function(S){var E=this.createNode(),k=this.nextToken().value;i.assert(k==="let"||k==="const","Lexical declaration must be either let or const");var R=this.parseBindingList(k,S);return this.consumeSemicolon(),this.finalize(E,new a.VariableDeclaration(R,k))},w.prototype.parseBindingRestElement=function(S,E){var k=this.createNode();this.expect("...");var R=this.parsePattern(S,E);return this.finalize(k,new a.RestElement(R))},w.prototype.parseArrayPattern=function(S,E){var k=this.createNode();this.expect("[");for(var R=[];!this.match("]");)if(this.match(","))this.nextToken(),R.push(null);else{if(this.match("...")){R.push(this.parseBindingRestElement(S,E));break}else R.push(this.parsePatternWithDefault(S,E));this.match("]")||this.expect(",")}return this.expect("]"),this.finalize(k,new a.ArrayPattern(R))},w.prototype.parsePropertyPattern=function(S,E){var k=this.createNode(),R=!1,M=!1,L=!1,V,H;if(this.lookahead.type===3){var O=this.lookahead;V=this.parseVariableIdentifier();var z=this.finalize(k,new a.Identifier(O.value));if(this.match("=")){S.push(O),M=!0,this.nextToken();var K=this.parseAssignmentExpression();H=this.finalize(this.startNode(O),new a.AssignmentPattern(z,K))}else this.match(":")?(this.expect(":"),H=this.parsePatternWithDefault(S,E)):(S.push(O),M=!0,H=z)}else R=this.match("["),V=this.parseObjectPropertyKey(),this.expect(":"),H=this.parsePatternWithDefault(S,E);return this.finalize(k,new a.Property("init",V,R,H,L,M))},w.prototype.parseRestProperty=function(S,E){var k=this.createNode();this.expect("...");var R=this.parsePattern(S);return this.match("=")&&this.throwError(s.Messages.DefaultRestProperty),this.match("}")||this.throwError(s.Messages.PropertyAfterRestProperty),this.finalize(k,new a.RestProperty(R))},w.prototype.parseObjectPattern=function(S,E){var k=this.createNode(),R=[];for(this.expect("{");!this.match("}");)R.push(this.match("...")?this.parseRestProperty(S,E):this.parsePropertyPattern(S,E)),this.match("}")||this.expect(",");return this.expect("}"),this.finalize(k,new a.ObjectPattern(R))},w.prototype.parsePattern=function(S,E){var k;return this.match("[")?k=this.parseArrayPattern(S,E):this.match("{")?k=this.parseObjectPattern(S,E):(this.matchKeyword("let")&&(E==="const"||E==="let")&&this.tolerateUnexpectedToken(this.lookahead,s.Messages.LetInLexicalBinding),S.push(this.lookahead),k=this.parseVariableIdentifier(E)),k},w.prototype.parsePatternWithDefault=function(S,E){var k=this.lookahead,R=this.parsePattern(S,E);if(this.match("=")){this.nextToken();var M=this.context.allowYield;this.context.allowYield=!0;var L=this.isolateCoverGrammar(this.parseAssignmentExpression);this.context.allowYield=M,R=this.finalize(this.startNode(k),new a.AssignmentPattern(R,L))}return R},w.prototype.parseVariableIdentifier=function(S){var E=this.createNode(),k=this.nextToken();return k.type===4&&k.value==="yield"?this.context.strict?this.tolerateUnexpectedToken(k,s.Messages.StrictReservedWord):this.context.allowYield||this.throwUnexpectedToken(k):k.type!==3?this.context.strict&&k.type===4&&this.scanner.isStrictModeReservedWord(k.value)?this.tolerateUnexpectedToken(k,s.Messages.StrictReservedWord):(this.context.strict||k.value!=="let"||S!=="var")&&this.throwUnexpectedToken(k):(this.context.isModule||this.context.await)&&k.type===3&&k.value==="await"&&this.tolerateUnexpectedToken(k),this.finalize(E,new a.Identifier(k.value))},w.prototype.parseVariableDeclaration=function(S){var E=this.createNode(),k=[],R=this.parsePattern(k,"var");this.context.strict&&R.type===p.Syntax.Identifier&&this.scanner.isRestrictedWord(R.name)&&this.tolerateError(s.Messages.StrictVarName);var M=null;return this.match("=")?(this.nextToken(),M=this.isolateCoverGrammar(this.parseAssignmentExpression)):R.type!==p.Syntax.Identifier&&!S.inFor&&this.expect("="),this.finalize(E,new a.VariableDeclarator(R,M))},w.prototype.parseVariableDeclarationList=function(S){var E={inFor:S.inFor},k=[];for(k.push(this.parseVariableDeclaration(E));this.match(",");)this.nextToken(),k.push(this.parseVariableDeclaration(E));return k},w.prototype.parseVariableStatement=function(){var S=this.createNode();this.expectKeyword("var");var E=this.parseVariableDeclarationList({inFor:!1});return this.consumeSemicolon(),this.finalize(S,new a.VariableDeclaration(E,"var"))},w.prototype.parseEmptyStatement=function(){var S=this.createNode();return this.expect(";"),this.finalize(S,new a.EmptyStatement)},w.prototype.parseExpressionStatement=function(){var S=this.createNode(),E=this.parseExpression();return this.consumeSemicolon(),this.finalize(S,new a.ExpressionStatement(E))},w.prototype.parseIfClause=function(){return this.context.strict&&this.matchKeyword("function")&&this.tolerateError(s.Messages.StrictFunction),this.parseStatement()},w.prototype.parseIfStatement=function(){var S=this.createNode(),E,k=null;this.expectKeyword("if"),this.expect("(");var R=this.parseExpression();return!this.match(")")&&this.config.tolerant?(this.tolerateUnexpectedToken(this.nextToken()),E=this.finalize(this.createNode(),new a.EmptyStatement)):(this.expect(")"),E=this.parseIfClause(),this.matchKeyword("else")&&(this.nextToken(),k=this.parseIfClause())),this.finalize(S,new a.IfStatement(R,E,k))},w.prototype.parseDoWhileStatement=function(){var S=this.createNode();this.expectKeyword("do");var E=this.context.inIteration;this.context.inIteration=!0;var k=this.parseStatement();this.context.inIteration=E,this.expectKeyword("while"),this.expect("(");var R=this.parseExpression();return!this.match(")")&&this.config.tolerant?this.tolerateUnexpectedToken(this.nextToken()):(this.expect(")"),this.match(";")&&this.nextToken()),this.finalize(S,new a.DoWhileStatement(k,R))},w.prototype.parseWhileStatement=function(){var S=this.createNode(),E;this.expectKeyword("while"),this.expect("(");var k=this.parseExpression();if(!this.match(")")&&this.config.tolerant)this.tolerateUnexpectedToken(this.nextToken()),E=this.finalize(this.createNode(),new a.EmptyStatement);else{this.expect(")");var R=this.context.inIteration;this.context.inIteration=!0,E=this.parseStatement(),this.context.inIteration=R}return this.finalize(S,new a.WhileStatement(k,E))},w.prototype.parseForStatement=function(){var S=null,E=null,k=null,R=!0,M,L,V=this.createNode();if(this.expectKeyword("for"),this.expect("("),this.match(";"))this.nextToken();else if(this.matchKeyword("var")){S=this.createNode(),this.nextToken();var H=this.context.allowIn;this.context.allowIn=!1;var O=this.parseVariableDeclarationList({inFor:!0});if(this.context.allowIn=H,O.length===1&&this.matchKeyword("in")){var z=O[0];z.init&&(z.id.type===p.Syntax.ArrayPattern||z.id.type===p.Syntax.ObjectPattern||this.context.strict)&&this.tolerateError(s.Messages.ForInOfLoopInitializer,"for-in"),S=this.finalize(S,new a.VariableDeclaration(O,"var")),this.nextToken(),M=S,L=this.parseExpression(),S=null}else O.length===1&&O[0].init===null&&this.matchContextualKeyword("of")?(S=this.finalize(S,new a.VariableDeclaration(O,"var")),this.nextToken(),M=S,L=this.parseAssignmentExpression(),S=null,R=!1):(S=this.finalize(S,new a.VariableDeclaration(O,"var")),this.expect(";"))}else if(this.matchKeyword("const")||this.matchKeyword("let")){S=this.createNode();var K=this.nextToken().value;if(!this.context.strict&&this.lookahead.value==="in")S=this.finalize(S,new a.Identifier(K)),this.nextToken(),M=S,L=this.parseExpression(),S=null;else{var H=this.context.allowIn;this.context.allowIn=!1;var O=this.parseBindingList(K,{inFor:!0});this.context.allowIn=H,O.length===1&&O[0].init===null&&this.matchKeyword("in")?(S=this.finalize(S,new a.VariableDeclaration(O,K)),this.nextToken(),M=S,L=this.parseExpression(),S=null):O.length===1&&O[0].init===null&&this.matchContextualKeyword("of")?(S=this.finalize(S,new a.VariableDeclaration(O,K)),this.nextToken(),M=S,L=this.parseAssignmentExpression(),S=null,R=!1):(this.consumeSemicolon(),S=this.finalize(S,new a.VariableDeclaration(O,K)))}}else{var q=this.lookahead,H=this.context.allowIn;if(this.context.allowIn=!1,S=this.inheritCoverGrammar(this.parseAssignmentExpression),this.context.allowIn=H,this.matchKeyword("in"))(!this.context.isAssignmentTarget||S.type===p.Syntax.AssignmentExpression)&&this.tolerateError(s.Messages.InvalidLHSInForIn),this.nextToken(),this.reinterpretExpressionAsPattern(S),M=S,L=this.parseExpression(),S=null;else if(this.matchContextualKeyword("of"))(!this.context.isAssignmentTarget||S.type===p.Syntax.AssignmentExpression)&&this.tolerateError(s.Messages.InvalidLHSInForLoop),this.nextToken(),this.reinterpretExpressionAsPattern(S),M=S,L=this.parseAssignmentExpression(),S=null,R=!1;else{if(this.match(",")){for(var Y=[S];this.match(",");)this.nextToken(),Y.push(this.isolateCoverGrammar(this.parseAssignmentExpression));S=this.finalize(this.startNode(q),new a.SequenceExpression(Y))}this.expect(";")}}typeof M>"u"&&(this.match(";")||(E=this.parseExpression()),this.expect(";"),this.match(")")||(k=this.parseExpression()));var se;if(!this.match(")")&&this.config.tolerant)this.tolerateUnexpectedToken(this.nextToken()),se=this.finalize(this.createNode(),new a.EmptyStatement);else{this.expect(")");var ce=this.context.inIteration;this.context.inIteration=!0,se=this.isolateCoverGrammar(this.parseStatement),this.context.inIteration=ce}return typeof M>"u"?this.finalize(V,new a.ForStatement(S,E,k,se)):R?this.finalize(V,new a.ForInStatement(M,L,se)):this.finalize(V,new a.ForOfStatement(M,L,se))},w.prototype.parseContinueStatement=function(){var S=this.createNode();this.expectKeyword("continue");var E=null;if(this.lookahead.type===3&&!this.hasLineTerminator){var k=this.parseVariableIdentifier();E=k;var R="$"+k.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,R)||this.throwError(s.Messages.UnknownLabel,k.name)}return this.consumeSemicolon(),E===null&&!this.context.inIteration&&this.throwError(s.Messages.IllegalContinue),this.finalize(S,new a.ContinueStatement(E))},w.prototype.parseBreakStatement=function(){var S=this.createNode();this.expectKeyword("break");var E=null;if(this.lookahead.type===3&&!this.hasLineTerminator){var k=this.parseVariableIdentifier(),R="$"+k.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,R)||this.throwError(s.Messages.UnknownLabel,k.name),E=k}return this.consumeSemicolon(),E===null&&!this.context.inIteration&&!this.context.inSwitch&&this.throwError(s.Messages.IllegalBreak),this.finalize(S,new a.BreakStatement(E))},w.prototype.parseReturnStatement=function(){this.context.inFunctionBody||this.tolerateError(s.Messages.IllegalReturn);var S=this.createNode();this.expectKeyword("return");var E=!this.match(";")&&!this.match("}")&&!this.hasLineTerminator&&this.lookahead.type!==2,k=E?this.parseExpression():null;return this.consumeSemicolon(),this.finalize(S,new a.ReturnStatement(k))},w.prototype.parseWithStatement=function(){this.context.strict&&this.tolerateError(s.Messages.StrictModeWith);var S=this.createNode(),E;this.expectKeyword("with"),this.expect("(");var k=this.parseExpression();return!this.match(")")&&this.config.tolerant?(this.tolerateUnexpectedToken(this.nextToken()),E=this.finalize(this.createNode(),new a.EmptyStatement)):(this.expect(")"),E=this.parseStatement()),this.finalize(S,new a.WithStatement(k,E))},w.prototype.parseSwitchCase=function(){var S=this.createNode(),E;this.matchKeyword("default")?(this.nextToken(),E=null):(this.expectKeyword("case"),E=this.parseExpression()),this.expect(":");for(var k=[];!(this.match("}")||this.matchKeyword("default")||this.matchKeyword("case"));)k.push(this.parseStatementListItem());return this.finalize(S,new a.SwitchCase(E,k))},w.prototype.parseSwitchStatement=function(){var S=this.createNode();this.expectKeyword("switch"),this.expect("(");var E=this.parseExpression();this.expect(")");var k=this.context.inSwitch;this.context.inSwitch=!0;var R=[],M=!1;for(this.expect("{");!this.match("}");){var L=this.parseSwitchCase();L.test===null&&(M&&this.throwError(s.Messages.MultipleDefaultsInSwitch),M=!0),R.push(L)}return this.expect("}"),this.context.inSwitch=k,this.finalize(S,new a.SwitchStatement(E,R))},w.prototype.parseLabelledStatement=function(){var S=this.createNode(),E=this.parseExpression(),k;if(E.type===p.Syntax.Identifier&&this.match(":")){this.nextToken();var R=E,M="$"+R.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,M)&&this.throwError(s.Messages.Redeclaration,"Label",R.name),this.context.labelSet[M]=!0;var L=void 0;if(this.matchKeyword("class"))this.tolerateUnexpectedToken(this.lookahead),L=this.parseClassDeclaration();else if(this.matchKeyword("function")){var V=this.lookahead,H=this.parseFunctionDeclaration();this.context.strict?this.tolerateUnexpectedToken(V,s.Messages.StrictFunction):H.generator&&this.tolerateUnexpectedToken(V,s.Messages.GeneratorInLegacyContext),L=H}else L=this.parseStatement();delete this.context.labelSet[M],k=new a.LabeledStatement(R,L)}else this.consumeSemicolon(),k=new a.ExpressionStatement(E);return this.finalize(S,k)},w.prototype.parseThrowStatement=function(){var S=this.createNode();this.expectKeyword("throw"),this.hasLineTerminator&&this.throwError(s.Messages.NewlineAfterThrow);var E=this.parseExpression();return this.consumeSemicolon(),this.finalize(S,new a.ThrowStatement(E))},w.prototype.parseCatchClause=function(){var S=this.createNode();this.expectKeyword("catch"),this.expect("("),this.match(")")&&this.throwUnexpectedToken(this.lookahead);for(var E=[],k=this.parsePattern(E),R={},M=0;M<E.length;M++){var L="$"+E[M].value;Object.prototype.hasOwnProperty.call(R,L)&&this.tolerateError(s.Messages.DuplicateBinding,E[M].value),R[L]=!0}this.context.strict&&k.type===p.Syntax.Identifier&&this.scanner.isRestrictedWord(k.name)&&this.tolerateError(s.Messages.StrictCatchVariable),this.expect(")");var V=this.parseBlock();return this.finalize(S,new a.CatchClause(k,V))},w.prototype.parseFinallyClause=function(){return this.expectKeyword("finally"),this.parseBlock()},w.prototype.parseTryStatement=function(){var S=this.createNode();this.expectKeyword("try");var E=this.parseBlock(),k=this.matchKeyword("catch")?this.parseCatchClause():null,R=this.matchKeyword("finally")?this.parseFinallyClause():null;return!k&&!R&&this.throwError(s.Messages.NoCatchOrFinally),this.finalize(S,new a.TryStatement(E,k,R))},w.prototype.parseDebuggerStatement=function(){var S=this.createNode();return this.expectKeyword("debugger"),this.consumeSemicolon(),this.finalize(S,new a.DebuggerStatement)},w.prototype.parseStatement=function(){var S;switch(this.lookahead.type){case 1:case 5:case 6:case 8:case 10:case 9:S=this.parseExpressionStatement();break;case 7:var E=this.lookahead.value;E==="{"?S=this.parseBlock():E==="("?S=this.parseExpressionStatement():E===";"?S=this.parseEmptyStatement():S=this.parseExpressionStatement();break;case 3:S=this.matchAsyncFunction()?this.parseFunctionDeclaration():this.parseLabelledStatement();break;case 4:switch(this.lookahead.value){case"break":S=this.parseBreakStatement();break;case"continue":S=this.parseContinueStatement();break;case"debugger":S=this.parseDebuggerStatement();break;case"do":S=this.parseDoWhileStatement();break;case"for":S=this.parseForStatement();break;case"function":S=this.parseFunctionDeclaration();break;case"if":S=this.parseIfStatement();break;case"return":S=this.parseReturnStatement();break;case"switch":S=this.parseSwitchStatement();break;case"throw":S=this.parseThrowStatement();break;case"try":S=this.parseTryStatement();break;case"var":S=this.parseVariableStatement();break;case"while":S=this.parseWhileStatement();break;case"with":S=this.parseWithStatement();break;default:S=this.parseExpressionStatement();break}break;default:S=this.throwUnexpectedToken(this.lookahead)}return S},w.prototype.parseFunctionSourceElements=function(){var S=this.createNode();this.expect("{");var E=this.parseDirectivePrologues(),k=this.context.labelSet,R=this.context.inIteration,M=this.context.inSwitch,L=this.context.inFunctionBody;for(this.context.labelSet={},this.context.inIteration=!1,this.context.inSwitch=!1,this.context.inFunctionBody=!0;this.lookahead.type!==2&&!this.match("}");)E.push(this.parseStatementListItem());return this.expect("}"),this.context.labelSet=k,this.context.inIteration=R,this.context.inSwitch=M,this.context.inFunctionBody=L,this.finalize(S,new a.BlockStatement(E))},w.prototype.validateParam=function(S,E,k){var R="$"+k;this.context.strict?(this.scanner.isRestrictedWord(k)&&(S.stricted=E,S.message=s.Messages.StrictParamName),Object.prototype.hasOwnProperty.call(S.paramSet,R)&&(S.stricted=E,S.message=s.Messages.StrictParamDupe)):S.firstRestricted||(this.scanner.isRestrictedWord(k)?(S.firstRestricted=E,S.message=s.Messages.StrictParamName):this.scanner.isStrictModeReservedWord(k)?(S.firstRestricted=E,S.message=s.Messages.StrictReservedWord):Object.prototype.hasOwnProperty.call(S.paramSet,R)&&(S.stricted=E,S.message=s.Messages.StrictParamDupe)),typeof Object.defineProperty=="function"?Object.defineProperty(S.paramSet,R,{value:!0,enumerable:!0,writable:!0,configurable:!0}):S.paramSet[R]=!0},w.prototype.parseRestElement=function(S){var E=this.createNode();this.expect("...");var k=this.parsePattern(S);return this.match("=")&&this.throwError(s.Messages.DefaultRestParameter),this.match(")")||this.throwError(s.Messages.ParameterAfterRestParameter),this.finalize(E,new a.RestElement(k))},w.prototype.parseFormalParameter=function(S){for(var E=[],k=this.match("...")?this.parseRestElement(E):this.parsePatternWithDefault(E),R=0;R<E.length;R++)this.validateParam(S,E[R],E[R].value);S.simple=S.simple&&k instanceof a.Identifier,S.params.push(k)},w.prototype.parseFormalParameters=function(S){var E;if(E={simple:!0,params:[],firstRestricted:S},this.expect("("),!this.match(")"))for(E.paramSet={};this.lookahead.type!==2&&(this.parseFormalParameter(E),!(this.match(")")||(this.expect(","),this.match(")")))););return this.expect(")"),{simple:E.simple,params:E.params,stricted:E.stricted,firstRestricted:E.firstRestricted,message:E.message}},w.prototype.matchAsyncFunction=function(){var S=this.matchContextualKeyword("async");if(S){var E=this.scanner.saveState();this.scanner.scanComments();var k=this.scanner.lex();this.scanner.restoreState(E),S=E.lineNumber===k.lineNumber&&k.type===4&&k.value==="function"}return S},w.prototype.parseFunctionDeclaration=function(S){var E=this.createNode(),k=this.matchContextualKeyword("async");k&&this.nextToken(),this.expectKeyword("function");var R=k?!1:this.match("*");R&&this.nextToken();var M,L=null,V=null;if(!S||!this.match("(")){var H=this.lookahead;L=this.parseVariableIdentifier(),this.context.strict?this.scanner.isRestrictedWord(H.value)&&this.tolerateUnexpectedToken(H,s.Messages.StrictFunctionName):this.scanner.isRestrictedWord(H.value)?(V=H,M=s.Messages.StrictFunctionName):this.scanner.isStrictModeReservedWord(H.value)&&(V=H,M=s.Messages.StrictReservedWord)}var O=this.context.await,z=this.context.allowYield;this.context.await=k,this.context.allowYield=!R;var K=this.parseFormalParameters(V),q=K.params,Y=K.stricted;V=K.firstRestricted,K.message&&(M=K.message);var se=this.context.strict,ce=this.context.allowStrictDirective;this.context.allowStrictDirective=K.simple;var le=this.parseFunctionSourceElements();return this.context.strict&&V&&this.throwUnexpectedToken(V,M),this.context.strict&&Y&&this.tolerateUnexpectedToken(Y,M),this.context.strict=se,this.context.allowStrictDirective=ce,this.context.await=O,this.context.allowYield=z,k?this.finalize(E,new a.AsyncFunctionDeclaration(L,q,le)):this.finalize(E,new a.FunctionDeclaration(L,q,le,R))},w.prototype.parseFunctionExpression=function(){var S=this.createNode(),E=this.matchContextualKeyword("async");E&&this.nextToken(),this.expectKeyword("function");var k=E?!1:this.match("*");k&&this.nextToken();var R,M=null,L,V=this.context.await,H=this.context.allowYield;if(this.context.await=E,this.context.allowYield=!k,!this.match("(")){var O=this.lookahead;M=!this.context.strict&&!k&&this.matchKeyword("yield")?this.parseIdentifierName():this.parseVariableIdentifier(),this.context.strict?this.scanner.isRestrictedWord(O.value)&&this.tolerateUnexpectedToken(O,s.Messages.StrictFunctionName):this.scanner.isRestrictedWord(O.value)?(L=O,R=s.Messages.StrictFunctionName):this.scanner.isStrictModeReservedWord(O.value)&&(L=O,R=s.Messages.StrictReservedWord)}var z=this.parseFormalParameters(L),K=z.params,q=z.stricted;L=z.firstRestricted,z.message&&(R=z.message);var Y=this.context.strict,se=this.context.allowStrictDirective;this.context.allowStrictDirective=z.simple;var ce=this.parseFunctionSourceElements();return this.context.strict&&L&&this.throwUnexpectedToken(L,R),this.context.strict&&q&&this.tolerateUnexpectedToken(q,R),this.context.strict=Y,this.context.allowStrictDirective=se,this.context.await=V,this.context.allowYield=H,E?this.finalize(S,new a.AsyncFunctionExpression(M,K,ce)):this.finalize(S,new a.FunctionExpression(M,K,ce,k))},w.prototype.parseDirective=function(){var S=this.lookahead,E=this.createNode(),k=this.parseExpression(),R=k.type===p.Syntax.Literal?this.getTokenRaw(S).slice(1,-1):null;return this.consumeSemicolon(),this.finalize(E,R?new a.Directive(k,R):new a.ExpressionStatement(k))},w.prototype.parseDirectivePrologues=function(){for(var S=null,E=[];;){var k=this.lookahead;if(k.type!==8)break;var R=this.parseDirective();E.push(R);var M=R.directive;if(typeof M!="string")break;M==="use strict"?(this.context.strict=!0,S&&this.tolerateUnexpectedToken(S,s.Messages.StrictOctalLiteral),this.context.allowStrictDirective||this.tolerateUnexpectedToken(k,s.Messages.IllegalLanguageModeDirective)):!S&&k.octal&&(S=k)}return E},w.prototype.qualifiedPropertyName=function(S){switch(S.type){case 3:case 8:case 1:case 5:case 6:case 4:return!0;case 7:return S.value==="[";default:break}return!1},w.prototype.parseGetterMethod=function(){var S=this.createNode(),E=!1,k=this.context.allowYield;this.context.allowYield=!1;var R=this.parseFormalParameters();R.params.length>0&&this.tolerateError(s.Messages.BadGetterArity);var M=this.parsePropertyMethod(R);return this.context.allowYield=k,this.finalize(S,new a.FunctionExpression(null,R.params,M,E))},w.prototype.parseSetterMethod=function(){var S=this.createNode(),E=!1,k=this.context.allowYield;this.context.allowYield=!1;var R=this.parseFormalParameters();R.params.length!==1?this.tolerateError(s.Messages.BadSetterArity):R.params[0]instanceof a.RestElement&&this.tolerateError(s.Messages.BadSetterRestParameter);var M=this.parsePropertyMethod(R);return this.context.allowYield=k,this.finalize(S,new a.FunctionExpression(null,R.params,M,E))},w.prototype.parseGeneratorMethod=function(){var S=this.createNode(),E=!0,k=this.context.allowYield;this.context.allowYield=!0;var R=this.parseFormalParameters();this.context.allowYield=!1;var M=this.parsePropertyMethod(R);return this.context.allowYield=k,this.finalize(S,new a.FunctionExpression(null,R.params,M,E))},w.prototype.isStartOfExpression=function(){var S=!0,E=this.lookahead.value;switch(this.lookahead.type){case 7:S=E==="["||E==="("||E==="{"||E==="+"||E==="-"||E==="!"||E==="~"||E==="++"||E==="--"||E==="/"||E==="/=";break;case 4:S=E==="class"||E==="delete"||E==="function"||E==="let"||E==="new"||E==="super"||E==="this"||E==="typeof"||E==="void"||E==="yield";break;default:break}return S},w.prototype.parseYieldExpression=function(){var S=this.createNode();this.expectKeyword("yield");var E=null,k=!1;if(!this.hasLineTerminator){var R=this.context.allowYield;this.context.allowYield=!1,k=this.match("*"),k?(this.nextToken(),E=this.parseAssignmentExpression()):this.isStartOfExpression()&&(E=this.parseAssignmentExpression()),this.context.allowYield=R}return this.finalize(S,new a.YieldExpression(E,k))},w.prototype.parseClassElement=function(S){var E=this.lookahead,k=this.createNode(),R="",M=null,L=null,V=!1,H=!1,O=!1,z=!1;if(this.match("*"))this.nextToken();else{V=this.match("["),M=this.parseObjectPropertyKey();var K=M;if(K.name==="static"&&(this.qualifiedPropertyName(this.lookahead)||this.match("*"))&&(E=this.lookahead,O=!0,V=this.match("["),this.match("*")?this.nextToken():M=this.parseObjectPropertyKey()),E.type===3&&!this.hasLineTerminator&&E.value==="async"){var q=this.lookahead.value;q!==":"&&q!=="("&&q!=="*"&&(z=!0,E=this.lookahead,M=this.parseObjectPropertyKey(),E.type===3&&(E.value==="get"||E.value==="set"?this.tolerateUnexpectedToken(E):E.value==="constructor"&&this.tolerateUnexpectedToken(E,s.Messages.ConstructorIsAsync)))}}var Y=this.qualifiedPropertyName(this.lookahead);return E.type===3?E.value==="get"&&Y?(R="get",V=this.match("["),M=this.parseObjectPropertyKey(),this.context.allowYield=!1,L=this.parseGetterMethod()):E.value==="set"&&Y&&(R="set",V=this.match("["),M=this.parseObjectPropertyKey(),L=this.parseSetterMethod()):E.type===7&&E.value==="*"&&Y&&(R="init",V=this.match("["),M=this.parseObjectPropertyKey(),L=this.parseGeneratorMethod(),H=!0),!R&&M&&this.match("(")&&(R="init",L=z?this.parsePropertyMethodAsyncFunction():this.parsePropertyMethodFunction(),H=!0),R||this.throwUnexpectedToken(this.lookahead),R==="init"&&(R="method"),V||(O&&this.isPropertyKey(M,"prototype")&&this.throwUnexpectedToken(E,s.Messages.StaticPrototype),!O&&this.isPropertyKey(M,"constructor")&&((R!=="method"||!H||L&&L.generator)&&this.throwUnexpectedToken(E,s.Messages.ConstructorSpecialMethod),S.value?this.throwUnexpectedToken(E,s.Messages.DuplicateConstructor):S.value=!0,R="constructor")),this.finalize(k,new a.MethodDefinition(M,V,L,R,O))},w.prototype.parseClassElementList=function(){var S=[],E={value:!1};for(this.expect("{");!this.match("}");)this.match(";")?this.nextToken():S.push(this.parseClassElement(E));return this.expect("}"),S},w.prototype.parseClassBody=function(){var S=this.createNode(),E=this.parseClassElementList();return this.finalize(S,new a.ClassBody(E))},w.prototype.parseClassDeclaration=function(S){var E=this.createNode(),k=this.context.strict;this.context.strict=!0,this.expectKeyword("class");var R=S&&this.lookahead.type!==3?null:this.parseVariableIdentifier(),M=null;this.matchKeyword("extends")&&(this.nextToken(),M=this.isolateCoverGrammar(this.parseLeftHandSideExpressionAllowCall));var L=this.parseClassBody();return this.context.strict=k,this.finalize(E,new a.ClassDeclaration(R,M,L))},w.prototype.parseClassExpression=function(){var S=this.createNode(),E=this.context.strict;this.context.strict=!0,this.expectKeyword("class");var k=this.lookahead.type===3?this.parseVariableIdentifier():null,R=null;this.matchKeyword("extends")&&(this.nextToken(),R=this.isolateCoverGrammar(this.parseLeftHandSideExpressionAllowCall));var M=this.parseClassBody();return this.context.strict=E,this.finalize(S,new a.ClassExpression(k,R,M))},w.prototype.parseModule=function(){this.context.strict=!0,this.context.isModule=!0;for(var S=this.createNode(),E=this.parseDirectivePrologues();this.lookahead.type!==2;)E.push(this.parseStatementListItem());return this.finalize(S,new a.Module(E))},w.prototype.parseScript=function(){for(var S=this.createNode(),E=this.parseDirectivePrologues();this.lookahead.type!==2;)E.push(this.parseStatementListItem());return this.finalize(S,new a.Script(E))},w.prototype.parseModuleSpecifier=function(){var S=this.createNode();this.lookahead.type!==8&&this.throwError(s.Messages.InvalidModuleSpecifier);var E=this.nextToken(),k=this.getTokenRaw(E);return this.finalize(S,new a.Literal(E.value,k))},w.prototype.parseImportSpecifier=function(){var S=this.createNode(),E,k;return this.lookahead.type===3?(E=this.parseVariableIdentifier(),k=E,this.matchContextualKeyword("as")&&(this.nextToken(),k=this.parseVariableIdentifier())):(E=this.parseIdentifierName(),k=E,this.matchContextualKeyword("as")?(this.nextToken(),k=this.parseVariableIdentifier()):this.throwUnexpectedToken(this.nextToken())),this.finalize(S,new a.ImportSpecifier(k,E))},w.prototype.parseNamedImports=function(){this.expect("{");for(var S=[];!this.match("}");)S.push(this.parseImportSpecifier()),this.match("}")||this.expect(",");return this.expect("}"),S},w.prototype.parseImportDefaultSpecifier=function(){var S=this.createNode(),E=this.parseIdentifierName();return this.finalize(S,new a.ImportDefaultSpecifier(E))},w.prototype.parseImportNamespaceSpecifier=function(){var S=this.createNode();this.expect("*"),this.matchContextualKeyword("as")||this.throwError(s.Messages.NoAsAfterImportNamespace),this.nextToken();var E=this.parseIdentifierName();return this.finalize(S,new a.ImportNamespaceSpecifier(E))},w.prototype.parseImportDeclaration=function(){this.context.inFunctionBody&&this.throwError(s.Messages.IllegalImportDeclaration);var S=this.createNode();this.expectKeyword("import");var E,k=[];if(this.lookahead.type===8)E=this.parseModuleSpecifier();else{if(this.match("{")?k=k.concat(this.parseNamedImports()):this.match("*")?k.push(this.parseImportNamespaceSpecifier()):this.isIdentifierName(this.lookahead)&&!this.matchKeyword("default")?(k.push(this.parseImportDefaultSpecifier()),this.match(",")&&(this.nextToken(),this.match("*")?k.push(this.parseImportNamespaceSpecifier()):this.match("{")?k=k.concat(this.parseNamedImports()):this.throwUnexpectedToken(this.lookahead))):this.throwUnexpectedToken(this.nextToken()),!this.matchContextualKeyword("from")){var R=this.lookahead.value?s.Messages.UnexpectedToken:s.Messages.MissingFromClause;this.throwError(R,this.lookahead.value)}this.nextToken(),E=this.parseModuleSpecifier()}return this.consumeSemicolon(),this.finalize(S,new a.ImportDeclaration(k,E))},w.prototype.parseExportSpecifier=function(){var S=this.createNode(),E=this.parseIdentifierName(),k=E;return this.matchContextualKeyword("as")&&(this.nextToken(),k=this.parseIdentifierName()),this.finalize(S,new a.ExportSpecifier(E,k))},w.prototype.parseExportDeclaration=function(){this.context.inFunctionBody&&this.throwError(s.Messages.IllegalExportDeclaration);var S=this.createNode();this.expectKeyword("export");var E;if(this.matchKeyword("default"))if(this.nextToken(),this.matchKeyword("function")){var k=this.parseFunctionDeclaration(!0);E=this.finalize(S,new a.ExportDefaultDeclaration(k))}else if(this.matchKeyword("class")){var k=this.parseClassDeclaration(!0);E=this.finalize(S,new a.ExportDefaultDeclaration(k))}else if(this.matchContextualKeyword("async")){var k=this.matchAsyncFunction()?this.parseFunctionDeclaration(!0):this.parseAssignmentExpression();E=this.finalize(S,new a.ExportDefaultDeclaration(k))}else{this.matchContextualKeyword("from")&&this.throwError(s.Messages.UnexpectedToken,this.lookahead.value);var k=this.match("{")?this.parseObjectInitializer():this.match("[")?this.parseArrayInitializer():this.parseAssignmentExpression();this.consumeSemicolon(),E=this.finalize(S,new a.ExportDefaultDeclaration(k))}else if(this.match("*")){if(this.nextToken(),!this.matchContextualKeyword("from")){var R=this.lookahead.value?s.Messages.UnexpectedToken:s.Messages.MissingFromClause;this.throwError(R,this.lookahead.value)}this.nextToken();var M=this.parseModuleSpecifier();this.consumeSemicolon(),E=this.finalize(S,new a.ExportAllDeclaration(M))}else if(this.lookahead.type===4){var k=void 0;switch(this.lookahead.value){case"let":case"const":k=this.parseLexicalDeclaration({inFor:!1});break;case"var":case"class":case"function":k=this.parseStatementListItem();break;default:this.throwUnexpectedToken(this.lookahead)}E=this.finalize(S,new a.ExportNamedDeclaration(k,[],null))}else if(this.matchAsyncFunction()){var k=this.parseFunctionDeclaration();E=this.finalize(S,new a.ExportNamedDeclaration(k,[],null))}else{var L=[],V=null,H=!1;for(this.expect("{");!this.match("}");)H=H||this.matchKeyword("default"),L.push(this.parseExportSpecifier()),this.match("}")||this.expect(",");if(this.expect("}"),this.matchContextualKeyword("from"))this.nextToken(),V=this.parseModuleSpecifier(),this.consumeSemicolon();else if(H){var R=this.lookahead.value?s.Messages.UnexpectedToken:s.Messages.MissingFromClause;this.throwError(R,this.lookahead.value)}else this.consumeSemicolon();E=this.finalize(S,new a.ExportNamedDeclaration(null,L,V))}return E},w}();e.Parser=b},function(c,e){"use strict";function t(i,n){if(!i)throw new Error("ASSERT: "+n)}e.assert=t},function(c,e){"use strict";var t=function(){function i(){this.errors=[],this.tolerant=!1}return i.prototype.recordError=function(n){this.errors.push(n)},i.prototype.tolerate=function(n){if(this.tolerant)this.recordError(n);else throw n},i.prototype.constructError=function(n,s){var a=new Error(n);try{throw a}catch(d){Object.create&&Object.defineProperty&&(a=Object.create(d),Object.defineProperty(a,"column",{value:s}))}return a},i.prototype.createError=function(n,s,a,d){var p="Line "+s+": "+d,f=this.constructError(p,a);return f.index=n,f.lineNumber=s,f.description=d,f},i.prototype.throwError=function(n,s,a,d){throw this.createError(n,s,a,d)},i.prototype.tolerateError=function(n,s,a,d){var p=this.createError(n,s,a,d);if(this.tolerant)this.recordError(p);else throw p},i}();e.ErrorHandler=t},function(c,e){"use strict";e.Messages={BadImportCallArity:"Unexpected token",BadGetterArity:"Getter must not have any formal parameters",BadSetterArity:"Setter must have exactly one formal parameter",BadSetterRestParameter:"Setter function argument must not be a rest parameter",ConstructorIsAsync:"Class constructor may not be an async method",ConstructorSpecialMethod:"Class constructor may not be an accessor",DeclarationMissingInitializer:"Missing initializer in %0 declaration",DefaultRestParameter:"Unexpected token =",DefaultRestProperty:"Unexpected token =",DuplicateBinding:"Duplicate binding %0",DuplicateConstructor:"A class may only have one constructor",DuplicateProtoProperty:"Duplicate __proto__ fields are not allowed in object literals",ForInOfLoopInitializer:"%0 loop variable declaration may not have an initializer",GeneratorInLegacyContext:"Generator declarations are not allowed in legacy contexts",IllegalBreak:"Illegal break statement",IllegalContinue:"Illegal continue statement",IllegalExportDeclaration:"Unexpected token",IllegalImportDeclaration:"Unexpected token",IllegalLanguageModeDirective:"Illegal 'use strict' directive in function with non-simple parameter list",IllegalReturn:"Illegal return statement",InvalidEscapedReservedWord:"Keyword must not contain escaped characters",InvalidHexEscapeSequence:"Invalid hexadecimal escape sequence",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",InvalidLHSInForLoop:"Invalid left-hand side in for-loop",InvalidModuleSpecifier:"Unexpected token",InvalidRegExp:"Invalid regular expression",LetInLexicalBinding:"let is disallowed as a lexically bound name",MissingFromClause:"Unexpected token",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NewlineAfterThrow:"Illegal newline after throw",NoAsAfterImportNamespace:"Unexpected token",NoCatchOrFinally:"Missing catch or finally after try",ParameterAfterRestParameter:"Rest parameter must be last formal parameter",PropertyAfterRestProperty:"Unexpected token",Redeclaration:"%0 '%1' has already been declared",StaticPrototype:"Classes may not have static property named prototype",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictFunction:"In strict mode code, functions can only be declared at top level or inside a block",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictModeWith:"Strict mode code may not include a with statement",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictReservedWord:"Use of future reserved word in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",TemplateOctalLiteral:"Octal literals are not allowed in template strings.",UnexpectedEOS:"Unexpected end of input",UnexpectedIdentifier:"Unexpected identifier",UnexpectedNumber:"Unexpected number",UnexpectedReserved:"Unexpected reserved word",UnexpectedString:"Unexpected string",UnexpectedTemplate:"Unexpected quasi %0",UnexpectedToken:"Unexpected token %0",UnexpectedTokenIllegal:"Unexpected token ILLEGAL",UnknownLabel:"Undefined label '%0'",UnterminatedRegExp:"Invalid regular expression: missing /"}},function(c,e,t){"use strict";var i=t(9),n=t(4),s=t(11);function a(f){return"0123456789abcdef".indexOf(f.toLowerCase())}function d(f){return"01234567".indexOf(f)}var p=function(){function f(_,b){this.source=_,this.errorHandler=b,this.trackComment=!1,this.length=_.length,this.index=0,this.lineNumber=_.length>0?1:0,this.lineStart=0,this.curlyStack=[]}return f.prototype.saveState=function(){return{index:this.index,lineNumber:this.lineNumber,lineStart:this.lineStart}},f.prototype.restoreState=function(_){this.index=_.index,this.lineNumber=_.lineNumber,this.lineStart=_.lineStart},f.prototype.eof=function(){return this.index>=this.length},f.prototype.throwUnexpectedToken=function(_){return _===void 0&&(_=s.Messages.UnexpectedTokenIllegal),this.errorHandler.throwError(this.index,this.lineNumber,this.index-this.lineStart+1,_)},f.prototype.tolerateUnexpectedToken=function(_){_===void 0&&(_=s.Messages.UnexpectedTokenIllegal),this.errorHandler.tolerateError(this.index,this.lineNumber,this.index-this.lineStart+1,_)},f.prototype.skipSingleLineComment=function(_){var b=[],w,S;for(this.trackComment&&(b=[],w=this.index-_,S={start:{line:this.lineNumber,column:this.index-this.lineStart-_},end:{}});!this.eof();){var E=this.source.charCodeAt(this.index);if(++this.index,n.Character.isLineTerminator(E)){if(this.trackComment){S.end={line:this.lineNumber,column:this.index-this.lineStart-1};var k={multiLine:!1,slice:[w+_,this.index-1],range:[w,this.index-1],loc:S};b.push(k)}return E===13&&this.source.charCodeAt(this.index)===10&&++this.index,++this.lineNumber,this.lineStart=this.index,b}}if(this.trackComment){S.end={line:this.lineNumber,column:this.index-this.lineStart};var k={multiLine:!1,slice:[w+_,this.index],range:[w,this.index],loc:S};b.push(k)}return b},f.prototype.skipMultiLineComment=function(){var _=[],b,w;for(this.trackComment&&(_=[],b=this.index-2,w={start:{line:this.lineNumber,column:this.index-this.lineStart-2},end:{}});!this.eof();){var S=this.source.charCodeAt(this.index);if(n.Character.isLineTerminator(S))S===13&&this.source.charCodeAt(this.index+1)===10&&++this.index,++this.lineNumber,++this.index,this.lineStart=this.index;else if(S===42){if(this.source.charCodeAt(this.index+1)===47){if(this.index+=2,this.trackComment){w.end={line:this.lineNumber,column:this.index-this.lineStart};var E={multiLine:!0,slice:[b+2,this.index-2],range:[b,this.index],loc:w};_.push(E)}return _}++this.index}else++this.index}if(this.trackComment){w.end={line:this.lineNumber,column:this.index-this.lineStart};var E={multiLine:!0,slice:[b+2,this.index],range:[b,this.index],loc:w};_.push(E)}return this.tolerateUnexpectedToken(),_},f.prototype.scanComments=function(){var _;this.trackComment&&(_=[]);for(var b=this.index===0;!this.eof();){var w=this.source.charCodeAt(this.index);if(n.Character.isWhiteSpace(w))++this.index;else if(n.Character.isLineTerminator(w))++this.index,w===13&&this.source.charCodeAt(this.index)===10&&++this.index,++this.lineNumber,this.lineStart=this.index,b=!0;else if(w===47)if(w=this.source.charCodeAt(this.index+1),w===47){this.index+=2;var S=this.skipSingleLineComment(2);this.trackComment&&(_=_.concat(S)),b=!0}else if(w===42){this.index+=2;var S=this.skipMultiLineComment();this.trackComment&&(_=_.concat(S))}else break;else if(b&&w===45)if(this.source.charCodeAt(this.index+1)===45&&this.source.charCodeAt(this.index+2)===62){this.index+=3;var S=this.skipSingleLineComment(3);this.trackComment&&(_=_.concat(S))}else break;else if(w===60)if(this.source.slice(this.index+1,this.index+4)==="!--"){this.index+=4;var S=this.skipSingleLineComment(4);this.trackComment&&(_=_.concat(S))}else break;else break}return _},f.prototype.isFutureReservedWord=function(_){switch(_){case"enum":case"export":case"import":case"super":return!0;default:return!1}},f.prototype.isStrictModeReservedWord=function(_){switch(_){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}},f.prototype.isRestrictedWord=function(_){return _==="eval"||_==="arguments"},f.prototype.isKeyword=function(_){switch(_.length){case 2:return _==="if"||_==="in"||_==="do";case 3:return _==="var"||_==="for"||_==="new"||_==="try"||_==="let";case 4:return _==="this"||_==="else"||_==="case"||_==="void"||_==="with"||_==="enum";case 5:return _==="while"||_==="break"||_==="catch"||_==="throw"||_==="const"||_==="yield"||_==="class"||_==="super";case 6:return _==="return"||_==="typeof"||_==="delete"||_==="switch"||_==="export"||_==="import";case 7:return _==="default"||_==="finally"||_==="extends";case 8:return _==="function"||_==="continue"||_==="debugger";case 10:return _==="instanceof";default:return!1}},f.prototype.codePointAt=function(_){var b=this.source.charCodeAt(_);if(b>=55296&&b<=56319){var w=this.source.charCodeAt(_+1);if(w>=56320&&w<=57343){var S=b;b=(S-55296)*1024+w-56320+65536}}return b},f.prototype.scanHexEscape=function(_){for(var b=_==="u"?4:2,w=0,S=0;S<b;++S)if(!this.eof()&&n.Character.isHexDigit(this.source.charCodeAt(this.index)))w=w*16+a(this.source[this.index++]);else return null;return String.fromCharCode(w)},f.prototype.scanUnicodeCodePointEscape=function(){var _=this.source[this.index],b=0;for(_==="}"&&this.throwUnexpectedToken();!this.eof()&&(_=this.source[this.index++],!!n.Character.isHexDigit(_.charCodeAt(0)));)b=b*16+a(_);return(b>1114111||_!=="}")&&this.throwUnexpectedToken(),n.Character.fromCodePoint(b)},f.prototype.getIdentifier=function(){for(var _=this.index++;!this.eof();){var b=this.source.charCodeAt(this.index);if(b===92)return this.index=_,this.getComplexIdentifier();if(b>=55296&&b<57343)return this.index=_,this.getComplexIdentifier();if(n.Character.isIdentifierPart(b))++this.index;else break}return this.source.slice(_,this.index)},f.prototype.getComplexIdentifier=function(){var _=this.codePointAt(this.index),b=n.Character.fromCodePoint(_);this.index+=b.length;var w;for(_===92&&(this.source.charCodeAt(this.index)!==117&&this.throwUnexpectedToken(),++this.index,this.source[this.index]==="{"?(++this.index,w=this.scanUnicodeCodePointEscape()):(w=this.scanHexEscape("u"),(w===null||w==="\\"||!n.Character.isIdentifierStart(w.charCodeAt(0)))&&this.throwUnexpectedToken()),b=w);!this.eof()&&(_=this.codePointAt(this.index),!!n.Character.isIdentifierPart(_));)w=n.Character.fromCodePoint(_),b+=w,this.index+=w.length,_===92&&(b=b.substr(0,b.length-1),this.source.charCodeAt(this.index)!==117&&this.throwUnexpectedToken(),++this.index,this.source[this.index]==="{"?(++this.index,w=this.scanUnicodeCodePointEscape()):(w=this.scanHexEscape("u"),(w===null||w==="\\"||!n.Character.isIdentifierPart(w.charCodeAt(0)))&&this.throwUnexpectedToken()),b+=w);return b},f.prototype.octalToDecimal=function(_){var b=_!=="0",w=d(_);return!this.eof()&&n.Character.isOctalDigit(this.source.charCodeAt(this.index))&&(b=!0,w=w*8+d(this.source[this.index++]),"0123".indexOf(_)>=0&&!this.eof()&&n.Character.isOctalDigit(this.source.charCodeAt(this.index))&&(w=w*8+d(this.source[this.index++]))),{code:w,octal:b}},f.prototype.scanIdentifier=function(){var _,b=this.index,w=this.source.charCodeAt(b)===92?this.getComplexIdentifier():this.getIdentifier();if(w.length===1?_=3:this.isKeyword(w)?_=4:w==="null"?_=5:w==="true"||w==="false"?_=1:_=3,_!==3&&b+w.length!==this.index){var S=this.index;this.index=b,this.tolerateUnexpectedToken(s.Messages.InvalidEscapedReservedWord),this.index=S}return{type:_,value:w,lineNumber:this.lineNumber,lineStart:this.lineStart,start:b,end:this.index}},f.prototype.scanPunctuator=function(){var _=this.index,b=this.source[this.index];switch(b){case"(":case"{":b==="{"&&this.curlyStack.push("{"),++this.index;break;case".":++this.index,this.source[this.index]==="."&&this.source[this.index+1]==="."&&(this.index+=2,b="...");break;case"}":++this.index,this.curlyStack.pop();break;case")":case";":case",":case"[":case"]":case":":case"?":case"~":++this.index;break;default:b=this.source.substr(this.index,4),b===">>>="?this.index+=4:(b=b.substr(0,3),b==="==="||b==="!=="||b===">>>"||b==="<<="||b===">>="||b==="**="?this.index+=3:(b=b.substr(0,2),b==="&&"||b==="||"||b==="=="||b==="!="||b==="+="||b==="-="||b==="*="||b==="/="||b==="++"||b==="--"||b==="<<"||b===">>"||b==="&="||b==="|="||b==="^="||b==="%="||b==="<="||b===">="||b==="=>"||b==="**"?this.index+=2:(b=this.source[this.index],"<>=!+-*%&|^/".indexOf(b)>=0&&++this.index)))}return this.index===_&&this.throwUnexpectedToken(),{type:7,value:b,lineNumber:this.lineNumber,lineStart:this.lineStart,start:_,end:this.index}},f.prototype.scanHexLiteral=function(_){for(var b="";!this.eof()&&n.Character.isHexDigit(this.source.charCodeAt(this.index));)b+=this.source[this.index++];return b.length===0&&this.throwUnexpectedToken(),n.Character.isIdentifierStart(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(),{type:6,value:parseInt("0x"+b,16),lineNumber:this.lineNumber,lineStart:this.lineStart,start:_,end:this.index}},f.prototype.scanBinaryLiteral=function(_){for(var b="",w;!this.eof()&&(w=this.source[this.index],!(w!=="0"&&w!=="1"));)b+=this.source[this.index++];return b.length===0&&this.throwUnexpectedToken(),this.eof()||(w=this.source.charCodeAt(this.index),(n.Character.isIdentifierStart(w)||n.Character.isDecimalDigit(w))&&this.throwUnexpectedToken()),{type:6,value:parseInt(b,2),lineNumber:this.lineNumber,lineStart:this.lineStart,start:_,end:this.index}},f.prototype.scanOctalLiteral=function(_,b){var w="",S=!1;for(n.Character.isOctalDigit(_.charCodeAt(0))?(S=!0,w="0"+this.source[this.index++]):++this.index;!this.eof()&&n.Character.isOctalDigit(this.source.charCodeAt(this.index));)w+=this.source[this.index++];return!S&&w.length===0&&this.throwUnexpectedToken(),(n.Character.isIdentifierStart(this.source.charCodeAt(this.index))||n.Character.isDecimalDigit(this.source.charCodeAt(this.index)))&&this.throwUnexpectedToken(),{type:6,value:parseInt(w,8),octal:S,lineNumber:this.lineNumber,lineStart:this.lineStart,start:b,end:this.index}},f.prototype.isImplicitOctalLiteral=function(){for(var _=this.index+1;_<this.length;++_){var b=this.source[_];if(b==="8"||b==="9")return!1;if(!n.Character.isOctalDigit(b.charCodeAt(0)))return!0}return!0},f.prototype.scanNumericLiteral=function(){var _=this.index,b=this.source[_];i.assert(n.Character.isDecimalDigit(b.charCodeAt(0))||b===".","Numeric literal must start with a decimal digit or a decimal point");var w="";if(b!=="."){if(w=this.source[this.index++],b=this.source[this.index],w==="0"){if(b==="x"||b==="X")return++this.index,this.scanHexLiteral(_);if(b==="b"||b==="B")return++this.index,this.scanBinaryLiteral(_);if(b==="o"||b==="O")return this.scanOctalLiteral(b,_);if(b&&n.Character.isOctalDigit(b.charCodeAt(0))&&this.isImplicitOctalLiteral())return this.scanOctalLiteral(b,_)}for(;n.Character.isDecimalDigit(this.source.charCodeAt(this.index));)w+=this.source[this.index++];b=this.source[this.index]}if(b==="."){for(w+=this.source[this.index++];n.Character.isDecimalDigit(this.source.charCodeAt(this.index));)w+=this.source[this.index++];b=this.source[this.index]}if(b==="e"||b==="E")if(w+=this.source[this.index++],b=this.source[this.index],(b==="+"||b==="-")&&(w+=this.source[this.index++]),n.Character.isDecimalDigit(this.source.charCodeAt(this.index)))for(;n.Character.isDecimalDigit(this.source.charCodeAt(this.index));)w+=this.source[this.index++];else this.throwUnexpectedToken();return n.Character.isIdentifierStart(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(),{type:6,value:parseFloat(w),lineNumber:this.lineNumber,lineStart:this.lineStart,start:_,end:this.index}},f.prototype.scanStringLiteral=function(){var _=this.index,b=this.source[_];i.assert(b==="'"||b==='"',"String literal must starts with a quote"),++this.index;for(var w=!1,S="";!this.eof();){var E=this.source[this.index++];if(E===b){b="";break}else if(E==="\\")if(E=this.source[this.index++],!E||!n.Character.isLineTerminator(E.charCodeAt(0)))switch(E){case"u":if(this.source[this.index]==="{")++this.index,S+=this.scanUnicodeCodePointEscape();else{var k=this.scanHexEscape(E);k===null&&this.throwUnexpectedToken(),S+=k}break;case"x":var R=this.scanHexEscape(E);R===null&&this.throwUnexpectedToken(s.Messages.InvalidHexEscapeSequence),S+=R;break;case"n":S+=`
`;break;case"r":S+="\r";break;case"t":S+="	";break;case"b":S+="\b";break;case"f":S+="\f";break;case"v":S+="\v";break;case"8":case"9":S+=E,this.tolerateUnexpectedToken();break;default:if(E&&n.Character.isOctalDigit(E.charCodeAt(0))){var M=this.octalToDecimal(E);w=M.octal||w,S+=String.fromCharCode(M.code)}else S+=E;break}else++this.lineNumber,E==="\r"&&this.source[this.index]===`
`&&++this.index,this.lineStart=this.index;else{if(n.Character.isLineTerminator(E.charCodeAt(0)))break;S+=E}}return b!==""&&(this.index=_,this.throwUnexpectedToken()),{type:8,value:S,octal:w,lineNumber:this.lineNumber,lineStart:this.lineStart,start:_,end:this.index}},f.prototype.scanTemplate=function(){var _="",b=!1,w=this.index,S=this.source[w]==="`",E=!1,k=2;for(++this.index;!this.eof();){var R=this.source[this.index++];if(R==="`"){k=1,E=!0,b=!0;break}else if(R==="$"){if(this.source[this.index]==="{"){this.curlyStack.push("${"),++this.index,b=!0;break}_+=R}else if(R==="\\")if(R=this.source[this.index++],n.Character.isLineTerminator(R.charCodeAt(0)))++this.lineNumber,R==="\r"&&this.source[this.index]===`
`&&++this.index,this.lineStart=this.index;else switch(R){case"n":_+=`
`;break;case"r":_+="\r";break;case"t":_+="	";break;case"u":if(this.source[this.index]==="{")++this.index,_+=this.scanUnicodeCodePointEscape();else{var M=this.index,L=this.scanHexEscape(R);L!==null?_+=L:(this.index=M,_+=R)}break;case"x":var V=this.scanHexEscape(R);V===null&&this.throwUnexpectedToken(s.Messages.InvalidHexEscapeSequence),_+=V;break;case"b":_+="\b";break;case"f":_+="\f";break;case"v":_+="\v";break;default:R==="0"?(n.Character.isDecimalDigit(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(s.Messages.TemplateOctalLiteral),_+="\0"):n.Character.isOctalDigit(R.charCodeAt(0))?this.throwUnexpectedToken(s.Messages.TemplateOctalLiteral):_+=R;break}else n.Character.isLineTerminator(R.charCodeAt(0))?(++this.lineNumber,R==="\r"&&this.source[this.index]===`
`&&++this.index,this.lineStart=this.index,_+=`
`):_+=R}return b||this.throwUnexpectedToken(),S||this.curlyStack.pop(),{type:10,value:this.source.slice(w+1,this.index-k),cooked:_,head:S,tail:E,lineNumber:this.lineNumber,lineStart:this.lineStart,start:w,end:this.index}},f.prototype.testRegExp=function(_,b){var w="\uFFFF",S=_,E=this;b.indexOf("u")>=0&&(S=S.replace(/\\u\{([0-9a-fA-F]+)\}|\\u([a-fA-F0-9]{4})/g,function(k,R,M){var L=parseInt(R||M,16);return L>1114111&&E.throwUnexpectedToken(s.Messages.InvalidRegExp),L<=65535?String.fromCharCode(L):w}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,w));try{RegExp(S)}catch{this.throwUnexpectedToken(s.Messages.InvalidRegExp)}try{return new RegExp(_,b)}catch{return null}},f.prototype.scanRegExpBody=function(){var _=this.source[this.index];i.assert(_==="/","Regular expression literal must start with a slash");for(var b=this.source[this.index++],w=!1,S=!1;!this.eof();)if(_=this.source[this.index++],b+=_,_==="\\")_=this.source[this.index++],n.Character.isLineTerminator(_.charCodeAt(0))&&this.throwUnexpectedToken(s.Messages.UnterminatedRegExp),b+=_;else if(n.Character.isLineTerminator(_.charCodeAt(0)))this.throwUnexpectedToken(s.Messages.UnterminatedRegExp);else if(w)_==="]"&&(w=!1);else if(_==="/"){S=!0;break}else _==="["&&(w=!0);return S||this.throwUnexpectedToken(s.Messages.UnterminatedRegExp),b.substr(1,b.length-2)},f.prototype.scanRegExpFlags=function(){for(var _="",b="";!this.eof();){var w=this.source[this.index];if(!n.Character.isIdentifierPart(w.charCodeAt(0)))break;if(++this.index,w==="\\"&&!this.eof())if(w=this.source[this.index],w==="u"){++this.index;var S=this.index,E=this.scanHexEscape("u");if(E!==null)for(b+=E,_+="\\u";S<this.index;++S)_+=this.source[S];else this.index=S,b+="u",_+="\\u";this.tolerateUnexpectedToken()}else _+="\\",this.tolerateUnexpectedToken();else b+=w,_+=w}return b},f.prototype.scanRegExp=function(){var _=this.index,b=this.scanRegExpBody(),w=this.scanRegExpFlags(),S=this.testRegExp(b,w);return{type:9,value:"",pattern:b,flags:w,regex:S,lineNumber:this.lineNumber,lineStart:this.lineStart,start:_,end:this.index}},f.prototype.lex=function(){if(this.eof())return{type:2,value:"",lineNumber:this.lineNumber,lineStart:this.lineStart,start:this.index,end:this.index};var _=this.source.charCodeAt(this.index);return n.Character.isIdentifierStart(_)?this.scanIdentifier():_===40||_===41||_===59?this.scanPunctuator():_===39||_===34?this.scanStringLiteral():_===46?n.Character.isDecimalDigit(this.source.charCodeAt(this.index+1))?this.scanNumericLiteral():this.scanPunctuator():n.Character.isDecimalDigit(_)?this.scanNumericLiteral():_===96||_===125&&this.curlyStack[this.curlyStack.length-1]==="${"?this.scanTemplate():_>=55296&&_<57343&&n.Character.isIdentifierStart(this.codePointAt(this.index))?this.scanIdentifier():this.scanPunctuator()},f}();e.Scanner=p},function(c,e){"use strict";e.TokenName={},e.TokenName[1]="Boolean",e.TokenName[2]="<end>",e.TokenName[3]="Identifier",e.TokenName[4]="Keyword",e.TokenName[5]="Null",e.TokenName[6]="Numeric",e.TokenName[7]="Punctuator",e.TokenName[8]="String",e.TokenName[9]="RegularExpression",e.TokenName[10]="Template"},function(c,e){"use strict";e.XHTMLEntities={quot:'"',amp:"&",apos:"'",gt:">",nbsp:"\xA0",iexcl:"\xA1",cent:"\xA2",pound:"\xA3",curren:"\xA4",yen:"\xA5",brvbar:"\xA6",sect:"\xA7",uml:"\xA8",copy:"\xA9",ordf:"\xAA",laquo:"\xAB",not:"\xAC",shy:"\xAD",reg:"\xAE",macr:"\xAF",deg:"\xB0",plusmn:"\xB1",sup2:"\xB2",sup3:"\xB3",acute:"\xB4",micro:"\xB5",para:"\xB6",middot:"\xB7",cedil:"\xB8",sup1:"\xB9",ordm:"\xBA",raquo:"\xBB",frac14:"\xBC",frac12:"\xBD",frac34:"\xBE",iquest:"\xBF",Agrave:"\xC0",Aacute:"\xC1",Acirc:"\xC2",Atilde:"\xC3",Auml:"\xC4",Aring:"\xC5",AElig:"\xC6",Ccedil:"\xC7",Egrave:"\xC8",Eacute:"\xC9",Ecirc:"\xCA",Euml:"\xCB",Igrave:"\xCC",Iacute:"\xCD",Icirc:"\xCE",Iuml:"\xCF",ETH:"\xD0",Ntilde:"\xD1",Ograve:"\xD2",Oacute:"\xD3",Ocirc:"\xD4",Otilde:"\xD5",Ouml:"\xD6",times:"\xD7",Oslash:"\xD8",Ugrave:"\xD9",Uacute:"\xDA",Ucirc:"\xDB",Uuml:"\xDC",Yacute:"\xDD",THORN:"\xDE",szlig:"\xDF",agrave:"\xE0",aacute:"\xE1",acirc:"\xE2",atilde:"\xE3",auml:"\xE4",aring:"\xE5",aelig:"\xE6",ccedil:"\xE7",egrave:"\xE8",eacute:"\xE9",ecirc:"\xEA",euml:"\xEB",igrave:"\xEC",iacute:"\xED",icirc:"\xEE",iuml:"\xEF",eth:"\xF0",ntilde:"\xF1",ograve:"\xF2",oacute:"\xF3",ocirc:"\xF4",otilde:"\xF5",ouml:"\xF6",divide:"\xF7",oslash:"\xF8",ugrave:"\xF9",uacute:"\xFA",ucirc:"\xFB",uuml:"\xFC",yacute:"\xFD",thorn:"\xFE",yuml:"\xFF",OElig:"\u0152",oelig:"\u0153",Scaron:"\u0160",scaron:"\u0161",Yuml:"\u0178",fnof:"\u0192",circ:"\u02C6",tilde:"\u02DC",Alpha:"\u0391",Beta:"\u0392",Gamma:"\u0393",Delta:"\u0394",Epsilon:"\u0395",Zeta:"\u0396",Eta:"\u0397",Theta:"\u0398",Iota:"\u0399",Kappa:"\u039A",Lambda:"\u039B",Mu:"\u039C",Nu:"\u039D",Xi:"\u039E",Omicron:"\u039F",Pi:"\u03A0",Rho:"\u03A1",Sigma:"\u03A3",Tau:"\u03A4",Upsilon:"\u03A5",Phi:"\u03A6",Chi:"\u03A7",Psi:"\u03A8",Omega:"\u03A9",alpha:"\u03B1",beta:"\u03B2",gamma:"\u03B3",delta:"\u03B4",epsilon:"\u03B5",zeta:"\u03B6",eta:"\u03B7",theta:"\u03B8",iota:"\u03B9",kappa:"\u03BA",lambda:"\u03BB",mu:"\u03BC",nu:"\u03BD",xi:"\u03BE",omicron:"\u03BF",pi:"\u03C0",rho:"\u03C1",sigmaf:"\u03C2",sigma:"\u03C3",tau:"\u03C4",upsilon:"\u03C5",phi:"\u03C6",chi:"\u03C7",psi:"\u03C8",omega:"\u03C9",thetasym:"\u03D1",upsih:"\u03D2",piv:"\u03D6",ensp:"\u2002",emsp:"\u2003",thinsp:"\u2009",zwnj:"\u200C",zwj:"\u200D",lrm:"\u200E",rlm:"\u200F",ndash:"\u2013",mdash:"\u2014",lsquo:"\u2018",rsquo:"\u2019",sbquo:"\u201A",ldquo:"\u201C",rdquo:"\u201D",bdquo:"\u201E",dagger:"\u2020",Dagger:"\u2021",bull:"\u2022",hellip:"\u2026",permil:"\u2030",prime:"\u2032",Prime:"\u2033",lsaquo:"\u2039",rsaquo:"\u203A",oline:"\u203E",frasl:"\u2044",euro:"\u20AC",image:"\u2111",weierp:"\u2118",real:"\u211C",trade:"\u2122",alefsym:"\u2135",larr:"\u2190",uarr:"\u2191",rarr:"\u2192",darr:"\u2193",harr:"\u2194",crarr:"\u21B5",lArr:"\u21D0",uArr:"\u21D1",rArr:"\u21D2",dArr:"\u21D3",hArr:"\u21D4",forall:"\u2200",part:"\u2202",exist:"\u2203",empty:"\u2205",nabla:"\u2207",isin:"\u2208",notin:"\u2209",ni:"\u220B",prod:"\u220F",sum:"\u2211",minus:"\u2212",lowast:"\u2217",radic:"\u221A",prop:"\u221D",infin:"\u221E",ang:"\u2220",and:"\u2227",or:"\u2228",cap:"\u2229",cup:"\u222A",int:"\u222B",there4:"\u2234",sim:"\u223C",cong:"\u2245",asymp:"\u2248",ne:"\u2260",equiv:"\u2261",le:"\u2264",ge:"\u2265",sub:"\u2282",sup:"\u2283",nsub:"\u2284",sube:"\u2286",supe:"\u2287",oplus:"\u2295",otimes:"\u2297",perp:"\u22A5",sdot:"\u22C5",lceil:"\u2308",rceil:"\u2309",lfloor:"\u230A",rfloor:"\u230B",loz:"\u25CA",spades:"\u2660",clubs:"\u2663",hearts:"\u2665",diams:"\u2666",lang:"\u27E8",rang:"\u27E9"}},function(c,e,t){"use strict";var i=t(10),n=t(12),s=t(13),a=function(){function p(){this.values=[],this.curly=this.paren=-1}return p.prototype.beforeFunctionExpression=function(f){return["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","**=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","**","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="].indexOf(f)>=0},p.prototype.isRegexStart=function(){var f=this.values[this.values.length-1],_=f!==null;switch(f){case"this":case"]":_=!1;break;case")":var b=this.values[this.paren-1];_=b==="if"||b==="while"||b==="for"||b==="with";break;case"}":if(_=!1,this.values[this.curly-3]==="function"){var w=this.values[this.curly-4];_=w?!this.beforeFunctionExpression(w):!1}else if(this.values[this.curly-4]==="function"){var S=this.values[this.curly-5];_=S?!this.beforeFunctionExpression(S):!0}break;default:break}return _},p.prototype.push=function(f){f.type===7||f.type===4?(f.value==="{"?this.curly=this.values.length:f.value==="("&&(this.paren=this.values.length),this.values.push(f.value)):this.values.push(null)},p}(),d=function(){function p(f,_){this.errorHandler=new i.ErrorHandler,this.errorHandler.tolerant=_?typeof _.tolerant=="boolean"&&_.tolerant:!1,this.scanner=new n.Scanner(f,this.errorHandler),this.scanner.trackComment=_?typeof _.comment=="boolean"&&_.comment:!1,this.trackRange=_?typeof _.range=="boolean"&&_.range:!1,this.trackLoc=_?typeof _.loc=="boolean"&&_.loc:!1,this.buffer=[],this.reader=new a}return p.prototype.errors=function(){return this.errorHandler.errors},p.prototype.getNextToken=function(){if(this.buffer.length===0){var f=this.scanner.scanComments();if(this.scanner.trackComment)for(var _=0;_<f.length;++_){var b=f[_],w=this.scanner.source.slice(b.slice[0],b.slice[1]),S={type:b.multiLine?"BlockComment":"LineComment",value:w};this.trackRange&&(S.range=b.range),this.trackLoc&&(S.loc=b.loc),this.buffer.push(S)}if(!this.scanner.eof()){var E=void 0;this.trackLoc&&(E={start:{line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart},end:{}});var k=void 0;this.scanner.source[this.scanner.index]==="/"?k=this.reader.isRegexStart()?this.scanner.scanRegExp():this.scanner.scanPunctuator():k=this.scanner.lex(),this.reader.push(k);var R={type:s.TokenName[k.type],value:this.scanner.source.slice(k.start,k.end)};if(this.trackRange&&(R.range=[k.start,k.end]),this.trackLoc&&(E.end={line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart},R.loc=E),k.type===9){var M=k.pattern,L=k.flags;R.regex={pattern:M,flags:L}}this.buffer.push(R)}}return this.buffer.shift()},p}();e.Tokenizer=d}])});(function(c,e){typeof exports=="object"&&typeof module<"u"?e(exports):typeof define=="function"&&define.amd?define(["exports"],e):e(c.THREE={})})(this,function(c){"use strict";Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),Number.isInteger===void 0&&(Number.isInteger=function(r){return typeof r=="number"&&isFinite(r)&&Math.floor(r)===r}),Math.sign===void 0&&(Math.sign=function(r){return r<0?-1:r>0?1:+r}),"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),Object.assign===void 0&&function(){Object.assign=function(r){if(r==null)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(r),h=1;h<arguments.length;h++){var u=arguments[h];if(u!=null)for(var g in u)Object.prototype.hasOwnProperty.call(u,g)&&(o[g]=u[g])}return o}}();function e(){}Object.assign(e.prototype,{addEventListener:function(r,o){this._listeners===void 0&&(this._listeners={});var h=this._listeners;h[r]===void 0&&(h[r]=[]),h[r].indexOf(o)===-1&&h[r].push(o)},hasEventListener:function(r,o){if(this._listeners===void 0)return!1;var h=this._listeners;return h[r]!==void 0&&h[r].indexOf(o)!==-1},removeEventListener:function(r,o){if(this._listeners!==void 0){var h=this._listeners,u=h[r];if(u!==void 0){var g=u.indexOf(o);g!==-1&&u.splice(g,1)}}},dispatchEvent:function(r){if(this._listeners!==void 0){var o=this._listeners,h=o[r.type];if(h!==void 0){r.target=this;for(var u=h.slice(0),g=0,y=u.length;g<y;g++)u[g].call(this,r)}}}});var t="94",i={LEFT:0,MIDDLE:1,RIGHT:2},n=0,s=1,a=2,d=3,p=0,f=1,_=0,b=1,w=2,S=0,E=1,k=2,R=1,M=2,L=0,V=1,H=2,O=0,z=1,K=2,q=3,Y=4,se=5,ce=100,le=101,te=102,ve=103,Pe=104,Be=200,qe=201,Ue=202,Ge=203,it=204,lt=205,bt=206,Yt=207,ni=208,ri=209,He=210,ei=0,ui=1,vi=2,Xe=3,bi=4,st=5,De=6,Me=7,Je=0,Ct=1,$e=2,pe=0,ee=1,Ce=2,Lt=3,tt=4,yi=300,sn=301,ki=302,ti=303,On=304,er=305,cr=306,Ye=307,Rt=1e3,xi=1001,Vn=1002,Hi=1003,Nr=1004,Ft=1005,fn=1006,ts=1007,wr=1008,gn=1009,Es=1010,Yn=1011,Le=1012,Ne=1013,et=1014,Gt=1015,Wi=1016,Pr=1017,is=1018,Ia=1019,Ar=1020,Ra=1021,Tr=1022,Dn=1023,xs=1024,oe=1025,ke=Dn,Ze=1026,We=1027,$t=33776,Jt=33777,an=33778,Ki=33779,Rn=35840,tr=35841,Is=35842,ur=35843,Ma=36196,vo=37808,fd=37809,yo=37810,So=37811,ka=37812,Da=37813,gd=37814,Zs=37815,La=37816,bo=37817,Co=37818,ll=37819,_d=37820,ir=37821,dl=2200,qt=2201,wo=2202,Ln=2300,Oi=2301,Ji=2302,ns=2400,_n=2401,Er=2402,un=0,hl=1,To=2,Br=3e3,Eo=3001,xo=3007,vd=3002,cl=3003,yd=3004,Io=3005,Sd=3006,Ro=3200,bd=3201,Na=0,Mo=1,si={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var r=[],o=0;o<256;o++)r[o]=(o<16?"0":"")+o.toString(16);return function(){var u=Math.random()*4294967295|0,g=Math.random()*4294967295|0,y=Math.random()*4294967295|0,T=Math.random()*4294967295|0,I=r[u&255]+r[u>>8&255]+r[u>>16&255]+r[u>>24&255]+"-"+r[g&255]+r[g>>8&255]+"-"+r[g>>16&15|64]+r[g>>24&255]+"-"+r[y&63|128]+r[y>>8&255]+"-"+r[y>>16&255]+r[y>>24&255]+r[T&255]+r[T>>8&255]+r[T>>16&255]+r[T>>24&255];return I.toUpperCase()}}(),clamp:function(r,o,h){return Math.max(o,Math.min(h,r))},euclideanModulo:function(r,o){return(r%o+o)%o},mapLinear:function(r,o,h,u,g){return u+(r-o)*(g-u)/(h-o)},lerp:function(r,o,h){return(1-h)*r+h*o},smoothstep:function(r,o,h){return r<=o?0:r>=h?1:(r=(r-o)/(h-o),r*r*(3-2*r))},smootherstep:function(r,o,h){return r<=o?0:r>=h?1:(r=(r-o)/(h-o),r*r*r*(r*(r*6-15)+10))},randInt:function(r,o){return r+Math.floor(Math.random()*(o-r+1))},randFloat:function(r,o){return r+Math.random()*(o-r)},randFloatSpread:function(r){return r*(.5-Math.random())},degToRad:function(r){return r*si.DEG2RAD},radToDeg:function(r){return r*si.RAD2DEG},isPowerOfTwo:function(r){return(r&r-1)===0&&r!==0},ceilPowerOfTwo:function(r){return Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},floorPowerOfTwo:function(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))}};function rt(r,o){this.x=r||0,this.y=o||0}Object.defineProperties(rt.prototype,{width:{get:function(){return this.x},set:function(r){this.x=r}},height:{get:function(){return this.y},set:function(r){this.y=r}}}),Object.assign(rt.prototype,{isVector2:!0,set:function(r,o){return this.x=r,this.y=o,this},setScalar:function(r){return this.x=r,this.y=r,this},setX:function(r){return this.x=r,this},setY:function(r){return this.y=r,this},setComponent:function(r,o){switch(r){case 0:this.x=o;break;case 1:this.y=o;break;default:throw new Error("index is out of range: "+r)}return this},getComponent:function(r){switch(r){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+r)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(r){return this.x=r.x,this.y=r.y,this},add:function(r,o){return o!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(r,o)):(this.x+=r.x,this.y+=r.y,this)},addScalar:function(r){return this.x+=r,this.y+=r,this},addVectors:function(r,o){return this.x=r.x+o.x,this.y=r.y+o.y,this},addScaledVector:function(r,o){return this.x+=r.x*o,this.y+=r.y*o,this},sub:function(r,o){return o!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(r,o)):(this.x-=r.x,this.y-=r.y,this)},subScalar:function(r){return this.x-=r,this.y-=r,this},subVectors:function(r,o){return this.x=r.x-o.x,this.y=r.y-o.y,this},multiply:function(r){return this.x*=r.x,this.y*=r.y,this},multiplyScalar:function(r){return this.x*=r,this.y*=r,this},divide:function(r){return this.x/=r.x,this.y/=r.y,this},divideScalar:function(r){return this.multiplyScalar(1/r)},applyMatrix3:function(r){var o=this.x,h=this.y,u=r.elements;return this.x=u[0]*o+u[3]*h+u[6],this.y=u[1]*o+u[4]*h+u[7],this},min:function(r){return this.x=Math.min(this.x,r.x),this.y=Math.min(this.y,r.y),this},max:function(r){return this.x=Math.max(this.x,r.x),this.y=Math.max(this.y,r.y),this},clamp:function(r,o){return this.x=Math.max(r.x,Math.min(o.x,this.x)),this.y=Math.max(r.y,Math.min(o.y,this.y)),this},clampScalar:function(){var r=new rt,o=new rt;return function(u,g){return r.set(u,u),o.set(g,g),this.clamp(r,o)}}(),clampLength:function(r,o){var h=this.length();return this.divideScalar(h||1).multiplyScalar(Math.max(r,Math.min(o,h)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(r){return this.x*r.x+this.y*r.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var r=Math.atan2(this.y,this.x);return r<0&&(r+=2*Math.PI),r},distanceTo:function(r){return Math.sqrt(this.distanceToSquared(r))},distanceToSquared:function(r){var o=this.x-r.x,h=this.y-r.y;return o*o+h*h},manhattanDistanceTo:function(r){return Math.abs(this.x-r.x)+Math.abs(this.y-r.y)},setLength:function(r){return this.normalize().multiplyScalar(r)},lerp:function(r,o){return this.x+=(r.x-this.x)*o,this.y+=(r.y-this.y)*o,this},lerpVectors:function(r,o,h){return this.subVectors(o,r).multiplyScalar(h).add(r)},equals:function(r){return r.x===this.x&&r.y===this.y},fromArray:function(r,o){return o===void 0&&(o=0),this.x=r[o],this.y=r[o+1],this},toArray:function(r,o){return r===void 0&&(r=[]),o===void 0&&(o=0),r[o]=this.x,r[o+1]=this.y,r},fromBufferAttribute:function(r,o,h){return h!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=r.getX(o),this.y=r.getY(o),this},rotateAround:function(r,o){var h=Math.cos(o),u=Math.sin(o),g=this.x-r.x,y=this.y-r.y;return this.x=g*h-y*u+r.x,this.y=g*u+y*h+r.y,this}});function Ot(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(Ot.prototype,{isMatrix4:!0,set:function(r,o,h,u,g,y,T,I,D,N,A,B,F,G,j,$){var Z=this.elements;return Z[0]=r,Z[4]=o,Z[8]=h,Z[12]=u,Z[1]=g,Z[5]=y,Z[9]=T,Z[13]=I,Z[2]=D,Z[6]=N,Z[10]=A,Z[14]=B,Z[3]=F,Z[7]=G,Z[11]=j,Z[15]=$,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new Ot().fromArray(this.elements)},copy:function(r){var o=this.elements,h=r.elements;return o[0]=h[0],o[1]=h[1],o[2]=h[2],o[3]=h[3],o[4]=h[4],o[5]=h[5],o[6]=h[6],o[7]=h[7],o[8]=h[8],o[9]=h[9],o[10]=h[10],o[11]=h[11],o[12]=h[12],o[13]=h[13],o[14]=h[14],o[15]=h[15],this},copyPosition:function(r){var o=this.elements,h=r.elements;return o[12]=h[12],o[13]=h[13],o[14]=h[14],this},extractBasis:function(r,o,h){return r.setFromMatrixColumn(this,0),o.setFromMatrixColumn(this,1),h.setFromMatrixColumn(this,2),this},makeBasis:function(r,o,h){return this.set(r.x,o.x,h.x,0,r.y,o.y,h.y,0,r.z,o.z,h.z,0,0,0,0,1),this},extractRotation:function(){var r=new he;return function(h){var u=this.elements,g=h.elements,y=1/r.setFromMatrixColumn(h,0).length(),T=1/r.setFromMatrixColumn(h,1).length(),I=1/r.setFromMatrixColumn(h,2).length();return u[0]=g[0]*y,u[1]=g[1]*y,u[2]=g[2]*y,u[3]=0,u[4]=g[4]*T,u[5]=g[5]*T,u[6]=g[6]*T,u[7]=0,u[8]=g[8]*I,u[9]=g[9]*I,u[10]=g[10]*I,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,this}}(),makeRotationFromEuler:function(r){r&&r.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var o=this.elements,h=r.x,u=r.y,g=r.z,y=Math.cos(h),T=Math.sin(h),I=Math.cos(u),D=Math.sin(u),N=Math.cos(g),A=Math.sin(g);if(r.order==="XYZ"){var B=y*N,F=y*A,G=T*N,j=T*A;o[0]=I*N,o[4]=-I*A,o[8]=D,o[1]=F+G*D,o[5]=B-j*D,o[9]=-T*I,o[2]=j-B*D,o[6]=G+F*D,o[10]=y*I}else if(r.order==="YXZ"){var $=I*N,Z=I*A,Q=D*N,ie=D*A;o[0]=$+ie*T,o[4]=Q*T-Z,o[8]=y*D,o[1]=y*A,o[5]=y*N,o[9]=-T,o[2]=Z*T-Q,o[6]=ie+$*T,o[10]=y*I}else if(r.order==="ZXY"){var $=I*N,Z=I*A,Q=D*N,ie=D*A;o[0]=$-ie*T,o[4]=-y*A,o[8]=Q+Z*T,o[1]=Z+Q*T,o[5]=y*N,o[9]=ie-$*T,o[2]=-y*D,o[6]=T,o[10]=y*I}else if(r.order==="ZYX"){var B=y*N,F=y*A,G=T*N,j=T*A;o[0]=I*N,o[4]=G*D-F,o[8]=B*D+j,o[1]=I*A,o[5]=j*D+B,o[9]=F*D-G,o[2]=-D,o[6]=T*I,o[10]=y*I}else if(r.order==="YZX"){var ne=y*I,ae=y*D,ye=T*I,ge=T*D;o[0]=I*N,o[4]=ge-ne*A,o[8]=ye*A+ae,o[1]=A,o[5]=y*N,o[9]=-T*N,o[2]=-D*N,o[6]=ae*A+ye,o[10]=ne-ge*A}else if(r.order==="XZY"){var ne=y*I,ae=y*D,ye=T*I,ge=T*D;o[0]=I*N,o[4]=-A,o[8]=D*N,o[1]=ne*A+ge,o[5]=y*N,o[9]=ae*A-ye,o[2]=ye*A-ae,o[6]=T*N,o[10]=ge*A+ne}return o[3]=0,o[7]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,this},makeRotationFromQuaternion:function(){var r=new he(0,0,0),o=new he(1,1,1);return function(u){return this.compose(r,u,o)}}(),lookAt:function(){var r=new he,o=new he,h=new he;return function(g,y,T){var I=this.elements;return h.subVectors(g,y),h.lengthSq()===0&&(h.z=1),h.normalize(),r.crossVectors(T,h),r.lengthSq()===0&&(Math.abs(T.z)===1?h.x+=1e-4:h.z+=1e-4,h.normalize(),r.crossVectors(T,h)),r.normalize(),o.crossVectors(h,r),I[0]=r.x,I[4]=o.x,I[8]=h.x,I[1]=r.y,I[5]=o.y,I[9]=h.y,I[2]=r.z,I[6]=o.z,I[10]=h.z,this}}(),multiply:function(r,o){return o!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(r,o)):this.multiplyMatrices(this,r)},premultiply:function(r){return this.multiplyMatrices(r,this)},multiplyMatrices:function(r,o){var h=r.elements,u=o.elements,g=this.elements,y=h[0],T=h[4],I=h[8],D=h[12],N=h[1],A=h[5],B=h[9],F=h[13],G=h[2],j=h[6],$=h[10],Z=h[14],Q=h[3],ie=h[7],ne=h[11],ae=h[15],ye=u[0],ge=u[4],be=u[8],Ee=u[12],Se=u[1],Re=u[5],Ie=u[9],Ve=u[13],ot=u[2],ct=u[6],pt=u[10],yt=u[14],ue=u[3],fe=u[7],je=u[11],Fe=u[15];return g[0]=y*ye+T*Se+I*ot+D*ue,g[4]=y*ge+T*Re+I*ct+D*fe,g[8]=y*be+T*Ie+I*pt+D*je,g[12]=y*Ee+T*Ve+I*yt+D*Fe,g[1]=N*ye+A*Se+B*ot+F*ue,g[5]=N*ge+A*Re+B*ct+F*fe,g[9]=N*be+A*Ie+B*pt+F*je,g[13]=N*Ee+A*Ve+B*yt+F*Fe,g[2]=G*ye+j*Se+$*ot+Z*ue,g[6]=G*ge+j*Re+$*ct+Z*fe,g[10]=G*be+j*Ie+$*pt+Z*je,g[14]=G*Ee+j*Ve+$*yt+Z*Fe,g[3]=Q*ye+ie*Se+ne*ot+ae*ue,g[7]=Q*ge+ie*Re+ne*ct+ae*fe,g[11]=Q*be+ie*Ie+ne*pt+ae*je,g[15]=Q*Ee+ie*Ve+ne*yt+ae*Fe,this},multiplyScalar:function(r){var o=this.elements;return o[0]*=r,o[4]*=r,o[8]*=r,o[12]*=r,o[1]*=r,o[5]*=r,o[9]*=r,o[13]*=r,o[2]*=r,o[6]*=r,o[10]*=r,o[14]*=r,o[3]*=r,o[7]*=r,o[11]*=r,o[15]*=r,this},applyToBufferAttribute:function(){var r=new he;return function(h){for(var u=0,g=h.count;u<g;u++)r.x=h.getX(u),r.y=h.getY(u),r.z=h.getZ(u),r.applyMatrix4(this),h.setXYZ(u,r.x,r.y,r.z);return h}}(),determinant:function(){var r=this.elements,o=r[0],h=r[4],u=r[8],g=r[12],y=r[1],T=r[5],I=r[9],D=r[13],N=r[2],A=r[6],B=r[10],F=r[14],G=r[3],j=r[7],$=r[11],Z=r[15];return G*(+g*I*A-u*D*A-g*T*B+h*D*B+u*T*F-h*I*F)+j*(+o*I*F-o*D*B+g*y*B-u*y*F+u*D*N-g*I*N)+$*(+o*D*A-o*T*F-g*y*A+h*y*F+g*T*N-h*D*N)+Z*(-u*T*N-o*I*A+o*T*B+u*y*A-h*y*B+h*I*N)},transpose:function(){var r=this.elements,o;return o=r[1],r[1]=r[4],r[4]=o,o=r[2],r[2]=r[8],r[8]=o,o=r[6],r[6]=r[9],r[9]=o,o=r[3],r[3]=r[12],r[12]=o,o=r[7],r[7]=r[13],r[13]=o,o=r[11],r[11]=r[14],r[14]=o,this},setPosition:function(r){var o=this.elements;return o[12]=r.x,o[13]=r.y,o[14]=r.z,this},getInverse:function(r,o){var h=this.elements,u=r.elements,g=u[0],y=u[1],T=u[2],I=u[3],D=u[4],N=u[5],A=u[6],B=u[7],F=u[8],G=u[9],j=u[10],$=u[11],Z=u[12],Q=u[13],ie=u[14],ne=u[15],ae=G*ie*B-Q*j*B+Q*A*$-N*ie*$-G*A*ne+N*j*ne,ye=Z*j*B-F*ie*B-Z*A*$+D*ie*$+F*A*ne-D*j*ne,ge=F*Q*B-Z*G*B+Z*N*$-D*Q*$-F*N*ne+D*G*ne,be=Z*G*A-F*Q*A-Z*N*j+D*Q*j+F*N*ie-D*G*ie,Ee=g*ae+y*ye+T*ge+I*be;if(Ee===0){var Se="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(o===!0)throw new Error(Se);return console.warn(Se),this.identity()}var Re=1/Ee;return h[0]=ae*Re,h[1]=(Q*j*I-G*ie*I-Q*T*$+y*ie*$+G*T*ne-y*j*ne)*Re,h[2]=(N*ie*I-Q*A*I+Q*T*B-y*ie*B-N*T*ne+y*A*ne)*Re,h[3]=(G*A*I-N*j*I-G*T*B+y*j*B+N*T*$-y*A*$)*Re,h[4]=ye*Re,h[5]=(F*ie*I-Z*j*I+Z*T*$-g*ie*$-F*T*ne+g*j*ne)*Re,h[6]=(Z*A*I-D*ie*I-Z*T*B+g*ie*B+D*T*ne-g*A*ne)*Re,h[7]=(D*j*I-F*A*I+F*T*B-g*j*B-D*T*$+g*A*$)*Re,h[8]=ge*Re,h[9]=(Z*G*I-F*Q*I-Z*y*$+g*Q*$+F*y*ne-g*G*ne)*Re,h[10]=(D*Q*I-Z*N*I+Z*y*B-g*Q*B-D*y*ne+g*N*ne)*Re,h[11]=(F*N*I-D*G*I-F*y*B+g*G*B+D*y*$-g*N*$)*Re,h[12]=be*Re,h[13]=(F*Q*T-Z*G*T+Z*y*j-g*Q*j-F*y*ie+g*G*ie)*Re,h[14]=(Z*N*T-D*Q*T-Z*y*A+g*Q*A+D*y*ie-g*N*ie)*Re,h[15]=(D*G*T-F*N*T+F*y*A-g*G*A-D*y*j+g*N*j)*Re,this},scale:function(r){var o=this.elements,h=r.x,u=r.y,g=r.z;return o[0]*=h,o[4]*=u,o[8]*=g,o[1]*=h,o[5]*=u,o[9]*=g,o[2]*=h,o[6]*=u,o[10]*=g,o[3]*=h,o[7]*=u,o[11]*=g,this},getMaxScaleOnAxis:function(){var r=this.elements,o=r[0]*r[0]+r[1]*r[1]+r[2]*r[2],h=r[4]*r[4]+r[5]*r[5]+r[6]*r[6],u=r[8]*r[8]+r[9]*r[9]+r[10]*r[10];return Math.sqrt(Math.max(o,h,u))},makeTranslation:function(r,o,h){return this.set(1,0,0,r,0,1,0,o,0,0,1,h,0,0,0,1),this},makeRotationX:function(r){var o=Math.cos(r),h=Math.sin(r);return this.set(1,0,0,0,0,o,-h,0,0,h,o,0,0,0,0,1),this},makeRotationY:function(r){var o=Math.cos(r),h=Math.sin(r);return this.set(o,0,h,0,0,1,0,0,-h,0,o,0,0,0,0,1),this},makeRotationZ:function(r){var o=Math.cos(r),h=Math.sin(r);return this.set(o,-h,0,0,h,o,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(r,o){var h=Math.cos(o),u=Math.sin(o),g=1-h,y=r.x,T=r.y,I=r.z,D=g*y,N=g*T;return this.set(D*y+h,D*T-u*I,D*I+u*T,0,D*T+u*I,N*T+h,N*I-u*y,0,D*I-u*T,N*I+u*y,g*I*I+h,0,0,0,0,1),this},makeScale:function(r,o,h){return this.set(r,0,0,0,0,o,0,0,0,0,h,0,0,0,0,1),this},makeShear:function(r,o,h){return this.set(1,o,h,0,r,1,h,0,r,o,1,0,0,0,0,1),this},compose:function(r,o,h){var u=this.elements,g=o._x,y=o._y,T=o._z,I=o._w,D=g+g,N=y+y,A=T+T,B=g*D,F=g*N,G=g*A,j=y*N,$=y*A,Z=T*A,Q=I*D,ie=I*N,ne=I*A,ae=h.x,ye=h.y,ge=h.z;return u[0]=(1-(j+Z))*ae,u[1]=(F+ne)*ae,u[2]=(G-ie)*ae,u[3]=0,u[4]=(F-ne)*ye,u[5]=(1-(B+Z))*ye,u[6]=($+Q)*ye,u[7]=0,u[8]=(G+ie)*ge,u[9]=($-Q)*ge,u[10]=(1-(B+j))*ge,u[11]=0,u[12]=r.x,u[13]=r.y,u[14]=r.z,u[15]=1,this},decompose:function(){var r=new he,o=new Ot;return function(u,g,y){var T=this.elements,I=r.set(T[0],T[1],T[2]).length(),D=r.set(T[4],T[5],T[6]).length(),N=r.set(T[8],T[9],T[10]).length(),A=this.determinant();A<0&&(I=-I),u.x=T[12],u.y=T[13],u.z=T[14],o.copy(this);var B=1/I,F=1/D,G=1/N;return o.elements[0]*=B,o.elements[1]*=B,o.elements[2]*=B,o.elements[4]*=F,o.elements[5]*=F,o.elements[6]*=F,o.elements[8]*=G,o.elements[9]*=G,o.elements[10]*=G,g.setFromRotationMatrix(o),y.x=I,y.y=D,y.z=N,this}}(),makePerspective:function(r,o,h,u,g,y){y===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var T=this.elements,I=2*g/(o-r),D=2*g/(h-u),N=(o+r)/(o-r),A=(h+u)/(h-u),B=-(y+g)/(y-g),F=-2*y*g/(y-g);return T[0]=I,T[4]=0,T[8]=N,T[12]=0,T[1]=0,T[5]=D,T[9]=A,T[13]=0,T[2]=0,T[6]=0,T[10]=B,T[14]=F,T[3]=0,T[7]=0,T[11]=-1,T[15]=0,this},makeOrthographic:function(r,o,h,u,g,y){var T=this.elements,I=1/(o-r),D=1/(h-u),N=1/(y-g),A=(o+r)*I,B=(h+u)*D,F=(y+g)*N;return T[0]=2*I,T[4]=0,T[8]=0,T[12]=-A,T[1]=0,T[5]=2*D,T[9]=0,T[13]=-B,T[2]=0,T[6]=0,T[10]=-2*N,T[14]=-F,T[3]=0,T[7]=0,T[11]=0,T[15]=1,this},equals:function(r){for(var o=this.elements,h=r.elements,u=0;u<16;u++)if(o[u]!==h[u])return!1;return!0},fromArray:function(r,o){o===void 0&&(o=0);for(var h=0;h<16;h++)this.elements[h]=r[h+o];return this},toArray:function(r,o){r===void 0&&(r=[]),o===void 0&&(o=0);var h=this.elements;return r[o]=h[0],r[o+1]=h[1],r[o+2]=h[2],r[o+3]=h[3],r[o+4]=h[4],r[o+5]=h[5],r[o+6]=h[6],r[o+7]=h[7],r[o+8]=h[8],r[o+9]=h[9],r[o+10]=h[10],r[o+11]=h[11],r[o+12]=h[12],r[o+13]=h[13],r[o+14]=h[14],r[o+15]=h[15],r}});function en(r,o,h,u){this._x=r||0,this._y=o||0,this._z=h||0,this._w=u!==void 0?u:1}Object.assign(en,{slerp:function(r,o,h,u){return h.copy(r).slerp(o,u)},slerpFlat:function(r,o,h,u,g,y,T){var I=h[u+0],D=h[u+1],N=h[u+2],A=h[u+3],B=g[y+0],F=g[y+1],G=g[y+2],j=g[y+3];if(A!==j||I!==B||D!==F||N!==G){var $=1-T,Z=I*B+D*F+N*G+A*j,Q=Z>=0?1:-1,ie=1-Z*Z;if(ie>Number.EPSILON){var ne=Math.sqrt(ie),ae=Math.atan2(ne,Z*Q);$=Math.sin($*ae)/ne,T=Math.sin(T*ae)/ne}var ye=T*Q;if(I=I*$+B*ye,D=D*$+F*ye,N=N*$+G*ye,A=A*$+j*ye,$===1-T){var ge=1/Math.sqrt(I*I+D*D+N*N+A*A);I*=ge,D*=ge,N*=ge,A*=ge}}r[o]=I,r[o+1]=D,r[o+2]=N,r[o+3]=A}}),Object.defineProperties(en.prototype,{x:{get:function(){return this._x},set:function(r){this._x=r,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(r){this._y=r,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(r){this._z=r,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(r){this._w=r,this.onChangeCallback()}}}),Object.assign(en.prototype,{set:function(r,o,h,u){return this._x=r,this._y=o,this._z=h,this._w=u,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(r){return this._x=r.x,this._y=r.y,this._z=r.z,this._w=r.w,this.onChangeCallback(),this},setFromEuler:function(r,o){if(!(r&&r.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var h=r._x,u=r._y,g=r._z,y=r.order,T=Math.cos,I=Math.sin,D=T(h/2),N=T(u/2),A=T(g/2),B=I(h/2),F=I(u/2),G=I(g/2);return y==="XYZ"?(this._x=B*N*A+D*F*G,this._y=D*F*A-B*N*G,this._z=D*N*G+B*F*A,this._w=D*N*A-B*F*G):y==="YXZ"?(this._x=B*N*A+D*F*G,this._y=D*F*A-B*N*G,this._z=D*N*G-B*F*A,this._w=D*N*A+B*F*G):y==="ZXY"?(this._x=B*N*A-D*F*G,this._y=D*F*A+B*N*G,this._z=D*N*G+B*F*A,this._w=D*N*A-B*F*G):y==="ZYX"?(this._x=B*N*A-D*F*G,this._y=D*F*A+B*N*G,this._z=D*N*G-B*F*A,this._w=D*N*A+B*F*G):y==="YZX"?(this._x=B*N*A+D*F*G,this._y=D*F*A+B*N*G,this._z=D*N*G-B*F*A,this._w=D*N*A-B*F*G):y==="XZY"&&(this._x=B*N*A-D*F*G,this._y=D*F*A-B*N*G,this._z=D*N*G+B*F*A,this._w=D*N*A+B*F*G),o!==!1&&this.onChangeCallback(),this},setFromAxisAngle:function(r,o){var h=o/2,u=Math.sin(h);return this._x=r.x*u,this._y=r.y*u,this._z=r.z*u,this._w=Math.cos(h),this.onChangeCallback(),this},setFromRotationMatrix:function(r){var o=r.elements,h=o[0],u=o[4],g=o[8],y=o[1],T=o[5],I=o[9],D=o[2],N=o[6],A=o[10],B=h+T+A,F;return B>0?(F=.5/Math.sqrt(B+1),this._w=.25/F,this._x=(N-I)*F,this._y=(g-D)*F,this._z=(y-u)*F):h>T&&h>A?(F=2*Math.sqrt(1+h-T-A),this._w=(N-I)/F,this._x=.25*F,this._y=(u+y)/F,this._z=(g+D)/F):T>A?(F=2*Math.sqrt(1+T-h-A),this._w=(g-D)/F,this._x=(u+y)/F,this._y=.25*F,this._z=(I+N)/F):(F=2*Math.sqrt(1+A-h-T),this._w=(y-u)/F,this._x=(g+D)/F,this._y=(I+N)/F,this._z=.25*F),this.onChangeCallback(),this},setFromUnitVectors:function(){var r=new he,o,h=1e-6;return function(g,y){return r===void 0&&(r=new he),o=g.dot(y)+1,o<h?(o=0,Math.abs(g.x)>Math.abs(g.z)?r.set(-g.y,g.x,0):r.set(0,-g.z,g.y)):r.crossVectors(g,y),this._x=r.x,this._y=r.y,this._z=r.z,this._w=o,this.normalize()}}(),inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(r){return this._x*r._x+this._y*r._y+this._z*r._z+this._w*r._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var r=this.length();return r===0?(this._x=0,this._y=0,this._z=0,this._w=1):(r=1/r,this._x=this._x*r,this._y=this._y*r,this._z=this._z*r,this._w=this._w*r),this.onChangeCallback(),this},multiply:function(r,o){return o!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(r,o)):this.multiplyQuaternions(this,r)},premultiply:function(r){return this.multiplyQuaternions(r,this)},multiplyQuaternions:function(r,o){var h=r._x,u=r._y,g=r._z,y=r._w,T=o._x,I=o._y,D=o._z,N=o._w;return this._x=h*N+y*T+u*D-g*I,this._y=u*N+y*I+g*T-h*D,this._z=g*N+y*D+h*I-u*T,this._w=y*N-h*T-u*I-g*D,this.onChangeCallback(),this},slerp:function(r,o){if(o===0)return this;if(o===1)return this.copy(r);var h=this._x,u=this._y,g=this._z,y=this._w,T=y*r._w+h*r._x+u*r._y+g*r._z;if(T<0?(this._w=-r._w,this._x=-r._x,this._y=-r._y,this._z=-r._z,T=-T):this.copy(r),T>=1)return this._w=y,this._x=h,this._y=u,this._z=g,this;var I=1-T*T;if(I<=Number.EPSILON){var D=1-o;return this._w=D*y+o*this._w,this._x=D*h+o*this._x,this._y=D*u+o*this._y,this._z=D*g+o*this._z,this.normalize()}var N=Math.sqrt(I),A=Math.atan2(N,T),B=Math.sin((1-o)*A)/N,F=Math.sin(o*A)/N;return this._w=y*B+this._w*F,this._x=h*B+this._x*F,this._y=u*B+this._y*F,this._z=g*B+this._z*F,this.onChangeCallback(),this},equals:function(r){return r._x===this._x&&r._y===this._y&&r._z===this._z&&r._w===this._w},fromArray:function(r,o){return o===void 0&&(o=0),this._x=r[o],this._y=r[o+1],this._z=r[o+2],this._w=r[o+3],this.onChangeCallback(),this},toArray:function(r,o){return r===void 0&&(r=[]),o===void 0&&(o=0),r[o]=this._x,r[o+1]=this._y,r[o+2]=this._z,r[o+3]=this._w,r},onChange:function(r){return this.onChangeCallback=r,this},onChangeCallback:function(){}});function he(r,o,h){this.x=r||0,this.y=o||0,this.z=h||0}Object.assign(he.prototype,{isVector3:!0,set:function(r,o,h){return this.x=r,this.y=o,this.z=h,this},setScalar:function(r){return this.x=r,this.y=r,this.z=r,this},setX:function(r){return this.x=r,this},setY:function(r){return this.y=r,this},setZ:function(r){return this.z=r,this},setComponent:function(r,o){switch(r){case 0:this.x=o;break;case 1:this.y=o;break;case 2:this.z=o;break;default:throw new Error("index is out of range: "+r)}return this},getComponent:function(r){switch(r){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+r)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(r){return this.x=r.x,this.y=r.y,this.z=r.z,this},add:function(r,o){return o!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(r,o)):(this.x+=r.x,this.y+=r.y,this.z+=r.z,this)},addScalar:function(r){return this.x+=r,this.y+=r,this.z+=r,this},addVectors:function(r,o){return this.x=r.x+o.x,this.y=r.y+o.y,this.z=r.z+o.z,this},addScaledVector:function(r,o){return this.x+=r.x*o,this.y+=r.y*o,this.z+=r.z*o,this},sub:function(r,o){return o!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(r,o)):(this.x-=r.x,this.y-=r.y,this.z-=r.z,this)},subScalar:function(r){return this.x-=r,this.y-=r,this.z-=r,this},subVectors:function(r,o){return this.x=r.x-o.x,this.y=r.y-o.y,this.z=r.z-o.z,this},multiply:function(r,o){return o!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(r,o)):(this.x*=r.x,this.y*=r.y,this.z*=r.z,this)},multiplyScalar:function(r){return this.x*=r,this.y*=r,this.z*=r,this},multiplyVectors:function(r,o){return this.x=r.x*o.x,this.y=r.y*o.y,this.z=r.z*o.z,this},applyEuler:function(){var r=new en;return function(h){return h&&h.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(r.setFromEuler(h))}}(),applyAxisAngle:function(){var r=new en;return function(h,u){return this.applyQuaternion(r.setFromAxisAngle(h,u))}}(),applyMatrix3:function(r){var o=this.x,h=this.y,u=this.z,g=r.elements;return this.x=g[0]*o+g[3]*h+g[6]*u,this.y=g[1]*o+g[4]*h+g[7]*u,this.z=g[2]*o+g[5]*h+g[8]*u,this},applyMatrix4:function(r){var o=this.x,h=this.y,u=this.z,g=r.elements,y=1/(g[3]*o+g[7]*h+g[11]*u+g[15]);return this.x=(g[0]*o+g[4]*h+g[8]*u+g[12])*y,this.y=(g[1]*o+g[5]*h+g[9]*u+g[13])*y,this.z=(g[2]*o+g[6]*h+g[10]*u+g[14])*y,this},applyQuaternion:function(r){var o=this.x,h=this.y,u=this.z,g=r.x,y=r.y,T=r.z,I=r.w,D=I*o+y*u-T*h,N=I*h+T*o-g*u,A=I*u+g*h-y*o,B=-g*o-y*h-T*u;return this.x=D*I+B*-g+N*-T-A*-y,this.y=N*I+B*-y+A*-g-D*-T,this.z=A*I+B*-T+D*-y-N*-g,this},project:function(){var r=new Ot;return function(h){return r.multiplyMatrices(h.projectionMatrix,r.getInverse(h.matrixWorld)),this.applyMatrix4(r)}}(),unproject:function(){var r=new Ot;return function(h){return r.multiplyMatrices(h.matrixWorld,r.getInverse(h.projectionMatrix)),this.applyMatrix4(r)}}(),transformDirection:function(r){var o=this.x,h=this.y,u=this.z,g=r.elements;return this.x=g[0]*o+g[4]*h+g[8]*u,this.y=g[1]*o+g[5]*h+g[9]*u,this.z=g[2]*o+g[6]*h+g[10]*u,this.normalize()},divide:function(r){return this.x/=r.x,this.y/=r.y,this.z/=r.z,this},divideScalar:function(r){return this.multiplyScalar(1/r)},min:function(r){return this.x=Math.min(this.x,r.x),this.y=Math.min(this.y,r.y),this.z=Math.min(this.z,r.z),this},max:function(r){return this.x=Math.max(this.x,r.x),this.y=Math.max(this.y,r.y),this.z=Math.max(this.z,r.z),this},clamp:function(r,o){return this.x=Math.max(r.x,Math.min(o.x,this.x)),this.y=Math.max(r.y,Math.min(o.y,this.y)),this.z=Math.max(r.z,Math.min(o.z,this.z)),this},clampScalar:function(){var r=new he,o=new he;return function(u,g){return r.set(u,u,u),o.set(g,g,g),this.clamp(r,o)}}(),clampLength:function(r,o){var h=this.length();return this.divideScalar(h||1).multiplyScalar(Math.max(r,Math.min(o,h)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(r){return this.x*r.x+this.y*r.y+this.z*r.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(r){return this.normalize().multiplyScalar(r)},lerp:function(r,o){return this.x+=(r.x-this.x)*o,this.y+=(r.y-this.y)*o,this.z+=(r.z-this.z)*o,this},lerpVectors:function(r,o,h){return this.subVectors(o,r).multiplyScalar(h).add(r)},cross:function(r,o){return o!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(r,o)):this.crossVectors(this,r)},crossVectors:function(r,o){var h=r.x,u=r.y,g=r.z,y=o.x,T=o.y,I=o.z;return this.x=u*I-g*T,this.y=g*y-h*I,this.z=h*T-u*y,this},projectOnVector:function(r){var o=r.dot(this)/r.lengthSq();return this.copy(r).multiplyScalar(o)},projectOnPlane:function(){var r=new he;return function(h){return r.copy(this).projectOnVector(h),this.sub(r)}}(),reflect:function(){var r=new he;return function(h){return this.sub(r.copy(h).multiplyScalar(2*this.dot(h)))}}(),angleTo:function(r){var o=this.dot(r)/Math.sqrt(this.lengthSq()*r.lengthSq());return Math.acos(si.clamp(o,-1,1))},distanceTo:function(r){return Math.sqrt(this.distanceToSquared(r))},distanceToSquared:function(r){var o=this.x-r.x,h=this.y-r.y,u=this.z-r.z;return o*o+h*h+u*u},manhattanDistanceTo:function(r){return Math.abs(this.x-r.x)+Math.abs(this.y-r.y)+Math.abs(this.z-r.z)},setFromSpherical:function(r){var o=Math.sin(r.phi)*r.radius;return this.x=o*Math.sin(r.theta),this.y=Math.cos(r.phi)*r.radius,this.z=o*Math.cos(r.theta),this},setFromCylindrical:function(r){return this.x=r.radius*Math.sin(r.theta),this.y=r.y,this.z=r.radius*Math.cos(r.theta),this},setFromMatrixPosition:function(r){var o=r.elements;return this.x=o[12],this.y=o[13],this.z=o[14],this},setFromMatrixScale:function(r){var o=this.setFromMatrixColumn(r,0).length(),h=this.setFromMatrixColumn(r,1).length(),u=this.setFromMatrixColumn(r,2).length();return this.x=o,this.y=h,this.z=u,this},setFromMatrixColumn:function(r,o){return this.fromArray(r.elements,o*4)},equals:function(r){return r.x===this.x&&r.y===this.y&&r.z===this.z},fromArray:function(r,o){return o===void 0&&(o=0),this.x=r[o],this.y=r[o+1],this.z=r[o+2],this},toArray:function(r,o){return r===void 0&&(r=[]),o===void 0&&(o=0),r[o]=this.x,r[o+1]=this.y,r[o+2]=this.z,r},fromBufferAttribute:function(r,o,h){return h!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=r.getX(o),this.y=r.getY(o),this.z=r.getZ(o),this}});function wn(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.assign(wn.prototype,{isMatrix3:!0,set:function(r,o,h,u,g,y,T,I,D){var N=this.elements;return N[0]=r,N[1]=u,N[2]=T,N[3]=o,N[4]=g,N[5]=I,N[6]=h,N[7]=y,N[8]=D,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(r){var o=this.elements,h=r.elements;return o[0]=h[0],o[1]=h[1],o[2]=h[2],o[3]=h[3],o[4]=h[4],o[5]=h[5],o[6]=h[6],o[7]=h[7],o[8]=h[8],this},setFromMatrix4:function(r){var o=r.elements;return this.set(o[0],o[4],o[8],o[1],o[5],o[9],o[2],o[6],o[10]),this},applyToBufferAttribute:function(){var r=new he;return function(h){for(var u=0,g=h.count;u<g;u++)r.x=h.getX(u),r.y=h.getY(u),r.z=h.getZ(u),r.applyMatrix3(this),h.setXYZ(u,r.x,r.y,r.z);return h}}(),multiply:function(r){return this.multiplyMatrices(this,r)},premultiply:function(r){return this.multiplyMatrices(r,this)},multiplyMatrices:function(r,o){var h=r.elements,u=o.elements,g=this.elements,y=h[0],T=h[3],I=h[6],D=h[1],N=h[4],A=h[7],B=h[2],F=h[5],G=h[8],j=u[0],$=u[3],Z=u[6],Q=u[1],ie=u[4],ne=u[7],ae=u[2],ye=u[5],ge=u[8];return g[0]=y*j+T*Q+I*ae,g[3]=y*$+T*ie+I*ye,g[6]=y*Z+T*ne+I*ge,g[1]=D*j+N*Q+A*ae,g[4]=D*$+N*ie+A*ye,g[7]=D*Z+N*ne+A*ge,g[2]=B*j+F*Q+G*ae,g[5]=B*$+F*ie+G*ye,g[8]=B*Z+F*ne+G*ge,this},multiplyScalar:function(r){var o=this.elements;return o[0]*=r,o[3]*=r,o[6]*=r,o[1]*=r,o[4]*=r,o[7]*=r,o[2]*=r,o[5]*=r,o[8]*=r,this},determinant:function(){var r=this.elements,o=r[0],h=r[1],u=r[2],g=r[3],y=r[4],T=r[5],I=r[6],D=r[7],N=r[8];return o*y*N-o*T*D-h*g*N+h*T*I+u*g*D-u*y*I},getInverse:function(r,o){r&&r.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var h=r.elements,u=this.elements,g=h[0],y=h[1],T=h[2],I=h[3],D=h[4],N=h[5],A=h[6],B=h[7],F=h[8],G=F*D-N*B,j=N*A-F*I,$=B*I-D*A,Z=g*G+y*j+T*$;if(Z===0){var Q="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(o===!0)throw new Error(Q);return console.warn(Q),this.identity()}var ie=1/Z;return u[0]=G*ie,u[1]=(T*B-F*y)*ie,u[2]=(N*y-T*D)*ie,u[3]=j*ie,u[4]=(F*g-T*A)*ie,u[5]=(T*I-N*g)*ie,u[6]=$*ie,u[7]=(y*A-B*g)*ie,u[8]=(D*g-y*I)*ie,this},transpose:function(){var r,o=this.elements;return r=o[1],o[1]=o[3],o[3]=r,r=o[2],o[2]=o[6],o[6]=r,r=o[5],o[5]=o[7],o[7]=r,this},getNormalMatrix:function(r){return this.setFromMatrix4(r).getInverse(this).transpose()},transposeIntoArray:function(r){var o=this.elements;return r[0]=o[0],r[1]=o[3],r[2]=o[6],r[3]=o[1],r[4]=o[4],r[5]=o[7],r[6]=o[2],r[7]=o[5],r[8]=o[8],this},setUvTransform:function(r,o,h,u,g,y,T){var I=Math.cos(g),D=Math.sin(g);this.set(h*I,h*D,-h*(I*y+D*T)+y+r,-u*D,u*I,-u*(-D*y+I*T)+T+o,0,0,1)},scale:function(r,o){var h=this.elements;return h[0]*=r,h[3]*=r,h[6]*=r,h[1]*=o,h[4]*=o,h[7]*=o,this},rotate:function(r){var o=Math.cos(r),h=Math.sin(r),u=this.elements,g=u[0],y=u[3],T=u[6],I=u[1],D=u[4],N=u[7];return u[0]=o*g+h*I,u[3]=o*y+h*D,u[6]=o*T+h*N,u[1]=-h*g+o*I,u[4]=-h*y+o*D,u[7]=-h*T+o*N,this},translate:function(r,o){var h=this.elements;return h[0]+=r*h[2],h[3]+=r*h[5],h[6]+=r*h[8],h[1]+=o*h[2],h[4]+=o*h[5],h[7]+=o*h[8],this},equals:function(r){for(var o=this.elements,h=r.elements,u=0;u<9;u++)if(o[u]!==h[u])return!1;return!0},fromArray:function(r,o){o===void 0&&(o=0);for(var h=0;h<9;h++)this.elements[h]=r[h+o];return this},toArray:function(r,o){r===void 0&&(r=[]),o===void 0&&(o=0);var h=this.elements;return r[o]=h[0],r[o+1]=h[1],r[o+2]=h[2],r[o+3]=h[3],r[o+4]=h[4],r[o+5]=h[5],r[o+6]=h[6],r[o+7]=h[7],r[o+8]=h[8],r}});var ul=0;function Ci(r,o,h,u,g,y,T,I,D,N){Object.defineProperty(this,"id",{value:ul++}),this.uuid=si.generateUUID(),this.name="",this.image=r!==void 0?r:Ci.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=o!==void 0?o:Ci.DEFAULT_MAPPING,this.wrapS=h!==void 0?h:xi,this.wrapT=u!==void 0?u:xi,this.magFilter=g!==void 0?g:fn,this.minFilter=y!==void 0?y:wr,this.anisotropy=D!==void 0?D:1,this.format=T!==void 0?T:Dn,this.type=I!==void 0?I:gn,this.offset=new rt(0,0),this.repeat=new rt(1,1),this.center=new rt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new wn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=N!==void 0?N:Br,this.version=0,this.onUpdate=null}Ci.DEFAULT_IMAGE=void 0,Ci.DEFAULT_MAPPING=yi,Ci.prototype=Object.assign(Object.create(e.prototype),{constructor:Ci,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(r){return this.name=r.name,this.image=r.image,this.mipmaps=r.mipmaps.slice(0),this.mapping=r.mapping,this.wrapS=r.wrapS,this.wrapT=r.wrapT,this.magFilter=r.magFilter,this.minFilter=r.minFilter,this.anisotropy=r.anisotropy,this.format=r.format,this.type=r.type,this.offset.copy(r.offset),this.repeat.copy(r.repeat),this.center.copy(r.center),this.rotation=r.rotation,this.matrixAutoUpdate=r.matrixAutoUpdate,this.matrix.copy(r.matrix),this.generateMipmaps=r.generateMipmaps,this.premultiplyAlpha=r.premultiplyAlpha,this.flipY=r.flipY,this.unpackAlignment=r.unpackAlignment,this.encoding=r.encoding,this},toJSON:function(r){var o=r===void 0||typeof r=="string";if(!o&&r.textures[this.uuid]!==void 0)return r.textures[this.uuid];function h(D){var N;if(D instanceof HTMLCanvasElement)N=D;else{N=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),N.width=D.width,N.height=D.height;var A=N.getContext("2d");D instanceof ImageData?A.putImageData(D,0,0):A.drawImage(D,0,0,D.width,D.height)}return N.width>2048||N.height>2048?N.toDataURL("image/jpeg",.6):N.toDataURL("image/png")}var u={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(this.image!==void 0){var g=this.image;if(g.uuid===void 0&&(g.uuid=si.generateUUID()),!o&&r.images[g.uuid]===void 0){var y;if(Array.isArray(g)){y=[];for(var T=0,I=g.length;T<I;T++)y.push(h(g[T]))}else y=h(g);r.images[g.uuid]={uuid:g.uuid,url:y}}u.image=g.uuid}return o||(r.textures[this.uuid]=u),u},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(r){if(this.mapping===yi){if(r.applyMatrix3(this.matrix),r.x<0||r.x>1)switch(this.wrapS){case Rt:r.x=r.x-Math.floor(r.x);break;case xi:r.x=r.x<0?0:1;break;case Vn:Math.abs(Math.floor(r.x)%2)===1?r.x=Math.ceil(r.x)-r.x:r.x=r.x-Math.floor(r.x);break}if(r.y<0||r.y>1)switch(this.wrapT){case Rt:r.y=r.y-Math.floor(r.y);break;case xi:r.y=r.y<0?0:1;break;case Vn:Math.abs(Math.floor(r.y)%2)===1?r.y=Math.ceil(r.y)-r.y:r.y=r.y-Math.floor(r.y);break}this.flipY&&(r.y=1-r.y)}}}),Object.defineProperty(Ci.prototype,"needsUpdate",{set:function(r){r===!0&&this.version++}});function wi(r,o,h,u){this.x=r||0,this.y=o||0,this.z=h||0,this.w=u!==void 0?u:1}Object.assign(wi.prototype,{isVector4:!0,set:function(r,o,h,u){return this.x=r,this.y=o,this.z=h,this.w=u,this},setScalar:function(r){return this.x=r,this.y=r,this.z=r,this.w=r,this},setX:function(r){return this.x=r,this},setY:function(r){return this.y=r,this},setZ:function(r){return this.z=r,this},setW:function(r){return this.w=r,this},setComponent:function(r,o){switch(r){case 0:this.x=o;break;case 1:this.y=o;break;case 2:this.z=o;break;case 3:this.w=o;break;default:throw new Error("index is out of range: "+r)}return this},getComponent:function(r){switch(r){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+r)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(r){return this.x=r.x,this.y=r.y,this.z=r.z,this.w=r.w!==void 0?r.w:1,this},add:function(r,o){return o!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(r,o)):(this.x+=r.x,this.y+=r.y,this.z+=r.z,this.w+=r.w,this)},addScalar:function(r){return this.x+=r,this.y+=r,this.z+=r,this.w+=r,this},addVectors:function(r,o){return this.x=r.x+o.x,this.y=r.y+o.y,this.z=r.z+o.z,this.w=r.w+o.w,this},addScaledVector:function(r,o){return this.x+=r.x*o,this.y+=r.y*o,this.z+=r.z*o,this.w+=r.w*o,this},sub:function(r,o){return o!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(r,o)):(this.x-=r.x,this.y-=r.y,this.z-=r.z,this.w-=r.w,this)},subScalar:function(r){return this.x-=r,this.y-=r,this.z-=r,this.w-=r,this},subVectors:function(r,o){return this.x=r.x-o.x,this.y=r.y-o.y,this.z=r.z-o.z,this.w=r.w-o.w,this},multiplyScalar:function(r){return this.x*=r,this.y*=r,this.z*=r,this.w*=r,this},applyMatrix4:function(r){var o=this.x,h=this.y,u=this.z,g=this.w,y=r.elements;return this.x=y[0]*o+y[4]*h+y[8]*u+y[12]*g,this.y=y[1]*o+y[5]*h+y[9]*u+y[13]*g,this.z=y[2]*o+y[6]*h+y[10]*u+y[14]*g,this.w=y[3]*o+y[7]*h+y[11]*u+y[15]*g,this},divideScalar:function(r){return this.multiplyScalar(1/r)},setAxisAngleFromQuaternion:function(r){this.w=2*Math.acos(r.w);var o=Math.sqrt(1-r.w*r.w);return o<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=r.x/o,this.y=r.y/o,this.z=r.z/o),this},setAxisAngleFromRotationMatrix:function(r){var o,h,u,g,y=.01,T=.1,I=r.elements,D=I[0],N=I[4],A=I[8],B=I[1],F=I[5],G=I[9],j=I[2],$=I[6],Z=I[10];if(Math.abs(N-B)<y&&Math.abs(A-j)<y&&Math.abs(G-$)<y){if(Math.abs(N+B)<T&&Math.abs(A+j)<T&&Math.abs(G+$)<T&&Math.abs(D+F+Z-3)<T)return this.set(1,0,0,0),this;o=Math.PI;var Q=(D+1)/2,ie=(F+1)/2,ne=(Z+1)/2,ae=(N+B)/4,ye=(A+j)/4,ge=(G+$)/4;return Q>ie&&Q>ne?Q<y?(h=0,u=.707106781,g=.707106781):(h=Math.sqrt(Q),u=ae/h,g=ye/h):ie>ne?ie<y?(h=.707106781,u=0,g=.707106781):(u=Math.sqrt(ie),h=ae/u,g=ge/u):ne<y?(h=.707106781,u=.707106781,g=0):(g=Math.sqrt(ne),h=ye/g,u=ge/g),this.set(h,u,g,o),this}var be=Math.sqrt(($-G)*($-G)+(A-j)*(A-j)+(B-N)*(B-N));return Math.abs(be)<.001&&(be=1),this.x=($-G)/be,this.y=(A-j)/be,this.z=(B-N)/be,this.w=Math.acos((D+F+Z-1)/2),this},min:function(r){return this.x=Math.min(this.x,r.x),this.y=Math.min(this.y,r.y),this.z=Math.min(this.z,r.z),this.w=Math.min(this.w,r.w),this},max:function(r){return this.x=Math.max(this.x,r.x),this.y=Math.max(this.y,r.y),this.z=Math.max(this.z,r.z),this.w=Math.max(this.w,r.w),this},clamp:function(r,o){return this.x=Math.max(r.x,Math.min(o.x,this.x)),this.y=Math.max(r.y,Math.min(o.y,this.y)),this.z=Math.max(r.z,Math.min(o.z,this.z)),this.w=Math.max(r.w,Math.min(o.w,this.w)),this},clampScalar:function(){var r,o;return function(u,g){return r===void 0&&(r=new wi,o=new wi),r.set(u,u,u,u),o.set(g,g,g,g),this.clamp(r,o)}}(),clampLength:function(r,o){var h=this.length();return this.divideScalar(h||1).multiplyScalar(Math.max(r,Math.min(o,h)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(r){return this.x*r.x+this.y*r.y+this.z*r.z+this.w*r.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(r){return this.normalize().multiplyScalar(r)},lerp:function(r,o){return this.x+=(r.x-this.x)*o,this.y+=(r.y-this.y)*o,this.z+=(r.z-this.z)*o,this.w+=(r.w-this.w)*o,this},lerpVectors:function(r,o,h){return this.subVectors(o,r).multiplyScalar(h).add(r)},equals:function(r){return r.x===this.x&&r.y===this.y&&r.z===this.z&&r.w===this.w},fromArray:function(r,o){return o===void 0&&(o=0),this.x=r[o],this.y=r[o+1],this.z=r[o+2],this.w=r[o+3],this},toArray:function(r,o){return r===void 0&&(r=[]),o===void 0&&(o=0),r[o]=this.x,r[o+1]=this.y,r[o+2]=this.z,r[o+3]=this.w,r},fromBufferAttribute:function(r,o,h){return h!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=r.getX(o),this.y=r.getY(o),this.z=r.getZ(o),this.w=r.getW(o),this}});function Nn(r,o,h){this.width=r,this.height=o,this.scissor=new wi(0,0,r,o),this.scissorTest=!1,this.viewport=new wi(0,0,r,o),h=h||{},h.minFilter===void 0&&(h.minFilter=fn),this.texture=new Ci(void 0,void 0,h.wrapS,h.wrapT,h.magFilter,h.minFilter,h.format,h.type,h.anisotropy,h.encoding),this.texture.generateMipmaps=h.generateMipmaps!==void 0?h.generateMipmaps:!0,this.depthBuffer=h.depthBuffer!==void 0?h.depthBuffer:!0,this.stencilBuffer=h.stencilBuffer!==void 0?h.stencilBuffer:!0,this.depthTexture=h.depthTexture!==void 0?h.depthTexture:null}Nn.prototype=Object.assign(Object.create(e.prototype),{constructor:Nn,isWebGLRenderTarget:!0,setSize:function(r,o){(this.width!==r||this.height!==o)&&(this.width=r,this.height=o,this.dispose()),this.viewport.set(0,0,r,o),this.scissor.set(0,0,r,o)},clone:function(){return new this.constructor().copy(this)},copy:function(r){return this.width=r.width,this.height=r.height,this.viewport.copy(r.viewport),this.texture=r.texture.clone(),this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.depthTexture=r.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function rs(r,o,h){Nn.call(this,r,o,h),this.activeCubeFace=0,this.activeMipMapLevel=0}rs.prototype=Object.create(Nn.prototype),rs.prototype.constructor=rs,rs.prototype.isWebGLRenderTargetCube=!0;function ss(r,o,h,u,g,y,T,I,D,N,A,B){Ci.call(this,null,y,T,I,D,N,u,g,A,B),this.image={data:r,width:o,height:h},this.magFilter=D!==void 0?D:Hi,this.minFilter=N!==void 0?N:Hi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}ss.prototype=Object.create(Ci.prototype),ss.prototype.constructor=ss,ss.prototype.isDataTexture=!0;function Jn(r,o){this.min=r!==void 0?r:new he(1/0,1/0,1/0),this.max=o!==void 0?o:new he(-1/0,-1/0,-1/0)}Object.assign(Jn.prototype,{isBox3:!0,set:function(r,o){return this.min.copy(r),this.max.copy(o),this},setFromArray:function(r){for(var o=1/0,h=1/0,u=1/0,g=-1/0,y=-1/0,T=-1/0,I=0,D=r.length;I<D;I+=3){var N=r[I],A=r[I+1],B=r[I+2];N<o&&(o=N),A<h&&(h=A),B<u&&(u=B),N>g&&(g=N),A>y&&(y=A),B>T&&(T=B)}return this.min.set(o,h,u),this.max.set(g,y,T),this},setFromBufferAttribute:function(r){for(var o=1/0,h=1/0,u=1/0,g=-1/0,y=-1/0,T=-1/0,I=0,D=r.count;I<D;I++){var N=r.getX(I),A=r.getY(I),B=r.getZ(I);N<o&&(o=N),A<h&&(h=A),B<u&&(u=B),N>g&&(g=N),A>y&&(y=A),B>T&&(T=B)}return this.min.set(o,h,u),this.max.set(g,y,T),this},setFromPoints:function(r){this.makeEmpty();for(var o=0,h=r.length;o<h;o++)this.expandByPoint(r[o]);return this},setFromCenterAndSize:function(){var r=new he;return function(h,u){var g=r.copy(u).multiplyScalar(.5);return this.min.copy(h).sub(g),this.max.copy(h).add(g),this}}(),setFromObject:function(r){return this.makeEmpty(),this.expandByObject(r)},clone:function(){return new this.constructor().copy(this)},copy:function(r){return this.min.copy(r.min),this.max.copy(r.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(r){return r===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),r=new he),this.isEmpty()?r.set(0,0,0):r.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(r){return r===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),r=new he),this.isEmpty()?r.set(0,0,0):r.subVectors(this.max,this.min)},expandByPoint:function(r){return this.min.min(r),this.max.max(r),this},expandByVector:function(r){return this.min.sub(r),this.max.add(r),this},expandByScalar:function(r){return this.min.addScalar(-r),this.max.addScalar(r),this},expandByObject:function(){var r,o,h,u=new he;function g(y){var T=y.geometry;if(T!==void 0){if(T.isGeometry){var I=T.vertices;for(o=0,h=I.length;o<h;o++)u.copy(I[o]),u.applyMatrix4(y.matrixWorld),r.expandByPoint(u)}else if(T.isBufferGeometry){var D=T.attributes.position;if(D!==void 0)for(o=0,h=D.count;o<h;o++)u.fromBufferAttribute(D,o).applyMatrix4(y.matrixWorld),r.expandByPoint(u)}}}return function(T){return r=this,T.updateMatrixWorld(!0),T.traverse(g),this}}(),containsPoint:function(r){return!(r.x<this.min.x||r.x>this.max.x||r.y<this.min.y||r.y>this.max.y||r.z<this.min.z||r.z>this.max.z)},containsBox:function(r){return this.min.x<=r.min.x&&r.max.x<=this.max.x&&this.min.y<=r.min.y&&r.max.y<=this.max.y&&this.min.z<=r.min.z&&r.max.z<=this.max.z},getParameter:function(r,o){return o===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),o=new he),o.set((r.x-this.min.x)/(this.max.x-this.min.x),(r.y-this.min.y)/(this.max.y-this.min.y),(r.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(r){return!(r.max.x<this.min.x||r.min.x>this.max.x||r.max.y<this.min.y||r.min.y>this.max.y||r.max.z<this.min.z||r.min.z>this.max.z)},intersectsSphere:function(){var r=new he;return function(h){return this.clampPoint(h.center,r),r.distanceToSquared(h.center)<=h.radius*h.radius}}(),intersectsPlane:function(r){var o,h;return r.normal.x>0?(o=r.normal.x*this.min.x,h=r.normal.x*this.max.x):(o=r.normal.x*this.max.x,h=r.normal.x*this.min.x),r.normal.y>0?(o+=r.normal.y*this.min.y,h+=r.normal.y*this.max.y):(o+=r.normal.y*this.max.y,h+=r.normal.y*this.min.y),r.normal.z>0?(o+=r.normal.z*this.min.z,h+=r.normal.z*this.max.z):(o+=r.normal.z*this.max.z,h+=r.normal.z*this.min.z),o<=r.constant&&h>=r.constant},intersectsTriangle:function(){var r=new he,o=new he,h=new he,u=new he,g=new he,y=new he,T=new he,I=new he,D=new he,N=new he;function A(B){var F,G;for(F=0,G=B.length-3;F<=G;F+=3){T.fromArray(B,F);var j=D.x*Math.abs(T.x)+D.y*Math.abs(T.y)+D.z*Math.abs(T.z),$=r.dot(T),Z=o.dot(T),Q=h.dot(T);if(Math.max(-Math.max($,Z,Q),Math.min($,Z,Q))>j)return!1}return!0}return function(F){if(this.isEmpty())return!1;this.getCenter(I),D.subVectors(this.max,I),r.subVectors(F.a,I),o.subVectors(F.b,I),h.subVectors(F.c,I),u.subVectors(o,r),g.subVectors(h,o),y.subVectors(r,h);var G=[0,-u.z,u.y,0,-g.z,g.y,0,-y.z,y.y,u.z,0,-u.x,g.z,0,-g.x,y.z,0,-y.x,-u.y,u.x,0,-g.y,g.x,0,-y.y,y.x,0];return!A(G)||(G=[1,0,0,0,1,0,0,0,1],!A(G))?!1:(N.crossVectors(u,g),G=[N.x,N.y,N.z],A(G))}}(),clampPoint:function(r,o){return o===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),o=new he),o.copy(r).clamp(this.min,this.max)},distanceToPoint:function(){var r=new he;return function(h){var u=r.copy(h).clamp(this.min,this.max);return u.sub(h).length()}}(),getBoundingSphere:function(){var r=new he;return function(h){return h===void 0&&(console.warn("THREE.Box3: .getBoundingSphere() target is now required"),h=new nr),this.getCenter(h.center),h.radius=this.getSize(r).length()*.5,h}}(),intersect:function(r){return this.min.max(r.min),this.max.min(r.max),this.isEmpty()&&this.makeEmpty(),this},union:function(r){return this.min.min(r.min),this.max.max(r.max),this},applyMatrix4:function(r){if(this.isEmpty())return this;var o=r.elements,h=o[0]*this.min.x,u=o[1]*this.min.x,g=o[2]*this.min.x,y=o[0]*this.max.x,T=o[1]*this.max.x,I=o[2]*this.max.x,D=o[4]*this.min.y,N=o[5]*this.min.y,A=o[6]*this.min.y,B=o[4]*this.max.y,F=o[5]*this.max.y,G=o[6]*this.max.y,j=o[8]*this.min.z,$=o[9]*this.min.z,Z=o[10]*this.min.z,Q=o[8]*this.max.z,ie=o[9]*this.max.z,ne=o[10]*this.max.z;return this.min.x=Math.min(h,y)+Math.min(D,B)+Math.min(j,Q)+o[12],this.min.y=Math.min(u,T)+Math.min(N,F)+Math.min($,ie)+o[13],this.min.z=Math.min(g,I)+Math.min(A,G)+Math.min(Z,ne)+o[14],this.max.x=Math.max(h,y)+Math.max(D,B)+Math.max(j,Q)+o[12],this.max.y=Math.max(u,T)+Math.max(N,F)+Math.max($,ie)+o[13],this.max.z=Math.max(g,I)+Math.max(A,G)+Math.max(Z,ne)+o[14],this},translate:function(r){return this.min.add(r),this.max.add(r),this},equals:function(r){return r.min.equals(this.min)&&r.max.equals(this.max)}});function nr(r,o){this.center=r!==void 0?r:new he,this.radius=o!==void 0?o:0}Object.assign(nr.prototype,{set:function(r,o){return this.center.copy(r),this.radius=o,this},setFromPoints:function(){var r=new Jn;return function(h,u){var g=this.center;u!==void 0?g.copy(u):r.setFromPoints(h).getCenter(g);for(var y=0,T=0,I=h.length;T<I;T++)y=Math.max(y,g.distanceToSquared(h[T]));return this.radius=Math.sqrt(y),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(r){return this.center.copy(r.center),this.radius=r.radius,this},empty:function(){return this.radius<=0},containsPoint:function(r){return r.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(r){return r.distanceTo(this.center)-this.radius},intersectsSphere:function(r){var o=this.radius+r.radius;return r.center.distanceToSquared(this.center)<=o*o},intersectsBox:function(r){return r.intersectsSphere(this)},intersectsPlane:function(r){return Math.abs(r.distanceToPoint(this.center))<=this.radius},clampPoint:function(r,o){var h=this.center.distanceToSquared(r);return o===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),o=new he),o.copy(r),h>this.radius*this.radius&&(o.sub(this.center).normalize(),o.multiplyScalar(this.radius).add(this.center)),o},getBoundingBox:function(r){return r===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),r=new Jn),r.set(this.center,this.center),r.expandByScalar(this.radius),r},applyMatrix4:function(r){return this.center.applyMatrix4(r),this.radius=this.radius*r.getMaxScaleOnAxis(),this},translate:function(r){return this.center.add(r),this},equals:function(r){return r.center.equals(this.center)&&r.radius===this.radius}});function rr(r,o){this.normal=r!==void 0?r:new he(1,0,0),this.constant=o!==void 0?o:0}Object.assign(rr.prototype,{set:function(r,o){return this.normal.copy(r),this.constant=o,this},setComponents:function(r,o,h,u){return this.normal.set(r,o,h),this.constant=u,this},setFromNormalAndCoplanarPoint:function(r,o){return this.normal.copy(r),this.constant=-o.dot(this.normal),this},setFromCoplanarPoints:function(){var r=new he,o=new he;return function(u,g,y){var T=r.subVectors(y,g).cross(o.subVectors(u,g)).normalize();return this.setFromNormalAndCoplanarPoint(T,u),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(r){return this.normal.copy(r.normal),this.constant=r.constant,this},normalize:function(){var r=1/this.normal.length();return this.normal.multiplyScalar(r),this.constant*=r,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(r){return this.normal.dot(r)+this.constant},distanceToSphere:function(r){return this.distanceToPoint(r.center)-r.radius},projectPoint:function(r,o){return o===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),o=new he),o.copy(this.normal).multiplyScalar(-this.distanceToPoint(r)).add(r)},intersectLine:function(){var r=new he;return function(h,u){u===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),u=new he);var g=h.delta(r),y=this.normal.dot(g);if(y===0)return this.distanceToPoint(h.start)===0?u.copy(h.start):void 0;var T=-(h.start.dot(this.normal)+this.constant)/y;if(!(T<0||T>1))return u.copy(g).multiplyScalar(T).add(h.start)}}(),intersectsLine:function(r){var o=this.distanceToPoint(r.start),h=this.distanceToPoint(r.end);return o<0&&h>0||h<0&&o>0},intersectsBox:function(r){return r.intersectsPlane(this)},intersectsSphere:function(r){return r.intersectsPlane(this)},coplanarPoint:function(r){return r===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),r=new he),r.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var r=new he,o=new wn;return function(u,g){var y=g||o.getNormalMatrix(u),T=this.coplanarPoint(r).applyMatrix4(u),I=this.normal.applyMatrix3(y).normalize();return this.constant=-T.dot(I),this}}(),translate:function(r){return this.constant-=r.dot(this.normal),this},equals:function(r){return r.normal.equals(this.normal)&&r.constant===this.constant}});function as(r,o,h,u,g,y){this.planes=[r!==void 0?r:new rr,o!==void 0?o:new rr,h!==void 0?h:new rr,u!==void 0?u:new rr,g!==void 0?g:new rr,y!==void 0?y:new rr]}Object.assign(as.prototype,{set:function(r,o,h,u,g,y){var T=this.planes;return T[0].copy(r),T[1].copy(o),T[2].copy(h),T[3].copy(u),T[4].copy(g),T[5].copy(y),this},clone:function(){return new this.constructor().copy(this)},copy:function(r){for(var o=this.planes,h=0;h<6;h++)o[h].copy(r.planes[h]);return this},setFromMatrix:function(r){var o=this.planes,h=r.elements,u=h[0],g=h[1],y=h[2],T=h[3],I=h[4],D=h[5],N=h[6],A=h[7],B=h[8],F=h[9],G=h[10],j=h[11],$=h[12],Z=h[13],Q=h[14],ie=h[15];return o[0].setComponents(T-u,A-I,j-B,ie-$).normalize(),o[1].setComponents(T+u,A+I,j+B,ie+$).normalize(),o[2].setComponents(T+g,A+D,j+F,ie+Z).normalize(),o[3].setComponents(T-g,A-D,j-F,ie-Z).normalize(),o[4].setComponents(T-y,A-N,j-G,ie-Q).normalize(),o[5].setComponents(T+y,A+N,j+G,ie+Q).normalize(),this},intersectsObject:function(){var r=new nr;return function(h){var u=h.geometry;return u.boundingSphere===null&&u.computeBoundingSphere(),r.copy(u.boundingSphere).applyMatrix4(h.matrixWorld),this.intersectsSphere(r)}}(),intersectsSprite:function(){var r=new nr;return function(h){return r.center.set(0,0,0),r.radius=.7071067811865476,r.applyMatrix4(h.matrixWorld),this.intersectsSphere(r)}}(),intersectsSphere:function(r){for(var o=this.planes,h=r.center,u=-r.radius,g=0;g<6;g++){var y=o[g].distanceToPoint(h);if(y<u)return!1}return!0},intersectsBox:function(){var r=new he,o=new he;return function(u){for(var g=this.planes,y=0;y<6;y++){var T=g[y];r.x=T.normal.x>0?u.min.x:u.max.x,o.x=T.normal.x>0?u.max.x:u.min.x,r.y=T.normal.y>0?u.min.y:u.max.y,o.y=T.normal.y>0?u.max.y:u.min.y,r.z=T.normal.z>0?u.min.z:u.max.z,o.z=T.normal.z>0?u.max.z:u.min.z;var I=T.distanceToPoint(r),D=T.distanceToPoint(o);if(I<0&&D<0)return!1}return!0}}(),containsPoint:function(r){for(var o=this.planes,h=0;h<6;h++)if(o[h].distanceToPoint(r)<0)return!1;return!0}});var pl=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif
`,Cd=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif
`,ml=`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif
`,wd=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( PHYSICAL )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif
`,Td=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Ed=`
vec3 transformed = vec3( position );
`,rc=`
vec3 objectNormal = vec3( normal );
`,ea=`float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	if( decayExponent > 0.0 ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		float maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		return distanceFalloff * maxDistanceCutoffFactor;
#else
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
#endif
	}
	return 1.0;
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE  = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS  = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;
	return specularColor * AB.x + AB.y;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
`,sc=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif
`,ac=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;
	}
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;
		}
		if ( clipped ) discard;
	#endif
#endif
`,oc=`#if NUM_CLIPPING_PLANES > 0
	#if ! defined( PHYSICAL ) && ! defined( PHONG )
		varying vec3 vViewPosition;
	#endif
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif
`,lc=`#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )
	varying vec3 vViewPosition;
#endif
`,xd=`#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )
	vViewPosition = - mvPosition.xyz;
#endif
`,Id=`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,dc=`#ifdef USE_COLOR
	varying vec3 vColor;
#endif
`,hc=`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,cc=`#ifdef USE_COLOR
	vColor.xyz = color.xyz;
#endif`,uc=`#define PI 3.14159265359
#define PI2 6.28318530718
#define PI_HALF 1.5707963267949
#define RECIPROCAL_PI 0.31830988618
#define RECIPROCAL_PI2 0.15915494
#define LOG2 1.442695
#define EPSILON 1e-6
#define saturate(a) clamp( a, 0.0, 1.0 )
#define whiteCompliment(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
`,Rd=`#ifdef ENVMAP_TYPE_CUBE_UV
#define cubeUV_textureSize (1024.0)
int getFaceFromDirection(vec3 direction) {
	vec3 absDirection = abs(direction);
	int face = -1;
	if( absDirection.x > absDirection.z ) {
		if(absDirection.x > absDirection.y )
			face = direction.x > 0.0 ? 0 : 3;
		else
			face = direction.y > 0.0 ? 1 : 4;
	}
	else {
		if(absDirection.z > absDirection.y )
			face = direction.z > 0.0 ? 2 : 5;
		else
			face = direction.y > 0.0 ? 1 : 4;
	}
	return face;
}
#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)
#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))
vec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {
	float scale = exp2(cubeUV_maxLods1 - roughnessLevel);
	float dxRoughness = dFdx(roughness);
	float dyRoughness = dFdy(roughness);
	vec3 dx = dFdx( vec * scale * dxRoughness );
	vec3 dy = dFdy( vec * scale * dyRoughness );
	float d = max( dot( dx, dx ), dot( dy, dy ) );
	d = clamp(d, 1.0, cubeUV_rangeClamp);
	float mipLevel = 0.5 * log2(d);
	return vec2(floor(mipLevel), fract(mipLevel));
}
#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)
#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)
vec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {
	mipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;
	float a = 16.0 * cubeUV_rcpTextureSize;
	vec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );
	vec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;
	float powScale = exp2_packed.x * exp2_packed.y;
	float scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;
	float mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;
	bool bRes = mipLevel == 0.0;
	scale =  bRes && (scale < a) ? a : scale;
	vec3 r;
	vec2 offset;
	int face = getFaceFromDirection(direction);
	float rcpPowScale = 1.0 / powScale;
	if( face == 0) {
		r = vec3(direction.x, -direction.z, direction.y);
		offset = vec2(0.0+mipOffset,0.75 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;
	}
	else if( face == 1) {
		r = vec3(direction.y, direction.x, direction.z);
		offset = vec2(scale+mipOffset, 0.75 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;
	}
	else if( face == 2) {
		r = vec3(direction.z, direction.x, direction.y);
		offset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;
	}
	else if( face == 3) {
		r = vec3(direction.x, direction.z, direction.y);
		offset = vec2(0.0+mipOffset,0.5 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;
	}
	else if( face == 4) {
		r = vec3(direction.y, direction.x, -direction.z);
		offset = vec2(scale+mipOffset, 0.5 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;
	}
	else {
		r = vec3(direction.z, -direction.x, direction.y);
		offset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;
	}
	r = normalize(r);
	float texelOffset = 0.5 * cubeUV_rcpTextureSize;
	vec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;
	vec2 base = offset + vec2( texelOffset );
	return base + s * ( scale - 2.0 * texelOffset );
}
#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)
vec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {
	float roughnessVal = roughness* cubeUV_maxLods3;
	float r1 = floor(roughnessVal);
	float r2 = r1 + 1.0;
	float t = fract(roughnessVal);
	vec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);
	float s = mipInfo.y;
	float level0 = mipInfo.x;
	float level1 = level0 + 1.0;
	level1 = level1 > 5.0 ? 5.0 : level1;
	level0 += min( floor( s + 0.5 ), 5.0 );
	vec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);
	vec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));
	vec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);
	vec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));
	vec4 result = mix(color10, color20, t);
	return vec4(result.rgb, 1.0);
}
#endif
`,pc=`vec3 transformedNormal = normalMatrix * objectNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
`,Md=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif
`,ko=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );
#endif
`,ta=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif
`,mc=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif
`,fc=`  gl_FragColor = linearToOutputTexel( gl_FragColor );
`,gc=`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.xyz * value.w * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.x, max( value.g, value.b ) );
	float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M            = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.x, max( value.g, value.b ) );
	float D      = max( maxRange / maxRGB, 1.0 );
	D            = min( floor( D ) / 255.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value )  {
	vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;
	Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract(Le);
	vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;
	return vec4( max(vRGB, 0.0), 1.0 );
}
`,Pa=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToVertex, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_EQUIREC )
		vec2 sampleUV;
		reflectVec = normalize( reflectVec );
		sampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
		sampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;
		vec4 envColor = texture2D( envMap, sampleUV );
	#elif defined( ENVMAP_TYPE_SPHERE )
		reflectVec = normalize( reflectVec );
		vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );
		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	envColor = envMapTexelToLinear( envColor );
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif
`,Un=`#if defined( USE_ENVMAP ) || defined( PHYSICAL )
	uniform float reflectivity;
	uniform float envMapIntensity;
#endif
#ifdef USE_ENVMAP
	#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )
		varying vec3 vWorldPosition;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif
`,_c=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif
`,kd=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif
`,Aa=`
#ifdef USE_FOG
fogDepth = -mvPosition.z;
#endif`,vc=`#ifdef USE_FOG
  varying float fogDepth;
#endif
`,Dd=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif
`,yc=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif
`,fl=`#ifdef TOON
	uniform sampler2D gradientMap;
	vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
		float dotNL = dot( normal, lightDirection );
		vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
		#ifdef USE_GRADIENTMAP
			return texture2D( gradientMap, coord ).rgb;
		#else
			return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
		#endif
	}
#endif
`,Ld=`#ifdef USE_LIGHTMAP
	reflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;
#endif
`,Sc=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,bc=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
#endif
`,Nd=`uniform vec3 ambientLightColor;
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
		float shadowCameraNear;
		float shadowCameraFar;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif
`,Pd=`#if defined( USE_ENVMAP ) && defined( PHYSICAL )
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			vec4 envMapColor = textureCubeUV( queryVec, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );
		#else
			vec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			vec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));
		#elif defined( ENVMAP_TYPE_EQUIREC )
			vec2 sampleUV;
			sampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
			sampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_SPHERE )
			vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif
`,Cc=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;
`,Ba=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	#ifdef TOON
		vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#else
		float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
		vec3 irradiance = dotNL * directLight.color;
	#endif
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)
`,Fr=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );
#ifdef STANDARD
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
	material.clearCoat = saturate( clearCoat );	material.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );
#endif
`,Do=`struct PhysicalMaterial {
	vec3	diffuseColor;
	float	specularRoughness;
	vec3	specularColor;
	#ifndef STANDARD
		float clearCoat;
		float clearCoatRoughness;
	#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearCoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos - halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos + halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos + halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos - halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifndef STANDARD
		float clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );
	#else
		float clearCoatDHR = 0.0;
	#endif
	reflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );
	reflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	#ifndef STANDARD
		reflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );
	#endif
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	#ifndef STANDARD
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		float dotNL = dotNV;
		float clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );
	#else
		float clearCoatDHR = 0.0;
	#endif
	reflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );
	#ifndef STANDARD
		reflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );
	#endif
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )
#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}
`,gl=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = normalize( vViewPosition );
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#ifdef USE_SHADOWMAP
		directLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#ifdef USE_SHADOWMAP
		directLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#ifdef USE_SHADOWMAP
		directLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
#endif
#if defined( RE_IndirectDiffuse )
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearCoatRadiance = vec3( 0.0 );
#endif
`,Ad=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )
		irradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );
	#ifndef STANDARD
		clearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );
	#endif
#endif
`,xr=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );
#endif
`,Rs=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,_l=`#ifdef USE_LOGDEPTHBUF
	uniform float logDepthBufFC;
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
	#endif
#endif
`,wc=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
	#endif
	uniform float logDepthBufFC;
#endif`,Bd=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
	#else
		gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
		gl_Position.z *= gl_Position.w;
	#endif
#endif
`,Tc=`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif
`,Fd=`#ifdef USE_MAP
	uniform sampler2D map;
#endif
`,vl=`#ifdef USE_MAP
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
`,yl=`#ifdef USE_MAP
	uniform mat3 uvTransform;
	uniform sampler2D map;
#endif
`,Sl=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif
`,Od=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Vd=`#ifdef USE_MORPHNORMALS
	objectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];
	objectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];
	objectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];
	objectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];
#endif
`,Ec=`#ifdef USE_MORPHTARGETS
	#ifndef USE_MORPHNORMALS
	uniform float morphTargetInfluences[ 8 ];
	#else
	uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,xc=`#ifdef USE_MORPHTARGETS
	transformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];
	transformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];
	transformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];
	transformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
	transformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];
	transformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];
	transformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];
	transformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];
	#endif
#endif
`,Ic=`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
#endif
`,Ud=`#ifdef USE_NORMALMAP
	#ifdef OBJECTSPACE_NORMALMAP
		normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
		#ifdef FLIP_SIDED
			normal = - normal;
		#endif
		#ifdef DOUBLE_SIDED
			normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		normal = normalize( normalMatrix * normal );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif
`,zd=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
	#ifdef OBJECTSPACE_NORMALMAP
		uniform mat3 normalMatrix;
	#else
		vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {
			vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
			vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
			vec2 st0 = dFdx( vUv.st );
			vec2 st1 = dFdy( vUv.st );
			float scale = sign( st1.t * st0.s - st0.t * st1.s );
			vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
			vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
			vec3 N = normalize( surf_norm );
			mat3 tsn = mat3( S, T, N );
			vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
			mapN.xy *= normalScale;
			mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			return normalize( tsn * mapN );
		}
	#endif
#endif
`,Fa=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}
`,Gd=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif
`,Hd=`vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );
gl_Position = projectionMatrix * mvPosition;
`,bl=`#if defined( DITHERING )
  gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif
`,Wd=`#if defined( DITHERING )
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif
`,Cl=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif
`,Or=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,jd=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHTS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];
	#endif
	#if NUM_SPOT_LIGHTS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];
	#endif
	#if NUM_POINT_LIGHTS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	float texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {
		const vec2 offset = vec2( 0.0, 1.0 );
		vec2 texelSize = vec2( 1.0 ) / size;
		vec2 centroidUV = floor( uv * size + 0.5 ) / size;
		float lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );
		float lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );
		float rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );
		float rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );
		vec2 f = fract( uv * size + 0.5 );
		float a = mix( lb, lt, f.y );
		float b = mix( rb, rt, f.y );
		float c = mix( a, b, f.x );
		return c;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			shadow = (
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 9.0 );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif
`,Lo=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHTS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];
	#endif
	#if NUM_SPOT_LIGHTS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];
	#endif
	#if NUM_POINT_LIGHTS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];
	#endif
#endif
`,wl=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;
	}
	#endif
	#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;
	}
	#endif
	#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;
	}
	#endif
#endif
`,Rc=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHTS > 0
	DirectionalLight directionalLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		shadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#endif
	#if NUM_SPOT_LIGHTS > 0
	SpotLight spotLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		shadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#endif
	#if NUM_POINT_LIGHTS > 0
	PointLight pointLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		shadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#endif
	#endif
	return shadow;
}
`,Ms=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,ks=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif
`,Oa=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif
`,Tl=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
#endif
`,El=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,qd=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,xl=`#if defined( TONE_MAPPING )
  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif
`,Ds=`#ifndef saturate
	#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
uniform float toneMappingWhitePoint;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )
vec3 Uncharted2ToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
`,Ls=`#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )
	varying vec2 vUv;
#endif`,Va=`#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
`,Kd=`#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,Xd=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,Mc=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
#endif`,Il=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = uv2;
#endif`,Yd=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );
#endif
`,kc=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldPosition;
void main() {
	gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );
	gl_FragColor.a *= opacity;
}
`,Rl=`varying vec3 vWorldPosition;
#include <common>
void main() {
	vWorldPosition = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}
`,Ua=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( gl_FragCoord.z );
	#endif
}
`,Ml=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
}
`,Jd=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}
`,No=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}
`,$d=`uniform sampler2D tEquirect;
varying vec3 vWorldPosition;
#include <common>
void main() {
	vec3 direction = normalize( vWorldPosition );
	vec2 sampleUV;
	sampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;
	gl_FragColor = texture2D( tEquirect, sampleUV );
}
`,kl=`varying vec3 vWorldPosition;
#include <common>
void main() {
	vWorldPosition = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}
`,za=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <premultiplied_alpha_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}
`,ia=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	vLineDistance = scale * lineDistance;
	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}
`,Po=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		reflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <premultiplied_alpha_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}
`,$n=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}
`,Qd=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	reflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}
`,Dc=`#define LAMBERT
varying vec3 vLightFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}
`,Zd=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}
`,Ga=`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}
`,Ns=`#define PHYSICAL
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifndef STANDARD
	uniform float clearCoat;
	uniform float clearCoatRoughness;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <lights_pars_begin>
#include <lights_pars_maps>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}
`,Ha=`#define PHYSICAL
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}
`,na=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}
`,eh=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )
	vViewPosition = - mvPosition.xyz;
#endif
}
`,th=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <packing>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <premultiplied_alpha_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}
`,ih=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#ifdef USE_SIZEATTENUATION
		gl_PointSize = size * ( scale / - mvPosition.z );
	#else
		gl_PointSize = size;
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}
`,Lc=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <fog_fragment>
}
`,Nc=`#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}
`,Si={alphamap_fragment:pl,alphamap_pars_fragment:Cd,alphatest_fragment:ml,aomap_fragment:wd,aomap_pars_fragment:Td,begin_vertex:Ed,beginnormal_vertex:rc,bsdfs:ea,bumpmap_pars_fragment:sc,clipping_planes_fragment:ac,clipping_planes_pars_fragment:oc,clipping_planes_pars_vertex:lc,clipping_planes_vertex:xd,color_fragment:Id,color_pars_fragment:dc,color_pars_vertex:hc,color_vertex:cc,common:uc,cube_uv_reflection_fragment:Rd,defaultnormal_vertex:pc,displacementmap_pars_vertex:Md,displacementmap_vertex:ko,emissivemap_fragment:ta,emissivemap_pars_fragment:mc,encodings_fragment:fc,encodings_pars_fragment:gc,envmap_fragment:Pa,envmap_pars_fragment:Un,envmap_pars_vertex:_c,envmap_vertex:kd,fog_vertex:Aa,fog_pars_vertex:vc,fog_fragment:Dd,fog_pars_fragment:yc,gradientmap_pars_fragment:fl,lightmap_fragment:Ld,lightmap_pars_fragment:Sc,lights_lambert_vertex:bc,lights_pars_begin:Nd,lights_pars_maps:Pd,lights_phong_fragment:Cc,lights_phong_pars_fragment:Ba,lights_physical_fragment:Fr,lights_physical_pars_fragment:Do,lights_fragment_begin:gl,lights_fragment_maps:Ad,lights_fragment_end:xr,logdepthbuf_fragment:Rs,logdepthbuf_pars_fragment:_l,logdepthbuf_pars_vertex:wc,logdepthbuf_vertex:Bd,map_fragment:Tc,map_pars_fragment:Fd,map_particle_fragment:vl,map_particle_pars_fragment:yl,metalnessmap_fragment:Sl,metalnessmap_pars_fragment:Od,morphnormal_vertex:Vd,morphtarget_pars_vertex:Ec,morphtarget_vertex:xc,normal_fragment_begin:Ic,normal_fragment_maps:Ud,normalmap_pars_fragment:zd,packing:Fa,premultiplied_alpha_fragment:Gd,project_vertex:Hd,dithering_fragment:bl,dithering_pars_fragment:Wd,roughnessmap_fragment:Cl,roughnessmap_pars_fragment:Or,shadowmap_pars_fragment:jd,shadowmap_pars_vertex:Lo,shadowmap_vertex:wl,shadowmask_pars_fragment:Rc,skinbase_vertex:Ms,skinning_pars_vertex:ks,skinning_vertex:Oa,skinnormal_vertex:Tl,specularmap_fragment:El,specularmap_pars_fragment:qd,tonemapping_fragment:xl,tonemapping_pars_fragment:Ds,uv_pars_fragment:Ls,uv_pars_vertex:Va,uv_vertex:Kd,uv2_pars_fragment:Xd,uv2_pars_vertex:Mc,uv2_vertex:Il,worldpos_vertex:Yd,cube_frag:kc,cube_vert:Rl,depth_frag:Ua,depth_vert:Ml,distanceRGBA_frag:Jd,distanceRGBA_vert:No,equirect_frag:$d,equirect_vert:kl,linedashed_frag:za,linedashed_vert:ia,meshbasic_frag:Po,meshbasic_vert:$n,meshlambert_frag:Qd,meshlambert_vert:Dc,meshphong_frag:Zd,meshphong_vert:Ga,meshphysical_frag:Ns,meshphysical_vert:Ha,normal_frag:na,normal_vert:eh,points_frag:th,points_vert:ih,shadow_frag:Lc,shadow_vert:Nc},Tn={merge:function(r){for(var o={},h=0;h<r.length;h++){var u=this.clone(r[h]);for(var g in u)o[g]=u[g]}return o},clone:function(r){var o={};for(var h in r){o[h]={};for(var u in r[h]){var g=r[h][u];g&&(g.isColor||g.isMatrix3||g.isMatrix4||g.isVector2||g.isVector3||g.isVector4||g.isTexture)?o[h][u]=g.clone():Array.isArray(g)?o[h][u]=g.slice():o[h][u]=g}}return o}},Dl={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Mt(r,o,h){return o===void 0&&h===void 0?this.set(r):this.setRGB(r,o,h)}Object.assign(Mt.prototype,{isColor:!0,r:1,g:1,b:1,set:function(r){return r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r),this},setScalar:function(r){return this.r=r,this.g=r,this.b=r,this},setHex:function(r){return r=Math.floor(r),this.r=(r>>16&255)/255,this.g=(r>>8&255)/255,this.b=(r&255)/255,this},setRGB:function(r,o,h){return this.r=r,this.g=o,this.b=h,this},setHSL:function(){function r(o,h,u){return u<0&&(u+=1),u>1&&(u-=1),u<1/6?o+(h-o)*6*u:u<1/2?h:u<2/3?o+(h-o)*6*(2/3-u):o}return function(h,u,g){if(h=si.euclideanModulo(h,1),u=si.clamp(u,0,1),g=si.clamp(g,0,1),u===0)this.r=this.g=this.b=g;else{var y=g<=.5?g*(1+u):g+u-g*u,T=2*g-y;this.r=r(T,y,h+1/3),this.g=r(T,y,h),this.b=r(T,y,h-1/3)}return this}}(),setStyle:function(r){function o(B){B!==void 0&&parseFloat(B)<1&&console.warn("THREE.Color: Alpha component of "+r+" will be ignored.")}var h;if(h=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(r)){var u,g=h[1],y=h[2];switch(g){case"rgb":case"rgba":if(u=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(y))return this.r=Math.min(255,parseInt(u[1],10))/255,this.g=Math.min(255,parseInt(u[2],10))/255,this.b=Math.min(255,parseInt(u[3],10))/255,o(u[5]),this;if(u=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(y))return this.r=Math.min(100,parseInt(u[1],10))/100,this.g=Math.min(100,parseInt(u[2],10))/100,this.b=Math.min(100,parseInt(u[3],10))/100,o(u[5]),this;break;case"hsl":case"hsla":if(u=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(y)){var T=parseFloat(u[1])/360,I=parseInt(u[2],10)/100,D=parseInt(u[3],10)/100;return o(u[5]),this.setHSL(T,I,D)}break}}else if(h=/^\#([A-Fa-f0-9]+)$/.exec(r)){var N=h[1],A=N.length;if(A===3)return this.r=parseInt(N.charAt(0)+N.charAt(0),16)/255,this.g=parseInt(N.charAt(1)+N.charAt(1),16)/255,this.b=parseInt(N.charAt(2)+N.charAt(2),16)/255,this;if(A===6)return this.r=parseInt(N.charAt(0)+N.charAt(1),16)/255,this.g=parseInt(N.charAt(2)+N.charAt(3),16)/255,this.b=parseInt(N.charAt(4)+N.charAt(5),16)/255,this}if(r&&r.length>0){var N=Dl[r];N!==void 0?this.setHex(N):console.warn("THREE.Color: Unknown color "+r)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(r){return this.r=r.r,this.g=r.g,this.b=r.b,this},copyGammaToLinear:function(r,o){return o===void 0&&(o=2),this.r=Math.pow(r.r,o),this.g=Math.pow(r.g,o),this.b=Math.pow(r.b,o),this},copyLinearToGamma:function(r,o){o===void 0&&(o=2);var h=o>0?1/o:1;return this.r=Math.pow(r.r,h),this.g=Math.pow(r.g,h),this.b=Math.pow(r.b,h),this},convertGammaToLinear:function(r){return this.copyGammaToLinear(this,r),this},convertLinearToGamma:function(r){return this.copyLinearToGamma(this,r),this},copySRGBToLinear:function(){function r(o){return o<.04045?o*.0773993808:Math.pow(o*.9478672986+.0521327014,2.4)}return function(h){return this.r=r(h.r),this.g=r(h.g),this.b=r(h.b),this}}(),copyLinearToSRGB:function(){function r(o){return o<.0031308?o*12.92:1.055*Math.pow(o,.41666)-.055}return function(h){return this.r=r(h.r),this.g=r(h.g),this.b=r(h.b),this}}(),convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return this.r*255<<16^this.g*255<<8^this.b*255<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(r){r===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),r={h:0,s:0,l:0});var o=this.r,h=this.g,u=this.b,g=Math.max(o,h,u),y=Math.min(o,h,u),T,I,D=(y+g)/2;if(y===g)T=0,I=0;else{var N=g-y;switch(I=D<=.5?N/(g+y):N/(2-g-y),g){case o:T=(h-u)/N+(h<u?6:0);break;case h:T=(u-o)/N+2;break;case u:T=(o-h)/N+4;break}T/=6}return r.h=T,r.s=I,r.l=D,r},getStyle:function(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"},offsetHSL:function(){var r={};return function(o,h,u){return this.getHSL(r),r.h+=o,r.s+=h,r.l+=u,this.setHSL(r.h,r.s,r.l),this}}(),add:function(r){return this.r+=r.r,this.g+=r.g,this.b+=r.b,this},addColors:function(r,o){return this.r=r.r+o.r,this.g=r.g+o.g,this.b=r.b+o.b,this},addScalar:function(r){return this.r+=r,this.g+=r,this.b+=r,this},sub:function(r){return this.r=Math.max(0,this.r-r.r),this.g=Math.max(0,this.g-r.g),this.b=Math.max(0,this.b-r.b),this},multiply:function(r){return this.r*=r.r,this.g*=r.g,this.b*=r.b,this},multiplyScalar:function(r){return this.r*=r,this.g*=r,this.b*=r,this},lerp:function(r,o){return this.r+=(r.r-this.r)*o,this.g+=(r.g-this.g)*o,this.b+=(r.b-this.b)*o,this},equals:function(r){return r.r===this.r&&r.g===this.g&&r.b===this.b},fromArray:function(r,o){return o===void 0&&(o=0),this.r=r[o],this.g=r[o+1],this.b=r[o+2],this},toArray:function(r,o){return r===void 0&&(r=[]),o===void 0&&(o=0),r[o]=this.r,r[o+1]=this.g,r[o+2]=this.b,r},toJSON:function(){return this.getHex()}});var Pt={common:{diffuse:{value:new Mt(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new wn},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new rt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Mt(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Mt(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new wn}}},Ps={basic:{uniforms:Tn.merge([Pt.common,Pt.specularmap,Pt.envmap,Pt.aomap,Pt.lightmap,Pt.fog]),vertexShader:Si.meshbasic_vert,fragmentShader:Si.meshbasic_frag},lambert:{uniforms:Tn.merge([Pt.common,Pt.specularmap,Pt.envmap,Pt.aomap,Pt.lightmap,Pt.emissivemap,Pt.fog,Pt.lights,{emissive:{value:new Mt(0)}}]),vertexShader:Si.meshlambert_vert,fragmentShader:Si.meshlambert_frag},phong:{uniforms:Tn.merge([Pt.common,Pt.specularmap,Pt.envmap,Pt.aomap,Pt.lightmap,Pt.emissivemap,Pt.bumpmap,Pt.normalmap,Pt.displacementmap,Pt.gradientmap,Pt.fog,Pt.lights,{emissive:{value:new Mt(0)},specular:{value:new Mt(1118481)},shininess:{value:30}}]),vertexShader:Si.meshphong_vert,fragmentShader:Si.meshphong_frag},standard:{uniforms:Tn.merge([Pt.common,Pt.envmap,Pt.aomap,Pt.lightmap,Pt.emissivemap,Pt.bumpmap,Pt.normalmap,Pt.displacementmap,Pt.roughnessmap,Pt.metalnessmap,Pt.fog,Pt.lights,{emissive:{value:new Mt(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Si.meshphysical_vert,fragmentShader:Si.meshphysical_frag},points:{uniforms:Tn.merge([Pt.points,Pt.fog]),vertexShader:Si.points_vert,fragmentShader:Si.points_frag},dashed:{uniforms:Tn.merge([Pt.common,Pt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Si.linedashed_vert,fragmentShader:Si.linedashed_frag},depth:{uniforms:Tn.merge([Pt.common,Pt.displacementmap]),vertexShader:Si.depth_vert,fragmentShader:Si.depth_frag},normal:{uniforms:Tn.merge([Pt.common,Pt.bumpmap,Pt.normalmap,Pt.displacementmap,{opacity:{value:1}}]),vertexShader:Si.normal_vert,fragmentShader:Si.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Si.cube_vert,fragmentShader:Si.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Si.equirect_vert,fragmentShader:Si.equirect_frag},distanceRGBA:{uniforms:Tn.merge([Pt.common,Pt.displacementmap,{referencePosition:{value:new he},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Si.distanceRGBA_vert,fragmentShader:Si.distanceRGBA_frag},shadow:{uniforms:Tn.merge([Pt.lights,Pt.fog,{color:{value:new Mt(0)},opacity:{value:1}}]),vertexShader:Si.shadow_vert,fragmentShader:Si.shadow_frag}};Ps.physical={uniforms:Tn.merge([Ps.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Si.meshphysical_vert,fragmentShader:Si.meshphysical_frag};function os(){var r=null,o=!1,h=null;function u(g,y){o!==!1&&(h(g,y),r.requestAnimationFrame(u))}return{start:function(){o!==!0&&h!==null&&(r.requestAnimationFrame(u),o=!0)},stop:function(){o=!1},setAnimationLoop:function(g){h=g},setContext:function(g){r=g}}}function ra(r){var o=new WeakMap;function h(I,D){var N=I.array,A=I.dynamic?r.DYNAMIC_DRAW:r.STATIC_DRAW,B=r.createBuffer();r.bindBuffer(D,B),r.bufferData(D,N,A),I.onUploadCallback();var F=r.FLOAT;return N instanceof Float32Array?F=r.FLOAT:N instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):N instanceof Uint16Array?F=r.UNSIGNED_SHORT:N instanceof Int16Array?F=r.SHORT:N instanceof Uint32Array?F=r.UNSIGNED_INT:N instanceof Int32Array?F=r.INT:N instanceof Int8Array?F=r.BYTE:N instanceof Uint8Array&&(F=r.UNSIGNED_BYTE),{buffer:B,type:F,bytesPerElement:N.BYTES_PER_ELEMENT,version:I.version}}function u(I,D,N){var A=D.array,B=D.updateRange;r.bindBuffer(N,I),D.dynamic===!1?r.bufferData(N,A,r.STATIC_DRAW):B.count===-1?r.bufferSubData(N,0,A):B.count===0?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(r.bufferSubData(N,B.offset*A.BYTES_PER_ELEMENT,A.subarray(B.offset,B.offset+B.count)),B.count=-1)}function g(I){return I.isInterleavedBufferAttribute&&(I=I.data),o.get(I)}function y(I){I.isInterleavedBufferAttribute&&(I=I.data);var D=o.get(I);D&&(r.deleteBuffer(D.buffer),o.delete(I))}function T(I,D){I.isInterleavedBufferAttribute&&(I=I.data);var N=o.get(I);N===void 0?o.set(I,h(I,D)):N.version<I.version&&(u(N.buffer,I,D),N.version=I.version)}return{get:g,remove:y,update:T}}function As(r,o,h,u){this._x=r||0,this._y=o||0,this._z=h||0,this._order=u||As.DefaultOrder}As.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],As.DefaultOrder="XYZ",Object.defineProperties(As.prototype,{x:{get:function(){return this._x},set:function(r){this._x=r,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(r){this._y=r,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(r){this._z=r,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(r){this._order=r,this.onChangeCallback()}}}),Object.assign(As.prototype,{isEuler:!0,set:function(r,o,h,u){return this._x=r,this._y=o,this._z=h,this._order=u||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(r){return this._x=r._x,this._y=r._y,this._z=r._z,this._order=r._order,this.onChangeCallback(),this},setFromRotationMatrix:function(r,o,h){var u=si.clamp,g=r.elements,y=g[0],T=g[4],I=g[8],D=g[1],N=g[5],A=g[9],B=g[2],F=g[6],G=g[10];return o=o||this._order,o==="XYZ"?(this._y=Math.asin(u(I,-1,1)),Math.abs(I)<.99999?(this._x=Math.atan2(-A,G),this._z=Math.atan2(-T,y)):(this._x=Math.atan2(F,N),this._z=0)):o==="YXZ"?(this._x=Math.asin(-u(A,-1,1)),Math.abs(A)<.99999?(this._y=Math.atan2(I,G),this._z=Math.atan2(D,N)):(this._y=Math.atan2(-B,y),this._z=0)):o==="ZXY"?(this._x=Math.asin(u(F,-1,1)),Math.abs(F)<.99999?(this._y=Math.atan2(-B,G),this._z=Math.atan2(-T,N)):(this._y=0,this._z=Math.atan2(D,y))):o==="ZYX"?(this._y=Math.asin(-u(B,-1,1)),Math.abs(B)<.99999?(this._x=Math.atan2(F,G),this._z=Math.atan2(D,y)):(this._x=0,this._z=Math.atan2(-T,N))):o==="YZX"?(this._z=Math.asin(u(D,-1,1)),Math.abs(D)<.99999?(this._x=Math.atan2(-A,N),this._y=Math.atan2(-B,y)):(this._x=0,this._y=Math.atan2(I,G))):o==="XZY"?(this._z=Math.asin(-u(T,-1,1)),Math.abs(T)<.99999?(this._x=Math.atan2(F,N),this._y=Math.atan2(I,y)):(this._x=Math.atan2(-A,G),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+o),this._order=o,h!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var r=new Ot;return function(h,u,g){return r.makeRotationFromQuaternion(h),this.setFromRotationMatrix(r,u,g)}}(),setFromVector3:function(r,o){return this.set(r.x,r.y,r.z,o||this._order)},reorder:function(){var r=new en;return function(h){return r.setFromEuler(this),this.setFromQuaternion(r,h)}}(),equals:function(r){return r._x===this._x&&r._y===this._y&&r._z===this._z&&r._order===this._order},fromArray:function(r){return this._x=r[0],this._y=r[1],this._z=r[2],r[3]!==void 0&&(this._order=r[3]),this.onChangeCallback(),this},toArray:function(r,o){return r===void 0&&(r=[]),o===void 0&&(o=0),r[o]=this._x,r[o+1]=this._y,r[o+2]=this._z,r[o+3]=this._order,r},toVector3:function(r){return r?r.set(this._x,this._y,this._z):new he(this._x,this._y,this._z)},onChange:function(r){return this.onChangeCallback=r,this},onChangeCallback:function(){}});function Ll(){this.mask=1}Object.assign(Ll.prototype,{set:function(r){this.mask=1<<r|0},enable:function(r){this.mask|=1<<r|0},toggle:function(r){this.mask^=1<<r|0},disable:function(r){this.mask&=~(1<<r|0)},test:function(r){return(this.mask&r.mask)!==0}});var Pc=0;function vt(){Object.defineProperty(this,"id",{value:Pc++}),this.uuid=si.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=vt.DefaultUp.clone();var r=new he,o=new As,h=new en,u=new he(1,1,1);function g(){h.setFromEuler(o,!1)}function y(){o.setFromQuaternion(h,void 0,!1)}o.onChange(g),h.onChange(y),Object.defineProperties(this,{position:{enumerable:!0,value:r},rotation:{enumerable:!0,value:o},quaternion:{enumerable:!0,value:h},scale:{enumerable:!0,value:u},modelViewMatrix:{value:new Ot},normalMatrix:{value:new wn}}),this.matrix=new Ot,this.matrixWorld=new Ot,this.matrixAutoUpdate=vt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Ll,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}vt.DefaultUp=new he(0,1,0),vt.DefaultMatrixAutoUpdate=!0,vt.prototype=Object.assign(Object.create(e.prototype),{constructor:vt,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(r){this.matrix.multiplyMatrices(r,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(r){return this.quaternion.premultiply(r),this},setRotationFromAxisAngle:function(r,o){this.quaternion.setFromAxisAngle(r,o)},setRotationFromEuler:function(r){this.quaternion.setFromEuler(r,!0)},setRotationFromMatrix:function(r){this.quaternion.setFromRotationMatrix(r)},setRotationFromQuaternion:function(r){this.quaternion.copy(r)},rotateOnAxis:function(){var r=new en;return function(h,u){return r.setFromAxisAngle(h,u),this.quaternion.multiply(r),this}}(),rotateOnWorldAxis:function(){var r=new en;return function(h,u){return r.setFromAxisAngle(h,u),this.quaternion.premultiply(r),this}}(),rotateX:function(){var r=new he(1,0,0);return function(h){return this.rotateOnAxis(r,h)}}(),rotateY:function(){var r=new he(0,1,0);return function(h){return this.rotateOnAxis(r,h)}}(),rotateZ:function(){var r=new he(0,0,1);return function(h){return this.rotateOnAxis(r,h)}}(),translateOnAxis:function(){var r=new he;return function(h,u){return r.copy(h).applyQuaternion(this.quaternion),this.position.add(r.multiplyScalar(u)),this}}(),translateX:function(){var r=new he(1,0,0);return function(h){return this.translateOnAxis(r,h)}}(),translateY:function(){var r=new he(0,1,0);return function(h){return this.translateOnAxis(r,h)}}(),translateZ:function(){var r=new he(0,0,1);return function(h){return this.translateOnAxis(r,h)}}(),localToWorld:function(r){return r.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var r=new Ot;return function(h){return h.applyMatrix4(r.getInverse(this.matrixWorld))}}(),lookAt:function(){var r=new Ot,o=new he;return function(u,g,y){u.isVector3?o.copy(u):o.set(u,g,y),this.isCamera?r.lookAt(this.position,o,this.up):r.lookAt(o,this.position,this.up),this.quaternion.setFromRotationMatrix(r)}}(),add:function(r){if(arguments.length>1){for(var o=0;o<arguments.length;o++)this.add(arguments[o]);return this}return r===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",r),this):(r&&r.isObject3D?(r.parent!==null&&r.parent.remove(r),r.parent=this,r.dispatchEvent({type:"added"}),this.children.push(r)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",r),this)},remove:function(r){if(arguments.length>1){for(var o=0;o<arguments.length;o++)this.remove(arguments[o]);return this}var h=this.children.indexOf(r);return h!==-1&&(r.parent=null,r.dispatchEvent({type:"removed"}),this.children.splice(h,1)),this},getObjectById:function(r){return this.getObjectByProperty("id",r)},getObjectByName:function(r){return this.getObjectByProperty("name",r)},getObjectByProperty:function(r,o){if(this[r]===o)return this;for(var h=0,u=this.children.length;h<u;h++){var g=this.children[h],y=g.getObjectByProperty(r,o);if(y!==void 0)return y}},getWorldPosition:function(r){return r===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),r=new he),this.updateMatrixWorld(!0),r.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var r=new he,o=new he;return function(u){return u===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),u=new en),this.updateMatrixWorld(!0),this.matrixWorld.decompose(r,u,o),u}}(),getWorldScale:function(){var r=new he,o=new en;return function(u){return u===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),u=new he),this.updateMatrixWorld(!0),this.matrixWorld.decompose(r,o,u),u}}(),getWorldDirection:function(){var r=new en;return function(h){return h===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),h=new he),this.getWorldQuaternion(r),h.set(0,0,1).applyQuaternion(r)}}(),raycast:function(){},traverse:function(r){r(this);for(var o=this.children,h=0,u=o.length;h<u;h++)o[h].traverse(r)},traverseVisible:function(r){if(this.visible!==!1){r(this);for(var o=this.children,h=0,u=o.length;h<u;h++)o[h].traverseVisible(r)}},traverseAncestors:function(r){var o=this.parent;o!==null&&(r(o),o.traverseAncestors(r))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(r){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||r)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,r=!0);for(var o=this.children,h=0,u=o.length;h<u;h++)o[h].updateMatrixWorld(r)},toJSON:function(r){var o=r===void 0||typeof r=="string",h={};o&&(r={geometries:{},materials:{},textures:{},images:{},shapes:{}},h.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var u={};u.uuid=this.uuid,u.type=this.type,this.name!==""&&(u.name=this.name),this.castShadow===!0&&(u.castShadow=!0),this.receiveShadow===!0&&(u.receiveShadow=!0),this.visible===!1&&(u.visible=!1),this.frustumCulled===!1&&(u.frustumCulled=!1),this.renderOrder!==0&&(u.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(u.userData=this.userData),u.layers=this.layers.mask,u.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(u.matrixAutoUpdate=!1);function g(Z,Q){return Z[Q.uuid]===void 0&&(Z[Q.uuid]=Q.toJSON(r)),Q.uuid}if(this.geometry!==void 0){u.geometry=g(r.geometries,this.geometry);var y=this.geometry.parameters;if(y!==void 0&&y.shapes!==void 0){var T=y.shapes;if(Array.isArray(T))for(var I=0,D=T.length;I<D;I++){var N=T[I];g(r.shapes,N)}else g(r.shapes,T)}}if(this.material!==void 0)if(Array.isArray(this.material)){for(var A=[],I=0,D=this.material.length;I<D;I++)A.push(g(r.materials,this.material[I]));u.material=A}else u.material=g(r.materials,this.material);if(this.children.length>0){u.children=[];for(var I=0;I<this.children.length;I++)u.children.push(this.children[I].toJSON(r).object)}if(o){var B=$(r.geometries),F=$(r.materials),G=$(r.textures),j=$(r.images),T=$(r.shapes);B.length>0&&(h.geometries=B),F.length>0&&(h.materials=F),G.length>0&&(h.textures=G),j.length>0&&(h.images=j),T.length>0&&(h.shapes=T)}return h.object=u,h;function $(Z){var Q=[];for(var ie in Z){var ne=Z[ie];delete ne.metadata,Q.push(ne)}return Q}},clone:function(r){return new this.constructor().copy(this,r)},copy:function(r,o){if(o===void 0&&(o=!0),this.name=r.name,this.up.copy(r.up),this.position.copy(r.position),this.quaternion.copy(r.quaternion),this.scale.copy(r.scale),this.matrix.copy(r.matrix),this.matrixWorld.copy(r.matrixWorld),this.matrixAutoUpdate=r.matrixAutoUpdate,this.matrixWorldNeedsUpdate=r.matrixWorldNeedsUpdate,this.layers.mask=r.layers.mask,this.visible=r.visible,this.castShadow=r.castShadow,this.receiveShadow=r.receiveShadow,this.frustumCulled=r.frustumCulled,this.renderOrder=r.renderOrder,this.userData=JSON.parse(JSON.stringify(r.userData)),o===!0)for(var h=0;h<r.children.length;h++){var u=r.children[h];this.add(u.clone())}return this}});function Ir(){vt.call(this),this.type="Camera",this.matrixWorldInverse=new Ot,this.projectionMatrix=new Ot}Ir.prototype=Object.assign(Object.create(vt.prototype),{constructor:Ir,isCamera:!0,copy:function(r,o){return vt.prototype.copy.call(this,r,o),this.matrixWorldInverse.copy(r.matrixWorldInverse),this.projectionMatrix.copy(r.projectionMatrix),this},getWorldDirection:function(){var r=new en;return function(h){return h===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),h=new he),this.getWorldQuaternion(r),h.set(0,0,-1).applyQuaternion(r)}}(),updateMatrixWorld:function(r){vt.prototype.updateMatrixWorld.call(this,r),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}});function sa(r,o,h,u,g,y){Ir.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=r,this.right=o,this.top=h,this.bottom=u,this.near=g!==void 0?g:.1,this.far=y!==void 0?y:2e3,this.updateProjectionMatrix()}sa.prototype=Object.assign(Object.create(Ir.prototype),{constructor:sa,isOrthographicCamera:!0,copy:function(r,o){return Ir.prototype.copy.call(this,r,o),this.left=r.left,this.right=r.right,this.top=r.top,this.bottom=r.bottom,this.near=r.near,this.far=r.far,this.zoom=r.zoom,this.view=r.view===null?null:Object.assign({},r.view),this},setViewOffset:function(r,o,h,u,g,y){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=o,this.view.offsetX=h,this.view.offsetY=u,this.view.width=g,this.view.height=y,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var r=(this.right-this.left)/(2*this.zoom),o=(this.top-this.bottom)/(2*this.zoom),h=(this.right+this.left)/2,u=(this.top+this.bottom)/2,g=h-r,y=h+r,T=u+o,I=u-o;if(this.view!==null&&this.view.enabled){var D=this.zoom/(this.view.width/this.view.fullWidth),N=this.zoom/(this.view.height/this.view.fullHeight),A=(this.right-this.left)/this.view.width,B=(this.top-this.bottom)/this.view.height;g+=A*(this.view.offsetX/D),y=g+A*(this.view.width/D),T-=B*(this.view.offsetY/N),I=T-B*(this.view.height/N)}this.projectionMatrix.makeOrthographic(g,y,T,I,this.near,this.far)},toJSON:function(r){var o=vt.prototype.toJSON.call(this,r);return o.object.zoom=this.zoom,o.object.left=this.left,o.object.right=this.right,o.object.top=this.top,o.object.bottom=this.bottom,o.object.near=this.near,o.object.far=this.far,this.view!==null&&(o.object.view=Object.assign({},this.view)),o}});function tn(r,o,h,u,g,y){this.a=r,this.b=o,this.c=h,this.normal=u&&u.isVector3?u:new he,this.vertexNormals=Array.isArray(u)?u:[],this.color=g&&g.isColor?g:new Mt,this.vertexColors=Array.isArray(g)?g:[],this.materialIndex=y!==void 0?y:0}Object.assign(tn.prototype,{clone:function(){return new this.constructor().copy(this)},copy:function(r){this.a=r.a,this.b=r.b,this.c=r.c,this.normal.copy(r.normal),this.color.copy(r.color),this.materialIndex=r.materialIndex;for(var o=0,h=r.vertexNormals.length;o<h;o++)this.vertexNormals[o]=r.vertexNormals[o].clone();for(var o=0,h=r.vertexColors.length;o<h;o++)this.vertexColors[o]=r.vertexColors[o].clone();return this}});var pn=0;function xt(){Object.defineProperty(this,"id",{value:pn+=2}),this.uuid=si.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}xt.prototype=Object.assign(Object.create(e.prototype),{constructor:xt,isGeometry:!0,applyMatrix:function(r){for(var o=new wn().getNormalMatrix(r),h=0,u=this.vertices.length;h<u;h++){var g=this.vertices[h];g.applyMatrix4(r)}for(var h=0,u=this.faces.length;h<u;h++){var y=this.faces[h];y.normal.applyMatrix3(o).normalize();for(var T=0,I=y.vertexNormals.length;T<I;T++)y.vertexNormals[T].applyMatrix3(o).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var r=new Ot;return function(h){return r.makeRotationX(h),this.applyMatrix(r),this}}(),rotateY:function(){var r=new Ot;return function(h){return r.makeRotationY(h),this.applyMatrix(r),this}}(),rotateZ:function(){var r=new Ot;return function(h){return r.makeRotationZ(h),this.applyMatrix(r),this}}(),translate:function(){var r=new Ot;return function(h,u,g){return r.makeTranslation(h,u,g),this.applyMatrix(r),this}}(),scale:function(){var r=new Ot;return function(h,u,g){return r.makeScale(h,u,g),this.applyMatrix(r),this}}(),lookAt:function(){var r=new vt;return function(h){r.lookAt(h),r.updateMatrix(),this.applyMatrix(r.matrix)}}(),fromBufferGeometry:function(r){var o=this,h=r.index!==null?r.index.array:void 0,u=r.attributes,g=u.position.array,y=u.normal!==void 0?u.normal.array:void 0,T=u.color!==void 0?u.color.array:void 0,I=u.uv!==void 0?u.uv.array:void 0,D=u.uv2!==void 0?u.uv2.array:void 0;D!==void 0&&(this.faceVertexUvs[1]=[]);for(var N=[],A=[],B=[],F=0,G=0;F<g.length;F+=3,G+=2)o.vertices.push(new he(g[F],g[F+1],g[F+2])),y!==void 0&&N.push(new he(y[F],y[F+1],y[F+2])),T!==void 0&&o.colors.push(new Mt(T[F],T[F+1],T[F+2])),I!==void 0&&A.push(new rt(I[G],I[G+1])),D!==void 0&&B.push(new rt(D[G],D[G+1]));function j(ae,ye,ge,be){var Ee=y!==void 0?[N[ae].clone(),N[ye].clone(),N[ge].clone()]:[],Se=T!==void 0?[o.colors[ae].clone(),o.colors[ye].clone(),o.colors[ge].clone()]:[],Re=new tn(ae,ye,ge,Ee,Se,be);o.faces.push(Re),I!==void 0&&o.faceVertexUvs[0].push([A[ae].clone(),A[ye].clone(),A[ge].clone()]),D!==void 0&&o.faceVertexUvs[1].push([B[ae].clone(),B[ye].clone(),B[ge].clone()])}var $=r.groups;if($.length>0)for(var F=0;F<$.length;F++)for(var Z=$[F],Q=Z.start,ie=Z.count,G=Q,ne=Q+ie;G<ne;G+=3)h!==void 0?j(h[G],h[G+1],h[G+2],Z.materialIndex):j(G,G+1,G+2,Z.materialIndex);else if(h!==void 0)for(var F=0;F<h.length;F+=3)j(h[F],h[F+1],h[F+2]);else for(var F=0;F<g.length/3;F+=3)j(F,F+1,F+2);return this.computeFaceNormals(),r.boundingBox!==null&&(this.boundingBox=r.boundingBox.clone()),r.boundingSphere!==null&&(this.boundingSphere=r.boundingSphere.clone()),this},center:function(){var r=new he;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(r).negate(),this.translate(r.x,r.y,r.z),this}}(),normalize:function(){this.computeBoundingSphere();var r=this.boundingSphere.center,o=this.boundingSphere.radius,h=o===0?1:1/o,u=new Ot;return u.set(h,0,0,-h*r.x,0,h,0,-h*r.y,0,0,h,-h*r.z,0,0,0,1),this.applyMatrix(u),this},computeFaceNormals:function(){for(var r=new he,o=new he,h=0,u=this.faces.length;h<u;h++){var g=this.faces[h],y=this.vertices[g.a],T=this.vertices[g.b],I=this.vertices[g.c];r.subVectors(I,T),o.subVectors(y,T),r.cross(o),r.normalize(),g.normal.copy(r)}},computeVertexNormals:function(r){r===void 0&&(r=!0);var o,h,u,g,y,T;for(T=new Array(this.vertices.length),o=0,h=this.vertices.length;o<h;o++)T[o]=new he;if(r){var I,D,N,A=new he,B=new he;for(u=0,g=this.faces.length;u<g;u++)y=this.faces[u],I=this.vertices[y.a],D=this.vertices[y.b],N=this.vertices[y.c],A.subVectors(N,D),B.subVectors(I,D),A.cross(B),T[y.a].add(A),T[y.b].add(A),T[y.c].add(A)}else for(this.computeFaceNormals(),u=0,g=this.faces.length;u<g;u++)y=this.faces[u],T[y.a].add(y.normal),T[y.b].add(y.normal),T[y.c].add(y.normal);for(o=0,h=this.vertices.length;o<h;o++)T[o].normalize();for(u=0,g=this.faces.length;u<g;u++){y=this.faces[u];var F=y.vertexNormals;F.length===3?(F[0].copy(T[y.a]),F[1].copy(T[y.b]),F[2].copy(T[y.c])):(F[0]=T[y.a].clone(),F[1]=T[y.b].clone(),F[2]=T[y.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var r,o,h;for(this.computeFaceNormals(),r=0,o=this.faces.length;r<o;r++){h=this.faces[r];var u=h.vertexNormals;u.length===3?(u[0].copy(h.normal),u[1].copy(h.normal),u[2].copy(h.normal)):(u[0]=h.normal.clone(),u[1]=h.normal.clone(),u[2]=h.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var r,o,h,u,g;for(h=0,u=this.faces.length;h<u;h++)for(g=this.faces[h],g.__originalFaceNormal?g.__originalFaceNormal.copy(g.normal):g.__originalFaceNormal=g.normal.clone(),g.__originalVertexNormals||(g.__originalVertexNormals=[]),r=0,o=g.vertexNormals.length;r<o;r++)g.__originalVertexNormals[r]?g.__originalVertexNormals[r].copy(g.vertexNormals[r]):g.__originalVertexNormals[r]=g.vertexNormals[r].clone();var y=new xt;for(y.faces=this.faces,r=0,o=this.morphTargets.length;r<o;r++){if(!this.morphNormals[r]){this.morphNormals[r]={},this.morphNormals[r].faceNormals=[],this.morphNormals[r].vertexNormals=[];var T=this.morphNormals[r].faceNormals,I=this.morphNormals[r].vertexNormals,N,A;for(h=0,u=this.faces.length;h<u;h++)N=new he,A={a:new he,b:new he,c:new he},T.push(N),I.push(A)}var D=this.morphNormals[r];y.vertices=this.morphTargets[r].vertices,y.computeFaceNormals(),y.computeVertexNormals();var N,A;for(h=0,u=this.faces.length;h<u;h++)g=this.faces[h],N=D.faceNormals[h],A=D.vertexNormals[h],N.copy(g.normal),A.a.copy(g.vertexNormals[0]),A.b.copy(g.vertexNormals[1]),A.c.copy(g.vertexNormals[2])}for(h=0,u=this.faces.length;h<u;h++)g=this.faces[h],g.normal=g.__originalFaceNormal,g.vertexNormals=g.__originalVertexNormals},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Jn),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new nr),this.boundingSphere.setFromPoints(this.vertices)},merge:function(r,o,h){if(!(r&&r.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",r);return}var u,g=this.vertices.length,y=this.vertices,T=r.vertices,I=this.faces,D=r.faces,N=this.faceVertexUvs[0],A=r.faceVertexUvs[0],B=this.colors,F=r.colors;h===void 0&&(h=0),o!==void 0&&(u=new wn().getNormalMatrix(o));for(var G=0,j=T.length;G<j;G++){var $=T[G],Z=$.clone();o!==void 0&&Z.applyMatrix4(o),y.push(Z)}for(var G=0,j=F.length;G<j;G++)B.push(F[G].clone());for(G=0,j=D.length;G<j;G++){var Q=D[G],ie,ne,ae,ye=Q.vertexNormals,ge=Q.vertexColors;ie=new tn(Q.a+g,Q.b+g,Q.c+g),ie.normal.copy(Q.normal),u!==void 0&&ie.normal.applyMatrix3(u).normalize();for(var be=0,Ee=ye.length;be<Ee;be++)ne=ye[be].clone(),u!==void 0&&ne.applyMatrix3(u).normalize(),ie.vertexNormals.push(ne);ie.color.copy(Q.color);for(var be=0,Ee=ge.length;be<Ee;be++)ae=ge[be],ie.vertexColors.push(ae.clone());ie.materialIndex=Q.materialIndex+h,I.push(ie)}for(G=0,j=A.length;G<j;G++){var Se=A[G],Re=[];if(Se!==void 0){for(var be=0,Ee=Se.length;be<Ee;be++)Re.push(Se[be].clone());N.push(Re)}}},mergeMesh:function(r){if(!(r&&r.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",r);return}r.matrixAutoUpdate&&r.updateMatrix(),this.merge(r.geometry,r.matrix)},mergeVertices:function(){var r={},o=[],h=[],u,g,y=4,T=Math.pow(10,y),I,D,N,A,B,F;for(I=0,D=this.vertices.length;I<D;I++)u=this.vertices[I],g=Math.round(u.x*T)+"_"+Math.round(u.y*T)+"_"+Math.round(u.z*T),r[g]===void 0?(r[g]=I,o.push(this.vertices[I]),h[I]=o.length-1):h[I]=h[r[g]];var G=[];for(I=0,D=this.faces.length;I<D;I++){N=this.faces[I],N.a=h[N.a],N.b=h[N.b],N.c=h[N.c],A=[N.a,N.b,N.c];for(var j=0;j<3;j++)if(A[j]===A[(j+1)%3]){G.push(I);break}}for(I=G.length-1;I>=0;I--){var $=G[I];for(this.faces.splice($,1),B=0,F=this.faceVertexUvs.length;B<F;B++)this.faceVertexUvs[B].splice($,1)}var Z=this.vertices.length-o.length;return this.vertices=o,Z},setFromPoints:function(r){this.vertices=[];for(var o=0,h=r.length;o<h;o++){var u=r[o];this.vertices.push(new he(u.x,u.y,u.z||0))}return this},sortFacesByMaterialIndex:function(){for(var r=this.faces,o=r.length,h=0;h<o;h++)r[h]._id=h;function u(N,A){return N.materialIndex-A.materialIndex}r.sort(u);var g=this.faceVertexUvs[0],y=this.faceVertexUvs[1],T,I;g&&g.length===o&&(T=[]),y&&y.length===o&&(I=[]);for(var h=0;h<o;h++){var D=r[h]._id;T&&T.push(g[D]),I&&I.push(y[D])}T&&(this.faceVertexUvs[0]=T),I&&(this.faceVertexUvs[1]=I)},toJSON:function(){var r={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.parameters!==void 0){var o=this.parameters;for(var h in o)o[h]!==void 0&&(r[h]=o[h]);return r}for(var u=[],g=0;g<this.vertices.length;g++){var y=this.vertices[g];u.push(y.x,y.y,y.z)}for(var T=[],I=[],D={},N=[],A={},B=[],F={},g=0;g<this.faces.length;g++){var G=this.faces[g],j=!0,$=!1,Z=this.faceVertexUvs[0][g]!==void 0,Q=G.normal.length()>0,ie=G.vertexNormals.length>0,ne=G.color.r!==1||G.color.g!==1||G.color.b!==1,ae=G.vertexColors.length>0,ye=0;if(ye=Se(ye,0,0),ye=Se(ye,1,j),ye=Se(ye,2,$),ye=Se(ye,3,Z),ye=Se(ye,4,Q),ye=Se(ye,5,ie),ye=Se(ye,6,ne),ye=Se(ye,7,ae),T.push(ye),T.push(G.a,G.b,G.c),T.push(G.materialIndex),Z){var ge=this.faceVertexUvs[0][g];T.push(Ve(ge[0]),Ve(ge[1]),Ve(ge[2]))}if(Q&&T.push(Re(G.normal)),ie){var be=G.vertexNormals;T.push(Re(be[0]),Re(be[1]),Re(be[2]))}if(ne&&T.push(Ie(G.color)),ae){var Ee=G.vertexColors;T.push(Ie(Ee[0]),Ie(Ee[1]),Ie(Ee[2]))}}function Se(ot,ct,pt){return pt?ot|1<<ct:ot&~(1<<ct)}function Re(ot){var ct=ot.x.toString()+ot.y.toString()+ot.z.toString();return D[ct]!==void 0||(D[ct]=I.length/3,I.push(ot.x,ot.y,ot.z)),D[ct]}function Ie(ot){var ct=ot.r.toString()+ot.g.toString()+ot.b.toString();return A[ct]!==void 0||(A[ct]=N.length,N.push(ot.getHex())),A[ct]}function Ve(ot){var ct=ot.x.toString()+ot.y.toString();return F[ct]!==void 0||(F[ct]=B.length/2,B.push(ot.x,ot.y)),F[ct]}return r.data={},r.data.vertices=u,r.data.normals=I,N.length>0&&(r.data.colors=N),B.length>0&&(r.data.uvs=[B]),r.data.faces=T,r},clone:function(){return new xt().copy(this)},copy:function(r){var o,h,u,g,y,T;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=r.name;var I=r.vertices;for(o=0,h=I.length;o<h;o++)this.vertices.push(I[o].clone());var D=r.colors;for(o=0,h=D.length;o<h;o++)this.colors.push(D[o].clone());var N=r.faces;for(o=0,h=N.length;o<h;o++)this.faces.push(N[o].clone());for(o=0,h=r.faceVertexUvs.length;o<h;o++){var A=r.faceVertexUvs[o];for(this.faceVertexUvs[o]===void 0&&(this.faceVertexUvs[o]=[]),u=0,g=A.length;u<g;u++){var B=A[u],F=[];for(y=0,T=B.length;y<T;y++){var G=B[y];F.push(G.clone())}this.faceVertexUvs[o].push(F)}}var j=r.morphTargets;for(o=0,h=j.length;o<h;o++){var $={};if($.name=j[o].name,j[o].vertices!==void 0)for($.vertices=[],u=0,g=j[o].vertices.length;u<g;u++)$.vertices.push(j[o].vertices[u].clone());if(j[o].normals!==void 0)for($.normals=[],u=0,g=j[o].normals.length;u<g;u++)$.normals.push(j[o].normals[u].clone());this.morphTargets.push($)}var Z=r.morphNormals;for(o=0,h=Z.length;o<h;o++){var Q={};if(Z[o].vertexNormals!==void 0)for(Q.vertexNormals=[],u=0,g=Z[o].vertexNormals.length;u<g;u++){var ie=Z[o].vertexNormals[u],ne={};ne.a=ie.a.clone(),ne.b=ie.b.clone(),ne.c=ie.c.clone(),Q.vertexNormals.push(ne)}if(Z[o].faceNormals!==void 0)for(Q.faceNormals=[],u=0,g=Z[o].faceNormals.length;u<g;u++)Q.faceNormals.push(Z[o].faceNormals[u].clone());this.morphNormals.push(Q)}var ae=r.skinWeights;for(o=0,h=ae.length;o<h;o++)this.skinWeights.push(ae[o].clone());var ye=r.skinIndices;for(o=0,h=ye.length;o<h;o++)this.skinIndices.push(ye[o].clone());var ge=r.lineDistances;for(o=0,h=ge.length;o<h;o++)this.lineDistances.push(ge[o]);var be=r.boundingBox;be!==null&&(this.boundingBox=be.clone());var Ee=r.boundingSphere;return Ee!==null&&(this.boundingSphere=Ee.clone()),this.elementsNeedUpdate=r.elementsNeedUpdate,this.verticesNeedUpdate=r.verticesNeedUpdate,this.uvsNeedUpdate=r.uvsNeedUpdate,this.normalsNeedUpdate=r.normalsNeedUpdate,this.colorsNeedUpdate=r.colorsNeedUpdate,this.lineDistancesNeedUpdate=r.lineDistancesNeedUpdate,this.groupsNeedUpdate=r.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function At(r,o,h){if(Array.isArray(r))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=r,this.itemSize=o,this.count=r!==void 0?r.length/o:0,this.normalized=h===!0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(At.prototype,"needsUpdate",{set:function(r){r===!0&&this.version++}}),Object.assign(At.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(r){if(Array.isArray(r))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=r!==void 0?r.length/this.itemSize:0,this.array=r,this},setDynamic:function(r){return this.dynamic=r,this},copy:function(r){return this.name=r.name,this.array=new r.array.constructor(r.array),this.itemSize=r.itemSize,this.count=r.count,this.normalized=r.normalized,this.dynamic=r.dynamic,this},copyAt:function(r,o,h){r*=this.itemSize,h*=o.itemSize;for(var u=0,g=this.itemSize;u<g;u++)this.array[r+u]=o.array[h+u];return this},copyArray:function(r){return this.array.set(r),this},copyColorsArray:function(r){for(var o=this.array,h=0,u=0,g=r.length;u<g;u++){var y=r[u];y===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",u),y=new Mt),o[h++]=y.r,o[h++]=y.g,o[h++]=y.b}return this},copyVector2sArray:function(r){for(var o=this.array,h=0,u=0,g=r.length;u<g;u++){var y=r[u];y===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",u),y=new rt),o[h++]=y.x,o[h++]=y.y}return this},copyVector3sArray:function(r){for(var o=this.array,h=0,u=0,g=r.length;u<g;u++){var y=r[u];y===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",u),y=new he),o[h++]=y.x,o[h++]=y.y,o[h++]=y.z}return this},copyVector4sArray:function(r){for(var o=this.array,h=0,u=0,g=r.length;u<g;u++){var y=r[u];y===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",u),y=new wi),o[h++]=y.x,o[h++]=y.y,o[h++]=y.z,o[h++]=y.w}return this},set:function(r,o){return o===void 0&&(o=0),this.array.set(r,o),this},getX:function(r){return this.array[r*this.itemSize]},setX:function(r,o){return this.array[r*this.itemSize]=o,this},getY:function(r){return this.array[r*this.itemSize+1]},setY:function(r,o){return this.array[r*this.itemSize+1]=o,this},getZ:function(r){return this.array[r*this.itemSize+2]},setZ:function(r,o){return this.array[r*this.itemSize+2]=o,this},getW:function(r){return this.array[r*this.itemSize+3]},setW:function(r,o){return this.array[r*this.itemSize+3]=o,this},setXY:function(r,o,h){return r*=this.itemSize,this.array[r+0]=o,this.array[r+1]=h,this},setXYZ:function(r,o,h,u){return r*=this.itemSize,this.array[r+0]=o,this.array[r+1]=h,this.array[r+2]=u,this},setXYZW:function(r,o,h,u,g){return r*=this.itemSize,this.array[r+0]=o,this.array[r+1]=h,this.array[r+2]=u,this.array[r+3]=g,this},onUpload:function(r){return this.onUploadCallback=r,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}});function on(r,o,h){At.call(this,new Int8Array(r),o,h)}on.prototype=Object.create(At.prototype),on.prototype.constructor=on;function sr(r,o,h){At.call(this,new Uint8Array(r),o,h)}sr.prototype=Object.create(At.prototype),sr.prototype.constructor=sr;function ar(r,o,h){At.call(this,new Uint8ClampedArray(r),o,h)}ar.prototype=Object.create(At.prototype),ar.prototype.constructor=ar;function ls(r,o,h){At.call(this,new Int16Array(r),o,h)}ls.prototype=Object.create(At.prototype),ls.prototype.constructor=ls;function Bs(r,o,h){At.call(this,new Uint16Array(r),o,h)}Bs.prototype=Object.create(At.prototype),Bs.prototype.constructor=Bs;function aa(r,o,h){At.call(this,new Int32Array(r),o,h)}aa.prototype=Object.create(At.prototype),aa.prototype.constructor=aa;function pr(r,o,h){At.call(this,new Uint32Array(r),o,h)}pr.prototype=Object.create(At.prototype),pr.prototype.constructor=pr;function _t(r,o,h){At.call(this,new Float32Array(r),o,h)}_t.prototype=Object.create(At.prototype),_t.prototype.constructor=_t;function ds(r,o,h){At.call(this,new Float64Array(r),o,h)}ds.prototype=Object.create(At.prototype),ds.prototype.constructor=ds;function nh(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}Object.assign(nh.prototype,{computeGroups:function(r){for(var o,h=[],u=void 0,g=r.faces,y=0;y<g.length;y++){var T=g[y];T.materialIndex!==u&&(u=T.materialIndex,o!==void 0&&(o.count=y*3-o.start,h.push(o)),o={start:y*3,materialIndex:u})}o!==void 0&&(o.count=y*3-o.start,h.push(o)),this.groups=h},fromGeometry:function(r){var o=r.faces,h=r.vertices,u=r.faceVertexUvs,g=u[0]&&u[0].length>0,y=u[1]&&u[1].length>0,T=r.morphTargets,I=T.length,D;if(I>0){D=[];for(var N=0;N<I;N++)D[N]=[];this.morphTargets.position=D}var A=r.morphNormals,B=A.length,F;if(B>0){F=[];for(var N=0;N<B;N++)F[N]=[];this.morphTargets.normal=F}var G=r.skinIndices,j=r.skinWeights,$=G.length===h.length,Z=j.length===h.length;h.length>0&&o.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(var N=0;N<o.length;N++){var Q=o[N];this.vertices.push(h[Q.a],h[Q.b],h[Q.c]);var ie=Q.vertexNormals;if(ie.length===3)this.normals.push(ie[0],ie[1],ie[2]);else{var ne=Q.normal;this.normals.push(ne,ne,ne)}var ae=Q.vertexColors;if(ae.length===3)this.colors.push(ae[0],ae[1],ae[2]);else{var ye=Q.color;this.colors.push(ye,ye,ye)}if(g===!0){var ge=u[0][N];ge!==void 0?this.uvs.push(ge[0],ge[1],ge[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",N),this.uvs.push(new rt,new rt,new rt))}if(y===!0){var ge=u[1][N];ge!==void 0?this.uvs2.push(ge[0],ge[1],ge[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",N),this.uvs2.push(new rt,new rt,new rt))}for(var be=0;be<I;be++){var Ee=T[be].vertices;D[be].push(Ee[Q.a],Ee[Q.b],Ee[Q.c])}for(var be=0;be<B;be++){var Se=A[be].vertexNormals[N];F[be].push(Se.a,Se.b,Se.c)}$&&this.skinIndices.push(G[Q.a],G[Q.b],G[Q.c]),Z&&this.skinWeights.push(j[Q.a],j[Q.b],j[Q.c])}return this.computeGroups(r),this.verticesNeedUpdate=r.verticesNeedUpdate,this.normalsNeedUpdate=r.normalsNeedUpdate,this.colorsNeedUpdate=r.colorsNeedUpdate,this.uvsNeedUpdate=r.uvsNeedUpdate,this.groupsNeedUpdate=r.groupsNeedUpdate,this}});function Ao(r){if(r.length===0)return-1/0;for(var o=r[0],h=1,u=r.length;h<u;++h)r[h]>o&&(o=r[h]);return o}var rh=1;function Tt(){Object.defineProperty(this,"id",{value:rh+=2}),this.uuid=si.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Tt.prototype=Object.assign(Object.create(e.prototype),{constructor:Tt,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(r){Array.isArray(r)?this.index=new(Ao(r)>65535?pr:Bs)(r,1):this.index=r},addAttribute:function(r,o){return!(o&&o.isBufferAttribute)&&!(o&&o.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(r,new At(arguments[1],arguments[2]))):r==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(o),this):(this.attributes[r]=o,this)},getAttribute:function(r){return this.attributes[r]},removeAttribute:function(r){return delete this.attributes[r],this},addGroup:function(r,o,h){this.groups.push({start:r,count:o,materialIndex:h!==void 0?h:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(r,o){this.drawRange.start=r,this.drawRange.count=o},applyMatrix:function(r){var o=this.attributes.position;o!==void 0&&(r.applyToBufferAttribute(o),o.needsUpdate=!0);var h=this.attributes.normal;if(h!==void 0){var u=new wn().getNormalMatrix(r);u.applyToBufferAttribute(h),h.needsUpdate=!0}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(){var r=new Ot;return function(h){return r.makeRotationX(h),this.applyMatrix(r),this}}(),rotateY:function(){var r=new Ot;return function(h){return r.makeRotationY(h),this.applyMatrix(r),this}}(),rotateZ:function(){var r=new Ot;return function(h){return r.makeRotationZ(h),this.applyMatrix(r),this}}(),translate:function(){var r=new Ot;return function(h,u,g){return r.makeTranslation(h,u,g),this.applyMatrix(r),this}}(),scale:function(){var r=new Ot;return function(h,u,g){return r.makeScale(h,u,g),this.applyMatrix(r),this}}(),lookAt:function(){var r=new vt;return function(h){r.lookAt(h),r.updateMatrix(),this.applyMatrix(r.matrix)}}(),center:function(){var r=new he;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(r).negate(),this.translate(r.x,r.y,r.z),this}}(),setFromObject:function(r){var o=r.geometry;if(r.isPoints||r.isLine){var h=new _t(o.vertices.length*3,3),u=new _t(o.colors.length*3,3);if(this.addAttribute("position",h.copyVector3sArray(o.vertices)),this.addAttribute("color",u.copyColorsArray(o.colors)),o.lineDistances&&o.lineDistances.length===o.vertices.length){var g=new _t(o.lineDistances.length,1);this.addAttribute("lineDistance",g.copyArray(o.lineDistances))}o.boundingSphere!==null&&(this.boundingSphere=o.boundingSphere.clone()),o.boundingBox!==null&&(this.boundingBox=o.boundingBox.clone())}else r.isMesh&&o&&o.isGeometry&&this.fromGeometry(o);return this},setFromPoints:function(r){for(var o=[],h=0,u=r.length;h<u;h++){var g=r[h];o.push(g.x,g.y,g.z||0)}return this.addAttribute("position",new _t(o,3)),this},updateFromObject:function(r){var o=r.geometry;if(r.isMesh){var h=o.__directGeometry;if(o.elementsNeedUpdate===!0&&(h=void 0,o.elementsNeedUpdate=!1),h===void 0)return this.fromGeometry(o);h.verticesNeedUpdate=o.verticesNeedUpdate,h.normalsNeedUpdate=o.normalsNeedUpdate,h.colorsNeedUpdate=o.colorsNeedUpdate,h.uvsNeedUpdate=o.uvsNeedUpdate,h.groupsNeedUpdate=o.groupsNeedUpdate,o.verticesNeedUpdate=!1,o.normalsNeedUpdate=!1,o.colorsNeedUpdate=!1,o.uvsNeedUpdate=!1,o.groupsNeedUpdate=!1,o=h}var u;return o.verticesNeedUpdate===!0&&(u=this.attributes.position,u!==void 0&&(u.copyVector3sArray(o.vertices),u.needsUpdate=!0),o.verticesNeedUpdate=!1),o.normalsNeedUpdate===!0&&(u=this.attributes.normal,u!==void 0&&(u.copyVector3sArray(o.normals),u.needsUpdate=!0),o.normalsNeedUpdate=!1),o.colorsNeedUpdate===!0&&(u=this.attributes.color,u!==void 0&&(u.copyColorsArray(o.colors),u.needsUpdate=!0),o.colorsNeedUpdate=!1),o.uvsNeedUpdate&&(u=this.attributes.uv,u!==void 0&&(u.copyVector2sArray(o.uvs),u.needsUpdate=!0),o.uvsNeedUpdate=!1),o.lineDistancesNeedUpdate&&(u=this.attributes.lineDistance,u!==void 0&&(u.copyArray(o.lineDistances),u.needsUpdate=!0),o.lineDistancesNeedUpdate=!1),o.groupsNeedUpdate&&(o.computeGroups(r.geometry),this.groups=o.groups,o.groupsNeedUpdate=!1),this},fromGeometry:function(r){return r.__directGeometry=new nh().fromGeometry(r),this.fromDirectGeometry(r.__directGeometry)},fromDirectGeometry:function(r){var o=new Float32Array(r.vertices.length*3);if(this.addAttribute("position",new At(o,3).copyVector3sArray(r.vertices)),r.normals.length>0){var h=new Float32Array(r.normals.length*3);this.addAttribute("normal",new At(h,3).copyVector3sArray(r.normals))}if(r.colors.length>0){var u=new Float32Array(r.colors.length*3);this.addAttribute("color",new At(u,3).copyColorsArray(r.colors))}if(r.uvs.length>0){var g=new Float32Array(r.uvs.length*2);this.addAttribute("uv",new At(g,2).copyVector2sArray(r.uvs))}if(r.uvs2.length>0){var y=new Float32Array(r.uvs2.length*2);this.addAttribute("uv2",new At(y,2).copyVector2sArray(r.uvs2))}this.groups=r.groups;for(var T in r.morphTargets){for(var I=[],D=r.morphTargets[T],N=0,A=D.length;N<A;N++){var B=D[N],F=new _t(B.length*3,3);I.push(F.copyVector3sArray(B))}this.morphAttributes[T]=I}if(r.skinIndices.length>0){var G=new _t(r.skinIndices.length*4,4);this.addAttribute("skinIndex",G.copyVector4sArray(r.skinIndices))}if(r.skinWeights.length>0){var j=new _t(r.skinWeights.length*4,4);this.addAttribute("skinWeight",j.copyVector4sArray(r.skinWeights))}return r.boundingSphere!==null&&(this.boundingSphere=r.boundingSphere.clone()),r.boundingBox!==null&&(this.boundingBox=r.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Jn);var r=this.attributes.position;r!==void 0?this.boundingBox.setFromBufferAttribute(r):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var r=new Jn,o=new he;return function(){this.boundingSphere===null&&(this.boundingSphere=new nr);var u=this.attributes.position;if(u){var g=this.boundingSphere.center;r.setFromBufferAttribute(u),r.getCenter(g);for(var y=0,T=0,I=u.count;T<I;T++)o.x=u.getX(T),o.y=u.getY(T),o.z=u.getZ(T),y=Math.max(y,g.distanceToSquared(o));this.boundingSphere.radius=Math.sqrt(y),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var r=this.index,o=this.attributes,h=this.groups;if(o.position){var u=o.position.array;if(o.normal===void 0)this.addAttribute("normal",new At(new Float32Array(u.length),3));else for(var g=o.normal.array,y=0,T=g.length;y<T;y++)g[y]=0;var I=o.normal.array,D,N,A,B=new he,F=new he,G=new he,j=new he,$=new he;if(r){var Z=r.array;h.length===0&&this.addGroup(0,Z.length);for(var Q=0,ie=h.length;Q<ie;++Q)for(var ne=h[Q],ae=ne.start,ye=ne.count,y=ae,T=ae+ye;y<T;y+=3)D=Z[y+0]*3,N=Z[y+1]*3,A=Z[y+2]*3,B.fromArray(u,D),F.fromArray(u,N),G.fromArray(u,A),j.subVectors(G,F),$.subVectors(B,F),j.cross($),I[D]+=j.x,I[D+1]+=j.y,I[D+2]+=j.z,I[N]+=j.x,I[N+1]+=j.y,I[N+2]+=j.z,I[A]+=j.x,I[A+1]+=j.y,I[A+2]+=j.z}else for(var y=0,T=u.length;y<T;y+=9)B.fromArray(u,y),F.fromArray(u,y+3),G.fromArray(u,y+6),j.subVectors(G,F),$.subVectors(B,F),j.cross($),I[y]=j.x,I[y+1]=j.y,I[y+2]=j.z,I[y+3]=j.x,I[y+4]=j.y,I[y+5]=j.z,I[y+6]=j.x,I[y+7]=j.y,I[y+8]=j.z;this.normalizeNormals(),o.normal.needsUpdate=!0}},merge:function(r,o){if(!(r&&r.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",r);return}o===void 0&&(o=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var h=this.attributes;for(var u in h)if(r.attributes[u]!==void 0)for(var g=h[u],y=g.array,T=r.attributes[u],I=T.array,D=T.itemSize,N=0,A=D*o;N<I.length;N++,A++)y[A]=I[N];return this},normalizeNormals:function(){var r=new he;return function(){for(var h=this.attributes.normal,u=0,g=h.count;u<g;u++)r.x=h.getX(u),r.y=h.getY(u),r.z=h.getZ(u),r.normalize(),h.setXYZ(u,r.x,r.y,r.z)}}(),toNonIndexed:function(){if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var r=new Tt,o=this.index.array,h=this.attributes;for(var u in h){for(var g=h[u],y=g.array,T=g.itemSize,I=new y.constructor(o.length*T),D=0,N=0,A=0,B=o.length;A<B;A++){D=o[A]*T;for(var F=0;F<T;F++)I[N++]=y[D++]}r.addAttribute(u,new At(I,T))}for(var G=this.groups,A=0,B=G.length;A<B;A++){var j=G[A];r.addGroup(j.start,j.count,j.materialIndex)}return r},toJSON:function(){var r={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),Object.keys(this.userData).length>0&&(r.userData=this.userData),this.parameters!==void 0){var o=this.parameters;for(var h in o)o[h]!==void 0&&(r[h]=o[h]);return r}r.data={attributes:{}};var u=this.index;if(u!==null){var g=Array.prototype.slice.call(u.array);r.data.index={type:u.array.constructor.name,array:g}}var y=this.attributes;for(var h in y){var T=y[h],g=Array.prototype.slice.call(T.array);r.data.attributes[h]={itemSize:T.itemSize,type:T.array.constructor.name,array:g,normalized:T.normalized}}var I=this.groups;I.length>0&&(r.data.groups=JSON.parse(JSON.stringify(I)));var D=this.boundingSphere;return D!==null&&(r.data.boundingSphere={center:D.center.toArray(),radius:D.radius}),r},clone:function(){return new Tt().copy(this)},copy:function(r){var o,h,u;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=r.name;var g=r.index;g!==null&&this.setIndex(g.clone());var y=r.attributes;for(o in y){var T=y[o];this.addAttribute(o,T.clone())}var I=r.morphAttributes;for(o in I){var D=[],N=I[o];for(h=0,u=N.length;h<u;h++)D.push(N[h].clone());this.morphAttributes[o]=D}var A=r.groups;for(h=0,u=A.length;h<u;h++){var B=A[h];this.addGroup(B.start,B.count,B.materialIndex)}var F=r.boundingBox;F!==null&&(this.boundingBox=F.clone());var G=r.boundingSphere;return G!==null&&(this.boundingSphere=G.clone()),this.drawRange.start=r.drawRange.start,this.drawRange.count=r.drawRange.count,this.userData=r.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function oa(r,o,h,u,g,y){xt.call(this),this.type="BoxGeometry",this.parameters={width:r,height:o,depth:h,widthSegments:u,heightSegments:g,depthSegments:y},this.fromBufferGeometry(new Vr(r,o,h,u,g,y)),this.mergeVertices()}oa.prototype=Object.create(xt.prototype),oa.prototype.constructor=oa;function Vr(r,o,h,u,g,y){Tt.call(this),this.type="BoxBufferGeometry",this.parameters={width:r,height:o,depth:h,widthSegments:u,heightSegments:g,depthSegments:y};var T=this;r=r||1,o=o||1,h=h||1,u=Math.floor(u)||1,g=Math.floor(g)||1,y=Math.floor(y)||1;var I=[],D=[],N=[],A=[],B=0,F=0;G("z","y","x",-1,-1,h,o,r,y,g,0),G("z","y","x",1,-1,h,o,-r,y,g,1),G("x","z","y",1,1,r,h,o,u,y,2),G("x","z","y",1,-1,r,h,-o,u,y,3),G("x","y","z",1,-1,r,o,h,u,g,4),G("x","y","z",-1,-1,r,o,-h,u,g,5),this.setIndex(I),this.addAttribute("position",new _t(D,3)),this.addAttribute("normal",new _t(N,3)),this.addAttribute("uv",new _t(A,2));function G(j,$,Z,Q,ie,ne,ae,ye,ge,be,Ee){var Se=ne/ge,Re=ae/be,Ie=ne/2,Ve=ae/2,ot=ye/2,ct=ge+1,pt=be+1,yt=0,ue=0,fe,je,Fe=new he;for(je=0;je<pt;je++){var mt=je*Re-Ve;for(fe=0;fe<ct;fe++){var we=fe*Se-Ie;Fe[j]=we*Q,Fe[$]=mt*ie,Fe[Z]=ot,D.push(Fe.x,Fe.y,Fe.z),Fe[j]=0,Fe[$]=0,Fe[Z]=ye>0?1:-1,N.push(Fe.x,Fe.y,Fe.z),A.push(fe/ge),A.push(1-je/be),yt+=1}}for(je=0;je<be;je++)for(fe=0;fe<ge;fe++){var ut=B+fe+ct*je,Qe=B+fe+ct*(je+1),Nt=B+(fe+1)+ct*(je+1),at=B+(fe+1)+ct*je;I.push(ut,Qe,at),I.push(Qe,Nt,at),ue+=6}T.addGroup(F,ue,Ee),F+=ue,B+=yt}}Vr.prototype=Object.create(Tt.prototype),Vr.prototype.constructor=Vr;function Fs(r,o,h,u){xt.call(this),this.type="PlaneGeometry",this.parameters={width:r,height:o,widthSegments:h,heightSegments:u},this.fromBufferGeometry(new hs(r,o,h,u)),this.mergeVertices()}Fs.prototype=Object.create(xt.prototype),Fs.prototype.constructor=Fs;function hs(r,o,h,u){Tt.call(this),this.type="PlaneBufferGeometry",this.parameters={width:r,height:o,widthSegments:h,heightSegments:u},r=r||1,o=o||1;var g=r/2,y=o/2,T=Math.floor(h)||1,I=Math.floor(u)||1,D=T+1,N=I+1,A=r/T,B=o/I,F,G,j=[],$=[],Z=[],Q=[];for(G=0;G<N;G++){var ie=G*B-y;for(F=0;F<D;F++){var ne=F*A-g;$.push(ne,-ie,0),Z.push(0,0,1),Q.push(F/T),Q.push(1-G/I)}}for(G=0;G<I;G++)for(F=0;F<T;F++){var ae=F+D*G,ye=F+D*(G+1),ge=F+1+D*(G+1),be=F+1+D*G;j.push(ae,ye,be),j.push(ye,ge,be)}this.setIndex(j),this.addAttribute("position",new _t($,3)),this.addAttribute("normal",new _t(Z,3)),this.addAttribute("uv",new _t(Q,2))}hs.prototype=Object.create(Tt.prototype),hs.prototype.constructor=hs;var Nl=0;function Xt(){Object.defineProperty(this,"id",{value:Nl++}),this.uuid=si.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=z,this.side=S,this.flatShading=!1,this.vertexColors=L,this.opacity=1,this.transparent=!1,this.blendSrc=it,this.blendDst=lt,this.blendEquation=ce,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Xe,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}Xt.prototype=Object.assign(Object.create(e.prototype),{constructor:Xt,isMaterial:!0,onBeforeCompile:function(){},setValues:function(r){if(r!==void 0)for(var o in r){var h=r[o];if(h===void 0){console.warn("THREE.Material: '"+o+"' parameter is undefined.");continue}if(o==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=h===R;continue}var u=this[o];if(u===void 0){console.warn("THREE."+this.type+": '"+o+"' is not a property of this material.");continue}u&&u.isColor?u.set(h):u&&u.isVector3&&h&&h.isVector3?u.copy(h):o==="overdraw"?this[o]=Number(h):this[o]=h}},toJSON:function(r){var o=r===void 0||typeof r=="string";o&&(r={textures:{},images:{}});var h={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};h.uuid=this.uuid,h.type=this.type,this.name!==""&&(h.name=this.name),this.color&&this.color.isColor&&(h.color=this.color.getHex()),this.roughness!==void 0&&(h.roughness=this.roughness),this.metalness!==void 0&&(h.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(h.emissive=this.emissive.getHex()),this.emissiveIntensity!==1&&(h.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(h.specular=this.specular.getHex()),this.shininess!==void 0&&(h.shininess=this.shininess),this.clearCoat!==void 0&&(h.clearCoat=this.clearCoat),this.clearCoatRoughness!==void 0&&(h.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(h.map=this.map.toJSON(r).uuid),this.alphaMap&&this.alphaMap.isTexture&&(h.alphaMap=this.alphaMap.toJSON(r).uuid),this.lightMap&&this.lightMap.isTexture&&(h.lightMap=this.lightMap.toJSON(r).uuid),this.aoMap&&this.aoMap.isTexture&&(h.aoMap=this.aoMap.toJSON(r).uuid,h.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(h.bumpMap=this.bumpMap.toJSON(r).uuid,h.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(h.normalMap=this.normalMap.toJSON(r).uuid,h.normalMapType=this.normalMapType,h.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(h.displacementMap=this.displacementMap.toJSON(r).uuid,h.displacementScale=this.displacementScale,h.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(h.roughnessMap=this.roughnessMap.toJSON(r).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(h.metalnessMap=this.metalnessMap.toJSON(r).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(h.emissiveMap=this.emissiveMap.toJSON(r).uuid),this.specularMap&&this.specularMap.isTexture&&(h.specularMap=this.specularMap.toJSON(r).uuid),this.envMap&&this.envMap.isTexture&&(h.envMap=this.envMap.toJSON(r).uuid,h.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(h.gradientMap=this.gradientMap.toJSON(r).uuid),this.size!==void 0&&(h.size=this.size),this.sizeAttenuation!==void 0&&(h.sizeAttenuation=this.sizeAttenuation),this.blending!==z&&(h.blending=this.blending),this.flatShading===!0&&(h.flatShading=this.flatShading),this.side!==S&&(h.side=this.side),this.vertexColors!==L&&(h.vertexColors=this.vertexColors),this.opacity<1&&(h.opacity=this.opacity),this.transparent===!0&&(h.transparent=this.transparent),h.depthFunc=this.depthFunc,h.depthTest=this.depthTest,h.depthWrite=this.depthWrite,this.rotation!==0&&(h.rotation=this.rotation),this.linewidth!==1&&(h.linewidth=this.linewidth),this.dashSize!==void 0&&(h.dashSize=this.dashSize),this.gapSize!==void 0&&(h.gapSize=this.gapSize),this.scale!==void 0&&(h.scale=this.scale),this.dithering===!0&&(h.dithering=!0),this.alphaTest>0&&(h.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(h.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(h.wireframe=this.wireframe),this.wireframeLinewidth>1&&(h.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(h.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(h.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(h.morphTargets=!0),this.skinning===!0&&(h.skinning=!0),this.visible===!1&&(h.visible=!1),JSON.stringify(this.userData)!=="{}"&&(h.userData=this.userData);function u(T){var I=[];for(var D in T){var N=T[D];delete N.metadata,I.push(N)}return I}if(o){var g=u(r.textures),y=u(r.images);g.length>0&&(h.textures=g),y.length>0&&(h.images=y)}return h},clone:function(){return new this.constructor().copy(this)},copy:function(r){this.name=r.name,this.fog=r.fog,this.lights=r.lights,this.blending=r.blending,this.side=r.side,this.flatShading=r.flatShading,this.vertexColors=r.vertexColors,this.opacity=r.opacity,this.transparent=r.transparent,this.blendSrc=r.blendSrc,this.blendDst=r.blendDst,this.blendEquation=r.blendEquation,this.blendSrcAlpha=r.blendSrcAlpha,this.blendDstAlpha=r.blendDstAlpha,this.blendEquationAlpha=r.blendEquationAlpha,this.depthFunc=r.depthFunc,this.depthTest=r.depthTest,this.depthWrite=r.depthWrite,this.colorWrite=r.colorWrite,this.precision=r.precision,this.polygonOffset=r.polygonOffset,this.polygonOffsetFactor=r.polygonOffsetFactor,this.polygonOffsetUnits=r.polygonOffsetUnits,this.dithering=r.dithering,this.alphaTest=r.alphaTest,this.premultipliedAlpha=r.premultipliedAlpha,this.overdraw=r.overdraw,this.visible=r.visible,this.userData=JSON.parse(JSON.stringify(r.userData)),this.clipShadows=r.clipShadows,this.clipIntersection=r.clipIntersection;var o=r.clippingPlanes,h=null;if(o!==null){var u=o.length;h=new Array(u);for(var g=0;g!==u;++g)h[g]=o[g].clone()}return this.clippingPlanes=h,this.shadowSide=r.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function ai(r){Xt.call(this),this.type="MeshBasicMaterial",this.color=new Mt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Je,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(r)}ai.prototype=Object.create(Xt.prototype),ai.prototype.constructor=ai,ai.prototype.isMeshBasicMaterial=!0,ai.prototype.copy=function(r){return Xt.prototype.copy.call(this,r),this.color.copy(r.color),this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this};function $i(r){Xt.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,this.fragmentShader=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,r!==void 0&&(r.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(r))}$i.prototype=Object.create(Xt.prototype),$i.prototype.constructor=$i,$i.prototype.isShaderMaterial=!0,$i.prototype.copy=function(r){return Xt.prototype.copy.call(this,r),this.fragmentShader=r.fragmentShader,this.vertexShader=r.vertexShader,this.uniforms=Tn.clone(r.uniforms),this.defines=Object.assign({},r.defines),this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.lights=r.lights,this.clipping=r.clipping,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this.extensions=r.extensions,this},$i.prototype.toJSON=function(r){var o=Xt.prototype.toJSON.call(this,r);return o.uniforms=this.uniforms,o.vertexShader=this.vertexShader,o.fragmentShader=this.fragmentShader,o};function zn(r,o){this.origin=r!==void 0?r:new he,this.direction=o!==void 0?o:new he}Object.assign(zn.prototype,{set:function(r,o){return this.origin.copy(r),this.direction.copy(o),this},clone:function(){return new this.constructor().copy(this)},copy:function(r){return this.origin.copy(r.origin),this.direction.copy(r.direction),this},at:function(r,o){return o===void 0&&(console.warn("THREE.Ray: .at() target is now required"),o=new he),o.copy(this.direction).multiplyScalar(r).add(this.origin)},lookAt:function(r){return this.direction.copy(r).sub(this.origin).normalize(),this},recast:function(){var r=new he;return function(h){return this.origin.copy(this.at(h,r)),this}}(),closestPointToPoint:function(r,o){o===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),o=new he),o.subVectors(r,this.origin);var h=o.dot(this.direction);return h<0?o.copy(this.origin):o.copy(this.direction).multiplyScalar(h).add(this.origin)},distanceToPoint:function(r){return Math.sqrt(this.distanceSqToPoint(r))},distanceSqToPoint:function(){var r=new he;return function(h){var u=r.subVectors(h,this.origin).dot(this.direction);return u<0?this.origin.distanceToSquared(h):(r.copy(this.direction).multiplyScalar(u).add(this.origin),r.distanceToSquared(h))}}(),distanceSqToSegment:function(){var r=new he,o=new he,h=new he;return function(g,y,T,I){r.copy(g).add(y).multiplyScalar(.5),o.copy(y).sub(g).normalize(),h.copy(this.origin).sub(r);var D=g.distanceTo(y)*.5,N=-this.direction.dot(o),A=h.dot(this.direction),B=-h.dot(o),F=h.lengthSq(),G=Math.abs(1-N*N),j,$,Z,Q;if(G>0)if(j=N*B-A,$=N*A-B,Q=D*G,j>=0)if($>=-Q)if($<=Q){var ie=1/G;j*=ie,$*=ie,Z=j*(j+N*$+2*A)+$*(N*j+$+2*B)+F}else $=D,j=Math.max(0,-(N*$+A)),Z=-j*j+$*($+2*B)+F;else $=-D,j=Math.max(0,-(N*$+A)),Z=-j*j+$*($+2*B)+F;else $<=-Q?(j=Math.max(0,-(-N*D+A)),$=j>0?-D:Math.min(Math.max(-D,-B),D),Z=-j*j+$*($+2*B)+F):$<=Q?(j=0,$=Math.min(Math.max(-D,-B),D),Z=$*($+2*B)+F):(j=Math.max(0,-(N*D+A)),$=j>0?D:Math.min(Math.max(-D,-B),D),Z=-j*j+$*($+2*B)+F);else $=N>0?-D:D,j=Math.max(0,-(N*$+A)),Z=-j*j+$*($+2*B)+F;return T&&T.copy(this.direction).multiplyScalar(j).add(this.origin),I&&I.copy(o).multiplyScalar($).add(r),Z}}(),intersectSphere:function(){var r=new he;return function(h,u){r.subVectors(h.center,this.origin);var g=r.dot(this.direction),y=r.dot(r)-g*g,T=h.radius*h.radius;if(y>T)return null;var I=Math.sqrt(T-y),D=g-I,N=g+I;return D<0&&N<0?null:D<0?this.at(N,u):this.at(D,u)}}(),intersectsSphere:function(r){return this.distanceToPoint(r.center)<=r.radius},distanceToPlane:function(r){var o=r.normal.dot(this.direction);if(o===0)return r.distanceToPoint(this.origin)===0?0:null;var h=-(this.origin.dot(r.normal)+r.constant)/o;return h>=0?h:null},intersectPlane:function(r,o){var h=this.distanceToPlane(r);return h===null?null:this.at(h,o)},intersectsPlane:function(r){var o=r.distanceToPoint(this.origin);if(o===0)return!0;var h=r.normal.dot(this.direction);return h*o<0},intersectBox:function(r,o){var h,u,g,y,T,I,D=1/this.direction.x,N=1/this.direction.y,A=1/this.direction.z,B=this.origin;return D>=0?(h=(r.min.x-B.x)*D,u=(r.max.x-B.x)*D):(h=(r.max.x-B.x)*D,u=(r.min.x-B.x)*D),N>=0?(g=(r.min.y-B.y)*N,y=(r.max.y-B.y)*N):(g=(r.max.y-B.y)*N,y=(r.min.y-B.y)*N),h>y||g>u||((g>h||h!==h)&&(h=g),(y<u||u!==u)&&(u=y),A>=0?(T=(r.min.z-B.z)*A,I=(r.max.z-B.z)*A):(T=(r.max.z-B.z)*A,I=(r.min.z-B.z)*A),h>I||T>u)||((T>h||h!==h)&&(h=T),(I<u||u!==u)&&(u=I),u<0)?null:this.at(h>=0?h:u,o)},intersectsBox:function(){var r=new he;return function(h){return this.intersectBox(h,r)!==null}}(),intersectTriangle:function(){var r=new he,o=new he,h=new he,u=new he;return function(y,T,I,D,N){o.subVectors(T,y),h.subVectors(I,y),u.crossVectors(o,h);var A=this.direction.dot(u),B;if(A>0){if(D)return null;B=1}else if(A<0)B=-1,A=-A;else return null;r.subVectors(this.origin,y);var F=B*this.direction.dot(h.crossVectors(r,h));if(F<0)return null;var G=B*this.direction.dot(o.cross(r));if(G<0||F+G>A)return null;var j=-B*r.dot(u);return j<0?null:this.at(j/A,N)}}(),applyMatrix4:function(r){return this.origin.applyMatrix4(r),this.direction.transformDirection(r),this},equals:function(r){return r.origin.equals(this.origin)&&r.direction.equals(this.direction)}});function Qn(r,o){this.start=r!==void 0?r:new he,this.end=o!==void 0?o:new he}Object.assign(Qn.prototype,{set:function(r,o){return this.start.copy(r),this.end.copy(o),this},clone:function(){return new this.constructor().copy(this)},copy:function(r){return this.start.copy(r.start),this.end.copy(r.end),this},getCenter:function(r){return r===void 0&&(console.warn("THREE.Line3: .getCenter() target is now required"),r=new he),r.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(r){return r===void 0&&(console.warn("THREE.Line3: .delta() target is now required"),r=new he),r.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(r,o){return o===void 0&&(console.warn("THREE.Line3: .at() target is now required"),o=new he),this.delta(o).multiplyScalar(r).add(this.start)},closestPointToPointParameter:function(){var r=new he,o=new he;return function(u,g){r.subVectors(u,this.start),o.subVectors(this.end,this.start);var y=o.dot(o),T=o.dot(r),I=T/y;return g&&(I=si.clamp(I,0,1)),I}}(),closestPointToPoint:function(r,o,h){var u=this.closestPointToPointParameter(r,o);return h===void 0&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),h=new he),this.delta(h).multiplyScalar(u).add(this.start)},applyMatrix4:function(r){return this.start.applyMatrix4(r),this.end.applyMatrix4(r),this},equals:function(r){return r.start.equals(this.start)&&r.end.equals(this.end)}});function Gn(r,o,h){this.a=r!==void 0?r:new he,this.b=o!==void 0?o:new he,this.c=h!==void 0?h:new he}Object.assign(Gn,{getNormal:function(){var r=new he;return function(h,u,g,y){y===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),y=new he),y.subVectors(g,u),r.subVectors(h,u),y.cross(r);var T=y.lengthSq();return T>0?y.multiplyScalar(1/Math.sqrt(T)):y.set(0,0,0)}}(),getBarycoord:function(){var r=new he,o=new he,h=new he;return function(g,y,T,I,D){r.subVectors(I,y),o.subVectors(T,y),h.subVectors(g,y);var N=r.dot(r),A=r.dot(o),B=r.dot(h),F=o.dot(o),G=o.dot(h),j=N*F-A*A;if(D===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),D=new he),j===0)return D.set(-2,-1,-1);var $=1/j,Z=(F*B-A*G)*$,Q=(N*G-A*B)*$;return D.set(1-Z-Q,Q,Z)}}(),containsPoint:function(){var r=new he;return function(h,u,g,y){return Gn.getBarycoord(h,u,g,y,r),r.x>=0&&r.y>=0&&r.x+r.y<=1}}()}),Object.assign(Gn.prototype,{set:function(r,o,h){return this.a.copy(r),this.b.copy(o),this.c.copy(h),this},setFromPointsAndIndices:function(r,o,h,u){return this.a.copy(r[o]),this.b.copy(r[h]),this.c.copy(r[u]),this},clone:function(){return new this.constructor().copy(this)},copy:function(r){return this.a.copy(r.a),this.b.copy(r.b),this.c.copy(r.c),this},getArea:function(){var r=new he,o=new he;return function(){return r.subVectors(this.c,this.b),o.subVectors(this.a,this.b),r.cross(o).length()*.5}}(),getMidpoint:function(r){return r===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),r=new he),r.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(r){return Gn.getNormal(this.a,this.b,this.c,r)},getPlane:function(r){return r===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),r=new he),r.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(r,o){return Gn.getBarycoord(r,this.a,this.b,this.c,o)},containsPoint:function(r){return Gn.containsPoint(r,this.a,this.b,this.c)},intersectsBox:function(r){return r.intersectsTriangle(this)},closestPointToPoint:function(){var r=new rr,o=[new Qn,new Qn,new Qn],h=new he,u=new he;return function(y,T){T===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),T=new he);var I=1/0;if(r.setFromCoplanarPoints(this.a,this.b,this.c),r.projectPoint(y,h),this.containsPoint(h)===!0)T.copy(h);else{o[0].set(this.a,this.b),o[1].set(this.b,this.c),o[2].set(this.c,this.a);for(var D=0;D<o.length;D++){o[D].closestPointToPoint(h,!0,u);var N=h.distanceToSquared(u);N<I&&(I=N,T.copy(u))}}return T}}(),equals:function(r){return r.a.equals(this.a)&&r.b.equals(this.b)&&r.c.equals(this.c)}});function Mn(r,o){vt.call(this),this.type="Mesh",this.geometry=r!==void 0?r:new Tt,this.material=o!==void 0?o:new ai({color:Math.random()*16777215}),this.drawMode=un,this.updateMorphTargets()}Mn.prototype=Object.assign(Object.create(vt.prototype),{constructor:Mn,isMesh:!0,setDrawMode:function(r){this.drawMode=r},copy:function(r){return vt.prototype.copy.call(this,r),this.drawMode=r.drawMode,r.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=r.morphTargetInfluences.slice()),r.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},r.morphTargetDictionary)),this},updateMorphTargets:function(){var r=this.geometry,o,h,u;if(r.isBufferGeometry){var g=r.morphAttributes,y=Object.keys(g);if(y.length>0){var T=g[y[0]];if(T!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},o=0,h=T.length;o<h;o++)u=T[o].name||String(o),this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=o}}else{var I=r.morphTargets;if(I!==void 0&&I.length>0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},o=0,h=I.length;o<h;o++)u=I[o].name||String(o),this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=o}},raycast:function(){var r=new Ot,o=new zn,h=new nr,u=new he,g=new he,y=new he,T=new he,I=new he,D=new he,N=new rt,A=new rt,B=new rt,F=new he,G=new he,j=new he;function $(ie,ne,ae,ye,ge,be,Ee){return Gn.getBarycoord(ie,ne,ae,ye,F),ge.multiplyScalar(F.x),be.multiplyScalar(F.y),Ee.multiplyScalar(F.z),ge.add(be).add(Ee),ge.clone()}function Z(ie,ne,ae,ye,ge,be,Ee,Se){var Re;if(ne.side===E?Re=ye.intersectTriangle(Ee,be,ge,!0,Se):Re=ye.intersectTriangle(ge,be,Ee,ne.side!==k,Se),Re===null)return null;j.copy(Se),j.applyMatrix4(ie.matrixWorld);var Ie=ae.ray.origin.distanceTo(j);return Ie<ae.near||Ie>ae.far?null:{distance:Ie,point:j.clone(),object:ie}}function Q(ie,ne,ae,ye,ge,be,Ee,Se,Re){u.fromBufferAttribute(ge,Ee),g.fromBufferAttribute(ge,Se),y.fromBufferAttribute(ge,Re);var Ie=Z(ie,ne,ae,ye,u,g,y,G);if(Ie){be&&(N.fromBufferAttribute(be,Ee),A.fromBufferAttribute(be,Se),B.fromBufferAttribute(be,Re),Ie.uv=$(G,u,g,y,N,A,B));var Ve=new tn(Ee,Se,Re);Gn.getNormal(u,g,y,Ve.normal),Ie.face=Ve}return Ie}return function(ne,ae){var ye=this.geometry,ge=this.material,be=this.matrixWorld;if(ge!==void 0&&(ye.boundingSphere===null&&ye.computeBoundingSphere(),h.copy(ye.boundingSphere),h.applyMatrix4(be),ne.ray.intersectsSphere(h)!==!1&&(r.getInverse(be),o.copy(ne.ray).applyMatrix4(r),!(ye.boundingBox!==null&&o.intersectsBox(ye.boundingBox)===!1)))){var Ee;if(ye.isBufferGeometry){var Se,Re,Ie,Ve=ye.index,ot=ye.attributes.position,ct=ye.attributes.uv,pt=ye.groups,yt=ye.drawRange,ue,fe,je,Fe,mt,we,ut,Qe;if(Ve!==null)if(Array.isArray(ge))for(ue=0,je=pt.length;ue<je;ue++)for(mt=pt[ue],we=ge[mt.materialIndex],ut=Math.max(mt.start,yt.start),Qe=Math.min(mt.start+mt.count,yt.start+yt.count),fe=ut,Fe=Qe;fe<Fe;fe+=3)Se=Ve.getX(ue),Re=Ve.getX(ue+1),Ie=Ve.getX(ue+2),Ee=Q(this,we,ne,o,ot,ct,Se,Re,Ie),Ee&&(Ee.faceIndex=Math.floor(ue/3),ae.push(Ee));else for(ut=Math.max(0,yt.start),Qe=Math.min(Ve.count,yt.start+yt.count),ue=ut,je=Qe;ue<je;ue+=3)Se=Ve.getX(ue),Re=Ve.getX(ue+1),Ie=Ve.getX(ue+2),Ee=Q(this,ge,ne,o,ot,ct,Se,Re,Ie),Ee&&(Ee.faceIndex=Math.floor(ue/3),ae.push(Ee));else if(ot!==void 0)if(Array.isArray(ge))for(ue=0,je=pt.length;ue<je;ue++)for(mt=pt[ue],we=ge[mt.materialIndex],ut=Math.max(mt.start,yt.start),Qe=Math.min(mt.start+mt.count,yt.start+yt.count),fe=ut,Fe=Qe;fe<Fe;fe+=3)Se=fe,Re=fe+1,Ie=fe+2,Ee=Q(this,we,ne,o,ot,ct,Se,Re,Ie),Ee&&(Ee.faceIndex=Math.floor(ue/3),ae.push(Ee));else for(ut=Math.max(0,yt.start),Qe=Math.min(ot.count,yt.start+yt.count),ue=ut,je=Qe;ue<je;ue+=3)Se=ue,Re=ue+1,Ie=ue+2,Ee=Q(this,ge,ne,o,ot,ct,Se,Re,Ie),Ee&&(Ee.faceIndex=Math.floor(ue/3),ae.push(Ee))}else if(ye.isGeometry){var Nt,at,Dt,Qt=Array.isArray(ge),Yi=ye.vertices,ft=ye.faces,_i,yn=ye.faceVertexUvs[0];yn.length>0&&(_i=yn);for(var zi=0,br=ft.length;zi<br;zi++){var ji=ft[zi],Sn=Qt?ge[ji.materialIndex]:ge;if(Sn!==void 0){if(Nt=Yi[ji.a],at=Yi[ji.b],Dt=Yi[ji.c],Sn.morphTargets===!0){var Zn=ye.morphTargets,Js=this.morphTargetInfluences;u.set(0,0,0),g.set(0,0,0),y.set(0,0,0);for(var es=0,$s=Zn.length;es<$s;es++){var Gi=Js[es];if(Gi!==0){var Cr=Zn[es].vertices;u.addScaledVector(T.subVectors(Cr[ji.a],Nt),Gi),g.addScaledVector(I.subVectors(Cr[ji.b],at),Gi),y.addScaledVector(D.subVectors(Cr[ji.c],Dt),Gi)}}u.add(Nt),g.add(at),y.add(Dt),Nt=u,at=g,Dt=y}if(Ee=Z(this,Sn,ne,o,Nt,at,Dt,G),Ee){if(_i&&_i[zi]){var Fn=_i[zi];N.copy(Fn[0]),A.copy(Fn[1]),B.copy(Fn[2]),Ee.uv=$(G,Nt,at,Dt,N,A,B)}Ee.face=ji,Ee.faceIndex=zi,ae.push(Ee)}}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});function sh(r,o,h,u){var g=new Mt(0),y=0,T,I,D;function N(B,F,G,j){var $=F.background;$===null?A(g,y):$&&$.isColor&&(A($,1),j=!0),(r.autoClear||j)&&r.clear(r.autoClearColor,r.autoClearDepth,r.autoClearStencil),$&&$.isCubeTexture?(D===void 0&&(D=new Mn(new Vr(1,1,1),new $i({uniforms:Ps.cube.uniforms,vertexShader:Ps.cube.vertexShader,fragmentShader:Ps.cube.fragmentShader,side:E,depthTest:!0,depthWrite:!1,fog:!1})),D.geometry.removeAttribute("normal"),D.geometry.removeAttribute("uv"),D.onBeforeRender=function(Z,Q,ie){this.matrixWorld.copyPosition(ie.matrixWorld)},h.update(D)),D.material.uniforms.tCube.value=$,B.push(D,D.geometry,D.material,0,null)):$&&$.isTexture&&(T===void 0&&(T=new sa(-1,1,1,-1,0,1),I=new Mn(new hs(2,2),new ai({depthTest:!1,depthWrite:!1,fog:!1})),h.update(I)),I.material.map=$,r.renderBufferDirect(T,null,I.geometry,I.material,I,null))}function A(B,F){o.buffers.color.setClear(B.r,B.g,B.b,F,u)}return{getClearColor:function(){return g},setClearColor:function(B,F){g.set(B),y=F!==void 0?F:1,A(g,y)},getClearAlpha:function(){return y},setClearAlpha:function(B){y=B,A(g,y)},render:N}}function Ac(r,o,h){var u;function g(I){u=I}function y(I,D){r.drawArrays(u,I,D),h.update(D,u)}function T(I,D,N){var A=o.get("ANGLE_instanced_arrays");if(A===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}A.drawArraysInstancedANGLE(u,D,N,I.maxInstancedCount),h.update(N,u,I.maxInstancedCount)}this.setMode=g,this.render=y,this.renderInstances=T}function Pl(r,o,h){var u;function g(){if(u!==void 0)return u;var ae=o.get("EXT_texture_filter_anisotropic");return ae!==null?u=r.getParameter(ae.MAX_TEXTURE_MAX_ANISOTROPY_EXT):u=0,u}function y(ae){if(ae==="highp"){if(r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.HIGH_FLOAT).precision>0&&r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT).precision>0)return"highp";ae="mediump"}return ae==="mediump"&&r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.MEDIUM_FLOAT).precision>0&&r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var T=h.precision!==void 0?h.precision:"highp",I=y(T);I!==T&&(console.warn("THREE.WebGLRenderer:",T,"not supported, using",I,"instead."),T=I);var D=h.logarithmicDepthBuffer===!0,N=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS),A=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS),B=r.getParameter(r.MAX_TEXTURE_SIZE),F=r.getParameter(r.MAX_CUBE_MAP_TEXTURE_SIZE),G=r.getParameter(r.MAX_VERTEX_ATTRIBS),j=r.getParameter(r.MAX_VERTEX_UNIFORM_VECTORS),$=r.getParameter(r.MAX_VARYING_VECTORS),Z=r.getParameter(r.MAX_FRAGMENT_UNIFORM_VECTORS),Q=A>0,ie=!!o.get("OES_texture_float"),ne=Q&&ie;return{getMaxAnisotropy:g,getMaxPrecision:y,precision:T,logarithmicDepthBuffer:D,maxTextures:N,maxVertexTextures:A,maxTextureSize:B,maxCubemapSize:F,maxAttributes:G,maxVertexUniforms:j,maxVaryings:$,maxFragmentUniforms:Z,vertexTextures:Q,floatFragmentTextures:ie,floatVertexTextures:ne}}function Wa(){var r=this,o=null,h=0,u=!1,g=!1,y=new rr,T=new wn,I={value:null,needsUpdate:!1};this.uniform=I,this.numPlanes=0,this.numIntersection=0,this.init=function(A,B,F){var G=A.length!==0||B||h!==0||u;return u=B,o=N(A,F,0),h=A.length,G},this.beginShadows=function(){g=!0,N(null)},this.endShadows=function(){g=!1,D()},this.setState=function(A,B,F,G,j,$){if(!u||A===null||A.length===0||g&&!F)g?N(null):D();else{var Z=g?0:h,Q=Z*4,ie=j.clippingState||null;I.value=ie,ie=N(A,G,Q,$);for(var ne=0;ne!==Q;++ne)ie[ne]=o[ne];j.clippingState=ie,this.numIntersection=B?this.numPlanes:0,this.numPlanes+=Z}};function D(){I.value!==o&&(I.value=o,I.needsUpdate=h>0),r.numPlanes=h,r.numIntersection=0}function N(A,B,F,G){var j=A!==null?A.length:0,$=null;if(j!==0){if($=I.value,G!==!0||$===null){var Z=F+j*4,Q=B.matrixWorldInverse;T.getNormalMatrix(Q),($===null||$.length<Z)&&($=new Float32Array(Z));for(var ie=0,ne=F;ie!==j;++ie,ne+=4)y.copy(A[ie]).applyMatrix4(Q,T),y.normal.toArray($,ne),$[ne+3]=y.constant}I.value=$,I.needsUpdate=!0}return r.numPlanes=j,$}}function ah(r){var o={};return{get:function(h){if(o[h]!==void 0)return o[h];var u;switch(h){case"WEBGL_depth_texture":u=r.getExtension("WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":u=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":u=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":u=r.getExtension("WEBGL_compressed_texture_pvrtc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:u=r.getExtension(h)}return u===null&&console.warn("THREE.WebGLRenderer: "+h+" extension not supported."),o[h]=u,u}}}function Al(r,o,h){var u={},g={};function y(N){var A=N.target,B=u[A.id];B.index!==null&&o.remove(B.index);for(var F in B.attributes)o.remove(B.attributes[F]);A.removeEventListener("dispose",y),delete u[A.id];var G=g[A.id];G&&(o.remove(G),delete g[A.id]),G=g[B.id],G&&(o.remove(G),delete g[B.id]),h.memory.geometries--}function T(N,A){var B=u[A.id];return B||(A.addEventListener("dispose",y),A.isBufferGeometry?B=A:A.isGeometry&&(A._bufferGeometry===void 0&&(A._bufferGeometry=new Tt().setFromObject(N)),B=A._bufferGeometry),u[A.id]=B,h.memory.geometries++,B)}function I(N){var A=N.index,B=N.attributes;A!==null&&o.update(A,r.ELEMENT_ARRAY_BUFFER);for(var F in B)o.update(B[F],r.ARRAY_BUFFER);var G=N.morphAttributes;for(var F in G)for(var j=G[F],$=0,Z=j.length;$<Z;$++)o.update(j[$],r.ARRAY_BUFFER)}function D(N){var A=g[N.id];if(A)return A;var B=[],F=N.index,G=N.attributes;if(F!==null)for(var j=F.array,$=0,Z=j.length;$<Z;$+=3){var Q=j[$+0],ie=j[$+1],ne=j[$+2];B.push(Q,ie,ie,ne,ne,Q)}else for(var j=G.position.array,$=0,Z=j.length/3-1;$<Z;$+=3){var Q=$+0,ie=$+1,ne=$+2;B.push(Q,ie,ie,ne,ne,Q)}return A=new(Ao(B)>65535?pr:Bs)(B,1),o.update(A,r.ELEMENT_ARRAY_BUFFER),g[N.id]=A,A}return{get:T,update:I,getWireframeAttribute:D}}function Os(r,o,h){var u;function g(A){u=A}var y,T;function I(A){y=A.type,T=A.bytesPerElement}function D(A,B){r.drawElements(u,B,y,A*T),h.update(B,u)}function N(A,B,F){var G=o.get("ANGLE_instanced_arrays");if(G===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}G.drawElementsInstancedANGLE(u,F,y,B*T,A.maxInstancedCount),h.update(F,u,A.maxInstancedCount)}this.setMode=g,this.setIndex=I,this.render=D,this.renderInstances=N}function oh(r){var o={geometries:0,textures:0},h={frame:0,calls:0,triangles:0,points:0,lines:0};function u(y,T,I){switch(I=I||1,h.calls++,T){case r.TRIANGLES:h.triangles+=I*(y/3);break;case r.TRIANGLE_STRIP:case r.TRIANGLE_FAN:h.triangles+=I*(y-2);break;case r.LINES:h.lines+=I*(y/2);break;case r.LINE_STRIP:h.lines+=I*(y-1);break;case r.LINE_LOOP:h.lines+=I*y;break;case r.POINTS:h.points+=I*y;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",T);break}}function g(){h.frame++,h.calls=0,h.triangles=0,h.points=0,h.lines=0}return{memory:o,render:h,programs:null,autoReset:!0,reset:g,update:u}}function Bo(r,o){return Math.abs(o[1])-Math.abs(r[1])}function Bl(r){var o={},h=new Float32Array(8);function u(g,y,T,I){var D=g.morphTargetInfluences,N=D.length,A=o[y.id];if(A===void 0){A=[];for(var B=0;B<N;B++)A[B]=[B,0];o[y.id]=A}for(var F=T.morphTargets&&y.morphAttributes.position,G=T.morphNormals&&y.morphAttributes.normal,B=0;B<N;B++){var j=A[B];j[1]!==0&&(F&&y.removeAttribute("morphTarget"+B),G&&y.removeAttribute("morphNormal"+B))}for(var B=0;B<N;B++){var j=A[B];j[0]=B,j[1]=D[B]}A.sort(Bo);for(var B=0;B<8;B++){var j=A[B];if(j){var $=j[0],Z=j[1];if(Z){F&&y.addAttribute("morphTarget"+B,F[$]),G&&y.addAttribute("morphNormal"+B,G[$]),h[B]=Z;continue}}h[B]=0}I.getUniforms().setValue(r,"morphTargetInfluences",h)}return{update:u}}function lh(r,o){var h={};function u(y){var T=o.render.frame,I=y.geometry,D=r.get(y,I);return h[D.id]!==T&&(I.isGeometry&&D.updateFromObject(y),r.update(D),h[D.id]=T),D}function g(){h={}}return{update:u,dispose:g}}function Ur(r,o,h,u,g,y,T,I,D,N){r=r!==void 0?r:[],o=o!==void 0?o:sn,Ci.call(this,r,o,h,u,g,y,T,I,D,N),this.flipY=!1}Ur.prototype=Object.create(Ci.prototype),Ur.prototype.constructor=Ur,Ur.prototype.isCubeTexture=!0,Object.defineProperty(Ur.prototype,"images",{get:function(){return this.image},set:function(r){this.image=r}});var Fl=new Ci,dh=new Ur;function hh(){this.seq=[],this.map={}}var ja=[],Ol=[],ch=new Float32Array(16),uh=new Float32Array(9),Vl=new Float32Array(4);function mr(r,o,h){var u=r[0];if(u<=0||u>0)return r;var g=o*h,y=ja[g];if(y===void 0&&(y=new Float32Array(g),ja[g]=y),o!==0){u.toArray(y,0);for(var T=1,I=0;T!==o;++T)I+=h,r[T].toArray(y,I)}return y}function Ai(r,o){if(r.length!==o.length)return!1;for(var h=0,u=r.length;h<u;h++)if(r[h]!==o[h])return!1;return!0}function ln(r,o){for(var h=0,u=o.length;h<u;h++)r[h]=o[h]}function Ul(r,o){var h=Ol[o];h===void 0&&(h=new Int32Array(o),Ol[o]=h);for(var u=0;u!==o;++u)h[u]=r.allocTextureUnit();return h}function zl(r,o){var h=this.cache;h[0]!==o&&(r.uniform1f(this.addr,o),h[0]=o)}function ph(r,o){var h=this.cache;h[0]!==o&&(r.uniform1i(this.addr,o),h[0]=o)}function Bc(r,o){var h=this.cache;if(o.x!==void 0)(h[0]!==o.x||h[1]!==o.y)&&(r.uniform2f(this.addr,o.x,o.y),h[0]=o.x,h[1]=o.y);else{if(Ai(h,o))return;r.uniform2fv(this.addr,o),ln(h,o)}}function mh(r,o){var h=this.cache;if(o.x!==void 0)(h[0]!==o.x||h[1]!==o.y||h[2]!==o.z)&&(r.uniform3f(this.addr,o.x,o.y,o.z),h[0]=o.x,h[1]=o.y,h[2]=o.z);else if(o.r!==void 0)(h[0]!==o.r||h[1]!==o.g||h[2]!==o.b)&&(r.uniform3f(this.addr,o.r,o.g,o.b),h[0]=o.r,h[1]=o.g,h[2]=o.b);else{if(Ai(h,o))return;r.uniform3fv(this.addr,o),ln(h,o)}}function En(r,o){var h=this.cache;if(o.x!==void 0)(h[0]!==o.x||h[1]!==o.y||h[2]!==o.z||h[3]!==o.w)&&(r.uniform4f(this.addr,o.x,o.y,o.z,o.w),h[0]=o.x,h[1]=o.y,h[2]=o.z,h[3]=o.w);else{if(Ai(h,o))return;r.uniform4fv(this.addr,o),ln(h,o)}}function Fo(r,o){var h=this.cache,u=o.elements;if(u===void 0){if(Ai(h,o))return;r.uniformMatrix2fv(this.addr,!1,o),ln(h,o)}else{if(Ai(h,u))return;Vl.set(u),r.uniformMatrix2fv(this.addr,!1,Vl),ln(h,u)}}function fh(r,o){var h=this.cache,u=o.elements;if(u===void 0){if(Ai(h,o))return;r.uniformMatrix3fv(this.addr,!1,o),ln(h,o)}else{if(Ai(h,u))return;uh.set(u),r.uniformMatrix3fv(this.addr,!1,uh),ln(h,u)}}function gh(r,o){var h=this.cache,u=o.elements;if(u===void 0){if(Ai(h,o))return;r.uniformMatrix4fv(this.addr,!1,o),ln(h,o)}else{if(Ai(h,u))return;ch.set(u),r.uniformMatrix4fv(this.addr,!1,ch),ln(h,u)}}function _h(r,o,h){var u=this.cache,g=h.allocTextureUnit();u[0]!==g&&(r.uniform1i(this.addr,g),u[0]=g),h.setTexture2D(o||Fl,g)}function la(r,o,h){var u=this.cache,g=h.allocTextureUnit();u[0]!==g&&(r.uniform1i(this.addr,g),u[0]=g),h.setTextureCube(o||dh,g)}function Oo(r,o){var h=this.cache;Ai(h,o)||(r.uniform2iv(this.addr,o),ln(h,o))}function Gl(r,o){var h=this.cache;Ai(h,o)||(r.uniform3iv(this.addr,o),ln(h,o))}function Hl(r,o){var h=this.cache;Ai(h,o)||(r.uniform4iv(this.addr,o),ln(h,o))}function vh(r){switch(r){case 5126:return zl;case 35664:return Bc;case 35665:return mh;case 35666:return En;case 35674:return Fo;case 35675:return fh;case 35676:return gh;case 35678:case 36198:return _h;case 35680:return la;case 5124:case 35670:return ph;case 35667:case 35671:return Oo;case 35668:case 35672:return Gl;case 35669:case 35673:return Hl}}function da(r,o){var h=this.cache;Ai(h,o)||(r.uniform1fv(this.addr,o),ln(h,o))}function yh(r,o){var h=this.cache;Ai(h,o)||(r.uniform1iv(this.addr,o),ln(h,o))}function Vo(r,o){var h=this.cache,u=mr(o,this.size,2);Ai(h,u)||(r.uniform2fv(this.addr,u),this.updateCache(u))}function Sh(r,o){var h=this.cache,u=mr(o,this.size,3);Ai(h,u)||(r.uniform3fv(this.addr,u),this.updateCache(u))}function qa(r,o){var h=this.cache,u=mr(o,this.size,4);Ai(h,u)||(r.uniform4fv(this.addr,u),this.updateCache(u))}function Fc(r,o){var h=this.cache,u=mr(o,this.size,4);Ai(h,u)||(r.uniformMatrix2fv(this.addr,!1,u),this.updateCache(u))}function ha(r,o){var h=this.cache,u=mr(o,this.size,9);Ai(h,u)||(r.uniformMatrix3fv(this.addr,!1,u),this.updateCache(u))}function bh(r,o){var h=this.cache,u=mr(o,this.size,16);Ai(h,u)||(r.uniformMatrix4fv(this.addr,!1,u),this.updateCache(u))}function Ch(r,o,h){var u=this.cache,g=o.length,y=Ul(h,g);Ai(u,y)===!1&&(r.uniform1iv(this.addr,y),ln(u,y));for(var T=0;T!==g;++T)h.setTexture2D(o[T]||Fl,y[T])}function wh(r,o,h){var u=this.cache,g=o.length,y=Ul(h,g);Ai(u,y)===!1&&(r.uniform1iv(this.addr,y),ln(u,y));for(var T=0;T!==g;++T)h.setTextureCube(o[T]||dh,y[T])}function Ka(r){switch(r){case 5126:return da;case 35664:return Vo;case 35665:return Sh;case 35666:return qa;case 35674:return Fc;case 35675:return ha;case 35676:return bh;case 35678:return Ch;case 35680:return wh;case 5124:case 35670:return yh;case 35667:case 35671:return Oo;case 35668:case 35672:return Gl;case 35669:case 35673:return Hl}}function Xa(r,o,h){this.id=r,this.addr=h,this.cache=[],this.setValue=vh(o.type)}function ca(r,o,h){this.id=r,this.addr=h,this.cache=[],this.size=o.size,this.setValue=Ka(o.type)}ca.prototype.updateCache=function(r){var o=this.cache;r instanceof Float32Array&&o.length!==r.length&&(this.cache=new Float32Array(r.length)),ln(o,r)};function ua(r){this.id=r,hh.call(this)}ua.prototype.setValue=function(r,o){for(var h=this.seq,u=0,g=h.length;u!==g;++u){var y=h[u];y.setValue(r,o[y.id])}};var Uo=/([\w\d_]+)(\])?(\[|\.)?/g;function Th(r,o){r.seq.push(o),r.map[o.id]=o}function Eh(r,o,h){var u=r.name,g=u.length;for(Uo.lastIndex=0;;){var y=Uo.exec(u),T=Uo.lastIndex,I=y[1],D=y[2]==="]",N=y[3];if(D&&(I=I|0),N===void 0||N==="["&&T+2===g){Th(h,N===void 0?new Xa(I,r,o):new ca(I,r,o));break}else{var A=h.map,B=A[I];B===void 0&&(B=new ua(I),Th(h,B)),h=B}}}function Pn(r,o,h){hh.call(this),this.renderer=h;for(var u=r.getProgramParameter(o,r.ACTIVE_UNIFORMS),g=0;g<u;++g){var y=r.getActiveUniform(o,g),T=r.getUniformLocation(o,y.name);Eh(y,T,this)}}Pn.prototype.setValue=function(r,o,h){var u=this.map[o];u!==void 0&&u.setValue(r,h,this.renderer)},Pn.prototype.setOptional=function(r,o,h){var u=o[h];u!==void 0&&this.setValue(r,h,u)},Pn.upload=function(r,o,h,u){for(var g=0,y=o.length;g!==y;++g){var T=o[g],I=h[T.id];I.needsUpdate!==!1&&T.setValue(r,I.value,u)}},Pn.seqWithValue=function(r,o){for(var h=[],u=0,g=r.length;u!==g;++u){var y=r[u];y.id in o&&h.push(y)}return h};function pa(r){for(var o=r.split(`
`),h=0;h<o.length;h++)o[h]=h+1+": "+o[h];return o.join(`
`)}function ma(r,o,h){var u=r.createShader(o);return r.shaderSource(u,h),r.compileShader(u),r.getShaderParameter(u,r.COMPILE_STATUS)===!1&&console.error("THREE.WebGLShader: Shader couldn't compile."),r.getShaderInfoLog(u)!==""&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",o===r.VERTEX_SHADER?"vertex":"fragment",r.getShaderInfoLog(u),pa(h)),u}var Oc=0;function Wl(r){switch(r){case Br:return["Linear","( value )"];case Eo:return["sRGB","( value )"];case vd:return["RGBE","( value )"];case yd:return["RGBM","( value, 7.0 )"];case Io:return["RGBM","( value, 16.0 )"];case Sd:return["RGBD","( value, 256.0 )"];case xo:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+r)}}function jl(r,o){var h=Wl(o);return"vec4 "+r+"( vec4 value ) { return "+h[0]+"ToLinear"+h[1]+"; }"}function Vc(r,o){var h=Wl(o);return"vec4 "+r+"( vec4 value ) { return LinearTo"+h[0]+h[1]+"; }"}function Uc(r,o){var h;switch(o){case ee:h="Linear";break;case Ce:h="Reinhard";break;case Lt:h="Uncharted2";break;case tt:h="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+o)}return"vec3 "+r+"( vec3 color ) { return "+h+"ToneMapping( color ); }"}function An(r,o,h){r=r||{};var u=[r.derivatives||o.envMapCubeUV||o.bumpMap||o.normalMap&&!o.objectSpaceNormalMap||o.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(r.fragDepth||o.logarithmicDepthBuffer)&&h.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",r.drawBuffers&&h.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(r.shaderTextureLOD||o.envMap)&&h.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""];return u.filter(Ya).join(`
`)}function xh(r){var o=[];for(var h in r){var u=r[h];u!==!1&&o.push("#define "+h+" "+u)}return o.join(`
`)}function zc(r,o){for(var h={},u=r.getProgramParameter(o,r.ACTIVE_ATTRIBUTES),g=0;g<u;g++){var y=r.getActiveAttrib(o,g),T=y.name;h[T]=r.getAttribLocation(o,T)}return h}function Ya(r){return r!==""}function Ih(r,o){return r.replace(/NUM_DIR_LIGHTS/g,o.numDirLights).replace(/NUM_SPOT_LIGHTS/g,o.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,o.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,o.numPointLights).replace(/NUM_HEMI_LIGHTS/g,o.numHemiLights)}function ql(r,o){return r.replace(/NUM_CLIPPING_PLANES/g,o.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,o.numClippingPlanes-o.numClipIntersection)}function zo(r){var o=/^[ \t]*#include +<([\w\d.]+)>/gm;function h(u,g){var y=Si[g];if(y===void 0)throw new Error("Can not resolve #include <"+g+">");return zo(y)}return r.replace(o,h)}function Kl(r){var o=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;function h(u,g,y,T){for(var I="",D=parseInt(g);D<parseInt(y);D++)I+=T.replace(/\[ i \]/g,"[ "+D+" ]");return I}return r.replace(o,h)}function Gc(r,o,h,u,g,y){var T=r.context,I=u.defines,D=g.vertexShader,N=g.fragmentShader,A="SHADOWMAP_TYPE_BASIC";y.shadowMapType===b?A="SHADOWMAP_TYPE_PCF":y.shadowMapType===w&&(A="SHADOWMAP_TYPE_PCF_SOFT");var B="ENVMAP_TYPE_CUBE",F="ENVMAP_MODE_REFLECTION",G="ENVMAP_BLENDING_MULTIPLY";if(y.envMap){switch(u.envMap.mapping){case sn:case ki:B="ENVMAP_TYPE_CUBE";break;case cr:case Ye:B="ENVMAP_TYPE_CUBE_UV";break;case ti:case On:B="ENVMAP_TYPE_EQUIREC";break;case er:B="ENVMAP_TYPE_SPHERE";break}switch(u.envMap.mapping){case ki:case On:F="ENVMAP_MODE_REFRACTION";break}switch(u.combine){case Je:G="ENVMAP_BLENDING_MULTIPLY";break;case Ct:G="ENVMAP_BLENDING_MIX";break;case $e:G="ENVMAP_BLENDING_ADD";break}}var j=r.gammaFactor>0?r.gammaFactor:1,$=An(u.extensions,y,o),Z=xh(I),Q=T.createProgram(),ie,ne;u.isRawShaderMaterial?(ie=[Z].filter(Ya).join(`
`),ie.length>0&&(ie+=`
`),ne=[$,Z].filter(Ya).join(`
`),ne.length>0&&(ne+=`
`)):(ie=["precision "+y.precision+" float;","precision "+y.precision+" int;","#define SHADER_NAME "+g.name,Z,y.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+j,"#define MAX_BONES "+y.maxBones,y.useFog&&y.fog?"#define USE_FOG":"",y.useFog&&y.fogExp?"#define FOG_EXP2":"",y.map?"#define USE_MAP":"",y.envMap?"#define USE_ENVMAP":"",y.envMap?"#define "+F:"",y.lightMap?"#define USE_LIGHTMAP":"",y.aoMap?"#define USE_AOMAP":"",y.emissiveMap?"#define USE_EMISSIVEMAP":"",y.bumpMap?"#define USE_BUMPMAP":"",y.normalMap?"#define USE_NORMALMAP":"",y.normalMap&&y.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",y.displacementMap&&y.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",y.specularMap?"#define USE_SPECULARMAP":"",y.roughnessMap?"#define USE_ROUGHNESSMAP":"",y.metalnessMap?"#define USE_METALNESSMAP":"",y.alphaMap?"#define USE_ALPHAMAP":"",y.vertexColors?"#define USE_COLOR":"",y.flatShading?"#define FLAT_SHADED":"",y.skinning?"#define USE_SKINNING":"",y.useVertexTexture?"#define BONE_TEXTURE":"",y.morphTargets?"#define USE_MORPHTARGETS":"",y.morphNormals&&y.flatShading===!1?"#define USE_MORPHNORMALS":"",y.doubleSided?"#define DOUBLE_SIDED":"",y.flipSided?"#define FLIP_SIDED":"",y.shadowMapEnabled?"#define USE_SHADOWMAP":"",y.shadowMapEnabled?"#define "+A:"",y.sizeAttenuation?"#define USE_SIZEATTENUATION":"",y.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",y.logarithmicDepthBuffer&&o.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","   attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","   attribute vec3 morphTarget0;","   attribute vec3 morphTarget1;","   attribute vec3 morphTarget2;","   attribute vec3 morphTarget3;","   #ifdef USE_MORPHNORMALS","       attribute vec3 morphNormal0;","       attribute vec3 morphNormal1;","       attribute vec3 morphNormal2;","       attribute vec3 morphNormal3;","   #else","       attribute vec3 morphTarget4;","       attribute vec3 morphTarget5;","       attribute vec3 morphTarget6;","       attribute vec3 morphTarget7;","   #endif","#endif","#ifdef USE_SKINNING","   attribute vec4 skinIndex;","   attribute vec4 skinWeight;","#endif",`
`].filter(Ya).join(`
`),ne=[$,"precision "+y.precision+" float;","precision "+y.precision+" int;","#define SHADER_NAME "+g.name,Z,y.alphaTest?"#define ALPHATEST "+y.alphaTest+(y.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+j,y.useFog&&y.fog?"#define USE_FOG":"",y.useFog&&y.fogExp?"#define FOG_EXP2":"",y.map?"#define USE_MAP":"",y.envMap?"#define USE_ENVMAP":"",y.envMap?"#define "+B:"",y.envMap?"#define "+F:"",y.envMap?"#define "+G:"",y.lightMap?"#define USE_LIGHTMAP":"",y.aoMap?"#define USE_AOMAP":"",y.emissiveMap?"#define USE_EMISSIVEMAP":"",y.bumpMap?"#define USE_BUMPMAP":"",y.normalMap?"#define USE_NORMALMAP":"",y.normalMap&&y.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",y.specularMap?"#define USE_SPECULARMAP":"",y.roughnessMap?"#define USE_ROUGHNESSMAP":"",y.metalnessMap?"#define USE_METALNESSMAP":"",y.alphaMap?"#define USE_ALPHAMAP":"",y.vertexColors?"#define USE_COLOR":"",y.gradientMap?"#define USE_GRADIENTMAP":"",y.flatShading?"#define FLAT_SHADED":"",y.doubleSided?"#define DOUBLE_SIDED":"",y.flipSided?"#define FLIP_SIDED":"",y.shadowMapEnabled?"#define USE_SHADOWMAP":"",y.shadowMapEnabled?"#define "+A:"",y.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",y.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",y.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",y.logarithmicDepthBuffer&&o.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",y.envMap&&o.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",y.toneMapping!==pe?"#define TONE_MAPPING":"",y.toneMapping!==pe?Si.tonemapping_pars_fragment:"",y.toneMapping!==pe?Uc("toneMapping",y.toneMapping):"",y.dithering?"#define DITHERING":"",y.outputEncoding||y.mapEncoding||y.envMapEncoding||y.emissiveMapEncoding?Si.encodings_pars_fragment:"",y.mapEncoding?jl("mapTexelToLinear",y.mapEncoding):"",y.envMapEncoding?jl("envMapTexelToLinear",y.envMapEncoding):"",y.emissiveMapEncoding?jl("emissiveMapTexelToLinear",y.emissiveMapEncoding):"",y.outputEncoding?Vc("linearToOutputTexel",y.outputEncoding):"",y.depthPacking?"#define DEPTH_PACKING "+u.depthPacking:"",`
`].filter(Ya).join(`
`)),D=zo(D),D=Ih(D,y),D=ql(D,y),N=zo(N),N=Ih(N,y),N=ql(N,y),D=Kl(D),N=Kl(N);var ae=ie+D,ye=ne+N,ge=ma(T,T.VERTEX_SHADER,ae),be=ma(T,T.FRAGMENT_SHADER,ye);T.attachShader(Q,ge),T.attachShader(Q,be),u.index0AttributeName!==void 0?T.bindAttribLocation(Q,0,u.index0AttributeName):y.morphTargets===!0&&T.bindAttribLocation(Q,0,"position"),T.linkProgram(Q);var Ee=T.getProgramInfoLog(Q).trim(),Se=T.getShaderInfoLog(ge).trim(),Re=T.getShaderInfoLog(be).trim(),Ie=!0,Ve=!0;T.getProgramParameter(Q,T.LINK_STATUS)===!1?(Ie=!1,console.error("THREE.WebGLProgram: shader error: ",T.getError(),"gl.VALIDATE_STATUS",T.getProgramParameter(Q,T.VALIDATE_STATUS),"gl.getProgramInfoLog",Ee,Se,Re)):Ee!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",Ee):(Se===""||Re==="")&&(Ve=!1),Ve&&(this.diagnostics={runnable:Ie,material:u,programLog:Ee,vertexShader:{log:Se,prefix:ie},fragmentShader:{log:Re,prefix:ne}}),T.deleteShader(ge),T.deleteShader(be);var ot;this.getUniforms=function(){return ot===void 0&&(ot=new Pn(T,Q,r)),ot};var ct;return this.getAttributes=function(){return ct===void 0&&(ct=zc(T,Q)),ct},this.destroy=function(){T.deleteProgram(Q),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.name=g.name,this.id=Oc++,this.code=h,this.usedTimes=1,this.program=Q,this.vertexShader=ge,this.fragmentShader=be,this}function Hc(r,o,h){var u=[],g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},y=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function T(D){var N=D.skeleton,A=N.bones;if(h.floatVertexTextures)return 1024;var B=h.maxVertexUniforms,F=Math.floor((B-20)/4),G=Math.min(F,A.length);return G<A.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+A.length+" bones. This GPU supports "+G+"."),0):G}function I(D,N){var A;return D?D.isTexture?A=D.encoding:D.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),A=D.texture.encoding):A=Br,A===Br&&N&&(A=xo),A}this.getParameters=function(D,N,A,B,F,G,j){var $=g[D.type],Z=j.isSkinnedMesh?T(j):0,Q=h.precision;D.precision!==null&&(Q=h.getMaxPrecision(D.precision),Q!==D.precision&&console.warn("THREE.WebGLProgram.getParameters:",D.precision,"not supported, using",Q,"instead."));var ie=r.getRenderTarget(),ne={shaderID:$,precision:Q,supportsVertexTextures:h.vertexTextures,outputEncoding:I(ie?ie.texture:null,r.gammaOutput),map:!!D.map,mapEncoding:I(D.map,r.gammaInput),envMap:!!D.envMap,envMapMode:D.envMap&&D.envMap.mapping,envMapEncoding:I(D.envMap,r.gammaInput),envMapCubeUV:!!D.envMap&&(D.envMap.mapping===cr||D.envMap.mapping===Ye),lightMap:!!D.lightMap,aoMap:!!D.aoMap,emissiveMap:!!D.emissiveMap,emissiveMapEncoding:I(D.emissiveMap,r.gammaInput),bumpMap:!!D.bumpMap,normalMap:!!D.normalMap,objectSpaceNormalMap:D.normalMapType===Mo,displacementMap:!!D.displacementMap,roughnessMap:!!D.roughnessMap,metalnessMap:!!D.metalnessMap,specularMap:!!D.specularMap,alphaMap:!!D.alphaMap,gradientMap:!!D.gradientMap,combine:D.combine,vertexColors:D.vertexColors,fog:!!B,useFog:D.fog,fogExp:B&&B.isFogExp2,flatShading:D.flatShading,sizeAttenuation:D.sizeAttenuation,logarithmicDepthBuffer:h.logarithmicDepthBuffer,skinning:D.skinning&&Z>0,maxBones:Z,useVertexTexture:h.floatVertexTextures,morphTargets:D.morphTargets,morphNormals:D.morphNormals,maxMorphTargets:r.maxMorphTargets,maxMorphNormals:r.maxMorphNormals,numDirLights:N.directional.length,numPointLights:N.point.length,numSpotLights:N.spot.length,numRectAreaLights:N.rectArea.length,numHemiLights:N.hemi.length,numClippingPlanes:F,numClipIntersection:G,dithering:D.dithering,shadowMapEnabled:r.shadowMap.enabled&&j.receiveShadow&&A.length>0,shadowMapType:r.shadowMap.type,toneMapping:r.toneMapping,physicallyCorrectLights:r.physicallyCorrectLights,premultipliedAlpha:D.premultipliedAlpha,alphaTest:D.alphaTest,doubleSided:D.side===k,flipSided:D.side===E,depthPacking:D.depthPacking!==void 0?D.depthPacking:!1};return ne},this.getProgramCode=function(D,N){var A=[];if(N.shaderID?A.push(N.shaderID):(A.push(D.fragmentShader),A.push(D.vertexShader)),D.defines!==void 0)for(var B in D.defines)A.push(B),A.push(D.defines[B]);for(var F=0;F<y.length;F++)A.push(N[y[F]]);return A.push(D.onBeforeCompile.toString()),A.push(r.gammaOutput),A.join()},this.acquireProgram=function(D,N,A,B){for(var F,G=0,j=u.length;G<j;G++){var $=u[G];if($.code===B){F=$,++F.usedTimes;break}}return F===void 0&&(F=new Gc(r,o,B,D,N,A),u.push(F)),F},this.releaseProgram=function(D){if(--D.usedTimes===0){var N=u.indexOf(D);u[N]=u[u.length-1],u.pop(),D.destroy()}},this.programs=u}function Wc(){var r=new WeakMap;function o(y){var T=r.get(y);return T===void 0&&(T={},r.set(y,T)),T}function h(y){r.delete(y)}function u(y,T,I){r.get(y)[T]=I}function g(){r=new WeakMap}return{get:o,remove:h,update:u,dispose:g}}function cs(r,o){return r.renderOrder!==o.renderOrder?r.renderOrder-o.renderOrder:r.program&&o.program&&r.program!==o.program?r.program.id-o.program.id:r.material.id!==o.material.id?r.material.id-o.material.id:r.z!==o.z?r.z-o.z:r.id-o.id}function Ja(r,o){return r.renderOrder!==o.renderOrder?r.renderOrder-o.renderOrder:r.z!==o.z?o.z-r.z:r.id-o.id}function Go(){var r=[],o=0,h=[],u=[];function g(){o=0,h.length=0,u.length=0}function y(I,D,N,A,B){var F=r[o];F===void 0?(F={id:I.id,object:I,geometry:D,material:N,program:N.program,renderOrder:I.renderOrder,z:A,group:B},r[o]=F):(F.id=I.id,F.object=I,F.geometry=D,F.material=N,F.program=N.program,F.renderOrder=I.renderOrder,F.z=A,F.group=B),(N.transparent===!0?u:h).push(F),o++}function T(){h.length>1&&h.sort(cs),u.length>1&&u.sort(Ja)}return{opaque:h,transparent:u,init:g,push:y,sort:T}}function $a(){var r={};function o(u,g){var y=u.id+","+g.id,T=r[y];return T===void 0&&(T=new Go,r[y]=T),T}function h(){r={}}return{get:o,dispose:h}}function zr(){var r={};return{get:function(o){if(r[o.id]!==void 0)return r[o.id];var h;switch(o.type){case"DirectionalLight":h={direction:new he,color:new Mt,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new rt};break;case"SpotLight":h={position:new he,direction:new he,color:new Mt,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new rt};break;case"PointLight":h={position:new he,color:new Mt,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new rt,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":h={direction:new he,skyColor:new Mt,groundColor:new Mt};break;case"RectAreaLight":h={color:new Mt,position:new he,halfWidth:new he,halfHeight:new he};break}return r[o.id]=h,h}}}var jc=0;function qc(){var r=new zr,o={id:jc++,hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},h=new he,u=new Ot,g=new Ot;function y(T,I,D){for(var N=0,A=0,B=0,F=0,G=0,j=0,$=0,Z=0,Q=D.matrixWorldInverse,ie=0,ne=T.length;ie<ne;ie++){var ae=T[ie],ye=ae.color,ge=ae.intensity,be=ae.distance,Ee=ae.shadow&&ae.shadow.map?ae.shadow.map.texture:null;if(ae.isAmbientLight)N+=ye.r*ge,A+=ye.g*ge,B+=ye.b*ge;else if(ae.isDirectionalLight){var Se=r.get(ae);if(Se.color.copy(ae.color).multiplyScalar(ae.intensity),Se.direction.setFromMatrixPosition(ae.matrixWorld),h.setFromMatrixPosition(ae.target.matrixWorld),Se.direction.sub(h),Se.direction.transformDirection(Q),Se.shadow=ae.castShadow,ae.castShadow){var Re=ae.shadow;Se.shadowBias=Re.bias,Se.shadowRadius=Re.radius,Se.shadowMapSize=Re.mapSize}o.directionalShadowMap[F]=Ee,o.directionalShadowMatrix[F]=ae.shadow.matrix,o.directional[F]=Se,F++}else if(ae.isSpotLight){var Se=r.get(ae);if(Se.position.setFromMatrixPosition(ae.matrixWorld),Se.position.applyMatrix4(Q),Se.color.copy(ye).multiplyScalar(ge),Se.distance=be,Se.direction.setFromMatrixPosition(ae.matrixWorld),h.setFromMatrixPosition(ae.target.matrixWorld),Se.direction.sub(h),Se.direction.transformDirection(Q),Se.coneCos=Math.cos(ae.angle),Se.penumbraCos=Math.cos(ae.angle*(1-ae.penumbra)),Se.decay=ae.distance===0?0:ae.decay,Se.shadow=ae.castShadow,ae.castShadow){var Re=ae.shadow;Se.shadowBias=Re.bias,Se.shadowRadius=Re.radius,Se.shadowMapSize=Re.mapSize}o.spotShadowMap[j]=Ee,o.spotShadowMatrix[j]=ae.shadow.matrix,o.spot[j]=Se,j++}else if(ae.isRectAreaLight){var Se=r.get(ae);Se.color.copy(ye).multiplyScalar(ge),Se.position.setFromMatrixPosition(ae.matrixWorld),Se.position.applyMatrix4(Q),g.identity(),u.copy(ae.matrixWorld),u.premultiply(Q),g.extractRotation(u),Se.halfWidth.set(ae.width*.5,0,0),Se.halfHeight.set(0,ae.height*.5,0),Se.halfWidth.applyMatrix4(g),Se.halfHeight.applyMatrix4(g),o.rectArea[$]=Se,$++}else if(ae.isPointLight){var Se=r.get(ae);if(Se.position.setFromMatrixPosition(ae.matrixWorld),Se.position.applyMatrix4(Q),Se.color.copy(ae.color).multiplyScalar(ae.intensity),Se.distance=ae.distance,Se.decay=ae.distance===0?0:ae.decay,Se.shadow=ae.castShadow,ae.castShadow){var Re=ae.shadow;Se.shadowBias=Re.bias,Se.shadowRadius=Re.radius,Se.shadowMapSize=Re.mapSize,Se.shadowCameraNear=Re.camera.near,Se.shadowCameraFar=Re.camera.far}o.pointShadowMap[G]=Ee,o.pointShadowMatrix[G]=ae.shadow.matrix,o.point[G]=Se,G++}else if(ae.isHemisphereLight){var Se=r.get(ae);Se.direction.setFromMatrixPosition(ae.matrixWorld),Se.direction.transformDirection(Q),Se.direction.normalize(),Se.skyColor.copy(ae.color).multiplyScalar(ge),Se.groundColor.copy(ae.groundColor).multiplyScalar(ge),o.hemi[Z]=Se,Z++}}o.ambient[0]=N,o.ambient[1]=A,o.ambient[2]=B,o.directional.length=F,o.spot.length=j,o.rectArea.length=$,o.point.length=G,o.hemi.length=Z,o.hash=o.id+","+F+","+G+","+j+","+$+","+Z+","+I.length}return{setup:y,state:o}}function fa(){var r=new qc,o=[],h=[],u=[];function g(){o.length=0,h.length=0,u.length=0}function y(A){o.push(A)}function T(A){h.push(A)}function I(A){u.push(A)}function D(A){r.setup(o,h,A)}var N={lightsArray:o,shadowsArray:h,spritesArray:u,lights:r};return{init:g,state:N,setupLights:D,pushLight:y,pushShadow:T,pushSprite:I}}function Rh(){var r={};function o(u,g){var y=u.id+","+g.id,T=r[y];return T===void 0&&(T=new fa,r[y]=T),T}function h(){r={}}return{get:o,dispose:h}}function Gr(r){Xt.call(this),this.type="MeshDepthMaterial",this.depthPacking=Ro,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(r)}Gr.prototype=Object.create(Xt.prototype),Gr.prototype.constructor=Gr,Gr.prototype.isMeshDepthMaterial=!0,Gr.prototype.copy=function(r){return Xt.prototype.copy.call(this,r),this.depthPacking=r.depthPacking,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.map=r.map,this.alphaMap=r.alphaMap,this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this};function fr(r){Xt.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new he,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(r)}fr.prototype=Object.create(Xt.prototype),fr.prototype.constructor=fr,fr.prototype.isMeshDistanceMaterial=!0,fr.prototype.copy=function(r){return Xt.prototype.copy.call(this,r),this.referencePosition.copy(r.referencePosition),this.nearDistance=r.nearDistance,this.farDistance=r.farDistance,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.map=r.map,this.alphaMap=r.alphaMap,this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this};function Vs(r,o,h){for(var u=new as,g=new Ot,y=new rt,T=new rt(h,h),I=new he,D=new he,N=1,A=2,B=(N|A)+1,F=new Array(B),G=new Array(B),j={},$={0:E,1:S,2:k},Z=[new he(1,0,0),new he(-1,0,0),new he(0,0,1),new he(0,0,-1),new he(0,1,0),new he(0,-1,0)],Q=[new he(0,1,0),new he(0,1,0),new he(0,1,0),new he(0,1,0),new he(0,0,1),new he(0,0,-1)],ie=[new wi,new wi,new wi,new wi,new wi,new wi],ne=0;ne!==B;++ne){var ae=(ne&N)!==0,ye=(ne&A)!==0,ge=new Gr({depthPacking:bd,morphTargets:ae,skinning:ye});F[ne]=ge;var be=new fr({morphTargets:ae,skinning:ye});G[ne]=be}var Ee=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=b,this.render=function(Ie,Ve,ot){if(Ee.enabled!==!1&&!(Ee.autoUpdate===!1&&Ee.needsUpdate===!1)&&Ie.length!==0){var ct=r.context,pt=r.state;pt.disable(ct.BLEND),pt.buffers.color.setClear(1,1,1,1),pt.buffers.depth.setTest(!0),pt.setScissorTest(!1);for(var yt,ue=0,fe=Ie.length;ue<fe;ue++){var je=Ie[ue],Fe=je.shadow,mt=je&&je.isPointLight;if(Fe===void 0){console.warn("THREE.WebGLShadowMap:",je,"has no shadow.");continue}var we=Fe.camera;if(y.copy(Fe.mapSize),y.min(T),mt){var ut=y.x,Qe=y.y;ie[0].set(ut*2,Qe,ut,Qe),ie[1].set(0,Qe,ut,Qe),ie[2].set(ut*3,Qe,ut,Qe),ie[3].set(ut,Qe,ut,Qe),ie[4].set(ut*3,0,ut,Qe),ie[5].set(ut,0,ut,Qe),y.x*=4,y.y*=2}if(Fe.map===null){var Nt={minFilter:Hi,magFilter:Hi,format:Dn};Fe.map=new Nn(y.x,y.y,Nt),Fe.map.texture.name=je.name+".shadowMap",we.updateProjectionMatrix()}Fe.isSpotLightShadow&&Fe.update(je);var at=Fe.map,Dt=Fe.matrix;D.setFromMatrixPosition(je.matrixWorld),we.position.copy(D),mt?(yt=6,Dt.makeTranslation(-D.x,-D.y,-D.z)):(yt=1,I.setFromMatrixPosition(je.target.matrixWorld),we.lookAt(I),we.updateMatrixWorld(),Dt.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),Dt.multiply(we.projectionMatrix),Dt.multiply(we.matrixWorldInverse)),r.setRenderTarget(at),r.clear();for(var Qt=0;Qt<yt;Qt++){if(mt){I.copy(we.position),I.add(Z[Qt]),we.up.copy(Q[Qt]),we.lookAt(I),we.updateMatrixWorld();var Yi=ie[Qt];pt.viewport(Yi)}g.multiplyMatrices(we.projectionMatrix,we.matrixWorldInverse),u.setFromMatrix(g),Re(Ve,ot,we,mt)}}Ee.needsUpdate=!1}};function Se(Ie,Ve,ot,ct,pt,yt){var ue=Ie.geometry,fe=null,je=F,Fe=Ie.customDepthMaterial;if(ot&&(je=G,Fe=Ie.customDistanceMaterial),Fe)fe=Fe;else{var mt=!1;Ve.morphTargets&&(ue&&ue.isBufferGeometry?mt=ue.morphAttributes&&ue.morphAttributes.position&&ue.morphAttributes.position.length>0:ue&&ue.isGeometry&&(mt=ue.morphTargets&&ue.morphTargets.length>0)),Ie.isSkinnedMesh&&Ve.skinning===!1&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",Ie);var we=Ie.isSkinnedMesh&&Ve.skinning,ut=0;mt&&(ut|=N),we&&(ut|=A),fe=je[ut]}if(r.localClippingEnabled&&Ve.clipShadows===!0&&Ve.clippingPlanes.length!==0){var Qe=fe.uuid,Nt=Ve.uuid,at=j[Qe];at===void 0&&(at={},j[Qe]=at);var Dt=at[Nt];Dt===void 0&&(Dt=fe.clone(),at[Nt]=Dt),fe=Dt}return fe.visible=Ve.visible,fe.wireframe=Ve.wireframe,fe.side=Ve.shadowSide!=null?Ve.shadowSide:$[Ve.side],fe.clipShadows=Ve.clipShadows,fe.clippingPlanes=Ve.clippingPlanes,fe.clipIntersection=Ve.clipIntersection,fe.wireframeLinewidth=Ve.wireframeLinewidth,fe.linewidth=Ve.linewidth,ot&&fe.isMeshDistanceMaterial&&(fe.referencePosition.copy(ct),fe.nearDistance=pt,fe.farDistance=yt),fe}function Re(Ie,Ve,ot,ct){if(Ie.visible!==!1){var pt=Ie.layers.test(Ve.layers);if(pt&&(Ie.isMesh||Ie.isLine||Ie.isPoints)&&Ie.castShadow&&(!Ie.frustumCulled||u.intersectsObject(Ie))){Ie.modelViewMatrix.multiplyMatrices(ot.matrixWorldInverse,Ie.matrixWorld);var yt=o.update(Ie),ue=Ie.material;if(Array.isArray(ue))for(var fe=yt.groups,je=0,Fe=fe.length;je<Fe;je++){var mt=fe[je],we=ue[mt.materialIndex];if(we&&we.visible){var ut=Se(Ie,we,ct,D,ot.near,ot.far);r.renderBufferDirect(ot,null,yt,ut,Ie,mt)}}else if(ue.visible){var ut=Se(Ie,ue,ct,D,ot.near,ot.far);r.renderBufferDirect(ot,null,yt,ut,Ie,null)}}for(var Qe=Ie.children,Nt=0,at=Qe.length;Nt<at;Nt++)Re(Qe[Nt],Ve,ot,ct)}}}function Hr(r,o,h,u,g,y,T,I,D){Ci.call(this,r,o,h,u,g,y,T,I,D),this.needsUpdate=!0}Hr.prototype=Object.create(Ci.prototype),Hr.prototype.constructor=Hr,Hr.prototype.isCanvasTexture=!0;function Mh(r,o,h,u,g){var y,T,I,D,N,A,B=new he,F=new en,G=new he;function j(){var Q=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),ie=new Uint16Array([0,1,2,0,2,3]);y=o.createBuffer(),T=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,y),o.bufferData(o.ARRAY_BUFFER,Q,o.STATIC_DRAW),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,T),o.bufferData(o.ELEMENT_ARRAY_BUFFER,ie,o.STATIC_DRAW),I=$(),D={position:o.getAttribLocation(I,"position"),uv:o.getAttribLocation(I,"uv")},N={uvOffset:o.getUniformLocation(I,"uvOffset"),uvScale:o.getUniformLocation(I,"uvScale"),rotation:o.getUniformLocation(I,"rotation"),center:o.getUniformLocation(I,"center"),scale:o.getUniformLocation(I,"scale"),color:o.getUniformLocation(I,"color"),map:o.getUniformLocation(I,"map"),opacity:o.getUniformLocation(I,"opacity"),modelViewMatrix:o.getUniformLocation(I,"modelViewMatrix"),projectionMatrix:o.getUniformLocation(I,"projectionMatrix"),fogType:o.getUniformLocation(I,"fogType"),fogDensity:o.getUniformLocation(I,"fogDensity"),fogNear:o.getUniformLocation(I,"fogNear"),fogFar:o.getUniformLocation(I,"fogFar"),fogColor:o.getUniformLocation(I,"fogColor"),fogDepth:o.getUniformLocation(I,"fogDepth"),alphaTest:o.getUniformLocation(I,"alphaTest")};var ne=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");ne.width=8,ne.height=8;var ae=ne.getContext("2d");ae.fillStyle="white",ae.fillRect(0,0,8,8),A=new Hr(ne)}this.render=function(Q,ie,ne){if(Q.length!==0){I===void 0&&j(),h.useProgram(I),h.initAttributes(),h.enableAttribute(D.position),h.enableAttribute(D.uv),h.disableUnusedAttributes(),h.disable(o.CULL_FACE),h.enable(o.BLEND),o.bindBuffer(o.ARRAY_BUFFER,y),o.vertexAttribPointer(D.position,2,o.FLOAT,!1,2*8,0),o.vertexAttribPointer(D.uv,2,o.FLOAT,!1,2*8,8),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,T),o.uniformMatrix4fv(N.projectionMatrix,!1,ne.projectionMatrix.elements),h.activeTexture(o.TEXTURE0),o.uniform1i(N.map,0);var ae=0,ye=0,ge=ie.fog;ge?(o.uniform3f(N.fogColor,ge.color.r,ge.color.g,ge.color.b),ge.isFog?(o.uniform1f(N.fogNear,ge.near),o.uniform1f(N.fogFar,ge.far),o.uniform1i(N.fogType,1),ae=1,ye=1):ge.isFogExp2&&(o.uniform1f(N.fogDensity,ge.density),o.uniform1i(N.fogType,2),ae=2,ye=2)):(o.uniform1i(N.fogType,0),ae=0,ye=0);for(var be=0,Ee=Q.length;be<Ee;be++){var Se=Q[be];Se.modelViewMatrix.multiplyMatrices(ne.matrixWorldInverse,Se.matrixWorld),Se.z=-Se.modelViewMatrix.elements[14]}Q.sort(Z);for(var Re=[],Ie=[],be=0,Ee=Q.length;be<Ee;be++){var Se=Q[be],Ve=Se.material;if(Ve.visible!==!1){Se.onBeforeRender(r,ie,ne,void 0,Ve,void 0),o.uniform1f(N.alphaTest,Ve.alphaTest),o.uniformMatrix4fv(N.modelViewMatrix,!1,Se.modelViewMatrix.elements),Se.matrixWorld.decompose(B,F,G),Re[0]=G.x,Re[1]=G.y,Ie[0]=Se.center.x-.5,Ie[1]=Se.center.y-.5;var ot=0;ie.fog&&Ve.fog&&(ot=ye),ae!==ot&&(o.uniform1i(N.fogType,ot),ae=ot),Ve.map!==null?(o.uniform2f(N.uvOffset,Ve.map.offset.x,Ve.map.offset.y),o.uniform2f(N.uvScale,Ve.map.repeat.x,Ve.map.repeat.y)):(o.uniform2f(N.uvOffset,0,0),o.uniform2f(N.uvScale,1,1)),o.uniform1f(N.opacity,Ve.opacity),o.uniform3f(N.color,Ve.color.r,Ve.color.g,Ve.color.b),o.uniform1f(N.rotation,Ve.rotation),o.uniform2fv(N.center,Ie),o.uniform2fv(N.scale,Re),h.setBlending(Ve.blending,Ve.blendEquation,Ve.blendSrc,Ve.blendDst,Ve.blendEquationAlpha,Ve.blendSrcAlpha,Ve.blendDstAlpha,Ve.premultipliedAlpha),h.buffers.depth.setTest(Ve.depthTest),h.buffers.depth.setMask(Ve.depthWrite),h.buffers.color.setMask(Ve.colorWrite),u.setTexture2D(Ve.map||A,0),o.drawElements(o.TRIANGLES,6,o.UNSIGNED_SHORT,0),Se.onAfterRender(r,ie,ne,void 0,Ve,void 0)}}h.enable(o.CULL_FACE),h.reset()}};function $(){var Q=o.createProgram(),ie=o.createShader(o.VERTEX_SHADER),ne=o.createShader(o.FRAGMENT_SHADER);return o.shaderSource(ie,["precision "+g.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 center;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float fogDepth;","void main() {","   vUV = uvOffset + uv * uvScale;","   vec2 alignedPosition = ( position - center ) * scale;","   vec2 rotatedPosition;","   rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","   rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","   vec4 mvPosition;","   mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","   mvPosition.xy += rotatedPosition;","   gl_Position = projectionMatrix * mvPosition;","   fogDepth = - mvPosition.z;","}"].join(`
`)),o.shaderSource(ne,["precision "+g.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","varying float fogDepth;","void main() {","   vec4 texture = texture2D( map, vUV );","   gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","   if ( gl_FragColor.a < alphaTest ) discard;","   if ( fogType > 0 ) {","       float fogFactor = 0.0;","       if ( fogType == 1 ) {","           fogFactor = smoothstep( fogNear, fogFar, fogDepth );","       } else {","           const float LOG2 = 1.442695;","           fogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );","           fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","       }","       gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );","   }","}"].join(`
`)),o.compileShader(ie),o.compileShader(ne),o.attachShader(Q,ie),o.attachShader(Q,ne),o.linkProgram(Q),Q}function Z(Q,ie){return Q.renderOrder!==ie.renderOrder?Q.renderOrder-ie.renderOrder:Q.z!==ie.z?ie.z-Q.z:ie.id-Q.id}}function Kc(r,o,h){function u(){var Ae=!1,St=new wi,Et=null,ii=new wi(0,0,0,0);return{setMask:function(It){Et!==It&&!Ae&&(r.colorMask(It,It,It,It),Et=It)},setLocked:function(It){Ae=It},setClear:function(It,oi,Mi,pi,bn){bn===!0&&(It*=pi,oi*=pi,Mi*=pi),St.set(It,oi,Mi,pi),ii.equals(St)===!1&&(r.clearColor(It,oi,Mi,pi),ii.copy(St))},reset:function(){Ae=!1,Et=null,ii.set(-1,0,0,0)}}}function g(){var Ae=!1,St=null,Et=null,ii=null;return{setTest:function(It){It?Dt(r.DEPTH_TEST):Qt(r.DEPTH_TEST)},setMask:function(It){St!==It&&!Ae&&(r.depthMask(It),St=It)},setFunc:function(It){if(Et!==It){if(It)switch(It){case ei:r.depthFunc(r.NEVER);break;case ui:r.depthFunc(r.ALWAYS);break;case vi:r.depthFunc(r.LESS);break;case Xe:r.depthFunc(r.LEQUAL);break;case bi:r.depthFunc(r.EQUAL);break;case st:r.depthFunc(r.GEQUAL);break;case De:r.depthFunc(r.GREATER);break;case Me:r.depthFunc(r.NOTEQUAL);break;default:r.depthFunc(r.LEQUAL)}else r.depthFunc(r.LEQUAL);Et=It}},setLocked:function(It){Ae=It},setClear:function(It){ii!==It&&(r.clearDepth(It),ii=It)},reset:function(){Ae=!1,St=null,Et=null,ii=null}}}function y(){var Ae=!1,St=null,Et=null,ii=null,It=null,oi=null,Mi=null,pi=null,bn=null;return{setTest:function(ci){ci?Dt(r.STENCIL_TEST):Qt(r.STENCIL_TEST)},setMask:function(ci){St!==ci&&!Ae&&(r.stencilMask(ci),St=ci)},setFunc:function(ci,Cn,kn){(Et!==ci||ii!==Cn||It!==kn)&&(r.stencilFunc(ci,Cn,kn),Et=ci,ii=Cn,It=kn)},setOp:function(ci,Cn,kn){(oi!==ci||Mi!==Cn||pi!==kn)&&(r.stencilOp(ci,Cn,kn),oi=ci,Mi=Cn,pi=kn)},setLocked:function(ci){Ae=ci},setClear:function(ci){bn!==ci&&(r.clearStencil(ci),bn=ci)},reset:function(){Ae=!1,St=null,Et=null,ii=null,It=null,oi=null,Mi=null,pi=null,bn=null}}}var T=new u,I=new g,D=new y,N=r.getParameter(r.MAX_VERTEX_ATTRIBS),A=new Uint8Array(N),B=new Uint8Array(N),F=new Uint8Array(N),G={},j=null,$=null,Z=null,Q=null,ie=null,ne=null,ae=null,ye=null,ge=null,be=!1,Ee=null,Se=null,Re=null,Ie=null,Ve=null,ot=r.getParameter(r.MAX_COMBINED_TEXTURE_IMAGE_UNITS),ct=!1,pt=0,yt=r.getParameter(r.VERSION);yt.indexOf("WebGL")!==-1?(pt=parseFloat(/^WebGL\ ([0-9])/.exec(yt)[1]),ct=pt>=1):yt.indexOf("OpenGL ES")!==-1&&(pt=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(yt)[1]),ct=pt>=2);var ue=null,fe={},je=new wi,Fe=new wi;function mt(Ae,St,Et){var ii=new Uint8Array(4),It=r.createTexture();r.bindTexture(Ae,It),r.texParameteri(Ae,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(Ae,r.TEXTURE_MAG_FILTER,r.NEAREST);for(var oi=0;oi<Et;oi++)r.texImage2D(St+oi,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,ii);return It}var we={};we[r.TEXTURE_2D]=mt(r.TEXTURE_2D,r.TEXTURE_2D,1),we[r.TEXTURE_CUBE_MAP]=mt(r.TEXTURE_CUBE_MAP,r.TEXTURE_CUBE_MAP_POSITIVE_X,6),T.setClear(0,0,0,1),I.setClear(1),D.setClear(0),Dt(r.DEPTH_TEST),I.setFunc(Xe),zi(!1),br(s),Dt(r.CULL_FACE),Dt(r.BLEND),_i(z);function ut(){for(var Ae=0,St=A.length;Ae<St;Ae++)A[Ae]=0}function Qe(Ae){Nt(Ae,0)}function Nt(Ae,St){if(A[Ae]=1,B[Ae]===0&&(r.enableVertexAttribArray(Ae),B[Ae]=1),F[Ae]!==St){var Et=o.get("ANGLE_instanced_arrays");Et.vertexAttribDivisorANGLE(Ae,St),F[Ae]=St}}function at(){for(var Ae=0,St=B.length;Ae!==St;++Ae)B[Ae]!==A[Ae]&&(r.disableVertexAttribArray(Ae),B[Ae]=0)}function Dt(Ae){G[Ae]!==!0&&(r.enable(Ae),G[Ae]=!0)}function Qt(Ae){G[Ae]!==!1&&(r.disable(Ae),G[Ae]=!1)}function Yi(){if(j===null&&(j=[],o.get("WEBGL_compressed_texture_pvrtc")||o.get("WEBGL_compressed_texture_s3tc")||o.get("WEBGL_compressed_texture_etc1")||o.get("WEBGL_compressed_texture_astc")))for(var Ae=r.getParameter(r.COMPRESSED_TEXTURE_FORMATS),St=0;St<Ae.length;St++)j.push(Ae[St]);return j}function ft(Ae){return $!==Ae?(r.useProgram(Ae),$=Ae,!0):!1}function _i(Ae,St,Et,ii,It,oi,Mi,pi){if(Ae!==O?Dt(r.BLEND):Qt(r.BLEND),Ae!==se){if(Ae!==Z||pi!==be)switch(Ae){case K:pi?(r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD),r.blendFuncSeparate(r.ONE,r.ONE,r.ONE,r.ONE)):(r.blendEquation(r.FUNC_ADD),r.blendFunc(r.SRC_ALPHA,r.ONE));break;case q:pi?(r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD),r.blendFuncSeparate(r.ZERO,r.ZERO,r.ONE_MINUS_SRC_COLOR,r.ONE_MINUS_SRC_ALPHA)):(r.blendEquation(r.FUNC_ADD),r.blendFunc(r.ZERO,r.ONE_MINUS_SRC_COLOR));break;case Y:pi?(r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD),r.blendFuncSeparate(r.ZERO,r.SRC_COLOR,r.ZERO,r.SRC_ALPHA)):(r.blendEquation(r.FUNC_ADD),r.blendFunc(r.ZERO,r.SRC_COLOR));break;default:pi?(r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD),r.blendFuncSeparate(r.ONE,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA)):(r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD),r.blendFuncSeparate(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA))}Q=null,ie=null,ne=null,ae=null,ye=null,ge=null}else It=It||St,oi=oi||Et,Mi=Mi||ii,(St!==Q||It!==ae)&&(r.blendEquationSeparate(h.convert(St),h.convert(It)),Q=St,ae=It),(Et!==ie||ii!==ne||oi!==ye||Mi!==ge)&&(r.blendFuncSeparate(h.convert(Et),h.convert(ii),h.convert(oi),h.convert(Mi)),ie=Et,ne=ii,ye=oi,ge=Mi);Z=Ae,be=pi}function yn(Ae,St){Ae.side===k?Qt(r.CULL_FACE):Dt(r.CULL_FACE);var Et=Ae.side===E;St&&(Et=!Et),zi(Et),Ae.blending===z&&Ae.transparent===!1?_i(O):_i(Ae.blending,Ae.blendEquation,Ae.blendSrc,Ae.blendDst,Ae.blendEquationAlpha,Ae.blendSrcAlpha,Ae.blendDstAlpha,Ae.premultipliedAlpha),I.setFunc(Ae.depthFunc),I.setTest(Ae.depthTest),I.setMask(Ae.depthWrite),T.setMask(Ae.colorWrite),Sn(Ae.polygonOffset,Ae.polygonOffsetFactor,Ae.polygonOffsetUnits)}function zi(Ae){Ee!==Ae&&(Ae?r.frontFace(r.CW):r.frontFace(r.CCW),Ee=Ae)}function br(Ae){Ae!==n?(Dt(r.CULL_FACE),Ae!==Se&&(Ae===s?r.cullFace(r.BACK):Ae===a?r.cullFace(r.FRONT):r.cullFace(r.FRONT_AND_BACK))):Qt(r.CULL_FACE),Se=Ae}function ji(Ae){Ae!==Re&&(ct&&r.lineWidth(Ae),Re=Ae)}function Sn(Ae,St,Et){Ae?(Dt(r.POLYGON_OFFSET_FILL),(Ie!==St||Ve!==Et)&&(r.polygonOffset(St,Et),Ie=St,Ve=Et)):Qt(r.POLYGON_OFFSET_FILL)}function Zn(Ae){Ae?Dt(r.SCISSOR_TEST):Qt(r.SCISSOR_TEST)}function Js(Ae){Ae===void 0&&(Ae=r.TEXTURE0+ot-1),ue!==Ae&&(r.activeTexture(Ae),ue=Ae)}function es(Ae,St){ue===null&&Js();var Et=fe[ue];Et===void 0&&(Et={type:void 0,texture:void 0},fe[ue]=Et),(Et.type!==Ae||Et.texture!==St)&&(r.bindTexture(Ae,St||we[Ae]),Et.type=Ae,Et.texture=St)}function $s(){try{r.compressedTexImage2D.apply(r,arguments)}catch(Ae){console.error("THREE.WebGLState:",Ae)}}function Gi(){try{r.texImage2D.apply(r,arguments)}catch(Ae){console.error("THREE.WebGLState:",Ae)}}function Cr(Ae){je.equals(Ae)===!1&&(r.scissor(Ae.x,Ae.y,Ae.z,Ae.w),je.copy(Ae))}function Fn(Ae){Fe.equals(Ae)===!1&&(r.viewport(Ae.x,Ae.y,Ae.z,Ae.w),Fe.copy(Ae))}function dr(){for(var Ae=0;Ae<B.length;Ae++)B[Ae]===1&&(r.disableVertexAttribArray(Ae),B[Ae]=0);G={},j=null,ue=null,fe={},$=null,Z=null,Ee=null,Se=null,T.reset(),I.reset(),D.reset()}return{buffers:{color:T,depth:I,stencil:D},initAttributes:ut,enableAttribute:Qe,enableAttributeAndDivisor:Nt,disableUnusedAttributes:at,enable:Dt,disable:Qt,getCompressedTextureFormats:Yi,useProgram:ft,setBlending:_i,setMaterial:yn,setFlipSided:zi,setCullFace:br,setLineWidth:ji,setPolygonOffset:Sn,setScissorTest:Zn,activeTexture:Js,bindTexture:es,compressedTexImage2D:$s,texImage2D:Gi,scissor:Cr,viewport:Fn,reset:dr}}function kh(r,o,h,u,g,y,T){var I=typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext,D={},N;function A(ue,fe){if(ue.width>fe||ue.height>fe){if("data"in ue){console.warn("THREE.WebGLRenderer: image in DataTexture is too big ("+ue.width+"x"+ue.height+").");return}var je=fe/Math.max(ue.width,ue.height),Fe=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");Fe.width=Math.floor(ue.width*je),Fe.height=Math.floor(ue.height*je);var mt=Fe.getContext("2d");return mt.drawImage(ue,0,0,ue.width,ue.height,0,0,Fe.width,Fe.height),console.warn("THREE.WebGLRenderer: image is too big ("+ue.width+"x"+ue.height+"). Resized to "+Fe.width+"x"+Fe.height,ue),Fe}return ue}function B(ue){return si.isPowerOfTwo(ue.width)&&si.isPowerOfTwo(ue.height)}function F(ue){if(ue instanceof HTMLImageElement||ue instanceof HTMLCanvasElement||ue instanceof ImageBitmap){N===void 0&&(N=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),N.width=si.floorPowerOfTwo(ue.width),N.height=si.floorPowerOfTwo(ue.height);var fe=N.getContext("2d");return fe.drawImage(ue,0,0,N.width,N.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+ue.width+"x"+ue.height+"). Resized to "+N.width+"x"+N.height,ue),N}return ue}function G(ue){return ue.wrapS!==xi||ue.wrapT!==xi||ue.minFilter!==Hi&&ue.minFilter!==fn}function j(ue,fe){return ue.generateMipmaps&&fe&&ue.minFilter!==Hi&&ue.minFilter!==fn}function $(ue,fe,je,Fe){r.generateMipmap(ue);var mt=u.get(fe);mt.__maxMipLevel=Math.log(Math.max(je,Fe))*Math.LOG2E}function Z(ue){return ue===Hi||ue===Nr||ue===Ft?r.NEAREST:r.LINEAR}function Q(ue){var fe=ue.target;fe.removeEventListener("dispose",Q),ne(fe),fe.isVideoTexture&&delete D[fe.id],T.memory.textures--}function ie(ue){var fe=ue.target;fe.removeEventListener("dispose",ie),ae(fe),T.memory.textures--}function ne(ue){var fe=u.get(ue);if(ue.image&&fe.__image__webglTextureCube)r.deleteTexture(fe.__image__webglTextureCube);else{if(fe.__webglInit===void 0)return;r.deleteTexture(fe.__webglTexture)}u.remove(ue)}function ae(ue){var fe=u.get(ue),je=u.get(ue.texture);if(!!ue){if(je.__webglTexture!==void 0&&r.deleteTexture(je.__webglTexture),ue.depthTexture&&ue.depthTexture.dispose(),ue.isWebGLRenderTargetCube)for(var Fe=0;Fe<6;Fe++)r.deleteFramebuffer(fe.__webglFramebuffer[Fe]),fe.__webglDepthbuffer&&r.deleteRenderbuffer(fe.__webglDepthbuffer[Fe]);else r.deleteFramebuffer(fe.__webglFramebuffer),fe.__webglDepthbuffer&&r.deleteRenderbuffer(fe.__webglDepthbuffer);u.remove(ue.texture),u.remove(ue)}}function ye(ue,fe){var je=u.get(ue);if(ue.isVideoTexture&&yt(ue),ue.version>0&&je.__version!==ue.version){var Fe=ue.image;if(Fe===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",ue);else if(Fe.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",ue);else{Se(je,ue,fe);return}}h.activeTexture(r.TEXTURE0+fe),h.bindTexture(r.TEXTURE_2D,je.__webglTexture)}function ge(ue,fe){var je=u.get(ue);if(ue.image.length===6)if(ue.version>0&&je.__version!==ue.version){je.__image__webglTextureCube||(ue.addEventListener("dispose",Q),je.__image__webglTextureCube=r.createTexture(),T.memory.textures++),h.activeTexture(r.TEXTURE0+fe),h.bindTexture(r.TEXTURE_CUBE_MAP,je.__image__webglTextureCube),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,ue.flipY);for(var Fe=ue&&ue.isCompressedTexture,mt=ue.image[0]&&ue.image[0].isDataTexture,we=[],ut=0;ut<6;ut++)!Fe&&!mt?we[ut]=A(ue.image[ut],g.maxCubemapSize):we[ut]=mt?ue.image[ut].image:ue.image[ut];var Qe=we[0],Nt=B(Qe),at=y.convert(ue.format),Dt=y.convert(ue.type);Ee(r.TEXTURE_CUBE_MAP,ue,Nt);for(var ut=0;ut<6;ut++)if(!Fe)mt?h.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+ut,0,at,we[ut].width,we[ut].height,0,at,Dt,we[ut].data):h.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+ut,0,at,at,Dt,we[ut]);else for(var Qt,Yi=we[ut].mipmaps,ft=0,_i=Yi.length;ft<_i;ft++)Qt=Yi[ft],ue.format!==Dn&&ue.format!==Tr?h.getCompressedTextureFormats().indexOf(at)>-1?h.compressedTexImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+ut,ft,at,Qt.width,Qt.height,0,Qt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):h.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+ut,ft,at,Qt.width,Qt.height,0,at,Dt,Qt.data);Fe?je.__maxMipLevel=Yi.length-1:je.__maxMipLevel=0,j(ue,Nt)&&$(r.TEXTURE_CUBE_MAP,ue,Qe.width,Qe.height),je.__version=ue.version,ue.onUpdate&&ue.onUpdate(ue)}else h.activeTexture(r.TEXTURE0+fe),h.bindTexture(r.TEXTURE_CUBE_MAP,je.__image__webglTextureCube)}function be(ue,fe){h.activeTexture(r.TEXTURE0+fe),h.bindTexture(r.TEXTURE_CUBE_MAP,u.get(ue).__webglTexture)}function Ee(ue,fe,je){var Fe;if(je?(r.texParameteri(ue,r.TEXTURE_WRAP_S,y.convert(fe.wrapS)),r.texParameteri(ue,r.TEXTURE_WRAP_T,y.convert(fe.wrapT)),r.texParameteri(ue,r.TEXTURE_MAG_FILTER,y.convert(fe.magFilter)),r.texParameteri(ue,r.TEXTURE_MIN_FILTER,y.convert(fe.minFilter))):(r.texParameteri(ue,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(ue,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),(fe.wrapS!==xi||fe.wrapT!==xi)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",fe),r.texParameteri(ue,r.TEXTURE_MAG_FILTER,Z(fe.magFilter)),r.texParameteri(ue,r.TEXTURE_MIN_FILTER,Z(fe.minFilter)),fe.minFilter!==Hi&&fe.minFilter!==fn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",fe)),Fe=o.get("EXT_texture_filter_anisotropic"),Fe){if(fe.type===Gt&&o.get("OES_texture_float_linear")===null||fe.type===Wi&&o.get("OES_texture_half_float_linear")===null)return;(fe.anisotropy>1||u.get(fe).__currentAnisotropy)&&(r.texParameterf(ue,Fe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(fe.anisotropy,g.getMaxAnisotropy())),u.get(fe).__currentAnisotropy=fe.anisotropy)}}function Se(ue,fe,je){ue.__webglInit===void 0&&(ue.__webglInit=!0,fe.addEventListener("dispose",Q),ue.__webglTexture=r.createTexture(),T.memory.textures++),h.activeTexture(r.TEXTURE0+je),h.bindTexture(r.TEXTURE_2D,ue.__webglTexture),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,fe.flipY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,fe.premultiplyAlpha),r.pixelStorei(r.UNPACK_ALIGNMENT,fe.unpackAlignment);var Fe=A(fe.image,g.maxTextureSize);G(fe)&&B(Fe)===!1&&(Fe=F(Fe));var mt=B(Fe),we=y.convert(fe.format),ut=y.convert(fe.type);Ee(r.TEXTURE_2D,fe,mt);var Qe,Nt=fe.mipmaps;if(fe.isDepthTexture){var at=r.DEPTH_COMPONENT;if(fe.type===Gt){if(!I)throw new Error("Float Depth Texture only supported in WebGL2.0");at=r.DEPTH_COMPONENT32F}else I&&(at=r.DEPTH_COMPONENT16);fe.format===Ze&&at===r.DEPTH_COMPONENT&&fe.type!==Le&&fe.type!==et&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),fe.type=Le,ut=y.convert(fe.type)),fe.format===We&&(at=r.DEPTH_STENCIL,fe.type!==Ar&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),fe.type=Ar,ut=y.convert(fe.type))),h.texImage2D(r.TEXTURE_2D,0,at,Fe.width,Fe.height,0,we,ut,null)}else if(fe.isDataTexture)if(Nt.length>0&&mt){for(var Dt=0,Qt=Nt.length;Dt<Qt;Dt++)Qe=Nt[Dt],h.texImage2D(r.TEXTURE_2D,Dt,we,Qe.width,Qe.height,0,we,ut,Qe.data);fe.generateMipmaps=!1,ue.__maxMipLevel=Nt.length-1}else h.texImage2D(r.TEXTURE_2D,0,we,Fe.width,Fe.height,0,we,ut,Fe.data),ue.__maxMipLevel=0;else if(fe.isCompressedTexture){for(var Dt=0,Qt=Nt.length;Dt<Qt;Dt++)Qe=Nt[Dt],fe.format!==Dn&&fe.format!==Tr?h.getCompressedTextureFormats().indexOf(we)>-1?h.compressedTexImage2D(r.TEXTURE_2D,Dt,we,Qe.width,Qe.height,0,Qe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):h.texImage2D(r.TEXTURE_2D,Dt,we,Qe.width,Qe.height,0,we,ut,Qe.data);ue.__maxMipLevel=Nt.length-1}else if(Nt.length>0&&mt){for(var Dt=0,Qt=Nt.length;Dt<Qt;Dt++)Qe=Nt[Dt],h.texImage2D(r.TEXTURE_2D,Dt,we,we,ut,Qe);fe.generateMipmaps=!1,ue.__maxMipLevel=Nt.length-1}else h.texImage2D(r.TEXTURE_2D,0,we,we,ut,Fe),ue.__maxMipLevel=0;j(fe,mt)&&$(r.TEXTURE_2D,fe,Fe.width,Fe.height),ue.__version=fe.version,fe.onUpdate&&fe.onUpdate(fe)}function Re(ue,fe,je,Fe){var mt=y.convert(fe.texture.format),we=y.convert(fe.texture.type);h.texImage2D(Fe,0,mt,fe.width,fe.height,0,mt,we,null),r.bindFramebuffer(r.FRAMEBUFFER,ue),r.framebufferTexture2D(r.FRAMEBUFFER,je,Fe,u.get(fe.texture).__webglTexture,0),r.bindFramebuffer(r.FRAMEBUFFER,null)}function Ie(ue,fe){r.bindRenderbuffer(r.RENDERBUFFER,ue),fe.depthBuffer&&!fe.stencilBuffer?(r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_COMPONENT16,fe.width,fe.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,ue)):fe.depthBuffer&&fe.stencilBuffer?(r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,fe.width,fe.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,ue)):r.renderbufferStorage(r.RENDERBUFFER,r.RGBA4,fe.width,fe.height),r.bindRenderbuffer(r.RENDERBUFFER,null)}function Ve(ue,fe){var je=fe&&fe.isWebGLRenderTargetCube;if(je)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(r.FRAMEBUFFER,ue),!(fe.depthTexture&&fe.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!u.get(fe.depthTexture).__webglTexture||fe.depthTexture.image.width!==fe.width||fe.depthTexture.image.height!==fe.height)&&(fe.depthTexture.image.width=fe.width,fe.depthTexture.image.height=fe.height,fe.depthTexture.needsUpdate=!0),ye(fe.depthTexture,0);var Fe=u.get(fe.depthTexture).__webglTexture;if(fe.depthTexture.format===Ze)r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,Fe,0);else if(fe.depthTexture.format===We)r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.TEXTURE_2D,Fe,0);else throw new Error("Unknown depthTexture format")}function ot(ue){var fe=u.get(ue),je=ue.isWebGLRenderTargetCube===!0;if(ue.depthTexture){if(je)throw new Error("target.depthTexture not supported in Cube render targets");Ve(fe.__webglFramebuffer,ue)}else if(je){fe.__webglDepthbuffer=[];for(var Fe=0;Fe<6;Fe++)r.bindFramebuffer(r.FRAMEBUFFER,fe.__webglFramebuffer[Fe]),fe.__webglDepthbuffer[Fe]=r.createRenderbuffer(),Ie(fe.__webglDepthbuffer[Fe],ue)}else r.bindFramebuffer(r.FRAMEBUFFER,fe.__webglFramebuffer),fe.__webglDepthbuffer=r.createRenderbuffer(),Ie(fe.__webglDepthbuffer,ue);r.bindFramebuffer(r.FRAMEBUFFER,null)}function ct(ue){var fe=u.get(ue),je=u.get(ue.texture);ue.addEventListener("dispose",ie),je.__webglTexture=r.createTexture(),T.memory.textures++;var Fe=ue.isWebGLRenderTargetCube===!0,mt=B(ue);if(Fe){fe.__webglFramebuffer=[];for(var we=0;we<6;we++)fe.__webglFramebuffer[we]=r.createFramebuffer()}else fe.__webglFramebuffer=r.createFramebuffer();if(Fe){h.bindTexture(r.TEXTURE_CUBE_MAP,je.__webglTexture),Ee(r.TEXTURE_CUBE_MAP,ue.texture,mt);for(var we=0;we<6;we++)Re(fe.__webglFramebuffer[we],ue,r.COLOR_ATTACHMENT0,r.TEXTURE_CUBE_MAP_POSITIVE_X+we);j(ue.texture,mt)&&$(r.TEXTURE_CUBE_MAP,ue.texture,ue.width,ue.height),h.bindTexture(r.TEXTURE_CUBE_MAP,null)}else h.bindTexture(r.TEXTURE_2D,je.__webglTexture),Ee(r.TEXTURE_2D,ue.texture,mt),Re(fe.__webglFramebuffer,ue,r.COLOR_ATTACHMENT0,r.TEXTURE_2D),j(ue.texture,mt)&&$(r.TEXTURE_2D,ue.texture,ue.width,ue.height),h.bindTexture(r.TEXTURE_2D,null);ue.depthBuffer&&ot(ue)}function pt(ue){var fe=ue.texture,je=B(ue);if(j(fe,je)){var Fe=ue.isWebGLRenderTargetCube?r.TEXTURE_CUBE_MAP:r.TEXTURE_2D,mt=u.get(fe).__webglTexture;h.bindTexture(Fe,mt),$(Fe,fe,ue.width,ue.height),h.bindTexture(Fe,null)}}function yt(ue){var fe=ue.id,je=T.render.frame;D[fe]!==je&&(D[fe]=je,ue.update())}this.setTexture2D=ye,this.setTextureCube=ge,this.setTextureCubeDynamic=be,this.setupRenderTarget=ct,this.updateRenderTargetMipmap=pt}function Qa(r,o){function h(u){var g;if(u===Rt)return r.REPEAT;if(u===xi)return r.CLAMP_TO_EDGE;if(u===Vn)return r.MIRRORED_REPEAT;if(u===Hi)return r.NEAREST;if(u===Nr)return r.NEAREST_MIPMAP_NEAREST;if(u===Ft)return r.NEAREST_MIPMAP_LINEAR;if(u===fn)return r.LINEAR;if(u===ts)return r.LINEAR_MIPMAP_NEAREST;if(u===wr)return r.LINEAR_MIPMAP_LINEAR;if(u===gn)return r.UNSIGNED_BYTE;if(u===Pr)return r.UNSIGNED_SHORT_4_4_4_4;if(u===is)return r.UNSIGNED_SHORT_5_5_5_1;if(u===Ia)return r.UNSIGNED_SHORT_5_6_5;if(u===Es)return r.BYTE;if(u===Yn)return r.SHORT;if(u===Le)return r.UNSIGNED_SHORT;if(u===Ne)return r.INT;if(u===et)return r.UNSIGNED_INT;if(u===Gt)return r.FLOAT;if(u===Wi&&(g=o.get("OES_texture_half_float"),g!==null))return g.HALF_FLOAT_OES;if(u===Ra)return r.ALPHA;if(u===Tr)return r.RGB;if(u===Dn)return r.RGBA;if(u===xs)return r.LUMINANCE;if(u===oe)return r.LUMINANCE_ALPHA;if(u===Ze)return r.DEPTH_COMPONENT;if(u===We)return r.DEPTH_STENCIL;if(u===ce)return r.FUNC_ADD;if(u===le)return r.FUNC_SUBTRACT;if(u===te)return r.FUNC_REVERSE_SUBTRACT;if(u===Be)return r.ZERO;if(u===qe)return r.ONE;if(u===Ue)return r.SRC_COLOR;if(u===Ge)return r.ONE_MINUS_SRC_COLOR;if(u===it)return r.SRC_ALPHA;if(u===lt)return r.ONE_MINUS_SRC_ALPHA;if(u===bt)return r.DST_ALPHA;if(u===Yt)return r.ONE_MINUS_DST_ALPHA;if(u===ni)return r.DST_COLOR;if(u===ri)return r.ONE_MINUS_DST_COLOR;if(u===He)return r.SRC_ALPHA_SATURATE;if((u===$t||u===Jt||u===an||u===Ki)&&(g=o.get("WEBGL_compressed_texture_s3tc"),g!==null)){if(u===$t)return g.COMPRESSED_RGB_S3TC_DXT1_EXT;if(u===Jt)return g.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(u===an)return g.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(u===Ki)return g.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((u===Rn||u===tr||u===Is||u===ur)&&(g=o.get("WEBGL_compressed_texture_pvrtc"),g!==null)){if(u===Rn)return g.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(u===tr)return g.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(u===Is)return g.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(u===ur)return g.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(u===Ma&&(g=o.get("WEBGL_compressed_texture_etc1"),g!==null))return g.COMPRESSED_RGB_ETC1_WEBGL;if((u===vo||u===fd||u===yo||u===So||u===ka||u===Da||u===gd||u===Zs||u===La||u===bo||u===Co||u===ll||u===_d||u===ir)&&(g=o.get("WEBGL_compressed_texture_astc"),g!==null))return u;if((u===ve||u===Pe)&&(g=o.get("EXT_blend_minmax"),g!==null)){if(u===ve)return g.MIN_EXT;if(u===Pe)return g.MAX_EXT}return u===Ar&&(g=o.get("WEBGL_depth_texture"),g!==null)?g.UNSIGNED_INT_24_8_WEBGL:0}return{convert:h}}function ga(){vt.call(this),this.type="Group"}ga.prototype=Object.assign(Object.create(vt.prototype),{constructor:ga,isGroup:!0});function nn(r,o,h,u){Ir.call(this),this.type="PerspectiveCamera",this.fov=r!==void 0?r:50,this.zoom=1,this.near=h!==void 0?h:.1,this.far=u!==void 0?u:2e3,this.focus=10,this.aspect=o!==void 0?o:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}nn.prototype=Object.assign(Object.create(Ir.prototype),{constructor:nn,isPerspectiveCamera:!0,copy:function(r,o){return Ir.prototype.copy.call(this,r,o),this.fov=r.fov,this.zoom=r.zoom,this.near=r.near,this.far=r.far,this.focus=r.focus,this.aspect=r.aspect,this.view=r.view===null?null:Object.assign({},r.view),this.filmGauge=r.filmGauge,this.filmOffset=r.filmOffset,this},setFocalLength:function(r){var o=.5*this.getFilmHeight()/r;this.fov=si.RAD2DEG*2*Math.atan(o),this.updateProjectionMatrix()},getFocalLength:function(){var r=Math.tan(si.DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/r},getEffectiveFOV:function(){return si.RAD2DEG*2*Math.atan(Math.tan(si.DEG2RAD*.5*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(r,o,h,u,g,y){this.aspect=r/o,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=o,this.view.offsetX=h,this.view.offsetY=u,this.view.width=g,this.view.height=y,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var r=this.near,o=r*Math.tan(si.DEG2RAD*.5*this.fov)/this.zoom,h=2*o,u=this.aspect*h,g=-.5*u,y=this.view;if(this.view!==null&&this.view.enabled){var T=y.fullWidth,I=y.fullHeight;g+=y.offsetX*u/T,o-=y.offsetY*h/I,u*=y.width/T,h*=y.height/I}var D=this.filmOffset;D!==0&&(g+=r*D/this.getFilmWidth()),this.projectionMatrix.makePerspective(g,g+u,o,o-h,r,this.far)},toJSON:function(r){var o=vt.prototype.toJSON.call(this,r);return o.object.fov=this.fov,o.object.zoom=this.zoom,o.object.near=this.near,o.object.far=this.far,o.object.focus=this.focus,o.object.aspect=this.aspect,this.view!==null&&(o.object.view=Object.assign({},this.view)),o.object.filmGauge=this.filmGauge,o.object.filmOffset=this.filmOffset,o}});function us(r){nn.call(this),this.cameras=r||[]}us.prototype=Object.assign(Object.create(nn.prototype),{constructor:us,isArrayCamera:!0});function Xl(r){var o=this,h=null,u=null,g=null,y=[],T=new Ot,I=new Ot;typeof window<"u"&&"VRFrameData"in window&&(u=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",Q,!1));var D=new Ot,N=new en,A=new he,B=new nn;B.bounds=new wi(0,0,.5,1),B.layers.enable(1);var F=new nn;F.bounds=new wi(.5,0,.5,1),F.layers.enable(2);var G=new us([B,F]);G.layers.enable(1),G.layers.enable(2);function j(){return h!==null&&h.isPresenting===!0}var $,Z;function Q(){if(j()){var ge=h.getEyeParameters("left"),be=ge.renderWidth,Ee=ge.renderHeight;Z=r.getPixelRatio(),$=r.getSize(),r.setDrawingBufferSize(be*2,Ee,1),ye.start()}else o.enabled&&(r.setDrawingBufferSize($.width,$.height,Z),ye.stop())}var ie=!1;function ne(ge){for(var be=navigator.getGamepads&&navigator.getGamepads(),Ee=0,Se=0,Re=be.length;Ee<Re;Ee++){var Ie=be[Ee];if(Ie&&(Ie.id==="Daydream Controller"||Ie.id==="Gear VR Controller"||Ie.id==="Oculus Go Controller"||Ie.id==="OpenVR Gamepad"||Ie.id.startsWith("Oculus Touch")||Ie.id.startsWith("Spatial Controller"))){if(Se===ge)return Ie;Se++}}}function ae(){for(var ge=0;ge<y.length;ge++){var be=y[ge],Ee=ne(ge);if(Ee!==void 0&&Ee.pose!==void 0){if(Ee.pose===null)return;var Se=Ee.pose;Se.hasPosition===!1&&be.position.set(.2,-.6,-.05),Se.position!==null&&be.position.fromArray(Se.position),Se.orientation!==null&&be.quaternion.fromArray(Se.orientation),be.matrix.compose(be.position,be.quaternion,be.scale),be.matrix.premultiply(T),be.matrix.decompose(be.position,be.quaternion,be.scale),be.matrixWorldNeedsUpdate=!0,be.visible=!0;var Re=Ee.id==="Daydream Controller"?0:1;ie!==Ee.buttons[Re].pressed&&(ie=Ee.buttons[Re].pressed,ie?be.dispatchEvent({type:"selectstart"}):(be.dispatchEvent({type:"selectend"}),be.dispatchEvent({type:"select"})))}else be.visible=!1}}this.enabled=!1,this.userHeight=1.6,this.getController=function(ge){var be=y[ge];return be===void 0&&(be=new ga,be.matrixAutoUpdate=!1,be.visible=!1,y[ge]=be),be},this.getDevice=function(){return h},this.setDevice=function(ge){ge!==void 0&&(h=ge),ye.setContext(ge)},this.setPoseTarget=function(ge){ge!==void 0&&(g=ge)},this.getCamera=function(ge){if(h===null)return ge.position.set(0,o.userHeight,0),ge;h.depthNear=ge.near,h.depthFar=ge.far,h.getFrameData(u);var be=h.stageParameters;be?T.fromArray(be.sittingToStandingTransform):T.makeTranslation(0,o.userHeight,0);var Ee=u.pose,Se=g!==null?g:ge;if(Se.matrix.copy(T),Se.matrix.decompose(Se.position,Se.quaternion,Se.scale),Ee.orientation!==null&&(N.fromArray(Ee.orientation),Se.quaternion.multiply(N)),Ee.position!==null&&(N.setFromRotationMatrix(T),A.fromArray(Ee.position),A.applyQuaternion(N),Se.position.add(A)),Se.updateMatrixWorld(),h.isPresenting===!1)return ge;B.near=ge.near,F.near=ge.near,B.far=ge.far,F.far=ge.far,G.matrixWorld.copy(ge.matrixWorld),G.matrixWorldInverse.copy(ge.matrixWorldInverse),B.matrixWorldInverse.fromArray(u.leftViewMatrix),F.matrixWorldInverse.fromArray(u.rightViewMatrix),I.getInverse(T),B.matrixWorldInverse.multiply(I),F.matrixWorldInverse.multiply(I);var Re=Se.parent;Re!==null&&(D.getInverse(Re.matrixWorld),B.matrixWorldInverse.multiply(D),F.matrixWorldInverse.multiply(D)),B.matrixWorld.getInverse(B.matrixWorldInverse),F.matrixWorld.getInverse(F.matrixWorldInverse),B.projectionMatrix.fromArray(u.leftProjectionMatrix),F.projectionMatrix.fromArray(u.rightProjectionMatrix),G.projectionMatrix.copy(B.projectionMatrix);var Ie=h.getLayers();if(Ie.length){var Ve=Ie[0];Ve.leftBounds!==null&&Ve.leftBounds.length===4&&B.bounds.fromArray(Ve.leftBounds),Ve.rightBounds!==null&&Ve.rightBounds.length===4&&F.bounds.fromArray(Ve.rightBounds)}return ae(),G},this.getStandingMatrix=function(){return T},this.isPresenting=j;var ye=new os;this.setAnimationLoop=function(ge){ye.setAnimationLoop(ge)},this.submitFrame=function(){j()&&h.submitFrame()},this.dispose=function(){typeof window<"u"&&window.removeEventListener("vrdisplaypresentchange",Q)}}function Xc(r){var o=r.context,h=null,u=null,g=null,y=null,T=[],I=[];function D(){return u!==null&&g!==null}var N=new nn;N.layers.enable(1),N.viewport=new wi;var A=new nn;A.layers.enable(2),A.viewport=new wi;var B=new us([N,A]);B.layers.enable(1),B.layers.enable(2),this.enabled=!1,this.getController=function(ie){var ne=T[ie];return ne===void 0&&(ne=new ga,ne.matrixAutoUpdate=!1,ne.visible=!1,T[ie]=ne),ne},this.getDevice=function(){return h},this.setDevice=function(ie){ie!==void 0&&(h=ie),o.setCompatibleXRDevice(ie)};function F(ie){var ne=T[I.indexOf(ie.inputSource)];ne&&ne.dispatchEvent({type:ie.type})}function G(){r.setFramebuffer(null),Q.stop()}this.setSession=function(ie,ne){u=ie,u!==null&&(u.addEventListener("select",F),u.addEventListener("selectstart",F),u.addEventListener("selectend",F),u.addEventListener("end",G),u.baseLayer=new XRWebGLLayer(u,o),u.requestFrameOfReference(ne.frameOfReferenceType).then(function(ae){g=ae,r.setFramebuffer(u.baseLayer.framebuffer),Q.setContext(u),Q.start()}),I=u.getInputSources(),u.addEventListener("inputsourceschange",function(){I=u.getInputSources(),console.log(I)}))};function j(ie,ne){ne===null?ie.matrixWorld.copy(ie.matrix):ie.matrixWorld.multiplyMatrices(ne.matrixWorld,ie.matrix),ie.matrixWorldInverse.getInverse(ie.matrixWorld)}this.getCamera=function(ie){if(D()){var ne=ie.parent,ae=B.cameras;j(B,ne);for(var ye=0;ye<ae.length;ye++)j(ae[ye],ne);ie.matrixWorld.copy(B.matrixWorld);for(var ge=ie.children,ye=0,be=ge.length;ye<be;ye++)ge[ye].updateMatrixWorld(!0);return B}return ie},this.isPresenting=D;var $=null;function Z(ie,ne){if(y=ne.getDevicePose(g),y!==null)for(var ae=u.baseLayer,ye=ne.views,ge=0;ge<ye.length;ge++){var be=ye[ge],Ee=ae.getViewport(be),Se=y.getViewMatrix(be),Re=B.cameras[ge];Re.matrix.fromArray(Se).getInverse(Re.matrix),Re.projectionMatrix.fromArray(be.projectionMatrix),Re.viewport.set(Ee.x,Ee.y,Ee.width,Ee.height),ge===0&&(B.matrix.copy(Re.matrix),B.projectionMatrix.copy(Re.projectionMatrix))}for(var ge=0;ge<T.length;ge++){var Ie=T[ge],Ve=I[ge];if(Ve){var ot=ne.getInputPose(Ve,g);if(ot!==null){Ie.matrix.elements=ot.pointerMatrix,Ie.matrix.decompose(Ie.position,Ie.rotation,Ie.scale),Ie.visible=!0;continue}}Ie.visible=!1}$&&$(ie)}var Q=new os;Q.setAnimationLoop(Z),this.setAnimationLoop=function(ie){$=ie},this.dispose=function(){},this.getStandingMatrix=function(){return console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed."),new THREE.Matrix4},this.submitFrame=function(){}}function Za(r){console.log("THREE.WebGLRenderer",t),r=r||{};var o=r.canvas!==void 0?r.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),h=r.context!==void 0?r.context:null,u=r.alpha!==void 0?r.alpha:!1,g=r.depth!==void 0?r.depth:!0,y=r.stencil!==void 0?r.stencil:!0,T=r.antialias!==void 0?r.antialias:!1,I=r.premultipliedAlpha!==void 0?r.premultipliedAlpha:!0,D=r.preserveDrawingBuffer!==void 0?r.preserveDrawingBuffer:!1,N=r.powerPreference!==void 0?r.powerPreference:"default",A=null,B=null;this.domElement=o,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=ee,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var F=this,G=!1,j=null,$=null,Z=null,Q=-1,ie="",ne=null,ae=null,ye=new wi,ge=new wi,be=null,Ee=0,Se=o.width,Re=o.height,Ie=1,Ve=new wi(0,0,Se,Re),ot=new wi(0,0,Se,Re),ct=!1,pt=new as,yt=new Wa,ue=!1,fe=!1,je=new Ot,Fe=new he;function mt(){return $===null?Ie:1}var we;try{var ut={alpha:u,depth:g,stencil:y,antialias:T,premultipliedAlpha:I,preserveDrawingBuffer:D,powerPreference:N};if(o.addEventListener("webglcontextlost",Ae,!1),o.addEventListener("webglcontextrestored",St,!1),we=h||o.getContext("webgl",ut)||o.getContext("experimental-webgl",ut),we===null)throw o.getContext("webgl")!==null?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");we.getShaderPrecisionFormat===void 0&&(we.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(re){console.error("THREE.WebGLRenderer: "+re.message)}var Qe,Nt,at,Dt,Qt,Yi,ft,_i,yn,zi,br,ji,Sn,Zn,Js,es,$s,Gi;function Cr(){Qe=new ah(we),Qe.get("WEBGL_depth_texture"),Qe.get("OES_texture_float"),Qe.get("OES_texture_float_linear"),Qe.get("OES_texture_half_float"),Qe.get("OES_texture_half_float_linear"),Qe.get("OES_standard_derivatives"),Qe.get("OES_element_index_uint"),Qe.get("ANGLE_instanced_arrays"),Gi=new Qa(we,Qe),Nt=new Pl(we,Qe,r),at=new Kc(we,Qe,Gi),at.scissor(ge.copy(ot).multiplyScalar(Ie)),at.viewport(ye.copy(Ve).multiplyScalar(Ie)),Dt=new oh(we),Qt=new Wc,Yi=new kh(we,Qe,at,Qt,Nt,Gi,Dt),ft=new ra(we),_i=new Al(we,ft,Dt),yn=new lh(_i,Dt),Zn=new Bl(we),zi=new Hc(F,Qe,Nt),br=new $a,ji=new Rh,Sn=new sh(F,at,yn,I),Js=new Ac(we,Qe,Dt),es=new Os(we,Qe,Dt),$s=new Mh(F,we,at,Yi,Nt),Dt.programs=zi.programs,F.context=we,F.capabilities=Nt,F.extensions=Qe,F.properties=Qt,F.renderLists=br,F.state=at,F.info=Dt}Cr();var Fn="xr"in navigator?new Xc(F):new Xl(F);this.vr=Fn;var dr=new Vs(F,yn,Nt.maxTextureSize);this.shadowMap=dr,this.getContext=function(){return we},this.getContextAttributes=function(){return we.getContextAttributes()},this.forceContextLoss=function(){var re=Qe.get("WEBGL_lose_context");re&&re.loseContext()},this.forceContextRestore=function(){var re=Qe.get("WEBGL_lose_context");re&&re.restoreContext()},this.getPixelRatio=function(){return Ie},this.setPixelRatio=function(re){re!==void 0&&(Ie=re,this.setSize(Se,Re,!1))},this.getSize=function(){return{width:Se,height:Re}},this.setSize=function(re,me,Te){if(Fn.isPresenting()){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Se=re,Re=me,o.width=re*Ie,o.height=me*Ie,Te!==!1&&(o.style.width=re+"px",o.style.height=me+"px"),this.setViewport(0,0,re,me)},this.getDrawingBufferSize=function(){return{width:Se*Ie,height:Re*Ie}},this.setDrawingBufferSize=function(re,me,Te){Se=re,Re=me,Ie=Te,o.width=re*Te,o.height=me*Te,this.setViewport(0,0,re,me)},this.getCurrentViewport=function(){return ye},this.setViewport=function(re,me,Te,nt){Ve.set(re,Re-me-nt,Te,nt),at.viewport(ye.copy(Ve).multiplyScalar(Ie))},this.setScissor=function(re,me,Te,nt){ot.set(re,Re-me-nt,Te,nt),at.scissor(ge.copy(ot).multiplyScalar(Ie))},this.setScissorTest=function(re){at.setScissorTest(ct=re)},this.getClearColor=function(){return Sn.getClearColor()},this.setClearColor=function(){Sn.setClearColor.apply(Sn,arguments)},this.getClearAlpha=function(){return Sn.getClearAlpha()},this.setClearAlpha=function(){Sn.setClearAlpha.apply(Sn,arguments)},this.clear=function(re,me,Te){var nt=0;(re===void 0||re)&&(nt|=we.COLOR_BUFFER_BIT),(me===void 0||me)&&(nt|=we.DEPTH_BUFFER_BIT),(Te===void 0||Te)&&(nt|=we.STENCIL_BUFFER_BIT),we.clear(nt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(re,me,Te,nt){this.setRenderTarget(re),this.clear(me,Te,nt)},this.dispose=function(){o.removeEventListener("webglcontextlost",Ae,!1),o.removeEventListener("webglcontextrestored",St,!1),br.dispose(),ji.dispose(),Qt.dispose(),yn.dispose(),Fn.dispose(),ci.stop()};function Ae(re){re.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),G=!0}function St(){console.log("THREE.WebGLRenderer: Context Restored."),G=!1,Cr()}function Et(re){var me=re.target;me.removeEventListener("dispose",Et),ii(me)}function ii(re){It(re),Qt.remove(re)}function It(re){var me=Qt.get(re).program;re.program=void 0,me!==void 0&&zi.releaseProgram(me)}function oi(re,me,Te){re.render(function(nt){F.renderBufferImmediate(nt,me,Te)})}this.renderBufferImmediate=function(re,me,Te){at.initAttributes();var nt=Qt.get(re);re.hasPositions&&!nt.position&&(nt.position=we.createBuffer()),re.hasNormals&&!nt.normal&&(nt.normal=we.createBuffer()),re.hasUvs&&!nt.uv&&(nt.uv=we.createBuffer()),re.hasColors&&!nt.color&&(nt.color=we.createBuffer());var gt=me.getAttributes();if(re.hasPositions&&(we.bindBuffer(we.ARRAY_BUFFER,nt.position),we.bufferData(we.ARRAY_BUFFER,re.positionArray,we.DYNAMIC_DRAW),at.enableAttribute(gt.position),we.vertexAttribPointer(gt.position,3,we.FLOAT,!1,0,0)),re.hasNormals){if(we.bindBuffer(we.ARRAY_BUFFER,nt.normal),!Te.isMeshPhongMaterial&&!Te.isMeshStandardMaterial&&!Te.isMeshNormalMaterial&&Te.flatShading===!0)for(var Wt=0,hi=re.count*3;Wt<hi;Wt+=9){var kt=re.normalArray,li=(kt[Wt+0]+kt[Wt+3]+kt[Wt+6])/3,Fi=(kt[Wt+1]+kt[Wt+4]+kt[Wt+7])/3,mi=(kt[Wt+2]+kt[Wt+5]+kt[Wt+8])/3;kt[Wt+0]=li,kt[Wt+1]=Fi,kt[Wt+2]=mi,kt[Wt+3]=li,kt[Wt+4]=Fi,kt[Wt+5]=mi,kt[Wt+6]=li,kt[Wt+7]=Fi,kt[Wt+8]=mi}we.bufferData(we.ARRAY_BUFFER,re.normalArray,we.DYNAMIC_DRAW),at.enableAttribute(gt.normal),we.vertexAttribPointer(gt.normal,3,we.FLOAT,!1,0,0)}re.hasUvs&&Te.map&&(we.bindBuffer(we.ARRAY_BUFFER,nt.uv),we.bufferData(we.ARRAY_BUFFER,re.uvArray,we.DYNAMIC_DRAW),at.enableAttribute(gt.uv),we.vertexAttribPointer(gt.uv,2,we.FLOAT,!1,0,0)),re.hasColors&&Te.vertexColors!==L&&(we.bindBuffer(we.ARRAY_BUFFER,nt.color),we.bufferData(we.ARRAY_BUFFER,re.colorArray,we.DYNAMIC_DRAW),at.enableAttribute(gt.color),we.vertexAttribPointer(gt.color,3,we.FLOAT,!1,0,0)),at.disableUnusedAttributes(),we.drawArrays(we.TRIANGLES,0,re.count),re.count=0},this.renderBufferDirect=function(re,me,Te,nt,gt,Wt){var hi=gt.isMesh&&gt.matrixWorld.determinant()<0;at.setMaterial(nt,hi);var kt=hd(re,me,nt,gt),li=Te.id+"_"+kt.id+"_"+(nt.wireframe===!0),Fi=!1;li!==ie&&(ie=li,Fi=!0),gt.morphTargetInfluences&&(Zn.update(gt,Te,nt,kt),Fi=!0);var mi=Te.index,Ei=Te.attributes.position,Zt=1;nt.wireframe===!0&&(mi=_i.getWireframeAttribute(Te),Zt=2);var qi,fi=Js;mi!==null&&(qi=ft.get(mi),fi=es,fi.setIndex(qi)),Fi&&(Mi(nt,kt,Te),mi!==null&&we.bindBuffer(we.ELEMENT_ARRAY_BUFFER,qi.buffer));var In=1/0;mi!==null?In=mi.count:Ei!==void 0&&(In=Ei.count);var Xn=Te.drawRange.start*Zt,Qs=Te.drawRange.count*Zt,hr=Wt!==null?Wt.start*Zt:0,ku=Wt!==null?Wt.count*Zt:1/0,Du=Math.max(Xn,hr),gm=Math.min(In,Xn+Qs,hr+ku)-1,Lu=Math.max(0,gm-Du+1);if(Lu!==0){if(gt.isMesh)if(nt.wireframe===!0)at.setLineWidth(nt.wireframeLinewidth*mt()),fi.setMode(we.LINES);else switch(gt.drawMode){case un:fi.setMode(we.TRIANGLES);break;case hl:fi.setMode(we.TRIANGLE_STRIP);break;case To:fi.setMode(we.TRIANGLE_FAN);break}else if(gt.isLine){var Nu=nt.linewidth;Nu===void 0&&(Nu=1),at.setLineWidth(Nu*mt()),gt.isLineSegments?fi.setMode(we.LINES):gt.isLineLoop?fi.setMode(we.LINE_LOOP):fi.setMode(we.LINE_STRIP)}else gt.isPoints&&fi.setMode(we.POINTS);Te&&Te.isInstancedBufferGeometry?Te.maxInstancedCount>0&&fi.renderInstances(Te,Du,Lu):fi.render(Du,Lu)}};function Mi(re,me,Te){if(Te&&Te.isInstancedBufferGeometry&&Qe.get("ANGLE_instanced_arrays")===null){console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}at.initAttributes();var nt=Te.attributes,gt=me.getAttributes(),Wt=re.defaultAttributeValues;for(var hi in gt){var kt=gt[hi];if(kt>=0){var li=nt[hi];if(li!==void 0){var Fi=li.normalized,mi=li.itemSize,Ei=ft.get(li);if(Ei===void 0)continue;var Zt=Ei.buffer,qi=Ei.type,fi=Ei.bytesPerElement;if(li.isInterleavedBufferAttribute){var In=li.data,Xn=In.stride,Qs=li.offset;In&&In.isInstancedInterleavedBuffer?(at.enableAttributeAndDivisor(kt,In.meshPerAttribute),Te.maxInstancedCount===void 0&&(Te.maxInstancedCount=In.meshPerAttribute*In.count)):at.enableAttribute(kt),we.bindBuffer(we.ARRAY_BUFFER,Zt),we.vertexAttribPointer(kt,mi,qi,Fi,Xn*fi,Qs*fi)}else li.isInstancedBufferAttribute?(at.enableAttributeAndDivisor(kt,li.meshPerAttribute),Te.maxInstancedCount===void 0&&(Te.maxInstancedCount=li.meshPerAttribute*li.count)):at.enableAttribute(kt),we.bindBuffer(we.ARRAY_BUFFER,Zt),we.vertexAttribPointer(kt,mi,qi,Fi,0,0)}else if(Wt!==void 0){var hr=Wt[hi];if(hr!==void 0)switch(hr.length){case 2:we.vertexAttrib2fv(kt,hr);break;case 3:we.vertexAttrib3fv(kt,hr);break;case 4:we.vertexAttrib4fv(kt,hr);break;default:we.vertexAttrib1fv(kt,hr)}}}}at.disableUnusedAttributes()}this.compile=function(re,me){B=ji.get(re,me),B.init(),re.traverse(function(Te){Te.isLight&&(B.pushLight(Te),Te.castShadow&&B.pushShadow(Te))}),B.setupLights(me),re.traverse(function(Te){if(Te.material)if(Array.isArray(Te.material))for(var nt=0;nt<Te.material.length;nt++)ol(Te.material[nt],re.fog,Te);else ol(Te.material,re.fog,Te)})};var pi=null;function bn(re){Fn.isPresenting()||pi&&pi(re)}var ci=new os;ci.setAnimationLoop(bn),typeof window<"u"&&ci.setContext(window),this.setAnimationLoop=function(re){pi=re,Fn.setAnimationLoop(re),ci.start()},this.render=function(re,me,Te,nt){if(!(me&&me.isCamera)){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(!G){ie="",Q=-1,ne=null,re.autoUpdate===!0&&re.updateMatrixWorld(),me.parent===null&&me.updateMatrixWorld(),Fn.enabled&&(me=Fn.getCamera(me)),B=ji.get(re,me),B.init(),re.onBeforeRender(F,re,me,Te),je.multiplyMatrices(me.projectionMatrix,me.matrixWorldInverse),pt.setFromMatrix(je),fe=this.localClippingEnabled,ue=yt.init(this.clippingPlanes,fe,me),A=br.get(re,me),A.init(),Cn(re,me,F.sortObjects),F.sortObjects===!0&&A.sort(),ue&&yt.beginShadows();var gt=B.state.shadowsArray;dr.render(gt,re,me),B.setupLights(me),ue&&yt.endShadows(),this.info.autoReset&&this.info.reset(),Te===void 0&&(Te=null),this.setRenderTarget(Te),Sn.render(A,re,me,nt);var Wt=A.opaque,hi=A.transparent;if(re.overrideMaterial){var kt=re.overrideMaterial;Wt.length&&kn(Wt,re,me,kt),hi.length&&kn(hi,re,me,kt)}else Wt.length&&kn(Wt,re,me),hi.length&&kn(hi,re,me);var li=B.state.spritesArray;$s.render(li,re,me),Te&&Yi.updateRenderTargetMipmap(Te),at.buffers.depth.setTest(!0),at.buffers.depth.setMask(!0),at.buffers.color.setMask(!0),at.setPolygonOffset(!1),re.onAfterRender(F,re,me),Fn.enabled&&Fn.submitFrame(),A=null,B=null}};function Cn(re,me,Te){if(re.visible!==!1){var nt=re.layers.test(me.layers);if(nt){if(re.isLight)B.pushLight(re),re.castShadow&&B.pushShadow(re);else if(re.isSprite)(!re.frustumCulled||pt.intersectsSprite(re))&&B.pushSprite(re);else if(re.isImmediateRenderObject)Te&&Fe.setFromMatrixPosition(re.matrixWorld).applyMatrix4(je),A.push(re,null,re.material,Fe.z,null);else if((re.isMesh||re.isLine||re.isPoints)&&(re.isSkinnedMesh&&re.skeleton.update(),!re.frustumCulled||pt.intersectsObject(re))){Te&&Fe.setFromMatrixPosition(re.matrixWorld).applyMatrix4(je);var gt=yn.update(re),Wt=re.material;if(Array.isArray(Wt))for(var hi=gt.groups,kt=0,li=hi.length;kt<li;kt++){var Fi=hi[kt],mi=Wt[Fi.materialIndex];mi&&mi.visible&&A.push(re,gt,mi,Fe.z,Fi)}else Wt.visible&&A.push(re,gt,Wt,Fe.z,null)}}for(var Ei=re.children,kt=0,li=Ei.length;kt<li;kt++)Cn(Ei[kt],me,Te)}}function kn(re,me,Te,nt){for(var gt=0,Wt=re.length;gt<Wt;gt++){var hi=re[gt],kt=hi.object,li=hi.geometry,Fi=nt===void 0?hi.material:nt,mi=hi.group;if(Te.isArrayCamera){ae=Te;for(var Ei=Te.cameras,Zt=0,qi=Ei.length;Zt<qi;Zt++){var fi=Ei[Zt];if(kt.layers.test(fi.layers)){if("viewport"in fi)at.viewport(ye.copy(fi.viewport));else{var In=fi.bounds,Xn=In.x*Se,Qs=In.y*Re,hr=In.z*Se,ku=In.w*Re;at.viewport(ye.set(Xn,Qs,hr,ku).multiplyScalar(Ie))}al(kt,me,fi,li,Fi,mi)}}}else ae=null,al(kt,me,Te,li,Fi,mi)}}function al(re,me,Te,nt,gt,Wt){if(re.onBeforeRender(F,me,Te,nt,gt,Wt),B=ji.get(me,ae||Te),re.modelViewMatrix.multiplyMatrices(Te.matrixWorldInverse,re.matrixWorld),re.normalMatrix.getNormalMatrix(re.modelViewMatrix),re.isImmediateRenderObject){var hi=re.isMesh&&re.matrixWorld.determinant()<0;at.setMaterial(gt,hi);var kt=hd(Te,me.fog,gt,re);ie="",oi(re,kt,gt)}else F.renderBufferDirect(Te,me.fog,nt,gt,re,Wt);re.onAfterRender(F,me,Te,nt,gt,Wt),B=ji.get(me,ae||Te)}function ol(re,me,Te){var nt=Qt.get(re),gt=B.state.lights,Wt=B.state.shadowsArray,hi=zi.getParameters(re,gt.state,Wt,me,yt.numPlanes,yt.numIntersection,Te),kt=zi.getProgramCode(re,hi),li=nt.program,Fi=!0;if(li===void 0)re.addEventListener("dispose",Et);else if(li.code!==kt)It(re);else if(nt.lightsHash!==gt.state.hash)Qt.update(re,"lightsHash",gt.state.hash),Fi=!1;else{if(hi.shaderID!==void 0)return;Fi=!1}if(Fi){if(hi.shaderID){var mi=Ps[hi.shaderID];nt.shader={name:re.type,uniforms:Tn.clone(mi.uniforms),vertexShader:mi.vertexShader,fragmentShader:mi.fragmentShader}}else nt.shader={name:re.type,uniforms:re.uniforms,vertexShader:re.vertexShader,fragmentShader:re.fragmentShader};re.onBeforeCompile(nt.shader,F),li=zi.acquireProgram(re,nt.shader,hi,kt),nt.program=li,re.program=li}var Ei=li.getAttributes();if(re.morphTargets){re.numSupportedMorphTargets=0;for(var Zt=0;Zt<F.maxMorphTargets;Zt++)Ei["morphTarget"+Zt]>=0&&re.numSupportedMorphTargets++}if(re.morphNormals){re.numSupportedMorphNormals=0;for(var Zt=0;Zt<F.maxMorphNormals;Zt++)Ei["morphNormal"+Zt]>=0&&re.numSupportedMorphNormals++}var qi=nt.shader.uniforms;(!re.isShaderMaterial&&!re.isRawShaderMaterial||re.clipping===!0)&&(nt.numClippingPlanes=yt.numPlanes,nt.numIntersection=yt.numIntersection,qi.clippingPlanes=yt.uniform),nt.fog=me,nt.lightsHash=gt.state.hash,re.lights&&(qi.ambientLightColor.value=gt.state.ambient,qi.directionalLights.value=gt.state.directional,qi.spotLights.value=gt.state.spot,qi.rectAreaLights.value=gt.state.rectArea,qi.pointLights.value=gt.state.point,qi.hemisphereLights.value=gt.state.hemi,qi.directionalShadowMap.value=gt.state.directionalShadowMap,qi.directionalShadowMatrix.value=gt.state.directionalShadowMatrix,qi.spotShadowMap.value=gt.state.spotShadowMap,qi.spotShadowMatrix.value=gt.state.spotShadowMatrix,qi.pointShadowMap.value=gt.state.pointShadowMap,qi.pointShadowMatrix.value=gt.state.pointShadowMatrix);var fi=nt.program.getUniforms(),In=Pn.seqWithValue(fi.seq,qi);nt.uniformsList=In}function hd(re,me,Te,nt){Ee=0;var gt=Qt.get(Te),Wt=B.state.lights;if(ue&&(fe||re!==ne)){var hi=re===ne&&Te.id===Q;yt.setState(Te.clippingPlanes,Te.clipIntersection,Te.clipShadows,re,gt,hi)}Te.needsUpdate===!1&&(gt.program===void 0||Te.fog&&gt.fog!==me||Te.lights&&gt.lightsHash!==Wt.state.hash||gt.numClippingPlanes!==void 0&&(gt.numClippingPlanes!==yt.numPlanes||gt.numIntersection!==yt.numIntersection))&&(Te.needsUpdate=!0),Te.needsUpdate&&(ol(Te,me,nt),Te.needsUpdate=!1);var kt=!1,li=!1,Fi=!1,mi=gt.program,Ei=mi.getUniforms(),Zt=gt.shader.uniforms;if(at.useProgram(mi.program)&&(kt=!0,li=!0,Fi=!0),Te.id!==Q&&(Q=Te.id,li=!0),kt||re!==ne){if(Ei.setValue(we,"projectionMatrix",re.projectionMatrix),Nt.logarithmicDepthBuffer&&Ei.setValue(we,"logDepthBufFC",2/(Math.log(re.far+1)/Math.LN2)),ne!==(ae||re)&&(ne=ae||re,li=!0,Fi=!0),Te.isShaderMaterial||Te.isMeshPhongMaterial||Te.isMeshStandardMaterial||Te.envMap){var qi=Ei.map.cameraPosition;qi!==void 0&&qi.setValue(we,Fe.setFromMatrixPosition(re.matrixWorld))}(Te.isMeshPhongMaterial||Te.isMeshLambertMaterial||Te.isMeshBasicMaterial||Te.isMeshStandardMaterial||Te.isShaderMaterial||Te.skinning)&&Ei.setValue(we,"viewMatrix",re.matrixWorldInverse)}if(Te.skinning){Ei.setOptional(we,nt,"bindMatrix"),Ei.setOptional(we,nt,"bindMatrixInverse");var fi=nt.skeleton;if(fi){var In=fi.bones;if(Nt.floatVertexTextures){if(fi.boneTexture===void 0){var Xn=Math.sqrt(In.length*4);Xn=si.ceilPowerOfTwo(Xn),Xn=Math.max(Xn,4);var Qs=new Float32Array(Xn*Xn*4);Qs.set(fi.boneMatrices);var hr=new ss(Qs,Xn,Xn,Dn,Gt);hr.needsUpdate=!0,fi.boneMatrices=Qs,fi.boneTexture=hr,fi.boneTextureSize=Xn}Ei.setValue(we,"boneTexture",fi.boneTexture),Ei.setValue(we,"boneTextureSize",fi.boneTextureSize)}else Ei.setOptional(we,fi,"boneMatrices")}}return li&&(Ei.setValue(we,"toneMappingExposure",F.toneMappingExposure),Ei.setValue(we,"toneMappingWhitePoint",F.toneMappingWhitePoint),Te.lights&&mm(Zt,Fi),me&&Te.fog&&Zh(Zt,me),Te.isMeshBasicMaterial?Ts(Zt,Te):Te.isMeshLambertMaterial?(Ts(Zt,Te),ec(Zt,Te)):Te.isMeshPhongMaterial?(Ts(Zt,Te),Te.isMeshToonMaterial?dm(Zt,Te):_o(Zt,Te)):Te.isMeshStandardMaterial?(Ts(Zt,Te),Te.isMeshPhysicalMaterial?hm(Zt,Te):sp(Zt,Te)):Te.isMeshDepthMaterial?(Ts(Zt,Te),cm(Zt,Te)):Te.isMeshDistanceMaterial?(Ts(Zt,Te),um(Zt,Te)):Te.isMeshNormalMaterial?(Ts(Zt,Te),pm(Zt,Te)):Te.isLineBasicMaterial?(Qh(Zt,Te),Te.isLineDashedMaterial&&Ru(Zt,Te)):Te.isPointsMaterial?Mu(Zt,Te):Te.isShadowMaterial&&(Zt.color.value=Te.color,Zt.opacity.value=Te.opacity),Zt.ltc_1!==void 0&&(Zt.ltc_1.value=Pt.LTC_1),Zt.ltc_2!==void 0&&(Zt.ltc_2.value=Pt.LTC_2),Pn.upload(we,gt.uniformsList,Zt,F)),Te.isShaderMaterial&&Te.uniformsNeedUpdate===!0&&(Pn.upload(we,gt.uniformsList,Zt,F),Te.uniformsNeedUpdate=!1),Ei.setValue(we,"modelViewMatrix",nt.modelViewMatrix),Ei.setValue(we,"normalMatrix",nt.normalMatrix),Ei.setValue(we,"modelMatrix",nt.matrixWorld),mi}function Ts(re,me){re.opacity.value=me.opacity,me.color&&(re.diffuse.value=me.color),me.emissive&&re.emissive.value.copy(me.emissive).multiplyScalar(me.emissiveIntensity),me.map&&(re.map.value=me.map),me.alphaMap&&(re.alphaMap.value=me.alphaMap),me.specularMap&&(re.specularMap.value=me.specularMap),me.envMap&&(re.envMap.value=me.envMap,re.flipEnvMap.value=me.envMap&&me.envMap.isCubeTexture?-1:1,re.reflectivity.value=me.reflectivity,re.refractionRatio.value=me.refractionRatio,re.maxMipLevel.value=Qt.get(me.envMap).__maxMipLevel),me.lightMap&&(re.lightMap.value=me.lightMap,re.lightMapIntensity.value=me.lightMapIntensity),me.aoMap&&(re.aoMap.value=me.aoMap,re.aoMapIntensity.value=me.aoMapIntensity);var Te;me.map?Te=me.map:me.specularMap?Te=me.specularMap:me.displacementMap?Te=me.displacementMap:me.normalMap?Te=me.normalMap:me.bumpMap?Te=me.bumpMap:me.roughnessMap?Te=me.roughnessMap:me.metalnessMap?Te=me.metalnessMap:me.alphaMap?Te=me.alphaMap:me.emissiveMap&&(Te=me.emissiveMap),Te!==void 0&&(Te.isWebGLRenderTarget&&(Te=Te.texture),Te.matrixAutoUpdate===!0&&Te.updateMatrix(),re.uvTransform.value.copy(Te.matrix))}function Qh(re,me){re.diffuse.value=me.color,re.opacity.value=me.opacity}function Ru(re,me){re.dashSize.value=me.dashSize,re.totalSize.value=me.dashSize+me.gapSize,re.scale.value=me.scale}function Mu(re,me){re.diffuse.value=me.color,re.opacity.value=me.opacity,re.size.value=me.size*Ie,re.scale.value=Re*.5,re.map.value=me.map,me.map!==null&&(me.map.matrixAutoUpdate===!0&&me.map.updateMatrix(),re.uvTransform.value.copy(me.map.matrix))}function Zh(re,me){re.fogColor.value=me.color,me.isFog?(re.fogNear.value=me.near,re.fogFar.value=me.far):me.isFogExp2&&(re.fogDensity.value=me.density)}function ec(re,me){me.emissiveMap&&(re.emissiveMap.value=me.emissiveMap)}function _o(re,me){re.specular.value=me.specular,re.shininess.value=Math.max(me.shininess,1e-4),me.emissiveMap&&(re.emissiveMap.value=me.emissiveMap),me.bumpMap&&(re.bumpMap.value=me.bumpMap,re.bumpScale.value=me.bumpScale,me.side===E&&(re.bumpScale.value*=-1)),me.normalMap&&(re.normalMap.value=me.normalMap,re.normalScale.value.copy(me.normalScale),me.side===E&&re.normalScale.value.negate()),me.displacementMap&&(re.displacementMap.value=me.displacementMap,re.displacementScale.value=me.displacementScale,re.displacementBias.value=me.displacementBias)}function dm(re,me){_o(re,me),me.gradientMap&&(re.gradientMap.value=me.gradientMap)}function sp(re,me){re.roughness.value=me.roughness,re.metalness.value=me.metalness,me.roughnessMap&&(re.roughnessMap.value=me.roughnessMap),me.metalnessMap&&(re.metalnessMap.value=me.metalnessMap),me.emissiveMap&&(re.emissiveMap.value=me.emissiveMap),me.bumpMap&&(re.bumpMap.value=me.bumpMap,re.bumpScale.value=me.bumpScale,me.side===E&&(re.bumpScale.value*=-1)),me.normalMap&&(re.normalMap.value=me.normalMap,re.normalScale.value.copy(me.normalScale),me.side===E&&re.normalScale.value.negate()),me.displacementMap&&(re.displacementMap.value=me.displacementMap,re.displacementScale.value=me.displacementScale,re.displacementBias.value=me.displacementBias),me.envMap&&(re.envMapIntensity.value=me.envMapIntensity)}function hm(re,me){sp(re,me),re.reflectivity.value=me.reflectivity,re.clearCoat.value=me.clearCoat,re.clearCoatRoughness.value=me.clearCoatRoughness}function cm(re,me){me.displacementMap&&(re.displacementMap.value=me.displacementMap,re.displacementScale.value=me.displacementScale,re.displacementBias.value=me.displacementBias)}function um(re,me){me.displacementMap&&(re.displacementMap.value=me.displacementMap,re.displacementScale.value=me.displacementScale,re.displacementBias.value=me.displacementBias),re.referencePosition.value.copy(me.referencePosition),re.nearDistance.value=me.nearDistance,re.farDistance.value=me.farDistance}function pm(re,me){me.bumpMap&&(re.bumpMap.value=me.bumpMap,re.bumpScale.value=me.bumpScale,me.side===E&&(re.bumpScale.value*=-1)),me.normalMap&&(re.normalMap.value=me.normalMap,re.normalScale.value.copy(me.normalScale),me.side===E&&re.normalScale.value.negate()),me.displacementMap&&(re.displacementMap.value=me.displacementMap,re.displacementScale.value=me.displacementScale,re.displacementBias.value=me.displacementBias)}function mm(re,me){re.ambientLightColor.needsUpdate=me,re.directionalLights.needsUpdate=me,re.pointLights.needsUpdate=me,re.spotLights.needsUpdate=me,re.rectAreaLights.needsUpdate=me,re.hemisphereLights.needsUpdate=me}function fm(){var re=Ee;return re>=Nt.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+re+" texture units while this GPU supports only "+Nt.maxTextures),Ee+=1,re}this.allocTextureUnit=fm,this.setTexture2D=function(){var re=!1;return function(Te,nt){Te&&Te.isWebGLRenderTarget&&(re||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),re=!0),Te=Te.texture),Yi.setTexture2D(Te,nt)}}(),this.setTexture=function(){var re=!1;return function(Te,nt){re||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),re=!0),Yi.setTexture2D(Te,nt)}}(),this.setTextureCube=function(){var re=!1;return function(Te,nt){Te&&Te.isWebGLRenderTargetCube&&(re||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),re=!0),Te=Te.texture),Te&&Te.isCubeTexture||Array.isArray(Te.image)&&Te.image.length===6?Yi.setTextureCube(Te,nt):Yi.setTextureCubeDynamic(Te,nt)}}(),this.setFramebuffer=function(re){j=re},this.getRenderTarget=function(){return $},this.setRenderTarget=function(re){$=re,re&&Qt.get(re).__webglFramebuffer===void 0&&Yi.setupRenderTarget(re);var me=j,Te=!1;if(re){var nt=Qt.get(re).__webglFramebuffer;re.isWebGLRenderTargetCube?(me=nt[re.activeCubeFace],Te=!0):me=nt,ye.copy(re.viewport),ge.copy(re.scissor),be=re.scissorTest}else ye.copy(Ve).multiplyScalar(Ie),ge.copy(ot).multiplyScalar(Ie),be=ct;if(Z!==me&&(we.bindFramebuffer(we.FRAMEBUFFER,me),Z=me),at.viewport(ye),at.scissor(ge),at.setScissorTest(be),Te){var gt=Qt.get(re.texture);we.framebufferTexture2D(we.FRAMEBUFFER,we.COLOR_ATTACHMENT0,we.TEXTURE_CUBE_MAP_POSITIVE_X+re.activeCubeFace,gt.__webglTexture,re.activeMipMapLevel)}},this.readRenderTargetPixels=function(re,me,Te,nt,gt,Wt){if(!(re&&re.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}var hi=Qt.get(re).__webglFramebuffer;if(hi){var kt=!1;hi!==Z&&(we.bindFramebuffer(we.FRAMEBUFFER,hi),kt=!0);try{var li=re.texture,Fi=li.format,mi=li.type;if(Fi!==Dn&&Gi.convert(Fi)!==we.getParameter(we.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(mi!==gn&&Gi.convert(mi)!==we.getParameter(we.IMPLEMENTATION_COLOR_READ_TYPE)&&!(mi===Gt&&(Qe.get("OES_texture_float")||Qe.get("WEBGL_color_buffer_float")))&&!(mi===Wi&&Qe.get("EXT_color_buffer_half_float"))){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}we.checkFramebufferStatus(we.FRAMEBUFFER)===we.FRAMEBUFFER_COMPLETE?me>=0&&me<=re.width-nt&&Te>=0&&Te<=re.height-gt&&we.readPixels(me,Te,nt,gt,Gi.convert(Fi),Gi.convert(mi),Wt):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{kt&&we.bindFramebuffer(we.FRAMEBUFFER,Z)}}},this.copyFramebufferToTexture=function(re,me,Te){var nt=me.image.width,gt=me.image.height,Wt=Gi.convert(me.format);this.setTexture2D(me,0),we.copyTexImage2D(we.TEXTURE_2D,Te||0,Wt,re.x,re.y,nt,gt,0)},this.copyTextureToTexture=function(re,me,Te,nt){var gt=me.image.width,Wt=me.image.height,hi=Gi.convert(Te.format),kt=Gi.convert(Te.type);this.setTexture2D(Te,0),me.isDataTexture?we.texSubImage2D(we.TEXTURE_2D,nt||0,re.x,re.y,gt,Wt,hi,kt,me.image.data):we.texSubImage2D(we.TEXTURE_2D,nt||0,re.x,re.y,hi,kt,me.image)}}function Us(r,o){this.name="",this.color=new Mt(r),this.density=o!==void 0?o:25e-5}Us.prototype.isFogExp2=!0,Us.prototype.clone=function(){return new Us(this.color,this.density)},Us.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}};function _a(r,o,h){this.name="",this.color=new Mt(r),this.near=o!==void 0?o:1,this.far=h!==void 0?h:1e3}_a.prototype.isFog=!0,_a.prototype.clone=function(){return new _a(this.color,this.near,this.far)},_a.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}};function eo(){vt.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}eo.prototype=Object.assign(Object.create(vt.prototype),{constructor:eo,copy:function(r,o){return vt.prototype.copy.call(this,r,o),r.background!==null&&(this.background=r.background.clone()),r.fog!==null&&(this.fog=r.fog.clone()),r.overrideMaterial!==null&&(this.overrideMaterial=r.overrideMaterial.clone()),this.autoUpdate=r.autoUpdate,this.matrixAutoUpdate=r.matrixAutoUpdate,this},toJSON:function(r){var o=vt.prototype.toJSON.call(this,r);return this.background!==null&&(o.object.background=this.background.toJSON(r)),this.fog!==null&&(o.object.fog=this.fog.toJSON()),o}});function Wr(r){Xt.call(this),this.type="SpriteMaterial",this.color=new Mt(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(r)}Wr.prototype=Object.create(Xt.prototype),Wr.prototype.constructor=Wr,Wr.prototype.isSpriteMaterial=!0,Wr.prototype.copy=function(r){return Xt.prototype.copy.call(this,r),this.color.copy(r.color),this.map=r.map,this.rotation=r.rotation,this};function to(r){vt.call(this),this.type="Sprite",this.material=r!==void 0?r:new Wr,this.center=new rt(.5,.5)}to.prototype=Object.assign(Object.create(vt.prototype),{constructor:to,isSprite:!0,raycast:function(){var r=new he,o=new he,h=new he,u=new rt,g=new rt,y=new Ot,T=new he,I=new he,D=new he;function N(A,B,F,G,j,$){u.subVectors(A,F).addScalar(.5).multiply(G),j!==void 0?(g.x=$*u.x-j*u.y,g.y=j*u.x+$*u.y):g.copy(u),A.copy(B),A.x+=g.x,A.y+=g.y,A.applyMatrix4(y)}return function(B,F){o.setFromMatrixScale(this.matrixWorld),y.getInverse(this.modelViewMatrix).premultiply(this.matrixWorld),h.setFromMatrixPosition(this.modelViewMatrix);var G=this.material.rotation,j,$;G!==0&&($=Math.cos(G),j=Math.sin(G));var Z=this.center;N(T.set(-.5,-.5,0),h,Z,o,j,$),N(I.set(.5,-.5,0),h,Z,o,j,$),N(D.set(.5,.5,0),h,Z,o,j,$);var Q=B.ray.intersectTriangle(T,I,D,!1,r);if(!(Q===null&&(N(I.set(-.5,.5,0),h,Z,o,j,$),Q=B.ray.intersectTriangle(T,D,I,!1,r),Q===null))){var ie=B.ray.origin.distanceTo(r);ie<B.near||ie>B.far||F.push({distance:ie,point:r.clone(),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(r){return vt.prototype.copy.call(this,r),r.center!==void 0&&this.center.copy(r.center),this}});function ps(){vt.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}ps.prototype=Object.assign(Object.create(vt.prototype),{constructor:ps,copy:function(r){vt.prototype.copy.call(this,r,!1);for(var o=r.levels,h=0,u=o.length;h<u;h++){var g=o[h];this.addLevel(g.object.clone(),g.distance)}return this},addLevel:function(r,o){o===void 0&&(o=0),o=Math.abs(o);for(var h=this.levels,u=0;u<h.length&&!(o<h[u].distance);u++);h.splice(u,0,{distance:o,object:r}),this.add(r)},getObjectForDistance:function(r){for(var o=this.levels,h=1,u=o.length;h<u&&!(r<o[h].distance);h++);return o[h-1].object},raycast:function(){var r=new he;return function(h,u){r.setFromMatrixPosition(this.matrixWorld);var g=h.ray.origin.distanceTo(r);this.getObjectForDistance(g).raycast(h,u)}}(),update:function(){var r=new he,o=new he;return function(u){var g=this.levels;if(g.length>1){r.setFromMatrixPosition(u.matrixWorld),o.setFromMatrixPosition(this.matrixWorld);var y=r.distanceTo(o);g[0].object.visible=!0;for(var T=1,I=g.length;T<I&&y>=g[T].distance;T++)g[T-1].object.visible=!1,g[T].object.visible=!0;for(;T<I;T++)g[T].object.visible=!1}}}(),toJSON:function(r){var o=vt.prototype.toJSON.call(this,r);o.object.levels=[];for(var h=this.levels,u=0,g=h.length;u<g;u++){var y=h[u];o.object.levels.push({object:y.object.uuid,distance:y.distance})}return o}});function ms(r,o){if(r=r||[],this.bones=r.slice(0),this.boneMatrices=new Float32Array(this.bones.length*16),o===void 0)this.calculateInverses();else if(this.bones.length===o.length)this.boneInverses=o.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var h=0,u=this.bones.length;h<u;h++)this.boneInverses.push(new Ot)}}Object.assign(ms.prototype,{calculateInverses:function(){this.boneInverses=[];for(var r=0,o=this.bones.length;r<o;r++){var h=new Ot;this.bones[r]&&h.getInverse(this.bones[r].matrixWorld),this.boneInverses.push(h)}},pose:function(){var r,o,h;for(o=0,h=this.bones.length;o<h;o++)r=this.bones[o],r&&r.matrixWorld.getInverse(this.boneInverses[o]);for(o=0,h=this.bones.length;o<h;o++)r=this.bones[o],r&&(r.parent&&r.parent.isBone?(r.matrix.getInverse(r.parent.matrixWorld),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))},update:function(){var r=new Ot,o=new Ot;return function(){for(var u=this.bones,g=this.boneInverses,y=this.boneMatrices,T=this.boneTexture,I=0,D=u.length;I<D;I++){var N=u[I]?u[I].matrixWorld:o;r.multiplyMatrices(N,g[I]),r.toArray(y,I*16)}T!==void 0&&(T.needsUpdate=!0)}}(),clone:function(){return new ms(this.bones,this.boneInverses)},getBoneByName:function(r){for(var o=0,h=this.bones.length;o<h;o++){var u=this.bones[o];if(u.name===r)return u}}});function Ho(){vt.call(this),this.type="Bone"}Ho.prototype=Object.assign(Object.create(vt.prototype),{constructor:Ho,isBone:!0});function Wo(r,o){Mn.call(this,r,o),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ot,this.bindMatrixInverse=new Ot;var h=this.initBones(),u=new ms(h);this.bind(u,this.matrixWorld),this.normalizeSkinWeights()}Wo.prototype=Object.assign(Object.create(Mn.prototype),{constructor:Wo,isSkinnedMesh:!0,initBones:function(){var r=[],o,h,u,g;if(this.geometry&&this.geometry.bones!==void 0){for(u=0,g=this.geometry.bones.length;u<g;u++)h=this.geometry.bones[u],o=new Ho,r.push(o),o.name=h.name,o.position.fromArray(h.pos),o.quaternion.fromArray(h.rotq),h.scl!==void 0&&o.scale.fromArray(h.scl);for(u=0,g=this.geometry.bones.length;u<g;u++)h=this.geometry.bones[u],h.parent!==-1&&h.parent!==null&&r[h.parent]!==void 0?r[h.parent].add(r[u]):this.add(r[u])}return this.updateMatrixWorld(!0),r},bind:function(r,o){this.skeleton=r,o===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),o=this.matrixWorld),this.bindMatrix.copy(o),this.bindMatrixInverse.getInverse(o)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var r,o;if(this.geometry&&this.geometry.isGeometry)for(o=0;o<this.geometry.skinWeights.length;o++){var h=this.geometry.skinWeights[o];r=1/h.manhattanLength(),r!==1/0?h.multiplyScalar(r):h.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var u=new wi,g=this.geometry.attributes.skinWeight;for(o=0;o<g.count;o++)u.x=g.getX(o),u.y=g.getY(o),u.z=g.getZ(o),u.w=g.getW(o),r=1/u.manhattanLength(),r!==1/0?u.multiplyScalar(r):u.set(1,0,0,0),g.setXYZW(o,u.x,u.y,u.z,u.w)}},updateMatrixWorld:function(r){Mn.prototype.updateMatrixWorld.call(this,r),this.bindMode==="attached"?this.bindMatrixInverse.getInverse(this.matrixWorld):this.bindMode==="detached"?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});function Di(r){Xt.call(this),this.type="LineBasicMaterial",this.color=new Mt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(r)}Di.prototype=Object.create(Xt.prototype),Di.prototype.constructor=Di,Di.prototype.isLineBasicMaterial=!0,Di.prototype.copy=function(r){return Xt.prototype.copy.call(this,r),this.color.copy(r.color),this.linewidth=r.linewidth,this.linecap=r.linecap,this.linejoin=r.linejoin,this};function Bn(r,o,h){if(h===1)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new Li(r,o);vt.call(this),this.type="Line",this.geometry=r!==void 0?r:new Tt,this.material=o!==void 0?o:new Di({color:Math.random()*16777215})}Bn.prototype=Object.assign(Object.create(vt.prototype),{constructor:Bn,isLine:!0,computeLineDistances:function(){var r=new he,o=new he;return function(){var u=this.geometry;if(u.isBufferGeometry)if(u.index===null){for(var g=u.attributes.position,y=[0],T=1,I=g.count;T<I;T++)r.fromBufferAttribute(g,T-1),o.fromBufferAttribute(g,T),y[T]=y[T-1],y[T]+=r.distanceTo(o);u.addAttribute("lineDistance",new _t(y,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(u.isGeometry){var D=u.vertices,y=u.lineDistances;y[0]=0;for(var T=1,I=D.length;T<I;T++)y[T]=y[T-1],y[T]+=D[T-1].distanceTo(D[T])}return this}}(),raycast:function(){var r=new Ot,o=new zn,h=new nr;return function(g,y){var T=g.linePrecision,I=T*T,D=this.geometry,N=this.matrixWorld;if(D.boundingSphere===null&&D.computeBoundingSphere(),h.copy(D.boundingSphere),h.applyMatrix4(N),g.ray.intersectsSphere(h)!==!1){r.getInverse(N),o.copy(g.ray).applyMatrix4(r);var A=new he,B=new he,F=new he,G=new he,j=this&&this.isLineSegments?2:1;if(D.isBufferGeometry){var $=D.index,Z=D.attributes,Q=Z.position.array;if($!==null)for(var ie=$.array,ne=0,ae=ie.length-1;ne<ae;ne+=j){var ye=ie[ne],ge=ie[ne+1];A.fromArray(Q,ye*3),B.fromArray(Q,ge*3);var be=o.distanceSqToSegment(A,B,G,F);if(!(be>I)){G.applyMatrix4(this.matrixWorld);var Ee=g.ray.origin.distanceTo(G);Ee<g.near||Ee>g.far||y.push({distance:Ee,point:F.clone().applyMatrix4(this.matrixWorld),index:ne,face:null,faceIndex:null,object:this})}}else for(var ne=0,ae=Q.length/3-1;ne<ae;ne+=j){A.fromArray(Q,3*ne),B.fromArray(Q,3*ne+3);var be=o.distanceSqToSegment(A,B,G,F);if(!(be>I)){G.applyMatrix4(this.matrixWorld);var Ee=g.ray.origin.distanceTo(G);Ee<g.near||Ee>g.far||y.push({distance:Ee,point:F.clone().applyMatrix4(this.matrixWorld),index:ne,face:null,faceIndex:null,object:this})}}}else if(D.isGeometry)for(var Se=D.vertices,Re=Se.length,ne=0;ne<Re-1;ne+=j){var be=o.distanceSqToSegment(Se[ne],Se[ne+1],G,F);if(!(be>I)){G.applyMatrix4(this.matrixWorld);var Ee=g.ray.origin.distanceTo(G);Ee<g.near||Ee>g.far||y.push({distance:Ee,point:F.clone().applyMatrix4(this.matrixWorld),index:ne,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});function Li(r,o){Bn.call(this,r,o),this.type="LineSegments"}Li.prototype=Object.assign(Object.create(Bn.prototype),{constructor:Li,isLineSegments:!0,computeLineDistances:function(){var r=new he,o=new he;return function(){var u=this.geometry;if(u.isBufferGeometry)if(u.index===null){for(var g=u.attributes.position,y=[],T=0,I=g.count;T<I;T+=2)r.fromBufferAttribute(g,T),o.fromBufferAttribute(g,T+1),y[T]=T===0?0:y[T-1],y[T+1]=y[T]+r.distanceTo(o);u.addAttribute("lineDistance",new _t(y,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(u.isGeometry)for(var D=u.vertices,y=u.lineDistances,T=0,I=D.length;T<I;T+=2)r.copy(D[T]),o.copy(D[T+1]),y[T]=T===0?0:y[T-1],y[T+1]=y[T]+r.distanceTo(o);return this}}()});function io(r,o){Bn.call(this,r,o),this.type="LineLoop"}io.prototype=Object.assign(Object.create(Bn.prototype),{constructor:io,isLineLoop:!0});function gr(r){Xt.call(this),this.type="PointsMaterial",this.color=new Mt(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.lights=!1,this.setValues(r)}gr.prototype=Object.create(Xt.prototype),gr.prototype.constructor=gr,gr.prototype.isPointsMaterial=!0,gr.prototype.copy=function(r){return Xt.prototype.copy.call(this,r),this.color.copy(r.color),this.map=r.map,this.size=r.size,this.sizeAttenuation=r.sizeAttenuation,this.morphTargets=r.morphTargets,this};function zs(r,o){vt.call(this),this.type="Points",this.geometry=r!==void 0?r:new Tt,this.material=o!==void 0?o:new gr({color:Math.random()*16777215})}zs.prototype=Object.assign(Object.create(vt.prototype),{constructor:zs,isPoints:!0,raycast:function(){var r=new Ot,o=new zn,h=new nr;return function(g,y){var T=this,I=this.geometry,D=this.matrixWorld,N=g.params.Points.threshold;if(I.boundingSphere===null&&I.computeBoundingSphere(),h.copy(I.boundingSphere),h.applyMatrix4(D),h.radius+=N,g.ray.intersectsSphere(h)===!1)return;r.getInverse(D),o.copy(g.ray).applyMatrix4(r);var A=N/((this.scale.x+this.scale.y+this.scale.z)/3),B=A*A,F=new he,G=new he;function j(Ee,Se){var Re=o.distanceSqToPoint(Ee);if(Re<B){o.closestPointToPoint(Ee,G),G.applyMatrix4(D);var Ie=g.ray.origin.distanceTo(G);if(Ie<g.near||Ie>g.far)return;y.push({distance:Ie,distanceToRay:Math.sqrt(Re),point:G.clone(),index:Se,face:null,object:T})}}if(I.isBufferGeometry){var $=I.index,Z=I.attributes,Q=Z.position.array;if($!==null)for(var ie=$.array,ne=0,ae=ie.length;ne<ae;ne++){var ye=ie[ne];F.fromArray(Q,ye*3),j(F,ye)}else for(var ne=0,ge=Q.length/3;ne<ge;ne++)F.fromArray(Q,ne*3),j(F,ne)}else for(var be=I.vertices,ne=0,ge=be.length;ne<ge;ne++)j(be[ne],ne)}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});function fs(r,o,h,u,g,y,T,I,D){Ci.call(this,r,o,h,u,g,y,T,I,D),this.generateMipmaps=!1}fs.prototype=Object.assign(Object.create(Ci.prototype),{constructor:fs,isVideoTexture:!0,update:function(){var r=this.image;r.readyState>=r.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});function Gs(r,o,h,u,g,y,T,I,D,N,A,B){Ci.call(this,null,y,T,I,D,N,u,g,A,B),this.image={width:o,height:h},this.mipmaps=r,this.flipY=!1,this.generateMipmaps=!1}Gs.prototype=Object.create(Ci.prototype),Gs.prototype.constructor=Gs,Gs.prototype.isCompressedTexture=!0;function gs(r,o,h,u,g,y,T,I,D,N){if(N=N!==void 0?N:Ze,N!==Ze&&N!==We)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");h===void 0&&N===Ze&&(h=Le),h===void 0&&N===We&&(h=Ar),Ci.call(this,null,u,g,y,T,I,N,h,D),this.image={width:r,height:o},this.magFilter=T!==void 0?T:Hi,this.minFilter=I!==void 0?I:Hi,this.flipY=!1,this.generateMipmaps=!1}gs.prototype=Object.create(Ci.prototype),gs.prototype.constructor=gs,gs.prototype.isDepthTexture=!0;function va(r){Tt.call(this),this.type="WireframeGeometry";var o=[],h,u,g,y,T,I=[0,0],D={},N,A,B,F,G=["a","b","c"],j;if(r&&r.isGeometry){var $=r.faces;for(h=0,g=$.length;h<g;h++){var Z=$[h];for(u=0;u<3;u++)A=Z[G[u]],B=Z[G[(u+1)%3]],I[0]=Math.min(A,B),I[1]=Math.max(A,B),F=I[0]+","+I[1],D[F]===void 0&&(D[F]={index1:I[0],index2:I[1]})}for(F in D)N=D[F],j=r.vertices[N.index1],o.push(j.x,j.y,j.z),j=r.vertices[N.index2],o.push(j.x,j.y,j.z)}else if(r&&r.isBufferGeometry){var Q,ie,ne,ae,ye,ge,be,Ee;if(j=new he,r.index!==null){for(Q=r.attributes.position,ie=r.index,ne=r.groups,ne.length===0&&(ne=[{start:0,count:ie.count,materialIndex:0}]),y=0,T=ne.length;y<T;++y)for(ae=ne[y],ye=ae.start,ge=ae.count,h=ye,g=ye+ge;h<g;h+=3)for(u=0;u<3;u++)A=ie.getX(h+u),B=ie.getX(h+(u+1)%3),I[0]=Math.min(A,B),I[1]=Math.max(A,B),F=I[0]+","+I[1],D[F]===void 0&&(D[F]={index1:I[0],index2:I[1]});for(F in D)N=D[F],j.fromBufferAttribute(Q,N.index1),o.push(j.x,j.y,j.z),j.fromBufferAttribute(Q,N.index2),o.push(j.x,j.y,j.z)}else for(Q=r.attributes.position,h=0,g=Q.count/3;h<g;h++)for(u=0;u<3;u++)be=3*h+u,j.fromBufferAttribute(Q,be),o.push(j.x,j.y,j.z),Ee=3*h+(u+1)%3,j.fromBufferAttribute(Q,Ee),o.push(j.x,j.y,j.z)}this.addAttribute("position",new _t(o,3))}va.prototype=Object.create(Tt.prototype),va.prototype.constructor=va;function jr(r,o,h){xt.call(this),this.type="ParametricGeometry",this.parameters={func:r,slices:o,stacks:h},this.fromBufferGeometry(new ya(r,o,h)),this.mergeVertices()}jr.prototype=Object.create(xt.prototype),jr.prototype.constructor=jr;function ya(r,o,h){Tt.call(this),this.type="ParametricBufferGeometry",this.parameters={func:r,slices:o,stacks:h};var u=[],g=[],y=[],T=[],I=1e-5,D=new he,N=new he,A=new he,B=new he,F=new he,G,j;r.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var $=o+1;for(G=0;G<=h;G++){var Z=G/h;for(j=0;j<=o;j++){var Q=j/o;r(Q,Z,N),g.push(N.x,N.y,N.z),Q-I>=0?(r(Q-I,Z,A),B.subVectors(N,A)):(r(Q+I,Z,A),B.subVectors(A,N)),Z-I>=0?(r(Q,Z-I,A),F.subVectors(N,A)):(r(Q,Z+I,A),F.subVectors(A,N)),D.crossVectors(B,F).normalize(),y.push(D.x,D.y,D.z),T.push(Q,Z)}}for(G=0;G<h;G++)for(j=0;j<o;j++){var ie=G*$+j,ne=G*$+j+1,ae=(G+1)*$+j+1,ye=(G+1)*$+j;u.push(ie,ne,ye),u.push(ne,ae,ye)}this.setIndex(u),this.addAttribute("position",new _t(g,3)),this.addAttribute("normal",new _t(y,3)),this.addAttribute("uv",new _t(T,2))}ya.prototype=Object.create(Tt.prototype),ya.prototype.constructor=ya;function no(r,o,h,u){xt.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:r,indices:o,radius:h,detail:u},this.fromBufferGeometry(new di(r,o,h,u)),this.mergeVertices()}no.prototype=Object.create(xt.prototype),no.prototype.constructor=no;function di(r,o,h,u){Tt.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:r,indices:o,radius:h,detail:u},h=h||1,u=u||0;var g=[],y=[];T(u),D(h),N(),this.addAttribute("position",new _t(g,3)),this.addAttribute("normal",new _t(g.slice(),3)),this.addAttribute("uv",new _t(y,2)),u===0?this.computeVertexNormals():this.normalizeNormals();function T(Q){for(var ie=new he,ne=new he,ae=new he,ye=0;ye<o.length;ye+=3)F(o[ye+0],ie),F(o[ye+1],ne),F(o[ye+2],ae),I(ie,ne,ae,Q)}function I(Q,ie,ne,ae){var ye=Math.pow(2,ae),ge=[],be,Ee;for(be=0;be<=ye;be++){ge[be]=[];var Se=Q.clone().lerp(ne,be/ye),Re=ie.clone().lerp(ne,be/ye),Ie=ye-be;for(Ee=0;Ee<=Ie;Ee++)Ee===0&&be===ye?ge[be][Ee]=Se:ge[be][Ee]=Se.clone().lerp(Re,Ee/Ie)}for(be=0;be<ye;be++)for(Ee=0;Ee<2*(ye-be)-1;Ee++){var Ve=Math.floor(Ee/2);Ee%2===0?(B(ge[be][Ve+1]),B(ge[be+1][Ve]),B(ge[be][Ve])):(B(ge[be][Ve+1]),B(ge[be+1][Ve+1]),B(ge[be+1][Ve]))}}function D(Q){for(var ie=new he,ne=0;ne<g.length;ne+=3)ie.x=g[ne+0],ie.y=g[ne+1],ie.z=g[ne+2],ie.normalize().multiplyScalar(Q),g[ne+0]=ie.x,g[ne+1]=ie.y,g[ne+2]=ie.z}function N(){for(var Q=new he,ie=0;ie<g.length;ie+=3){Q.x=g[ie+0],Q.y=g[ie+1],Q.z=g[ie+2];var ne=$(Q)/2/Math.PI+.5,ae=Z(Q)/Math.PI+.5;y.push(ne,1-ae)}G(),A()}function A(){for(var Q=0;Q<y.length;Q+=6){var ie=y[Q+0],ne=y[Q+2],ae=y[Q+4],ye=Math.max(ie,ne,ae),ge=Math.min(ie,ne,ae);ye>.9&&ge<.1&&(ie<.2&&(y[Q+0]+=1),ne<.2&&(y[Q+2]+=1),ae<.2&&(y[Q+4]+=1))}}function B(Q){g.push(Q.x,Q.y,Q.z)}function F(Q,ie){var ne=Q*3;ie.x=r[ne+0],ie.y=r[ne+1],ie.z=r[ne+2]}function G(){for(var Q=new he,ie=new he,ne=new he,ae=new he,ye=new rt,ge=new rt,be=new rt,Ee=0,Se=0;Ee<g.length;Ee+=9,Se+=6){Q.set(g[Ee+0],g[Ee+1],g[Ee+2]),ie.set(g[Ee+3],g[Ee+4],g[Ee+5]),ne.set(g[Ee+6],g[Ee+7],g[Ee+8]),ye.set(y[Se+0],y[Se+1]),ge.set(y[Se+2],y[Se+3]),be.set(y[Se+4],y[Se+5]),ae.copy(Q).add(ie).add(ne).divideScalar(3);var Re=$(ae);j(ye,Se+0,Q,Re),j(ge,Se+2,ie,Re),j(be,Se+4,ne,Re)}}function j(Q,ie,ne,ae){ae<0&&Q.x===1&&(y[ie]=Q.x-1),ne.x===0&&ne.z===0&&(y[ie]=ae/2/Math.PI+.5)}function $(Q){return Math.atan2(Q.z,-Q.x)}function Z(Q){return Math.atan2(-Q.y,Math.sqrt(Q.x*Q.x+Q.z*Q.z))}}di.prototype=Object.create(Tt.prototype),di.prototype.constructor=di;function ro(r,o){xt.call(this),this.type="TetrahedronGeometry",this.parameters={radius:r,detail:o},this.fromBufferGeometry(new _s(r,o)),this.mergeVertices()}ro.prototype=Object.create(xt.prototype),ro.prototype.constructor=ro;function _s(r,o){var h=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],u=[2,1,0,0,3,2,1,3,0,2,3,1];di.call(this,h,u,r,o),this.type="TetrahedronBufferGeometry",this.parameters={radius:r,detail:o}}_s.prototype=Object.create(di.prototype),_s.prototype.constructor=_s;function qr(r,o){xt.call(this),this.type="OctahedronGeometry",this.parameters={radius:r,detail:o},this.fromBufferGeometry(new vn(r,o)),this.mergeVertices()}qr.prototype=Object.create(xt.prototype),qr.prototype.constructor=qr;function vn(r,o){var h=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],u=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];di.call(this,h,u,r,o),this.type="OctahedronBufferGeometry",this.parameters={radius:r,detail:o}}vn.prototype=Object.create(di.prototype),vn.prototype.constructor=vn;function vs(r,o){xt.call(this),this.type="IcosahedronGeometry",this.parameters={radius:r,detail:o},this.fromBufferGeometry(new ys(r,o)),this.mergeVertices()}vs.prototype=Object.create(xt.prototype),vs.prototype.constructor=vs;function ys(r,o){var h=(1+Math.sqrt(5))/2,u=[-1,h,0,1,h,0,-1,-h,0,1,-h,0,0,-1,h,0,1,h,0,-1,-h,0,1,-h,h,0,-1,h,0,1,-h,0,-1,-h,0,1],g=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];di.call(this,u,g,r,o),this.type="IcosahedronBufferGeometry",this.parameters={radius:r,detail:o}}ys.prototype=Object.create(di.prototype),ys.prototype.constructor=ys;function Sa(r,o){xt.call(this),this.type="DodecahedronGeometry",this.parameters={radius:r,detail:o},this.fromBufferGeometry(new Hs(r,o)),this.mergeVertices()}Sa.prototype=Object.create(xt.prototype),Sa.prototype.constructor=Sa;function Hs(r,o){var h=(1+Math.sqrt(5))/2,u=1/h,g=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-u,-h,0,-u,h,0,u,-h,0,u,h,-u,-h,0,-u,h,0,u,-h,0,u,h,0,-h,0,-u,h,0,-u,-h,0,u,h,0,u],y=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];di.call(this,g,y,r,o),this.type="DodecahedronBufferGeometry",this.parameters={radius:r,detail:o}}Hs.prototype=Object.create(di.prototype),Hs.prototype.constructor=Hs;function ba(r,o,h,u,g,y){xt.call(this),this.type="TubeGeometry",this.parameters={path:r,tubularSegments:o,radius:h,radialSegments:u,closed:g},y!==void 0&&console.warn("THREE.TubeGeometry: taper has been removed.");var T=new Ws(r,o,h,u,g);this.tangents=T.tangents,this.normals=T.normals,this.binormals=T.binormals,this.fromBufferGeometry(T),this.mergeVertices()}ba.prototype=Object.create(xt.prototype),ba.prototype.constructor=ba;function Ws(r,o,h,u,g){Tt.call(this),this.type="TubeBufferGeometry",this.parameters={path:r,tubularSegments:o,radius:h,radialSegments:u,closed:g},o=o||64,h=h||1,u=u||8,g=g||!1;var y=r.computeFrenetFrames(o,g);this.tangents=y.tangents,this.normals=y.normals,this.binormals=y.binormals;var T=new he,I=new he,D=new rt,N=new he,A,B,F=[],G=[],j=[],$=[];Z(),this.setIndex($),this.addAttribute("position",new _t(F,3)),this.addAttribute("normal",new _t(G,3)),this.addAttribute("uv",new _t(j,2));function Z(){for(A=0;A<o;A++)Q(A);Q(g===!1?o:0),ne(),ie()}function Q(ae){N=r.getPointAt(ae/o,N);var ye=y.normals[ae],ge=y.binormals[ae];for(B=0;B<=u;B++){var be=B/u*Math.PI*2,Ee=Math.sin(be),Se=-Math.cos(be);I.x=Se*ye.x+Ee*ge.x,I.y=Se*ye.y+Ee*ge.y,I.z=Se*ye.z+Ee*ge.z,I.normalize(),G.push(I.x,I.y,I.z),T.x=N.x+h*I.x,T.y=N.y+h*I.y,T.z=N.z+h*I.z,F.push(T.x,T.y,T.z)}}function ie(){for(B=1;B<=o;B++)for(A=1;A<=u;A++){var ae=(u+1)*(B-1)+(A-1),ye=(u+1)*B+(A-1),ge=(u+1)*B+A,be=(u+1)*(B-1)+A;$.push(ae,ye,be),$.push(ye,ge,be)}}function ne(){for(A=0;A<=o;A++)for(B=0;B<=u;B++)D.x=A/o,D.y=B/u,j.push(D.x,D.y)}}Ws.prototype=Object.create(Tt.prototype),Ws.prototype.constructor=Ws;function Ca(r,o,h,u,g,y,T){xt.call(this),this.type="TorusKnotGeometry",this.parameters={radius:r,tube:o,tubularSegments:h,radialSegments:u,p:g,q:y},T!==void 0&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new wa(r,o,h,u,g,y)),this.mergeVertices()}Ca.prototype=Object.create(xt.prototype),Ca.prototype.constructor=Ca;function wa(r,o,h,u,g,y){Tt.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:r,tube:o,tubularSegments:h,radialSegments:u,p:g,q:y},r=r||1,o=o||.4,h=Math.floor(h)||64,u=Math.floor(u)||8,g=g||2,y=y||3;var T=[],I=[],D=[],N=[],A,B,F=new he,G=new he,j=new he,$=new he,Z=new he,Q=new he,ie=new he;for(A=0;A<=h;++A){var ne=A/h*g*Math.PI*2;for(Ie(ne,g,y,r,j),Ie(ne+.01,g,y,r,$),Q.subVectors($,j),ie.addVectors($,j),Z.crossVectors(Q,ie),ie.crossVectors(Z,Q),Z.normalize(),ie.normalize(),B=0;B<=u;++B){var ae=B/u*Math.PI*2,ye=-o*Math.cos(ae),ge=o*Math.sin(ae);F.x=j.x+(ye*ie.x+ge*Z.x),F.y=j.y+(ye*ie.y+ge*Z.y),F.z=j.z+(ye*ie.z+ge*Z.z),I.push(F.x,F.y,F.z),G.subVectors(F,j).normalize(),D.push(G.x,G.y,G.z),N.push(A/h),N.push(B/u)}}for(B=1;B<=h;B++)for(A=1;A<=u;A++){var be=(u+1)*(B-1)+(A-1),Ee=(u+1)*B+(A-1),Se=(u+1)*B+A,Re=(u+1)*(B-1)+A;T.push(be,Ee,Re),T.push(Ee,Se,Re)}this.setIndex(T),this.addAttribute("position",new _t(I,3)),this.addAttribute("normal",new _t(D,3)),this.addAttribute("uv",new _t(N,2));function Ie(Ve,ot,ct,pt,yt){var ue=Math.cos(Ve),fe=Math.sin(Ve),je=ct/ot*Ve,Fe=Math.cos(je);yt.x=pt*(2+Fe)*.5*ue,yt.y=pt*(2+Fe)*fe*.5,yt.z=pt*Math.sin(je)*.5}}wa.prototype=Object.create(Tt.prototype),wa.prototype.constructor=wa;function js(r,o,h,u,g){xt.call(this),this.type="TorusGeometry",this.parameters={radius:r,tube:o,radialSegments:h,tubularSegments:u,arc:g},this.fromBufferGeometry(new qs(r,o,h,u,g)),this.mergeVertices()}js.prototype=Object.create(xt.prototype),js.prototype.constructor=js;function qs(r,o,h,u,g){Tt.call(this),this.type="TorusBufferGeometry",this.parameters={radius:r,tube:o,radialSegments:h,tubularSegments:u,arc:g},r=r||1,o=o||.4,h=Math.floor(h)||8,u=Math.floor(u)||6,g=g||Math.PI*2;var y=[],T=[],I=[],D=[],N=new he,A=new he,B=new he,F,G;for(F=0;F<=h;F++)for(G=0;G<=u;G++){var j=G/u*g,$=F/h*Math.PI*2;A.x=(r+o*Math.cos($))*Math.cos(j),A.y=(r+o*Math.cos($))*Math.sin(j),A.z=o*Math.sin($),T.push(A.x,A.y,A.z),N.x=r*Math.cos(j),N.y=r*Math.sin(j),B.subVectors(A,N).normalize(),I.push(B.x,B.y,B.z),D.push(G/u),D.push(F/h)}for(F=1;F<=h;F++)for(G=1;G<=u;G++){var Z=(u+1)*F+G-1,Q=(u+1)*(F-1)+G-1,ie=(u+1)*(F-1)+G,ne=(u+1)*F+G;y.push(Z,Q,ne),y.push(Q,ie,ne)}this.setIndex(y),this.addAttribute("position",new _t(T,3)),this.addAttribute("normal",new _t(I,3)),this.addAttribute("uv",new _t(D,2))}qs.prototype=Object.create(Tt.prototype),qs.prototype.constructor=qs;var Ni={triangulate:function(r,o,h){h=h||2;var u=o&&o.length,g=u?o[0]*h:r.length,y=Yl(r,0,g,h,!0),T=[];if(!y)return T;var I,D,N,A,B,F,G;if(u&&(y=$c(r,o,y,h)),r.length>80*h){I=N=r[0],D=A=r[1];for(var j=h;j<g;j+=h)B=r[j],F=r[j+1],B<I&&(I=B),F<D&&(D=F),B>N&&(N=B),F>A&&(A=F);G=Math.max(N-I,A-D),G=G!==0?1/G:0}return so(y,T,h,I,D,G),T}};function Yl(r,o,h,u,g){var y,T;if(g===Bt(r,o,h,u)>0)for(y=o;y<h;y+=u)T=Oe(y,r[y],r[y+1],T);else for(y=h-u;y>=o;y-=u)T=Oe(y,r[y],r[y+1],T);return T&&X(T,T.next)&&(Ke(T),T=T.next),T}function Rr(r,o){if(!r)return r;o||(o=r);var h=r,u;do if(u=!1,!h.steiner&&(X(h,h.next)||W(h.prev,h,h.next)===0)){if(Ke(h),h=o=h.prev,h===h.next)break;u=!0}else h=h.next;while(u||h!==o);return o}function so(r,o,h,u,g,y,T){if(!!r){!T&&y&&m(r,u,g,y);for(var I=r,D,N;r.prev!==r.next;){if(D=r.prev,N=r.next,y?Yc(r,u,g,y):jo(r)){o.push(D.i/h),o.push(r.i/h),o.push(N.i/h),Ke(r),r=N.next,I=N.next;continue}if(r=N,r===I){T?T===1?(r=dn(r,o,h),so(r,o,h,u,g,y,2)):T===2&&Jc(r,o,h,u,g,y):so(Rr(r),o,h,u,g,y,1);break}}}}function jo(r){var o=r.prev,h=r,u=r.next;if(W(o,h,u)>=0)return!1;for(var g=r.next.next;g!==r.prev;){if(P(o.x,o.y,h.x,h.y,u.x,u.y,g.x,g.y)&&W(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function Yc(r,o,h,u){var g=r.prev,y=r,T=r.next;if(W(g,y,T)>=0)return!1;for(var I=g.x<y.x?g.x<T.x?g.x:T.x:y.x<T.x?y.x:T.x,D=g.y<y.y?g.y<T.y?g.y:T.y:y.y<T.y?y.y:T.y,N=g.x>y.x?g.x>T.x?g.x:T.x:y.x>T.x?y.x:T.x,A=g.y>y.y?g.y>T.y?g.y:T.y:y.y>T.y?y.y:T.y,B=v(I,D,o,h,u),F=v(N,A,o,h,u),G=r.nextZ;G&&G.z<=F;){if(G!==r.prev&&G!==r.next&&P(g.x,g.y,y.x,y.y,T.x,T.y,G.x,G.y)&&W(G.prev,G,G.next)>=0)return!1;G=G.nextZ}for(G=r.prevZ;G&&G.z>=B;){if(G!==r.prev&&G!==r.next&&P(g.x,g.y,y.x,y.y,T.x,T.y,G.x,G.y)&&W(G.prev,G,G.next)>=0)return!1;G=G.prevZ}return!0}function dn(r,o,h){var u=r;do{var g=u.prev,y=u.next.next;!X(g,y)&&J(g,u,u.next,y)&&_e(g,y)&&_e(y,g)&&(o.push(g.i/h),o.push(u.i/h),o.push(y.i/h),Ke(u),Ke(u.next),u=r=y),u=u.next}while(u!==r);return u}function Jc(r,o,h,u,g,y){var T=r;do{for(var I=T.next.next;I!==T.prev;){if(T.i!==I.i&&U(T,I)){var D=ze(T,I);T=Rr(T,T.next),D=Rr(D,D.next),so(T,o,h,u,g,y),so(D,o,h,u,g,y);return}I=I.next}T=T.next}while(T!==r)}function $c(r,o,h,u){var g=[],y,T,I,D,N;for(y=0,T=o.length;y<T;y++)I=o[y]*u,D=y<T-1?o[y+1]*u:r.length,N=Yl(r,I,D,u,!1),N===N.next&&(N.steiner=!0),g.push(x(N));for(g.sort(Qc),y=0;y<g.length;y++)qo(g[y],h),h=Rr(h,h.next);return h}function Qc(r,o){return r.x-o.x}function qo(r,o){if(o=l(r,o),o){var h=ze(o,r);Rr(h,h.next)}}function l(r,o){var h=o,u=r.x,g=r.y,y=-1/0,T;do{if(g<=h.y&&g>=h.next.y&&h.next.y!==h.y){var I=h.x+(g-h.y)*(h.next.x-h.x)/(h.next.y-h.y);if(I<=u&&I>y){if(y=I,I===u){if(g===h.y)return h;if(g===h.next.y)return h.next}T=h.x<h.next.x?h:h.next}}h=h.next}while(h!==o);if(!T)return null;if(u===y)return T.prev;var D=T,N=T.x,A=T.y,B=1/0,F;for(h=T.next;h!==D;)u>=h.x&&h.x>=N&&u!==h.x&&P(g<A?u:y,g,N,A,g<A?y:u,g,h.x,h.y)&&(F=Math.abs(g-h.y)/(u-h.x),(F<B||F===B&&h.x>T.x)&&_e(h,r)&&(T=h,B=F)),h=h.next;return T}function m(r,o,h,u){var g=r;do g.z===null&&(g.z=v(g.x,g.y,o,h,u)),g.prevZ=g.prev,g.nextZ=g.next,g=g.next;while(g!==r);g.prevZ.nextZ=null,g.prevZ=null,C(g)}function C(r){var o,h,u,g,y,T,I,D,N=1;do{for(h=r,r=null,y=null,T=0;h;){for(T++,u=h,I=0,o=0;o<N&&(I++,u=u.nextZ,!!u);o++);for(D=N;I>0||D>0&&u;)I!==0&&(D===0||!u||h.z<=u.z)?(g=h,h=h.nextZ,I--):(g=u,u=u.nextZ,D--),y?y.nextZ=g:r=g,g.prevZ=y,y=g;h=u}y.nextZ=null,N*=2}while(T>1);return r}function v(r,o,h,u,g){return r=32767*(r-h)*g,o=32767*(o-u)*g,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,o=(o|o<<8)&16711935,o=(o|o<<4)&252645135,o=(o|o<<2)&858993459,o=(o|o<<1)&1431655765,r|o<<1}function x(r){var o=r,h=r;do o.x<h.x&&(h=o),o=o.next;while(o!==r);return h}function P(r,o,h,u,g,y,T,I){return(g-T)*(o-I)-(r-T)*(y-I)>=0&&(r-T)*(u-I)-(h-T)*(o-I)>=0&&(h-T)*(y-I)-(g-T)*(u-I)>=0}function U(r,o){return r.next.i!==o.i&&r.prev.i!==o.i&&!de(r,o)&&_e(r,o)&&_e(o,r)&&xe(r,o)}function W(r,o,h){return(o.y-r.y)*(h.x-o.x)-(o.x-r.x)*(h.y-o.y)}function X(r,o){return r.x===o.x&&r.y===o.y}function J(r,o,h,u){return X(r,o)&&X(h,u)||X(r,u)&&X(h,o)?!0:W(r,o,h)>0!=W(r,o,u)>0&&W(h,u,r)>0!=W(h,u,o)>0}function de(r,o){var h=r;do{if(h.i!==r.i&&h.next.i!==r.i&&h.i!==o.i&&h.next.i!==o.i&&J(h,h.next,r,o))return!0;h=h.next}while(h!==r);return!1}function _e(r,o){return W(r.prev,r,r.next)<0?W(r,o,r.next)>=0&&W(r,r.prev,o)>=0:W(r,o,r.prev)<0||W(r,r.next,o)<0}function xe(r,o){var h=r,u=!1,g=(r.x+o.x)/2,y=(r.y+o.y)/2;do h.y>y!=h.next.y>y&&h.next.y!==h.y&&g<(h.next.x-h.x)*(y-h.y)/(h.next.y-h.y)+h.x&&(u=!u),h=h.next;while(h!==r);return u}function ze(r,o){var h=new ht(r.i,r.x,r.y),u=new ht(o.i,o.x,o.y),g=r.next,y=o.prev;return r.next=o,o.prev=r,h.next=g,g.prev=h,u.next=h,h.prev=u,y.next=u,u.prev=y,u}function Oe(r,o,h,u){var g=new ht(r,o,h);return u?(g.next=u.next,g.prev=u,u.next.prev=g,u.next=g):(g.prev=g,g.next=g),g}function Ke(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function ht(r,o,h){this.i=r,this.x=o,this.y=h,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Bt(r,o,h,u){for(var g=0,y=o,T=h-u;y<h;y+=u)g+=(r[T]-r[y])*(r[y+1]+r[T+1]),T=y;return g}var dt={area:function(r){for(var o=r.length,h=0,u=o-1,g=0;g<o;u=g++)h+=r[u].x*r[g].y-r[g].x*r[u].y;return h*.5},isClockWise:function(r){return dt.area(r)<0},triangulateShape:function(r,o){var h=[],u=[],g=[];Vt(r),Ut(h,r);var y=r.length;o.forEach(Vt);for(var T=0;T<o.length;T++)u.push(y),y+=o[T].length,Ut(h,o[T]);for(var I=Ni.triangulate(h,u),T=0;T<I.length;T+=3)g.push(I.slice(T,T+3));return g}};function Vt(r){var o=r.length;o>2&&r[o-1].equals(r[0])&&r.pop()}function Ut(r,o){for(var h=0;h<o.length;h++)r.push(o[h].x),r.push(o[h].y)}function wt(r,o){xt.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:r,options:o},this.fromBufferGeometry(new Ht(r,o)),this.mergeVertices()}wt.prototype=Object.create(xt.prototype),wt.prototype.constructor=wt,wt.prototype.toJSON=function(){var r=xt.prototype.toJSON.call(this),o=this.parameters.shapes,h=this.parameters.options;return gi(o,h,r)};function Ht(r,o){Tt.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:r,options:o},r=Array.isArray(r)?r:[r];for(var h=this,u=[],g=[],y=0,T=r.length;y<T;y++){var I=r[y];D(I)}this.addAttribute("position",new _t(u,3)),this.addAttribute("uv",new _t(g,2)),this.computeVertexNormals();function D(N){var A=[],B=o.curveSegments!==void 0?o.curveSegments:12,F=o.steps!==void 0?o.steps:1,G=o.depth!==void 0?o.depth:100,j=o.bevelEnabled!==void 0?o.bevelEnabled:!0,$=o.bevelThickness!==void 0?o.bevelThickness:6,Z=o.bevelSize!==void 0?o.bevelSize:$-2,Q=o.bevelSegments!==void 0?o.bevelSegments:3,ie=o.extrudePath,ne=o.UVGenerator!==void 0?o.UVGenerator:Kt;o.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),G=o.amount);var ae,ye=!1,ge,be,Ee,Se;ie&&(ae=ie.getSpacedPoints(F),ye=!0,j=!1,ge=ie.computeFrenetFrames(F,!1),be=new he,Ee=new he,Se=new he),j||(Q=0,$=0,Z=0);var Re,Ie,Ve,ot=N.extractPoints(B),ct=ot.shape,pt=ot.holes,yt=!dt.isClockWise(ct);if(yt)for(ct=ct.reverse(),Ie=0,Ve=pt.length;Ie<Ve;Ie++)Re=pt[Ie],dt.isClockWise(Re)&&(pt[Ie]=Re.reverse());var ue=dt.triangulateShape(ct,pt),fe=ct;for(Ie=0,Ve=pt.length;Ie<Ve;Ie++)Re=pt[Ie],ct=ct.concat(Re);function je(St,Et,ii){return Et||console.error("THREE.ExtrudeGeometry: vec does not exist"),Et.clone().multiplyScalar(ii).add(St)}var Fe,mt,we,ut,Qe,Nt=ct.length,at,Dt=ue.length;function Qt(St,Et,ii){var It,oi,Mi,pi=St.x-Et.x,bn=St.y-Et.y,ci=ii.x-St.x,Cn=ii.y-St.y,kn=pi*pi+bn*bn,al=pi*Cn-bn*ci;if(Math.abs(al)>Number.EPSILON){var ol=Math.sqrt(kn),hd=Math.sqrt(ci*ci+Cn*Cn),Ts=Et.x-bn/ol,Qh=Et.y+pi/ol,Ru=ii.x-Cn/hd,Mu=ii.y+ci/hd,Zh=((Ru-Ts)*Cn-(Mu-Qh)*ci)/(pi*Cn-bn*ci);It=Ts+pi*Zh-St.x,oi=Qh+bn*Zh-St.y;var ec=It*It+oi*oi;if(ec<=2)return new rt(It,oi);Mi=Math.sqrt(ec/2)}else{var _o=!1;pi>Number.EPSILON?ci>Number.EPSILON&&(_o=!0):pi<-Number.EPSILON?ci<-Number.EPSILON&&(_o=!0):Math.sign(bn)===Math.sign(Cn)&&(_o=!0),_o?(It=-bn,oi=pi,Mi=Math.sqrt(kn)):(It=pi,oi=bn,Mi=Math.sqrt(kn/2))}return new rt(It/Mi,oi/Mi)}for(var Yi=[],ft=0,_i=fe.length,yn=_i-1,zi=ft+1;ft<_i;ft++,yn++,zi++)yn===_i&&(yn=0),zi===_i&&(zi=0),Yi[ft]=Qt(fe[ft],fe[yn],fe[zi]);var br=[],ji,Sn=Yi.concat();for(Ie=0,Ve=pt.length;Ie<Ve;Ie++){for(Re=pt[Ie],ji=[],ft=0,_i=Re.length,yn=_i-1,zi=ft+1;ft<_i;ft++,yn++,zi++)yn===_i&&(yn=0),zi===_i&&(zi=0),ji[ft]=Qt(Re[ft],Re[yn],Re[zi]);br.push(ji),Sn=Sn.concat(ji)}for(Fe=0;Fe<Q;Fe++){for(we=Fe/Q,ut=$*Math.cos(we*Math.PI/2),mt=Z*Math.sin(we*Math.PI/2),ft=0,_i=fe.length;ft<_i;ft++)Qe=je(fe[ft],Yi[ft],mt),Gi(Qe.x,Qe.y,-ut);for(Ie=0,Ve=pt.length;Ie<Ve;Ie++)for(Re=pt[Ie],ji=br[Ie],ft=0,_i=Re.length;ft<_i;ft++)Qe=je(Re[ft],ji[ft],mt),Gi(Qe.x,Qe.y,-ut)}for(mt=Z,ft=0;ft<Nt;ft++)Qe=j?je(ct[ft],Sn[ft],mt):ct[ft],ye?(Ee.copy(ge.normals[0]).multiplyScalar(Qe.x),be.copy(ge.binormals[0]).multiplyScalar(Qe.y),Se.copy(ae[0]).add(Ee).add(be),Gi(Se.x,Se.y,Se.z)):Gi(Qe.x,Qe.y,0);var Zn;for(Zn=1;Zn<=F;Zn++)for(ft=0;ft<Nt;ft++)Qe=j?je(ct[ft],Sn[ft],mt):ct[ft],ye?(Ee.copy(ge.normals[Zn]).multiplyScalar(Qe.x),be.copy(ge.binormals[Zn]).multiplyScalar(Qe.y),Se.copy(ae[Zn]).add(Ee).add(be),Gi(Se.x,Se.y,Se.z)):Gi(Qe.x,Qe.y,G/F*Zn);for(Fe=Q-1;Fe>=0;Fe--){for(we=Fe/Q,ut=$*Math.cos(we*Math.PI/2),mt=Z*Math.sin(we*Math.PI/2),ft=0,_i=fe.length;ft<_i;ft++)Qe=je(fe[ft],Yi[ft],mt),Gi(Qe.x,Qe.y,G+ut);for(Ie=0,Ve=pt.length;Ie<Ve;Ie++)for(Re=pt[Ie],ji=br[Ie],ft=0,_i=Re.length;ft<_i;ft++)Qe=je(Re[ft],ji[ft],mt),ye?Gi(Qe.x,Qe.y+ae[F-1].y,ae[F-1].x+ut):Gi(Qe.x,Qe.y,G+ut)}Js(),es();function Js(){var St=u.length/3;if(j){var Et=0,ii=Nt*Et;for(ft=0;ft<Dt;ft++)at=ue[ft],Cr(at[2]+ii,at[1]+ii,at[0]+ii);for(Et=F+Q*2,ii=Nt*Et,ft=0;ft<Dt;ft++)at=ue[ft],Cr(at[0]+ii,at[1]+ii,at[2]+ii)}else{for(ft=0;ft<Dt;ft++)at=ue[ft],Cr(at[2],at[1],at[0]);for(ft=0;ft<Dt;ft++)at=ue[ft],Cr(at[0]+Nt*F,at[1]+Nt*F,at[2]+Nt*F)}h.addGroup(St,u.length/3-St,0)}function es(){var St=u.length/3,Et=0;for($s(fe,Et),Et+=fe.length,Ie=0,Ve=pt.length;Ie<Ve;Ie++)Re=pt[Ie],$s(Re,Et),Et+=Re.length;h.addGroup(St,u.length/3-St,1)}function $s(St,Et){var ii,It;for(ft=St.length;--ft>=0;){ii=ft,It=ft-1,It<0&&(It=St.length-1);var oi=0,Mi=F+Q*2;for(oi=0;oi<Mi;oi++){var pi=Nt*oi,bn=Nt*(oi+1),ci=Et+ii+pi,Cn=Et+It+pi,kn=Et+It+bn,al=Et+ii+bn;Fn(ci,Cn,kn,al)}}}function Gi(St,Et,ii){A.push(St),A.push(Et),A.push(ii)}function Cr(St,Et,ii){dr(St),dr(Et),dr(ii);var It=u.length/3,oi=ne.generateTopUV(h,u,It-3,It-2,It-1);Ae(oi[0]),Ae(oi[1]),Ae(oi[2])}function Fn(St,Et,ii,It){dr(St),dr(Et),dr(It),dr(Et),dr(ii),dr(It);var oi=u.length/3,Mi=ne.generateSideWallUV(h,u,oi-6,oi-3,oi-2,oi-1);Ae(Mi[0]),Ae(Mi[1]),Ae(Mi[3]),Ae(Mi[1]),Ae(Mi[2]),Ae(Mi[3])}function dr(St){u.push(A[St*3+0]),u.push(A[St*3+1]),u.push(A[St*3+2])}function Ae(St){g.push(St.x),g.push(St.y)}}}Ht.prototype=Object.create(Tt.prototype),Ht.prototype.constructor=Ht,Ht.prototype.toJSON=function(){var r=Tt.prototype.toJSON.call(this),o=this.parameters.shapes,h=this.parameters.options;return gi(o,h,r)};var Kt={generateTopUV:function(r,o,h,u,g){var y=o[h*3],T=o[h*3+1],I=o[u*3],D=o[u*3+1],N=o[g*3],A=o[g*3+1];return[new rt(y,T),new rt(I,D),new rt(N,A)]},generateSideWallUV:function(r,o,h,u,g,y){var T=o[h*3],I=o[h*3+1],D=o[h*3+2],N=o[u*3],A=o[u*3+1],B=o[u*3+2],F=o[g*3],G=o[g*3+1],j=o[g*3+2],$=o[y*3],Z=o[y*3+1],Q=o[y*3+2];return Math.abs(I-A)<.01?[new rt(T,1-D),new rt(N,1-B),new rt(F,1-j),new rt($,1-Q)]:[new rt(I,1-D),new rt(A,1-B),new rt(G,1-j),new rt(Z,1-Q)]}};function gi(r,o,h){if(h.shapes=[],Array.isArray(r))for(var u=0,g=r.length;u<g;u++){var y=r[u];h.shapes.push(y.uuid)}else h.shapes.push(r.uuid);return o.extrudePath!==void 0&&(h.options.extrudePath=o.extrudePath.toJSON()),h}function Ii(r,o){xt.call(this),this.type="TextGeometry",this.parameters={text:r,parameters:o},this.fromBufferGeometry(new Vi(r,o)),this.mergeVertices()}Ii.prototype=Object.create(xt.prototype),Ii.prototype.constructor=Ii;function Vi(r,o){o=o||{};var h=o.font;if(!(h&&h.isFont))return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new xt;var u=h.generateShapes(r,o.size);o.depth=o.height!==void 0?o.height:50,o.bevelThickness===void 0&&(o.bevelThickness=10),o.bevelSize===void 0&&(o.bevelSize=8),o.bevelEnabled===void 0&&(o.bevelEnabled=!1),Ht.call(this,u,o),this.type="TextBufferGeometry"}Vi.prototype=Object.create(Ht.prototype),Vi.prototype.constructor=Vi;function Qi(r,o,h,u,g,y,T){xt.call(this),this.type="SphereGeometry",this.parameters={radius:r,widthSegments:o,heightSegments:h,phiStart:u,phiLength:g,thetaStart:y,thetaLength:T},this.fromBufferGeometry(new Ti(r,o,h,u,g,y,T)),this.mergeVertices()}Qi.prototype=Object.create(xt.prototype),Qi.prototype.constructor=Qi;function Ti(r,o,h,u,g,y,T){Tt.call(this),this.type="SphereBufferGeometry",this.parameters={radius:r,widthSegments:o,heightSegments:h,phiStart:u,phiLength:g,thetaStart:y,thetaLength:T},r=r||1,o=Math.max(3,Math.floor(o)||8),h=Math.max(2,Math.floor(h)||6),u=u!==void 0?u:0,g=g!==void 0?g:Math.PI*2,y=y!==void 0?y:0,T=T!==void 0?T:Math.PI;var I=y+T,D,N,A=0,B=[],F=new he,G=new he,j=[],$=[],Z=[],Q=[];for(N=0;N<=h;N++){var ie=[],ne=N/h;for(D=0;D<=o;D++){var ae=D/o;F.x=-r*Math.cos(u+ae*g)*Math.sin(y+ne*T),F.y=r*Math.cos(y+ne*T),F.z=r*Math.sin(u+ae*g)*Math.sin(y+ne*T),$.push(F.x,F.y,F.z),G.set(F.x,F.y,F.z).normalize(),Z.push(G.x,G.y,G.z),Q.push(ae,1-ne),ie.push(A++)}B.push(ie)}for(N=0;N<h;N++)for(D=0;D<o;D++){var ye=B[N][D+1],ge=B[N][D],be=B[N+1][D],Ee=B[N+1][D+1];(N!==0||y>0)&&j.push(ye,ge,Ee),(N!==h-1||I<Math.PI)&&j.push(ge,be,Ee)}this.setIndex(j),this.addAttribute("position",new _t($,3)),this.addAttribute("normal",new _t(Z,3)),this.addAttribute("uv",new _t(Q,2))}Ti.prototype=Object.create(Tt.prototype),Ti.prototype.constructor=Ti;function Xi(r,o,h,u,g,y){xt.call(this),this.type="RingGeometry",this.parameters={innerRadius:r,outerRadius:o,thetaSegments:h,phiSegments:u,thetaStart:g,thetaLength:y},this.fromBufferGeometry(new Pi(r,o,h,u,g,y)),this.mergeVertices()}Xi.prototype=Object.create(xt.prototype),Xi.prototype.constructor=Xi;function Pi(r,o,h,u,g,y){Tt.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:r,outerRadius:o,thetaSegments:h,phiSegments:u,thetaStart:g,thetaLength:y},r=r||.5,o=o||1,g=g!==void 0?g:0,y=y!==void 0?y:Math.PI*2,h=h!==void 0?Math.max(3,h):8,u=u!==void 0?Math.max(1,u):1;var T=[],I=[],D=[],N=[],A,B=r,F=(o-r)/u,G=new he,j=new rt,$,Z;for($=0;$<=u;$++){for(Z=0;Z<=h;Z++)A=g+Z/h*y,G.x=B*Math.cos(A),G.y=B*Math.sin(A),I.push(G.x,G.y,G.z),D.push(0,0,1),j.x=(G.x/o+1)/2,j.y=(G.y/o+1)/2,N.push(j.x,j.y);B+=F}for($=0;$<u;$++){var Q=$*(h+1);for(Z=0;Z<h;Z++){A=Z+Q;var ie=A,ne=A+h+1,ae=A+h+2,ye=A+1;T.push(ie,ne,ye),T.push(ne,ae,ye)}}this.setIndex(T),this.addAttribute("position",new _t(I,3)),this.addAttribute("normal",new _t(D,3)),this.addAttribute("uv",new _t(N,2))}Pi.prototype=Object.create(Tt.prototype),Pi.prototype.constructor=Pi;function Ri(r,o,h,u){xt.call(this),this.type="LatheGeometry",this.parameters={points:r,segments:o,phiStart:h,phiLength:u},this.fromBufferGeometry(new Zi(r,o,h,u)),this.mergeVertices()}Ri.prototype=Object.create(xt.prototype),Ri.prototype.constructor=Ri;function Zi(r,o,h,u){Tt.call(this),this.type="LatheBufferGeometry",this.parameters={points:r,segments:o,phiStart:h,phiLength:u},o=Math.floor(o)||12,h=h||0,u=u||Math.PI*2,u=si.clamp(u,0,Math.PI*2);var g=[],y=[],T=[],I,D=1/o,N=new he,A=new rt,B,F;for(B=0;B<=o;B++){var G=h+B*D*u,j=Math.sin(G),$=Math.cos(G);for(F=0;F<=r.length-1;F++)N.x=r[F].x*j,N.y=r[F].y,N.z=r[F].x*$,y.push(N.x,N.y,N.z),A.x=B/o,A.y=F/(r.length-1),T.push(A.x,A.y)}for(B=0;B<o;B++)for(F=0;F<r.length-1;F++){I=F+B*r.length;var Z=I,Q=I+r.length,ie=I+r.length+1,ne=I+1;g.push(Z,Q,ne),g.push(Q,ie,ne)}if(this.setIndex(g),this.addAttribute("position",new _t(y,3)),this.addAttribute("uv",new _t(T,2)),this.computeVertexNormals(),u===Math.PI*2){var ae=this.attributes.normal.array,ye=new he,ge=new he,be=new he;for(I=o*r.length*3,B=0,F=0;B<r.length;B++,F+=3)ye.x=ae[F+0],ye.y=ae[F+1],ye.z=ae[F+2],ge.x=ae[I+F+0],ge.y=ae[I+F+1],ge.z=ae[I+F+2],be.addVectors(ye,ge).normalize(),ae[F+0]=ae[I+F+0]=be.x,ae[F+1]=ae[I+F+1]=be.y,ae[F+2]=ae[I+F+2]=be.z}}Zi.prototype=Object.create(Tt.prototype),Zi.prototype.constructor=Zi;function Hn(r,o){xt.call(this),this.type="ShapeGeometry",typeof o=="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),o=o.curveSegments),this.parameters={shapes:r,curveSegments:o},this.fromBufferGeometry(new _r(r,o)),this.mergeVertices()}Hn.prototype=Object.create(xt.prototype),Hn.prototype.constructor=Hn,Hn.prototype.toJSON=function(){var r=xt.prototype.toJSON.call(this),o=this.parameters.shapes;return Mr(o,r)};function _r(r,o){Tt.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:r,curveSegments:o},o=o||12;var h=[],u=[],g=[],y=[],T=0,I=0;if(Array.isArray(r)===!1)N(r);else for(var D=0;D<r.length;D++)N(r[D]),this.addGroup(T,I,D),T+=I,I=0;this.setIndex(h),this.addAttribute("position",new _t(u,3)),this.addAttribute("normal",new _t(g,3)),this.addAttribute("uv",new _t(y,2));function N(A){var B,F,G,j=u.length/3,$=A.extractPoints(o),Z=$.shape,Q=$.holes;if(dt.isClockWise(Z)===!1)for(Z=Z.reverse(),B=0,F=Q.length;B<F;B++)G=Q[B],dt.isClockWise(G)===!0&&(Q[B]=G.reverse());var ie=dt.triangulateShape(Z,Q);for(B=0,F=Q.length;B<F;B++)G=Q[B],Z=Z.concat(G);for(B=0,F=Z.length;B<F;B++){var ne=Z[B];u.push(ne.x,ne.y,0),g.push(0,0,1),y.push(ne.x,ne.y)}for(B=0,F=ie.length;B<F;B++){var ae=ie[B],ye=ae[0]+j,ge=ae[1]+j,be=ae[2]+j;h.push(ye,ge,be),I+=3}}}_r.prototype=Object.create(Tt.prototype),_r.prototype.constructor=_r,_r.prototype.toJSON=function(){var r=Tt.prototype.toJSON.call(this),o=this.parameters.shapes;return Mr(o,r)};function Mr(r,o){if(o.shapes=[],Array.isArray(r))for(var h=0,u=r.length;h<u;h++){var g=r[h];o.shapes.push(g.uuid)}else o.shapes.push(r.uuid);return o}function vr(r,o){Tt.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:o},o=o!==void 0?o:1;var h=[],u=Math.cos(si.DEG2RAD*o),g=[0,0],y={},T,I,D,N=["a","b","c"],A;r.isBufferGeometry?(A=new xt,A.fromBufferGeometry(r)):A=r.clone(),A.mergeVertices(),A.computeFaceNormals();for(var B=A.vertices,F=A.faces,G=0,j=F.length;G<j;G++)for(var $=F[G],Z=0;Z<3;Z++)T=$[N[Z]],I=$[N[(Z+1)%3]],g[0]=Math.min(T,I),g[1]=Math.max(T,I),D=g[0]+","+g[1],y[D]===void 0?y[D]={index1:g[0],index2:g[1],face1:G,face2:void 0}:y[D].face2=G;for(D in y){var Q=y[D];if(Q.face2===void 0||F[Q.face1].normal.dot(F[Q.face2].normal)<=u){var ie=B[Q.index1];h.push(ie.x,ie.y,ie.z),ie=B[Q.index2],h.push(ie.x,ie.y,ie.z)}}this.addAttribute("position",new _t(h,3))}vr.prototype=Object.create(Tt.prototype),vr.prototype.constructor=vr;function Bi(r,o,h,u,g,y,T,I){xt.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:r,radiusBottom:o,height:h,radialSegments:u,heightSegments:g,openEnded:y,thetaStart:T,thetaLength:I},this.fromBufferGeometry(new Wn(r,o,h,u,g,y,T,I)),this.mergeVertices()}Bi.prototype=Object.create(xt.prototype),Bi.prototype.constructor=Bi;function Wn(r,o,h,u,g,y,T,I){Tt.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:r,radiusBottom:o,height:h,radialSegments:u,heightSegments:g,openEnded:y,thetaStart:T,thetaLength:I};var D=this;r=r!==void 0?r:1,o=o!==void 0?o:1,h=h||1,u=Math.floor(u)||8,g=Math.floor(g)||1,y=y!==void 0?y:!1,T=T!==void 0?T:0,I=I!==void 0?I:Math.PI*2;var N=[],A=[],B=[],F=[],G=0,j=[],$=h/2,Z=0;Q(),y===!1&&(r>0&&ie(!0),o>0&&ie(!1)),this.setIndex(N),this.addAttribute("position",new _t(A,3)),this.addAttribute("normal",new _t(B,3)),this.addAttribute("uv",new _t(F,2));function Q(){var ne,ae,ye=new he,ge=new he,be=0,Ee=(o-r)/h;for(ae=0;ae<=g;ae++){var Se=[],Re=ae/g,Ie=Re*(o-r)+r;for(ne=0;ne<=u;ne++){var Ve=ne/u,ot=Ve*I+T,ct=Math.sin(ot),pt=Math.cos(ot);ge.x=Ie*ct,ge.y=-Re*h+$,ge.z=Ie*pt,A.push(ge.x,ge.y,ge.z),ye.set(ct,Ee,pt).normalize(),B.push(ye.x,ye.y,ye.z),F.push(Ve,1-Re),Se.push(G++)}j.push(Se)}for(ne=0;ne<u;ne++)for(ae=0;ae<g;ae++){var yt=j[ae][ne],ue=j[ae+1][ne],fe=j[ae+1][ne+1],je=j[ae][ne+1];N.push(yt,ue,je),N.push(ue,fe,je),be+=6}D.addGroup(Z,be,0),Z+=be}function ie(ne){var ae,ye,ge,be=new rt,Ee=new he,Se=0,Re=ne===!0?r:o,Ie=ne===!0?1:-1;for(ye=G,ae=1;ae<=u;ae++)A.push(0,$*Ie,0),B.push(0,Ie,0),F.push(.5,.5),G++;for(ge=G,ae=0;ae<=u;ae++){var Ve=ae/u,ot=Ve*I+T,ct=Math.cos(ot),pt=Math.sin(ot);Ee.x=Re*pt,Ee.y=$*Ie,Ee.z=Re*ct,A.push(Ee.x,Ee.y,Ee.z),B.push(0,Ie,0),be.x=ct*.5+.5,be.y=pt*.5*Ie+.5,F.push(be.x,be.y),G++}for(ae=0;ae<u;ae++){var yt=ye+ae,ue=ge+ae;ne===!0?N.push(ue,ue+1,yt):N.push(ue+1,ue,yt),Se+=3}D.addGroup(Z,Se,ne===!0?1:2),Z+=Se}}Wn.prototype=Object.create(Tt.prototype),Wn.prototype.constructor=Wn;function rn(r,o,h,u,g,y,T){Bi.call(this,0,r,o,h,u,g,y,T),this.type="ConeGeometry",this.parameters={radius:r,height:o,radialSegments:h,heightSegments:u,openEnded:g,thetaStart:y,thetaLength:T}}rn.prototype=Object.create(Bi.prototype),rn.prototype.constructor=rn;function ao(r,o,h,u,g,y,T){Wn.call(this,0,r,o,h,u,g,y,T),this.type="ConeBufferGeometry",this.parameters={radius:r,height:o,radialSegments:h,heightSegments:u,openEnded:g,thetaStart:y,thetaLength:T}}ao.prototype=Object.create(Wn.prototype),ao.prototype.constructor=ao;function kr(r,o,h,u){xt.call(this),this.type="CircleGeometry",this.parameters={radius:r,segments:o,thetaStart:h,thetaLength:u},this.fromBufferGeometry(new Ss(r,o,h,u)),this.mergeVertices()}kr.prototype=Object.create(xt.prototype),kr.prototype.constructor=kr;function Ss(r,o,h,u){Tt.call(this),this.type="CircleBufferGeometry",this.parameters={radius:r,segments:o,thetaStart:h,thetaLength:u},r=r||1,o=o!==void 0?Math.max(3,o):8,h=h!==void 0?h:0,u=u!==void 0?u:Math.PI*2;var g=[],y=[],T=[],I=[],D,N,A=new he,B=new rt;for(y.push(0,0,0),T.push(0,0,1),I.push(.5,.5),N=0,D=3;N<=o;N++,D+=3){var F=h+N/o*u;A.x=r*Math.cos(F),A.y=r*Math.sin(F),y.push(A.x,A.y,A.z),T.push(0,0,1),B.x=(y[D]/r+1)/2,B.y=(y[D+1]/r+1)/2,I.push(B.x,B.y)}for(D=1;D<=o;D++)g.push(D,D+1,0);this.setIndex(g),this.addAttribute("position",new _t(y,3)),this.addAttribute("normal",new _t(T,3)),this.addAttribute("uv",new _t(I,2))}Ss.prototype=Object.create(Tt.prototype),Ss.prototype.constructor=Ss;var Ui=Object.freeze({WireframeGeometry:va,ParametricGeometry:jr,ParametricBufferGeometry:ya,TetrahedronGeometry:ro,TetrahedronBufferGeometry:_s,OctahedronGeometry:qr,OctahedronBufferGeometry:vn,IcosahedronGeometry:vs,IcosahedronBufferGeometry:ys,DodecahedronGeometry:Sa,DodecahedronBufferGeometry:Hs,PolyhedronGeometry:no,PolyhedronBufferGeometry:di,TubeGeometry:ba,TubeBufferGeometry:Ws,TorusKnotGeometry:Ca,TorusKnotBufferGeometry:wa,TorusGeometry:js,TorusBufferGeometry:qs,TextGeometry:Ii,TextBufferGeometry:Vi,SphereGeometry:Qi,SphereBufferGeometry:Ti,RingGeometry:Xi,RingBufferGeometry:Pi,PlaneGeometry:Fs,PlaneBufferGeometry:hs,LatheGeometry:Ri,LatheBufferGeometry:Zi,ShapeGeometry:Hn,ShapeBufferGeometry:_r,ExtrudeGeometry:wt,ExtrudeBufferGeometry:Ht,EdgesGeometry:vr,ConeGeometry:rn,ConeBufferGeometry:ao,CylinderGeometry:Bi,CylinderBufferGeometry:Wn,CircleGeometry:kr,CircleBufferGeometry:Ss,BoxGeometry:oa,BoxBufferGeometry:Vr});function Ks(r){Xt.call(this),this.type="ShadowMaterial",this.color=new Mt(0),this.transparent=!0,this.setValues(r)}Ks.prototype=Object.create(Xt.prototype),Ks.prototype.constructor=Ks,Ks.prototype.isShadowMaterial=!0,Ks.prototype.copy=function(r){return Xt.prototype.copy.call(this,r),this.color.copy(r.color),this};function Ko(r){$i.call(this,r),this.type="RawShaderMaterial"}Ko.prototype=Object.create($i.prototype),Ko.prototype.constructor=Ko,Ko.prototype.isRawShaderMaterial=!0;function bs(r){Xt.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Mt(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Mt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Na,this.normalScale=new rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(r)}bs.prototype=Object.create(Xt.prototype),bs.prototype.constructor=bs,bs.prototype.isMeshStandardMaterial=!0,bs.prototype.copy=function(r){return Xt.prototype.copy.call(this,r),this.defines={STANDARD:""},this.color.copy(r.color),this.roughness=r.roughness,this.metalness=r.metalness,this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.roughnessMap=r.roughnessMap,this.metalnessMap=r.metalnessMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.envMapIntensity=r.envMapIntensity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this};function oo(r){bs.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(r)}oo.prototype=Object.create(bs.prototype),oo.prototype.constructor=oo,oo.prototype.isMeshPhysicalMaterial=!0,oo.prototype.copy=function(r){return bs.prototype.copy.call(this,r),this.defines={PHYSICAL:""},this.reflectivity=r.reflectivity,this.clearCoat=r.clearCoat,this.clearCoatRoughness=r.clearCoatRoughness,this};function Kr(r){Xt.call(this),this.type="MeshPhongMaterial",this.color=new Mt(16777215),this.specular=new Mt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Mt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Na,this.normalScale=new rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Je,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(r)}Kr.prototype=Object.create(Xt.prototype),Kr.prototype.constructor=Kr,Kr.prototype.isMeshPhongMaterial=!0,Kr.prototype.copy=function(r){return Xt.prototype.copy.call(this,r),this.color.copy(r.color),this.specular.copy(r.specular),this.shininess=r.shininess,this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this};function lo(r){Kr.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(r)}lo.prototype=Object.create(Kr.prototype),lo.prototype.constructor=lo,lo.prototype.isMeshToonMaterial=!0,lo.prototype.copy=function(r){return Kr.prototype.copy.call(this,r),this.gradientMap=r.gradientMap,this};function ho(r){Xt.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Na,this.normalScale=new rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(r)}ho.prototype=Object.create(Xt.prototype),ho.prototype.constructor=ho,ho.prototype.isMeshNormalMaterial=!0,ho.prototype.copy=function(r){return Xt.prototype.copy.call(this,r),this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this};function co(r){Xt.call(this),this.type="MeshLambertMaterial",this.color=new Mt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Mt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Je,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(r)}co.prototype=Object.create(Xt.prototype),co.prototype.constructor=co,co.prototype.isMeshLambertMaterial=!0,co.prototype.copy=function(r){return Xt.prototype.copy.call(this,r),this.color.copy(r.color),this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this};function uo(r){Di.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(r)}uo.prototype=Object.create(Di.prototype),uo.prototype.constructor=uo,uo.prototype.isLineDashedMaterial=!0,uo.prototype.copy=function(r){return Di.prototype.copy.call(this,r),this.scale=r.scale,this.dashSize=r.dashSize,this.gapSize=r.gapSize,this};var vp=Object.freeze({ShadowMaterial:Ks,SpriteMaterial:Wr,RawShaderMaterial:Ko,ShaderMaterial:$i,PointsMaterial:gr,MeshPhysicalMaterial:oo,MeshStandardMaterial:bs,MeshPhongMaterial:Kr,MeshToonMaterial:lo,MeshNormalMaterial:ho,MeshLambertMaterial:co,MeshDepthMaterial:Gr,MeshDistanceMaterial:fr,MeshBasicMaterial:ai,LineDashedMaterial:uo,LineBasicMaterial:Di,Material:Xt}),po={enabled:!1,files:{},add:function(r,o){this.enabled!==!1&&(this.files[r]=o)},get:function(r){if(this.enabled!==!1)return this.files[r]},remove:function(r){delete this.files[r]},clear:function(){this.files={}}};function Zc(r,o,h){var u=this,g=!1,y=0,T=0,I=void 0;this.onStart=void 0,this.onLoad=r,this.onProgress=o,this.onError=h,this.itemStart=function(D){T++,g===!1&&u.onStart!==void 0&&u.onStart(D,y,T),g=!0},this.itemEnd=function(D){y++,u.onProgress!==void 0&&u.onProgress(D,y,T),y===T&&(g=!1,u.onLoad!==void 0&&u.onLoad())},this.itemError=function(D){u.onError!==void 0&&u.onError(D)},this.resolveURL=function(D){return I?I(D):D},this.setURLModifier=function(D){return I=D,this}}var or=new Zc,Xs={};function Xr(r){this.manager=r!==void 0?r:or}Object.assign(Xr.prototype,{load:function(r,o,h,u){r===void 0&&(r=""),this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);var g=this,y=po.get(r);if(y!==void 0)return g.manager.itemStart(r),setTimeout(function(){o&&o(y),g.manager.itemEnd(r)},0),y;if(Xs[r]!==void 0){Xs[r].push({onLoad:o,onProgress:h,onError:u});return}var T=/^data:(.*?)(;base64)?,(.*)$/,I=r.match(T);if(I){var D=I[1],N=!!I[2],A=I[3];A=window.decodeURIComponent(A),N&&(A=window.atob(A));try{var B,F=(this.responseType||"").toLowerCase();switch(F){case"arraybuffer":case"blob":for(var G=new Uint8Array(A.length),j=0;j<A.length;j++)G[j]=A.charCodeAt(j);F==="blob"?B=new Blob([G.buffer],{type:D}):B=G.buffer;break;case"document":var $=new DOMParser;B=$.parseFromString(A,D);break;case"json":B=JSON.parse(A);break;default:B=A;break}window.setTimeout(function(){o&&o(B),g.manager.itemEnd(r)},0)}catch(ie){window.setTimeout(function(){u&&u(ie),g.manager.itemEnd(r),g.manager.itemError(r)},0)}}else{Xs[r]=[],Xs[r].push({onLoad:o,onProgress:h,onError:u});var Z=new XMLHttpRequest;Z.open("GET",r,!0),Z.addEventListener("load",function(ie){var ne=this.response;po.add(r,ne);var ae=Xs[r];if(delete Xs[r],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var ye=0,ge=ae.length;ye<ge;ye++){var be=ae[ye];be.onLoad&&be.onLoad(ne)}g.manager.itemEnd(r)}else{for(var ye=0,ge=ae.length;ye<ge;ye++){var be=ae[ye];be.onError&&be.onError(ie)}g.manager.itemEnd(r),g.manager.itemError(r)}},!1),Z.addEventListener("progress",function(ie){for(var ne=Xs[r],ae=0,ye=ne.length;ae<ye;ae++){var ge=ne[ae];ge.onProgress&&ge.onProgress(ie)}},!1),Z.addEventListener("error",function(ie){var ne=Xs[r];delete Xs[r];for(var ae=0,ye=ne.length;ae<ye;ae++){var ge=ne[ae];ge.onError&&ge.onError(ie)}g.manager.itemEnd(r),g.manager.itemError(r)},!1),this.responseType!==void 0&&(Z.responseType=this.responseType),this.withCredentials!==void 0&&(Z.withCredentials=this.withCredentials),Z.overrideMimeType&&Z.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(var Q in this.requestHeader)Z.setRequestHeader(Q,this.requestHeader[Q]);Z.send(null)}return g.manager.itemStart(r),Z},setPath:function(r){return this.path=r,this},setResponseType:function(r){return this.responseType=r,this},setWithCredentials:function(r){return this.withCredentials=r,this},setMimeType:function(r){return this.mimeType=r,this},setRequestHeader:function(r){return this.requestHeader=r,this}});function Vu(r){this.manager=r!==void 0?r:or,this._parser=null}Object.assign(Vu.prototype,{load:function(r,o,h,u){var g=this,y=[],T=new Gs;T.image=y;var I=new Xr(this.manager);I.setPath(this.path),I.setResponseType("arraybuffer");function D(F){I.load(r[F],function(G){var j=g._parser(G,!0);y[F]={width:j.width,height:j.height,format:j.format,mipmaps:j.mipmaps},N+=1,N===6&&(j.mipmapCount===1&&(T.minFilter=fn),T.format=j.format,T.needsUpdate=!0,o&&o(T))},h,u)}if(Array.isArray(r))for(var N=0,A=0,B=r.length;A<B;++A)D(A);else I.load(r,function(F){var G=g._parser(F,!0);if(G.isCubemap)for(var j=G.mipmaps.length/G.mipmapCount,$=0;$<j;$++){y[$]={mipmaps:[]};for(var Z=0;Z<G.mipmapCount;Z++)y[$].mipmaps.push(G.mipmaps[$*G.mipmapCount+Z]),y[$].format=G.format,y[$].width=G.width,y[$].height=G.height}else T.image.width=G.width,T.image.height=G.height,T.mipmaps=G.mipmaps;G.mipmapCount===1&&(T.minFilter=fn),T.format=G.format,T.needsUpdate=!0,o&&o(T)},h,u);return T},setPath:function(r){return this.path=r,this}});function eu(r){this.manager=r!==void 0?r:or,this._parser=null}Object.assign(eu.prototype,{load:function(r,o,h,u){var g=this,y=new ss,T=new Xr(this.manager);return T.setResponseType("arraybuffer"),T.load(r,function(I){var D=g._parser(I);!D||(D.image!==void 0?y.image=D.image:D.data!==void 0&&(y.image.width=D.width,y.image.height=D.height,y.image.data=D.data),y.wrapS=D.wrapS!==void 0?D.wrapS:xi,y.wrapT=D.wrapT!==void 0?D.wrapT:xi,y.magFilter=D.magFilter!==void 0?D.magFilter:fn,y.minFilter=D.minFilter!==void 0?D.minFilter:wr,y.anisotropy=D.anisotropy!==void 0?D.anisotropy:1,D.format!==void 0&&(y.format=D.format),D.type!==void 0&&(y.type=D.type),D.mipmaps!==void 0&&(y.mipmaps=D.mipmaps),D.mipmapCount===1&&(y.minFilter=fn),y.needsUpdate=!0,o&&o(y,D))},h,u),y}});function Jl(r){this.manager=r!==void 0?r:or}Object.assign(Jl.prototype,{crossOrigin:"anonymous",load:function(r,o,h,u){r===void 0&&(r=""),this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);var g=this,y=po.get(r);if(y!==void 0)return g.manager.itemStart(r),setTimeout(function(){o&&o(y),g.manager.itemEnd(r)},0),y;var T=document.createElementNS("http://www.w3.org/1999/xhtml","img");function I(){T.removeEventListener("load",I,!1),T.removeEventListener("error",D,!1),po.add(r,this),o&&o(this),g.manager.itemEnd(r)}function D(N){T.removeEventListener("load",I,!1),T.removeEventListener("error",D,!1),u&&u(N),g.manager.itemEnd(r),g.manager.itemError(r)}return T.addEventListener("load",I,!1),T.addEventListener("error",D,!1),r.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(T.crossOrigin=this.crossOrigin),g.manager.itemStart(r),T.src=r,T},setCrossOrigin:function(r){return this.crossOrigin=r,this},setPath:function(r){return this.path=r,this}});function tu(r){this.manager=r!==void 0?r:or}Object.assign(tu.prototype,{crossOrigin:"anonymous",load:function(r,o,h,u){var g=new Ur,y=new Jl(this.manager);y.setCrossOrigin(this.crossOrigin),y.setPath(this.path);var T=0;function I(N){y.load(r[N],function(A){g.images[N]=A,T++,T===6&&(g.needsUpdate=!0,o&&o(g))},void 0,u)}for(var D=0;D<r.length;++D)I(D);return g},setCrossOrigin:function(r){return this.crossOrigin=r,this},setPath:function(r){return this.path=r,this}});function Dh(r){this.manager=r!==void 0?r:or}Object.assign(Dh.prototype,{crossOrigin:"anonymous",load:function(r,o,h,u){var g=new Ci,y=new Jl(this.manager);return y.setCrossOrigin(this.crossOrigin),y.setPath(this.path),y.load(r,function(T){g.image=T;var I=r.search(/\.(jpg|jpeg)$/)>0||r.search(/^data\:image\/jpeg/)===0;g.format=I?Tr:Dn,g.needsUpdate=!0,o!==void 0&&o(g)},h,u),g},setCrossOrigin:function(r){return this.crossOrigin=r,this},setPath:function(r){return this.path=r,this}});function zt(){this.type="Curve",this.arcLengthDivisions=200}Object.assign(zt.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(r,o){var h=this.getUtoTmapping(r);return this.getPoint(h,o)},getPoints:function(r){r===void 0&&(r=5);for(var o=[],h=0;h<=r;h++)o.push(this.getPoint(h/r));return o},getSpacedPoints:function(r){r===void 0&&(r=5);for(var o=[],h=0;h<=r;h++)o.push(this.getPointAt(h/r));return o},getLength:function(){var r=this.getLengths();return r[r.length-1]},getLengths:function(r){if(r===void 0&&(r=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===r+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var o=[],h,u=this.getPoint(0),g,y=0;for(o.push(0),g=1;g<=r;g++)h=this.getPoint(g/r),y+=h.distanceTo(u),o.push(y),u=h;return this.cacheArcLengths=o,o},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(r,o){var h=this.getLengths(),u=0,g=h.length,y;o?y=o:y=r*h[g-1];for(var T=0,I=g-1,D;T<=I;)if(u=Math.floor(T+(I-T)/2),D=h[u]-y,D<0)T=u+1;else if(D>0)I=u-1;else{I=u;break}if(u=I,h[u]===y)return u/(g-1);var N=h[u],A=h[u+1],B=A-N,F=(y-N)/B,G=(u+F)/(g-1);return G},getTangent:function(r){var o=1e-4,h=r-o,u=r+o;h<0&&(h=0),u>1&&(u=1);var g=this.getPoint(h),y=this.getPoint(u),T=y.clone().sub(g);return T.normalize()},getTangentAt:function(r){var o=this.getUtoTmapping(r);return this.getTangent(o)},computeFrenetFrames:function(r,o){var h=new he,u=[],g=[],y=[],T=new he,I=new Ot,D,N,A;for(D=0;D<=r;D++)N=D/r,u[D]=this.getTangentAt(N),u[D].normalize();g[0]=new he,y[0]=new he;var B=Number.MAX_VALUE,F=Math.abs(u[0].x),G=Math.abs(u[0].y),j=Math.abs(u[0].z);for(F<=B&&(B=F,h.set(1,0,0)),G<=B&&(B=G,h.set(0,1,0)),j<=B&&h.set(0,0,1),T.crossVectors(u[0],h).normalize(),g[0].crossVectors(u[0],T),y[0].crossVectors(u[0],g[0]),D=1;D<=r;D++)g[D]=g[D-1].clone(),y[D]=y[D-1].clone(),T.crossVectors(u[D-1],u[D]),T.length()>Number.EPSILON&&(T.normalize(),A=Math.acos(si.clamp(u[D-1].dot(u[D]),-1,1)),g[D].applyMatrix4(I.makeRotationAxis(T,A))),y[D].crossVectors(u[D],g[D]);if(o===!0)for(A=Math.acos(si.clamp(g[0].dot(g[r]),-1,1)),A/=r,u[0].dot(T.crossVectors(g[0],g[r]))>0&&(A=-A),D=1;D<=r;D++)g[D].applyMatrix4(I.makeRotationAxis(u[D],A*D)),y[D].crossVectors(u[D],g[D]);return{tangents:u,normals:g,binormals:y}},clone:function(){return new this.constructor().copy(this)},copy:function(r){return this.arcLengthDivisions=r.arcLengthDivisions,this},toJSON:function(){var r={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return r.arcLengthDivisions=this.arcLengthDivisions,r.type=this.type,r},fromJSON:function(r){return this.arcLengthDivisions=r.arcLengthDivisions,this}});function yr(r,o,h,u,g,y,T,I){zt.call(this),this.type="EllipseCurve",this.aX=r||0,this.aY=o||0,this.xRadius=h||1,this.yRadius=u||1,this.aStartAngle=g||0,this.aEndAngle=y||2*Math.PI,this.aClockwise=T||!1,this.aRotation=I||0}yr.prototype=Object.create(zt.prototype),yr.prototype.constructor=yr,yr.prototype.isEllipseCurve=!0,yr.prototype.getPoint=function(r,o){for(var h=o||new rt,u=Math.PI*2,g=this.aEndAngle-this.aStartAngle,y=Math.abs(g)<Number.EPSILON;g<0;)g+=u;for(;g>u;)g-=u;g<Number.EPSILON&&(y?g=0:g=u),this.aClockwise===!0&&!y&&(g===u?g=-u:g=g-u);var T=this.aStartAngle+r*g,I=this.aX+this.xRadius*Math.cos(T),D=this.aY+this.yRadius*Math.sin(T);if(this.aRotation!==0){var N=Math.cos(this.aRotation),A=Math.sin(this.aRotation),B=I-this.aX,F=D-this.aY;I=B*N-F*A+this.aX,D=B*A+F*N+this.aY}return h.set(I,D)},yr.prototype.copy=function(r){return zt.prototype.copy.call(this,r),this.aX=r.aX,this.aY=r.aY,this.xRadius=r.xRadius,this.yRadius=r.yRadius,this.aStartAngle=r.aStartAngle,this.aEndAngle=r.aEndAngle,this.aClockwise=r.aClockwise,this.aRotation=r.aRotation,this},yr.prototype.toJSON=function(){var r=zt.prototype.toJSON.call(this);return r.aX=this.aX,r.aY=this.aY,r.xRadius=this.xRadius,r.yRadius=this.yRadius,r.aStartAngle=this.aStartAngle,r.aEndAngle=this.aEndAngle,r.aClockwise=this.aClockwise,r.aRotation=this.aRotation,r},yr.prototype.fromJSON=function(r){return zt.prototype.fromJSON.call(this,r),this.aX=r.aX,this.aY=r.aY,this.xRadius=r.xRadius,this.yRadius=r.yRadius,this.aStartAngle=r.aStartAngle,this.aEndAngle=r.aEndAngle,this.aClockwise=r.aClockwise,this.aRotation=r.aRotation,this};function Xo(r,o,h,u,g,y){yr.call(this,r,o,h,h,u,g,y),this.type="ArcCurve"}Xo.prototype=Object.create(yr.prototype),Xo.prototype.constructor=Xo,Xo.prototype.isArcCurve=!0;function iu(){var r=0,o=0,h=0,u=0;function g(y,T,I,D){r=y,o=I,h=-3*y+3*T-2*I-D,u=2*y-2*T+I+D}return{initCatmullRom:function(y,T,I,D,N){g(T,I,N*(I-y),N*(D-T))},initNonuniformCatmullRom:function(y,T,I,D,N,A,B){var F=(T-y)/N-(I-y)/(N+A)+(I-T)/A,G=(I-T)/A-(D-T)/(A+B)+(D-I)/B;F*=A,G*=A,g(T,I,F,G)},calc:function(y){var T=y*y,I=T*y;return r+o*y+h*T+u*I}}}var Lh=new he,nu=new iu,ru=new iu,su=new iu;function jn(r,o,h,u){zt.call(this),this.type="CatmullRomCurve3",this.points=r||[],this.closed=o||!1,this.curveType=h||"centripetal",this.tension=u||.5}jn.prototype=Object.create(zt.prototype),jn.prototype.constructor=jn,jn.prototype.isCatmullRomCurve3=!0,jn.prototype.getPoint=function(r,o){var h=o||new he,u=this.points,g=u.length,y=(g-(this.closed?0:1))*r,T=Math.floor(y),I=y-T;this.closed?T+=T>0?0:(Math.floor(Math.abs(T)/g)+1)*g:I===0&&T===g-1&&(T=g-2,I=1);var D,N,A,B;if(this.closed||T>0?D=u[(T-1)%g]:(Lh.subVectors(u[0],u[1]).add(u[0]),D=Lh),N=u[T%g],A=u[(T+1)%g],this.closed||T+2<g?B=u[(T+2)%g]:(Lh.subVectors(u[g-1],u[g-2]).add(u[g-1]),B=Lh),this.curveType==="centripetal"||this.curveType==="chordal"){var F=this.curveType==="chordal"?.5:.25,G=Math.pow(D.distanceToSquared(N),F),j=Math.pow(N.distanceToSquared(A),F),$=Math.pow(A.distanceToSquared(B),F);j<1e-4&&(j=1),G<1e-4&&(G=j),$<1e-4&&($=j),nu.initNonuniformCatmullRom(D.x,N.x,A.x,B.x,G,j,$),ru.initNonuniformCatmullRom(D.y,N.y,A.y,B.y,G,j,$),su.initNonuniformCatmullRom(D.z,N.z,A.z,B.z,G,j,$)}else this.curveType==="catmullrom"&&(nu.initCatmullRom(D.x,N.x,A.x,B.x,this.tension),ru.initCatmullRom(D.y,N.y,A.y,B.y,this.tension),su.initCatmullRom(D.z,N.z,A.z,B.z,this.tension));return h.set(nu.calc(I),ru.calc(I),su.calc(I)),h},jn.prototype.copy=function(r){zt.prototype.copy.call(this,r),this.points=[];for(var o=0,h=r.points.length;o<h;o++){var u=r.points[o];this.points.push(u.clone())}return this.closed=r.closed,this.curveType=r.curveType,this.tension=r.tension,this},jn.prototype.toJSON=function(){var r=zt.prototype.toJSON.call(this);r.points=[];for(var o=0,h=this.points.length;o<h;o++){var u=this.points[o];r.points.push(u.toArray())}return r.closed=this.closed,r.curveType=this.curveType,r.tension=this.tension,r},jn.prototype.fromJSON=function(r){zt.prototype.fromJSON.call(this,r),this.points=[];for(var o=0,h=r.points.length;o<h;o++){var u=r.points[o];this.points.push(new he().fromArray(u))}return this.closed=r.closed,this.curveType=r.curveType,this.tension=r.tension,this};function Uu(r,o,h,u,g){var y=(u-o)*.5,T=(g-h)*.5,I=r*r,D=r*I;return(2*h-2*u+y+T)*D+(-3*h+3*u-2*y-T)*I+y*r+h}function yp(r,o){var h=1-r;return h*h*o}function Sp(r,o){return 2*(1-r)*r*o}function bp(r,o){return r*r*o}function $l(r,o,h,u){return yp(r,o)+Sp(r,h)+bp(r,u)}function Cp(r,o){var h=1-r;return h*h*h*o}function wp(r,o){var h=1-r;return 3*h*h*r*o}function Tp(r,o){return 3*(1-r)*r*r*o}function Ep(r,o){return r*r*r*o}function Ql(r,o,h,u,g){return Cp(r,o)+wp(r,h)+Tp(r,u)+Ep(r,g)}function Yr(r,o,h,u){zt.call(this),this.type="CubicBezierCurve",this.v0=r||new rt,this.v1=o||new rt,this.v2=h||new rt,this.v3=u||new rt}Yr.prototype=Object.create(zt.prototype),Yr.prototype.constructor=Yr,Yr.prototype.isCubicBezierCurve=!0,Yr.prototype.getPoint=function(r,o){var h=o||new rt,u=this.v0,g=this.v1,y=this.v2,T=this.v3;return h.set(Ql(r,u.x,g.x,y.x,T.x),Ql(r,u.y,g.y,y.y,T.y)),h},Yr.prototype.copy=function(r){return zt.prototype.copy.call(this,r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this.v3.copy(r.v3),this},Yr.prototype.toJSON=function(){var r=zt.prototype.toJSON.call(this);return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r.v3=this.v3.toArray(),r},Yr.prototype.fromJSON=function(r){return zt.prototype.fromJSON.call(this,r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this.v3.fromArray(r.v3),this};function Cs(r,o,h,u){zt.call(this),this.type="CubicBezierCurve3",this.v0=r||new he,this.v1=o||new he,this.v2=h||new he,this.v3=u||new he}Cs.prototype=Object.create(zt.prototype),Cs.prototype.constructor=Cs,Cs.prototype.isCubicBezierCurve3=!0,Cs.prototype.getPoint=function(r,o){var h=o||new he,u=this.v0,g=this.v1,y=this.v2,T=this.v3;return h.set(Ql(r,u.x,g.x,y.x,T.x),Ql(r,u.y,g.y,y.y,T.y),Ql(r,u.z,g.z,y.z,T.z)),h},Cs.prototype.copy=function(r){return zt.prototype.copy.call(this,r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this.v3.copy(r.v3),this},Cs.prototype.toJSON=function(){var r=zt.prototype.toJSON.call(this);return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r.v3=this.v3.toArray(),r},Cs.prototype.fromJSON=function(r){return zt.prototype.fromJSON.call(this,r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this.v3.fromArray(r.v3),this};function lr(r,o){zt.call(this),this.type="LineCurve",this.v1=r||new rt,this.v2=o||new rt}lr.prototype=Object.create(zt.prototype),lr.prototype.constructor=lr,lr.prototype.isLineCurve=!0,lr.prototype.getPoint=function(r,o){var h=o||new rt;return r===1?h.copy(this.v2):(h.copy(this.v2).sub(this.v1),h.multiplyScalar(r).add(this.v1)),h},lr.prototype.getPointAt=function(r,o){return this.getPoint(r,o)},lr.prototype.getTangent=function(){var r=this.v2.clone().sub(this.v1);return r.normalize()},lr.prototype.copy=function(r){return zt.prototype.copy.call(this,r),this.v1.copy(r.v1),this.v2.copy(r.v2),this},lr.prototype.toJSON=function(){var r=zt.prototype.toJSON.call(this);return r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r},lr.prototype.fromJSON=function(r){return zt.prototype.fromJSON.call(this,r),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this};function Jr(r,o){zt.call(this),this.type="LineCurve3",this.v1=r||new he,this.v2=o||new he}Jr.prototype=Object.create(zt.prototype),Jr.prototype.constructor=Jr,Jr.prototype.isLineCurve3=!0,Jr.prototype.getPoint=function(r,o){var h=o||new he;return r===1?h.copy(this.v2):(h.copy(this.v2).sub(this.v1),h.multiplyScalar(r).add(this.v1)),h},Jr.prototype.getPointAt=function(r,o){return this.getPoint(r,o)},Jr.prototype.copy=function(r){return zt.prototype.copy.call(this,r),this.v1.copy(r.v1),this.v2.copy(r.v2),this},Jr.prototype.toJSON=function(){var r=zt.prototype.toJSON.call(this);return r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r},Jr.prototype.fromJSON=function(r){return zt.prototype.fromJSON.call(this,r),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this};function $r(r,o,h){zt.call(this),this.type="QuadraticBezierCurve",this.v0=r||new rt,this.v1=o||new rt,this.v2=h||new rt}$r.prototype=Object.create(zt.prototype),$r.prototype.constructor=$r,$r.prototype.isQuadraticBezierCurve=!0,$r.prototype.getPoint=function(r,o){var h=o||new rt,u=this.v0,g=this.v1,y=this.v2;return h.set($l(r,u.x,g.x,y.x),$l(r,u.y,g.y,y.y)),h},$r.prototype.copy=function(r){return zt.prototype.copy.call(this,r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this},$r.prototype.toJSON=function(){var r=zt.prototype.toJSON.call(this);return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r},$r.prototype.fromJSON=function(r){return zt.prototype.fromJSON.call(this,r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this};function ws(r,o,h){zt.call(this),this.type="QuadraticBezierCurve3",this.v0=r||new he,this.v1=o||new he,this.v2=h||new he}ws.prototype=Object.create(zt.prototype),ws.prototype.constructor=ws,ws.prototype.isQuadraticBezierCurve3=!0,ws.prototype.getPoint=function(r,o){var h=o||new he,u=this.v0,g=this.v1,y=this.v2;return h.set($l(r,u.x,g.x,y.x),$l(r,u.y,g.y,y.y),$l(r,u.z,g.z,y.z)),h},ws.prototype.copy=function(r){return zt.prototype.copy.call(this,r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this},ws.prototype.toJSON=function(){var r=zt.prototype.toJSON.call(this);return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r},ws.prototype.fromJSON=function(r){return zt.prototype.fromJSON.call(this,r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this};function Qr(r){zt.call(this),this.type="SplineCurve",this.points=r||[]}Qr.prototype=Object.create(zt.prototype),Qr.prototype.constructor=Qr,Qr.prototype.isSplineCurve=!0,Qr.prototype.getPoint=function(r,o){var h=o||new rt,u=this.points,g=(u.length-1)*r,y=Math.floor(g),T=g-y,I=u[y===0?y:y-1],D=u[y],N=u[y>u.length-2?u.length-1:y+1],A=u[y>u.length-3?u.length-1:y+2];return h.set(Uu(T,I.x,D.x,N.x,A.x),Uu(T,I.y,D.y,N.y,A.y)),h},Qr.prototype.copy=function(r){zt.prototype.copy.call(this,r),this.points=[];for(var o=0,h=r.points.length;o<h;o++){var u=r.points[o];this.points.push(u.clone())}return this},Qr.prototype.toJSON=function(){var r=zt.prototype.toJSON.call(this);r.points=[];for(var o=0,h=this.points.length;o<h;o++){var u=this.points[o];r.points.push(u.toArray())}return r},Qr.prototype.fromJSON=function(r){zt.prototype.fromJSON.call(this,r),this.points=[];for(var o=0,h=r.points.length;o<h;o++){var u=r.points[o];this.points.push(new rt().fromArray(u))}return this};var zu=Object.freeze({ArcCurve:Xo,CatmullRomCurve3:jn,CubicBezierCurve:Yr,CubicBezierCurve3:Cs,EllipseCurve:yr,LineCurve:lr,LineCurve3:Jr,QuadraticBezierCurve:$r,QuadraticBezierCurve3:ws,SplineCurve:Qr});function Ys(){zt.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}Ys.prototype=Object.assign(Object.create(zt.prototype),{constructor:Ys,add:function(r){this.curves.push(r)},closePath:function(){var r=this.curves[0].getPoint(0),o=this.curves[this.curves.length-1].getPoint(1);r.equals(o)||this.curves.push(new lr(o,r))},getPoint:function(r){for(var o=r*this.getLength(),h=this.getCurveLengths(),u=0;u<h.length;){if(h[u]>=o){var g=h[u]-o,y=this.curves[u],T=y.getLength(),I=T===0?0:1-g/T;return y.getPointAt(I)}u++}return null},getLength:function(){var r=this.getCurveLengths();return r[r.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var r=[],o=0,h=0,u=this.curves.length;h<u;h++)o+=this.curves[h].getLength(),r.push(o);return this.cacheLengths=r,r},getSpacedPoints:function(r){r===void 0&&(r=40);for(var o=[],h=0;h<=r;h++)o.push(this.getPoint(h/r));return this.autoClose&&o.push(o[0]),o},getPoints:function(r){r=r||12;for(var o=[],h,u=0,g=this.curves;u<g.length;u++)for(var y=g[u],T=y&&y.isEllipseCurve?r*2:y&&(y.isLineCurve||y.isLineCurve3)?1:y&&y.isSplineCurve?r*y.points.length:r,I=y.getPoints(T),D=0;D<I.length;D++){var N=I[D];h&&h.equals(N)||(o.push(N),h=N)}return this.autoClose&&o.length>1&&!o[o.length-1].equals(o[0])&&o.push(o[0]),o},copy:function(r){zt.prototype.copy.call(this,r),this.curves=[];for(var o=0,h=r.curves.length;o<h;o++){var u=r.curves[o];this.curves.push(u.clone())}return this.autoClose=r.autoClose,this},toJSON:function(){var r=zt.prototype.toJSON.call(this);r.autoClose=this.autoClose,r.curves=[];for(var o=0,h=this.curves.length;o<h;o++){var u=this.curves[o];r.curves.push(u.toJSON())}return r},fromJSON:function(r){zt.prototype.fromJSON.call(this,r),this.autoClose=r.autoClose,this.curves=[];for(var o=0,h=r.curves.length;o<h;o++){var u=r.curves[o];this.curves.push(new zu[u.type]().fromJSON(u))}return this}});function Zr(r){Ys.call(this),this.type="Path",this.currentPoint=new rt,r&&this.setFromPoints(r)}Zr.prototype=Object.assign(Object.create(Ys.prototype),{constructor:Zr,setFromPoints:function(r){this.moveTo(r[0].x,r[0].y);for(var o=1,h=r.length;o<h;o++)this.lineTo(r[o].x,r[o].y)},moveTo:function(r,o){this.currentPoint.set(r,o)},lineTo:function(r,o){var h=new lr(this.currentPoint.clone(),new rt(r,o));this.curves.push(h),this.currentPoint.set(r,o)},quadraticCurveTo:function(r,o,h,u){var g=new $r(this.currentPoint.clone(),new rt(r,o),new rt(h,u));this.curves.push(g),this.currentPoint.set(h,u)},bezierCurveTo:function(r,o,h,u,g,y){var T=new Yr(this.currentPoint.clone(),new rt(r,o),new rt(h,u),new rt(g,y));this.curves.push(T),this.currentPoint.set(g,y)},splineThru:function(r){var o=[this.currentPoint.clone()].concat(r),h=new Qr(o);this.curves.push(h),this.currentPoint.copy(r[r.length-1])},arc:function(r,o,h,u,g,y){var T=this.currentPoint.x,I=this.currentPoint.y;this.absarc(r+T,o+I,h,u,g,y)},absarc:function(r,o,h,u,g,y){this.absellipse(r,o,h,h,u,g,y)},ellipse:function(r,o,h,u,g,y,T,I){var D=this.currentPoint.x,N=this.currentPoint.y;this.absellipse(r+D,o+N,h,u,g,y,T,I)},absellipse:function(r,o,h,u,g,y,T,I){var D=new yr(r,o,h,u,g,y,T,I);if(this.curves.length>0){var N=D.getPoint(0);N.equals(this.currentPoint)||this.lineTo(N.x,N.y)}this.curves.push(D);var A=D.getPoint(1);this.currentPoint.copy(A)},copy:function(r){return Ys.prototype.copy.call(this,r),this.currentPoint.copy(r.currentPoint),this},toJSON:function(){var r=Ys.prototype.toJSON.call(this);return r.currentPoint=this.currentPoint.toArray(),r},fromJSON:function(r){return Ys.prototype.fromJSON.call(this,r),this.currentPoint.fromArray(r.currentPoint),this}});function Ta(r){Zr.call(this,r),this.uuid=si.generateUUID(),this.type="Shape",this.holes=[]}Ta.prototype=Object.assign(Object.create(Zr.prototype),{constructor:Ta,getPointsHoles:function(r){for(var o=[],h=0,u=this.holes.length;h<u;h++)o[h]=this.holes[h].getPoints(r);return o},extractPoints:function(r){return{shape:this.getPoints(r),holes:this.getPointsHoles(r)}},copy:function(r){Zr.prototype.copy.call(this,r),this.holes=[];for(var o=0,h=r.holes.length;o<h;o++){var u=r.holes[o];this.holes.push(u.clone())}return this},toJSON:function(){var r=Zr.prototype.toJSON.call(this);r.uuid=this.uuid,r.holes=[];for(var o=0,h=this.holes.length;o<h;o++){var u=this.holes[o];r.holes.push(u.toJSON())}return r},fromJSON:function(r){Zr.prototype.fromJSON.call(this,r),this.uuid=r.uuid,this.holes=[];for(var o=0,h=r.holes.length;o<h;o++){var u=r.holes[o];this.holes.push(new Zr().fromJSON(u))}return this}});function hn(r,o){vt.call(this),this.type="Light",this.color=new Mt(r),this.intensity=o!==void 0?o:1,this.receiveShadow=void 0}hn.prototype=Object.assign(Object.create(vt.prototype),{constructor:hn,isLight:!0,copy:function(r){return vt.prototype.copy.call(this,r),this.color.copy(r.color),this.intensity=r.intensity,this},toJSON:function(r){var o=vt.prototype.toJSON.call(this,r);return o.object.color=this.color.getHex(),o.object.intensity=this.intensity,this.groundColor!==void 0&&(o.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(o.object.distance=this.distance),this.angle!==void 0&&(o.object.angle=this.angle),this.decay!==void 0&&(o.object.decay=this.decay),this.penumbra!==void 0&&(o.object.penumbra=this.penumbra),this.shadow!==void 0&&(o.object.shadow=this.shadow.toJSON()),o}});function Nh(r,o,h){hn.call(this,r,h),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(vt.DefaultUp),this.updateMatrix(),this.groundColor=new Mt(o)}Nh.prototype=Object.assign(Object.create(hn.prototype),{constructor:Nh,isHemisphereLight:!0,copy:function(r){return hn.prototype.copy.call(this,r),this.groundColor.copy(r.groundColor),this}});function mo(r){this.camera=r,this.bias=0,this.radius=1,this.mapSize=new rt(512,512),this.map=null,this.matrix=new Ot}Object.assign(mo.prototype,{copy:function(r){return this.camera=r.camera.clone(),this.bias=r.bias,this.radius=r.radius,this.mapSize.copy(r.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var r={};return this.bias!==0&&(r.bias=this.bias),this.radius!==1&&(r.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(r.mapSize=this.mapSize.toArray()),r.camera=this.camera.toJSON(!1).object,delete r.camera.matrix,r}});function Ph(){mo.call(this,new nn(50,1,.5,500))}Ph.prototype=Object.assign(Object.create(mo.prototype),{constructor:Ph,isSpotLightShadow:!0,update:function(r){var o=this.camera,h=si.RAD2DEG*2*r.angle,u=this.mapSize.width/this.mapSize.height,g=r.distance||o.far;(h!==o.fov||u!==o.aspect||g!==o.far)&&(o.fov=h,o.aspect=u,o.far=g,o.updateProjectionMatrix())}});function Ah(r,o,h,u,g,y){hn.call(this,r,o),this.type="SpotLight",this.position.copy(vt.DefaultUp),this.updateMatrix(),this.target=new vt,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(T){this.intensity=T/Math.PI}}),this.distance=h!==void 0?h:0,this.angle=u!==void 0?u:Math.PI/3,this.penumbra=g!==void 0?g:0,this.decay=y!==void 0?y:1,this.shadow=new Ph}Ah.prototype=Object.assign(Object.create(hn.prototype),{constructor:Ah,isSpotLight:!0,copy:function(r){return hn.prototype.copy.call(this,r),this.distance=r.distance,this.angle=r.angle,this.penumbra=r.penumbra,this.decay=r.decay,this.target=r.target.clone(),this.shadow=r.shadow.clone(),this}});function Bh(r,o,h,u){hn.call(this,r,o),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return this.intensity*4*Math.PI},set:function(g){this.intensity=g/(4*Math.PI)}}),this.distance=h!==void 0?h:0,this.decay=u!==void 0?u:1,this.shadow=new mo(new nn(90,1,.5,500))}Bh.prototype=Object.assign(Object.create(hn.prototype),{constructor:Bh,isPointLight:!0,copy:function(r){return hn.prototype.copy.call(this,r),this.distance=r.distance,this.decay=r.decay,this.shadow=r.shadow.clone(),this}});function Fh(){mo.call(this,new sa(-5,5,5,-5,.5,500))}Fh.prototype=Object.assign(Object.create(mo.prototype),{constructor:Fh});function Oh(r,o){hn.call(this,r,o),this.type="DirectionalLight",this.position.copy(vt.DefaultUp),this.updateMatrix(),this.target=new vt,this.shadow=new Fh}Oh.prototype=Object.assign(Object.create(hn.prototype),{constructor:Oh,isDirectionalLight:!0,copy:function(r){return hn.prototype.copy.call(this,r),this.target=r.target.clone(),this.shadow=r.shadow.clone(),this}});function Vh(r,o){hn.call(this,r,o),this.type="AmbientLight",this.castShadow=void 0}Vh.prototype=Object.assign(Object.create(hn.prototype),{constructor:Vh,isAmbientLight:!0});function Uh(r,o,h,u){hn.call(this,r,o),this.type="RectAreaLight",this.width=h!==void 0?h:10,this.height=u!==void 0?u:10}Uh.prototype=Object.assign(Object.create(hn.prototype),{constructor:Uh,isRectAreaLight:!0,copy:function(r){return hn.prototype.copy.call(this,r),this.width=r.width,this.height=r.height,this},toJSON:function(r){var o=hn.prototype.toJSON.call(this,r);return o.object.width=this.width,o.object.height=this.height,o}});function zh(r,o,h,u){xn.call(this,r,o,h,u)}zh.prototype=Object.assign(Object.create(xn.prototype),{constructor:zh,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Ln,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function Gh(r,o,h){xn.call(this,r,o,h)}Gh.prototype=Object.assign(Object.create(xn.prototype),{constructor:Gh,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Ln,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function Sr(r,o,h,u){this.parameterPositions=r,this._cachedIndex=0,this.resultBuffer=u!==void 0?u:new o.constructor(h),this.sampleValues=o,this.valueSize=h}Object.assign(Sr.prototype,{evaluate:function(r){var o=this.parameterPositions,h=this._cachedIndex,u=o[h],g=o[h-1];e:{t:{var y;i:{n:if(!(r<u)){for(var T=h+2;;){if(u===void 0){if(r<g)break n;return h=o.length,this._cachedIndex=h,this.afterEnd_(h-1,r,g)}if(h===T)break;if(g=u,u=o[++h],r<u)break t}y=o.length;break i}if(!(r>=g)){var I=o[1];r<I&&(h=2,g=I);for(var T=h-2;;){if(g===void 0)return this._cachedIndex=0,this.beforeStart_(0,r,u);if(h===T)break;if(u=g,g=o[--h-1],r>=g)break t}y=h,h=0;break i}break e}for(;h<y;){var D=h+y>>>1;r<o[D]?y=D:h=D+1}if(u=o[h],g=o[h-1],g===void 0)return this._cachedIndex=0,this.beforeStart_(0,r,u);if(u===void 0)return h=o.length,this._cachedIndex=h,this.afterEnd_(h-1,g,r)}this._cachedIndex=h,this.intervalChanged_(h,g,u)}return this.interpolate_(h,g,r,u)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(r){for(var o=this.resultBuffer,h=this.sampleValues,u=this.valueSize,g=r*u,y=0;y!==u;++y)o[y]=h[g+y];return o},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}});Object.assign(Sr.prototype,{beforeStart_:Sr.prototype.copySampleValue_,afterEnd_:Sr.prototype.copySampleValue_});function Hh(r,o,h,u){Sr.call(this,r,o,h,u)}Hh.prototype=Object.assign(Object.create(Sr.prototype),{constructor:Hh,interpolate_:function(r,o,h,u){for(var g=this.resultBuffer,y=this.sampleValues,T=this.valueSize,I=r*T,D=(h-o)/(u-o),N=I+T;I!==N;I+=4)en.slerpFlat(g,0,y,I-T,y,I,D);return g}});function Zl(r,o,h,u){xn.call(this,r,o,h,u)}Zl.prototype=Object.assign(Object.create(xn.prototype),{constructor:Zl,ValueTypeName:"quaternion",DefaultInterpolation:Oi,InterpolantFactoryMethodLinear:function(r){return new Hh(this.times,this.values,this.getValueSize(),r)},InterpolantFactoryMethodSmooth:void 0});function Wh(r,o,h,u){xn.call(this,r,o,h,u)}Wh.prototype=Object.assign(Object.create(xn.prototype),{constructor:Wh,ValueTypeName:"color"});function Yo(r,o,h,u){xn.call(this,r,o,h,u)}Yo.prototype=Object.assign(Object.create(xn.prototype),{constructor:Yo,ValueTypeName:"number"});function jh(r,o,h,u){Sr.call(this,r,o,h,u),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}jh.prototype=Object.assign(Object.create(Sr.prototype),{constructor:jh,DefaultSettings_:{endingStart:ns,endingEnd:ns},intervalChanged_:function(r,o,h){var u=this.parameterPositions,g=r-2,y=r+1,T=u[g],I=u[y];if(T===void 0)switch(this.getSettings_().endingStart){case _n:g=r,T=2*o-h;break;case Er:g=u.length-2,T=o+u[g]-u[g+1];break;default:g=r,T=h}if(I===void 0)switch(this.getSettings_().endingEnd){case _n:y=r,I=2*h-o;break;case Er:y=1,I=h+u[1]-u[0];break;default:y=r-1,I=o}var D=(h-o)*.5,N=this.valueSize;this._weightPrev=D/(o-T),this._weightNext=D/(I-h),this._offsetPrev=g*N,this._offsetNext=y*N},interpolate_:function(r,o,h,u){for(var g=this.resultBuffer,y=this.sampleValues,T=this.valueSize,I=r*T,D=I-T,N=this._offsetPrev,A=this._offsetNext,B=this._weightPrev,F=this._weightNext,G=(h-o)/(u-o),j=G*G,$=j*G,Z=-B*$+2*B*j-B*G,Q=(1+B)*$+(-1.5-2*B)*j+(-.5+B)*G+1,ie=(-1-F)*$+(1.5+F)*j+.5*G,ne=F*$-F*j,ae=0;ae!==T;++ae)g[ae]=Z*y[N+ae]+Q*y[D+ae]+ie*y[I+ae]+ne*y[A+ae];return g}});function ed(r,o,h,u){Sr.call(this,r,o,h,u)}ed.prototype=Object.assign(Object.create(Sr.prototype),{constructor:ed,interpolate_:function(r,o,h,u){for(var g=this.resultBuffer,y=this.sampleValues,T=this.valueSize,I=r*T,D=I-T,N=(h-o)/(u-o),A=1-N,B=0;B!==T;++B)g[B]=y[D+B]*A+y[I+B]*N;return g}});function qh(r,o,h,u){Sr.call(this,r,o,h,u)}qh.prototype=Object.assign(Object.create(Sr.prototype),{constructor:qh,interpolate_:function(r){return this.copySampleValue_(r-1)}});var qn={arraySlice:function(r,o,h){return qn.isTypedArray(r)?new r.constructor(r.subarray(o,h!==void 0?h:r.length)):r.slice(o,h)},convertArray:function(r,o,h){return!r||!h&&r.constructor===o?r:typeof o.BYTES_PER_ELEMENT=="number"?new o(r):Array.prototype.slice.call(r)},isTypedArray:function(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)},getKeyframeOrder:function(r){function o(y,T){return r[y]-r[T]}for(var h=r.length,u=new Array(h),g=0;g!==h;++g)u[g]=g;return u.sort(o),u},sortedArray:function(r,o,h){for(var u=r.length,g=new r.constructor(u),y=0,T=0;T!==u;++y)for(var I=h[y]*o,D=0;D!==o;++D)g[T++]=r[I+D];return g},flattenJSON:function(r,o,h,u){for(var g=1,y=r[0];y!==void 0&&y[u]===void 0;)y=r[g++];if(y!==void 0){var T=y[u];if(T!==void 0)if(Array.isArray(T))do T=y[u],T!==void 0&&(o.push(y.time),h.push.apply(h,T)),y=r[g++];while(y!==void 0);else if(T.toArray!==void 0)do T=y[u],T!==void 0&&(o.push(y.time),T.toArray(h,h.length)),y=r[g++];while(y!==void 0);else do T=y[u],T!==void 0&&(o.push(y.time),h.push(T)),y=r[g++];while(y!==void 0)}}};function xn(r,o,h,u){if(r===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(o===void 0||o.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+r);this.name=r,this.times=qn.convertArray(o,this.TimeBufferType),this.values=qn.convertArray(h,this.ValueBufferType),this.setInterpolation(u||this.DefaultInterpolation),this.validate(),this.optimize()}Object.assign(xn,{parse:function(r){if(r.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var o=xn._getTrackTypeForValueTypeName(r.type);if(r.times===void 0){var h=[],u=[];qn.flattenJSON(r.keys,h,u,"value"),r.times=h,r.values=u}return o.parse!==void 0?o.parse(r):new o(r.name,r.times,r.values,r.interpolation)},toJSON:function(r){var o=r.constructor,h;if(o.toJSON!==void 0)h=o.toJSON(r);else{h={name:r.name,times:qn.convertArray(r.times,Array),values:qn.convertArray(r.values,Array)};var u=r.getInterpolation();u!==r.DefaultInterpolation&&(h.interpolation=u)}return h.type=r.ValueTypeName,h},_getTrackTypeForValueTypeName:function(r){switch(r.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Yo;case"vector":case"vector2":case"vector3":case"vector4":return Jo;case"color":return Wh;case"quaternion":return Zl;case"bool":case"boolean":return Gh;case"string":return zh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+r)}}),Object.assign(xn.prototype,{constructor:xn,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Oi,InterpolantFactoryMethodDiscrete:function(r){return new qh(this.times,this.values,this.getValueSize(),r)},InterpolantFactoryMethodLinear:function(r){return new ed(this.times,this.values,this.getValueSize(),r)},InterpolantFactoryMethodSmooth:function(r){return new jh(this.times,this.values,this.getValueSize(),r)},setInterpolation:function(r){var o;switch(r){case Ln:o=this.InterpolantFactoryMethodDiscrete;break;case Oi:o=this.InterpolantFactoryMethodLinear;break;case Ji:o=this.InterpolantFactoryMethodSmooth;break}if(o===void 0){var h="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(r!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(h);console.warn("THREE.KeyframeTrack:",h);return}this.createInterpolant=o},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ln;case this.InterpolantFactoryMethodLinear:return Oi;case this.InterpolantFactoryMethodSmooth:return Ji}},getValueSize:function(){return this.values.length/this.times.length},shift:function(r){if(r!==0)for(var o=this.times,h=0,u=o.length;h!==u;++h)o[h]+=r;return this},scale:function(r){if(r!==1)for(var o=this.times,h=0,u=o.length;h!==u;++h)o[h]*=r;return this},trim:function(r,o){for(var h=this.times,u=h.length,g=0,y=u-1;g!==u&&h[g]<r;)++g;for(;y!==-1&&h[y]>o;)--y;if(++y,g!==0||y!==u){g>=y&&(y=Math.max(y,1),g=y-1);var T=this.getValueSize();this.times=qn.arraySlice(h,g,y),this.values=qn.arraySlice(this.values,g*T,y*T)}return this},validate:function(){var r=!0,o=this.getValueSize();o-Math.floor(o)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),r=!1);var h=this.times,u=this.values,g=h.length;g===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),r=!1);for(var y=null,T=0;T!==g;T++){var I=h[T];if(typeof I=="number"&&isNaN(I)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,T,I),r=!1;break}if(y!==null&&y>I){console.error("THREE.KeyframeTrack: Out of order keys.",this,T,I,y),r=!1;break}y=I}if(u!==void 0&&qn.isTypedArray(u))for(var T=0,D=u.length;T!==D;++T){var N=u[T];if(isNaN(N)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,T,N),r=!1;break}}return r},optimize:function(){for(var r=this.times,o=this.values,h=this.getValueSize(),u=this.getInterpolation()===Ji,g=1,y=r.length-1,T=1;T<y;++T){var I=!1,D=r[T],N=r[T+1];if(D!==N&&(T!==1||D!==D[0]))if(u)I=!0;else for(var A=T*h,B=A-h,F=A+h,G=0;G!==h;++G){var j=o[A+G];if(j!==o[B+G]||j!==o[F+G]){I=!0;break}}if(I){if(T!==g){r[g]=r[T];for(var $=T*h,Z=g*h,G=0;G!==h;++G)o[Z+G]=o[$+G]}++g}}if(y>0){r[g]=r[y];for(var $=y*h,Z=g*h,G=0;G!==h;++G)o[Z+G]=o[$+G];++g}return g!==r.length&&(this.times=qn.arraySlice(r,0,g),this.values=qn.arraySlice(o,0,g*h)),this}});function Jo(r,o,h,u){xn.call(this,r,o,h,u)}Jo.prototype=Object.assign(Object.create(xn.prototype),{constructor:Jo,ValueTypeName:"vector"});function Dr(r,o,h){this.name=r,this.tracks=h,this.duration=o!==void 0?o:-1,this.uuid=si.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}Object.assign(Dr,{parse:function(r){for(var o=[],h=r.tracks,u=1/(r.fps||1),g=0,y=h.length;g!==y;++g)o.push(xn.parse(h[g]).scale(u));return new Dr(r.name,r.duration,o)},toJSON:function(r){for(var o=[],h=r.tracks,u={name:r.name,duration:r.duration,tracks:o,uuid:r.uuid},g=0,y=h.length;g!==y;++g)o.push(xn.toJSON(h[g]));return u},CreateFromMorphTargetSequence:function(r,o,h,u){for(var g=o.length,y=[],T=0;T<g;T++){var I=[],D=[];I.push((T+g-1)%g,T,(T+1)%g),D.push(0,1,0);var N=qn.getKeyframeOrder(I);I=qn.sortedArray(I,1,N),D=qn.sortedArray(D,1,N),!u&&I[0]===0&&(I.push(g),D.push(D[0])),y.push(new Yo(".morphTargetInfluences["+o[T].name+"]",I,D).scale(1/h))}return new Dr(r,-1,y)},findByName:function(r,o){var h=r;if(!Array.isArray(r)){var u=r;h=u.geometry&&u.geometry.animations||u.animations}for(var g=0;g<h.length;g++)if(h[g].name===o)return h[g];return null},CreateClipsFromMorphTargetSequences:function(r,o,h){for(var u={},g=/^([\w-]*?)([\d]+)$/,y=0,T=r.length;y<T;y++){var I=r[y],D=I.name.match(g);if(D&&D.length>1){var N=D[1],A=u[N];A||(u[N]=A=[]),A.push(I)}}var B=[];for(var N in u)B.push(Dr.CreateFromMorphTargetSequence(N,u[N],o,h));return B},parseAnimation:function(r,o){if(!r)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var h=function(ne,ae,ye,ge,be){if(ye.length!==0){var Ee=[],Se=[];qn.flattenJSON(ye,Ee,Se,ge),Ee.length!==0&&be.push(new ne(ae,Ee,Se))}},u=[],g=r.name||"default",y=r.length||-1,T=r.fps||30,I=r.hierarchy||[],D=0;D<I.length;D++){var N=I[D].keys;if(!(!N||N.length===0))if(N[0].morphTargets){for(var A={},B=0;B<N.length;B++)if(N[B].morphTargets)for(var F=0;F<N[B].morphTargets.length;F++)A[N[B].morphTargets[F]]=-1;for(var G in A){for(var j=[],$=[],F=0;F!==N[B].morphTargets.length;++F){var Z=N[B];j.push(Z.time),$.push(Z.morphTarget===G?1:0)}u.push(new Yo(".morphTargetInfluence["+G+"]",j,$))}y=A.length*(T||1)}else{var Q=".bones["+o[D].name+"]";h(Jo,Q+".position",N,"pos",u),h(Zl,Q+".quaternion",N,"rot",u),h(Jo,Q+".scale",N,"scl",u)}}if(u.length===0)return null;var ie=new Dr(g,y,u);return ie}}),Object.assign(Dr.prototype,{resetDuration:function(){for(var r=this.tracks,o=0,h=0,u=r.length;h!==u;++h){var g=this.tracks[h];o=Math.max(o,g.times[g.times.length-1])}this.duration=o},trim:function(){for(var r=0;r<this.tracks.length;r++)this.tracks[r].trim(0,this.duration);return this},optimize:function(){for(var r=0;r<this.tracks.length;r++)this.tracks[r].optimize();return this}});function Kh(r){this.manager=r!==void 0?r:or,this.textures={}}Object.assign(Kh.prototype,{load:function(r,o,h,u){var g=this,y=new Xr(g.manager);y.load(r,function(T){o(g.parse(JSON.parse(T)))},h,u)},setTextures:function(r){this.textures=r},parse:function(r){var o=this.textures;function h(y){return o[y]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",y),o[y]}var u=new vp[r.type];if(r.uuid!==void 0&&(u.uuid=r.uuid),r.name!==void 0&&(u.name=r.name),r.color!==void 0&&u.color.setHex(r.color),r.roughness!==void 0&&(u.roughness=r.roughness),r.metalness!==void 0&&(u.metalness=r.metalness),r.emissive!==void 0&&u.emissive.setHex(r.emissive),r.specular!==void 0&&u.specular.setHex(r.specular),r.shininess!==void 0&&(u.shininess=r.shininess),r.clearCoat!==void 0&&(u.clearCoat=r.clearCoat),r.clearCoatRoughness!==void 0&&(u.clearCoatRoughness=r.clearCoatRoughness),r.uniforms!==void 0&&(u.uniforms=r.uniforms),r.vertexShader!==void 0&&(u.vertexShader=r.vertexShader),r.fragmentShader!==void 0&&(u.fragmentShader=r.fragmentShader),r.vertexColors!==void 0&&(u.vertexColors=r.vertexColors),r.fog!==void 0&&(u.fog=r.fog),r.flatShading!==void 0&&(u.flatShading=r.flatShading),r.blending!==void 0&&(u.blending=r.blending),r.side!==void 0&&(u.side=r.side),r.opacity!==void 0&&(u.opacity=r.opacity),r.transparent!==void 0&&(u.transparent=r.transparent),r.alphaTest!==void 0&&(u.alphaTest=r.alphaTest),r.depthTest!==void 0&&(u.depthTest=r.depthTest),r.depthWrite!==void 0&&(u.depthWrite=r.depthWrite),r.colorWrite!==void 0&&(u.colorWrite=r.colorWrite),r.wireframe!==void 0&&(u.wireframe=r.wireframe),r.wireframeLinewidth!==void 0&&(u.wireframeLinewidth=r.wireframeLinewidth),r.wireframeLinecap!==void 0&&(u.wireframeLinecap=r.wireframeLinecap),r.wireframeLinejoin!==void 0&&(u.wireframeLinejoin=r.wireframeLinejoin),r.rotation!==void 0&&(u.rotation=r.rotation),r.linewidth!==1&&(u.linewidth=r.linewidth),r.dashSize!==void 0&&(u.dashSize=r.dashSize),r.gapSize!==void 0&&(u.gapSize=r.gapSize),r.scale!==void 0&&(u.scale=r.scale),r.polygonOffset!==void 0&&(u.polygonOffset=r.polygonOffset),r.polygonOffsetFactor!==void 0&&(u.polygonOffsetFactor=r.polygonOffsetFactor),r.polygonOffsetUnits!==void 0&&(u.polygonOffsetUnits=r.polygonOffsetUnits),r.skinning!==void 0&&(u.skinning=r.skinning),r.morphTargets!==void 0&&(u.morphTargets=r.morphTargets),r.dithering!==void 0&&(u.dithering=r.dithering),r.visible!==void 0&&(u.visible=r.visible),r.userData!==void 0&&(u.userData=r.userData),r.shading!==void 0&&(u.flatShading=r.shading===1),r.size!==void 0&&(u.size=r.size),r.sizeAttenuation!==void 0&&(u.sizeAttenuation=r.sizeAttenuation),r.map!==void 0&&(u.map=h(r.map)),r.alphaMap!==void 0&&(u.alphaMap=h(r.alphaMap),u.transparent=!0),r.bumpMap!==void 0&&(u.bumpMap=h(r.bumpMap)),r.bumpScale!==void 0&&(u.bumpScale=r.bumpScale),r.normalMap!==void 0&&(u.normalMap=h(r.normalMap)),r.normalMapType!==void 0&&(u.normalMapType=r.normalMapType),r.normalScale!==void 0){var g=r.normalScale;Array.isArray(g)===!1&&(g=[g,g]),u.normalScale=new rt().fromArray(g)}return r.displacementMap!==void 0&&(u.displacementMap=h(r.displacementMap)),r.displacementScale!==void 0&&(u.displacementScale=r.displacementScale),r.displacementBias!==void 0&&(u.displacementBias=r.displacementBias),r.roughnessMap!==void 0&&(u.roughnessMap=h(r.roughnessMap)),r.metalnessMap!==void 0&&(u.metalnessMap=h(r.metalnessMap)),r.emissiveMap!==void 0&&(u.emissiveMap=h(r.emissiveMap)),r.emissiveIntensity!==void 0&&(u.emissiveIntensity=r.emissiveIntensity),r.specularMap!==void 0&&(u.specularMap=h(r.specularMap)),r.envMap!==void 0&&(u.envMap=h(r.envMap)),r.reflectivity!==void 0&&(u.reflectivity=r.reflectivity),r.lightMap!==void 0&&(u.lightMap=h(r.lightMap)),r.lightMapIntensity!==void 0&&(u.lightMapIntensity=r.lightMapIntensity),r.aoMap!==void 0&&(u.aoMap=h(r.aoMap)),r.aoMapIntensity!==void 0&&(u.aoMapIntensity=r.aoMapIntensity),r.gradientMap!==void 0&&(u.gradientMap=h(r.gradientMap)),u}});function au(r){this.manager=r!==void 0?r:or}Object.assign(au.prototype,{load:function(r,o,h,u){var g=this,y=new Xr(g.manager);y.load(r,function(T){o(g.parse(JSON.parse(T)))},h,u)},parse:function(r){var o=new Tt,h=r.data.index;if(h!==void 0){var u=new Gu[h.type](h.array);o.setIndex(new At(u,1))}var g=r.data.attributes;for(var y in g){var T=g[y],u=new Gu[T.type](T.array);o.addAttribute(y,new At(u,T.itemSize,T.normalized))}var I=r.data.groups||r.data.drawcalls||r.data.offsets;if(I!==void 0)for(var D=0,N=I.length;D!==N;++D){var A=I[D];o.addGroup(A.start,A.count,A.materialIndex)}var B=r.data.boundingSphere;if(B!==void 0){var F=new he;B.center!==void 0&&F.fromArray(B.center),o.boundingSphere=new nr(F,B.radius)}return o}});var Gu={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray<"u"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function $o(){}$o.Handlers={handlers:[],add:function(r,o){this.handlers.push(r,o)},get:function(r){for(var o=this.handlers,h=0,u=o.length;h<u;h+=2){var g=o[h],y=o[h+1];if(g.test(r))return y}return null}},Object.assign($o.prototype,{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(r,o,h){for(var u=[],g=0;g<r.length;++g)u[g]=this.createMaterial(r[g],o,h);return u},createMaterial:function(){var r={NoBlending:O,NormalBlending:z,AdditiveBlending:K,SubtractiveBlending:q,MultiplyBlending:Y,CustomBlending:se},o=new Mt,h=new Dh,u=new Kh;return function(y,T,I){var D={};function N(G,j,$,Z,Q){var ie=T+G,ne=$o.Handlers.get(ie),ae;ne!==null?ae=ne.load(ie):(h.setCrossOrigin(I),ae=h.load(ie)),j!==void 0&&(ae.repeat.fromArray(j),j[0]!==1&&(ae.wrapS=Rt),j[1]!==1&&(ae.wrapT=Rt)),$!==void 0&&ae.offset.fromArray($),Z!==void 0&&(Z[0]==="repeat"&&(ae.wrapS=Rt),Z[0]==="mirror"&&(ae.wrapS=Vn),Z[1]==="repeat"&&(ae.wrapT=Rt),Z[1]==="mirror"&&(ae.wrapT=Vn)),Q!==void 0&&(ae.anisotropy=Q);var ye=si.generateUUID();return D[ye]=ae,ye}var A={uuid:si.generateUUID(),type:"MeshLambertMaterial"};for(var B in y){var F=y[B];switch(B){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":A.name=F;break;case"blending":A.blending=r[F];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",B,"is no longer supported.");break;case"colorDiffuse":A.color=o.fromArray(F).getHex();break;case"colorSpecular":A.specular=o.fromArray(F).getHex();break;case"colorEmissive":A.emissive=o.fromArray(F).getHex();break;case"specularCoef":A.shininess=F;break;case"shading":F.toLowerCase()==="basic"&&(A.type="MeshBasicMaterial"),F.toLowerCase()==="phong"&&(A.type="MeshPhongMaterial"),F.toLowerCase()==="standard"&&(A.type="MeshStandardMaterial");break;case"mapDiffuse":A.map=N(F,y.mapDiffuseRepeat,y.mapDiffuseOffset,y.mapDiffuseWrap,y.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":A.emissiveMap=N(F,y.mapEmissiveRepeat,y.mapEmissiveOffset,y.mapEmissiveWrap,y.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":A.lightMap=N(F,y.mapLightRepeat,y.mapLightOffset,y.mapLightWrap,y.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":A.aoMap=N(F,y.mapAORepeat,y.mapAOOffset,y.mapAOWrap,y.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":A.bumpMap=N(F,y.mapBumpRepeat,y.mapBumpOffset,y.mapBumpWrap,y.mapBumpAnisotropy);break;case"mapBumpScale":A.bumpScale=F;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":A.normalMap=N(F,y.mapNormalRepeat,y.mapNormalOffset,y.mapNormalWrap,y.mapNormalAnisotropy);break;case"mapNormalFactor":A.normalScale=F;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":A.specularMap=N(F,y.mapSpecularRepeat,y.mapSpecularOffset,y.mapSpecularWrap,y.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":A.metalnessMap=N(F,y.mapMetalnessRepeat,y.mapMetalnessOffset,y.mapMetalnessWrap,y.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":A.roughnessMap=N(F,y.mapRoughnessRepeat,y.mapRoughnessOffset,y.mapRoughnessWrap,y.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":A.alphaMap=N(F,y.mapAlphaRepeat,y.mapAlphaOffset,y.mapAlphaWrap,y.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":A.side=E;break;case"doubleSided":A.side=k;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),A.opacity=F;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":A[B]=F;break;case"vertexColors":F===!0&&(A.vertexColors=H),F==="face"&&(A.vertexColors=V);break;default:console.error("THREE.Loader.createMaterial: Unsupported",B,F);break}}return A.type==="MeshBasicMaterial"&&delete A.emissive,A.type!=="MeshPhongMaterial"&&delete A.specular,A.opacity<1&&(A.transparent=!0),u.setTextures(D),u.parse(A)}}()});var ou={decodeText:function(r){if(typeof TextDecoder<"u")return new TextDecoder().decode(r);for(var o="",h=0,u=r.length;h<u;h++)o+=String.fromCharCode(r[h]);return decodeURIComponent(escape(o))},extractUrlBase:function(r){var o=r.lastIndexOf("/");return o===-1?"./":r.substr(0,o+1)}};function lu(r){typeof r=="boolean"&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),r=void 0),this.manager=r!==void 0?r:or,this.withCredentials=!1}Object.assign(lu.prototype,{crossOrigin:"anonymous",load:function(r,o,h,u){var g=this,y=this.texturePath&&typeof this.texturePath=="string"?this.texturePath:ou.extractUrlBase(r),T=new Xr(this.manager);T.setWithCredentials(this.withCredentials),T.load(r,function(I){var D=JSON.parse(I),N=D.metadata;if(N!==void 0){var A=N.type;if(A!==void 0&&A.toLowerCase()==="object"){console.error("THREE.JSONLoader: "+r+" should be loaded with THREE.ObjectLoader instead.");return}}var B=g.parse(D,y);o(B.geometry,B.materials)},h,u)},setCrossOrigin:function(r){return this.crossOrigin=r,this},setTexturePath:function(r){return this.texturePath=r,this},parse:function(){function r(g,y){function T(Qe,Nt){return Qe&1<<Nt}var I,D,N,A,B,F,G,j,$,Z,Q,ie,ne,ae,ye,ge,be,Ee,Se,Re,Ie,Ve,ot,ct,pt,yt,ue,fe=g.faces,je=g.vertices,Fe=g.normals,mt=g.colors,we=g.scale,ut=0;if(g.uvs!==void 0){for(I=0;I<g.uvs.length;I++)g.uvs[I].length&&ut++;for(I=0;I<ut;I++)y.faceVertexUvs[I]=[]}for(A=0,B=je.length;A<B;)Ee=new he,Ee.x=je[A++]*we,Ee.y=je[A++]*we,Ee.z=je[A++]*we,y.vertices.push(Ee);for(A=0,B=fe.length;A<B;)if(Z=fe[A++],Q=T(Z,0),ie=T(Z,1),ne=T(Z,3),ae=T(Z,4),ye=T(Z,5),ge=T(Z,6),be=T(Z,7),Q){if(Re=new tn,Re.a=fe[A],Re.b=fe[A+1],Re.c=fe[A+3],Ie=new tn,Ie.a=fe[A+1],Ie.b=fe[A+2],Ie.c=fe[A+3],A+=4,ie&&($=fe[A++],Re.materialIndex=$,Ie.materialIndex=$),N=y.faces.length,ne)for(I=0;I<ut;I++)for(ct=g.uvs[I],y.faceVertexUvs[I][N]=[],y.faceVertexUvs[I][N+1]=[],D=0;D<4;D++)j=fe[A++],yt=ct[j*2],ue=ct[j*2+1],pt=new rt(yt,ue),D!==2&&y.faceVertexUvs[I][N].push(pt),D!==0&&y.faceVertexUvs[I][N+1].push(pt);if(ae&&(G=fe[A++]*3,Re.normal.set(Fe[G++],Fe[G++],Fe[G]),Ie.normal.copy(Re.normal)),ye)for(I=0;I<4;I++)G=fe[A++]*3,ot=new he(Fe[G++],Fe[G++],Fe[G]),I!==2&&Re.vertexNormals.push(ot),I!==0&&Ie.vertexNormals.push(ot);if(ge&&(F=fe[A++],Ve=mt[F],Re.color.setHex(Ve),Ie.color.setHex(Ve)),be)for(I=0;I<4;I++)F=fe[A++],Ve=mt[F],I!==2&&Re.vertexColors.push(new Mt(Ve)),I!==0&&Ie.vertexColors.push(new Mt(Ve));y.faces.push(Re),y.faces.push(Ie)}else{if(Se=new tn,Se.a=fe[A++],Se.b=fe[A++],Se.c=fe[A++],ie&&($=fe[A++],Se.materialIndex=$),N=y.faces.length,ne)for(I=0;I<ut;I++)for(ct=g.uvs[I],y.faceVertexUvs[I][N]=[],D=0;D<3;D++)j=fe[A++],yt=ct[j*2],ue=ct[j*2+1],pt=new rt(yt,ue),y.faceVertexUvs[I][N].push(pt);if(ae&&(G=fe[A++]*3,Se.normal.set(Fe[G++],Fe[G++],Fe[G])),ye)for(I=0;I<3;I++)G=fe[A++]*3,ot=new he(Fe[G++],Fe[G++],Fe[G]),Se.vertexNormals.push(ot);if(ge&&(F=fe[A++],Se.color.setHex(mt[F])),be)for(I=0;I<3;I++)F=fe[A++],Se.vertexColors.push(new Mt(mt[F]));y.faces.push(Se)}}function o(g,y){var T=g.influencesPerVertex!==void 0?g.influencesPerVertex:2;if(g.skinWeights)for(var I=0,D=g.skinWeights.length;I<D;I+=T){var N=g.skinWeights[I],A=T>1?g.skinWeights[I+1]:0,B=T>2?g.skinWeights[I+2]:0,F=T>3?g.skinWeights[I+3]:0;y.skinWeights.push(new wi(N,A,B,F))}if(g.skinIndices)for(var I=0,D=g.skinIndices.length;I<D;I+=T){var G=g.skinIndices[I],j=T>1?g.skinIndices[I+1]:0,$=T>2?g.skinIndices[I+2]:0,Z=T>3?g.skinIndices[I+3]:0;y.skinIndices.push(new wi(G,j,$,Z))}y.bones=g.bones,y.bones&&y.bones.length>0&&(y.skinWeights.length!==y.skinIndices.length||y.skinIndices.length!==y.vertices.length)&&console.warn("When skinning, number of vertices ("+y.vertices.length+"), skinIndices ("+y.skinIndices.length+"), and skinWeights ("+y.skinWeights.length+") should match.")}function h(g,y){var T=g.scale;if(g.morphTargets!==void 0)for(var I=0,D=g.morphTargets.length;I<D;I++){y.morphTargets[I]={},y.morphTargets[I].name=g.morphTargets[I].name,y.morphTargets[I].vertices=[];for(var N=y.morphTargets[I].vertices,A=g.morphTargets[I].vertices,B=0,F=A.length;B<F;B+=3){var G=new he;G.x=A[B]*T,G.y=A[B+1]*T,G.z=A[B+2]*T,N.push(G)}}if(g.morphColors!==void 0&&g.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');for(var j=y.faces,$=g.morphColors[0].colors,I=0,D=j.length;I<D;I++)j[I].color.fromArray($,I*3)}}function u(g,y){var T=[],I=[];g.animation!==void 0&&I.push(g.animation),g.animations!==void 0&&(g.animations.length?I=I.concat(g.animations):I.push(g.animations));for(var D=0;D<I.length;D++){var N=Dr.parseAnimation(I[D],y.bones);N&&T.push(N)}if(y.morphTargets){var A=Dr.CreateClipsFromMorphTargetSequences(y.morphTargets,10);T=T.concat(A)}T.length>0&&(y.animations=T)}return function(y,T){y.data!==void 0&&(y=y.data),y.scale!==void 0?y.scale=1/y.scale:y.scale=1;var I=new xt;if(r(y,I),o(y,I),h(y,I),u(y,I),I.computeFaceNormals(),I.computeBoundingSphere(),y.materials===void 0||y.materials.length===0)return{geometry:I};var D=$o.prototype.initMaterials(y.materials,T,this.crossOrigin);return{geometry:I,materials:D}}}()});function Hu(r){this.manager=r!==void 0?r:or,this.texturePath=""}Object.assign(Hu.prototype,{crossOrigin:"anonymous",load:function(r,o,h,u){this.texturePath===""&&(this.texturePath=r.substring(0,r.lastIndexOf("/")+1));var g=this,y=new Xr(g.manager);y.load(r,function(T){var I=null;try{I=JSON.parse(T)}catch(N){u!==void 0&&u(N),console.error("THREE:ObjectLoader: Can't parse "+r+".",N.message);return}var D=I.metadata;if(D===void 0||D.type===void 0||D.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+r+". Use THREE.JSONLoader instead.");return}g.parse(I,o)},h,u)},setTexturePath:function(r){return this.texturePath=r,this},setCrossOrigin:function(r){return this.crossOrigin=r,this},parse:function(r,o){var h=this.parseShape(r.shapes),u=this.parseGeometries(r.geometries,h),g=this.parseImages(r.images,function(){o!==void 0&&o(I)}),y=this.parseTextures(r.textures,g),T=this.parseMaterials(r.materials,y),I=this.parseObject(r.object,u,T);return r.animations&&(I.animations=this.parseAnimations(r.animations)),(r.images===void 0||r.images.length===0)&&o!==void 0&&o(I),I},parseShape:function(r){var o={};if(r!==void 0)for(var h=0,u=r.length;h<u;h++){var g=new Ta().fromJSON(r[h]);o[g.uuid]=g}return o},parseGeometries:function(r,o){var h={};if(r!==void 0)for(var u=new lu,g=new au,y=0,T=r.length;y<T;y++){var I,D=r[y];switch(D.type){case"PlaneGeometry":case"PlaneBufferGeometry":I=new Ui[D.type](D.width,D.height,D.widthSegments,D.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":I=new Ui[D.type](D.width,D.height,D.depth,D.widthSegments,D.heightSegments,D.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":I=new Ui[D.type](D.radius,D.segments,D.thetaStart,D.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":I=new Ui[D.type](D.radiusTop,D.radiusBottom,D.height,D.radialSegments,D.heightSegments,D.openEnded,D.thetaStart,D.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":I=new Ui[D.type](D.radius,D.height,D.radialSegments,D.heightSegments,D.openEnded,D.thetaStart,D.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":I=new Ui[D.type](D.radius,D.widthSegments,D.heightSegments,D.phiStart,D.phiLength,D.thetaStart,D.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":I=new Ui[D.type](D.radius,D.detail);break;case"RingGeometry":case"RingBufferGeometry":I=new Ui[D.type](D.innerRadius,D.outerRadius,D.thetaSegments,D.phiSegments,D.thetaStart,D.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":I=new Ui[D.type](D.radius,D.tube,D.radialSegments,D.tubularSegments,D.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":I=new Ui[D.type](D.radius,D.tube,D.tubularSegments,D.radialSegments,D.p,D.q);break;case"LatheGeometry":case"LatheBufferGeometry":I=new Ui[D.type](D.points,D.segments,D.phiStart,D.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":I=new Ui[D.type](D.vertices,D.indices,D.radius,D.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var F=[],N=0,A=D.shapes.length;N<A;N++){var B=o[D.shapes[N]];F.push(B)}I=new Ui[D.type](F,D.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(var F=[],N=0,A=D.shapes.length;N<A;N++){var B=o[D.shapes[N]];F.push(B)}var G=D.options.extrudePath;G!==void 0&&(D.options.extrudePath=new zu[G.type]().fromJSON(G)),I=new Ui[D.type](F,D.options);break;case"BufferGeometry":I=g.parse(D);break;case"Geometry":I=u.parse(D,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+D.type+'"');continue}I.uuid=D.uuid,D.name!==void 0&&(I.name=D.name),I.isBufferGeometry===!0&&D.userData!==void 0&&(I.userData=D.userData),h[D.uuid]=I}return h},parseMaterials:function(r,o){var h={};if(r!==void 0){var u=new Kh;u.setTextures(o);for(var g=0,y=r.length;g<y;g++){var T=r[g];if(T.type==="MultiMaterial"){for(var I=[],D=0;D<T.materials.length;D++)I.push(u.parse(T.materials[D]));h[T.uuid]=I}else h[T.uuid]=u.parse(T)}}return h},parseAnimations:function(r){for(var o=[],h=0;h<r.length;h++){var u=r[h],g=Dr.parse(u);u.uuid!==void 0&&(g.uuid=u.uuid),o.push(g)}return o},parseImages:function(r,o){var h=this,u={};function g($){return h.manager.itemStart($),T.load($,function(){h.manager.itemEnd($)},void 0,function(){h.manager.itemEnd($),h.manager.itemError($)})}if(r!==void 0&&r.length>0){var y=new Zc(o),T=new Jl(y);T.setCrossOrigin(this.crossOrigin);for(var I=0,D=r.length;I<D;I++){var N=r[I],A=N.url;if(Array.isArray(A)){u[N.uuid]=[];for(var B=0,F=A.length;B<F;B++){var G=A[B],j=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(G)?G:h.texturePath+G;u[N.uuid].push(g(j))}}else{var j=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(N.url)?N.url:h.texturePath+N.url;u[N.uuid]=g(j)}}}return u},parseTextures:function(r,o){function h(D,N){return typeof D=="number"?D:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",D),N[D])}var u={};if(r!==void 0)for(var g=0,y=r.length;g<y;g++){var T=r[g];T.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',T.uuid),o[T.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",T.image);var I;Array.isArray(o[T.image])?I=new Ur(o[T.image]):I=new Ci(o[T.image]),I.needsUpdate=!0,I.uuid=T.uuid,T.name!==void 0&&(I.name=T.name),T.mapping!==void 0&&(I.mapping=h(T.mapping,xp)),T.offset!==void 0&&I.offset.fromArray(T.offset),T.repeat!==void 0&&I.repeat.fromArray(T.repeat),T.center!==void 0&&I.center.fromArray(T.center),T.rotation!==void 0&&(I.rotation=T.rotation),T.wrap!==void 0&&(I.wrapS=h(T.wrap[0],Wu),I.wrapT=h(T.wrap[1],Wu)),T.format!==void 0&&(I.format=T.format),T.minFilter!==void 0&&(I.minFilter=h(T.minFilter,ju)),T.magFilter!==void 0&&(I.magFilter=h(T.magFilter,ju)),T.anisotropy!==void 0&&(I.anisotropy=T.anisotropy),T.flipY!==void 0&&(I.flipY=T.flipY),u[T.uuid]=I}return u},parseObject:function(r,o,h){var u;function g(j){return o[j]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",j),o[j]}function y(j){if(j!==void 0){if(Array.isArray(j)){for(var $=[],Z=0,Q=j.length;Z<Q;Z++){var ie=j[Z];h[ie]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",ie),$.push(h[ie])}return $}return h[j]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",j),h[j]}}switch(r.type){case"Scene":u=new eo,r.background!==void 0&&Number.isInteger(r.background)&&(u.background=new Mt(r.background)),r.fog!==void 0&&(r.fog.type==="Fog"?u.fog=new _a(r.fog.color,r.fog.near,r.fog.far):r.fog.type==="FogExp2"&&(u.fog=new Us(r.fog.color,r.fog.density)));break;case"PerspectiveCamera":u=new nn(r.fov,r.aspect,r.near,r.far),r.focus!==void 0&&(u.focus=r.focus),r.zoom!==void 0&&(u.zoom=r.zoom),r.filmGauge!==void 0&&(u.filmGauge=r.filmGauge),r.filmOffset!==void 0&&(u.filmOffset=r.filmOffset),r.view!==void 0&&(u.view=Object.assign({},r.view));break;case"OrthographicCamera":u=new sa(r.left,r.right,r.top,r.bottom,r.near,r.far),r.zoom!==void 0&&(u.zoom=r.zoom),r.view!==void 0&&(u.view=Object.assign({},r.view));break;case"AmbientLight":u=new Vh(r.color,r.intensity);break;case"DirectionalLight":u=new Oh(r.color,r.intensity);break;case"PointLight":u=new Bh(r.color,r.intensity,r.distance,r.decay);break;case"RectAreaLight":u=new Uh(r.color,r.intensity,r.width,r.height);break;case"SpotLight":u=new Ah(r.color,r.intensity,r.distance,r.angle,r.penumbra,r.decay);break;case"HemisphereLight":u=new Nh(r.color,r.groundColor,r.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var T=g(r.geometry),I=y(r.material);T.bones&&T.bones.length>0?u=new Wo(T,I):u=new Mn(T,I);break;case"LOD":u=new ps;break;case"Line":u=new Bn(g(r.geometry),y(r.material),r.mode);break;case"LineLoop":u=new io(g(r.geometry),y(r.material));break;case"LineSegments":u=new Li(g(r.geometry),y(r.material));break;case"PointCloud":case"Points":u=new zs(g(r.geometry),y(r.material));break;case"Sprite":u=new to(y(r.material));break;case"Group":u=new ga;break;default:u=new vt}if(u.uuid=r.uuid,r.name!==void 0&&(u.name=r.name),r.matrix!==void 0?(u.matrix.fromArray(r.matrix),r.matrixAutoUpdate!==void 0&&(u.matrixAutoUpdate=r.matrixAutoUpdate),u.matrixAutoUpdate&&u.matrix.decompose(u.position,u.quaternion,u.scale)):(r.position!==void 0&&u.position.fromArray(r.position),r.rotation!==void 0&&u.rotation.fromArray(r.rotation),r.quaternion!==void 0&&u.quaternion.fromArray(r.quaternion),r.scale!==void 0&&u.scale.fromArray(r.scale)),r.castShadow!==void 0&&(u.castShadow=r.castShadow),r.receiveShadow!==void 0&&(u.receiveShadow=r.receiveShadow),r.shadow&&(r.shadow.bias!==void 0&&(u.shadow.bias=r.shadow.bias),r.shadow.radius!==void 0&&(u.shadow.radius=r.shadow.radius),r.shadow.mapSize!==void 0&&u.shadow.mapSize.fromArray(r.shadow.mapSize),r.shadow.camera!==void 0&&(u.shadow.camera=this.parseObject(r.shadow.camera))),r.visible!==void 0&&(u.visible=r.visible),r.frustumCulled!==void 0&&(u.frustumCulled=r.frustumCulled),r.renderOrder!==void 0&&(u.renderOrder=r.renderOrder),r.userData!==void 0&&(u.userData=r.userData),r.layers!==void 0&&(u.layers.mask=r.layers),r.children!==void 0)for(var D=r.children,N=0;N<D.length;N++)u.add(this.parseObject(D[N],o,h));if(r.type==="LOD")for(var A=r.levels,B=0;B<A.length;B++){var F=A[B],G=u.getObjectByProperty("uuid",F.object);G!==void 0&&u.addLevel(G,F.distance)}return u}});var xp={UVMapping:yi,CubeReflectionMapping:sn,CubeRefractionMapping:ki,EquirectangularReflectionMapping:ti,EquirectangularRefractionMapping:On,SphericalReflectionMapping:er,CubeUVReflectionMapping:cr,CubeUVRefractionMapping:Ye},Wu={RepeatWrapping:Rt,ClampToEdgeWrapping:xi,MirroredRepeatWrapping:Vn},ju={NearestFilter:Hi,NearestMipMapNearestFilter:Nr,NearestMipMapLinearFilter:Ft,LinearFilter:fn,LinearMipMapNearestFilter:ts,LinearMipMapLinearFilter:wr};function du(r){typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=r!==void 0?r:or,this.options=void 0}du.prototype={constructor:du,setOptions:function(o){return this.options=o,this},load:function(r,o,h,u){r===void 0&&(r=""),this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);var g=this,y=po.get(r);if(y!==void 0)return g.manager.itemStart(r),setTimeout(function(){o&&o(y),g.manager.itemEnd(r)},0),y;fetch(r).then(function(T){return T.blob()}).then(function(T){return createImageBitmap(T,g.options)}).then(function(T){po.add(r,T),o&&o(T),g.manager.itemEnd(r)}).catch(function(T){u&&u(T),g.manager.itemEnd(r),g.manager.itemError(r)})},setCrossOrigin:function(){return this},setPath:function(r){return this.path=r,this}};function hu(){this.type="ShapePath",this.color=new Mt,this.subPaths=[],this.currentPath=null}Object.assign(hu.prototype,{moveTo:function(r,o){this.currentPath=new Zr,this.subPaths.push(this.currentPath),this.currentPath.moveTo(r,o)},lineTo:function(r,o){this.currentPath.lineTo(r,o)},quadraticCurveTo:function(r,o,h,u){this.currentPath.quadraticCurveTo(r,o,h,u)},bezierCurveTo:function(r,o,h,u,g,y){this.currentPath.bezierCurveTo(r,o,h,u,g,y)},splineThru:function(r){this.currentPath.splineThru(r)},toShapes:function(r,o){function h(pt){for(var yt=[],ue=0,fe=pt.length;ue<fe;ue++){var je=pt[ue],Fe=new Ta;Fe.curves=je.curves,yt.push(Fe)}return yt}function u(pt,yt){for(var ue=yt.length,fe=!1,je=ue-1,Fe=0;Fe<ue;je=Fe++){var mt=yt[je],we=yt[Fe],ut=we.x-mt.x,Qe=we.y-mt.y;if(Math.abs(Qe)>Number.EPSILON){if(Qe<0&&(mt=yt[Fe],ut=-ut,we=yt[je],Qe=-Qe),pt.y<mt.y||pt.y>we.y)continue;if(pt.y===mt.y){if(pt.x===mt.x)return!0}else{var Nt=Qe*(pt.x-mt.x)-ut*(pt.y-mt.y);if(Nt===0)return!0;if(Nt<0)continue;fe=!fe}}else{if(pt.y!==mt.y)continue;if(we.x<=pt.x&&pt.x<=mt.x||mt.x<=pt.x&&pt.x<=we.x)return!0}}return fe}var g=dt.isClockWise,y=this.subPaths;if(y.length===0)return[];if(o===!0)return h(y);var T,I,D,N=[];if(y.length===1)return I=y[0],D=new Ta,D.curves=I.curves,N.push(D),N;var A=!g(y[0].getPoints());A=r?!A:A;var B=[],F=[],G=[],j=0,$;F[j]=void 0,G[j]=[];for(var Z=0,Q=y.length;Z<Q;Z++)I=y[Z],$=I.getPoints(),T=g($),T=r?!T:T,T?(!A&&F[j]&&j++,F[j]={s:new Ta,p:$},F[j].s.curves=I.curves,A&&j++,G[j]=[]):G[j].push({h:I,p:$[0]});if(!F[0])return h(y);if(F.length>1){for(var ie=!1,ne=[],ae=0,ye=F.length;ae<ye;ae++)B[ae]=[];for(var ae=0,ye=F.length;ae<ye;ae++)for(var ge=G[ae],be=0;be<ge.length;be++){for(var Ee=ge[be],Se=!0,Re=0;Re<F.length;Re++)u(Ee.p,F[Re].p)&&(ae!==Re&&ne.push({froms:ae,tos:Re,hole:be}),Se?(Se=!1,B[Re].push(Ee)):ie=!0);Se&&B[ae].push(Ee)}ne.length>0&&(ie||(G=B))}for(var Ie,Z=0,Ve=F.length;Z<Ve;Z++){D=F[Z].s,N.push(D),Ie=G[Z];for(var ot=0,ct=Ie.length;ot<ct;ot++)D.holes.push(Ie[ot].h)}return N}});function cu(r){this.type="Font",this.data=r}Object.assign(cu.prototype,{isFont:!0,generateShapes:function(r,o){o===void 0&&(o=100);for(var h=[],u=Ip(r,o,this.data),g=0,y=u.length;g<y;g++)Array.prototype.push.apply(h,u[g].toShapes());return h}});function Ip(r,o,h){for(var u=Array.from?Array.from(r):String(r).split(""),g=o/h.resolution,y=(h.boundingBox.yMax-h.boundingBox.yMin+h.underlineThickness)*g,T=[],I=0,D=0,N=0;N<u.length;N++){var A=u[N];if(A===`
`)I=0,D-=y;else{var B=Rp(A,g,I,D,h);I+=B.offsetX,T.push(B.path)}}return T}function Rp(r,o,h,u,g){var y=g.glyphs[r]||g.glyphs["?"];if(!!y){var T=new hu,I,D,N,A,B,F,G,j;if(y.o)for(var $=y._cachedOutline||(y._cachedOutline=y.o.split(" ")),Z=0,Q=$.length;Z<Q;){var ie=$[Z++];switch(ie){case"m":I=$[Z++]*o+h,D=$[Z++]*o+u,T.moveTo(I,D);break;case"l":I=$[Z++]*o+h,D=$[Z++]*o+u,T.lineTo(I,D);break;case"q":N=$[Z++]*o+h,A=$[Z++]*o+u,B=$[Z++]*o+h,F=$[Z++]*o+u,T.quadraticCurveTo(B,F,N,A);break;case"b":N=$[Z++]*o+h,A=$[Z++]*o+u,B=$[Z++]*o+h,F=$[Z++]*o+u,G=$[Z++]*o+h,j=$[Z++]*o+u,T.bezierCurveTo(B,F,G,j,N,A);break}}return{offsetX:y.ha*o,path:T}}}function qu(r){this.manager=r!==void 0?r:or}Object.assign(qu.prototype,{load:function(r,o,h,u){var g=this,y=new Xr(this.manager);y.setPath(this.path),y.load(r,function(T){var I;try{I=JSON.parse(T)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),I=JSON.parse(T.substring(65,T.length-2))}var D=g.parse(I);o&&o(D)},h,u)},parse:function(r){return new cu(r)},setPath:function(r){return this.path=r,this}});var Xh,uu={getContext:function(){return Xh===void 0&&(Xh=new(window.AudioContext||window.webkitAudioContext)),Xh},setContext:function(r){Xh=r}};function pu(r){this.manager=r!==void 0?r:or}Object.assign(pu.prototype,{load:function(r,o,h,u){var g=new Xr(this.manager);g.setResponseType("arraybuffer"),g.load(r,function(y){var T=y.slice(0),I=uu.getContext();I.decodeAudioData(T,function(D){o(D)})},h,u)}});function Ku(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new nn,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new nn,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}Object.assign(Ku.prototype,{update:function(){var r,o,h,u,g,y,T,I,D=new Ot,N=new Ot;return function(B){var F=r!==this||o!==B.focus||h!==B.fov||u!==B.aspect*this.aspect||g!==B.near||y!==B.far||T!==B.zoom||I!==this.eyeSep;if(F){r=this,o=B.focus,h=B.fov,u=B.aspect*this.aspect,g=B.near,y=B.far,T=B.zoom;var G=B.projectionMatrix.clone();I=this.eyeSep/2;var j=I*g/o,$=g*Math.tan(si.DEG2RAD*h*.5)/T,Z,Q;N.elements[12]=-I,D.elements[12]=I,Z=-$*u+j,Q=$*u+j,G.elements[0]=2*g/(Q-Z),G.elements[8]=(Q+Z)/(Q-Z),this.cameraL.projectionMatrix.copy(G),Z=-$*u-j,Q=$*u-j,G.elements[0]=2*g/(Q-Z),G.elements[8]=(Q+Z)/(Q-Z),this.cameraR.projectionMatrix.copy(G)}this.cameraL.matrixWorld.copy(B.matrixWorld).multiply(N),this.cameraR.matrixWorld.copy(B.matrixWorld).multiply(D)}}()});function td(r,o,h){vt.call(this),this.type="CubeCamera";var u=90,g=1,y=new nn(u,g,r,o);y.up.set(0,-1,0),y.lookAt(new he(1,0,0)),this.add(y);var T=new nn(u,g,r,o);T.up.set(0,-1,0),T.lookAt(new he(-1,0,0)),this.add(T);var I=new nn(u,g,r,o);I.up.set(0,0,1),I.lookAt(new he(0,1,0)),this.add(I);var D=new nn(u,g,r,o);D.up.set(0,0,-1),D.lookAt(new he(0,-1,0)),this.add(D);var N=new nn(u,g,r,o);N.up.set(0,-1,0),N.lookAt(new he(0,0,1)),this.add(N);var A=new nn(u,g,r,o);A.up.set(0,-1,0),A.lookAt(new he(0,0,-1)),this.add(A);var B={format:Tr,magFilter:fn,minFilter:fn};this.renderTarget=new rs(h,h,B),this.renderTarget.texture.name="CubeCamera",this.update=function(F,G){this.parent===null&&this.updateMatrixWorld();var j=this.renderTarget,$=j.texture.generateMipmaps;j.texture.generateMipmaps=!1,j.activeCubeFace=0,F.render(G,y,j),j.activeCubeFace=1,F.render(G,T,j),j.activeCubeFace=2,F.render(G,I,j),j.activeCubeFace=3,F.render(G,D,j),j.activeCubeFace=4,F.render(G,N,j),j.texture.generateMipmaps=$,j.activeCubeFace=5,F.render(G,A,j),F.setRenderTarget(null)},this.clear=function(F,G,j,$){for(var Z=this.renderTarget,Q=0;Q<6;Q++)Z.activeCubeFace=Q,F.setRenderTarget(Z),F.clear(G,j,$);F.setRenderTarget(null)}}td.prototype=Object.create(vt.prototype),td.prototype.constructor=td;function mu(){vt.call(this),this.type="AudioListener",this.context=uu.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}mu.prototype=Object.assign(Object.create(vt.prototype),{constructor:mu,getInput:function(){return this.gain},removeFilter:function(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(r){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=r,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(r){return this.gain.gain.setTargetAtTime(r,this.context.currentTime,.01),this},updateMatrixWorld:function(){var r=new he,o=new en,h=new he,u=new he;return function(y){vt.prototype.updateMatrixWorld.call(this,y);var T=this.context.listener,I=this.up;this.matrixWorld.decompose(r,o,h),u.set(0,0,-1).applyQuaternion(o),T.positionX?(T.positionX.setValueAtTime(r.x,this.context.currentTime),T.positionY.setValueAtTime(r.y,this.context.currentTime),T.positionZ.setValueAtTime(r.z,this.context.currentTime),T.forwardX.setValueAtTime(u.x,this.context.currentTime),T.forwardY.setValueAtTime(u.y,this.context.currentTime),T.forwardZ.setValueAtTime(u.z,this.context.currentTime),T.upX.setValueAtTime(I.x,this.context.currentTime),T.upY.setValueAtTime(I.y,this.context.currentTime),T.upZ.setValueAtTime(I.z,this.context.currentTime)):(T.setPosition(r.x,r.y,r.z),T.setOrientation(u.x,u.y,u.z,I.x,I.y,I.z))}}()});function Qo(r){vt.call(this),this.type="Audio",this.context=r.context,this.gain=this.context.createGain(),this.gain.connect(r.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}Qo.prototype=Object.assign(Object.create(vt.prototype),{constructor:Qo,getOutput:function(){return this.gain},setNodeSource:function(r){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=r,this.connect(),this},setMediaElementSource:function(r){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(r),this.connect(),this},setBuffer:function(r){return this.buffer=r,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}var r=this.context.createBufferSource();return r.buffer=this.buffer,r.loop=this.loop,r.onended=this.onEnded.bind(this),r.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,r.start(this.startTime,this.offset),this.isPlaying=!0,this.source=r,this.connect()},pause:function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this},stop:function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.source.stop(),this.offset=0,this.isPlaying=!1,this},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var r=1,o=this.filters.length;r<o;r++)this.filters[r-1].connect(this.filters[r]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var r=1,o=this.filters.length;r<o;r++)this.filters[r-1].disconnect(this.filters[r]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(r){return r||(r=[]),this.isPlaying===!0?(this.disconnect(),this.filters=r,this.connect()):this.filters=r,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(r){return this.setFilters(r?[r]:[])},setPlaybackRate:function(r){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=r,this.isPlaying===!0&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(r){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=r,this.isPlaying===!0&&(this.source.loop=this.loop),this},getVolume:function(){return this.gain.gain.value},setVolume:function(r){return this.gain.gain.setTargetAtTime(r,this.context.currentTime,.01),this}});function fu(r){Qo.call(this,r),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}fu.prototype=Object.assign(Object.create(Qo.prototype),{constructor:fu,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(r){return this.panner.refDistance=r,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(r){return this.panner.rolloffFactor=r,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(r){return this.panner.distanceModel=r,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(r){return this.panner.maxDistance=r,this},setDirectionalCone:function(r,o,h){return this.panner.coneInnerAngle=r,this.panner.coneOuterAngle=o,this.panner.coneOuterGain=h,this},updateMatrixWorld:function(){var r=new he,o=new en,h=new he,u=new he;return function(y){vt.prototype.updateMatrixWorld.call(this,y);var T=this.panner;this.matrixWorld.decompose(r,o,h),u.set(0,0,1).applyQuaternion(o),T.setPosition(r.x,r.y,r.z),T.setOrientation(u.x,u.y,u.z)}}()});function gu(r,o){this.analyser=r.context.createAnalyser(),this.analyser.fftSize=o!==void 0?o:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),r.getOutput().connect(this.analyser)}Object.assign(gu.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var r=0,o=this.getFrequencyData(),h=0;h<o.length;h++)r+=o[h];return r/o.length}});function _u(r,o,h){this.binding=r,this.valueSize=h;var u=Float64Array,g;switch(o){case"quaternion":g=this._slerp;break;case"string":case"bool":u=Array,g=this._select;break;default:g=this._lerp}this.buffer=new u(h*4),this._mixBufferRegion=g,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Object.assign(_u.prototype,{accumulate:function(r,o){var h=this.buffer,u=this.valueSize,g=r*u+u,y=this.cumulativeWeight;if(y===0){for(var T=0;T!==u;++T)h[g+T]=h[T];y=o}else{y+=o;var I=o/y;this._mixBufferRegion(h,g,0,I,u)}this.cumulativeWeight=y},apply:function(r){var o=this.valueSize,h=this.buffer,u=r*o+o,g=this.cumulativeWeight,y=this.binding;if(this.cumulativeWeight=0,g<1){var T=o*3;this._mixBufferRegion(h,u,T,1-g,o)}for(var I=o,D=o+o;I!==D;++I)if(h[I]!==h[I+o]){y.setValue(h,u);break}},saveOriginalState:function(){var r=this.binding,o=this.buffer,h=this.valueSize,u=h*3;r.getValue(o,u);for(var g=h,y=u;g!==y;++g)o[g]=o[u+g%h];this.cumulativeWeight=0},restoreOriginalState:function(){var r=this.valueSize*3;this.binding.setValue(this.buffer,r)},_select:function(r,o,h,u,g){if(u>=.5)for(var y=0;y!==g;++y)r[o+y]=r[h+y]},_slerp:function(r,o,h,u){en.slerpFlat(r,o,r,o,r,h,u)},_lerp:function(r,o,h,u,g){for(var y=1-u,T=0;T!==g;++T){var I=o+T;r[I]=r[I]*y+r[h+T]*u}}});var vu="\\[\\]\\.:\\/";function Xu(r,o,h){var u=h||Kn.parseTrackName(o);this._targetGroup=r,this._bindings=r.subscribe_(o,u)}Object.assign(Xu.prototype,{getValue:function(r,o){this.bind();var h=this._targetGroup.nCachedObjects_,u=this._bindings[h];u!==void 0&&u.getValue(r,o)},setValue:function(r,o){for(var h=this._bindings,u=this._targetGroup.nCachedObjects_,g=h.length;u!==g;++u)h[u].setValue(r,o)},bind:function(){for(var r=this._bindings,o=this._targetGroup.nCachedObjects_,h=r.length;o!==h;++o)r[o].bind()},unbind:function(){for(var r=this._bindings,o=this._targetGroup.nCachedObjects_,h=r.length;o!==h;++o)r[o].unbind()}});function Kn(r,o,h){this.path=o,this.parsedPath=h||Kn.parseTrackName(o),this.node=Kn.findNode(r,this.parsedPath.nodeName)||r,this.rootNode=r}Object.assign(Kn,{Composite:Xu,create:function(r,o,h){return r&&r.isAnimationObjectGroup?new Kn.Composite(r,o,h):new Kn(r,o,h)},sanitizeNodeName:function(){var r=new RegExp("["+vu+"]","g");return function(h){return h.replace(/\s/g,"_").replace(r,"")}}(),parseTrackName:function(){var r="[^"+vu+"]",o="[^"+vu.replace("\\.","")+"]",h=/((?:WC+[\/:])*)/.source.replace("WC",r),u=/(WCOD+)?/.source.replace("WCOD",o),g=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",r),y=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",r),T=new RegExp("^"+h+u+g+y+"$"),I=["material","materials","bones"];return function(N){var A=T.exec(N);if(!A)throw new Error("PropertyBinding: Cannot parse trackName: "+N);var B={nodeName:A[2],objectName:A[3],objectIndex:A[4],propertyName:A[5],propertyIndex:A[6]},F=B.nodeName&&B.nodeName.lastIndexOf(".");if(F!==void 0&&F!==-1){var G=B.nodeName.substring(F+1);I.indexOf(G)!==-1&&(B.nodeName=B.nodeName.substring(0,F),B.objectName=G)}if(B.propertyName===null||B.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+N);return B}}(),findNode:function(r,o){if(!o||o===""||o==="root"||o==="."||o===-1||o===r.name||o===r.uuid)return r;if(r.skeleton){var h=r.skeleton.getBoneByName(o);if(h!==void 0)return h}if(r.children){var u=function(y){for(var T=0;T<y.length;T++){var I=y[T];if(I.name===o||I.uuid===o)return I;var D=u(I.children);if(D)return D}return null},g=u(r.children);if(g)return g}return null}}),Object.assign(Kn.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(o,h){o[h]=this.node[this.propertyName]},function(o,h){for(var u=this.resolvedProperty,g=0,y=u.length;g!==y;++g)o[h++]=u[g]},function(o,h){o[h]=this.resolvedProperty[this.propertyIndex]},function(o,h){this.resolvedProperty.toArray(o,h)}],SetterByBindingTypeAndVersioning:[[function(o,h){this.targetObject[this.propertyName]=o[h]},function(o,h){this.targetObject[this.propertyName]=o[h],this.targetObject.needsUpdate=!0},function(o,h){this.targetObject[this.propertyName]=o[h],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(o,h){for(var u=this.resolvedProperty,g=0,y=u.length;g!==y;++g)u[g]=o[h++]},function(o,h){for(var u=this.resolvedProperty,g=0,y=u.length;g!==y;++g)u[g]=o[h++];this.targetObject.needsUpdate=!0},function(o,h){for(var u=this.resolvedProperty,g=0,y=u.length;g!==y;++g)u[g]=o[h++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(o,h){this.resolvedProperty[this.propertyIndex]=o[h]},function(o,h){this.resolvedProperty[this.propertyIndex]=o[h],this.targetObject.needsUpdate=!0},function(o,h){this.resolvedProperty[this.propertyIndex]=o[h],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(o,h){this.resolvedProperty.fromArray(o,h)},function(o,h){this.resolvedProperty.fromArray(o,h),this.targetObject.needsUpdate=!0},function(o,h){this.resolvedProperty.fromArray(o,h),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(o,h){this.bind(),this.getValue(o,h)},setValue:function(o,h){this.bind(),this.setValue(o,h)},bind:function(){var r=this.node,o=this.parsedPath,h=o.objectName,u=o.propertyName,g=o.propertyIndex;if(r||(r=Kn.findNode(this.rootNode,o.nodeName)||this.rootNode,this.node=r),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!r){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(h){var y=o.objectIndex;switch(h){case"materials":if(!r.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!r.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}r=r.material.materials;break;case"bones":if(!r.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}r=r.skeleton.bones;for(var T=0;T<r.length;T++)if(r[T].name===y){y=T;break}break;default:if(r[h]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}r=r[h]}if(y!==void 0){if(r[y]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,r);return}r=r[y]}}var I=r[u];if(I===void 0){var D=o.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+D+"."+u+" but it wasn't found.",r);return}var N=this.Versioning.None;r.needsUpdate!==void 0?(N=this.Versioning.NeedsUpdate,this.targetObject=r):r.matrixWorldNeedsUpdate!==void 0&&(N=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=r);var A=this.BindingType.Direct;if(g!==void 0){if(u==="morphTargetInfluences"){if(!r.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(r.geometry.isBufferGeometry){if(!r.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}for(var T=0;T<this.node.geometry.morphAttributes.position.length;T++)if(r.geometry.morphAttributes.position[T].name===g){g=T;break}}else{if(!r.geometry.morphTargets){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);return}for(var T=0;T<this.node.geometry.morphTargets.length;T++)if(r.geometry.morphTargets[T].name===g){g=T;break}}}A=this.BindingType.ArrayElement,this.resolvedProperty=I,this.propertyIndex=g}else I.fromArray!==void 0&&I.toArray!==void 0?(A=this.BindingType.HasFromToArray,this.resolvedProperty=I):Array.isArray(I)?(A=this.BindingType.EntireArray,this.resolvedProperty=I):this.propertyName=u;this.getValue=this.GetterByBindingType[A],this.setValue=this.SetterByBindingTypeAndVersioning[A][N]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}});Object.assign(Kn.prototype,{_getValue_unbound:Kn.prototype.getValue,_setValue_unbound:Kn.prototype.setValue});function Yu(){this.uuid=si.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var r={};this._indicesByUUID=r;for(var o=0,h=arguments.length;o!==h;++o)r[arguments[o].uuid]=o;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var u=this;this.stats={objects:{get total(){return u._objects.length},get inUse(){return this.total-u.nCachedObjects_}},get bindingsPerObject(){return u._bindings.length}}}Object.assign(Yu.prototype,{isAnimationObjectGroup:!0,add:function(){for(var r=this._objects,o=r.length,h=this.nCachedObjects_,u=this._indicesByUUID,g=this._paths,y=this._parsedPaths,T=this._bindings,I=T.length,D=void 0,N=0,A=arguments.length;N!==A;++N){var B=arguments[N],F=B.uuid,G=u[F];if(G===void 0){G=o++,u[F]=G,r.push(B);for(var j=0,$=I;j!==$;++j)T[j].push(new Kn(B,g[j],y[j]))}else if(G<h){D=r[G];var Z=--h,Q=r[Z];u[Q.uuid]=G,r[G]=Q,u[F]=Z,r[Z]=B;for(var j=0,$=I;j!==$;++j){var ie=T[j],ne=ie[Z],ae=ie[G];ie[G]=ne,ae===void 0&&(ae=new Kn(B,g[j],y[j])),ie[Z]=ae}}else r[G]!==D&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=h},remove:function(){for(var r=this._objects,o=this.nCachedObjects_,h=this._indicesByUUID,u=this._bindings,g=u.length,y=0,T=arguments.length;y!==T;++y){var I=arguments[y],D=I.uuid,N=h[D];if(N!==void 0&&N>=o){var A=o++,B=r[A];h[B.uuid]=N,r[N]=B,h[D]=A,r[A]=I;for(var F=0,G=g;F!==G;++F){var j=u[F],$=j[A],Z=j[N];j[N]=$,j[A]=Z}}}this.nCachedObjects_=o},uncache:function(){for(var r=this._objects,o=r.length,h=this.nCachedObjects_,u=this._indicesByUUID,g=this._bindings,y=g.length,T=0,I=arguments.length;T!==I;++T){var D=arguments[T],N=D.uuid,A=u[N];if(A!==void 0)if(delete u[N],A<h){var B=--h,F=r[B],G=--o,j=r[G];u[F.uuid]=A,r[A]=F,u[j.uuid]=B,r[B]=j,r.pop();for(var $=0,Z=y;$!==Z;++$){var Q=g[$],ie=Q[B],ne=Q[G];Q[A]=ie,Q[B]=ne,Q.pop()}}else{var G=--o,j=r[G];u[j.uuid]=A,r[A]=j,r.pop();for(var $=0,Z=y;$!==Z;++$){var Q=g[$];Q[A]=Q[G],Q.pop()}}}this.nCachedObjects_=h},subscribe_:function(r,o){var h=this._bindingsIndicesByPath,u=h[r],g=this._bindings;if(u!==void 0)return g[u];var y=this._paths,T=this._parsedPaths,I=this._objects,D=I.length,N=this.nCachedObjects_,A=new Array(D);u=g.length,h[r]=u,y.push(r),T.push(o),g.push(A);for(var B=N,F=I.length;B!==F;++B){var G=I[B];A[B]=new Kn(G,r,o)}return A},unsubscribe_:function(r){var o=this._bindingsIndicesByPath,h=o[r];if(h!==void 0){var u=this._paths,g=this._parsedPaths,y=this._bindings,T=y.length-1,I=y[T],D=r[T];o[D]=h,y[h]=I,y.pop(),g[h]=g[T],g.pop(),u[h]=u[T],u.pop()}}});function Ju(r,o,h){this._mixer=r,this._clip=o,this._localRoot=h||null;for(var u=o.tracks,g=u.length,y=new Array(g),T={endingStart:ns,endingEnd:ns},I=0;I!==g;++I){var D=u[I].createInterpolant(null);y[I]=D,D.settings=T}this._interpolantSettings=T,this._interpolants=y,this._propertyBindings=new Array(g),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=qt,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}Object.assign(Ju.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(r){return this._startTime=r,this},setLoop:function(r,o){return this.loop=r,this.repetitions=o,this},setEffectiveWeight:function(r){return this.weight=r,this._effectiveWeight=this.enabled?r:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(r){return this._scheduleFading(r,0,1)},fadeOut:function(r){return this._scheduleFading(r,1,0)},crossFadeFrom:function(r,o,h){if(r.fadeOut(o),this.fadeIn(o),h){var u=this._clip.duration,g=r._clip.duration,y=g/u,T=u/g;r.warp(1,y,o),this.warp(T,1,o)}return this},crossFadeTo:function(r,o,h){return r.crossFadeFrom(this,o,h)},stopFading:function(){var r=this._weightInterpolant;return r!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(r)),this},setEffectiveTimeScale:function(r){return this.timeScale=r,this._effectiveTimeScale=this.paused?0:r,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(r){return this.timeScale=this._clip.duration/r,this.stopWarping()},syncWith:function(r){return this.time=r.time,this.timeScale=r.timeScale,this.stopWarping()},halt:function(r){return this.warp(this._effectiveTimeScale,0,r)},warp:function(r,o,h){var u=this._mixer,g=u.time,y=this._timeScaleInterpolant,T=this.timeScale;y===null&&(y=u._lendControlInterpolant(),this._timeScaleInterpolant=y);var I=y.parameterPositions,D=y.sampleValues;return I[0]=g,I[1]=g+h,D[0]=r/T,D[1]=o/T,this},stopWarping:function(){var r=this._timeScaleInterpolant;return r!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(r)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(r,o,h,u){if(!this.enabled){this._updateWeight(r);return}var g=this._startTime;if(g!==null){var y=(r-g)*h;if(y<0||h===0)return;this._startTime=null,o=h*y}o*=this._updateTimeScale(r);var T=this._updateTime(o),I=this._updateWeight(r);if(I>0)for(var D=this._interpolants,N=this._propertyBindings,A=0,B=D.length;A!==B;++A)D[A].evaluate(T),N[A].accumulate(u,I)},_updateWeight:function(r){var o=0;if(this.enabled){o=this.weight;var h=this._weightInterpolant;if(h!==null){var u=h.evaluate(r)[0];o*=u,r>h.parameterPositions[1]&&(this.stopFading(),u===0&&(this.enabled=!1))}}return this._effectiveWeight=o,o},_updateTimeScale:function(r){var o=0;if(!this.paused){o=this.timeScale;var h=this._timeScaleInterpolant;if(h!==null){var u=h.evaluate(r)[0];o*=u,r>h.parameterPositions[1]&&(this.stopWarping(),o===0?this.paused=!0:this.timeScale=o)}}return this._effectiveTimeScale=o,o},_updateTime:function(r){var o=this.time+r;if(r===0)return o;var h=this._clip.duration,u=this.loop,g=this._loopCount;if(u===dl){g===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(o>=h)o=h;else if(o<0)o=0;else break e;this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:r<0?-1:1})}}else{var y=u===wo;if(g===-1&&(r>=0?(g=0,this._setEndings(!0,this.repetitions===0,y)):this._setEndings(this.repetitions===0,!0,y)),o>=h||o<0){var T=Math.floor(o/h);o-=h*T,g+=Math.abs(T);var I=this.repetitions-g;if(I<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,o=r>0?h:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:r>0?1:-1});else{if(I===1){var D=r<0;this._setEndings(D,!D,y)}else this._setEndings(!1,!1,y);this._loopCount=g,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:T})}}if(y&&(g&1)===1)return this.time=o,h-o}return this.time=o,o},_setEndings:function(r,o,h){var u=this._interpolantSettings;h?(u.endingStart=_n,u.endingEnd=_n):(r?u.endingStart=this.zeroSlopeAtStart?_n:ns:u.endingStart=Er,o?u.endingEnd=this.zeroSlopeAtEnd?_n:ns:u.endingEnd=Er)},_scheduleFading:function(r,o,h){var u=this._mixer,g=u.time,y=this._weightInterpolant;y===null&&(y=u._lendControlInterpolant(),this._weightInterpolant=y);var T=y.parameterPositions,I=y.sampleValues;return T[0]=g,I[0]=o,T[1]=g+r,I[1]=h,this}});function yu(r){this._root=r,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}yu.prototype=Object.assign(Object.create(e.prototype),{constructor:yu,_bindAction:function(r,o){var h=r._localRoot||this._root,u=r._clip.tracks,g=u.length,y=r._propertyBindings,T=r._interpolants,I=h.uuid,D=this._bindingsByRootAndName,N=D[I];N===void 0&&(N={},D[I]=N);for(var A=0;A!==g;++A){var B=u[A],F=B.name,G=N[F];if(G!==void 0)y[A]=G;else{if(G=y[A],G!==void 0){G._cacheIndex===null&&(++G.referenceCount,this._addInactiveBinding(G,I,F));continue}var j=o&&o._propertyBindings[A].binding.parsedPath;G=new _u(Kn.create(h,F,j),B.ValueTypeName,B.getValueSize()),++G.referenceCount,this._addInactiveBinding(G,I,F),y[A]=G}T[A].resultBuffer=G.buffer}},_activateAction:function(r){if(!this._isActiveAction(r)){if(r._cacheIndex===null){var o=(r._localRoot||this._root).uuid,h=r._clip.uuid,u=this._actionsByClip[h];this._bindAction(r,u&&u.knownActions[0]),this._addInactiveAction(r,h,o)}for(var g=r._propertyBindings,y=0,T=g.length;y!==T;++y){var I=g[y];I.useCount++===0&&(this._lendBinding(I),I.saveOriginalState())}this._lendAction(r)}},_deactivateAction:function(r){if(this._isActiveAction(r)){for(var o=r._propertyBindings,h=0,u=o.length;h!==u;++h){var g=o[h];--g.useCount===0&&(g.restoreOriginalState(),this._takeBackBinding(g))}this._takeBackAction(r)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var r=this;this.stats={actions:{get total(){return r._actions.length},get inUse(){return r._nActiveActions}},bindings:{get total(){return r._bindings.length},get inUse(){return r._nActiveBindings}},controlInterpolants:{get total(){return r._controlInterpolants.length},get inUse(){return r._nActiveControlInterpolants}}}},_isActiveAction:function(r){var o=r._cacheIndex;return o!==null&&o<this._nActiveActions},_addInactiveAction:function(r,o,h){var u=this._actions,g=this._actionsByClip,y=g[o];if(y===void 0)y={knownActions:[r],actionByRoot:{}},r._byClipCacheIndex=0,g[o]=y;else{var T=y.knownActions;r._byClipCacheIndex=T.length,T.push(r)}r._cacheIndex=u.length,u.push(r),y.actionByRoot[h]=r},_removeInactiveAction:function(r){var o=this._actions,h=o[o.length-1],u=r._cacheIndex;h._cacheIndex=u,o[u]=h,o.pop(),r._cacheIndex=null;var g=r._clip.uuid,y=this._actionsByClip,T=y[g],I=T.knownActions,D=I[I.length-1],N=r._byClipCacheIndex;D._byClipCacheIndex=N,I[N]=D,I.pop(),r._byClipCacheIndex=null;var A=T.actionByRoot,B=(r._localRoot||this._root).uuid;delete A[B],I.length===0&&delete y[g],this._removeInactiveBindingsForAction(r)},_removeInactiveBindingsForAction:function(r){for(var o=r._propertyBindings,h=0,u=o.length;h!==u;++h){var g=o[h];--g.referenceCount===0&&this._removeInactiveBinding(g)}},_lendAction:function(r){var o=this._actions,h=r._cacheIndex,u=this._nActiveActions++,g=o[u];r._cacheIndex=u,o[u]=r,g._cacheIndex=h,o[h]=g},_takeBackAction:function(r){var o=this._actions,h=r._cacheIndex,u=--this._nActiveActions,g=o[u];r._cacheIndex=u,o[u]=r,g._cacheIndex=h,o[h]=g},_addInactiveBinding:function(r,o,h){var u=this._bindingsByRootAndName,g=u[o],y=this._bindings;g===void 0&&(g={},u[o]=g),g[h]=r,r._cacheIndex=y.length,y.push(r)},_removeInactiveBinding:function(r){var o=this._bindings,h=r.binding,u=h.rootNode.uuid,g=h.path,y=this._bindingsByRootAndName,T=y[u],I=o[o.length-1],D=r._cacheIndex;I._cacheIndex=D,o[D]=I,o.pop(),delete T[g];e:{for(var N in T)break e;delete y[u]}},_lendBinding:function(r){var o=this._bindings,h=r._cacheIndex,u=this._nActiveBindings++,g=o[u];r._cacheIndex=u,o[u]=r,g._cacheIndex=h,o[h]=g},_takeBackBinding:function(r){var o=this._bindings,h=r._cacheIndex,u=--this._nActiveBindings,g=o[u];r._cacheIndex=u,o[u]=r,g._cacheIndex=h,o[h]=g},_lendControlInterpolant:function(){var r=this._controlInterpolants,o=this._nActiveControlInterpolants++,h=r[o];return h===void 0&&(h=new ed(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),h.__cacheIndex=o,r[o]=h),h},_takeBackControlInterpolant:function(r){var o=this._controlInterpolants,h=r.__cacheIndex,u=--this._nActiveControlInterpolants,g=o[u];r.__cacheIndex=u,o[u]=r,g.__cacheIndex=h,o[h]=g},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(r,o){var h=o||this._root,u=h.uuid,g=typeof r=="string"?Dr.findByName(h,r):r,y=g!==null?g.uuid:r,T=this._actionsByClip[y],I=null;if(T!==void 0){var D=T.actionByRoot[u];if(D!==void 0)return D;I=T.knownActions[0],g===null&&(g=I._clip)}if(g===null)return null;var N=new Ju(this,g,o);return this._bindAction(N,I),this._addInactiveAction(N,y,u),N},existingAction:function(r,o){var h=o||this._root,u=h.uuid,g=typeof r=="string"?Dr.findByName(h,r):r,y=g?g.uuid:r,T=this._actionsByClip[y];return T!==void 0&&T.actionByRoot[u]||null},stopAllAction:function(){var r=this._actions,o=this._nActiveActions,h=this._bindings,u=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var g=0;g!==o;++g)r[g].reset();for(var g=0;g!==u;++g)h[g].useCount=0;return this},update:function(r){r*=this.timeScale;for(var o=this._actions,h=this._nActiveActions,u=this.time+=r,g=Math.sign(r),y=this._accuIndex^=1,T=0;T!==h;++T){var I=o[T];I._update(u,r,g,y)}for(var D=this._bindings,N=this._nActiveBindings,T=0;T!==N;++T)D[T].apply(y);return this},getRoot:function(){return this._root},uncacheClip:function(r){var o=this._actions,h=r.uuid,u=this._actionsByClip,g=u[h];if(g!==void 0){for(var y=g.knownActions,T=0,I=y.length;T!==I;++T){var D=y[T];this._deactivateAction(D);var N=D._cacheIndex,A=o[o.length-1];D._cacheIndex=null,D._byClipCacheIndex=null,A._cacheIndex=N,o[N]=A,o.pop(),this._removeInactiveBindingsForAction(D)}delete u[h]}},uncacheRoot:function(r){var o=r.uuid,h=this._actionsByClip;for(var u in h){var g=h[u].actionByRoot,y=g[o];y!==void 0&&(this._deactivateAction(y),this._removeInactiveAction(y))}var T=this._bindingsByRootAndName,I=T[o];if(I!==void 0)for(var D in I){var N=I[D];N.restoreOriginalState(),this._removeInactiveBinding(N)}},uncacheAction:function(r,o){var h=this.existingAction(r,o);h!==null&&(this._deactivateAction(h),this._removeInactiveAction(h))}});function Yh(r){typeof r=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),r=arguments[1]),this.value=r}Yh.prototype.clone=function(){return new Yh(this.value.clone===void 0?this.value:this.value.clone())};function Su(){Tt.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}Su.prototype=Object.assign(Object.create(Tt.prototype),{constructor:Su,isInstancedBufferGeometry:!0,copy:function(r){return Tt.prototype.copy.call(this,r),this.maxInstancedCount=r.maxInstancedCount,this},clone:function(){return new this.constructor().copy(this)}});function bu(r,o,h,u){this.data=r,this.itemSize=o,this.offset=h,this.normalized=u===!0}Object.defineProperties(bu.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(bu.prototype,{isInterleavedBufferAttribute:!0,setX:function(r,o){return this.data.array[r*this.data.stride+this.offset]=o,this},setY:function(r,o){return this.data.array[r*this.data.stride+this.offset+1]=o,this},setZ:function(r,o){return this.data.array[r*this.data.stride+this.offset+2]=o,this},setW:function(r,o){return this.data.array[r*this.data.stride+this.offset+3]=o,this},getX:function(r){return this.data.array[r*this.data.stride+this.offset]},getY:function(r){return this.data.array[r*this.data.stride+this.offset+1]},getZ:function(r){return this.data.array[r*this.data.stride+this.offset+2]},getW:function(r){return this.data.array[r*this.data.stride+this.offset+3]},setXY:function(r,o,h){return r=r*this.data.stride+this.offset,this.data.array[r+0]=o,this.data.array[r+1]=h,this},setXYZ:function(r,o,h,u){return r=r*this.data.stride+this.offset,this.data.array[r+0]=o,this.data.array[r+1]=h,this.data.array[r+2]=u,this},setXYZW:function(r,o,h,u,g){return r=r*this.data.stride+this.offset,this.data.array[r+0]=o,this.data.array[r+1]=h,this.data.array[r+2]=u,this.data.array[r+3]=g,this}});function Zo(r,o){this.array=r,this.stride=o,this.count=r!==void 0?r.length/o:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(Zo.prototype,"needsUpdate",{set:function(r){r===!0&&this.version++}}),Object.assign(Zo.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(r){if(Array.isArray(r))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=r!==void 0?r.length/this.stride:0,this.array=r,this},setDynamic:function(r){return this.dynamic=r,this},copy:function(r){return this.array=new r.array.constructor(r.array),this.count=r.count,this.stride=r.stride,this.dynamic=r.dynamic,this},copyAt:function(r,o,h){r*=this.stride,h*=o.stride;for(var u=0,g=this.stride;u<g;u++)this.array[r+u]=o.array[h+u];return this},set:function(r,o){return o===void 0&&(o=0),this.array.set(r,o),this},clone:function(){return new this.constructor().copy(this)},onUpload:function(r){return this.onUploadCallback=r,this}});function Cu(r,o,h){Zo.call(this,r,o),this.meshPerAttribute=h||1}Cu.prototype=Object.assign(Object.create(Zo.prototype),{constructor:Cu,isInstancedInterleavedBuffer:!0,copy:function(r){return Zo.prototype.copy.call(this,r),this.meshPerAttribute=r.meshPerAttribute,this}});function wu(r,o,h){At.call(this,r,o),this.meshPerAttribute=h||1}wu.prototype=Object.assign(Object.create(At.prototype),{constructor:wu,isInstancedBufferAttribute:!0,copy:function(r){return At.prototype.copy.call(this,r),this.meshPerAttribute=r.meshPerAttribute,this}});function $u(r,o,h,u){this.ray=new zn(r,o),this.near=h||0,this.far=u||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Qu(r,o){return r.distance-o.distance}function Tu(r,o,h,u){if(r.visible!==!1&&(r.raycast(o,h),u===!0))for(var g=r.children,y=0,T=g.length;y<T;y++)Tu(g[y],o,h,!0)}Object.assign($u.prototype,{linePrecision:1,set:function(r,o){this.ray.set(r,o)},setFromCamera:function(r,o){o&&o.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(o.matrixWorld),this.ray.direction.set(r.x,r.y,.5).unproject(o).sub(this.ray.origin).normalize()):o&&o.isOrthographicCamera?(this.ray.origin.set(r.x,r.y,(o.near+o.far)/(o.near-o.far)).unproject(o),this.ray.direction.set(0,0,-1).transformDirection(o.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(r,o,h){var u=h||[];return Tu(r,this,u,o),u.sort(Qu),u},intersectObjects:function(r,o,h){var u=h||[];if(Array.isArray(r)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),u;for(var g=0,y=r.length;g<y;g++)Tu(r[g],this,u,o);return u.sort(Qu),u}});function Zu(r){this.autoStart=r!==void 0?r:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(Zu.prototype,{start:function(){this.startTime=(typeof performance>"u"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var r=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var o=(typeof performance>"u"?Date:performance).now();r=(o-this.oldTime)/1e3,this.oldTime=o,this.elapsedTime+=r}return r}});function ep(r,o,h){return this.radius=r!==void 0?r:1,this.phi=o!==void 0?o:0,this.theta=h!==void 0?h:0,this}Object.assign(ep.prototype,{set:function(r,o,h){return this.radius=r,this.phi=o,this.theta=h,this},clone:function(){return new this.constructor().copy(this)},copy:function(r){return this.radius=r.radius,this.phi=r.phi,this.theta=r.theta,this},makeSafe:function(){var r=1e-6;return this.phi=Math.max(r,Math.min(Math.PI-r,this.phi)),this},setFromVector3:function(r){return this.radius=r.length(),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(r.x,r.z),this.phi=Math.acos(si.clamp(r.y/this.radius,-1,1))),this}});function tp(r,o,h){return this.radius=r!==void 0?r:1,this.theta=o!==void 0?o:0,this.y=h!==void 0?h:0,this}Object.assign(tp.prototype,{set:function(r,o,h){return this.radius=r,this.theta=o,this.y=h,this},clone:function(){return new this.constructor().copy(this)},copy:function(r){return this.radius=r.radius,this.theta=r.theta,this.y=r.y,this},setFromVector3:function(r){return this.radius=Math.sqrt(r.x*r.x+r.z*r.z),this.theta=Math.atan2(r.x,r.z),this.y=r.y,this}});function Eu(r,o){this.min=r!==void 0?r:new rt(1/0,1/0),this.max=o!==void 0?o:new rt(-1/0,-1/0)}Object.assign(Eu.prototype,{set:function(r,o){return this.min.copy(r),this.max.copy(o),this},setFromPoints:function(r){this.makeEmpty();for(var o=0,h=r.length;o<h;o++)this.expandByPoint(r[o]);return this},setFromCenterAndSize:function(){var r=new rt;return function(h,u){var g=r.copy(u).multiplyScalar(.5);return this.min.copy(h).sub(g),this.max.copy(h).add(g),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(r){return this.min.copy(r.min),this.max.copy(r.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(r){return r===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),r=new rt),this.isEmpty()?r.set(0,0):r.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(r){return r===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),r=new rt),this.isEmpty()?r.set(0,0):r.subVectors(this.max,this.min)},expandByPoint:function(r){return this.min.min(r),this.max.max(r),this},expandByVector:function(r){return this.min.sub(r),this.max.add(r),this},expandByScalar:function(r){return this.min.addScalar(-r),this.max.addScalar(r),this},containsPoint:function(r){return!(r.x<this.min.x||r.x>this.max.x||r.y<this.min.y||r.y>this.max.y)},containsBox:function(r){return this.min.x<=r.min.x&&r.max.x<=this.max.x&&this.min.y<=r.min.y&&r.max.y<=this.max.y},getParameter:function(r,o){return o===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),o=new rt),o.set((r.x-this.min.x)/(this.max.x-this.min.x),(r.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(r){return!(r.max.x<this.min.x||r.min.x>this.max.x||r.max.y<this.min.y||r.min.y>this.max.y)},clampPoint:function(r,o){return o===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),o=new rt),o.copy(r).clamp(this.min,this.max)},distanceToPoint:function(){var r=new rt;return function(h){var u=r.copy(h).clamp(this.min,this.max);return u.sub(h).length()}}(),intersect:function(r){return this.min.max(r.min),this.max.min(r.max),this},union:function(r){return this.min.min(r.min),this.max.max(r.max),this},translate:function(r){return this.min.add(r),this.max.add(r),this},equals:function(r){return r.min.equals(this.min)&&r.max.equals(this.max)}});function id(r){vt.call(this),this.material=r,this.render=function(){}}id.prototype=Object.create(vt.prototype),id.prototype.constructor=id,id.prototype.isImmediateRenderObject=!0;function nd(r,o,h,u){this.object=r,this.size=o!==void 0?o:1;var g=h!==void 0?h:16711680,y=u!==void 0?u:1,T=0,I=this.object.geometry;I&&I.isGeometry?T=I.faces.length*3:I&&I.isBufferGeometry&&(T=I.attributes.normal.count);var D=new Tt,N=new _t(T*2*3,3);D.addAttribute("position",N),Li.call(this,D,new Di({color:g,linewidth:y})),this.matrixAutoUpdate=!1,this.update()}nd.prototype=Object.create(Li.prototype),nd.prototype.constructor=nd,nd.prototype.update=function(){var r=new he,o=new he,h=new wn;return function(){var g=["a","b","c"];this.object.updateMatrixWorld(!0),h.getNormalMatrix(this.object.matrixWorld);var y=this.object.matrixWorld,T=this.geometry.attributes.position,I=this.object.geometry;if(I&&I.isGeometry)for(var D=I.vertices,N=I.faces,A=0,B=0,F=N.length;B<F;B++)for(var G=N[B],j=0,$=G.vertexNormals.length;j<$;j++){var Z=D[G[g[j]]],Q=G.vertexNormals[j];r.copy(Z).applyMatrix4(y),o.copy(Q).applyMatrix3(h).normalize().multiplyScalar(this.size).add(r),T.setXYZ(A,r.x,r.y,r.z),A=A+1,T.setXYZ(A,o.x,o.y,o.z),A=A+1}else if(I&&I.isBufferGeometry)for(var ie=I.attributes.position,ne=I.attributes.normal,A=0,j=0,$=ie.count;j<$;j++)r.set(ie.getX(j),ie.getY(j),ie.getZ(j)).applyMatrix4(y),o.set(ne.getX(j),ne.getY(j),ne.getZ(j)),o.applyMatrix3(h).normalize().multiplyScalar(this.size).add(r),T.setXYZ(A,r.x,r.y,r.z),A=A+1,T.setXYZ(A,o.x,o.y,o.z),A=A+1;T.needsUpdate=!0}}();function el(r,o){vt.call(this),this.light=r,this.light.updateMatrixWorld(),this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1,this.color=o;for(var h=new Tt,u=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],g=0,y=1,T=32;g<T;g++,y++){var I=g/T*Math.PI*2,D=y/T*Math.PI*2;u.push(Math.cos(I),Math.sin(I),1,Math.cos(D),Math.sin(D),1)}h.addAttribute("position",new _t(u,3));var N=new Di({fog:!1});this.cone=new Li(h,N),this.add(this.cone),this.update()}el.prototype=Object.create(vt.prototype),el.prototype.constructor=el,el.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},el.prototype.update=function(){var r=new he,o=new he;return function(){this.light.updateMatrixWorld();var u=this.light.distance?this.light.distance:1e3,g=u*Math.tan(this.light.angle);this.cone.scale.set(g,g,u),r.setFromMatrixPosition(this.light.matrixWorld),o.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(o.sub(r)),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}();function ip(r){var o=[];r&&r.isBone&&o.push(r);for(var h=0;h<r.children.length;h++)o.push.apply(o,ip(r.children[h]));return o}function tl(r){for(var o=ip(r),h=new Tt,u=[],g=[],y=new Mt(0,0,1),T=new Mt(0,1,0),I=0;I<o.length;I++){var D=o[I];D.parent&&D.parent.isBone&&(u.push(0,0,0),u.push(0,0,0),g.push(y.r,y.g,y.b),g.push(T.r,T.g,T.b))}h.addAttribute("position",new _t(u,3)),h.addAttribute("color",new _t(g,3));var N=new Di({vertexColors:H,depthTest:!1,depthWrite:!1,transparent:!0});Li.call(this,h,N),this.root=r,this.bones=o,this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1}tl.prototype=Object.create(Li.prototype),tl.prototype.constructor=tl,tl.prototype.updateMatrixWorld=function(){var r=new he,o=new Ot,h=new Ot;return function(g){var y=this.bones,T=this.geometry,I=T.getAttribute("position");h.getInverse(this.root.matrixWorld);for(var D=0,N=0;D<y.length;D++){var A=y[D];A.parent&&A.parent.isBone&&(o.multiplyMatrices(h,A.matrixWorld),r.setFromMatrixPosition(o),I.setXYZ(N,r.x,r.y,r.z),o.multiplyMatrices(h,A.parent.matrixWorld),r.setFromMatrixPosition(o),I.setXYZ(N+1,r.x,r.y,r.z),N+=2)}T.getAttribute("position").needsUpdate=!0,vt.prototype.updateMatrixWorld.call(this,g)}}();function il(r,o,h){this.light=r,this.light.updateMatrixWorld(),this.color=h;var u=new Ti(o,4,2),g=new ai({wireframe:!0,fog:!1});Mn.call(this,u,g),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}il.prototype=Object.create(Mn.prototype),il.prototype.constructor=il,il.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},il.prototype.update=function(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)};function nl(r,o){vt.call(this),this.light=r,this.light.updateMatrixWorld(),this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1,this.color=o;var h=new Di({fog:!1}),u=new Tt;u.addAttribute("position",new At(new Float32Array(5*3),3)),this.line=new Bn(u,h),this.add(this.line),this.update()}nl.prototype=Object.create(vt.prototype),nl.prototype.constructor=nl,nl.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},nl.prototype.update=function(){var r=this.light.width*.5,o=this.light.height*.5,h=this.line.geometry.attributes.position,u=h.array;u[0]=r,u[1]=-o,u[2]=0,u[3]=r,u[4]=o,u[5]=0,u[6]=-r,u[7]=o,u[8]=0,u[9]=-r,u[10]=-o,u[11]=0,u[12]=r,u[13]=-o,u[14]=0,h.needsUpdate=!0,this.color!==void 0?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)};function rl(r,o,h){vt.call(this),this.light=r,this.light.updateMatrixWorld(),this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1,this.color=h;var u=new vn(o);u.rotateY(Math.PI*.5),this.material=new ai({wireframe:!0,fog:!1}),this.color===void 0&&(this.material.vertexColors=H);var g=u.getAttribute("position"),y=new Float32Array(g.count*3);u.addAttribute("color",new At(y,3)),this.add(new Mn(u,this.material)),this.update()}rl.prototype=Object.create(vt.prototype),rl.prototype.constructor=rl,rl.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},rl.prototype.update=function(){var r=new he,o=new Mt,h=new Mt;return function(){var g=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var y=g.geometry.getAttribute("color");o.copy(this.light.color),h.copy(this.light.groundColor);for(var T=0,I=y.count;T<I;T++){var D=T<I/2?o:h;y.setXYZ(T,D.r,D.g,D.b)}y.needsUpdate=!0}g.lookAt(r.setFromMatrixPosition(this.light.matrixWorld).negate())}}();function rd(r,o,h,u){r=r||10,o=o||10,h=new Mt(h!==void 0?h:4473924),u=new Mt(u!==void 0?u:8947848);for(var g=o/2,y=r/o,T=r/2,I=[],D=[],N=0,A=0,B=-T;N<=o;N++,B+=y){I.push(-T,0,B,T,0,B),I.push(B,0,-T,B,0,T);var F=N===g?h:u;F.toArray(D,A),A+=3,F.toArray(D,A),A+=3,F.toArray(D,A),A+=3,F.toArray(D,A),A+=3}var G=new Tt;G.addAttribute("position",new _t(I,3)),G.addAttribute("color",new _t(D,3));var j=new Di({vertexColors:H});Li.call(this,G,j)}rd.prototype=Object.create(Li.prototype),rd.prototype.constructor=rd;function Jh(r,o,h,u,g,y){r=r||10,o=o||16,h=h||8,u=u||64,g=new Mt(g!==void 0?g:4473924),y=new Mt(y!==void 0?y:8947848);var T=[],I=[],D,N,A,B,F,G,j;for(B=0;B<=o;B++)A=B/o*(Math.PI*2),D=Math.sin(A)*r,N=Math.cos(A)*r,T.push(0,0,0),T.push(D,0,N),j=B&1?g:y,I.push(j.r,j.g,j.b),I.push(j.r,j.g,j.b);for(B=0;B<=h;B++)for(j=B&1?g:y,G=r-r/h*B,F=0;F<u;F++)A=F/u*(Math.PI*2),D=Math.sin(A)*G,N=Math.cos(A)*G,T.push(D,0,N),I.push(j.r,j.g,j.b),A=(F+1)/u*(Math.PI*2),D=Math.sin(A)*G,N=Math.cos(A)*G,T.push(D,0,N),I.push(j.r,j.g,j.b);var $=new Tt;$.addAttribute("position",new _t(T,3)),$.addAttribute("color",new _t(I,3));var Z=new Di({vertexColors:H});Li.call(this,$,Z)}Jh.prototype=Object.create(Li.prototype),Jh.prototype.constructor=Jh;function sd(r,o,h,u){this.object=r,this.size=o!==void 0?o:1;var g=h!==void 0?h:16776960,y=u!==void 0?u:1,T=0,I=this.object.geometry;I&&I.isGeometry?T=I.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var D=new Tt,N=new _t(T*2*3,3);D.addAttribute("position",N),Li.call(this,D,new Di({color:g,linewidth:y})),this.matrixAutoUpdate=!1,this.update()}sd.prototype=Object.create(Li.prototype),sd.prototype.constructor=sd,sd.prototype.update=function(){var r=new he,o=new he,h=new wn;return function(){this.object.updateMatrixWorld(!0),h.getNormalMatrix(this.object.matrixWorld);for(var g=this.object.matrixWorld,y=this.geometry.attributes.position,T=this.object.geometry,I=T.vertices,D=T.faces,N=0,A=0,B=D.length;A<B;A++){var F=D[A],G=F.normal;r.copy(I[F.a]).add(I[F.b]).add(I[F.c]).divideScalar(3).applyMatrix4(g),o.copy(G).applyMatrix3(h).normalize().multiplyScalar(this.size).add(r),y.setXYZ(N,r.x,r.y,r.z),N=N+1,y.setXYZ(N,o.x,o.y,o.z),N=N+1}y.needsUpdate=!0}}();function sl(r,o,h){vt.call(this),this.light=r,this.light.updateMatrixWorld(),this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1,this.color=h,o===void 0&&(o=1);var u=new Tt;u.addAttribute("position",new _t([-o,o,0,o,o,0,o,-o,0,-o,-o,0,-o,o,0],3));var g=new Di({fog:!1});this.lightPlane=new Bn(u,g),this.add(this.lightPlane),u=new Tt,u.addAttribute("position",new _t([0,0,0,0,0,1],3)),this.targetLine=new Bn(u,g),this.add(this.targetLine),this.update()}sl.prototype=Object.create(vt.prototype),sl.prototype.constructor=sl,sl.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},sl.prototype.update=function(){var r=new he,o=new he,h=new he;return function(){r.setFromMatrixPosition(this.light.matrixWorld),o.setFromMatrixPosition(this.light.target.matrixWorld),h.subVectors(o,r),this.lightPlane.lookAt(h),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(h),this.targetLine.scale.z=h.length()}}();function ad(r){var o=new Tt,h=new Di({color:16777215,vertexColors:V}),u=[],g=[],y={},T=new Mt(16755200),I=new Mt(16711680),D=new Mt(43775),N=new Mt(16777215),A=new Mt(3355443);B("n1","n2",T),B("n2","n4",T),B("n4","n3",T),B("n3","n1",T),B("f1","f2",T),B("f2","f4",T),B("f4","f3",T),B("f3","f1",T),B("n1","f1",T),B("n2","f2",T),B("n3","f3",T),B("n4","f4",T),B("p","n1",I),B("p","n2",I),B("p","n3",I),B("p","n4",I),B("u1","u2",D),B("u2","u3",D),B("u3","u1",D),B("c","t",N),B("p","c",A),B("cn1","cn2",A),B("cn3","cn4",A),B("cf1","cf2",A),B("cf3","cf4",A);function B(G,j,$){F(G,$),F(j,$)}function F(G,j){u.push(0,0,0),g.push(j.r,j.g,j.b),y[G]===void 0&&(y[G]=[]),y[G].push(u.length/3-1)}o.addAttribute("position",new _t(u,3)),o.addAttribute("color",new _t(g,3)),Li.call(this,o,h),this.camera=r,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=y,this.update()}ad.prototype=Object.create(Li.prototype),ad.prototype.constructor=ad,ad.prototype.update=function(){var r,o,h=new he,u=new Ir;function g(y,T,I,D){h.set(T,I,D).unproject(u);var N=o[y];if(N!==void 0)for(var A=r.getAttribute("position"),B=0,F=N.length;B<F;B++)A.setXYZ(N[B],h.x,h.y,h.z)}return function(){r=this.geometry,o=this.pointMap;var T=1,I=1;u.projectionMatrix.copy(this.camera.projectionMatrix),g("c",0,0,-1),g("t",0,0,1),g("n1",-T,-I,-1),g("n2",T,-I,-1),g("n3",-T,I,-1),g("n4",T,I,-1),g("f1",-T,-I,1),g("f2",T,-I,1),g("f3",-T,I,1),g("f4",T,I,1),g("u1",T*.7,I*1.1,-1),g("u2",-T*.7,I*1.1,-1),g("u3",0,I*2,-1),g("cf1",-T,0,1),g("cf2",T,0,1),g("cf3",0,-I,1),g("cf4",0,I,1),g("cn1",-T,0,-1),g("cn2",T,0,-1),g("cn3",0,-I,-1),g("cn4",0,I,-1),r.getAttribute("position").needsUpdate=!0}}();function fo(r,o){this.object=r,o===void 0&&(o=16776960);var h=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),u=new Float32Array(8*3),g=new Tt;g.setIndex(new At(h,1)),g.addAttribute("position",new At(u,3)),Li.call(this,g,new Di({color:o})),this.matrixAutoUpdate=!1,this.update()}fo.prototype=Object.create(Li.prototype),fo.prototype.constructor=fo,fo.prototype.update=function(){var r=new Jn;return function(h){if(h!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&r.setFromObject(this.object),!r.isEmpty()){var u=r.min,g=r.max,y=this.geometry.attributes.position,T=y.array;T[0]=g.x,T[1]=g.y,T[2]=g.z,T[3]=u.x,T[4]=g.y,T[5]=g.z,T[6]=u.x,T[7]=u.y,T[8]=g.z,T[9]=g.x,T[10]=u.y,T[11]=g.z,T[12]=g.x,T[13]=g.y,T[14]=u.z,T[15]=u.x,T[16]=g.y,T[17]=u.z,T[18]=u.x,T[19]=u.y,T[20]=u.z,T[21]=g.x,T[22]=u.y,T[23]=u.z,y.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),fo.prototype.setFromObject=function(r){return this.object=r,this.update(),this};function od(r,o){this.type="Box3Helper",this.box=r;var h=o!==void 0?o:16776960,u=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),g=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],y=new Tt;y.setIndex(new At(u,1)),y.addAttribute("position",new _t(g,3)),Li.call(this,y,new Di({color:h})),this.geometry.computeBoundingSphere()}od.prototype=Object.create(Li.prototype),od.prototype.constructor=od,od.prototype.updateMatrixWorld=function(r){var o=this.box;o.isEmpty()||(o.getCenter(this.position),o.getSize(this.scale),this.scale.multiplyScalar(.5),vt.prototype.updateMatrixWorld.call(this,r))};function ld(r,o,h){this.type="PlaneHelper",this.plane=r,this.size=o===void 0?1:o;var u=h!==void 0?h:16776960,g=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],y=new Tt;y.addAttribute("position",new _t(g,3)),y.computeBoundingSphere(),Bn.call(this,y,new Di({color:u}));var T=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],I=new Tt;I.addAttribute("position",new _t(T,3)),I.computeBoundingSphere(),this.add(new Mn(I,new ai({color:u,opacity:.2,transparent:!0,depthWrite:!1})))}ld.prototype=Object.create(Bn.prototype),ld.prototype.constructor=ld,ld.prototype.updateMatrixWorld=function(r){var o=-this.plane.constant;Math.abs(o)<1e-8&&(o=1e-8),this.scale.set(.5*this.size,.5*this.size,o),this.children[0].material.side=o<0?E:S,this.lookAt(this.plane.normal),vt.prototype.updateMatrixWorld.call(this,r)};var $h,xu;function go(r,o,h,u,g,y){vt.call(this),u===void 0&&(u=16776960),h===void 0&&(h=1),g===void 0&&(g=.2*h),y===void 0&&(y=.2*g),$h===void 0&&($h=new Tt,$h.addAttribute("position",new _t([0,0,0,0,1,0],3)),xu=new Wn(0,.5,1,5,1),xu.translate(0,-.5,0)),this.position.copy(o),this.line=new Bn($h,new Di({color:u})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Mn(xu,new ai({color:u})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(r),this.setLength(h,g,y)}go.prototype=Object.create(vt.prototype),go.prototype.constructor=go,go.prototype.setDirection=function(){var r=new he,o;return function(u){u.y>.99999?this.quaternion.set(0,0,0,1):u.y<-.99999?this.quaternion.set(1,0,0,0):(r.set(u.z,0,-u.x).normalize(),o=Math.acos(u.y),this.quaternion.setFromAxisAngle(r,o))}}(),go.prototype.setLength=function(r,o,h){o===void 0&&(o=.2*r),h===void 0&&(h=.2*o),this.line.scale.set(1,Math.max(0,r-o),1),this.line.updateMatrix(),this.cone.scale.set(h,o,h),this.cone.position.y=r,this.cone.updateMatrix()},go.prototype.setColor=function(r){this.line.material.color.copy(r),this.cone.material.color.copy(r)};function dd(r){r=r||1;var o=[0,0,0,r,0,0,0,0,0,0,r,0,0,0,0,0,0,r],h=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],u=new Tt;u.addAttribute("position",new _t(o,3)),u.addAttribute("color",new _t(h,3));var g=new Di({vertexColors:H});Li.call(this,u,g)}dd.prototype=Object.create(Li.prototype),dd.prototype.constructor=dd;function Mp(r,o,h,u,g,y,T){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new tn(r,o,h,g,y,T)}var kp=0,Dp=1;function Lp(r){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),r}function Np(r){return r===void 0&&(r=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),r.isMultiMaterial=!0,r.materials=r,r.clone=function(){return r.slice()},r}function Pp(r,o){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new zs(r,o)}function Ap(r){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new to(r)}function Bp(r,o){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new zs(r,o)}function Fp(r){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new gr(r)}function Op(r){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new gr(r)}function Vp(r){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new gr(r)}function Up(r,o,h){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new he(r,o,h)}function zp(r,o){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new At(r,o).setDynamic(!0)}function Gp(r,o){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new on(r,o)}function Hp(r,o){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new sr(r,o)}function Wp(r,o){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new ar(r,o)}function jp(r,o){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new ls(r,o)}function qp(r,o){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Bs(r,o)}function Kp(r,o){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new aa(r,o)}function Xp(r,o){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new pr(r,o)}function Yp(r,o){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new _t(r,o)}function Jp(r,o){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new ds(r,o)}zt.create=function(r,o){return console.log("THREE.Curve.create() has been deprecated"),r.prototype=Object.create(zt.prototype),r.prototype.constructor=r,r.prototype.getPoint=o,r},Object.assign(Ys.prototype,{createPointsGeometry:function(r){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var o=this.getPoints(r);return this.createGeometry(o)},createSpacedPointsGeometry:function(r){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var o=this.getSpacedPoints(r);return this.createGeometry(o)},createGeometry:function(r){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var o=new xt,h=0,u=r.length;h<u;h++){var g=r[h];o.vertices.push(new he(g.x,g.y,g.z||0))}return o}}),Object.assign(Zr.prototype,{fromPoints:function(r){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(r)}});function np(r){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),jn.call(this,r),this.type="catmullrom",this.closed=!0}np.prototype=Object.create(jn.prototype);function rp(r){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),jn.call(this,r),this.type="catmullrom"}rp.prototype=Object.create(jn.prototype);function Iu(r){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),jn.call(this,r),this.type="catmullrom"}Iu.prototype=Object.create(jn.prototype),Object.assign(Iu.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}});function $p(r){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new dd(r)}function Qp(r,o){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new fo(r,o)}function Zp(r,o){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Li(new vr(r.geometry),new Di({color:o!==void 0?o:16777215}))}rd.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},tl.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};function em(r,o){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Li(new va(r.geometry),new Di({color:o!==void 0?o:16777215}))}Object.assign($o.prototype,{extractUrlBase:function(r){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),ou.extractUrlBase(r)}});function tm(r){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Xr(r)}function im(r){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new eu(r)}Object.assign(Eu.prototype,{center:function(r){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(r)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(r){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(r)},size:function(r){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(r)}}),Object.assign(Jn.prototype,{center:function(r){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(r)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(r){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(r)},isIntersectionSphere:function(r){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(r)},size:function(r){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(r)}}),Qn.prototype.center=function(r){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(r)},Object.assign(si,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(r){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),si.floorPowerOfTwo(r)},nextPowerOfTwo:function(r){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),si.ceilPowerOfTwo(r)}}),Object.assign(wn.prototype,{flattenToArrayOffset:function(r,o){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(r,o)},multiplyVector3:function(r){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),r.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(r){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(r)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Ot.prototype,{extractPosition:function(r){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(r)},flattenToArrayOffset:function(r,o){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(r,o)},getPosition:function(){var r;return function(){return r===void 0&&(r=new he),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),r.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(r){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(r)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(r){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)},multiplyVector4:function(r){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(r){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),r.transformDirection(this)},crossVector:function(r){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(r){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(r)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(r,o,h,u,g,y){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(r,o,u,h,g,y)}}),rr.prototype.isIntersectionLine=function(r){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(r)},en.prototype.multiplyVector3=function(r){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),r.applyQuaternion(this)},Object.assign(zn.prototype,{isIntersectionBox:function(r){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(r)},isIntersectionPlane:function(r){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(r)},isIntersectionSphere:function(r){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(r)}}),Object.assign(Gn.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(r,o){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(r,o)},midpoint:function(r){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(r)},normal:function(r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(r)},plane:function(r){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(r)}}),Object.assign(Gn,{barycoordFromPoint:function(r,o,h,u,g){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Gn.getBarycoord(r,o,h,u,g)},normal:function(r,o,h,u){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Gn.getNormal(r,o,h,u)}}),Object.assign(Ta.prototype,{extractAllPoints:function(r){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(r)},extrude:function(r){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new wt(this,r)},makeGeometry:function(r){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Hn(this,r)}}),Object.assign(rt.prototype,{fromAttribute:function(r,o,h){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,o,h)},distanceToManhattan:function(r){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(r)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(he.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(r){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(r)},getScaleFromMatrix:function(r){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(r)},getColumnFromMatrix:function(r,o){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(o,r)},applyProjection:function(r){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(r)},fromAttribute:function(r,o,h){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,o,h)},distanceToManhattan:function(r){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(r)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(wi.prototype,{fromAttribute:function(r,o,h){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,o,h)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(xt.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(vt.prototype,{getChildByName:function(r){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(r)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(r,o){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(o,r)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(vt.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(r){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=r}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(ps.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(ms.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(zt.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(r){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=r}}),nn.prototype.setLens=function(r,o){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),o!==void 0&&(this.filmGauge=o),this.setFocalLength(r)},Object.defineProperties(hn.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(r){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=r}},shadowCameraLeft:{set:function(r){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=r}},shadowCameraRight:{set:function(r){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=r}},shadowCameraTop:{set:function(r){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=r}},shadowCameraBottom:{set:function(r){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=r}},shadowCameraNear:{set:function(r){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=r}},shadowCameraFar:{set:function(r){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=r}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(r){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=r}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(r){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=r}},shadowMapHeight:{set:function(r){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=r}}}),Object.defineProperties(At.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}}),Object.assign(Tt.prototype,{addIndex:function(r){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(r)},addDrawCall:function(r,o,h){h!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(r,o)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(Tt.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.assign(Ht.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(Yh.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Xt.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Mt}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(r){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===R}}}),Object.defineProperties(Kr.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties($i.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(r){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=r}}}),Object.assign(Za.prototype,{animate:function(r){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(r)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(r){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(r)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")}}),Object.defineProperties(Za.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(r){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=r}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(r){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=r}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Vs.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Nn.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(r){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=r}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(r){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=r}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(r){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=r}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(r){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=r}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(r){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=r}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(r){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=r}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(r){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=r}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(r){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=r}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(r){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=r}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(r){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=r}}}),Object.defineProperties(Xl.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}}}),Qo.prototype.load=function(r){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var o=this,h=new pu;return h.load(r,function(u){o.setBuffer(u)}),this},gu.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},td.prototype.updateCubeMap=function(r,o){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(r,o)};var nm={merge:function(r,o,h){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var u;o.isMesh&&(o.matrixAutoUpdate&&o.updateMatrix(),u=o.matrix,o=o.geometry),r.merge(o,u,h)},center:function(r){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),r.center()}},rm={crossOrigin:void 0,loadTexture:function(r,o,h,u){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var g=new Dh;g.setCrossOrigin(this.crossOrigin);var y=g.load(r,h,void 0,u);return o&&(y.mapping=o),y},loadTextureCube:function(r,o,h,u){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var g=new tu;g.setCrossOrigin(this.crossOrigin);var y=g.load(r,h,void 0,u);return o&&(y.mapping=o),y},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};function sm(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(r,o){console.warn("THREE.Projector: .projectVector() is now vector.project()."),r.project(o)},this.unprojectVector=function(r,o){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),r.unproject(o)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}}function am(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}}var om={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};function lm(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")}c.WebGLRenderTargetCube=rs,c.WebGLRenderTarget=Nn,c.WebGLRenderer=Za,c.ShaderLib=Ps,c.UniformsLib=Pt,c.UniformsUtils=Tn,c.ShaderChunk=Si,c.FogExp2=Us,c.Fog=_a,c.Scene=eo,c.Sprite=to,c.LOD=ps,c.SkinnedMesh=Wo,c.Skeleton=ms,c.Bone=Ho,c.Mesh=Mn,c.LineSegments=Li,c.LineLoop=io,c.Line=Bn,c.Points=zs,c.Group=ga,c.VideoTexture=fs,c.DataTexture=ss,c.CompressedTexture=Gs,c.CubeTexture=Ur,c.CanvasTexture=Hr,c.DepthTexture=gs,c.Texture=Ci,c.CompressedTextureLoader=Vu,c.DataTextureLoader=eu,c.CubeTextureLoader=tu,c.TextureLoader=Dh,c.ObjectLoader=Hu,c.MaterialLoader=Kh,c.BufferGeometryLoader=au,c.DefaultLoadingManager=or,c.LoadingManager=Zc,c.JSONLoader=lu,c.ImageLoader=Jl,c.ImageBitmapLoader=du,c.FontLoader=qu,c.FileLoader=Xr,c.Loader=$o,c.LoaderUtils=ou,c.Cache=po,c.AudioLoader=pu,c.SpotLightShadow=Ph,c.SpotLight=Ah,c.PointLight=Bh,c.RectAreaLight=Uh,c.HemisphereLight=Nh,c.DirectionalLightShadow=Fh,c.DirectionalLight=Oh,c.AmbientLight=Vh,c.LightShadow=mo,c.Light=hn,c.StereoCamera=Ku,c.PerspectiveCamera=nn,c.OrthographicCamera=sa,c.CubeCamera=td,c.ArrayCamera=us,c.Camera=Ir,c.AudioListener=mu,c.PositionalAudio=fu,c.AudioContext=uu,c.AudioAnalyser=gu,c.Audio=Qo,c.VectorKeyframeTrack=Jo,c.StringKeyframeTrack=zh,c.QuaternionKeyframeTrack=Zl,c.NumberKeyframeTrack=Yo,c.ColorKeyframeTrack=Wh,c.BooleanKeyframeTrack=Gh,c.PropertyMixer=_u,c.PropertyBinding=Kn,c.KeyframeTrack=xn,c.AnimationUtils=qn,c.AnimationObjectGroup=Yu,c.AnimationMixer=yu,c.AnimationClip=Dr,c.Uniform=Yh,c.InstancedBufferGeometry=Su,c.BufferGeometry=Tt,c.Geometry=xt,c.InterleavedBufferAttribute=bu,c.InstancedInterleavedBuffer=Cu,c.InterleavedBuffer=Zo,c.InstancedBufferAttribute=wu,c.Face3=tn,c.Object3D=vt,c.Raycaster=$u,c.Layers=Ll,c.EventDispatcher=e,c.Clock=Zu,c.QuaternionLinearInterpolant=Hh,c.LinearInterpolant=ed,c.DiscreteInterpolant=qh,c.CubicInterpolant=jh,c.Interpolant=Sr,c.Triangle=Gn,c.Math=si,c.Spherical=ep,c.Cylindrical=tp,c.Plane=rr,c.Frustum=as,c.Sphere=nr,c.Ray=zn,c.Matrix4=Ot,c.Matrix3=wn,c.Box3=Jn,c.Box2=Eu,c.Line3=Qn,c.Euler=As,c.Vector4=wi,c.Vector3=he,c.Vector2=rt,c.Quaternion=en,c.Color=Mt,c.ImmediateRenderObject=id,c.VertexNormalsHelper=nd,c.SpotLightHelper=el,c.SkeletonHelper=tl,c.PointLightHelper=il,c.RectAreaLightHelper=nl,c.HemisphereLightHelper=rl,c.GridHelper=rd,c.PolarGridHelper=Jh,c.FaceNormalsHelper=sd,c.DirectionalLightHelper=sl,c.CameraHelper=ad,c.BoxHelper=fo,c.Box3Helper=od,c.PlaneHelper=ld,c.ArrowHelper=go,c.AxesHelper=dd,c.Shape=Ta,c.Path=Zr,c.ShapePath=hu,c.Font=cu,c.CurvePath=Ys,c.Curve=zt,c.ShapeUtils=dt,c.WebGLUtils=Qa,c.WireframeGeometry=va,c.ParametricGeometry=jr,c.ParametricBufferGeometry=ya,c.TetrahedronGeometry=ro,c.TetrahedronBufferGeometry=_s,c.OctahedronGeometry=qr,c.OctahedronBufferGeometry=vn,c.IcosahedronGeometry=vs,c.IcosahedronBufferGeometry=ys,c.DodecahedronGeometry=Sa,c.DodecahedronBufferGeometry=Hs,c.PolyhedronGeometry=no,c.PolyhedronBufferGeometry=di,c.TubeGeometry=ba,c.TubeBufferGeometry=Ws,c.TorusKnotGeometry=Ca,c.TorusKnotBufferGeometry=wa,c.TorusGeometry=js,c.TorusBufferGeometry=qs,c.TextGeometry=Ii,c.TextBufferGeometry=Vi,c.SphereGeometry=Qi,c.SphereBufferGeometry=Ti,c.RingGeometry=Xi,c.RingBufferGeometry=Pi,c.PlaneGeometry=Fs,c.PlaneBufferGeometry=hs,c.LatheGeometry=Ri,c.LatheBufferGeometry=Zi,c.ShapeGeometry=Hn,c.ShapeBufferGeometry=_r,c.ExtrudeGeometry=wt,c.ExtrudeBufferGeometry=Ht,c.EdgesGeometry=vr,c.ConeGeometry=rn,c.ConeBufferGeometry=ao,c.CylinderGeometry=Bi,c.CylinderBufferGeometry=Wn,c.CircleGeometry=kr,c.CircleBufferGeometry=Ss,c.BoxGeometry=oa,c.BoxBufferGeometry=Vr,c.ShadowMaterial=Ks,c.SpriteMaterial=Wr,c.RawShaderMaterial=Ko,c.ShaderMaterial=$i,c.PointsMaterial=gr,c.MeshPhysicalMaterial=oo,c.MeshStandardMaterial=bs,c.MeshPhongMaterial=Kr,c.MeshToonMaterial=lo,c.MeshNormalMaterial=ho,c.MeshLambertMaterial=co,c.MeshDepthMaterial=Gr,c.MeshDistanceMaterial=fr,c.MeshBasicMaterial=ai,c.LineDashedMaterial=uo,c.LineBasicMaterial=Di,c.Material=Xt,c.Float64BufferAttribute=ds,c.Float32BufferAttribute=_t,c.Uint32BufferAttribute=pr,c.Int32BufferAttribute=aa,c.Uint16BufferAttribute=Bs,c.Int16BufferAttribute=ls,c.Uint8ClampedBufferAttribute=ar,c.Uint8BufferAttribute=sr,c.Int8BufferAttribute=on,c.BufferAttribute=At,c.ArcCurve=Xo,c.CatmullRomCurve3=jn,c.CubicBezierCurve=Yr,c.CubicBezierCurve3=Cs,c.EllipseCurve=yr,c.LineCurve=lr,c.LineCurve3=Jr,c.QuadraticBezierCurve=$r,c.QuadraticBezierCurve3=ws,c.SplineCurve=Qr,c.REVISION=t,c.MOUSE=i,c.CullFaceNone=n,c.CullFaceBack=s,c.CullFaceFront=a,c.CullFaceFrontBack=d,c.FrontFaceDirectionCW=p,c.FrontFaceDirectionCCW=f,c.BasicShadowMap=_,c.PCFShadowMap=b,c.PCFSoftShadowMap=w,c.FrontSide=S,c.BackSide=E,c.DoubleSide=k,c.FlatShading=R,c.SmoothShading=M,c.NoColors=L,c.FaceColors=V,c.VertexColors=H,c.NoBlending=O,c.NormalBlending=z,c.AdditiveBlending=K,c.SubtractiveBlending=q,c.MultiplyBlending=Y,c.CustomBlending=se,c.AddEquation=ce,c.SubtractEquation=le,c.ReverseSubtractEquation=te,c.MinEquation=ve,c.MaxEquation=Pe,c.ZeroFactor=Be,c.OneFactor=qe,c.SrcColorFactor=Ue,c.OneMinusSrcColorFactor=Ge,c.SrcAlphaFactor=it,c.OneMinusSrcAlphaFactor=lt,c.DstAlphaFactor=bt,c.OneMinusDstAlphaFactor=Yt,c.DstColorFactor=ni,c.OneMinusDstColorFactor=ri,c.SrcAlphaSaturateFactor=He,c.NeverDepth=ei,c.AlwaysDepth=ui,c.LessDepth=vi,c.LessEqualDepth=Xe,c.EqualDepth=bi,c.GreaterEqualDepth=st,c.GreaterDepth=De,c.NotEqualDepth=Me,c.MultiplyOperation=Je,c.MixOperation=Ct,c.AddOperation=$e,c.NoToneMapping=pe,c.LinearToneMapping=ee,c.ReinhardToneMapping=Ce,c.Uncharted2ToneMapping=Lt,c.CineonToneMapping=tt,c.UVMapping=yi,c.CubeReflectionMapping=sn,c.CubeRefractionMapping=ki,c.EquirectangularReflectionMapping=ti,c.EquirectangularRefractionMapping=On,c.SphericalReflectionMapping=er,c.CubeUVReflectionMapping=cr,c.CubeUVRefractionMapping=Ye,c.RepeatWrapping=Rt,c.ClampToEdgeWrapping=xi,c.MirroredRepeatWrapping=Vn,c.NearestFilter=Hi,c.NearestMipMapNearestFilter=Nr,c.NearestMipMapLinearFilter=Ft,c.LinearFilter=fn,c.LinearMipMapNearestFilter=ts,c.LinearMipMapLinearFilter=wr,c.UnsignedByteType=gn,c.ByteType=Es,c.ShortType=Yn,c.UnsignedShortType=Le,c.IntType=Ne,c.UnsignedIntType=et,c.FloatType=Gt,c.HalfFloatType=Wi,c.UnsignedShort4444Type=Pr,c.UnsignedShort5551Type=is,c.UnsignedShort565Type=Ia,c.UnsignedInt248Type=Ar,c.AlphaFormat=Ra,c.RGBFormat=Tr,c.RGBAFormat=Dn,c.LuminanceFormat=xs,c.LuminanceAlphaFormat=oe,c.RGBEFormat=ke,c.DepthFormat=Ze,c.DepthStencilFormat=We,c.RGB_S3TC_DXT1_Format=$t,c.RGBA_S3TC_DXT1_Format=Jt,c.RGBA_S3TC_DXT3_Format=an,c.RGBA_S3TC_DXT5_Format=Ki,c.RGB_PVRTC_4BPPV1_Format=Rn,c.RGB_PVRTC_2BPPV1_Format=tr,c.RGBA_PVRTC_4BPPV1_Format=Is,c.RGBA_PVRTC_2BPPV1_Format=ur,c.RGB_ETC1_Format=Ma,c.RGBA_ASTC_4x4_Format=vo,c.RGBA_ASTC_5x4_Format=fd,c.RGBA_ASTC_5x5_Format=yo,c.RGBA_ASTC_6x5_Format=So,c.RGBA_ASTC_6x6_Format=ka,c.RGBA_ASTC_8x5_Format=Da,c.RGBA_ASTC_8x6_Format=gd,c.RGBA_ASTC_8x8_Format=Zs,c.RGBA_ASTC_10x5_Format=La,c.RGBA_ASTC_10x6_Format=bo,c.RGBA_ASTC_10x8_Format=Co,c.RGBA_ASTC_10x10_Format=ll,c.RGBA_ASTC_12x10_Format=_d,c.RGBA_ASTC_12x12_Format=ir,c.LoopOnce=dl,c.LoopRepeat=qt,c.LoopPingPong=wo,c.InterpolateDiscrete=Ln,c.InterpolateLinear=Oi,c.InterpolateSmooth=Ji,c.ZeroCurvatureEnding=ns,c.ZeroSlopeEnding=_n,c.WrapAroundEnding=Er,c.TrianglesDrawMode=un,c.TriangleStripDrawMode=hl,c.TriangleFanDrawMode=To,c.LinearEncoding=Br,c.sRGBEncoding=Eo,c.GammaEncoding=xo,c.RGBEEncoding=vd,c.LogLuvEncoding=cl,c.RGBM7Encoding=yd,c.RGBM16Encoding=Io,c.RGBDEncoding=Sd,c.BasicDepthPacking=Ro,c.RGBADepthPacking=bd,c.TangentSpaceNormalMap=Na,c.ObjectSpaceNormalMap=Mo,c.CubeGeometry=oa,c.Face4=Mp,c.LineStrip=kp,c.LinePieces=Dp,c.MeshFaceMaterial=Lp,c.MultiMaterial=Np,c.PointCloud=Pp,c.Particle=Ap,c.ParticleSystem=Bp,c.PointCloudMaterial=Fp,c.ParticleBasicMaterial=Op,c.ParticleSystemMaterial=Vp,c.Vertex=Up,c.DynamicBufferAttribute=zp,c.Int8Attribute=Gp,c.Uint8Attribute=Hp,c.Uint8ClampedAttribute=Wp,c.Int16Attribute=jp,c.Uint16Attribute=qp,c.Int32Attribute=Kp,c.Uint32Attribute=Xp,c.Float32Attribute=Yp,c.Float64Attribute=Jp,c.ClosedSplineCurve3=np,c.SplineCurve3=rp,c.Spline=Iu,c.AxisHelper=$p,c.BoundingBoxHelper=Qp,c.EdgesHelper=Zp,c.WireframeHelper=em,c.XHRLoader=tm,c.BinaryTextureLoader=im,c.GeometryUtils=nm,c.ImageUtils=rm,c.Projector=sm,c.CanvasRenderer=am,c.SceneUtils=om,c.LensFlare=lm,Object.defineProperty(c,"__esModule",{value:!0})});THREE.OrbitControls=function(c,e){this.object=c,this.domElement=e!==void 0?e:document,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:THREE.MOUSE.LEFT,MIDDLE:THREE.MOUSE.MIDDLE,RIGHT:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return f.phi},this.getAzimuthalAngle=function(){return f.theta},this.saveState=function(){t.target0.copy(t.target),t.position0.copy(t.object.position),t.zoom0=t.object.zoom},this.reset=function(){t.target.copy(t.target0),t.object.position.copy(t.position0),t.object.zoom=t.zoom0,t.object.updateProjectionMatrix(),t.dispatchEvent(i),t.update(),d=a.NONE},this.update=function(){var ee=new THREE.Vector3,Ce=new THREE.Quaternion().setFromUnitVectors(c.up,new THREE.Vector3(0,1,0)),Lt=Ce.clone().inverse(),tt=new THREE.Vector3,yi=new THREE.Quaternion;return function(){var ki=t.object.position;return ee.copy(ki).sub(t.target),ee.applyQuaternion(Ce),f.setFromVector3(ee),t.autoRotate&&d===a.NONE&&Y(K()),f.theta+=_.theta,f.phi+=_.phi,f.theta=Math.max(t.minAzimuthAngle,Math.min(t.maxAzimuthAngle,f.theta)),f.phi=Math.max(t.minPolarAngle,Math.min(t.maxPolarAngle,f.phi)),f.makeSafe(),f.radius*=b,f.radius=Math.max(t.minDistance,Math.min(t.maxDistance,f.radius)),t.target.add(w),ee.setFromSpherical(f),ee.applyQuaternion(Lt),ki.copy(t.target).add(ee),t.object.lookAt(t.target),t.enableDamping===!0?(_.theta*=1-t.dampingFactor,_.phi*=1-t.dampingFactor,w.multiplyScalar(1-t.dampingFactor)):(_.set(0,0,0),w.set(0,0,0)),b=1,S||tt.distanceToSquared(t.object.position)>p||8*(1-yi.dot(t.object.quaternion))>p?(t.dispatchEvent(i),tt.copy(t.object.position),yi.copy(t.object.quaternion),S=!1,!0):!1}}(),this.dispose=function(){t.domElement.removeEventListener("contextmenu",pe,!1),t.domElement.removeEventListener("mousedown",Xe,!1),t.domElement.removeEventListener("wheel",De,!1),t.domElement.removeEventListener("touchstart",Je,!1),t.domElement.removeEventListener("touchend",$e,!1),t.domElement.removeEventListener("touchmove",Ct,!1),document.removeEventListener("mousemove",bi,!1),document.removeEventListener("mouseup",st,!1),window.removeEventListener("keydown",Me,!1)};var t=this,i={type:"change"},n={type:"start"},s={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY_PAN:4},d=a.NONE,p=1e-6,f=new THREE.Spherical,_=new THREE.Spherical,b=1,w=new THREE.Vector3,S=!1,E=new THREE.Vector2,k=new THREE.Vector2,R=new THREE.Vector2,M=new THREE.Vector2,L=new THREE.Vector2,V=new THREE.Vector2,H=new THREE.Vector2,O=new THREE.Vector2,z=new THREE.Vector2;function K(){return 2*Math.PI/60/60*t.autoRotateSpeed}function q(){return Math.pow(.95,t.zoomSpeed)}function Y(ee){_.theta-=ee}function se(ee){_.phi-=ee}var ce=function(){var ee=new THREE.Vector3;return function(Lt,tt){ee.setFromMatrixColumn(tt,0),ee.multiplyScalar(-Lt),w.add(ee)}}(),le=function(){var ee=new THREE.Vector3;return function(Lt,tt){t.screenSpacePanning===!0?ee.setFromMatrixColumn(tt,1):(ee.setFromMatrixColumn(tt,0),ee.crossVectors(t.object.up,ee)),ee.multiplyScalar(Lt),w.add(ee)}}(),te=function(){var ee=new THREE.Vector3;return function(Lt,tt){var yi=t.domElement===document?t.domElement.body:t.domElement;if(t.object.isPerspectiveCamera){var sn=t.object.position;ee.copy(sn).sub(t.target);var ki=ee.length();ki*=Math.tan(t.object.fov/2*Math.PI/180),ce(2*Lt*ki/yi.clientHeight,t.object.matrix),le(2*tt*ki/yi.clientHeight,t.object.matrix)}else t.object.isOrthographicCamera?(ce(Lt*(t.object.right-t.object.left)/t.object.zoom/yi.clientWidth,t.object.matrix),le(tt*(t.object.top-t.object.bottom)/t.object.zoom/yi.clientHeight,t.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),t.enablePan=!1)}}();function ve(ee){t.object.isPerspectiveCamera?b/=ee:t.object.isOrthographicCamera?(t.object.zoom=Math.max(t.minZoom,Math.min(t.maxZoom,t.object.zoom*ee)),t.object.updateProjectionMatrix(),S=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),t.enableZoom=!1)}function Pe(ee){t.object.isPerspectiveCamera?b*=ee:t.object.isOrthographicCamera?(t.object.zoom=Math.max(t.minZoom,Math.min(t.maxZoom,t.object.zoom/ee)),t.object.updateProjectionMatrix(),S=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),t.enableZoom=!1)}function Be(ee){E.set(ee.clientX,ee.clientY)}function qe(ee){H.set(ee.clientX,ee.clientY)}function Ue(ee){M.set(ee.clientX,ee.clientY)}function Ge(ee){k.set(ee.clientX,ee.clientY),R.subVectors(k,E).multiplyScalar(t.rotateSpeed);var Ce=t.domElement===document?t.domElement.body:t.domElement;Y(2*Math.PI*R.x/Ce.clientHeight),se(2*Math.PI*R.y/Ce.clientHeight),E.copy(k),t.update()}function it(ee){O.set(ee.clientX,ee.clientY),z.subVectors(O,H),z.y>0?ve(q()):z.y<0&&Pe(q()),H.copy(O),t.update()}function lt(ee){L.set(ee.clientX,ee.clientY),V.subVectors(L,M).multiplyScalar(t.panSpeed),te(V.x,V.y),M.copy(L),t.update()}function bt(ee){}function Yt(ee){ee.deltaY<0?Pe(q()):ee.deltaY>0&&ve(q()),t.update()}function ni(ee){switch(ee.keyCode){case t.keys.UP:te(0,t.keyPanSpeed),t.update();break;case t.keys.BOTTOM:te(0,-t.keyPanSpeed),t.update();break;case t.keys.LEFT:te(t.keyPanSpeed,0),t.update();break;case t.keys.RIGHT:te(-t.keyPanSpeed,0),t.update();break}}function ri(ee){E.set(ee.touches[0].pageX,ee.touches[0].pageY)}function He(ee){if(t.enableZoom){var Ce=ee.touches[0].pageX-ee.touches[1].pageX,Lt=ee.touches[0].pageY-ee.touches[1].pageY,tt=Math.sqrt(Ce*Ce+Lt*Lt);H.set(0,tt)}if(t.enablePan){var yi=.5*(ee.touches[0].pageX+ee.touches[1].pageX),sn=.5*(ee.touches[0].pageY+ee.touches[1].pageY);M.set(yi,sn)}}function ei(ee){k.set(ee.touches[0].pageX,ee.touches[0].pageY),R.subVectors(k,E).multiplyScalar(t.rotateSpeed);var Ce=t.domElement===document?t.domElement.body:t.domElement;Y(2*Math.PI*R.x/Ce.clientHeight),se(2*Math.PI*R.y/Ce.clientHeight),E.copy(k),t.update()}function ui(ee){if(t.enableZoom){var Ce=ee.touches[0].pageX-ee.touches[1].pageX,Lt=ee.touches[0].pageY-ee.touches[1].pageY,tt=Math.sqrt(Ce*Ce+Lt*Lt);O.set(0,tt),z.set(0,Math.pow(O.y/H.y,t.zoomSpeed)),ve(z.y),H.copy(O)}if(t.enablePan){var yi=.5*(ee.touches[0].pageX+ee.touches[1].pageX),sn=.5*(ee.touches[0].pageY+ee.touches[1].pageY);L.set(yi,sn),V.subVectors(L,M).multiplyScalar(t.panSpeed),te(V.x,V.y),M.copy(L)}t.update()}function vi(ee){}function Xe(ee){if(t.enabled!==!1){switch(ee.preventDefault(),ee.button){case t.mouseButtons.LEFT:if(ee.ctrlKey||ee.metaKey){if(t.enablePan===!1)return;Ue(ee),d=a.PAN}else{if(t.enableRotate===!1)return;Be(ee),d=a.ROTATE}break;case t.mouseButtons.MIDDLE:if(t.enableZoom===!1)return;qe(ee),d=a.DOLLY;break;case t.mouseButtons.RIGHT:if(t.enablePan===!1)return;Ue(ee),d=a.PAN;break}d!==a.NONE&&(document.addEventListener("mousemove",bi,!1),document.addEventListener("mouseup",st,!1),t.dispatchEvent(n))}}function bi(ee){if(t.enabled!==!1)switch(ee.preventDefault(),d){case a.ROTATE:if(t.enableRotate===!1)return;Ge(ee);break;case a.DOLLY:if(t.enableZoom===!1)return;it(ee);break;case a.PAN:if(t.enablePan===!1)return;lt(ee);break}}function st(ee){t.enabled!==!1&&(document.removeEventListener("mousemove",bi,!1),document.removeEventListener("mouseup",st,!1),t.dispatchEvent(s),d=a.NONE)}function De(ee){t.enabled===!1||t.enableZoom===!1||d!==a.NONE&&d!==a.ROTATE||(ee.preventDefault(),ee.stopPropagation(),t.dispatchEvent(n),Yt(ee),t.dispatchEvent(s))}function Me(ee){t.enabled===!1||t.enableKeys===!1||t.enablePan===!1||ni(ee)}function Je(ee){if(t.enabled!==!1){switch(ee.preventDefault(),ee.touches.length){case 1:if(t.enableRotate===!1)return;ri(ee),d=a.TOUCH_ROTATE;break;case 2:if(t.enableZoom===!1&&t.enablePan===!1)return;He(ee),d=a.TOUCH_DOLLY_PAN;break;default:d=a.NONE}d!==a.NONE&&t.dispatchEvent(n)}}function Ct(ee){if(t.enabled!==!1)switch(ee.preventDefault(),ee.stopPropagation(),ee.touches.length){case 1:if(t.enableRotate===!1||d!==a.TOUCH_ROTATE)return;ei(ee);break;case 2:if(t.enableZoom===!1&&t.enablePan===!1||d!==a.TOUCH_DOLLY_PAN)return;ui(ee);break;default:d=a.NONE}}function $e(ee){t.enabled!==!1&&(t.dispatchEvent(s),d=a.NONE)}function pe(ee){t.enabled!==!1&&ee.preventDefault()}t.domElement.addEventListener("contextmenu",pe,!1),t.domElement.addEventListener("mousedown",Xe,!1),t.domElement.addEventListener("wheel",De,!1),t.domElement.addEventListener("touchstart",Je,!1),t.domElement.addEventListener("touchend",$e,!1),t.domElement.addEventListener("touchmove",Ct,!1),window.addEventListener("keydown",Me,!1),this.update()};THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);THREE.OrbitControls.prototype.constructor=THREE.OrbitControls;Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(c){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!c}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(c){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!c}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(c){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!c}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(c){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!c}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(c){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!c}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(c){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=c}}});var WI={dontLocalizeUserInterface:!0};WI.Platform={name:InspectorFrontendHost.platform(),isNightlyBuild:!1,version:{base:0,release:0,name:"",build:""}};(function(){let c=/ AppleWebKit\/([^ ]+)/.exec(navigator.userAgent);c&&(WI.Platform.version.build=c[1],c[1].indexOf("+")!==-1&&document.styleSheets.length<10&&(WI.Platform.isNightlyBuild=!0));let e=/ Mac OS X (\d+)_(\d+)/.exec(navigator.appVersion);if(e&&e[1]==="10")switch(WI.Platform.version.base=10,WI.Platform.version.release=parseInt(e[2]),e[2]){case"14":WI.Platform.version.name="mojave";break;case"13":WI.Platform.version.name="high-sierra";break;case"12":WI.Platform.version.name="sierra";break;default:WI.Platform.version.name="unknown-mac";break}})();class Debouncer{constructor(e){console.assert(typeof e=="function"),this._callback=e,this._lastArguments=[],this._timeoutIdentifier=void 0,this._animationFrameIdentifier=void 0,this._promiseIdentifier=void 0}force(){this._lastArguments=arguments,this._execute()}delayForTime(e,...t){console.assert(e>=0),this.cancel(),this._lastArguments=t,this._timeoutIdentifier=setTimeout(()=>{this._execute()},e)}delayForFrame(){this.cancel(),this._lastArguments=arguments,this._animationFrameIdentifier=requestAnimationFrame(()=>{this._execute()})}delayForMicrotask(){this.cancel(),this._lastArguments=arguments;let e=Symbol("next-microtask");this._promiseIdentifier=e,queueMicrotask(()=>{this._promiseIdentifier===e&&this._execute()})}cancel(){this._lastArguments=[],this._timeoutIdentifier&&(clearTimeout(this._timeoutIdentifier),this._timeoutIdentifier=void 0),this._animationFrameIdentifier&&(cancelAnimationFrame(this._animationFrameIdentifier),this._animationFrameIdentifier=void 0),this._promiseIdentifier&&(this._promiseIdentifier=void 0)}_execute(){let e=this._lastArguments;this.cancel(),this._callback.apply(void 0,e)}}WI.DebuggableType={JavaScript:"javascript",Web:"web",Worker:"worker",ServiceWorker:"service-worker"};class LinkedList{constructor(){this.head=new LinkedListNode,this.head.next=this.head.prev=this.head,this.length=0}clear(){this.head.next=this.head.prev=this.head,this.length=0}get last(){return this.head.prev}push(e){let t=new LinkedListNode(e),i=this.last,n=this.head;return i.next=t,t.next=n,n.prev=t,t.prev=i,this.length++,t}remove(e){return e?(e.prev.next=e.next,e.next.prev=e.prev,this.length--,!0):!1}forEach(e){let t=this.head;for(let i=0,n=this.length;i<n;i++)if(t=t.next,e(t.value,i)===!1)return}toArray(){let e=this.head,t=this.length,i=new Array(t);for(;t--;)e=e.prev,i[t]=e.value;return i}toJSON(){return this.toArray()}}class LinkedListNode{constructor(e){this.value=e,this.prev=null,this.next=null}}class ListMultimap{constructor(){this._insertionOrderedEntries=new LinkedList,this._keyMap=new Map}get size(){return this._insertionOrderedEntries.length}add(e,t){let i=this._keyMap.get(e);i||(i=new Map,this._keyMap.set(e,i));let n=i.get(t);return n||(n=this._insertionOrderedEntries.push([e,t]),i.set(t,n)),this}delete(e,t){let i=this._keyMap.get(e);if(!i)return!1;let n=i.get(t);return n?(i.delete(t),this._insertionOrderedEntries.remove(n),!0):!1}deleteAll(e){let t=this._keyMap.get(e);if(!t)return!1;let i=this._insertionOrderedEntries,n=!1;return t.forEach(function(s){i.remove(s),n=!0}),this._keyMap.delete(e),n}has(e,t){let i=this._keyMap.get(e);return i?i.has(t):!1}clear(){this._keyMap=new Map,this._insertionOrderedEntries=new LinkedList}forEach(e){this._insertionOrderedEntries.forEach(e)}toArray(){return this._insertionOrderedEntries.toArray()}toJSON(){return this.toArray()}}class Multimap{constructor(e=[]){this._map=new Map;for(let[t,i]of e)this.add(t,i)}get size(){return this._map.size}has(e,t){let i=this._map.get(e);return i?t===void 0||i.has(t):!1}get(e){return this._map.get(e)}add(e,t){let i=this._map.get(e);return i||(i=new Set,this._map.set(e,i)),i.add(t),this}delete(e,t){if(arguments.length===1)return this._map.delete(e);let i=this._map.get(e);if(!i)return!1;let n=i.delete(t);return i.size||this._map.delete(e),n}clear(){this._map.clear()}keys(){return this._map.keys()}*values(){for(let e of this._map.values())for(let t of e)yield t}sets(){return this._map.entries()}*[Symbol.iterator](){for(let[e,t]of this._map)for(let i of t)yield[e,i]}copy(){return new Multimap(this.toJSON())}toJSON(){return Array.from(this)}}WI.Object=class{constructor(){this._listeners=null}static addEventListener(e,t,i){if(i=i||null,console.assert(e,"Object.addEventListener: invalid event type ",e,"(listener: ",t,"thisObject: ",i,")"),!e||(console.assert(t,"Object.addEventListener: invalid listener ",t,"(event type: ",e,"thisObject: ",i,")"),!t))return null;this._listeners||(this._listeners=new Map);let n=this._listeners.get(e);return n||(n=new ListMultimap,this._listeners.set(e,n)),n.add(i,t),t}static singleFireEventListener(e,t,i){let n=function(){this.removeEventListener(e,n,null),t.apply(i,arguments)}.bind(this);return this.addEventListener(e,n,null),n}static removeEventListener(e,t,i){if(e=e||null,t=t||null,i=i||null,!this._listeners)return;if(i&&!e){this._listeners.forEach(function(a){a.deleteAll(i)});return}let n=this._listeners.get(e);if(!n||n.size===0)return;let s=n.delete(i,t);console.assert(s,"removeEventListener cannot remove "+e.toString()+" because it doesn't exist.")}static awaitEvent(e){let t=new WI.WrappedPromise;return this.singleFireEventListener(e,i=>t.resolve(i)),t.promise}static hasEventListeners(e){if(!this._listeners)return!1;let t=this._listeners.get(e);return t&&t.size>0}static retainedObjectsWithPrototype(e){let t=new Set;return this._listeners&&this._listeners.forEach(function(i,n){i.forEach(function(s){let a=s[0];a instanceof e&&t.add(a)})}),t}addEventListener(){return WI.Object.addEventListener.apply(this,arguments)}singleFireEventListener(){return WI.Object.singleFireEventListener.apply(this,arguments)}removeEventListener(){return WI.Object.removeEventListener.apply(this,arguments)}awaitEvent(){return WI.Object.awaitEvent.apply(this,arguments)}hasEventListeners(){return WI.Object.hasEventListeners.apply(this,arguments)}retainedObjectsWithPrototype(){return WI.Object.retainedObjectsWithPrototype.apply(this,arguments)}dispatchEventToListeners(e,t){let i=new WI.Event(this,e,t);function n(a){if(!a||i._stoppedPropagation)return;let d=a._listeners;if(!d||!a.hasOwnProperty("_listeners"))return;console.assert(d instanceof Map);let p=d.get(e);if(!p)return;let f=p.toArray();for(let _=0,b=f.length;_<b;++_){let[w,S]=f[_];if(S.call(w,i),i._stoppedPropagation)break}}n(this),i._stoppedPropagation=!1;let s=this.constructor;for(;s&&(n(s),!!s.prototype.__proto__);)s=s.prototype.__proto__.constructor;return i.defaultPrevented}};WI.Event=class{constructor(e,t,i){this.target=e,this.type=t,this.data=i,this.defaultPrevented=!1,this._stoppedPropagation=!1}stopPropagation(){this._stoppedPropagation=!0}preventDefault(){this.defaultPrevented=!0}};WI.notifications=new WI.Object;WI.Notification={GlobalModifierKeysDidChange:"global-modifiers-did-change",PageArchiveStarted:"page-archive-started",PageArchiveEnded:"page-archive-ended",ExtraDomainsActivated:"extra-domains-activated",DebugUIEnabledDidChange:"debug-ui-enabled-did-change",VisibilityStateDidChange:"visibility-state-did-change",TransitionPageTarget:"transition-page-target"};class Throttler{constructor(e,t){console.assert(typeof e=="function"),console.assert(t>=0),this._callback=e,this._delay=t,this._lastArguments=[],this._timeoutIdentifier=void 0,this._lastFireTime=-this._delay}force(){this._lastArguments=arguments,this._execute()}fire(){this._lastArguments=arguments;let e=this._delay-(Date.now()-this._lastFireTime);if(e<=0){this._execute();return}this._timeoutIdentifier||(this._timeoutIdentifier=setTimeout(()=>{this._execute()},e))}cancel(){this._lastArguments=[],this._timeoutIdentifier&&(clearTimeout(this._timeoutIdentifier),this._timeoutIdentifier=void 0)}_execute(){this._lastFireTime=Date.now();let e=this._lastArguments;this.cancel(),this._callback.apply(void 0,e)}}WI.roleSelectorForNode=function(c){var e="",t=c.computedRole();return t&&(e=":role("+t+")"),e};WI.linkifyAccessibilityNodeReference=function(c){if(!c)return null;var e=WI.linkifyNodeReference(c),t=e.title,i=t.indexOf(".");i>-1&&(t=t.substring(0,i));var n=WI.roleSelectorForNode(c);return e.textContent=t+n,e.title+=n,e};WI.linkifyNodeReference=function(c,e={}){let t=c.displayName;isNaN(e.maxLength)||(t=t.truncate(e.maxLength));let i=document.createElement("span");return i.append(t),WI.linkifyNodeReferenceElement(c,i,{...e,displayName:t})};WI.linkifyNodeReferenceElement=function(c,e,t={}){e.setAttribute("role","link"),e.title=t.displayName||c.displayName;let i=c.nodeType();return(i!==Node.DOCUMENT_NODE||c.parentNode)&&i!==Node.TEXT_NODE&&e.classList.add("node-link"),WI.bindInteractionsForNodeToElement(c,e,t),e};WI.bindInteractionsForNodeToElement=function(c,e,t={}){t.ignoreClick||e.addEventListener("click",i=>{WI.domManager.inspectElement(c.id)}),e.addEventListener("mouseover",i=>{WI.domManager.highlightDOMNode(c.id,"all")}),e.addEventListener("mouseout",i=>{WI.domManager.hideDOMNodeHighlight()}),e.addEventListener("contextmenu",i=>{let n=WI.ContextMenu.createFromEvent(i);WI.appendContextMenuItemsForDOMNode(n,c,t)})};function createSVGElement(c){return document.createElementNS("http://www.w3.org/2000/svg",c)}WI.cssPath=function(c,e={}){if(console.assert(c instanceof WI.DOMNode,"Expected a DOMNode."),c.nodeType()!==Node.ELEMENT_NODE)return"";let t="";c.isPseudoElement()&&(t="::"+c.pseudoType(),c=c.parentNode);let i=[];for(;c;){let n=WI.cssPathComponent(c,e);if(!n||(i.push(n),n.done))break;c=c.parentNode}return i.reverse(),i.map(n=>n.value).join(" > ")+t};WI.cssPathComponent=function(c,e={}){if(console.assert(c instanceof WI.DOMNode,"Expected a DOMNode."),console.assert(!c.isPseudoElement()),c.nodeType()!==Node.ELEMENT_NODE)return null;let t=c.nodeNameInCorrectCase();if(!c.parentNode||c.parentNode.nodeType()===Node.DOCUMENT_NODE)return{value:t,done:!0};if(e.full){let E=function(H){let O=new Map;for(let z of H.attributes()){let K=[z.value];(z.name==="id"||z.name==="class")&&(K=z.value.split(/\s+/)),O.set(z.name,new Set(K))}return O},L=function(H,O="",z=!1){return!H||!H.size||(H=Array.from(H),H=H.filter(K=>K&&K.length),!H.length)?"":(H=H.map(K=>z?CSS.escape(K):K.escapeCharacters('"')),O+H.join(O))};var w=E,S=L;let k=0,R=!1,M=E(c);c.parentNode.children.forEach((H,O)=>{if(H.nodeType()!==Node.ELEMENT_NODE)return;if(H===c){k=O;return}if(R||H.nodeNameInCorrectCase()!==t)return;let z=E(H),K=0;for(let[q,Y]of M){let se=z.get(q);se&&Y.size<=se.size&&Y.isSubsetOf(se)&&++K}K===M.size&&(R=!0)});let V=t;V+=L(M.get("id"),"#",!0),V+=L(M.get("class"),".",!0);for(let[H,O]of M)H!=="id"&&H!=="class"&&(V+=`[${H}="${L(O)}"]`);return R&&(V+=`:nth-child(${k+1})`),{value:V,done:!1}}let i=c.nodeName().toLowerCase();if(i==="body"||i==="head"||i==="html")return{value:t,done:!0};if(c.getAttribute("id"))return{value:c.escapedIdSelector,done:!0};function s(E){let k=E.getAttribute("class");return k?k.trim().split(/\s+/):[]}let a=-1,d=!0,p=new Set(s(c)),f=c.parentNode.children,_=0;for(let E of f)if(E.nodeType()===Node.ELEMENT_NODE){if(_++,E===c){a=_;continue}if(E.nodeNameInCorrectCase()===t&&(d=!1),p.size){let k=s(E);for(let R of k)p.delete(R)}}let b=t;return i==="input"&&c.getAttribute("type")&&!p.size&&(b+=`[type="${c.getAttribute("type")}"]`),d||(p.size?b+=c.escapedClassSelector:b+=`:nth-child(${a})`),{value:b,done:!1}};WI.xpath=function(c){if(console.assert(c instanceof WI.DOMNode,"Expected a DOMNode."),c.nodeType()===Node.DOCUMENT_NODE)return"/";let e=[];for(;c;){let i=WI.xpathComponent(c);if(!i||(e.push(i),i.done))break;c=c.parentNode}return e.reverse(),(e.length&&e[0].done?"":"/")+e.map(i=>i.value).join("/")};WI.xpathComponent=function(c){console.assert(c instanceof WI.DOMNode,"Expected a DOMNode.");let e=WI.xpathIndex(c);if(e===-1)return null;let t;switch(c.nodeType()){case Node.DOCUMENT_NODE:return{value:"",done:!0};case Node.ELEMENT_NODE:var i=c.getAttribute("id");if(i)return{value:`//*[@id="${i}"]`,done:!0};t=c.localName();break;case Node.ATTRIBUTE_NODE:t=`@${c.nodeName()}`;break;case Node.TEXT_NODE:case Node.CDATA_SECTION_NODE:t="text()";break;case Node.COMMENT_NODE:t="comment()";break;case Node.PROCESSING_INSTRUCTION_NODE:t="processing-instruction()";break;default:t="";break}return e>0&&(t+=`[${e}]`),{value:t,done:!1}};WI.xpathIndex=function(c){if(!c.parentNode)return 0;let e=c.parentNode.children;if(e.length<=1)return 0;function t(a,d){if(a===d)return!0;let p=a.nodeType(),f=d.nodeType();return p===Node.ELEMENT_NODE&&f===Node.ELEMENT_NODE?a.localName()===d.localName():p===Node.CDATA_SECTION_NODE?p===Node.TEXT_NODE:f===Node.CDATA_SECTION_NODE?f===Node.TEXT_NODE:p===f}let i=!0,n=-1,s=1;for(let a of e)if(!!t(c,a)){if(c===a){if(n=s,!i)return n}else if(i=!1,n!==-1)return n;s++}return i?0:(console.assert(n>0,"Should have found the node."),n)};WI.EventListener=class{constructor(e,t){this._thisObject=e,this._emitter=null,this._callback=null,this._fireOnce=t}connect(e,t,i,n){console.assert(!this._emitter&&!this._callback,"EventListener already bound to a callback.",this),console.assert(e,`Missing event emitter for event: ${t}.`),console.assert(t,"Missing event type."),console.assert(i,`Missing callback for event: ${t}.`);var s=e&&(e instanceof WI.Object||e instanceof Node||typeof e.addEventListener=="function");if(console.assert(s,"Event emitter ",e,` (type: ${t}) is null or does not implement Node or WI.Object.`),!(!s||!t||!i)){if(this._emitter=e,this._type=t,this._usesCapture=!!n,e instanceof Node&&(i=i.bind(this._thisObject)),this._fireOnce){var a=this;this._callback=function(){a.disconnect(),i.apply(this,arguments)}}else this._callback=i;this._emitter instanceof Node?this._emitter.addEventListener(this._type,this._callback,this._usesCapture):this._emitter.addEventListener(this._type,this._callback,this._thisObject)}}disconnect(){console.assert(this._emitter&&this._callback,"EventListener is not bound to a callback.",this),!(!this._emitter||!this._callback)&&(this._emitter instanceof Node?this._emitter.removeEventListener(this._type,this._callback,this._usesCapture):this._emitter.removeEventListener(this._type,this._callback,this._thisObject),this._fireOnce&&delete this._thisObject,delete this._emitter,delete this._type,delete this._callback)}};WI.EventListenerSet=class{constructor(e,t){this.name=t,this._defaultThisObject=e,this._listeners=[],this._installed=!1}register(e,t,i,n,s){console.assert(e,`Missing event emitter for event: ${t}.`),console.assert(t,"Missing event type."),console.assert(i,`Missing callback for event: ${t}.`);var a=e&&(e instanceof WI.Object||e instanceof Node||typeof e.addEventListener=="function");console.assert(a,"Event emitter ",e,` (type: ${t}) is null or does not implement Node or WI.Object.`),!(!a||!t||!i)&&this._listeners.push({listener:new WI.EventListener(n||this._defaultThisObject),emitter:e,type:t,callback:i,usesCapture:s})}unregister(){this._installed&&this.uninstall(),this._listeners=[]}install(){if(console.assert(!this._installed,"Already installed listener group: "+this.name),!this._installed){this._installed=!0;for(var e of this._listeners)e.listener.connect(e.emitter,e.type,e.callback,e.usesCapture)}}uninstall(e){if(console.assert(this._installed,"Trying to uninstall listener group "+this.name+", but it isn't installed."),!!this._installed){this._installed=!1;for(var t of this._listeners)t.listener.disconnect();e&&(this._listeners=[])}}};WI.FileUtilities=class ap{static screenshotString(){let e=new Date,t=[e.getFullYear(),Number.zeroPad(e.getMonth()+1,2),Number.zeroPad(e.getDate(),2),Number.zeroPad(e.getHours(),2),Number.zeroPad(e.getMinutes(),2),Number.zeroPad(e.getSeconds(),2)];return WI.UIString("Screen Shot %s-%s-%s at %s.%s.%s").format(...t)}static sanitizeFilename(e){return e.replace(/:+/g,"-")}static inspectorURLForFilename(e){return"web-inspector:///"+encodeURIComponent(ap.sanitizeFilename(e))}static save(e,t){if(console.assert(e),!e)return;if(typeof e.customSaveHandler=="function"){e.customSaveHandler(t);return}if(console.assert(e.content),!e.content)return;let i=e.url||"",n=parseURL(i).lastPathComponent;if(!n){n=WI.UIString("Untitled");let a=/^data:([^;]+)/.exec(i);if(a){let d=WI.fileExtensionForMIMEType(a[1]);d&&(n+="."+d)}}if(typeof e.content=="string"){const a=e.base64Encoded||!1;InspectorFrontendHost.save(n,e.content,a,t||e.forceSaveAs);return}let s=new FileReader;s.readAsDataURL(e.content),s.addEventListener("loadend",()=>{let a=parseDataURL(s.result);const d=!0;InspectorFrontendHost.save(n,a.data,d,t||e.forceSaveAs)})}static importText(e){let t=document.createElement("input");t.type="file",t.multiple=!0,t.addEventListener("change",i=>{WI.FileUtilities.readText(t.files,e)}),t.click()}static importJSON(e){let t=document.createElement("input");t.type="file",t.multiple=!0,t.addEventListener("change",i=>{WI.FileUtilities.readJSON(t.files,e)}),t.click()}static async readText(e,t){console.assert(e instanceof File||e instanceof FileList);let i=[];e instanceof File?i.push(e):e instanceof FileList&&(i=Array.from(e));for(let n of i){let s=new FileReader;s.readAsText(n);let a={filename:n.name};try{await new Promise((p,f)=>{s.addEventListener("loadend",_=>{a.text=s.result,p(_)}),s.addEventListener("error",f)})}catch(p){a.error=p}let d=t(a);d instanceof Promise&&await d}}static async readJSON(e,t){return WI.FileUtilities.readText(e,i=>{if(i.text&&!i.error)try{i.json=JSON.parse(i.text)}catch(n){i.error=n}return t(i)})}};WI.ImageUtilities=class{static useSVGSymbol(e,t,i){const n="http://www.w3.org/2000/svg",s="http://www.w3.org/1999/xlink";let a=document.createElementNS(n,"svg");a.style.width="100%",a.style.height="100%",e.includes("#")||(e+="#root");let d=document.createElementNS(n,"use");d.setAttributeNS(s,"xlink:href",e),a.appendChild(d);let p=document.createElement("div");return p.appendChild(a),t&&(p.className=t),i&&(p.title=i),p}static promisifyLoad(e){return new Promise((t,i)=>{let n=new Image,s=()=>{t(n)};n.addEventListener("load",s),n.addEventListener("error",s),n.src=e})}static scratchCanvasContext2D(e){WI.ImageUtilities._scratchContext2D||(WI.ImageUtilities._scratchContext2D=document.createElement("canvas").getContext("2d"));let t=WI.ImageUtilities._scratchContext2D;t.clearRect(0,0,t.canvas.width,t.canvas.height),t.save(),e(t),t.restore()}static imageFromImageBitmap(e){console.assert(e instanceof ImageBitmap);let t=null;return WI.ImageUtilities.scratchCanvasContext2D(i=>{i.canvas.width=e.width,i.canvas.height=e.height,i.drawImage(e,0,0),t=new Image,t.src=i.canvas.toDataURL()}),t}static imageFromImageData(e){console.assert(e instanceof ImageData);let t=null;return WI.ImageUtilities.scratchCanvasContext2D(i=>{i.canvas.width=e.width,i.canvas.height=e.height,i.putImageData(e,0,0),t=new Image,t.src=i.canvas.toDataURL()}),t}static imageFromCanvasGradient(e,t,i){console.assert(e instanceof CanvasGradient);let n=null;return WI.ImageUtilities.scratchCanvasContext2D(s=>{s.canvas.width=t,s.canvas.height=i,s.fillStyle=e,s.fillRect(0,0,t,i),n=new Image,n.src=s.canvas.toDataURL()}),n}static supportsCanvasPathDebugging(){return"getPath"in CanvasRenderingContext2D.prototype&&"setPath"in CanvasRenderingContext2D.prototype&&"currentX"in CanvasRenderingContext2D.prototype&&"currentY"in CanvasRenderingContext2D.prototype}};WI.ImageUtilities._scratchContext2D=null;(function(){if(WI.dontLocalizeUserInterface)return;let c=InspectorFrontendHost.localizedStringsURL();console.assert(c),c&&document.write('<script src="'+c+'"><\/script>')})();WI.unlocalizedString=function(c){return c};WI.UIString=function(c,e,t){"use strict";return WI.dontLocalizeUserInterface?c:(arguments.length===2&&(t=e,e=void 0),e=e||c,window.localizedStrings&&e in window.localizedStrings?window.localizedStrings[e]:(window.localizedStrings||console.error(`Attempted to load localized string "${e}" before localizedStrings was initialized.`,t),this._missingLocalizedStrings||(this._missingLocalizedStrings={}),e in this._missingLocalizedStrings||(console.error(`Localized string "${e}" was not found.`,t),this._missingLocalizedStrings[e]=!0),"LOCALIZED STRING NOT FOUND"))};WI.repeatedUIString={};WI.repeatedUIString.timelineRecordLayout=function(){return WI.UIString("Layout","Layout @ Timeline record","Layout phase timeline records")};WI.repeatedUIString.timelineRecordPaint=function(){return WI.UIString("Paint","Paint @ Timeline record","Paint (render) phase timeline records")};WI.repeatedUIString.timelineRecordComposite=function(){return WI.UIString("Composite","Composite @ Timeline record","Composite phase timeline records, where graphic layers are combined")};WI.repeatedUIString.allExceptions=function(){return WI.UIString("All Exceptions","Break (pause) on all exceptions")};WI.repeatedUIString.uncaughtExceptions=function(){return WI.UIString("Uncaught Exceptions","Break (pause) on uncaught (unhandled) exceptions")};WI.repeatedUIString.assertionFailures=function(){return WI.UIString("Assertion Failures","Break (pause) when console.assert() fails")};WI.repeatedUIString.allRequests=function(){return WI.UIString("All Requests","A submenu item of 'Break on' that breaks (pauses) before all network requests")};WI.repeatedUIString.fetch=function(){return WI.UIString("Fetch","Resource loaded via 'fetch' method")};WI.repeatedUIString.revealInDOMTree=function(){return WI.UIString("Reveal in DOM Tree","Open Elements tab and select this node in DOM tree")};WI.fileExtensionForURL=function(c){let e=parseURL(c).lastPathComponent;if(!e)return null;let t=e.lastIndexOf(".");return t===-1||t===e.length-1?null:e.substr(t+1)};WI.mimeTypeForFileExtension=function(c){return{html:"text/html",xhtml:"application/xhtml+xml",xml:"text/xml",js:"text/javascript",mjs:"text/javascript",json:"application/json",clj:"text/x-clojure",coffee:"text/x-coffeescript",ls:"text/x-livescript",ts:"text/typescript",ps:"application/postscript",jsx:"text/jsx",css:"text/css",less:"text/x-less",sass:"text/x-sass",scss:"text/x-scss",bmp:"image/bmp",gif:"image/gif",jpeg:"image/jpeg",jpg:"image/jpeg",pdf:"application/pdf",png:"image/png",tif:"image/tiff",tiff:"image/tiff",xbm:"image/x-xbitmap",webp:"image/webp",ico:"image/x-icon",ogx:"application/ogg",ogg:"audio/ogg",oga:"audio/ogg",ogv:"video/ogg",anx:"application/annodex",axa:"audio/annodex",axv:"video/annodex",spx:"audio/speex",webm:"video/webm",m1a:"audio/mpeg",m2a:"audio/mpeg",mpg:"video/mpeg",m15:"video/mpeg",m1s:"video/mpeg",m1v:"video/mpeg",m75:"video/mpeg",mpa:"video/mpeg",mpeg:"video/mpeg",mpm:"video/mpeg",mpv:"video/mpeg",m3u8:"application/x-mpegurl",m3url:"audio/x-mpegurl",m3u:"audio/x-mpegurl",m4v:"video/x-m4v",m4a:"audio/x-m4a",m4b:"audio/x-m4b",m4p:"audio/x-m4p",mp3:"audio/mp3",mp2:"video/x-mpeg2",vob:"video/mpeg2",mod:"video/mpeg2",m2ts:"video/m2ts",m2t:"video/x-m2ts","3gpp":"audio/3gpp","3g2":"audio/3gpp2",amc:"application/x-mpeg",aac:"audio/aac",adts:"audio/aac",m4r:"audio/x-aac",caf:"audio/x-caf",gsm:"audio/x-gsm",wav:"audio/x-wav",vtt:"text/vtt",woff:"font/woff",woff2:"font/woff2",otf:"font/otf",ttf:"font/ttf",sfnt:"font/sfnt",svg:"image/svg+xml",txt:"text/plain",xsl:"text/xsl"}[c]||null};WI.fileExtensionForMIMEType=function(c){if(!c)return null;let t={"text/html":"html","application/xhtml+xml":"xhtml","text/xml":"xml","application/ecmascript":"js","application/javascript":"js","application/x-ecmascript":"js","application/x-javascript":"js","text/ecmascript":"js","text/javascript":"js","text/javascript1.0":"js","text/javascript1.1":"js","text/javascript1.2":"js","text/javascript1.3":"js","text/javascript1.4":"js","text/javascript1.5":"js","text/jscript":"js","text/x-ecmascript":"js","text/x-javascript":"js","application/json":"json","text/x-clojure":"clj","text/x-coffeescript":"coffee","text/livescript":"ls","text/x-livescript":"ls","text/typescript":"ts","application/postscript":"ps","text/jsx":"jsx","text/css":"css","text/x-less":"less","text/x-sass":"sass","text/x-scss":"scss","image/bmp":"bmp","image/gif":"gif","image/jp2":"jp2","image/jpeg":"jpg","application/pdf":"pdf","text/pdf":"pdf","image/png":"png","image/tiff":"tiff","image/x-xbitmap":"xbm","image/webp":"webp","image/vnd.microsoft.icon":"ico","image/x-icon":"ico","application/ogg":"ogx","audio/ogg":"ogg","application/annodex":"anx","audio/annodex":"axa","video/annodex":"axv","audio/speex":"spx","video/webm":"webm","audio/webm":"webm","video/mpeg":"mpeg","application/vnd.apple.mpegurl":"m3u8","application/mpegurl":"m3u8","application/x-mpegurl":"m3u8","audio/mpegurl":"m3u","audio/x-mpegurl":"m3u","video/x-m4v":"m4v","audio/x-m4a":"m4a","audio/x-m4b":"m4b","audio/x-m4p":"m4p","audio/mp4":"m4a","audio/mp3":"mp3","audio/x-mp3":"mp3","audio/x-mpeg":"mp3","video/x-mpeg2":"mp2","video/mpeg2":"vob","video/m2ts":"m2ts","video/x-m2ts":"m2t","audio/3gpp":"3gpp","audio/3gpp2":"3g2","application/x-mpeg":"amc","audio/aac":"aac","audio/x-aac":"m4r","audio/x-caf":"caf","audio/x-gsm":"gsm","audio/x-wav":"wav","audio/vnd.wave":"wav","text/vtt":"vtt","font/woff":"woff","font/woff2":"woff2","font/otf":"otf","font/ttf":"ttf","font/sfnt":"sfnt","image/svg+xml":"svg","text/plain":"txt","text/xsl":"xsl"}[c];return t||(c.endsWith("+json")?"json":c.endsWith("+xml")?"xml":null)};WI.shouldTreatMIMETypeAsText=function(c){if(!c)return!1;if(c.startsWith("text/")||c.endsWith("+json")||c.endsWith("+xml"))return!0;let e=WI.fileExtensionForMIMEType(c);return e==="m3u8"||e==="m3u"||e==="js"||e==="json"?!0:c.startsWith("application/")?c.endsWith("script")||c.endsWith("json"):!1};WI.ObjectStore=class op{constructor(e,t={}){this._name=e,this._options=t}static supported(){return(!window.InspectorTest||WI.ObjectStore.__testObjectStore)&&window.indexedDB}static async reset(){WI.ObjectStore._database&&WI.ObjectStore._database.close(),await window.indexedDB.deleteDatabase(op._databaseName)}static get _databaseName(){let e=InspectorFrontendHost?InspectorFrontendHost.inspectionLevel():1;return"com.apple.WebInspector"+(e>1?"-"+e:"")}static _open(e){if(WI.ObjectStore._database){e(WI.ObjectStore._database);return}if(Array.isArray(WI.ObjectStore._databaseCallbacks)){WI.ObjectStore._databaseCallbacks.push(e);return}WI.ObjectStore._databaseCallbacks=[e];const t=3;let i=window.indexedDB.open(WI.ObjectStore._databaseName,t);i.addEventListener("upgradeneeded",n=>{let s=i.result,a=Object.values(WI.objectStores);WI.ObjectStore.__testObjectStore&&a.push(WI.ObjectStore.__testObjectStore);let d=new Set;for(let p of a)s.objectStoreNames.contains(p._name)||s.createObjectStore(p._name,p._options),d.add(p._name);for(let p of s.objectStoreNames)d.has(p)||s.deleteObjectStore(p)}),i.addEventListener("success",n=>{WI.ObjectStore._database=i.result,WI.ObjectStore._database.addEventListener("close",s=>{WI.ObjectStore._database=null});for(let s of WI.ObjectStore._databaseCallbacks)s(WI.ObjectStore._database);WI.ObjectStore._databaseCallbacks=null})}get keyPath(){return(this._options||{}).keyPath}associateObject(e,t,i){typeof i=="object"&&(i=this._resolveKeyPath(i,t).value);let n=this._resolveKeyPath(e,t);n.object[n.key]=i}async getAll(...e){return WI.ObjectStore.supported()?this._operation("readonly",t=>t.getAll(...e)):[]}async put(...e){if(!!WI.ObjectStore.supported())return this._operation("readwrite",t=>t.put(...e))}async putObject(e,...t){if(!WI.ObjectStore.supported())return;console.assert(typeof e.toJSON=="function","ObjectStore cannot store an object without JSON serialization",e.constructor.name);let i=await this.put(e.toJSON(WI.ObjectStore.toJSONSymbol),...t);return this.associateObject(e,t[0],i),i}async delete(...e){if(!!WI.ObjectStore.supported())return this._operation("readwrite",t=>t.delete(...e))}async deleteObject(e,...t){if(!!WI.ObjectStore.supported())return this.delete(this._resolveKeyPath(e).value,...t)}async clear(...e){if(!!WI.ObjectStore.supported())return this._operation("readwrite",t=>t.clear(...e))}_resolveKeyPath(e,t){t=t||this._options.keyPath||"";let i=t.split("."),n=i.splice(-1,1);for(;i.length&&e.hasOwnProperty(i[0]);)e=e[i.shift()];return i.length&&(n=i.join(".")+"."+n),{object:e,key:n,value:e[n]}}async _operation(e,t){return new Promise((i,n)=>{WI.ObjectStore._open(s=>{let a=s.transaction([this._name],e),d=a.objectStore(this._name),p=null;try{p=t(d)}catch(_){n(_);return}function f(_){if(a.removeEventListener("complete",f),a.removeEventListener("error",f),p.removeEventListener("success",f),p.removeEventListener("error",f),p.error){n(p.error);return}i(p.result)}a.addEventListener("complete",f,{once:!0}),a.addEventListener("error",f,{once:!0}),p.addEventListener("success",f,{once:!0}),p.addEventListener("error",f,{once:!0})})})}};WI.ObjectStore._database=null;WI.ObjectStore._databaseCallbacks=null;WI.ObjectStore.toJSONSymbol=Symbol("ObjectStore-toJSON");WI.objectStores={audits:new WI.ObjectStore("audit-manager-tests",{keyPath:"__id",autoIncrement:!0}),breakpoints:new WI.ObjectStore("debugger-breakpoints",{keyPath:"__id"}),domBreakpoints:new WI.ObjectStore("dom-debugger-dom-breakpoints",{keyPath:"__id"}),eventBreakpoints:new WI.ObjectStore("dom-debugger-event-breakpoints",{keyPath:"__id"}),urlBreakpoints:new WI.ObjectStore("dom-debugger-url-breakpoints",{keyPath:"__id"})};function removeURLFragment(c){var e=c.indexOf("#");return e>=0?c.substring(0,e):c}function relativePath(c,e){console.assert(c.charAt(0)==="/"),console.assert(e.charAt(0)==="/");for(var t=c.split("/"),i=e.replace(/\/$/,"").split("/"),n=[],s=1;s<t.length&&s<i.length&&t[s]===i[s];++s);for(var a=s;a<i.length;++a)n.push("..");for(var a=s;a<t.length;++a)n.push(t[a]);return n.join("/")}function parseSecurityOrigin(c){c=c?c.trim():"";let e=c.match(/^(?<scheme>[^:]+):\/\/(?<host>[^\/:]*)(?::(?<port>[\d]+))?$/i);if(!e)return{scheme:null,host:null,port:null};let t=e.groups.scheme.toLowerCase(),i=e.groups.host.toLowerCase(),n=Number(e.groups.port)||null;return{scheme:t,host:i,port:n}}function parseDataURL(c){if(!c.startsWith("data:"))return null;let e=c.match(/^data:(?<mime>[^;,]*)?(?:;charset=(?<charset>[^;,]*?))?(?<base64>;base64)?,(?<data>.*)$/);if(!e)return null;let t="data",i=e.groups.mime||"text/plain",n=e.groups.charset||"US-ASCII",s=!!e.groups.base64,a=decodeURIComponent(e.groups.data);return{scheme:t,mimeType:i,charset:n,base64:s,data:a}}function parseURL(c){if(c=c?c.trim():"",c.startsWith("data:"))return{scheme:"data",userinfo:null,host:null,port:null,path:null,queryString:null,fragment:null,lastPathComponent:null};let e=c.match(/^(?<scheme>[^\/:]+):\/\/(?:(?<userinfo>[^#@\/]+)@)?(?<host>[^\/#:]*)(?::(?<port>[\d]+))?(?:(?<path>\/[^#]*)?(?:#(?<fragment>.*))?)?$/i);if(!e)return{scheme:null,userinfo:null,host:null,port:null,path:null,queryString:null,fragment:null,lastPathComponent:null};let t=e.groups.scheme.toLowerCase(),i=e.groups.userinfo||null,n=e.groups.host.toLowerCase(),s=Number(e.groups.port)||null,a=e.groups.path||null,d=e.groups.fragment||null,p=a,f=null;if(a){let b=a.indexOf("?");b!==-1&&(p=a.substring(0,b),f=a.substring(b+1)),p=resolveDotsInPath(p)}let _=null;if(p&&p!=="/"){let b=p[p.length-1]==="/"?1:0,w=p.lastIndexOf("/",p.length-1-b);w!==-1&&(_=p.substring(w+1,p.length-b))}return{scheme:t,userinfo:i,host:n,port:s,path:p,queryString:f,fragment:d,lastPathComponent:_}}function absoluteURL(c,e){if(c=c?c.trim():"",c.startsWith("data:")||c.startsWith("javascript:")||c.startsWith("mailto:")||parseURL(c).scheme)return c;if(!c)return e||null;var t=parseURL(e);if(!t.scheme)return null;if(c[0]==="/"&&c[1]==="/")return t.scheme+":"+c;t.path||(t.path="/");var i=t.scheme+"://"+t.host+(t.port?":"+t.port:"");if(c[0]==="?")return i+t.path+c;if(c[0]==="/")return i+resolveDotsInPath(c);if(c[0]==="#"){let s=t.queryString?"?"+t.queryString:"";return i+t.path+s+c}var n=t.path.substring(0,t.path.lastIndexOf("/"))+"/";return i+resolveDotsInPath(n+c)}function parseQueryString(c,e){if(!c)return e?[]:{};function t(n){try{return decodeURIComponent(n.replace(/\+/g," "))}catch{return n}}var i=e?[]:{};for(let n of c.split("&")){let s=n.indexOf("=");s===-1&&(s=n.length);let a=t(n.substring(0,s)),d=t(n.substring(s+1));e?i.push({name:a,value:d}):i[a]=d}return i}WI.displayNameForURL=function(c,e,t={}){if(c.startsWith("data:"))return WI.truncateURL(c);e||(e=parseURL(c));var i;try{i=decodeURIComponent(e.lastPathComponent||"")}catch{i=e.lastPathComponent}return t.allowDirectoryAsName&&(!i||e.path.endsWith(i+"/"))&&(i="/"),i||WI.displayNameForHost(e.host)||c};WI.truncateURL=function(c,e=!1,t=6){if(!c.startsWith("data:"))return c;const i=c.indexOf(",")+1;let n=c.slice(0,i);e&&(n+=`
`);const s=c.slice(i);if(s.length<t)return n+s;const a=s.slice(0,Math.ceil(t/2)),d="\u2026",p=e?`
${d}
`:d,f=s.slice(-Math.floor(t/2));return n+a+p+f};WI.displayNameForHost=function(c){return c};WI.h2Authority=function(c){let{scheme:e,userinfo:t,host:i,port:n}=c,s=i||"";return t&&e!=="http"&&e!=="https"&&(s=t+"@"+s),n&&(s+=":"+n),s};WI.h2Path=function(c){let{scheme:e,path:t,queryString:i}=c,n=t||"";return!t&&(e==="http"||e==="https")&&(n="/"),i&&(n+="?"+i),n};var emDash="\u2014",enDash="\u2013",figureDash="\u2012",ellipsis="\u2026",zeroWidthSpace="\u200B",multiplicationSign="\xD7";Object.defineProperty(Object,"shallowCopy",{value(c){for(var e={},t=Object.keys(c),i=0;i<t.length;++i)e[t[i]]=c[t[i]];return e}});Object.defineProperty(Object,"shallowEqual",{value(c,e){if(!(c instanceof Object)||!(e instanceof Object))return!1;if(c===e||Array.shallowEqual(c,e))return!0;if(c.constructor!==e.constructor)return!1;let t=Object.keys(c),i=Object.keys(e);if(t.length!==i.length)return!1;for(let n of t){if(!(n in e))return!1;let s=c[n],a=e[n];if(s!==a&&!Array.shallowEqual(s,a))return!1}return!0}});Object.defineProperty(Object,"filter",{value(c,e){let t={};for(let i in c)e(i,c[i])&&(t[i]=c[i]);return t}});Object.defineProperty(Object.prototype,"valueForCaseInsensitiveKey",{value(c){if(this.hasOwnProperty(c))return this[c];var e=c.toLowerCase();for(var t in this)if(t.toLowerCase()===e)return this[t]}});Object.defineProperty(Map,"fromObject",{value(c){let e=new Map;for(let t in c)e.set(t,c[t]);return e}});Object.defineProperty(Map.prototype,"take",{value(c){let e=this.get(c);return this.delete(c),e}});Object.defineProperty(Map.prototype,"getOrInitialize",{value(c,e){console.assert(e!==void 0,"getOrInitialize should not be used with undefined.");let t=this.get(c);return t||(this.set(c,e),e)}});Object.defineProperty(Set.prototype,"take",{value(c){let e=this.has(c);return e&&this.delete(c),e}});Object.defineProperty(Set.prototype,"equals",{value(c){return this.size===c.size&&this.isSubsetOf(c)}});Object.defineProperty(Set.prototype,"difference",{value(c){if(c===this)return new Set;let e=new Set;for(let t of this)c.has(t)||e.add(t);return e}});Object.defineProperty(Set.prototype,"firstValue",{get(){return this.values().next().value}});Object.defineProperty(Set.prototype,"lastValue",{get(){return Array.from(this.values()).lastValue}});Object.defineProperty(Set.prototype,"intersects",{value(c){if(!this.size||!c.size)return!1;for(let e of this)if(c.has(e))return!0;return!1}});Object.defineProperty(Set.prototype,"isSubsetOf",{value(c){for(let e of this)if(!c.has(e))return!1;return!0}});Object.defineProperty(Node.prototype,"traverseNextNode",{value(c){var e=this.firstChild;if(e)return e;if(c&&this===c)return null;if(e=this.nextSibling,e)return e;for(e=this;e&&!e.nextSibling&&(!c||!e.parentNode||e.parentNode!==c);)e=e.parentNode;return e?e.nextSibling:null}});Object.defineProperty(Node.prototype,"traversePreviousNode",{value(c){if(c&&this===c)return null;for(var e=this.previousSibling;e&&e.lastChild;)e=e.lastChild;return e||this.parentNode}});Object.defineProperty(Node.prototype,"rangeOfWord",{value(c,e,t,i){var n,s=0,a,d=0;if(t||(t=this),!i||i==="backward"||i==="both"){for(var p=this;p;){if(p===t){n||(n=t);break}if(p.nodeType===Node.TEXT_NODE){let b=p===this?c-1:p.nodeValue.length-1;for(var f=b;f>=0;--f)if(e.indexOf(p.nodeValue[f])!==-1){n=p,s=f+1;break}}if(n)break;p=p.traversePreviousNode(t)}n||(n=t,s=0)}else n=this,s=c;if(!i||i==="forward"||i==="both"){for(p=this;p;){if(p===t){a||(a=t);break}if(p.nodeType===Node.TEXT_NODE){let b=p===this?c:0;for(var f=b;f<p.nodeValue.length;++f)if(e.indexOf(p.nodeValue[f])!==-1){a=p,d=f;break}}if(a)break;p=p.traverseNextNode(t)}a||(a=t,d=t.nodeType===Node.TEXT_NODE?t.nodeValue.length:t.childNodes.length)}else a=this,d=c;var _=this.ownerDocument.createRange();return _.setStart(n,s),_.setEnd(a,d),_}});Object.defineProperty(Element.prototype,"realOffsetWidth",{get(){return this.getBoundingClientRect().width}});Object.defineProperty(Element.prototype,"realOffsetHeight",{get(){return this.getBoundingClientRect().height}});Object.defineProperty(Element.prototype,"totalOffsetLeft",{get(){return this.getBoundingClientRect().left}});Object.defineProperty(Element.prototype,"totalOffsetRight",{get(){return this.getBoundingClientRect().right}});Object.defineProperty(Element.prototype,"totalOffsetTop",{get(){return this.getBoundingClientRect().top}});Object.defineProperty(Element.prototype,"totalOffsetBottom",{get(){return this.getBoundingClientRect().bottom}});Object.defineProperty(Element.prototype,"removeChildren",{value(){this.firstChild&&(this.textContent="")}});Object.defineProperty(Element.prototype,"isInsertionCaretInside",{value(){var c=window.getSelection();if(!c.rangeCount||!c.isCollapsed)return!1;var e=c.getRangeAt(0);return e.startContainer===this||this.contains(e.startContainer)}});Object.defineProperty(Element.prototype,"createChild",{value(c,e){var t=this.ownerDocument.createElement(c);return e&&(t.className=e),this.appendChild(t),t}});Object.defineProperty(Element.prototype,"isScrolledToBottom",{value(){return this.scrollTop+this.clientHeight===this.scrollHeight}});Object.defineProperty(Element.prototype,"recalculateStyles",{value(){this.ownerDocument.defaultView.getComputedStyle(this)}});Object.defineProperty(DocumentFragment.prototype,"createChild",{value:Element.prototype.createChild});Object.defineProperty(Event.prototype,"stop",{value(){this.stopImmediatePropagation(),this.preventDefault()}});Object.defineProperty(KeyboardEvent.prototype,"commandOrControlKey",{get(){return WI.Platform.name==="mac"?this.metaKey:this.ctrlKey}});Object.defineProperty(MouseEvent.prototype,"commandOrControlKey",{get(){return WI.Platform.name==="mac"?this.metaKey:this.ctrlKey}});Object.defineProperty(Array,"isTypedArray",{value(c){if(!c)return!1;let e=c.constructor;return e===Int8Array||e===Int16Array||e===Int32Array||e===Uint8Array||e===Uint8ClampedArray||e===Uint16Array||e===Uint32Array||e===Float32Array||e===Float64Array}});Object.defineProperty(Array,"shallowEqual",{value(c,e){function t(n){return Array.isArray(n)||Array.isTypedArray(n)}if(!t(c)||!t(e))return!1;if(c===e)return!0;let i=c.length;if(i!==e.length)return!1;for(let n=0;n<i;++n)if(c[n]!==e[n]&&!Object.shallowEqual(c[n],e[n]))return!1;return!0}});Object.defineProperty(Array,"diffArrays",{value(c,e,t,i){"use strict";function n(p,f){return p===f}i=i||n;function s(){let p=c.length,f=e.length,_=p+f;for(let b=0;b<c.length&&!(b>_);++b)for(let w=0;w<e.length;++w){let S=b+w;if(S>_)break;if(i(c[b],e[w])){S<_&&(_=S,p=b,f=w);break}}return[p,f]}function a(p,f){let _=Math.min(p.length,f.length),b=0;for(;b<_&&i(p[b],f[b]);)++b;return b}function d(p,f,_){for(let b=0;b<p;++b)t(_[b],f)}for(;c.length||e.length;){let p=a(c,e);if(p&&(d(p,0,e),c=c.slice(p),e=e.slice(p)),!c.length&&!e.length)break;let[f,_]=s();d(f,-1,c),d(_,1,e),c=c.slice(f),e=e.slice(_)}}});Object.defineProperty(Array.prototype,"lastValue",{get(){if(!!this.length)return this[this.length-1]}});Object.defineProperty(Array.prototype,"adjacencies",{value:function*(){for(let c=1;c<this.length;++c)yield[this[c-1],this[c]]}});Object.defineProperty(Array.prototype,"remove",{value(c){for(let e=0;e<this.length;++e)if(this[e]===c)return this.splice(e,1),!0;return!1}});Object.defineProperty(Array.prototype,"removeAll",{value(c){for(let e=this.length-1;e>=0;--e)this[e]===c&&this.splice(e,1)}});Object.defineProperty(Array.prototype,"toggleIncludes",{value(c,e){let t=this.includes(c);t!==!!e&&(t?this.remove(c):this.push(c))}});Object.defineProperty(Array.prototype,"insertAtIndex",{value(c,e){this.splice(e,0,c)}});Object.defineProperty(Array.prototype,"keySet",{value(){let c=Object.create(null);for(var e=0;e<this.length;++e)c[this[e]]=!0;return c}});Object.defineProperty(Array.prototype,"partition",{value(c){let e=[],t=[];for(let i=0;i<this.length;++i){let n=this[i];c(n)?e.push(n):t.push(n)}return[e,t]}});Object.defineProperty(String.prototype,"isLowerCase",{value(){return String(this)===this.toLowerCase()}});Object.defineProperty(String.prototype,"isUpperCase",{value(){return String(this)===this.toUpperCase()}});Object.defineProperty(String.prototype,"truncateStart",{value(c){"use strict";return this.length<=c?this:ellipsis+this.substr(this.length-c+1)}});Object.defineProperty(String.prototype,"truncateMiddle",{value(c){"use strict";if(this.length<=c)return this;var e=c>>1,t=c-e-1;return this.substr(0,e)+ellipsis+this.substr(this.length-t,t)}});Object.defineProperty(String.prototype,"truncateEnd",{value(c){"use strict";return this.length<=c?this:this.substr(0,c-1)+ellipsis}});Object.defineProperty(String.prototype,"truncate",{value(c){"use strict";if(this.length<=c)return this;let e=this.slice(0,c),t=e.search(/\s\S*$/);return t>Math.floor(c/2)&&(e=e.slice(0,t-1)),e+ellipsis}});Object.defineProperty(String.prototype,"collapseWhitespace",{value(){return this.replace(/[\s\xA0]+/g," ")}});Object.defineProperty(String.prototype,"removeWhitespace",{value(){return this.replace(/[\s\xA0]+/g,"")}});Object.defineProperty(String.prototype,"escapeCharacters",{value(c){if(!c)return this.valueOf();let e=new Set(c),t=!1;for(let n of this)if(!!e.has(n)){t=!0;break}if(!t)return this.valueOf();let i="";for(let n of this)e.has(n)&&(i+="\\"),i+=n;return i.valueOf()}});Object.defineProperty(String.prototype,"escapeForRegExp",{value(){return this.escapeCharacters("^[]{}()\\.$*+?|")}});Object.defineProperty(String.prototype,"capitalize",{value(){return this.charAt(0).toUpperCase()+this.slice(1)}});Object.defineProperty(String.prototype,"extendedLocaleCompare",{value(c){return this.localeCompare(c,void 0,{numeric:!0})}});Object.defineProperty(String,"tokenizeFormatString",{value(c){var e=[],t=0;function i(p){e.push({type:"string",value:p})}function n(p,f,_){e.push({type:"specifier",specifier:p,precision:f,substitutionIndex:_})}for(var s=0,a=c.indexOf("%",s);a!==-1;a=c.indexOf("%",s)){if(i(c.substring(s,a)),s=a+1,c[s]==="%"){i("%"),++s;continue}if(!isNaN(c[s])){for(var d=parseInt(c.substring(s),10);!isNaN(c[s]);)++s;d>0&&c[s]==="$"&&(t=d-1,++s)}const p=6;let f=p;if(c[s]===".")for(++s,f=parseInt(c.substring(s),10),isNaN(f)&&(f=p);!isNaN(c[s]);)++s;n(c[s],f,t),++t,++s}return i(c.substring(s)),e}});Object.defineProperty(String.prototype,"lineCount",{get(){"use strict";let c=1,e=0;for(;;){if(e=this.indexOf(`
`,e),e===-1)return c;e+=1,c++}}});Object.defineProperty(String.prototype,"lastLine",{get(){"use strict";let c=this.lastIndexOf(`
`);return c===-1?this:this.slice(c+1)}});Object.defineProperty(String.prototype,"hash",{get(){for(var e=2654435769,t=null,i=0;i<this.length;++i){var n=this[i].charCodeAt(0);if(t===null){t=n;continue}e+=t,e=e<<16^(n<<11^e),e+=e>>11,t=null}return t!==null&&(e+=t,e^=e<<11,e+=e>>17),e^=e<<3,e+=e>>5,e^=e<<2,e+=e>>15,e^=e<<10,(4294967295+e+1).toString(36)}});Object.defineProperty(String,"standardFormatters",{value:{d:function(c){return parseInt(c).toLocaleString()},f:function(c,e){let t=parseFloat(c);if(isNaN(t))return NaN;let i={minimumFractionDigits:e.precision,maximumFractionDigits:e.precision,useGrouping:!1};return t.toLocaleString(void 0,i)},s:function(c){return c}}});Object.defineProperty(String,"format",{value(c,e,t,i,n){if(!c||!e||!e.length)return{formattedResult:n(i,c),unusedSubstitutions:e};function s(){return'String.format("'+c+'", "'+Array.from(e).join('", "')+'")'}function a(E){console.warn(s()+": "+E)}function d(E){console.error(s()+": "+E)}for(var p=i,f=String.tokenizeFormatString(c),_={},b=0;b<f.length;++b){var w=f[b];if(w.type==="string"){p=n(p,w.value);continue}if(w.type!=="specifier"){d('Unknown token type "'+w.type+'" found.');continue}if(w.substitutionIndex>=e.length){d("not enough substitution arguments. Had "+e.length+" but needed "+(w.substitutionIndex+1)+", so substitution was skipped."),p=n(p,"%"+(w.precision>-1?w.precision:"")+w.specifier);continue}if(_[w.substitutionIndex]=!0,!(w.specifier in t)){a("unsupported format character \u201C"+w.specifier+"\u201D. Treating as a string."),p=n(p,e[w.substitutionIndex]);continue}p=n(p,t[w.specifier](e[w.substitutionIndex],w))}for(var S=[],b=0;b<e.length;++b)b in _||S.push(e[b]);return{formattedResult:p,unusedSubstitutions:S}}});Object.defineProperty(String.prototype,"format",{value(){return String.format(this,arguments,String.standardFormatters,"",function(c,e){return c+e}).formattedResult}});Object.defineProperty(String.prototype,"insertWordBreakCharacters",{value(){return this.replace(/([\/;:\)\]\}&?])/g,"$1\u200B")}});Object.defineProperty(String.prototype,"removeWordBreakCharacters",{value(){return this.replace(/\u200b/g,"")}});Object.defineProperty(String.prototype,"levenshteinDistance",{value(c){for(var e=this.length,t=c.length,i=new Array(e+1),n=0;n<=e;++n)i[n]=new Array(t+1),i[n][0]=n;for(var s=0;s<=t;++s)i[0][s]=s;for(var s=1;s<=t;++s)for(var n=1;n<=e;++n)if(this[n-1]===c[s-1])i[n][s]=i[n-1][s-1];else{var a=i[n-1][s]+1,d=i[n][s-1]+1,p=i[n-1][s-1]+1;i[n][s]=Math.min(a,d,p)}return i[e][t]}});Object.defineProperty(String.prototype,"toCamelCase",{value(){return this.toLowerCase().replace(/[^\w]+(\w)/g,(c,e)=>e.toUpperCase())}});Object.defineProperty(String.prototype,"hasMatchingEscapedQuotes",{value(){return/^\"(?:[^\"\\]|\\.)*\"$/.test(this)||/^\'(?:[^\'\\]|\\.)*\'$/.test(this)}});Object.defineProperty(Math,"roundTo",{value(c,e){return Math.round(c/e)*e}});Object.defineProperty(Number,"constrain",{value(c,e,t){return isNaN(c)||t<e?e:(c<e?c=e:c>t&&(c=t),c)}});Object.defineProperty(Number,"percentageString",{value(c,e=1){return c.toLocaleString(void 0,{minimumFractionDigits:e,style:"percent"})}});Object.defineProperty(Number,"secondsToMillisecondsString",{value(c,e){let t=c*1e3;return e?WI.UIString("%.2fms").format(t):WI.UIString("%.1fms").format(t)}});Object.defineProperty(Number,"secondsToString",{value(c,e){let i=c*1e3;if(i<1e-4)return WI.UIString("%.0fms").format(0);if(Math.abs(i)<10+1e-4)return e?WI.UIString("%.3fms").format(i):WI.UIString("%.2fms").format(i);if(Math.abs(i)<100+1e-4)return e?WI.UIString("%.2fms").format(i):WI.UIString("%.1fms").format(i);if(Math.abs(i)<1e3+1e-4)return e?WI.UIString("%.1fms").format(i):WI.UIString("%.0fms").format(i);if(e||Math.abs(c)<60)return WI.UIString("%.2fs").format(c);let n=c/60;if(Math.abs(n)<60)return WI.UIString("%.1fmin").format(n);let s=n/60;if(Math.abs(s)<24)return WI.UIString("%.1fhrs").format(s);let a=s/24;return WI.UIString("%.1f days").format(a)}});Object.defineProperty(Number,"bytesToString",{value(c,e){if(e===void 0&&(e=!0),Math.abs(c)<1024)return WI.UIString("%.0f B").format(c);let t=c/1024;if(Math.abs(t)<1024)return e||Math.abs(t)<10?WI.UIString("%.2f KB").format(t):WI.UIString("%.1f KB").format(t);let i=t/1024;if(Math.abs(i)<1024)return e||Math.abs(i)<10?WI.UIString("%.2f MB").format(i):WI.UIString("%.1f MB").format(i);let n=i/1024;return e||Math.abs(n)<10?WI.UIString("%.2f GB").format(n):WI.UIString("%.1f GB").format(n)}});Object.defineProperty(Number,"abbreviate",{value(c){return c<1e3?c.toLocaleString():c<1e6?WI.UIString("%.1fK").format(Math.round(c/100)/10):c<1e9?WI.UIString("%.1fM").format(Math.round(c/1e5)/10):WI.UIString("%.1fB").format(Math.round(c/1e8)/10)}});Object.defineProperty(Number,"zeroPad",{value(c,e){return c.toLocaleString().padStart(e,"0")}});Object.defineProperty(Number,"countDigits",{value(c){return c===0?1:(c=Math.abs(c),Math.floor(Math.log(c)*Math.LOG10E)+1)}});Object.defineProperty(Number.prototype,"maxDecimals",{value(c){let e=10**c;return Math.round(this*e)/e}});Object.defineProperty(Uint32Array,"isLittleEndian",{value(){if("_isLittleEndian"in this)return this._isLittleEndian;var c=new ArrayBuffer(4),e=new Uint32Array(c),t=new Uint8Array(c);return e[0]=168496141,this._isLittleEndian=t[0]===13&&t[1]===12&&t[2]===11&&t[3]===10,this._isLittleEndian}});function isEmptyObject(c){for(var e in c)return!1;return!0}function isEnterKey(c){return c.keyCode!==229&&c.keyIdentifier==="Enter"}function resolveDotsInPath(c){if(!c||c.indexOf("./")===-1)return c;console.assert(c.charAt(0)==="/");for(var e=[],t=c.split("/"),i=0;i<t.length;++i){var n=t[i];if(n!=="."){if(n===".."){if(e.length===1)continue;e.pop();continue}e.push(n)}}return e.join("/")}function parseMIMEType(c){if(!c)return{type:c,boundary:null,encoding:null};var e=c.split(/\s*;\s*/);console.assert(e.length>=1);for(var t=e[0],i=null,n=null,s=1;s<e.length;++s){var a=e[s].split(/\s*=\s*/);a.length===2&&(a[0].toLowerCase()==="boundary"?i=a[1]:a[0].toLowerCase()==="charset"&&(n=a[1].replace('^"|"$',"")))}return{type:t,boundary:i||null,encoding:n||null}}function simpleGlobStringToRegExp(c,e){if(!c)return null;var t=c.escapeCharacters("^[]{}()\\.$+?|");t=t.replace(/\\\\\*/g,"\\*");var i=/(^|[^\\])\*+/g;return i.test(c)&&(t=t.replace(i,"$1.*"),t="\\b"+t+"\\b"),new RegExp(t,e)}Object.defineProperty(Array.prototype,"lowerBound",{value(c,e){function t(a,d){return a-d}e=e||t;for(var i=0,n=this.length;i<n;){var s=i+n>>1;e(c,this[s])>0?i=s+1:n=s}return n}});Object.defineProperty(Array.prototype,"upperBound",{value(c,e){function t(a,d){return a-d}e=e||t;for(var i=0,n=this.length;i<n;){var s=i+n>>1;e(c,this[s])>=0?i=s+1:n=s}return n}});Object.defineProperty(Array.prototype,"binaryIndexOf",{value(c,e){function t(n,s){return n-s}e=e||t;var i=this.lowerBound(c,e);return i<this.length&&e(c,this[i])===0?i:-1}});Object.defineProperty(Promise,"chain",{async value(c,e){let t=[];for(let i=0;i<c.length;++i)t.push(await c[i](t.lastValue||e||null,i));return t}});Object.defineProperty(Promise,"delay",{value(c){return new Promise(e=>setTimeout(e,c||0))}});function appendWebInspectorSourceURL(c){return c.includes("//# sourceURL")?c:`
//# sourceURL=__WebInspectorInternal__
`+c}function appendWebInspectorConsoleEvaluationSourceURL(c){return c.includes("//# sourceURL")?c:`
//# sourceURL=__WebInspectorConsoleEvaluation__
`+c}function isWebInspectorInternalScript(c){return c==="__WebInspectorInternal__"}function isWebInspectorConsoleEvaluationScript(c){return c==="__WebInspectorConsoleEvaluation__"}function isWebKitInjectedScript(c){return c&&c.startsWith("__InjectedScript_")&&c.endsWith(".js")}function isWebKitInternalScript(c){return isWebInspectorConsoleEvaluationScript(c)?!1:isWebKitInjectedScript(c)?!0:c&&c.startsWith("__Web")&&c.endsWith("__")}function isFunctionStringNativeCode(c){return c.endsWith(`{
    [native code]
}`)}function whitespaceRatio(c,e,t){let i=0,n=t-e;for(let a=e;a<t;a++){let d=c[a];d===" "?i++:d==="	"?i+=4:d===`
`&&(i+=8)}return i/n}function isTextLikelyMinified(c){return c.length<=2500?whitespaceRatio(c,0,c.length)<.2:whitespaceRatio(c,0,2500)<.2||whitespaceRatio(c,c.length-2500,c.length)<.2}function doubleQuotedString(c){return JSON.stringify(c)}function insertionIndexForObjectInListSortedByFunction(c,e,t,i){return i?e.upperBound(c,t):e.lowerBound(c,t)}function insertObjectIntoSortedArray(c,e,t){e.splice(insertionIndexForObjectInListSortedByFunction(c,e,t),0,c)}function decodeBase64ToBlob(c,e){e=e||"";const t=1024;for(var i=atob(c),n=i.length,s=Math.ceil(n/t),a=new Array(s),d=0;d<s;++d){for(var p=d*t,f=Math.min(p+t,n),_=new Array(f-p),b=p,w=0;b<f;++w,++b)_[w]=i[b].charCodeAt(0);a[d]=new Uint8Array(_)}return new Blob(a,{type:e})}function textToBlob(c,e){return new Blob([c],{type:e})}function blobAsText(c,e){console.assert(c instanceof Blob);let t=new FileReader;t.addEventListener("loadend",()=>{e(t.result)}),t.readAsText(c)}WI.SearchUtilities=class{static get defaultSettings(){return{caseSensitive:WI.settings.searchCaseSensitive,regularExpression:WI.settings.searchRegularExpression}}static createSettings(e,t={}){let i={};for(let[n,s]of Object.entries(WI.SearchUtilities.defaultSettings)){let a=new WI.Setting(e+"-"+s.name,s.value);s.addEventListener(WI.Setting.Event.Changed,d=>{a.value=s.value}),i[n]=a,t.handleChanged&&a.addEventListener(WI.Setting.Event.Changed,t.handleChanged)}return i}static regExpForString(e,t={}){function i(s){return s instanceof WI.Setting?s.value:!!s}console.assert(typeof e=="string"&&e||e instanceof RegExp),i(t.regularExpression)||(e=simpleGlobStringToRegExp(String(e))),console.assert(typeof e=="string"&&e||e instanceof RegExp);let n="g";return i(t.caseSensitive)||(n+="i"),new RegExp(e,n)}static createSettingsButton(e){console.assert(!isEmptyObject(e));let t=!1,i=document.createElement("button");i.addEventListener("mousedown",s=>{if(s.stop(),t)return;t=!0;let a=WI.ContextMenu.createFromEvent(s);a.addBeforeShowCallback(()=>{t=!1}),e.caseSensitive&&a.appendCheckboxItem(WI.UIString("Case Sensitive","Case Sensitive @ Context Menu","Context menu label for whether searches should be case sensitive."),()=>{e.caseSensitive.value=!e.caseSensitive.value},e.caseSensitive.value),e.regularExpression&&a.appendCheckboxItem(WI.UIString("Regular Expression","Regular Expression @ Context Menu","Context menu label for whether searches should be treated as regular expressions."),()=>{e.regularExpression.value=!e.regularExpression.value},e.regularExpression.value),a.show()}),i.classList.add("search-settings"),i.tabIndex=-1,i.appendChild(WI.ImageUtilities.useSVGSymbol("data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' d='M 7.5009 14 C 8.3259 14 9.0009 13.325 9.0019 12.5 L 9.0009 11.725 C 9.1479 11.673 9.2909 11.616 9.4299 11.551 L 10.1759 12.298 C 10.7599 12.881 11.7149 12.88 12.2969 12.297 C 12.5899 12.005 12.7349 11.619 12.7349 11.235 C 12.7349 10.852 12.5899 10.467 12.2979 10.175 L 11.5519 9.429 C 11.6179 9.289 11.6739 9.146 11.7259 9 L 12.5009 8.999 C 13.3259 9 14.0009 8.325 14.0009 7.5 C 14.0009 6.674 13.3259 6 12.5009 5.999 L 11.7259 6 C 11.6739 5.853 11.6179 5.71 11.5519 5.571 L 12.2979 4.825 C 12.5889 4.533 12.7349 4.148 12.7349 3.764 C 12.7349 3.379 12.5899 2.995 12.2989 2.704 C 11.7149 2.119 10.7599 2.119 10.1769 2.702 L 9.4299 3.449 C 9.2899 3.382 9.1479 3.327 9.0009 3.275 L 9.0009 2.499 C 9.0009 1.674 8.3259 0.999 7.5009 0.999 C 6.6759 0.999 6.0009 1.674 6.0009 2.499 L 6.0009 3.275 C 5.8549 3.327 5.7109 3.383 5.5709 3.449 L 4.8249 2.703 C 4.2419 2.12 3.2869 2.12 2.7039 2.703 C 2.4119 2.995 2.2659 3.379 2.2659 3.763 C 2.2659 4.148 2.4119 4.532 2.7029 4.824 L 3.4499 5.571 C 3.3839 5.71 3.3289 5.853 3.2759 6 L 2.5009 5.999 C 1.6759 6 1.0009 6.674 1.0009 7.5 C 1.0009 8.325 1.6759 9 2.5009 9 L 3.2759 9 C 3.3279 9.146 3.3839 9.289 3.4499 9.429 L 2.7039 10.175 C 2.4119 10.467 2.2649 10.852 2.2659 11.236 C 2.2649 11.621 2.4129 12.006 2.7029 12.296 C 3.2869 12.88 4.2419 12.88 4.8249 12.297 L 5.5719 11.551 C 5.7109 11.616 5.8539 11.673 6.0009 11.725 L 5.9999 12.5 C 6.0009 13.325 6.6759 14 7.5009 14 Z'/%3e %3cpath fill='none' stroke='currentColor' d='M 7.5 5.6 C 8.548 5.6 9.4 6.452 9.4 7.5 C 9.4 8.548 8.548 9.4 7.5 9.4 C 6.452 9.4 5.6 8.548 5.6 7.5 C 5.6 6.452 6.452 5.6 7.5 5.6'/%3e %3c/svg%3e","glyph"));function n(){i.classList.toggle("active",Object.values(e).some(s=>!!s.value))}return e.caseSensitive.addEventListener(WI.Setting.Event.Changed,n),e.regularExpression.addEventListener(WI.Setting.Event.Changed,n),n(),i}};WI.Setting=class lp extends WI.Object{constructor(e,t){super(),this._name=e,this._localStorageKey=WI.Setting._localStorageKey(this._name),this._defaultValue=t}static migrateValue(e){let t=WI.Setting._localStorageKey(e),i;if(!window.InspectorTest&&window.localStorage&&t in window.localStorage){try{i=JSON.parse(window.localStorage[t])}catch{}window.localStorage.removeItem(t)}return i}static reset(){let e=lp._localStorageKey(""),t=[];for(let i=0;i<window.localStorage.length;++i){let n=window.localStorage.key(i);n.startsWith(e)&&t.push(n)}for(let i of t)window.localStorage.removeItem(i)}static _localStorageKey(e){let t=InspectorFrontendHost?InspectorFrontendHost.inspectionLevel():1;return`com.apple.WebInspector${t>1?"-"+t:""}.${e}`}get name(){return this._name}get value(){if("_value"in this)return this._value;if(this._value=JSON.parse(JSON.stringify(this._defaultValue)),!window.InspectorTest&&window.localStorage&&this._localStorageKey in window.localStorage)try{this._value=JSON.parse(window.localStorage[this._localStorageKey])}catch{delete window.localStorage[this._localStorageKey]}return this._value}set value(e){if(this._value!==e){if(this._value=e,!window.InspectorTest&&window.localStorage)try{Object.shallowEqual(this._value,this._defaultValue)?delete window.localStorage[this._localStorageKey]:window.localStorage[this._localStorageKey]=JSON.stringify(this._value)}catch{console.error("Error saving setting with name: "+this._name)}this.dispatchEventToListeners(WI.Setting.Event.Changed,this._value,{name:this._name})}}reset(){this.value=JSON.parse(JSON.stringify(this._defaultValue))}};WI.Setting.Event={Changed:"setting-changed"};WI.settings={canvasRecordingAutoCaptureEnabled:new WI.Setting("canvas-recording-auto-capture-enabled",!1),canvasRecordingAutoCaptureFrameCount:new WI.Setting("canvas-recording-auto-capture-frame-count",1),consoleAutoExpandTrace:new WI.Setting("console-auto-expand-trace",!0),cssChangesPerNode:new WI.Setting("css-changes-per-node",!1),clearLogOnNavigate:new WI.Setting("clear-log-on-navigate",!0),clearNetworkOnNavigate:new WI.Setting("clear-network-on-navigate",!0),cpuTimelineThreadDetailsExpanded:new WI.Setting("cpu-timeline-thread-details-expanded",!1),emulateInUserGesture:new WI.Setting("emulate-in-user-gesture",!1),enableControlFlowProfiler:new WI.Setting("enable-control-flow-profiler",!1),enableLineWrapping:new WI.Setting("enable-line-wrapping",!1),groupMediaRequestsByDOMNode:new WI.Setting("group-media-requests-by-dom-node",WI.Setting.migrateValue("group-by-dom-node")||!1),indentUnit:new WI.Setting("indent-unit",4),indentWithTabs:new WI.Setting("indent-with-tabs",!1),resourceCachingDisabled:new WI.Setting("disable-resource-caching",!1),searchCaseSensitive:new WI.Setting("search-case-sensitive",!1),searchRegularExpression:new WI.Setting("search-regular-expression",!1),selectedNetworkDetailContentViewIdentifier:new WI.Setting("network-detail-content-view-identifier","preview"),sourceMapsEnabled:new WI.Setting("source-maps-enabled",!0),showAllRequestsBreakpoint:new WI.Setting("show-all-requests-breakpoint",!0),showAssertionFailuresBreakpoint:new WI.Setting("show-assertion-failures-breakpoint",!0),showCanvasPath:new WI.Setting("show-canvas-path",!1),showImageGrid:new WI.Setting("show-image-grid",!1),showInvalidCharacters:new WI.Setting("show-invalid-characters",!1),showJavaScriptTypeInformation:new WI.Setting("show-javascript-type-information",!1),showPaintRects:new WI.Setting("show-paint-rects",!1),showRulers:new WI.Setting("show-rulers",!1),showRulersDuringElementSelection:new WI.Setting("show-rulers-during-element-selection",!0),showScopeChainOnPause:new WI.Setting("show-scope-chain-sidebar",!0),showShadowDOM:new WI.Setting("show-shadow-dom",!0),showWhitespaceCharacters:new WI.Setting("show-whitespace-characters",!1),tabSize:new WI.Setting("tab-size",4),timelinesAutoStop:new WI.Setting("timelines-auto-stop",!0),timelineOverviewGroupBySourceCode:new WI.Setting("timeline-overview-group-by-source-code",!0),zoomFactor:new WI.Setting("zoom-factor",1),experimentalEnableLayersTab:new WI.Setting("experimental-enable-layers-tab",!1),experimentalEnableNewTabBar:new WI.Setting("experimental-enable-new-tab-bar",!1),experimentalEnableSourcesTab:new WI.Setting("experimental-enable-sources-tab",!1),experimentalEnableStylesJumpToEffective:new WI.Setting("experimental-styles-jump-to-effective",!1),autoLogProtocolMessages:new WI.Setting("auto-collect-protocol-messages",!1),autoLogTimeStats:new WI.Setting("auto-collect-time-stats",!1),enableLayoutFlashing:new WI.Setting("enable-layout-flashing",!1),enableStyleEditingDebugMode:new WI.Setting("enable-style-editing-debug-mode",!1),enableUncaughtExceptionReporter:new WI.Setting("enable-uncaught-exception-reporter",!0),filterMultiplexingBackendInspectorProtocolMessages:new WI.Setting("filter-multiplexing-backend-inspector-protocol-messages",!0),layoutDirection:new WI.Setting("layout-direction-override","system"),pauseForInternalScripts:new WI.Setting("pause-for-internal-scripts",!1),debugShowInternalObjectsInHeapSnapshot:new WI.Setting("debug-show-internal-objects-in-heap-snapshot",!1)};WI.YieldableTask=class{constructor(e,t,i={}){let{workInterval:n,idleInterval:s}=i;console.assert(!n||n>0,n),console.assert(!s||s>0,s),console.assert(e&&typeof e.yieldableTaskWillProcessItem=="function","Delegate provide an implementation of method 'yieldableTaskWillProcessItem'."),console.assert(t instanceof Object&&Symbol.iterator in t,"Argument `items` must subclass Object and be iterable.",t),this._workInterval=n||10,this._idleInterval=s||0,this._delegate=e,this._items=t,this._idleTimeoutIdentifier=void 0,this._processing=!1,this._processing=!1,this._cancelled=!1}get processing(){return this._processing}get cancelled(){return this._cancelled}get idleInterval(){return this._idleInterval}get workInterval(){return this._workInterval}start(){if(console.assert(!this._processing),this._processing||(console.assert(!this._cancelled),this._cancelled))return;function*e(){let t=Date.now(),i=[];for(let n of this._items){if(this._cancelled||(this._delegate.yieldableTaskWillProcessItem(this,n),i.push(n),this._cancelled))break;let s=Date.now()-t;if(s>this._workInterval){let a=i.slice();i=[],this._willYield(a,s),yield,t=Date.now()}}i.length&&this._willYield(i,Date.now()-t)}this._processing=!0,this._pendingItemsIterator=e.call(this),this._processPendingItems()}cancel(){!this._processing||(this._cancelled=!0)}_processPendingItems(){if(console.assert(this._processing),!this._cancelled){if(!this._pendingItemsIterator.next().done){this._idleTimeoutIdentifier=setTimeout(()=>{this._processPendingItems()},this._idleInterval);return}this._didFinish()}}_willYield(e,t){typeof this._delegate.yieldableTaskDidYield=="function"&&this._delegate.yieldableTaskDidYield(this,e,t)}_didFinish(){this._processing=!1,this._pendingItemsIterator=null,this._idleTimeoutIdentifier&&(clearTimeout(this._idleTimeoutIdentifier),this._idleTimeoutIdentifier=void 0),typeof this._delegate.yieldableTaskDidFinish=="function"&&this._delegate.yieldableTaskDidFinish(this)}};WI.ProtocolTracer=class{logStarted(){}logFrontendException(e,t,i){}logFrontendRequest(e,t){}logWillHandleResponse(e,t){}logDidHandleResponse(e,t,i=null){}logWillHandleEvent(e,t){}logDidHandleEvent(e,t,i=null){}logFinished(){}};WI.LoggingProtocolTracer=class extends WI.ProtocolTracer{constructor(){super(),this._dumpMessagesToConsole=!1,this._dumpTimingDataToConsole=!1,this._filterMultiplexingBackend=!0,this._logToConsole=window.InspectorTest?InspectorFrontendHost.unbufferedLog.bind(InspectorFrontendHost):console.log}set dumpMessagesToConsole(e){this._dumpMessagesToConsole=!!e}get dumpMessagesToConsole(){return this._dumpMessagesToConsole}set dumpTimingDataToConsole(e){this._dumpTimingDataToConsole=!!e}get dumpTimingDataToConsole(){return this._dumpTimingDataToConsole}set filterMultiplexingBackend(e){this._filterMultiplexingBackend=!!e}get filterMultiplexingBackend(){return this._filterMultiplexingBackend}logFrontendException(e,t,i){this._processEntry({type:"exception",connection:e,message:t,exception:i})}logFrontendRequest(e,t){this._processEntry({type:"request",connection:e,message:t})}logWillHandleResponse(e,t){let i={type:"response",connection:e,message:t};this._processEntry(i)}logDidHandleResponse(e,t,i=null){let n={type:"response",connection:e,message:t};i&&(n.timings=Object.shallowCopy(i)),this._processEntry(n)}logWillHandleEvent(e,t){let i={type:"event",connection:e,message:t};this._processEntry(i)}logDidHandleEvent(e,t,i=null){let n={type:"event",connection:e,message:t};i&&(n.timings=Object.shallowCopy(i)),this._processEntry(n)}_processEntry(e){if(this._dumpTimingDataToConsole&&e.timings)e.timings.rtt&&e.timings.dispatch?this._logToConsole(`time-stats: Handling: ${e.timings.dispatch||NaN}ms; RTT: ${e.timings.rtt}ms`):e.timings.dispatch&&this._logToConsole(`time-stats: Handling: ${e.timings.dispatch||NaN}ms`);else if(this._dumpMessagesToConsole&&!e.timings){let t=e.connection,i=t&&t.target?t.target.identifier:"unknown";if(this._filterMultiplexingBackend&&i==="multi")return;let n=`${e.type} (${i})`;!window.InspectorTest&&InspectorFrontendHost.isBeingInspected()?e.type==="request"||e.type==="exception"?console.trace(n,e.message):this._logToConsole(n,e.message):this._logToConsole(`${n}: ${JSON.stringify(e.message)}`),e.exception&&(this._logToConsole(e.exception),e.exception.stack&&this._logToConsole(e.exception.stack))}}};InspectorBackendClass=class{constructor(){this._agents={},this._customTracer=null,this._defaultTracer=new WI.LoggingProtocolTracer,this._activeTracers=[this._defaultTracer],this._supportedDomainsForDebuggableType=new Map;for(let e of Object.values(WI.DebuggableType))this._supportedDomainsForDebuggableType.set(e,[]);WI.settings.autoLogProtocolMessages.addEventListener(WI.Setting.Event.Changed,this._startOrStopAutomaticTracing,this),WI.settings.autoLogTimeStats.addEventListener(WI.Setting.Event.Changed,this._startOrStopAutomaticTracing,this),this._startOrStopAutomaticTracing(),this.currentDispatchState={event:null,request:null,response:null}}get domains(){return this._agents}set dumpInspectorProtocolMessages(e){WI.settings.autoLogProtocolMessages.value=e,this._defaultTracer.dumpMessagesToConsole=e}get dumpInspectorProtocolMessages(){return WI.settings.autoLogProtocolMessages.value}set dumpInspectorTimeStats(e){WI.settings.autoLogTimeStats.value=e,this.dumpInspectorProtocolMessages||(this.dumpInspectorProtocolMessages=!0),this._defaultTracer.dumpTimingDataToConsole=e}get dumpInspectorTimeStats(){return WI.settings.autoLogTimeStats.value}set filterMultiplexingBackendInspectorProtocolMessages(e){WI.settings.filterMultiplexingBackendInspectorProtocolMessages.value=e,this._defaultTracer.filterMultiplexingBackend=e}get filterMultiplexingBackendInspectorProtocolMessages(){return WI.settings.filterMultiplexingBackendInspectorProtocolMessages.value}set customTracer(e){console.assert(!e||e instanceof WI.ProtocolTracer,e),console.assert(!e||e!==this._defaultTracer,e),!(!e&&!this._customTracer)&&e!==this._customTracer&&e!==this._defaultTracer&&(this._customTracer&&this._customTracer.logFinished(),this._customTracer=e,this._activeTracers=[this._defaultTracer],this._customTracer&&(this._customTracer.logStarted(),this._activeTracers.push(this._customTracer)))}get activeTracers(){return this._activeTracers}registerVersion(e,t){let i=this._agentForDomain(e);i.VERSION=t}registerCommand(e,t,i){var[n,s]=e.split("."),a=this._agentForDomain(n);a.addCommand(InspectorBackend.Command.create(a,e,t,i))}registerEnum(e,t){var[i,n]=e.split("."),s=this._agentForDomain(i);s.addEnum(n,t)}registerEvent(e,t){var[i,n]=e.split("."),s=this._agentForDomain(i);s.addEvent(new InspectorBackend.Event(n,t))}registerDomainDispatcher(e,t){var i=this._agentForDomain(e);i.dispatcher=t}dispatch(e){InspectorBackend.backendConnection.dispatch(e)}runAfterPendingDispatches(e){if(!WI.mainTarget){e();return}WI.mainTarget.connection.runAfterPendingDispatches(e)}activateDomain(e,t){let i=t||Object.values(WI.DebuggableType);for(let n of i)this._supportedDomainsForDebuggableType.get(n).push(e);if(!t||t.includes(InspectorFrontendHost.debuggableType())){let n=this._agents[e];return n.activate(),n}return null}supportedDomainsForDebuggableType(e){return console.assert(Object.values(WI.DebuggableType).includes(e),"Unknown debuggable type",e),this._supportedDomainsForDebuggableType.get(e)}_startOrStopAutomaticTracing(){this._defaultTracer.dumpMessagesToConsole=this.dumpInspectorProtocolMessages,this._defaultTracer.dumpTimingDataToConsole=this.dumpTimingDataToConsole,this._defaultTracer.filterMultiplexingBackend=this.filterMultiplexingBackendInspectorProtocolMessages}_agentForDomain(e){if(this._agents[e])return this._agents[e];var t=new InspectorBackend.Agent(e);return this._agents[e]=t,t}};InspectorBackend=new InspectorBackendClass;InspectorBackend.Agent=class{constructor(e){this._domainName=e,this._connection=InspectorBackend.backendConnection,this._dispatcher=null,this._active=!1,this._events={}}get domainName(){return this._domainName}get active(){return this._active}get connection(){return this._connection}set connection(e){this._connection=e}get dispatcher(){return this._dispatcher}set dispatcher(e){this._dispatcher=e}addEnum(e,t){this[e]=t}addCommand(e){this[e.commandName]=e}addEvent(e){this._events[e.eventName]=e}getEvent(e){return this._events[e]}hasEvent(e){return e in this._events}hasEventParameter(e,t){let i=this._events[e];return i&&i.parameterNames.includes(t)}activate(){this._active=!0,window[this._domainName+"Agent"]=this}dispatchEvent(e,t){return this._dispatcher?e in this._dispatcher?(this._dispatcher[e].apply(this._dispatcher,t),!0):(console.error(`Protocol Error: Attempted to dispatch an unimplemented method '${this._domainName}.${e}'`),!1):(console.error(`No domain dispatcher registered for domain '${this._domainName}', for event '${this._domainName}.${e}'`),!1)}};InspectorBackend.Command=function(c,e,t,i){"use strict";this._agent=c,this._instance=this;let[n,s]=e.split(".");this._qualifiedName=e,this._commandName=s,this._callSignature=t||[],this._replySignature=i||[]};InspectorBackend.Command.create=function(c,e,t,i){"use strict";let n=new InspectorBackend.Command(c,e,t,i);function s(){return console.assert(this instanceof InspectorBackend.Agent),n._invokeWithArguments.call(n,this,Array.from(arguments))}return s._instance=n,Object.setPrototypeOf(s,InspectorBackend.Command.prototype),s};InspectorBackend.Command.prototype={__proto__:Function.prototype,get qualifiedName(){return this._instance._qualifiedName},get commandName(){return this._instance._commandName},get callSignature(){return this._instance._callSignature},get replySignature(){return this._instance._replySignature},invoke(c,e,t){"use strict";let i=this._instance;function n(a){if(console.error(`Protocol Error: ${a}`),e)setTimeout(e.bind(null,a),0);else return Promise.reject(new Error(a))}if(typeof c!="object")return n(`invoke expects an object for command arguments but its type is '${typeof c}'.`);let s={};for(let{name:a,type:d,optional:p}of i.callSignature){if(!(a in c)&&!p)return n(`Missing argument '${a}' for command '${i.qualifiedName}'.`);let f=c[a];if(!(p&&f===void 0)){if(typeof f!==d)return n(`Invalid type of argument '${a}' for command '${i.qualifiedName}' call. It must be '${d}' but it is '${typeof f}'.`);s[a]=f}}if(t=t||i._agent,typeof e=="function")t._connection._sendCommandToBackendWithCallback(i,s,e);else return t._connection._sendCommandToBackendExpectingPromise(i,s)},supports(c){"use strict";return this._instance.callSignature.some(e=>e.name===c)},_invokeWithArguments(c,e){"use strict";let t=this._instance,i=typeof e.lastValue=="function"?e.pop():null;function n(a){if(console.error(`Protocol Error: ${a}`),i)setTimeout(i.bind(null,a),0);else return Promise.reject(new Error(a))}let s={};for(let{name:a,type:d,optional:p}of t.callSignature){if(!e.length&&!p)return n(`Invalid number of arguments for command '${t.qualifiedName}'.`);let f=e.shift();if(!(p&&f===void 0)){if(typeof f!==d)return n(`Invalid type of argument '${a}' for command '${t.qualifiedName}' call. It must be '${d}' but it is '${typeof f}'.`);s[a]=f}}if(!i&&e.length===1&&e[0]!==void 0)return n(`Protocol Error: Optional callback argument for command '${t.qualifiedName}' call must be a function but its type is '${typeof e[0]}'.`);if(i)c._connection._sendCommandToBackendWithCallback(t,s,i);else return c._connection._sendCommandToBackendExpectingPromise(t,s)}};InspectorBackend.Event=class{constructor(e,t){this.eventName=e,this.parameterNames=t}};InspectorBackend.globalSequenceId=1;InspectorBackend.Connection=class{constructor(){this._pendingResponses=new Map,this._agents={},this._deferredCallbacks=[],this._target=null}get target(){return this._target}set target(e){console.assert(!this._target),this._target=e;for(let t in this._agents){let i=this._agents[t].dispatcher;i&&(i.target=e)}}dispatch(e){let t=typeof e=="string"?JSON.parse(e):e;"id"in t?this._dispatchResponse(t):this._dispatchEvent(t)}runAfterPendingDispatches(e){console.assert(typeof e=="function"),this._pendingResponses.size?this._deferredCallbacks.push(e):e.call(this)}sendMessageToBackend(e){throw new Error("Should be implemented by a InspectorBackend.Connection subclass")}_dispatchResponse(e){console.assert(this._pendingResponses.size>=0),e.error&&e.error.code!==-32e3&&e.error.message!=="'Target' domain was not found"&&console.error("Request with id = "+e.id+" failed. "+JSON.stringify(e.error));let t=e.id;console.assert(this._pendingResponses.has(t),t,this._target?this._target.identifier:"(unknown)",this._pendingResponses);let i=this._pendingResponses.take(t)||{},{request:n,command:s,callback:a,promise:d}=i,p=performance.now();for(let b of InspectorBackend.activeTracers)b.logWillHandleResponse(this,e);InspectorBackend.currentDispatchState.request=n,InspectorBackend.currentDispatchState.response=e,typeof a=="function"?this._dispatchResponseToCallback(s,n,e,a):typeof d=="object"?this._dispatchResponseToPromise(s,e,d):console.error("Received a command response without a corresponding callback or promise.",e,s),InspectorBackend.currentDispatchState.request=null,InspectorBackend.currentDispatchState.response=null;let f=(performance.now()-p).toFixed(3),_=(p-i.sendRequestTimestamp).toFixed(3);for(let b of InspectorBackend.activeTracers)b.logDidHandleResponse(this,e,{rtt:_,dispatch:f});this._deferredCallbacks.length&&!this._pendingResponses.size&&this._flushPendingScripts()}_dispatchResponseToCallback(e,t,i,n){let s=[];if(s.push(i.error?i.error.message:null),i.result)for(let a of e.replySignature)s.push(i.result[a]);try{n.apply(null,s)}catch(a){WI.reportInternalError(a,{cause:`An uncaught exception was thrown while dispatching response callback for command ${e.qualifiedName}.`})}}_dispatchResponseToPromise(e,t,i){let{resolve:n,reject:s}=i;t.error?s(new Error(t.error.message)):n(t.result)}_dispatchEvent(e){let t=e.method,[i,n]=t.split(".");if(!(i in this._agents)){console.error("Protocol Error: Attempted to dispatch method '"+n+"' for non-existing domain '"+i+"'",e);return}let s=this._agents[i];if(!s.active){console.error("Protocol Error: Attempted to dispatch method for domain '"+i+"' which exists but is not active.",e);return}let a=s.getEvent(n);if(!a){console.error("Protocol Error: Attempted to dispatch an unspecified method '"+t+"'",e);return}let d=[];e.params&&(d=a.parameterNames.map(_=>e.params[_]));let p=performance.now();for(let _ of InspectorBackend.activeTracers)_.logWillHandleEvent(this,e);InspectorBackend.currentDispatchState.event=e;try{s.dispatchEvent(n,d)}catch(_){for(let b of InspectorBackend.activeTracers)b.logFrontendException(this,e,_);WI.reportInternalError(_,{cause:`An uncaught exception was thrown while handling event: ${t}`})}InspectorBackend.currentDispatchState.event=null;let f=(performance.now()-p).toFixed(3);for(let _ of InspectorBackend.activeTracers)_.logDidHandleEvent(this,e,{dispatch:f})}_sendCommandToBackendWithCallback(e,t,i){let n=InspectorBackend.globalSequenceId++,s={id:n,method:e.qualifiedName};isEmptyObject(t)||(s.params=t);let a={command:e,request:s,callback:i};InspectorBackend.activeTracer&&(a.sendRequestTimestamp=performance.now()),this._pendingResponses.set(n,a),this._sendMessageToBackend(s)}_sendCommandToBackendExpectingPromise(e,t){let i=InspectorBackend.globalSequenceId++,n={id:i,method:e.qualifiedName};isEmptyObject(t)||(n.params=t);let s={command:e,request:n};InspectorBackend.activeTracer&&(s.sendRequestTimestamp=performance.now());let a=new Promise(function(d,p){s.promise={resolve:d,reject:p}});return this._pendingResponses.set(i,s),this._sendMessageToBackend(n),a}_sendMessageToBackend(e){for(let t of InspectorBackend.activeTracers)t.logFrontendRequest(this,e);this.sendMessageToBackend(JSON.stringify(e))}_flushPendingScripts(){console.assert(this._pendingResponses.size===0);let e=this._deferredCallbacks;this._deferredCallbacks=[];for(let t of e)t.call(this)}};InspectorBackend.BackendConnection=class extends InspectorBackend.Connection{constructor(){super(),this._agents=InspectorBackend._agents}sendMessageToBackend(e){InspectorFrontendHost.sendMessageToBackend(e)}};InspectorBackend.WorkerConnection=class extends InspectorBackend.Connection{constructor(e){super(),this._workerId=e;for(let[t,i]of Object.entries(InspectorBackend._agents)){let n=Object.create(i);n.connection=this,i.dispatcher&&(n.dispatcher=new i.dispatcher.constructor),this._agents[t]=n}}sendMessageToBackend(e){WorkerAgent.sendMessageToWorker(this._workerId,e).catch(function(){})}};InspectorBackend.TargetConnection=class extends InspectorBackend.Connection{constructor(e){super(),this._targetId=e;for(let[t,i]of Object.entries(InspectorBackend._agents)){let n=Object.create(i);n.connection=this,i.dispatcher&&(n.dispatcher=new i.dispatcher.constructor),this._agents[t]=n}}sendMessageToBackend(e){TargetAgent.sendMessageToTarget(this._targetId,e)}};InspectorBackend.backendConnection=new InspectorBackend.BackendConnection;InspectorFrontendAPI={_loaded:!1,_pendingCommands:[],savedURL:function(c){},appendedToURL:function(c){},isTimelineProfilingEnabled:function(){return WI.timelineManager.isCapturing()},setTimelineProfilingEnabled:function(c){WI.timelineManager.isCapturing()!==c&&(c?WI.timelineManager.startCapturing():WI.timelineManager.stopCapturing())},setElementSelectionEnabled:function(c){WI.domManager.inspectModeEnabled=c},setDockingUnavailable:function(c){WI.updateDockingAvailability(!c)},setDockSide:function(c){WI.updateDockedState(c)},setIsVisible:function(c){WI.updateVisibilityState(c)},showConsole:function(){WI.showConsoleTab(),WI.quickConsole.prompt.focus(),document.readyState!=="complete"&&document.addEventListener("readystatechange",this),document.visibilityState!=="visible"&&document.addEventListener("visibilitychange",this)},handleEvent:function(c){console.assert(c.type==="readystatechange"||c.type==="visibilitychange"),document.readyState==="complete"&&document.visibilityState==="visible"&&(WI.quickConsole.prompt.focus(),document.removeEventListener("readystatechange",this),document.removeEventListener("visibilitychange",this))},showResources:function(){WI.settings.experimentalEnableSourcesTab.value?WI.showSourcesTab():WI.showResourcesTab()},showTimelines:function(){WI.showTimelineTab()},showMainResourceForFrame:function(c){const e={ignoreNetworkTab:!0,ignoreSearchTab:!0};WI.showSourceCodeForFrame(c,e)},contextMenuItemSelected:function(c){WI.ContextMenu.contextMenuItemSelected(c)},contextMenuCleared:function(){WI.ContextMenu.contextMenuCleared()},dispatchMessageAsync:function(c){WI.dispatchMessageFromBackend(c)},dispatchMessage:function(c){InspectorBackend.dispatch(c)},dispatch:function(c){if(!InspectorFrontendAPI._loaded)return InspectorFrontendAPI._pendingCommands.push(c),null;var e=c.shift();return console.assert(InspectorFrontendAPI[e],"Unexpected InspectorFrontendAPI method name: "+e),InspectorFrontendAPI[e]?InspectorFrontendAPI[e].apply(InspectorFrontendAPI,c):null},loadCompleted:function(){InspectorFrontendAPI._loaded=!0;for(var c=0;c<InspectorFrontendAPI._pendingCommands.length;++c)InspectorFrontendAPI.dispatch(InspectorFrontendAPI._pendingCommands[c]);delete InspectorFrontendAPI._pendingCommands}};InspectorBackend.registerApplicationCacheDispatcher=InspectorBackend.registerDomainDispatcher.bind(InspectorBackend,"ApplicationCache");InspectorBackend.registerEvent("ApplicationCache.applicationCacheStatusUpdated",["frameId","manifestURL","status"]);InspectorBackend.registerEvent("ApplicationCache.networkStateUpdated",["isNowOnline"]);InspectorBackend.registerCommand("ApplicationCache.getFramesWithManifests",[],["frameIds"]);InspectorBackend.registerCommand("ApplicationCache.enable",[],[]);InspectorBackend.registerCommand("ApplicationCache.getManifestForFrame",[{name:"frameId",type:"string",optional:!1}],["manifestURL"]);InspectorBackend.registerCommand("ApplicationCache.getApplicationCacheForFrame",[{name:"frameId",type:"string",optional:!1}],["applicationCache"]);InspectorBackend.activateDomain("ApplicationCache",["web"]);InspectorBackend.registerVersion("Audit",3);InspectorBackend.registerCommand("Audit.setup",[{name:"contextId",type:"number",optional:!0}],[]);InspectorBackend.registerCommand("Audit.run",[{name:"test",type:"string",optional:!1},{name:"contextId",type:"number",optional:!0}],["result","wasThrown"]);InspectorBackend.registerCommand("Audit.teardown",[],[]);InspectorBackend.activateDomain("Audit");InspectorBackend.registerCPUProfilerDispatcher=InspectorBackend.registerDomainDispatcher.bind(InspectorBackend,"CPUProfiler");InspectorBackend.registerEnum("CPUProfiler.ThreadInfoType",{Main:"main",WebKit:"webkit"});InspectorBackend.registerEvent("CPUProfiler.trackingStart",["timestamp"]);InspectorBackend.registerEvent("CPUProfiler.trackingUpdate",["event"]);InspectorBackend.registerEvent("CPUProfiler.trackingComplete",["timestamp"]);InspectorBackend.registerCommand("CPUProfiler.startTracking",[],[]);InspectorBackend.registerCommand("CPUProfiler.stopTracking",[],[]);InspectorBackend.activateDomain("CPUProfiler",["web"]);InspectorBackend.registerCSSDispatcher=InspectorBackend.registerDomainDispatcher.bind(InspectorBackend,"CSS");InspectorBackend.registerEnum("CSS.StyleSheetOrigin",{User:"user",UserAgent:"user-agent",Inspector:"inspector",Regular:"regular"});InspectorBackend.registerEnum("CSS.PseudoId",{FirstLine:"first-line",FirstLetter:"first-letter",Marker:"marker",Before:"before",After:"after",Selection:"selection",Scrollbar:"scrollbar",ScrollbarThumb:"scrollbar-thumb",ScrollbarButton:"scrollbar-button",ScrollbarTrack:"scrollbar-track",ScrollbarTrackPiece:"scrollbar-track-piece",ScrollbarCorner:"scrollbar-corner",Resizer:"resizer"});InspectorBackend.registerEnum("CSS.CSSPropertyStatus",{Active:"active",Inactive:"inactive",Disabled:"disabled",Style:"style"});InspectorBackend.registerEnum("CSS.CSSMediaSource",{MediaRule:"mediaRule",ImportRule:"importRule",LinkedSheet:"linkedSheet",InlineSheet:"inlineSheet"});InspectorBackend.registerEvent("CSS.mediaQueryResultChanged",[]);InspectorBackend.registerEvent("CSS.styleSheetChanged",["styleSheetId"]);InspectorBackend.registerEvent("CSS.styleSheetAdded",["header"]);InspectorBackend.registerEvent("CSS.styleSheetRemoved",["styleSheetId"]);InspectorBackend.registerCommand("CSS.enable",[],[]);InspectorBackend.registerCommand("CSS.disable",[],[]);InspectorBackend.registerCommand("CSS.getMatchedStylesForNode",[{name:"nodeId",type:"number",optional:!1},{name:"includePseudo",type:"boolean",optional:!0},{name:"includeInherited",type:"boolean",optional:!0}],["matchedCSSRules","pseudoElements","inherited"]);InspectorBackend.registerCommand("CSS.getInlineStylesForNode",[{name:"nodeId",type:"number",optional:!1}],["inlineStyle","attributesStyle"]);InspectorBackend.registerCommand("CSS.getComputedStyleForNode",[{name:"nodeId",type:"number",optional:!1}],["computedStyle"]);InspectorBackend.registerCommand("CSS.getAllStyleSheets",[],["headers"]);InspectorBackend.registerCommand("CSS.getStyleSheet",[{name:"styleSheetId",type:"string",optional:!1}],["styleSheet"]);InspectorBackend.registerCommand("CSS.getStyleSheetText",[{name:"styleSheetId",type:"string",optional:!1}],["text"]);InspectorBackend.registerCommand("CSS.setStyleSheetText",[{name:"styleSheetId",type:"string",optional:!1},{name:"text",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("CSS.setStyleText",[{name:"styleId",type:"object",optional:!1},{name:"text",type:"string",optional:!1}],["style"]);InspectorBackend.registerCommand("CSS.setRuleSelector",[{name:"ruleId",type:"object",optional:!1},{name:"selector",type:"string",optional:!1}],["rule"]);InspectorBackend.registerCommand("CSS.createStyleSheet",[{name:"frameId",type:"string",optional:!1}],["styleSheetId"]);InspectorBackend.registerCommand("CSS.addRule",[{name:"styleSheetId",type:"string",optional:!1},{name:"selector",type:"string",optional:!1}],["rule"]);InspectorBackend.registerCommand("CSS.getSupportedCSSProperties",[],["cssProperties"]);InspectorBackend.registerCommand("CSS.getSupportedSystemFontFamilyNames",[],["fontFamilyNames"]);InspectorBackend.registerCommand("CSS.forcePseudoState",[{name:"nodeId",type:"number",optional:!1},{name:"forcedPseudoClasses",type:"object",optional:!1}],[]);InspectorBackend.activateDomain("CSS",["web"]);InspectorBackend.registerCanvasDispatcher=InspectorBackend.registerDomainDispatcher.bind(InspectorBackend,"Canvas");InspectorBackend.registerEnum("Canvas.ContextType",{Canvas2D:"canvas-2d",BitmapRenderer:"bitmaprenderer",WebGL:"webgl",WebGL2:"webgl2",WebGPU:"webgpu"});InspectorBackend.registerEnum("Canvas.ShaderType",{Fragment:"fragment",Vertex:"vertex"});InspectorBackend.registerEvent("Canvas.canvasAdded",["canvas"]);InspectorBackend.registerEvent("Canvas.canvasRemoved",["canvasId"]);InspectorBackend.registerEvent("Canvas.canvasMemoryChanged",["canvasId","memoryCost"]);InspectorBackend.registerEvent("Canvas.extensionEnabled",["canvasId","extension"]);InspectorBackend.registerEvent("Canvas.cssCanvasClientNodesChanged",["canvasId"]);InspectorBackend.registerEvent("Canvas.recordingStarted",["canvasId","initiator"]);InspectorBackend.registerEvent("Canvas.recordingProgress",["canvasId","frames","bufferUsed"]);InspectorBackend.registerEvent("Canvas.recordingFinished",["canvasId","recording"]);InspectorBackend.registerEvent("Canvas.programCreated",["canvasId","programId"]);InspectorBackend.registerEvent("Canvas.programDeleted",["programId"]);InspectorBackend.registerCommand("Canvas.enable",[],[]);InspectorBackend.registerCommand("Canvas.disable",[],[]);InspectorBackend.registerCommand("Canvas.requestNode",[{name:"canvasId",type:"string",optional:!1}],["nodeId"]);InspectorBackend.registerCommand("Canvas.requestContent",[{name:"canvasId",type:"string",optional:!1}],["content"]);InspectorBackend.registerCommand("Canvas.requestCSSCanvasClientNodes",[{name:"canvasId",type:"string",optional:!1}],["clientNodeIds"]);InspectorBackend.registerCommand("Canvas.resolveCanvasContext",[{name:"canvasId",type:"string",optional:!1},{name:"objectGroup",type:"string",optional:!0}],["object"]);InspectorBackend.registerCommand("Canvas.setRecordingAutoCaptureFrameCount",[{name:"count",type:"number",optional:!1}],[]);InspectorBackend.registerCommand("Canvas.startRecording",[{name:"canvasId",type:"string",optional:!1},{name:"frameCount",type:"number",optional:!0},{name:"memoryLimit",type:"number",optional:!0}],[]);InspectorBackend.registerCommand("Canvas.stopRecording",[{name:"canvasId",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("Canvas.requestShaderSource",[{name:"programId",type:"string",optional:!1},{name:"shaderType",type:"string",optional:!1}],["content"]);InspectorBackend.registerCommand("Canvas.updateShader",[{name:"programId",type:"string",optional:!1},{name:"shaderType",type:"string",optional:!1},{name:"source",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("Canvas.setShaderProgramDisabled",[{name:"programId",type:"string",optional:!1},{name:"disabled",type:"boolean",optional:!1}],[]);InspectorBackend.registerCommand("Canvas.setShaderProgramHighlighted",[{name:"programId",type:"string",optional:!1},{name:"highlighted",type:"boolean",optional:!1}],[]);InspectorBackend.activateDomain("Canvas",["web"]);InspectorBackend.registerConsoleDispatcher=InspectorBackend.registerDomainDispatcher.bind(InspectorBackend,"Console");InspectorBackend.registerEnum("Console.ChannelSource",{XML:"xml",JavaScript:"javascript",Network:"network",ConsoleAPI:"console-api",Storage:"storage",Appcache:"appcache",Rendering:"rendering",CSS:"css",Security:"security",ContentBlocker:"content-blocker",Media:"media",MediaSource:"mediasource",WebRTC:"webrtc",Other:"other"});InspectorBackend.registerEnum("Console.ChannelLevel",{Off:"off",Basic:"basic",Verbose:"verbose"});InspectorBackend.registerEnum("Console.ConsoleMessageLevel",{Log:"log",Info:"info",Warning:"warning",Error:"error",Debug:"debug"});InspectorBackend.registerEnum("Console.ConsoleMessageType",{Log:"log",Dir:"dir",DirXML:"dirxml",Table:"table",Trace:"trace",Clear:"clear",StartGroup:"startGroup",StartGroupCollapsed:"startGroupCollapsed",EndGroup:"endGroup",Assert:"assert",Timing:"timing",Profile:"profile",ProfileEnd:"profileEnd",Image:"image"});InspectorBackend.registerEvent("Console.messageAdded",["message"]);InspectorBackend.registerEvent("Console.messageRepeatCountUpdated",["count"]);InspectorBackend.registerEvent("Console.messagesCleared",[]);InspectorBackend.registerEvent("Console.heapSnapshot",["timestamp","snapshotData","title"]);InspectorBackend.registerCommand("Console.enable",[],[]);InspectorBackend.registerCommand("Console.disable",[],[]);InspectorBackend.registerCommand("Console.clearMessages",[],[]);InspectorBackend.registerCommand("Console.getLoggingChannels",[],["channels"]);InspectorBackend.registerCommand("Console.setLoggingChannelLevel",[{name:"source",type:"string",optional:!1},{name:"level",type:"string",optional:!1}],[]);InspectorBackend.activateDomain("Console");InspectorBackend.registerDOMDispatcher=InspectorBackend.registerDomainDispatcher.bind(InspectorBackend,"DOM");InspectorBackend.registerEnum("DOM.PseudoType",{Before:"before",After:"after"});InspectorBackend.registerEnum("DOM.ShadowRootType",{UserAgent:"user-agent",Open:"open",Closed:"closed"});InspectorBackend.registerEnum("DOM.CustomElementState",{Builtin:"builtin",Custom:"custom",Waiting:"waiting",Failed:"failed"});InspectorBackend.registerEnum("DOM.LiveRegionRelevant",{Additions:"additions",Removals:"removals",Text:"text"});InspectorBackend.registerEnum("DOM.AccessibilityPropertiesChecked",{True:"true",False:"false",Mixed:"mixed"});InspectorBackend.registerEnum("DOM.AccessibilityPropertiesCurrent",{True:"true",False:"false",Page:"page",Step:"step",Location:"location",Date:"date",Time:"time"});InspectorBackend.registerEnum("DOM.AccessibilityPropertiesInvalid",{True:"true",False:"false",Grammar:"grammar",Spelling:"spelling"});InspectorBackend.registerEnum("DOM.AccessibilityPropertiesLiveRegionStatus",{Assertive:"assertive",Polite:"polite",Off:"off"});InspectorBackend.registerEvent("DOM.documentUpdated",[]);InspectorBackend.registerEvent("DOM.inspect",["nodeId"]);InspectorBackend.registerEvent("DOM.setChildNodes",["parentId","nodes"]);InspectorBackend.registerEvent("DOM.attributeModified",["nodeId","name","value"]);InspectorBackend.registerEvent("DOM.attributeRemoved",["nodeId","name"]);InspectorBackend.registerEvent("DOM.inlineStyleInvalidated",["nodeIds"]);InspectorBackend.registerEvent("DOM.characterDataModified",["nodeId","characterData"]);InspectorBackend.registerEvent("DOM.childNodeCountUpdated",["nodeId","childNodeCount"]);InspectorBackend.registerEvent("DOM.childNodeInserted",["parentNodeId","previousNodeId","node"]);InspectorBackend.registerEvent("DOM.childNodeRemoved",["parentNodeId","nodeId"]);InspectorBackend.registerEvent("DOM.shadowRootPushed",["hostId","root"]);InspectorBackend.registerEvent("DOM.shadowRootPopped",["hostId","rootId"]);InspectorBackend.registerEvent("DOM.customElementStateChanged",["nodeId","customElementState"]);InspectorBackend.registerEvent("DOM.pseudoElementAdded",["parentId","pseudoElement"]);InspectorBackend.registerEvent("DOM.pseudoElementRemoved",["parentId","pseudoElementId"]);InspectorBackend.registerEvent("DOM.didAddEventListener",["nodeId"]);InspectorBackend.registerEvent("DOM.willRemoveEventListener",["nodeId"]);InspectorBackend.registerEvent("DOM.didFireEvent",["nodeId","eventName","timestamp","data"]);InspectorBackend.registerEvent("DOM.powerEfficientPlaybackStateChanged",["nodeId","timestamp","isPowerEfficient"]);InspectorBackend.registerCommand("DOM.getDocument",[],["root"]);InspectorBackend.registerCommand("DOM.requestChildNodes",[{name:"nodeId",type:"number",optional:!1},{name:"depth",type:"number",optional:!0}],[]);InspectorBackend.registerCommand("DOM.querySelector",[{name:"nodeId",type:"number",optional:!1},{name:"selector",type:"string",optional:!1}],["nodeId"]);InspectorBackend.registerCommand("DOM.querySelectorAll",[{name:"nodeId",type:"number",optional:!1},{name:"selector",type:"string",optional:!1}],["nodeIds"]);InspectorBackend.registerCommand("DOM.setNodeName",[{name:"nodeId",type:"number",optional:!1},{name:"name",type:"string",optional:!1}],["nodeId"]);InspectorBackend.registerCommand("DOM.setNodeValue",[{name:"nodeId",type:"number",optional:!1},{name:"value",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("DOM.removeNode",[{name:"nodeId",type:"number",optional:!1}],[]);InspectorBackend.registerCommand("DOM.setAttributeValue",[{name:"nodeId",type:"number",optional:!1},{name:"name",type:"string",optional:!1},{name:"value",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("DOM.setAttributesAsText",[{name:"nodeId",type:"number",optional:!1},{name:"text",type:"string",optional:!1},{name:"name",type:"string",optional:!0}],[]);InspectorBackend.registerCommand("DOM.removeAttribute",[{name:"nodeId",type:"number",optional:!1},{name:"name",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("DOM.getSupportedEventNames",[],["eventNames"]);InspectorBackend.registerCommand("DOM.getDataBindingsForNode",[{name:"nodeId",type:"number",optional:!1}],["dataBindings"]);InspectorBackend.registerCommand("DOM.getAssociatedDataForNode",[{name:"nodeId",type:"number",optional:!1}],["associatedData"]);InspectorBackend.registerCommand("DOM.getEventListenersForNode",[{name:"nodeId",type:"number",optional:!1}],["listeners"]);InspectorBackend.registerCommand("DOM.setEventListenerDisabled",[{name:"eventListenerId",type:"number",optional:!1},{name:"disabled",type:"boolean",optional:!1}],[]);InspectorBackend.registerCommand("DOM.setBreakpointForEventListener",[{name:"eventListenerId",type:"number",optional:!1}],[]);InspectorBackend.registerCommand("DOM.removeBreakpointForEventListener",[{name:"eventListenerId",type:"number",optional:!1}],[]);InspectorBackend.registerCommand("DOM.getAccessibilityPropertiesForNode",[{name:"nodeId",type:"number",optional:!1}],["properties"]);InspectorBackend.registerCommand("DOM.getOuterHTML",[{name:"nodeId",type:"number",optional:!1}],["outerHTML"]);InspectorBackend.registerCommand("DOM.setOuterHTML",[{name:"nodeId",type:"number",optional:!1},{name:"outerHTML",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("DOM.insertAdjacentHTML",[{name:"nodeId",type:"number",optional:!1},{name:"position",type:"string",optional:!1},{name:"html",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("DOM.performSearch",[{name:"query",type:"string",optional:!1},{name:"nodeIds",type:"object",optional:!0},{name:"caseSensitive",type:"boolean",optional:!0}],["searchId","resultCount"]);InspectorBackend.registerCommand("DOM.getSearchResults",[{name:"searchId",type:"string",optional:!1},{name:"fromIndex",type:"number",optional:!1},{name:"toIndex",type:"number",optional:!1}],["nodeIds"]);InspectorBackend.registerCommand("DOM.discardSearchResults",[{name:"searchId",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("DOM.requestNode",[{name:"objectId",type:"string",optional:!1}],["nodeId"]);InspectorBackend.registerCommand("DOM.setInspectModeEnabled",[{name:"enabled",type:"boolean",optional:!1},{name:"highlightConfig",type:"object",optional:!0},{name:"showRulers",type:"boolean",optional:!0}],[]);InspectorBackend.registerCommand("DOM.highlightRect",[{name:"x",type:"number",optional:!1},{name:"y",type:"number",optional:!1},{name:"width",type:"number",optional:!1},{name:"height",type:"number",optional:!1},{name:"color",type:"object",optional:!0},{name:"outlineColor",type:"object",optional:!0},{name:"usePageCoordinates",type:"boolean",optional:!0}],[]);InspectorBackend.registerCommand("DOM.highlightQuad",[{name:"quad",type:"object",optional:!1},{name:"color",type:"object",optional:!0},{name:"outlineColor",type:"object",optional:!0},{name:"usePageCoordinates",type:"boolean",optional:!0}],[]);InspectorBackend.registerCommand("DOM.highlightSelector",[{name:"highlightConfig",type:"object",optional:!1},{name:"selectorString",type:"string",optional:!1},{name:"frameId",type:"string",optional:!0}],[]);InspectorBackend.registerCommand("DOM.highlightNode",[{name:"highlightConfig",type:"object",optional:!1},{name:"nodeId",type:"number",optional:!0},{name:"objectId",type:"string",optional:!0}],[]);InspectorBackend.registerCommand("DOM.highlightNodeList",[{name:"nodeIds",type:"object",optional:!1},{name:"highlightConfig",type:"object",optional:!1}],[]);InspectorBackend.registerCommand("DOM.hideHighlight",[],[]);InspectorBackend.registerCommand("DOM.highlightFrame",[{name:"frameId",type:"string",optional:!1},{name:"contentColor",type:"object",optional:!0},{name:"contentOutlineColor",type:"object",optional:!0}],[]);InspectorBackend.registerCommand("DOM.pushNodeByPathToFrontend",[{name:"path",type:"string",optional:!1}],["nodeId"]);InspectorBackend.registerCommand("DOM.resolveNode",[{name:"nodeId",type:"number",optional:!1},{name:"objectGroup",type:"string",optional:!0}],["object"]);InspectorBackend.registerCommand("DOM.getAttributes",[{name:"nodeId",type:"number",optional:!1}],["attributes"]);InspectorBackend.registerCommand("DOM.moveTo",[{name:"nodeId",type:"number",optional:!1},{name:"targetNodeId",type:"number",optional:!1},{name:"insertBeforeNodeId",type:"number",optional:!0}],["nodeId"]);InspectorBackend.registerCommand("DOM.undo",[],[]);InspectorBackend.registerCommand("DOM.redo",[],[]);InspectorBackend.registerCommand("DOM.markUndoableState",[],[]);InspectorBackend.registerCommand("DOM.focus",[{name:"nodeId",type:"number",optional:!1}],[]);InspectorBackend.registerCommand("DOM.setInspectedNode",[{name:"nodeId",type:"number",optional:!1}],[]);InspectorBackend.activateDomain("DOM",["web"]);InspectorBackend.registerEnum("DOMDebugger.DOMBreakpointType",{SubtreeModified:"subtree-modified",AttributeModified:"attribute-modified",NodeRemoved:"node-removed"});InspectorBackend.registerEnum("DOMDebugger.EventBreakpointType",{AnimationFrame:"animation-frame",Listener:"listener",Timer:"timer"});InspectorBackend.registerCommand("DOMDebugger.setDOMBreakpoint",[{name:"nodeId",type:"number",optional:!1},{name:"type",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("DOMDebugger.removeDOMBreakpoint",[{name:"nodeId",type:"number",optional:!1},{name:"type",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("DOMDebugger.setEventBreakpoint",[{name:"breakpointType",type:"string",optional:!1},{name:"eventName",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("DOMDebugger.removeEventBreakpoint",[{name:"breakpointType",type:"string",optional:!1},{name:"eventName",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("DOMDebugger.setURLBreakpoint",[{name:"url",type:"string",optional:!1},{name:"isRegex",type:"boolean",optional:!0}],[]);InspectorBackend.registerCommand("DOMDebugger.removeURLBreakpoint",[{name:"url",type:"string",optional:!1}],[]);InspectorBackend.activateDomain("DOMDebugger",["web"]);InspectorBackend.registerDOMStorageDispatcher=InspectorBackend.registerDomainDispatcher.bind(InspectorBackend,"DOMStorage");InspectorBackend.registerEvent("DOMStorage.domStorageItemsCleared",["storageId"]);InspectorBackend.registerEvent("DOMStorage.domStorageItemRemoved",["storageId","key"]);InspectorBackend.registerEvent("DOMStorage.domStorageItemAdded",["storageId","key","newValue"]);InspectorBackend.registerEvent("DOMStorage.domStorageItemUpdated",["storageId","key","oldValue","newValue"]);InspectorBackend.registerCommand("DOMStorage.enable",[],[]);InspectorBackend.registerCommand("DOMStorage.disable",[],[]);InspectorBackend.registerCommand("DOMStorage.getDOMStorageItems",[{name:"storageId",type:"object",optional:!1}],["entries"]);InspectorBackend.registerCommand("DOMStorage.setDOMStorageItem",[{name:"storageId",type:"object",optional:!1},{name:"key",type:"string",optional:!1},{name:"value",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("DOMStorage.removeDOMStorageItem",[{name:"storageId",type:"object",optional:!1},{name:"key",type:"string",optional:!1}],[]);InspectorBackend.activateDomain("DOMStorage",["web"]);InspectorBackend.registerDatabaseDispatcher=InspectorBackend.registerDomainDispatcher.bind(InspectorBackend,"Database");InspectorBackend.registerEvent("Database.addDatabase",["database"]);InspectorBackend.registerCommand("Database.enable",[],[]);InspectorBackend.registerCommand("Database.disable",[],[]);InspectorBackend.registerCommand("Database.getDatabaseTableNames",[{name:"databaseId",type:"string",optional:!1}],["tableNames"]);InspectorBackend.registerCommand("Database.executeSQL",[{name:"databaseId",type:"string",optional:!1},{name:"query",type:"string",optional:!1}],["columnNames","values","sqlError"]);InspectorBackend.activateDomain("Database",["web"]);InspectorBackend.registerDebuggerDispatcher=InspectorBackend.registerDomainDispatcher.bind(InspectorBackend,"Debugger");InspectorBackend.registerEnum("Debugger.BreakpointActionType",{Log:"log",Evaluate:"evaluate",Sound:"sound",Probe:"probe"});InspectorBackend.registerEnum("Debugger.ScopeType",{Global:"global",With:"with",Closure:"closure",Catch:"catch",FunctionName:"functionName",GlobalLexicalEnvironment:"globalLexicalEnvironment",NestedLexical:"nestedLexical"});InspectorBackend.registerEvent("Debugger.globalObjectCleared",[]);InspectorBackend.registerEvent("Debugger.scriptParsed",["scriptId","url","startLine","startColumn","endLine","endColumn","isContentScript","sourceURL","sourceMapURL","module"]);InspectorBackend.registerEvent("Debugger.scriptFailedToParse",["url","scriptSource","startLine","errorLine","errorMessage"]);InspectorBackend.registerEvent("Debugger.breakpointResolved",["breakpointId","location"]);InspectorBackend.registerEnum("Debugger.PausedReason",{XHR:"XHR",Fetch:"Fetch",DOM:"DOM",AnimationFrame:"AnimationFrame",EventListener:"EventListener",Timer:"Timer",Exception:"exception",Assert:"assert",CSPViolation:"CSPViolation",DebuggerStatement:"DebuggerStatement",Breakpoint:"Breakpoint",PauseOnNextStatement:"PauseOnNextStatement",Other:"other"});InspectorBackend.registerEvent("Debugger.paused",["callFrames","reason","data","asyncStackTrace"]);InspectorBackend.registerEvent("Debugger.resumed",[]);InspectorBackend.registerEvent("Debugger.didSampleProbe",["sample"]);InspectorBackend.registerEvent("Debugger.playBreakpointActionSound",["breakpointActionId"]);InspectorBackend.registerCommand("Debugger.enable",[],[]);InspectorBackend.registerCommand("Debugger.disable",[],[]);InspectorBackend.registerCommand("Debugger.setAsyncStackTraceDepth",[{name:"depth",type:"number",optional:!1}],[]);InspectorBackend.registerCommand("Debugger.setBreakpointsActive",[{name:"active",type:"boolean",optional:!1}],[]);InspectorBackend.registerCommand("Debugger.setBreakpointByUrl",[{name:"lineNumber",type:"number",optional:!1},{name:"url",type:"string",optional:!0},{name:"urlRegex",type:"string",optional:!0},{name:"columnNumber",type:"number",optional:!0},{name:"options",type:"object",optional:!0}],["breakpointId","locations"]);InspectorBackend.registerCommand("Debugger.setBreakpoint",[{name:"location",type:"object",optional:!1},{name:"options",type:"object",optional:!0}],["breakpointId","actualLocation"]);InspectorBackend.registerCommand("Debugger.removeBreakpoint",[{name:"breakpointId",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("Debugger.continueUntilNextRunLoop",[],[]);InspectorBackend.registerCommand("Debugger.continueToLocation",[{name:"location",type:"object",optional:!1}],[]);InspectorBackend.registerCommand("Debugger.stepOver",[],[]);InspectorBackend.registerCommand("Debugger.stepInto",[],[]);InspectorBackend.registerCommand("Debugger.stepOut",[],[]);InspectorBackend.registerCommand("Debugger.pause",[],[]);InspectorBackend.registerCommand("Debugger.resume",[],[]);InspectorBackend.registerCommand("Debugger.searchInContent",[{name:"scriptId",type:"string",optional:!1},{name:"query",type:"string",optional:!1},{name:"caseSensitive",type:"boolean",optional:!0},{name:"isRegex",type:"boolean",optional:!0}],["result"]);InspectorBackend.registerCommand("Debugger.getScriptSource",[{name:"scriptId",type:"string",optional:!1}],["scriptSource"]);InspectorBackend.registerCommand("Debugger.getFunctionDetails",[{name:"functionId",type:"string",optional:!1}],["details"]);InspectorBackend.registerCommand("Debugger.setPauseOnExceptions",[{name:"state",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("Debugger.setPauseOnAssertions",[{name:"enabled",type:"boolean",optional:!1}],[]);InspectorBackend.registerCommand("Debugger.setPauseForInternalScripts",[{name:"shouldPause",type:"boolean",optional:!1}],[]);InspectorBackend.registerCommand("Debugger.evaluateOnCallFrame",[{name:"callFrameId",type:"string",optional:!1},{name:"expression",type:"string",optional:!1},{name:"objectGroup",type:"string",optional:!0},{name:"includeCommandLineAPI",type:"boolean",optional:!0},{name:"doNotPauseOnExceptionsAndMuteConsole",type:"boolean",optional:!0},{name:"returnByValue",type:"boolean",optional:!0},{name:"generatePreview",type:"boolean",optional:!0},{name:"saveResult",type:"boolean",optional:!0}],["result","wasThrown","savedResultIndex"]);InspectorBackend.activateDomain("Debugger");InspectorBackend.registerHeapDispatcher=InspectorBackend.registerDomainDispatcher.bind(InspectorBackend,"Heap");InspectorBackend.registerEnum("Heap.GarbageCollectionType",{Full:"full",Partial:"partial"});InspectorBackend.registerEvent("Heap.garbageCollected",["collection"]);InspectorBackend.registerEvent("Heap.trackingStart",["timestamp","snapshotData"]);InspectorBackend.registerEvent("Heap.trackingComplete",["timestamp","snapshotData"]);InspectorBackend.registerCommand("Heap.enable",[],[]);InspectorBackend.registerCommand("Heap.disable",[],[]);InspectorBackend.registerCommand("Heap.gc",[],[]);InspectorBackend.registerCommand("Heap.snapshot",[],["timestamp","snapshotData"]);InspectorBackend.registerCommand("Heap.startTracking",[],[]);InspectorBackend.registerCommand("Heap.stopTracking",[],[]);InspectorBackend.registerCommand("Heap.getPreview",[{name:"heapObjectId",type:"number",optional:!1}],["string","functionDetails","preview"]);InspectorBackend.registerCommand("Heap.getRemoteObject",[{name:"heapObjectId",type:"number",optional:!1},{name:"objectGroup",type:"string",optional:!0}],["result"]);InspectorBackend.activateDomain("Heap");InspectorBackend.registerIndexedDBDispatcher=InspectorBackend.registerDomainDispatcher.bind(InspectorBackend,"IndexedDB");InspectorBackend.registerEnum("IndexedDB.KeyType",{Number:"number",String:"string",Date:"date",Array:"array"});InspectorBackend.registerEnum("IndexedDB.KeyPathType",{Null:"null",String:"string",Array:"array"});InspectorBackend.registerCommand("IndexedDB.enable",[],[]);InspectorBackend.registerCommand("IndexedDB.disable",[],[]);InspectorBackend.registerCommand("IndexedDB.requestDatabaseNames",[{name:"securityOrigin",type:"string",optional:!1}],["databaseNames"]);InspectorBackend.registerCommand("IndexedDB.requestDatabase",[{name:"securityOrigin",type:"string",optional:!1},{name:"databaseName",type:"string",optional:!1}],["databaseWithObjectStores"]);InspectorBackend.registerCommand("IndexedDB.requestData",[{name:"securityOrigin",type:"string",optional:!1},{name:"databaseName",type:"string",optional:!1},{name:"objectStoreName",type:"string",optional:!1},{name:"indexName",type:"string",optional:!1},{name:"skipCount",type:"number",optional:!1},{name:"pageSize",type:"number",optional:!1},{name:"keyRange",type:"object",optional:!0}],["objectStoreDataEntries","hasMore"]);InspectorBackend.registerCommand("IndexedDB.clearObjectStore",[{name:"securityOrigin",type:"string",optional:!1},{name:"databaseName",type:"string",optional:!1},{name:"objectStoreName",type:"string",optional:!1}],[]);InspectorBackend.activateDomain("IndexedDB",["web"]);InspectorBackend.registerInspectorDispatcher=InspectorBackend.registerDomainDispatcher.bind(InspectorBackend,"Inspector");InspectorBackend.registerEvent("Inspector.evaluateForTestInFrontend",["script"]);InspectorBackend.registerEvent("Inspector.inspect",["object","hints"]);InspectorBackend.registerEvent("Inspector.activateExtraDomains",["domains"]);InspectorBackend.registerCommand("Inspector.enable",[],[]);InspectorBackend.registerCommand("Inspector.disable",[],[]);InspectorBackend.registerCommand("Inspector.initialized",[],[]);InspectorBackend.activateDomain("Inspector",["javascript","web"]);InspectorBackend.registerLayerTreeDispatcher=InspectorBackend.registerDomainDispatcher.bind(InspectorBackend,"LayerTree");InspectorBackend.registerEvent("LayerTree.layerTreeDidChange",[]);InspectorBackend.registerCommand("LayerTree.enable",[],[]);InspectorBackend.registerCommand("LayerTree.disable",[],[]);InspectorBackend.registerCommand("LayerTree.layersForNode",[{name:"nodeId",type:"number",optional:!1}],["layers"]);InspectorBackend.registerCommand("LayerTree.reasonsForCompositingLayer",[{name:"layerId",type:"string",optional:!1}],["compositingReasons"]);InspectorBackend.activateDomain("LayerTree",["web"]);InspectorBackend.registerMemoryDispatcher=InspectorBackend.registerDomainDispatcher.bind(InspectorBackend,"Memory");InspectorBackend.registerEnum("Memory.CategoryDataType",{JavaScript:"javascript",JIT:"jit",Images:"images",Layers:"layers",Page:"page",Other:"other"});InspectorBackend.registerEnum("Memory.MemoryPressureSeverity",{Critical:"critical",NonCritical:"non-critical"});InspectorBackend.registerEvent("Memory.memoryPressure",["timestamp","severity"]);InspectorBackend.registerEvent("Memory.trackingStart",["timestamp"]);InspectorBackend.registerEvent("Memory.trackingUpdate",["event"]);InspectorBackend.registerEvent("Memory.trackingComplete",["timestamp"]);InspectorBackend.registerCommand("Memory.enable",[],[]);InspectorBackend.registerCommand("Memory.disable",[],[]);InspectorBackend.registerCommand("Memory.startTracking",[],[]);InspectorBackend.registerCommand("Memory.stopTracking",[],[]);InspectorBackend.activateDomain("Memory",["web"]);InspectorBackend.registerNetworkDispatcher=InspectorBackend.registerDomainDispatcher.bind(InspectorBackend,"Network");InspectorBackend.registerEnum("Network.ResponseSource",{Unknown:"unknown",Network:"network",MemoryCache:"memory-cache",DiskCache:"disk-cache",ServiceWorker:"service-worker"});InspectorBackend.registerEnum("Network.MetricsPriority",{Low:"low",Medium:"medium",High:"high"});InspectorBackend.registerEnum("Network.InitiatorType",{Parser:"parser",Script:"script",Other:"other"});InspectorBackend.registerEvent("Network.requestWillBeSent",["requestId","frameId","loaderId","documentURL","request","timestamp","walltime","initiator","redirectResponse","type","targetId"]);InspectorBackend.registerEvent("Network.responseReceived",["requestId","frameId","loaderId","timestamp","type","response"]);InspectorBackend.registerEvent("Network.dataReceived",["requestId","timestamp","dataLength","encodedDataLength"]);InspectorBackend.registerEvent("Network.loadingFinished",["requestId","timestamp","sourceMapURL","metrics"]);InspectorBackend.registerEvent("Network.loadingFailed",["requestId","timestamp","errorText","canceled"]);InspectorBackend.registerEvent("Network.requestServedFromMemoryCache",["requestId","frameId","loaderId","documentURL","timestamp","initiator","resource"]);InspectorBackend.registerEvent("Network.webSocketWillSendHandshakeRequest",["requestId","timestamp","walltime","request"]);InspectorBackend.registerEvent("Network.webSocketHandshakeResponseReceived",["requestId","timestamp","response"]);InspectorBackend.registerEvent("Network.webSocketCreated",["requestId","url"]);InspectorBackend.registerEvent("Network.webSocketClosed",["requestId","timestamp"]);InspectorBackend.registerEvent("Network.webSocketFrameReceived",["requestId","timestamp","response"]);InspectorBackend.registerEvent("Network.webSocketFrameError",["requestId","timestamp","errorMessage"]);InspectorBackend.registerEvent("Network.webSocketFrameSent",["requestId","timestamp","response"]);InspectorBackend.registerCommand("Network.enable",[],[]);InspectorBackend.registerCommand("Network.disable",[],[]);InspectorBackend.registerCommand("Network.setExtraHTTPHeaders",[{name:"headers",type:"object",optional:!1}],[]);InspectorBackend.registerCommand("Network.getResponseBody",[{name:"requestId",type:"string",optional:!1}],["body","base64Encoded"]);InspectorBackend.registerCommand("Network.setResourceCachingDisabled",[{name:"disabled",type:"boolean",optional:!1}],[]);InspectorBackend.registerCommand("Network.loadResource",[{name:"frameId",type:"string",optional:!1},{name:"url",type:"string",optional:!1}],["content","mimeType","status"]);InspectorBackend.registerCommand("Network.getSerializedCertificate",[{name:"requestId",type:"string",optional:!1}],["serializedCertificate"]);InspectorBackend.registerCommand("Network.resolveWebSocket",[{name:"requestId",type:"string",optional:!1},{name:"objectGroup",type:"string",optional:!0}],["object"]);InspectorBackend.activateDomain("Network",["web","service-worker"]);InspectorBackend.registerPageDispatcher=InspectorBackend.registerDomainDispatcher.bind(InspectorBackend,"Page");InspectorBackend.registerEnum("Page.Setting",{AuthorAndUserStylesEnabled:"AuthorAndUserStylesEnabled",ICECandidateFilteringEnabled:"ICECandidateFilteringEnabled",ImagesEnabled:"ImagesEnabled",MediaCaptureRequiresSecureConnection:"MediaCaptureRequiresSecureConnection",MockCaptureDevicesEnabled:"MockCaptureDevicesEnabled",NeedsSiteSpecificQuirks:"NeedsSiteSpecificQuirks",ScriptEnabled:"ScriptEnabled",WebSecurityEnabled:"WebSecurityEnabled"});InspectorBackend.registerEnum("Page.ResourceType",{Document:"Document",Stylesheet:"Stylesheet",Image:"Image",Font:"Font",Script:"Script",XHR:"XHR",Fetch:"Fetch",Ping:"Ping",Beacon:"Beacon",WebSocket:"WebSocket",Other:"Other"});InspectorBackend.registerEnum("Page.CoordinateSystem",{Viewport:"Viewport",Page:"Page"});InspectorBackend.registerEnum("Page.CookieSameSitePolicy",{None:"None",Lax:"Lax",Strict:"Strict"});InspectorBackend.registerEnum("Page.Appearance",{Light:"Light",Dark:"Dark"});InspectorBackend.registerEvent("Page.domContentEventFired",["timestamp"]);InspectorBackend.registerEvent("Page.loadEventFired",["timestamp"]);InspectorBackend.registerEvent("Page.frameNavigated",["frame"]);InspectorBackend.registerEvent("Page.frameDetached",["frameId"]);InspectorBackend.registerEvent("Page.frameStartedLoading",["frameId"]);InspectorBackend.registerEvent("Page.frameStoppedLoading",["frameId"]);InspectorBackend.registerEvent("Page.frameScheduledNavigation",["frameId","delay"]);InspectorBackend.registerEvent("Page.frameClearedScheduledNavigation",["frameId"]);InspectorBackend.registerEvent("Page.defaultAppearanceDidChange",["appearance"]);InspectorBackend.registerCommand("Page.enable",[],[]);InspectorBackend.registerCommand("Page.disable",[],[]);InspectorBackend.registerCommand("Page.reload",[{name:"ignoreCache",type:"boolean",optional:!0},{name:"revalidateAllResources",type:"boolean",optional:!0}],[]);InspectorBackend.registerCommand("Page.navigate",[{name:"url",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("Page.overrideUserAgent",[{name:"value",type:"string",optional:!0}],[]);InspectorBackend.registerCommand("Page.overrideSetting",[{name:"setting",type:"string",optional:!1},{name:"value",type:"boolean",optional:!0}],[]);InspectorBackend.registerCommand("Page.getCookies",[],["cookies"]);InspectorBackend.registerCommand("Page.deleteCookie",[{name:"cookieName",type:"string",optional:!1},{name:"url",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("Page.getResourceTree",[],["frameTree"]);InspectorBackend.registerCommand("Page.getResourceContent",[{name:"frameId",type:"string",optional:!1},{name:"url",type:"string",optional:!1}],["content","base64Encoded"]);InspectorBackend.registerCommand("Page.searchInResource",[{name:"frameId",type:"string",optional:!1},{name:"url",type:"string",optional:!1},{name:"query",type:"string",optional:!1},{name:"caseSensitive",type:"boolean",optional:!0},{name:"isRegex",type:"boolean",optional:!0},{name:"requestId",type:"string",optional:!0}],["result"]);InspectorBackend.registerCommand("Page.searchInResources",[{name:"text",type:"string",optional:!1},{name:"caseSensitive",type:"boolean",optional:!0},{name:"isRegex",type:"boolean",optional:!0}],["result"]);InspectorBackend.registerCommand("Page.setShowRulers",[{name:"result",type:"boolean",optional:!1}],[]);InspectorBackend.registerCommand("Page.setShowPaintRects",[{name:"result",type:"boolean",optional:!1}],[]);InspectorBackend.registerCommand("Page.setEmulatedMedia",[{name:"media",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("Page.setForcedAppearance",[{name:"appearance",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("Page.getCompositingBordersVisible",[],["result"]);InspectorBackend.registerCommand("Page.setCompositingBordersVisible",[{name:"visible",type:"boolean",optional:!1}],[]);InspectorBackend.registerCommand("Page.snapshotNode",[{name:"nodeId",type:"number",optional:!1}],["dataURL"]);InspectorBackend.registerCommand("Page.snapshotRect",[{name:"x",type:"number",optional:!1},{name:"y",type:"number",optional:!1},{name:"width",type:"number",optional:!1},{name:"height",type:"number",optional:!1},{name:"coordinateSystem",type:"string",optional:!1}],["dataURL"]);InspectorBackend.registerCommand("Page.archive",[],["data"]);InspectorBackend.activateDomain("Page",["web"]);InspectorBackend.registerVersion("Recording",1);InspectorBackend.registerEnum("Recording.Type",{Canvas2D:"canvas-2d",CanvasBitmapRenderer:"canvas-bitmaprenderer",CanvasWebGL:"canvas-webgl",CanvasWebGL2:"canvas-webgl2"});InspectorBackend.registerEnum("Recording.Initiator",{Frontend:"frontend",Console:"console",AutoCapture:"auto-capture"});InspectorBackend.activateDomain("Recording",["web"]);InspectorBackend.registerRuntimeDispatcher=InspectorBackend.registerDomainDispatcher.bind(InspectorBackend,"Runtime");InspectorBackend.registerEnum("Runtime.RemoteObjectType",{Object:"object",Function:"function",Undefined:"undefined",String:"string",Number:"number",Boolean:"boolean",Symbol:"symbol"});InspectorBackend.registerEnum("Runtime.RemoteObjectSubtype",{Array:"array",Null:"null",Node:"node",Regexp:"regexp",Date:"date",Error:"error",Map:"map",Set:"set",Weakmap:"weakmap",Weakset:"weakset",Iterator:"iterator",Class:"class",Proxy:"proxy"});InspectorBackend.registerEnum("Runtime.ObjectPreviewType",{Object:"object",Function:"function",Undefined:"undefined",String:"string",Number:"number",Boolean:"boolean",Symbol:"symbol"});InspectorBackend.registerEnum("Runtime.ObjectPreviewSubtype",{Array:"array",Null:"null",Node:"node",Regexp:"regexp",Date:"date",Error:"error",Map:"map",Set:"set",Weakmap:"weakmap",Weakset:"weakset",Iterator:"iterator",Class:"class",Proxy:"proxy"});InspectorBackend.registerEnum("Runtime.PropertyPreviewType",{Object:"object",Function:"function",Undefined:"undefined",String:"string",Number:"number",Boolean:"boolean",Symbol:"symbol",Accessor:"accessor"});InspectorBackend.registerEnum("Runtime.PropertyPreviewSubtype",{Array:"array",Null:"null",Node:"node",Regexp:"regexp",Date:"date",Error:"error",Map:"map",Set:"set",Weakmap:"weakmap",Weakset:"weakset",Iterator:"iterator",Class:"class",Proxy:"proxy"});InspectorBackend.registerEnum("Runtime.SyntaxErrorType",{None:"none",Irrecoverable:"irrecoverable",UnterminatedLiteral:"unterminated-literal",Recoverable:"recoverable"});InspectorBackend.registerEvent("Runtime.executionContextCreated",["context"]);InspectorBackend.registerCommand("Runtime.parse",[{name:"source",type:"string",optional:!1}],["result","message","range"]);InspectorBackend.registerCommand("Runtime.evaluate",[{name:"expression",type:"string",optional:!1},{name:"objectGroup",type:"string",optional:!0},{name:"includeCommandLineAPI",type:"boolean",optional:!0},{name:"doNotPauseOnExceptionsAndMuteConsole",type:"boolean",optional:!0},{name:"contextId",type:"number",optional:!0},{name:"returnByValue",type:"boolean",optional:!0},{name:"generatePreview",type:"boolean",optional:!0},{name:"saveResult",type:"boolean",optional:!0},{name:"emulateUserGesture",type:"boolean",optional:!0}],["result","wasThrown","savedResultIndex"]);InspectorBackend.registerCommand("Runtime.awaitPromise",[{name:"promiseObjectId",type:"string",optional:!1},{name:"returnByValue",type:"boolean",optional:!0},{name:"generatePreview",type:"boolean",optional:!0},{name:"saveResult",type:"boolean",optional:!0}],["result","wasThrown","savedResultIndex"]);InspectorBackend.registerCommand("Runtime.callFunctionOn",[{name:"objectId",type:"string",optional:!1},{name:"functionDeclaration",type:"string",optional:!1},{name:"arguments",type:"object",optional:!0},{name:"doNotPauseOnExceptionsAndMuteConsole",type:"boolean",optional:!0},{name:"returnByValue",type:"boolean",optional:!0},{name:"generatePreview",type:"boolean",optional:!0}],["result","wasThrown"]);InspectorBackend.registerCommand("Runtime.getPreview",[{name:"objectId",type:"string",optional:!1}],["preview"]);InspectorBackend.registerCommand("Runtime.getProperties",[{name:"objectId",type:"string",optional:!1},{name:"ownProperties",type:"boolean",optional:!0},{name:"generatePreview",type:"boolean",optional:!0}],["result","internalProperties"]);InspectorBackend.registerCommand("Runtime.getDisplayableProperties",[{name:"objectId",type:"string",optional:!1},{name:"generatePreview",type:"boolean",optional:!0}],["properties","internalProperties"]);InspectorBackend.registerCommand("Runtime.getCollectionEntries",[{name:"objectId",type:"string",optional:!1},{name:"objectGroup",type:"string",optional:!0},{name:"startIndex",type:"number",optional:!0},{name:"numberToFetch",type:"number",optional:!0}],["entries"]);InspectorBackend.registerCommand("Runtime.saveResult",[{name:"value",type:"object",optional:!1},{name:"contextId",type:"number",optional:!0}],["savedResultIndex"]);InspectorBackend.registerCommand("Runtime.releaseObject",[{name:"objectId",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("Runtime.releaseObjectGroup",[{name:"objectGroup",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("Runtime.enable",[],[]);InspectorBackend.registerCommand("Runtime.disable",[],[]);InspectorBackend.registerCommand("Runtime.getRuntimeTypesForVariablesAtOffsets",[{name:"locations",type:"object",optional:!1}],["types"]);InspectorBackend.registerCommand("Runtime.enableTypeProfiler",[],[]);InspectorBackend.registerCommand("Runtime.disableTypeProfiler",[],[]);InspectorBackend.registerCommand("Runtime.enableControlFlowProfiler",[],[]);InspectorBackend.registerCommand("Runtime.disableControlFlowProfiler",[],[]);InspectorBackend.registerCommand("Runtime.getBasicBlocks",[{name:"sourceID",type:"string",optional:!1}],["basicBlocks"]);InspectorBackend.activateDomain("Runtime");InspectorBackend.registerScriptProfilerDispatcher=InspectorBackend.registerDomainDispatcher.bind(InspectorBackend,"ScriptProfiler");InspectorBackend.registerEnum("ScriptProfiler.EventType",{API:"API",Microtask:"Microtask",Other:"Other"});InspectorBackend.registerEvent("ScriptProfiler.trackingStart",["timestamp"]);InspectorBackend.registerEvent("ScriptProfiler.trackingUpdate",["event"]);InspectorBackend.registerEvent("ScriptProfiler.trackingComplete",["timestamp","samples"]);InspectorBackend.registerCommand("ScriptProfiler.startTracking",[{name:"includeSamples",type:"boolean",optional:!0}],[]);InspectorBackend.registerCommand("ScriptProfiler.stopTracking",[],[]);InspectorBackend.activateDomain("ScriptProfiler",["javascript","web"]);InspectorBackend.registerTargetDispatcher=InspectorBackend.registerDomainDispatcher.bind(InspectorBackend,"Target");InspectorBackend.registerEnum("Target.TargetInfoType",{JavaScript:"javascript",Page:"page",Worker:"worker",ServiceWorker:"serviceworker"});InspectorBackend.registerEvent("Target.targetCreated",["targetInfo"]);InspectorBackend.registerEvent("Target.targetDestroyed",["targetId"]);InspectorBackend.registerEvent("Target.dispatchMessageFromTarget",["targetId","message"]);InspectorBackend.registerCommand("Target.exists",[],[]);InspectorBackend.registerCommand("Target.sendMessageToTarget",[{name:"targetId",type:"string",optional:!1},{name:"message",type:"string",optional:!1}],[]);InspectorBackend.activateDomain("Target",["web"]);InspectorBackend.registerTimelineDispatcher=InspectorBackend.registerDomainDispatcher.bind(InspectorBackend,"Timeline");InspectorBackend.registerEnum("Timeline.EventType",{EventDispatch:"EventDispatch",ScheduleStyleRecalculation:"ScheduleStyleRecalculation",RecalculateStyles:"RecalculateStyles",InvalidateLayout:"InvalidateLayout",Layout:"Layout",Paint:"Paint",Composite:"Composite",RenderingFrame:"RenderingFrame",TimerInstall:"TimerInstall",TimerRemove:"TimerRemove",TimerFire:"TimerFire",EvaluateScript:"EvaluateScript",TimeStamp:"TimeStamp",Time:"Time",TimeEnd:"TimeEnd",FunctionCall:"FunctionCall",ProbeSample:"ProbeSample",ConsoleProfile:"ConsoleProfile",RequestAnimationFrame:"RequestAnimationFrame",CancelAnimationFrame:"CancelAnimationFrame",FireAnimationFrame:"FireAnimationFrame",ObserverCallback:"ObserverCallback"});InspectorBackend.registerEnum("Timeline.Instrument",{ScriptProfiler:"ScriptProfiler",Timeline:"Timeline",CPU:"CPU",Memory:"Memory",Heap:"Heap"});InspectorBackend.registerEvent("Timeline.eventRecorded",["record"]);InspectorBackend.registerEvent("Timeline.recordingStarted",["startTime"]);InspectorBackend.registerEvent("Timeline.recordingStopped",["endTime"]);InspectorBackend.registerEvent("Timeline.autoCaptureStarted",[]);InspectorBackend.registerCommand("Timeline.start",[{name:"maxCallStackDepth",type:"number",optional:!0}],[]);InspectorBackend.registerCommand("Timeline.stop",[],[]);InspectorBackend.registerCommand("Timeline.setAutoCaptureEnabled",[{name:"enabled",type:"boolean",optional:!1}],[]);InspectorBackend.registerCommand("Timeline.setInstruments",[{name:"instruments",type:"object",optional:!1}],[]);InspectorBackend.activateDomain("Timeline",["web"]);InspectorBackend.registerWorkerDispatcher=InspectorBackend.registerDomainDispatcher.bind(InspectorBackend,"Worker");InspectorBackend.registerEvent("Worker.workerCreated",["workerId","url"]);InspectorBackend.registerEvent("Worker.workerTerminated",["workerId"]);InspectorBackend.registerEvent("Worker.dispatchMessageFromWorker",["workerId","message"]);InspectorBackend.registerCommand("Worker.enable",[],[]);InspectorBackend.registerCommand("Worker.disable",[],[]);InspectorBackend.registerCommand("Worker.initialized",[{name:"workerId",type:"string",optional:!1}],[]);InspectorBackend.registerCommand("Worker.sendMessageToWorker",[{name:"workerId",type:"string",optional:!1},{name:"message",type:"string",optional:!1}],[]);InspectorBackend.activateDomain("Worker",["web"]);WI._messagesToDispatch=[];WI.dispatchNextQueuedMessageFromBackend=function(){const c=WI._messagesToDispatch.length,e=performance.now(),t=10;let i=0;for(;i<WI._messagesToDispatch.length&&!(performance.now()-e>t);++i)InspectorBackend.dispatch(WI._messagesToDispatch[i]);if(i===WI._messagesToDispatch.length?(WI._messagesToDispatch=[],WI._dispatchTimeout=null):(WI._messagesToDispatch=WI._messagesToDispatch.slice(i),WI._dispatchTimeout=setTimeout(WI.dispatchNextQueuedMessageFromBackend,0)),InspectorBackend.dumpInspectorTimeStats){let n=(performance.now()-e).toFixed(3),s=c-WI._messagesToDispatch.length,a=WI._messagesToDispatch.length;console.log(`time-stats: --- RunLoop duration: ${n}ms; dispatched: ${s}; remaining: ${a}`)}};WI.dispatchMessageFromBackend=function(c){this._messagesToDispatch.push(c),!(window.__uncaughtExceptions&&window.__uncaughtExceptions.length)&&(this._dispatchTimeout||(this._dispatchTimeout=setTimeout(this.dispatchNextQueuedMessageFromBackend,0)))};WI.RemoteObject=class{constructor(e,t,i,n,s,a,d,p,f,_){console.assert(i),console.assert(!_||_ instanceof WI.ObjectPreview),console.assert(!e||e instanceof WI.Target),this._target=e||WI.mainTarget,this._type=i,this._subtype=n,t?(console.assert(!n||typeof n=="string"),console.assert(!a||typeof a=="string"),console.assert(!s),this._objectId=t,this._description=a||"",this._hasChildren=i!=="symbol",this._size=d,this._classPrototype=p,this._preview=_,n==="class"&&(this._functionDescription=this._description,this._description="class "+f)):(console.assert(i!=="object"||s===null),console.assert(!_),this._description=a||s+"",this._hasChildren=!1,this._value=s)}static createFakeRemoteObject(){return new WI.RemoteObject(void 0,WI.RemoteObject.FakeRemoteObjectId,"object")}static fromPrimitiveValue(e){return new WI.RemoteObject(void 0,void 0,typeof e,void 0,e,void 0,void 0,void 0,void 0)}static fromPayload(e,t){if(console.assert(typeof e=="object","Remote object payload should only be an object"),e.subtype==="array"){var i=e.description.match(/\[(\d+)\]$/);i&&(e.size=parseInt(i[1]),e.description=e.description.replace(/\[\d+\]$/,""))}return e.classPrototype&&(e.classPrototype=WI.RemoteObject.fromPayload(e.classPrototype,t)),e.preview&&(e.preview.type||(e.preview.type=e.type,e.preview.subtype=e.subtype,e.preview.description=e.description,e.preview.size=e.size),e.preview=WI.ObjectPreview.fromPayload(e.preview)),new WI.RemoteObject(t,e.objectId,e.type,e.subtype,e.value,e.description,e.size,e.classPrototype,e.className,e.preview)}static createCallArgument(e){return e instanceof WI.RemoteObject?e.objectId?{objectId:e.objectId}:{value:e.value}:{value:e}}static resolveNode(e,t){return DOMAgent.resolveNode(e.id,t).then(({object:i})=>WI.RemoteObject.fromPayload(i,WI.mainTarget))}static resolveWebSocket(e,t,i){console.assert(typeof i=="function"),NetworkAgent.resolveWebSocket(e.requestIdentifier,t,(n,s)=>{i(n||!s?null:WI.RemoteObject.fromPayload(s,e.target))})}static resolveCanvasContext(e,t,i){console.assert(typeof i=="function"),CanvasAgent.resolveCanvasContext(e.identifier,t,(n,s)=>{i(n||!s?null:WI.RemoteObject.fromPayload(s,WI.mainTarget))})}get target(){return this._target}get objectId(){return this._objectId}get type(){return this._type}get subtype(){return this._subtype}get description(){return this._description}get functionDescription(){return console.assert(this.type==="function"),this._functionDescription||this._description}get hasChildren(){return this._hasChildren}get value(){return this._value}get size(){return this._size||0}get classPrototype(){return this._classPrototype}get preview(){return this._preview}hasSize(){return this.isArray()||this.isCollectionType()}hasValue(){return"_value"in this}canLoadPreview(){return!(this._failedToLoadPreview||this._type!=="object"||!this._objectId||this._isSymbol()||this._isFakeObject())}updatePreview(e){if(!this.canLoadPreview()){e(null);return}if(!this._target.RuntimeAgent.getPreview){this._failedToLoadPreview=!0,e(null);return}this._target.RuntimeAgent.getPreview(this._objectId,(t,i)=>{if(t){this._failedToLoadPreview=!0,e(null);return}this._preview=WI.ObjectPreview.fromPayload(i),e(this._preview)})}getPropertyDescriptors(e,t={}){if(!this._objectId||this._isSymbol()||this._isFakeObject()){e([]);return}this._target.RuntimeAgent.getProperties(this._objectId,t.ownProperties,t.generatePreview,this._getPropertyDescriptorsResolver.bind(this,e))}getDisplayablePropertyDescriptors(e){if(!this._objectId||this._isSymbol()||this._isFakeObject()){e([]);return}if(!this._target.RuntimeAgent.getDisplayableProperties){this._target.RuntimeAgent.getProperties(this._objectId,function(t,i){var n=[];if(i){for(var s of i)if(s.isOwn||s.name==="__proto__")n.push(s);else if(s.value&&s.name!==s.name.toUpperCase()){var a=s.value.type;a&&a!=="function"&&s.name!=="constructor"&&n.push(s)}}this._getPropertyDescriptorsResolver(e,t,n)}.bind(this));return}this._target.RuntimeAgent.getDisplayableProperties(this._objectId,!0,this._getPropertyDescriptorsResolver.bind(this,e))}deprecatedGetOwnProperties(e){this._deprecatedGetProperties(!0,e)}deprecatedGetAllProperties(e){this._deprecatedGetProperties(!1,e)}deprecatedGetDisplayableProperties(e){if(!this._objectId||this._isSymbol()||this._isFakeObject()){e([]);return}if(!this._target.RuntimeAgent.getDisplayableProperties){this._target.RuntimeAgent.getProperties(this._objectId,function(t,i){var n=[];if(i){for(var s of i)if(s.isOwn||s.get||s.name==="__proto__")n.push(s);else if(s.value&&s.name!==s.name.toUpperCase()){var a=s.value.type;a&&a!=="function"&&s.name!=="constructor"&&n.push(s)}}this._deprecatedGetPropertiesResolver(e,t,n)}.bind(this));return}this._target.RuntimeAgent.getDisplayableProperties(this._objectId,this._deprecatedGetPropertiesResolver.bind(this,e))}setPropertyValue(e,t,i){if(!this._objectId||this._isSymbol()||this._isFakeObject()){i("Can't set a property of non-object.");return}this._target.RuntimeAgent.evaluate.invoke({expression:appendWebInspectorSourceURL(t),doNotPauseOnExceptionsAndMuteConsole:!0},n.bind(this),this._target.RuntimeAgent);function n(a,d,p){if(a||p){i(a||d.description);return}function f(_,b){this[_]=b}delete d.description,this._target.RuntimeAgent.callFunctionOn(this._objectId,appendWebInspectorSourceURL(f.toString()),[{value:e},d],!0,void 0,s.bind(this)),d._objectId&&this._target.RuntimeAgent.releaseObject(d._objectId)}function s(a,d,p){if(a||p){i(a||d.description);return}i()}}isUndefined(){return this._type==="undefined"}isNode(){return this._subtype==="node"}isArray(){return this._subtype==="array"}isClass(){return this._subtype==="class"}isCollectionType(){return this._subtype==="map"||this._subtype==="set"||this._subtype==="weakmap"||this._subtype==="weakset"}isWeakCollection(){return this._subtype==="weakmap"||this._subtype==="weakset"}getCollectionEntries(e,t,i){e=typeof e=="number"?e:0,t=typeof t=="number"?t:100,console.assert(e>=0),console.assert(t>=0),console.assert(this.isCollectionType()),console.assert(this._subtype==="weakmap"&&e===0||this._subtype!=="weakmap"),console.assert(this._subtype==="weakset"&&e===0||this._subtype!=="weakset");let n=this.isWeakCollection()?this._weakCollectionObjectGroup():"";this._target.RuntimeAgent.getCollectionEntries(this._objectId,n,e,t,(s,a)=>{a=a.map(d=>WI.CollectionEntry.fromPayload(d,this._target)),i(a)})}releaseWeakCollectionEntries(){console.assert(this.isWeakCollection()),this._target.RuntimeAgent.releaseObjectGroup(this._weakCollectionObjectGroup())}pushNodeToFrontend(e){this._objectId?WI.domManager.pushNodeToFrontend(this._objectId,e):e(0)}async fetchProperties(e,t={}){let i=new Set,n=[];for(let p of e){if(typeof p!="string"&&typeof p!="number")throw new Error(`Tried to get property using key is not a string or number: ${p}`);i.has(p)||(i.add(p),n.push(this.getProperty(p)))}function s(p){return p.hasValue()?p.value:p}let a=Array.from(i),d=await Promise.all(n);for(let p=0;p<a.length;++p)t[a[p]]=s(d[p]);return t}getProperty(e,t=null){function i(n){if(typeof n!="string"&&typeof n!="number")throw new Error(`Tried to get property using key is not a string or number: ${n}`);return this[n]}if(t&&typeof t=="function")this.callFunction(i,[e],!0,t);else return this.callFunction(i,[e],!0)}callFunction(e,t,i,n=null){let s=a=>a?WI.RemoteObject.fromPayload(a,this._target):null;if(t&&(t=t.map(WI.RemoteObject.createCallArgument)),n&&typeof n=="function")this._target.RuntimeAgent.callFunctionOn(this._objectId,appendWebInspectorSourceURL(e.toString()),t,!0,void 0,!!i,(a,d,p)=>{n(a,s(d),p)});else return this._target.RuntimeAgent.callFunctionOn(this._objectId,appendWebInspectorSourceURL(e.toString()),t,!0,void 0,!!i).then(({result:a,wasThrown:d})=>(a=s(a),a&&d?Promise.reject(a):Promise.resolve(a)))}callFunctionJSON(e,t,i){function n(s,a,d){i(s||d?null:a.value)}this._target.RuntimeAgent.callFunctionOn(this._objectId,appendWebInspectorSourceURL(e.toString()),t,!0,!0,n)}invokeGetter(e,t){console.assert(e instanceof WI.RemoteObject);function i(n){return n?n.call(this):void 0}this.callFunction(i,[e],!0,t)}getOwnPropertyDescriptor(e,t){function i(s){return this[s]}function n(s,a,d){if(s||d||!(a instanceof WI.RemoteObject)){t(null);return}var p={name:e,value:a,writable:!0,configurable:!0,enumerable:!1},f=new WI.PropertyDescriptor(p,null,!0,!1,!1,!1);t(f)}this.callFunction(i,[e],!1,n.bind(this))}release(){this._objectId&&!this._isFakeObject()&&this._target.RuntimeAgent.releaseObject(this._objectId)}arrayLength(){if(this._subtype!=="array")return 0;var e=this._description.match(/\[([0-9]+)\]/);return e?parseInt(e[1],10):0}asCallArgument(){return WI.RemoteObject.createCallArgument(this)}findFunctionSourceCodeLocation(){var e=new WI.WrappedPromise;return!this._isFunction()||!this._objectId?(e.resolve(WI.RemoteObject.SourceCodeLocationPromise.MissingObjectId),e.promise):(this._target.DebuggerAgent.getFunctionDetails(this._objectId,(t,i)=>{if(t){e.resolve(WI.RemoteObject.SourceCodeLocationPromise.NoSourceFound);return}var n=i.location,s=WI.debuggerManager.scriptForIdentifier(n.scriptId,this._target);if(!s||!WI.isDebugUIEnabled()&&isWebKitInternalScript(s.sourceURL)){e.resolve(WI.RemoteObject.SourceCodeLocationPromise.NoSourceFound);return}var a=s.createSourceCodeLocation(n.lineNumber,n.columnNumber||0);e.resolve(a)}),e.promise)}_isFakeObject(){return this._objectId===WI.RemoteObject.FakeRemoteObjectId}_isSymbol(){return this._type==="symbol"}_isFunction(){return this._type==="function"}_weakCollectionObjectGroup(){return JSON.stringify(this._objectId)+"-"+this._subtype}_getPropertyDescriptorsResolver(e,t,i,n){if(t){e(null);return}let s=i.map(a=>WI.PropertyDescriptor.fromPayload(a,!1,this._target));n&&(s=s.concat(n.map(a=>WI.PropertyDescriptor.fromPayload(a,!0,this._target)))),e(s)}_deprecatedGetProperties(e,t){if(!this._objectId||this._isSymbol()||this._isFakeObject()){t([]);return}this._target.RuntimeAgent.getProperties(this._objectId,e,this._deprecatedGetPropertiesResolver.bind(this,t))}_deprecatedGetPropertiesResolver(e,t,i,n){if(t){e(null);return}n&&(i=i.concat(n.map(function(p){return p.writable=!1,p.configurable=!1,p.enumerable=!1,p.isOwn=!0,p})));for(var s=[],a=0;i&&a<i.length;++a){var d=i[a];d.get||d.set?(d.get&&s.push(new WI.DeprecatedRemoteObjectProperty("get "+d.name,WI.RemoteObject.fromPayload(d.get,this._target),d)),d.set&&s.push(new WI.DeprecatedRemoteObjectProperty("set "+d.name,WI.RemoteObject.fromPayload(d.set,this._target),d))):s.push(new WI.DeprecatedRemoteObjectProperty(d.name,WI.RemoteObject.fromPayload(d.value,this._target),d))}e(s)}};WI.RemoteObject.FakeRemoteObjectId="fake-remote-object";WI.RemoteObject.SourceCodeLocationPromise={NoSourceFound:"remote-object-source-code-location-promise-no-source-found",MissingObjectId:"remote-object-source-code-location-promise-missing-object-id"};WI.DeprecatedRemoteObjectProperty=class{constructor(e,t,i){this.name=e,this.value=t,this.enumerable=i?!!i.enumerable:!0,this.writable=i?!!i.writable:!0,i&&i.wasThrown&&(this.wasThrown=!0)}fromPrimitiveValue(e,t){return new WI.DeprecatedRemoteObjectProperty(e,WI.RemoteObject.fromPrimitiveValue(t))}};WI.Target=class extends WI.Object{constructor(e,t,i,n){super(),this._identifier=e,this._name=t,this._type=i,this._connection=n,this._executionContext=null,this._mainResource=null,this._resourceCollection=new WI.ResourceCollection,this._extraScriptCollection=new WI.ScriptCollection,this._agents={};const s=this._supportedDomainsForTargetType(this._type);for(let a of s){let d=this._connection._agents[a];d&&d.active&&(this._agents[a]=d)}this._connection.target=this,console.assert(this.RuntimeAgent),console.assert(this.DebuggerAgent),console.assert(this.ConsoleAgent)}initialize(){this.InspectorAgent&&this.InspectorAgent.enable();for(let e of WI.managers)e.initializeTarget&&e.initializeTarget(this);WI.initializeTarget(this),this.ConsoleAgent.enable(),setTimeout(()=>{WI.performOneTimeFrontendInitializationsUsingTarget(this)}),setTimeout(()=>{this.InspectorAgent&&this.InspectorAgent.initialized&&this.InspectorAgent.initialized()})}activateExtraDomain(e){let t=this._connection._agents[e];t&&t.active&&(this._agents[e]=t)}get AuditAgent(){return this._agents.Audit}get ApplicationCacheAgent(){return this._agents.ApplicationCache}get CPUProfilerAgent(){return this._agents.CPUProfiler}get CSSAgent(){return this._agents.CSS}get CanvasAgent(){return this._agents.Canvas}get ConsoleAgent(){return this._agents.Console}get DOMAgent(){return this._agents.DOM}get DOMDebuggerAgent(){return this._agents.DOMDebugger}get DOMStorageAgent(){return this._agents.DOMStorage}get DatabaseAgent(){return this._agents.Database}get DebuggerAgent(){return this._agents.Debugger}get HeapAgent(){return this._agents.Heap}get IndexedDBAgent(){return this._agents.IndexedDB}get InspectorAgent(){return this._agents.Inspector}get LayerTreeAgent(){return this._agents.LayerTree}get MemoryAgent(){return this._agents.Memory}get NetworkAgent(){return this._agents.Network}get PageAgent(){return this._agents.Page}get RecordingAgent(){return this._agents.Recording}get RuntimeAgent(){return this._agents.Runtime}get ScriptProfilerAgent(){return this._agents.ScriptProfiler}get ServiceWorkerAgent(){return this._agents.ServiceWorker}get TargetAgent(){return this._agents.Target}get TimelineAgent(){return this._agents.Timeline}get WorkerAgent(){return this._agents.Worker}get identifier(){return this._identifier}set identifier(e){this._identifier=e}get name(){return this._name}set name(e){this._name=e}get type(){return this._type}get connection(){return this._connection}get executionContext(){return this._executionContext}get resourceCollection(){return this._resourceCollection}get extraScriptCollection(){return this._extraScriptCollection}get displayName(){return this._name}get mainResource(){return this._mainResource}set mainResource(e){console.assert(!this._mainResource),this._mainResource=e,this.dispatchEventToListeners(WI.Target.Event.MainResourceAdded,{resource:e})}addResource(e){this._resourceCollection.add(e),this.dispatchEventToListeners(WI.Target.Event.ResourceAdded,{resource:e})}adoptResource(e){e._target=this,this.addResource(e)}addScript(e){this._extraScriptCollection.add(e),this.dispatchEventToListeners(WI.Target.Event.ScriptAdded,{script:e})}_supportedDomainsForTargetType(e){switch(e){case WI.Target.Type.JSContext:return InspectorBackend.supportedDomainsForDebuggableType(WI.DebuggableType.JavaScript);case WI.Target.Type.Worker:return InspectorBackend.supportedDomainsForDebuggableType(WI.DebuggableType.Worker);case WI.Target.Type.ServiceWorker:return InspectorBackend.supportedDomainsForDebuggableType(WI.DebuggableType.ServiceWorker);case WI.Target.Type.Page:return InspectorBackend.supportedDomainsForDebuggableType(WI.DebuggableType.Web);default:return console.assert(!1,"Unexpected target type",e),InspectorBackend.supportedDomainsForDebuggableType(WI.DebuggableType.Web)}}};WI.Target.Type={Page:Symbol("page"),JSContext:Symbol("jscontext"),ServiceWorker:Symbol("service-worker"),Worker:Symbol("worker")};WI.Target.Event={MainResourceAdded:"target-main-resource-added",ResourceAdded:"target-resource-added",ScriptAdded:"target-script-added"};WI.DirectBackendTarget=class dp extends WI.Target{constructor(){let{type:e,displayName:t}=dp.connectionInfoForDebuggable();super("direct",t,e,InspectorBackend.backendConnection),this._executionContext=new WI.ExecutionContext(this,WI.RuntimeManager.TopLevelContextExecutionIdentifier,t,!0,null),this._mainResource=null}static connectionInfoForDebuggable(){switch(WI.sharedApp.debuggableType){case WI.DebuggableType.JavaScript:return{type:WI.Target.Type.JSContext,displayName:WI.UIString("JavaScript Context")};case WI.DebuggableType.ServiceWorker:return{type:WI.Target.Type.ServiceWorker,displayName:WI.UIString("ServiceWorker")};case WI.DebuggableType.Web:return{type:WI.Target.Type.Page,displayName:WI.UIString("Page")};default:return console.error("Unexpected debuggable type: ",WI.sharedApp.debuggableType),{type:WI.Target.Type.JSContext,displayName:WI.UIString("JavaScript Context")}}}get mainResource(){if(this._mainResource)return this._mainResource;let e=WI.networkManager.mainFrame;return e?e.mainResource:null}set mainResource(e){this._mainResource=e}};WI.MultiplexingBackendTarget=class extends WI.Target{constructor(){const e=WI.Target.Type.Page,t=WI.UIString("Page");super("multi",t,e,InspectorBackend.backendConnection);let i=this._agents;this._agents={Target:i.Target}}initialize(){}get name(){return console.error("Called name on a MultiplexingBackendTarget"),WI.UIString("Page")}get executionContext(){return console.error("Called executionContext on a MultiplexingBackendTarget"),null}get mainResource(){return console.error("Called mainResource on a MultiplexingBackendTarget"),null}};WI.JavaScriptContextTarget=class extends WI.Target{constructor(e,t,i){super(e,t,WI.Target.Type.JSContext,i);const n=!1;this._executionContext=new WI.ExecutionContext(this,WI.RuntimeManager.TopLevelContextExecutionIdentifier,this.displayName,n,null)}};WI.PageTarget=class extends WI.Target{constructor(e,t,i){super(e,t,WI.Target.Type.Page,i);const n=!0;this._executionContext=new WI.ExecutionContext(this,WI.RuntimeManager.TopLevelContextExecutionIdentifier,this.displayName,n,null)}};WI.WorkerTarget=class extends WI.Target{constructor(e,t,i){super(e,t,WI.Target.Type.Worker,i);const n=!1;this._executionContext=new WI.ExecutionContext(this,WI.RuntimeManager.TopLevelContextExecutionIdentifier,this.displayName,n,null)}get displayName(){return WI.displayNameForURL(this._name)}};WI.ApplicationCacheObserver=class{applicationCacheStatusUpdated(e,t,i){WI.applicationCacheManager.applicationCacheStatusUpdated(e,t,i)}networkStateUpdated(e){WI.applicationCacheManager.networkStateUpdated(e)}};WI.CPUProfilerObserver=class{trackingStart(e){WI.timelineManager.cpuProfilerTrackingStarted(e)}trackingUpdate(e){WI.timelineManager.cpuProfilerTrackingUpdated(e)}trackingComplete(e){WI.timelineManager.cpuProfilerTrackingCompleted(e)}};WI.CSSObserver=class{mediaQueryResultChanged(){WI.cssManager.mediaQueryResultChanged()}styleSheetChanged(e){WI.cssManager.styleSheetChanged(e)}styleSheetAdded(e){WI.cssManager.styleSheetAdded(e)}styleSheetRemoved(e){WI.cssManager.styleSheetRemoved(e)}namedFlowCreated(e){}namedFlowRemoved(e,t){}regionOversetChanged(e){}registeredNamedFlowContentElement(e,t,i,n){}unregisteredNamedFlowContentElement(e,t,i){}};WI.CanvasObserver=class{canvasAdded(e){WI.canvasManager.canvasAdded(e)}canvasRemoved(e){WI.canvasManager.canvasRemoved(e)}canvasMemoryChanged(e,t){WI.canvasManager.canvasMemoryChanged(e,t)}cssCanvasClientNodesChanged(e){WI.canvasManager.cssCanvasClientNodesChanged(e)}recordingStarted(e,t){WI.canvasManager.recordingStarted(e,t)}recordingProgress(e,t,i){WI.canvasManager.recordingProgress(e,t,i)}recordingFinished(e,t){WI.canvasManager.recordingFinished(e,t)}extensionEnabled(e,t){WI.canvasManager.extensionEnabled(e,t)}programCreated(e,t){WI.canvasManager.programCreated(e,t)}programDeleted(e){WI.canvasManager.programDeleted(e)}};WI.ConsoleObserver=class{messageAdded(e){e.source==="console-api"&&e.type==="clear"||(e.type==="assert"&&!e.text&&(e.text=WI.UIString("Assertion")),WI.consoleManager.messageWasAdded(this.target,e.source,e.level,e.text,e.type,e.url,e.line,e.column||0,e.repeatCount,e.parameters,e.stackTrace,e.networkRequestId))}messageRepeatCountUpdated(e){WI.consoleManager.messageRepeatCountUpdated(e)}messagesCleared(){WI.consoleManager.messagesCleared()}heapSnapshot(e,t,i){WI.HeapSnapshotWorkerProxy.singleton().createSnapshot(t,i||null,({objectId:s,snapshot:a})=>{let d=WI.HeapSnapshotProxy.deserialize(s,a);d.snapshotStringData=t,WI.timelineManager.heapSnapshotAdded(e,d)})}};WI.DOMObserver=class{documentUpdated(){WI.domManager._documentUpdated()}inspect(e){WI.domManager.inspectElement(e)}setChildNodes(e,t){WI.domManager._setChildNodes(e,t)}attributeModified(e,t,i){WI.domManager._attributeModified(e,t,i)}attributeRemoved(e,t){WI.domManager._attributeRemoved(e,t)}inlineStyleInvalidated(e){WI.domManager._inlineStyleInvalidated(e)}characterDataModified(e,t){WI.domManager._characterDataModified(e,t)}childNodeCountUpdated(e,t){WI.domManager._childNodeCountUpdated(e,t)}childNodeInserted(e,t,i){WI.domManager._childNodeInserted(e,t,i)}childNodeRemoved(e,t){WI.domManager._childNodeRemoved(e,t)}shadowRootPushed(e,t){WI.domManager._childNodeInserted(e,0,t)}shadowRootPopped(e,t){WI.domManager._childNodeRemoved(e,t)}customElementStateChanged(e,t){WI.domManager._customElementStateChanged(e,t)}pseudoElementAdded(e,t){WI.domManager._pseudoElementAdded(e,t)}pseudoElementRemoved(e,t){WI.domManager._pseudoElementRemoved(e,t)}didAddEventListener(e){WI.domManager.didAddEventListener(e)}willRemoveEventListener(e){WI.domManager.willRemoveEventListener(e)}didFireEvent(e,t,i,n){WI.domManager.didFireEvent(e,t,i,n)}videoLowPowerChanged(e,t,i){WI.domManager.powerEfficientPlaybackStateChanged(e,t,i)}powerEfficientPlaybackStateChanged(e,t,i){WI.domManager.powerEfficientPlaybackStateChanged(e,t,i)}};WI.DOMStorageObserver=class{domStorageItemsCleared(e){WI.domStorageManager.itemsCleared(e)}domStorageItemRemoved(e,t){WI.domStorageManager.itemRemoved(e,t)}domStorageItemAdded(e,t,i){WI.domStorageManager.itemAdded(e,t,i)}domStorageItemUpdated(e,t,i,n){WI.domStorageManager.itemUpdated(e,t,i,n)}};WI.DatabaseObserver=class{addDatabase(e){WI.databaseManager.databaseWasAdded(e.id,e.domain,e.name,e.version)}};WI.DebuggerObserver=class{constructor(){this._legacyScriptParsed=InspectorBackend.domains.Debugger.hasEventParameter("scriptParsed","hasSourceURL")}globalObjectCleared(){WI.debuggerManager.reset()}scriptParsed(e,t,i,n,s,a,d,p,f,_){if(this._legacyScriptParsed){let b=arguments[7],S=arguments[8]?t:void 0;WI.debuggerManager.scriptDidParse(this.target,e,t,i,n,s,a,_,d,S,b);return}WI.debuggerManager.scriptDidParse(this.target,e,t,i,n,s,a,_,d,p,f)}scriptFailedToParse(e,t,i,n,s){WI.debuggerManager.scriptDidFail(this.target,e,t)}breakpointResolved(e,t){WI.debuggerManager.breakpointResolved(this.target,e,t)}paused(e,t,i,n){WI.debuggerManager.debuggerDidPause(this.target,e,t,i,n)}resumed(){WI.debuggerManager.debuggerDidResume(this.target)}playBreakpointActionSound(e){WI.debuggerManager.playBreakpointActionSound(e)}didSampleProbe(e){WI.debuggerManager.didSampleProbe(this.target,e)}};WI.HeapObserver=class{garbageCollected(e){WI.heapManager.garbageCollected(this.target,e)}trackingStart(e,t){WI.HeapSnapshotWorkerProxy.singleton().createSnapshot(t,({objectId:n,snapshot:s})=>{let a=WI.HeapSnapshotProxy.deserialize(n,s);a.snapshotStringData=t,WI.timelineManager.heapTrackingStarted(e,a)})}trackingComplete(e,t){WI.HeapSnapshotWorkerProxy.singleton().createSnapshot(t,({objectId:n,snapshot:s})=>{let a=WI.HeapSnapshotProxy.deserialize(n,s);a.snapshotStringData=t,WI.timelineManager.heapTrackingCompleted(e,a)})}};WI.InspectorObserver=class{evaluateForTestInFrontend(e){!InspectorFrontendHost.isUnderTest()||InspectorBackend.runAfterPendingDispatches(function(){window.eval(e)})}inspect(e,t){let i=WI.RemoteObject.fromPayload(e,WI.mainTarget);if(i.subtype==="node"){WI.domManager.inspectNodeObject(i);return}if(i.type==="function"){i.findFunctionSourceCodeLocation().then(n=>{n instanceof WI.SourceCodeLocation&&WI.showSourceCodeLocation(n,{ignoreNetworkTab:!0,ignoreSearchTab:!0})}),i.release();return}t.databaseId?WI.databaseManager.inspectDatabase(t.databaseId):t.domStorageId&&WI.domStorageManager.inspectDOMStorage(t.domStorageId),i.release()}activateExtraDomains(e){WI.sharedApp.activateExtraDomains(e)}};WI.LayerTreeObserver=class{layerTreeDidChange(){WI.layerTreeManager.layerTreeDidChange()}};WI.MemoryObserver=class{memoryPressure(e,t){WI.memoryManager.memoryPressure(e,t)}trackingStart(e){WI.timelineManager.memoryTrackingStarted(e)}trackingUpdate(e){WI.timelineManager.memoryTrackingUpdated(e)}trackingComplete(e){WI.timelineManager.memoryTrackingCompleted(e)}};WI.NetworkObserver=class{requestWillBeSent(e,t,i,n,s,a,d,p,f,_,b){InspectorBackend.domains.Network.hasEventParameter("requestWillBeSent","walltime")||(d=void 0,p=arguments[6],f=arguments[7],_=arguments[8],b=arguments[9]),WI.networkManager.resourceRequestWillBeSent(e,t,i,s,_,f,a,d,p,b)}requestServedFromCache(e){WI.networkManager.markResourceRequestAsServedFromMemoryCache(e)}responseReceived(e,t,i,n,s,a){WI.networkManager.resourceRequestDidReceiveResponse(e,t,i,s,a,n)}dataReceived(e,t,i,n){WI.networkManager.resourceRequestDidReceiveData(e,i,n,t)}loadingFinished(e,t,i,n){WI.networkManager.resourceRequestDidFinishLoading(e,t,i,n)}loadingFailed(e,t,i,n){WI.networkManager.resourceRequestDidFailLoading(e,n,t,i)}requestServedFromMemoryCache(e,t,i,n,s,a,d){WI.networkManager.resourceRequestWasServedFromMemoryCache(e,t,i,d,s,a)}webSocketCreated(e,t){WI.networkManager.webSocketCreated(e,t)}webSocketWillSendHandshakeRequest(e,t,i,n){WI.networkManager.webSocketWillSendHandshakeRequest(e,t,i,n)}webSocketHandshakeResponseReceived(e,t,i){WI.networkManager.webSocketHandshakeResponseReceived(e,t,i)}webSocketClosed(e,t){WI.networkManager.webSocketClosed(e,t)}webSocketFrameReceived(e,t,i){WI.networkManager.webSocketFrameReceived(e,t,i)}webSocketFrameSent(e,t,i){WI.networkManager.webSocketFrameSent(e,t,i)}webSocketFrameError(e,t,i){}};WI.PageObserver=class{domContentEventFired(e){WI.timelineManager.pageDOMContentLoadedEventFired(e)}loadEventFired(e){WI.timelineManager.pageLoadEventFired(e)}frameNavigated(e,t){WI.networkManager.frameDidNavigate(e,t)}frameDetached(e){WI.networkManager.frameDidDetach(e)}defaultAppearanceDidChange(e){WI.cssManager.defaultAppearanceDidChange(e)}frameStartedLoading(e){}frameStoppedLoading(e){}frameScheduledNavigation(e,t){}frameClearedScheduledNavigation(e){}javascriptDialogOpening(e){}javascriptDialogClosed(){}scriptsEnabled(e){}};WI.RuntimeObserver=class{executionContextCreated(e){WI.networkManager.executionContextCreated(e)}};WI.ScriptProfilerObserver=class{trackingStart(e){WI.timelineManager.scriptProfilerTrackingStarted(e)}trackingUpdate(e){WI.timelineManager.scriptProfilerTrackingUpdated(e)}trackingComplete(e,t){WI.timelineManager.scriptProfilerTrackingCompleted(e,t)}programmaticCaptureStarted(){}programmaticCaptureStopped(){}};WI.TargetObserver=class{targetCreated(e){WI.targetManager.targetCreated(e)}targetDestroyed(e){WI.targetManager.targetDestroyed(e)}dispatchMessageFromTarget(e,t){WI.targetManager.dispatchMessageFromTarget(e,t)}};WI.TimelineObserver=class{eventRecorded(e){WI.timelineManager.eventRecorded(e)}recordingStarted(e){WI.timelineManager.capturingStarted(e)}recordingStopped(e){WI.timelineManager.capturingStopped(e)}autoCaptureStarted(){WI.timelineManager.autoCaptureStarted()}programmaticCaptureStarted(){}programmaticCaptureStopped(){}};WI.WorkerObserver=class{workerCreated(e,t){WI.workerManager.workerCreated(e,t)}workerTerminated(e){WI.workerManager.workerTerminated(e)}dispatchMessageFromWorker(e,t){WI.workerManager.dispatchMessageFromWorker(e,t)}};WI.BreakpointAction=class hp{constructor(e,t,i){console.assert(e instanceof WI.Breakpoint),console.assert(Object.values(WI.BreakpointAction.Type).includes(t)),this._breakpoint=e,this._type=t,this._data=i||null,this._id=WI.debuggerManager.nextBreakpointActionIdentifier()}static fromJSON(e,t){return new hp(t,e.type,e.data)}toJSON(){let e={type:this._type};return this._data&&(e.data=this._data),e}get breakpoint(){return this._breakpoint}get id(){return this._id}get type(){return this._type}get data(){return this._data}set data(e){this._data!==e&&(this._data=e,this._breakpoint.breakpointActionDidChange(this))}toProtocol(){let e=this.toJSON();return e.id=this._id,e}};WI.BreakpointAction.Type={Log:"log",Evaluate:"evaluate",Sound:"sound",Probe:"probe"};WI.ConsoleMessage=class{constructor(e,t,i,n,s,a,d,p,f,_,b,w){console.assert(e instanceof WI.Target),console.assert(typeof t=="string"),console.assert(typeof i=="string"),console.assert(typeof n=="string"),console.assert(!s||Object.values(WI.ConsoleMessage.MessageType).includes(s)),console.assert(!_||_.every(S=>S instanceof WI.RemoteObject)),this._target=e,this._source=t,this._level=i,this._messageText=n,this._type=s||WI.ConsoleMessage.MessageType.Log,this._url=a||null,this._line=d||0,this._column=p||0,this._sourceCodeLocation=void 0,this._repeatCount=f||0,this._parameters=_,b=b||[],this._stackTrace=WI.StackTrace.fromPayload(this._target,{callFrames:b}),this._request=w}get target(){return this._target}get source(){return this._source}get level(){return this._level}get messageText(){return this._messageText}get type(){return this._type}get url(){return this._url}get line(){return this._line}get column(){return this._column}get repeatCount(){return this._repeatCount}get parameters(){return this._parameters}get stackTrace(){return this._stackTrace}get request(){return this._request}get sourceCodeLocation(){if(this._sourceCodeLocation!==void 0)return this._sourceCodeLocation;let e=this._stackTrace.callFrames[0];if(e&&e.sourceCodeLocation)return this._sourceCodeLocation=e.sourceCodeLocation,this._sourceCodeLocation;if(this._url&&this._url!=="undefined"){let t=WI.networkManager.resourceForURL(this._url);if(t){let i=this._line>0?this._line-1:0,n=this._column>0?this._column-1:0;return this._sourceCodeLocation=new WI.SourceCodeLocation(t,i,n),this._sourceCodeLocation}}return this._sourceCodeLocation=null,this._sourceCodeLocation}};WI.ConsoleMessage.MessageSource={HTML:"html",XML:"xml",JS:"javascript",Network:"network",ConsoleAPI:"console-api",Storage:"storage",Appcache:"appcache",Rendering:"rendering",CSS:"css",Security:"security",Other:"other",Media:"media",MediaSource:"mediasource",WebRTC:"webrtc"};WI.ConsoleMessage.MessageType={Log:"log",Dir:"dir",DirXML:"dirxml",Table:"table",Trace:"trace",StartGroup:"startGroup",StartGroupCollapsed:"startGroupCollapsed",EndGroup:"endGroup",Assert:"assert",Timing:"timing",Profile:"profile",ProfileEnd:"profileEnd",Image:"image",Result:"result"};WI.ConsoleMessage.MessageLevel={Log:"log",Info:"info",Warning:"warning",Error:"error",Debug:"debug"};WI.Instrument=class{static createForTimelineType(e){switch(e){case WI.TimelineRecord.Type.Network:return new WI.NetworkInstrument;case WI.TimelineRecord.Type.Layout:return new WI.LayoutInstrument;case WI.TimelineRecord.Type.Script:return new WI.ScriptInstrument;case WI.TimelineRecord.Type.RenderingFrame:return new WI.FPSInstrument;case WI.TimelineRecord.Type.CPU:return new WI.CPUInstrument;case WI.TimelineRecord.Type.Memory:return new WI.MemoryInstrument;case WI.TimelineRecord.Type.HeapAllocations:return new WI.HeapAllocationsInstrument;case WI.TimelineRecord.Type.Media:return new WI.MediaInstrument;default:return console.error("Unknown TimelineRecord.Type: "+e),null}}static startLegacyTimelineAgent(e){console.assert(window.TimelineAgent,"Attempted to start legacy timeline agent without TimelineAgent."),!WI.Instrument._legacyTimelineAgentStarted&&(WI.Instrument._legacyTimelineAgentStarted=!0,!e&&TimelineAgent.start())}static stopLegacyTimelineAgent(e){!WI.Instrument._legacyTimelineAgentStarted||(WI.Instrument._legacyTimelineAgentStarted=!1,!e&&TimelineAgent.stop())}get timelineRecordType(){return null}startInstrumentation(e){WI.Instrument.startLegacyTimelineAgent(e)}stopInstrumentation(e){WI.Instrument.stopLegacyTimelineAgent(e)}};WI.Instrument._legacyTimelineAgentStarted=!1;WI.SourceCode=class extends WI.Object{constructor(){super(),this._originalRevision=new WI.SourceCodeRevision(this,null,!1),this._currentRevision=this._originalRevision,this._sourceMaps=null,this._formatterSourceMap=null,this._requestContentPromise=null}get displayName(){return console.error("Needs to be implemented by a subclass."),""}get originalRevision(){return this._originalRevision}get currentRevision(){return this._currentRevision}set currentRevision(e){console.assert(e instanceof WI.SourceCodeRevision),e instanceof WI.SourceCodeRevision&&(console.assert(e.sourceCode===this),e.sourceCode===this&&(this._currentRevision=e,this.dispatchEventToListeners(WI.SourceCode.Event.ContentDidChange)))}get content(){return this._currentRevision.content}get url(){}get contentIdentifier(){return this.url}get sourceMaps(){return this._sourceMaps||[]}addSourceMap(e){console.assert(e instanceof WI.SourceMap),this._sourceMaps||(this._sourceMaps=[]),this._sourceMaps.push(e),this.dispatchEventToListeners(WI.SourceCode.Event.SourceMapAdded)}get formatterSourceMap(){return this._formatterSourceMap}set formatterSourceMap(e){console.assert(this._formatterSourceMap===null||e===null),console.assert(e===null||e instanceof WI.FormatterSourceMap),this._formatterSourceMap=e,this.dispatchEventToListeners(WI.SourceCode.Event.FormatterDidChange)}requestContent(){return this._requestContentPromise=this._requestContentPromise||this.requestContentFromBackend().then(this._processContent.bind(this)),this._requestContentPromise}createSourceCodeLocation(e,t){return new WI.SourceCodeLocation(this,e,t)}createLazySourceCodeLocation(e,t){return new WI.LazySourceCodeLocation(this,e,t)}createSourceCodeTextRange(e){return new WI.SourceCodeTextRange(this,e)}revisionContentDidChange(e){this._ignoreRevisionContentDidChangeEvent||e===this._currentRevision&&(this.handleCurrentRevisionContentChange(),this.dispatchEventToListeners(WI.SourceCode.Event.ContentDidChange))}handleCurrentRevisionContentChange(){}get revisionForRequestedContent(){return this._originalRevision}markContentAsStale(){this._requestContentPromise=null,this._contentReceived=!1}requestContentFromBackend(){return console.error("Needs to be implemented by a subclass."),Promise.reject(new Error("Needs to be implemented by a subclass."))}get mimeType(){console.error("Needs to be implemented by a subclass.")}_processContent(e){let t=e.content||e.body||e.text||e.scriptSource,i=t,n=e.error;e.base64Encoded&&(i=i?decodeBase64ToBlob(i,this.mimeType):"");let s=this.revisionForRequestedContent;return this._ignoreRevisionContentDidChangeEvent=!0,s.content=i||null,this._ignoreRevisionContentDidChangeEvent=!1,Promise.resolve({error:n,sourceCode:this,content:i,rawContent:t,rawBase64Encoded:e.base64Encoded})}};WI.SourceCode.Event={ContentDidChange:"source-code-content-did-change",SourceMapAdded:"source-code-source-map-added",FormatterDidChange:"source-code-formatter-did-change",LoadingDidFinish:"source-code-loading-did-finish",LoadingDidFail:"source-code-loading-did-fail"};WI.SourceCodeLocation=class extends WI.Object{constructor(e,t,i){super(),console.assert(e===null||e instanceof WI.SourceCode),console.assert(!(e instanceof WI.SourceMapResource)),console.assert(typeof t=="number"&&!isNaN(t)&&t>=0),console.assert(typeof i=="number"&&!isNaN(i)&&i>=0),this._sourceCode=e||null,this._lineNumber=t,this._columnNumber=i,this._resolveFormattedLocation(),this._sourceCode&&(this._sourceCode.addEventListener(WI.SourceCode.Event.SourceMapAdded,this._sourceCodeSourceMapAdded,this),this._sourceCode.addEventListener(WI.SourceCode.Event.FormatterDidChange,this._sourceCodeFormatterDidChange,this)),this._resetMappedLocation()}isEqual(e){return e?this._sourceCode===e._sourceCode&&this._lineNumber===e._lineNumber&&this._columnNumber===e._columnNumber:!1}get sourceCode(){return this._sourceCode}set sourceCode(e){this.setSourceCode(e)}get lineNumber(){return this._lineNumber}get columnNumber(){return this._columnNumber}position(){return new WI.SourceCodePosition(this.lineNumber,this.columnNumber)}get formattedLineNumber(){return this._formattedLineNumber}get formattedColumnNumber(){return this._formattedColumnNumber}formattedPosition(){return new WI.SourceCodePosition(this.formattedLineNumber,this.formattedColumnNumber)}get displaySourceCode(){return this.resolveMappedLocation(),this._mappedResource||this._sourceCode}get displayLineNumber(){return this.resolveMappedLocation(),isNaN(this._mappedLineNumber)?this._formattedLineNumber:this._mappedLineNumber}get displayColumnNumber(){return this.resolveMappedLocation(),isNaN(this._mappedColumnNumber)?this._formattedColumnNumber:this._mappedColumnNumber}displayPosition(){return new WI.SourceCodePosition(this.displayLineNumber,this.displayColumnNumber)}originalLocationString(e,t,i){return this._locationString(this.sourceCode,this.lineNumber,this.columnNumber,e,t,i)}formattedLocationString(e,t,i){return this._locationString(this.sourceCode,this.formattedLineNumber,this.formattedColumn,e,t,i)}displayLocationString(e,t,i){return this._locationString(this.displaySourceCode,this.displayLineNumber,this.displayColumnNumber,e,t,i)}tooltipString(){if(!this.hasDifferentDisplayLocation())return this.originalLocationString(WI.SourceCodeLocation.ColumnStyle.Shown,WI.SourceCodeLocation.NameStyle.Full);var e=WI.UIString("Located at %s").format(this.displayLocationString(WI.SourceCodeLocation.ColumnStyle.Shown,WI.SourceCodeLocation.NameStyle.Full));return e+=`
`+WI.UIString("Originally %s").format(this.originalLocationString(WI.SourceCodeLocation.ColumnStyle.Shown,WI.SourceCodeLocation.NameStyle.Full)),e}hasMappedLocation(){return this.resolveMappedLocation(),this._mappedResource!==null}hasFormattedLocation(){return this._formattedLineNumber!==this._lineNumber||this._formattedColumnNumber!==this._columnNumber}hasDifferentDisplayLocation(){return this.hasMappedLocation()||this.hasFormattedLocation()}update(e,t,i){if(console.assert(e===this._sourceCode||this._mappedResource&&e===this._mappedResource),console.assert(typeof t=="number"&&!isNaN(t)&&t>=0),console.assert(typeof i=="number"&&!isNaN(i)&&i>=0),!(e===this._sourceCode&&t===this._lineNumber&&i===this._columnNumber)&&!(this._mappedResource&&e===this._mappedResource&&t===this._mappedLineNumber&&i===this._mappedColumnNumber)){var n=e.createSourceCodeLocation(t,i);console.assert(n.sourceCode===this._sourceCode),this._makeChangeAndDispatchChangeEventIfNeeded(function(){this._lineNumber=n._lineNumber,this._columnNumber=n._columnNumber,n._mappedLocationIsResolved&&(this._mappedLocationIsResolved=!0,this._mappedResource=n._mappedResource,this._mappedLineNumber=n._mappedLineNumber,this._mappedColumnNumber=n._mappedColumnNumber)})}}populateLiveDisplayLocationTooltip(e,t){t=t||"",e.title=t+this.tooltipString(),this.addEventListener(WI.SourceCodeLocation.Event.DisplayLocationChanged,function(i){this.sourceCode&&(e.title=t+this.tooltipString())},this)}populateLiveDisplayLocationString(e,t,i,n,s){var a;function d(_,b){!b&&a===_||(a=_,_?this.hasDifferentDisplayLocation()&&(e[t]=this.originalLocationString(i,n,s),e.classList.remove(WI.SourceCodeLocation.DisplayLocationClassName)):(e[t]=this.displayLocationString(i,n,s),e.classList.toggle(WI.SourceCodeLocation.DisplayLocationClassName,this.hasDifferentDisplayLocation())))}function p(_){d.call(this,_.metaKey&&!_.altKey&&!_.shiftKey)}d.call(this,!1),this.addEventListener(WI.SourceCodeLocation.Event.DisplayLocationChanged,function(_){this.sourceCode&&d.call(this,a,!0)},this);var f=p.bind(this);e.addEventListener("mouseover",f),e.addEventListener("mousemove",f),e.addEventListener("mouseout",_=>{d.call(this,!1)})}setSourceCode(e){console.assert(this._sourceCode===null&&e instanceof WI.SourceCode||this._sourceCode instanceof WI.SourceCode&&e===null),e!==this._sourceCode&&this._makeChangeAndDispatchChangeEventIfNeeded(function(){this._sourceCode&&(this._sourceCode.removeEventListener(WI.SourceCode.Event.SourceMapAdded,this._sourceCodeSourceMapAdded,this),this._sourceCode.removeEventListener(WI.SourceCode.Event.FormatterDidChange,this._sourceCodeFormatterDidChange,this)),this._sourceCode=e,this._sourceCode&&(this._sourceCode.addEventListener(WI.SourceCode.Event.SourceMapAdded,this._sourceCodeSourceMapAdded,this),this._sourceCode.addEventListener(WI.SourceCode.Event.FormatterDidChange,this._sourceCodeFormatterDidChange,this))})}resolveMappedLocation(){if(!this._mappedLocationIsResolved&&(console.assert(this._mappedResource===null),console.assert(isNaN(this._mappedLineNumber)),console.assert(isNaN(this._mappedColumnNumber)),this._mappedLocationIsResolved=!0,!!this._sourceCode)){var e=this._sourceCode.sourceMaps;if(!!e.length)for(var t=0;t<e.length;++t){var i=e[t],n=i.findEntry(this._lineNumber,this._columnNumber);if(!(!n||n.length===2)){console.assert(n.length===5);var s=n[2],a=i.resourceForURL(s);if(!a)return;this._mappedResource=a,this._mappedLineNumber=n[3],this._mappedColumnNumber=n[4];return}}}}_locationString(e,t,i,n,s,a){if(console.assert(e),!e)return"";n=n||WI.SourceCodeLocation.ColumnStyle.OnlyIfLarge,s=s||WI.SourceCodeLocation.NameStyle.Short,a=a||"";let d=t+1;switch(n===WI.SourceCodeLocation.ColumnStyle.Shown&&i>0||n===WI.SourceCodeLocation.ColumnStyle.OnlyIfLarge&&i>WI.SourceCodeLocation.LargeColumnNumber?d+=":"+(i+1):n===WI.SourceCodeLocation.ColumnStyle.Hidden&&(d=""),s){case WI.SourceCodeLocation.NameStyle.None:return a+d;case WI.SourceCodeLocation.NameStyle.Short:case WI.SourceCodeLocation.NameStyle.Full:var p=e.displayURL,f=s===WI.SourceCodeLocation.NameStyle.Full&&p?p:e.displayName;if(n===WI.SourceCodeLocation.ColumnStyle.Hidden)return a+f;var _=p?":"+d:WI.UIString(" (line %s)").format(d);return a+f+_;default:return console.error("Unknown nameStyle: "+s),a+d}}_resetMappedLocation(){this._mappedLocationIsResolved=!1,this._mappedResource=null,this._mappedLineNumber=NaN,this._mappedColumnNumber=NaN}_setMappedLocation(e,t,i){this._mappedLocationIsResolved=!0,this._mappedResource=e,this._mappedLineNumber=t,this._mappedColumnNumber=i}_resolveFormattedLocation(){if(this._sourceCode&&this._sourceCode.formatterSourceMap){var e=this._sourceCode.formatterSourceMap.originalToFormatted(this._lineNumber,this._columnNumber);this._formattedLineNumber=e.lineNumber,this._formattedColumnNumber=e.columnNumber}else this._formattedLineNumber=this._lineNumber,this._formattedColumnNumber=this._columnNumber}_makeChangeAndDispatchChangeEventIfNeeded(e){var t=this._sourceCode,i=this._lineNumber,n=this._columnNumber,s=this._formattedLineNumber,a=this._formattedColumnNumber,d=this.displaySourceCode,p=this.displayLineNumber,f=this.displayColumnNumber;this._resetMappedLocation(),e&&e.call(this),this.resolveMappedLocation(),this._resolveFormattedLocation();var _=!1,b=this.displaySourceCode;(d!==b||b&&(p!==this.displayLineNumber||f!==this.displayColumnNumber))&&(_=!0);var w=!1;if((_||t!==this._sourceCode||this._sourceCode&&(i!==this._lineNumber||n!==this._columnNumber)||this._sourceCode&&(s!==this._formattedLineNumber||a!==this._formattedColumnNumber))&&(w=!0),_||w){var S={oldSourceCode:t,oldLineNumber:i,oldColumnNumber:n,oldFormattedLineNumber:s,oldFormattedColumnNumber:a,oldDisplaySourceCode:d,oldDisplayLineNumber:p,oldDisplayColumnNumber:f};_&&this.dispatchEventToListeners(WI.SourceCodeLocation.Event.DisplayLocationChanged,S),w&&this.dispatchEventToListeners(WI.SourceCodeLocation.Event.LocationChanged,S)}}_sourceCodeSourceMapAdded(){this._makeChangeAndDispatchChangeEventIfNeeded(null)}_sourceCodeFormatterDidChange(){this._makeChangeAndDispatchChangeEventIfNeeded(null)}};WI.SourceCodeLocation.DisplayLocationClassName="display-location";WI.SourceCodeLocation.LargeColumnNumber=80;WI.SourceCodeLocation.NameStyle={None:"none",Short:"short",Full:"full"};WI.SourceCodeLocation.ColumnStyle={Hidden:"hidden",OnlyIfLarge:"only-if-large",Shown:"shown"};WI.SourceCodeLocation.Event={LocationChanged:"source-code-location-location-changed",DisplayLocationChanged:"source-code-location-display-location-changed"};WI.Timeline=class extends WI.Object{constructor(e){super(),this._type=e,this.reset(!0)}static create(e){return e===WI.TimelineRecord.Type.Network?new WI.NetworkTimeline(e):e===WI.TimelineRecord.Type.CPU?new WI.CPUTimeline(e):e===WI.TimelineRecord.Type.Memory?new WI.MemoryTimeline(e):new WI.Timeline(e)}get type(){return this._type}get startTime(){return this._startTime}get endTime(){return this._endTime}get records(){return this._records}reset(e){this._records=[],this._startTime=NaN,this._endTime=NaN,e||(this.dispatchEventToListeners(WI.Timeline.Event.TimesUpdated),this.dispatchEventToListeners(WI.Timeline.Event.Reset))}addRecord(e,t={}){e.updatesDynamically&&e.addEventListener(WI.TimelineRecord.Event.Updated,this._recordUpdated,this),this._tryInsertingRecordInSortedOrder(e),this._updateTimesIfNeeded(e),this.dispatchEventToListeners(WI.Timeline.Event.RecordAdded,{record:e})}saveIdentityToCookie(e){e[WI.Timeline.TimelineTypeCookieKey]=this._type}refresh(){this.dispatchEventToListeners(WI.Timeline.Event.Refreshed)}closestRecordTo(e){let t=this._records.lowerBound(e,(d,p)=>d-p.endTime),i=this._records[t-1],n=this._records[t];if(!i&&!n)return null;if(!i&&n)return n;if(!n&&i)return i;let s=Math.abs(i.endTime-e),a=Math.abs(n.startTime-e);return s<a?i:n}recordsInTimeRange(e,t,{includeRecordBeforeStart:i,includeRecordAfterEnd:n}={}){let s=this._records.lowerBound(e,(d,p)=>d-p.endTime);if(i&&s>0){s--;let d=this._records[s];if(d.parent&&d.parent.type===d.type)for(s--;this._records[s]!==d.parent;)s--}let a=this._records.upperBound(t,(d,p)=>d-p.startTime);return n&&a<this._records.length&&++a,this._records.slice(s,a)}_updateTimesIfNeeded(e){var t=!1;(isNaN(this._startTime)||e.startTime<this._startTime)&&(this._startTime=e.startTime,t=!0),(isNaN(this._endTime)||this._endTime<e.endTime)&&(this._endTime=e.endTime,t=!0),t&&this.dispatchEventToListeners(WI.Timeline.Event.TimesUpdated)}_recordUpdated(e){this._updateTimesIfNeeded(e.target)}_tryInsertingRecordInSortedOrder(e){let t=this._records.lastValue;if(!t||t.startTime<e.startTime||e.updatesDynamically){this._records.push(e);return}let i=this._records.length-2,n=Math.max(this._records.length-20,0);for(let s=i;s>=n;--s)if(this._records[s].startTime<e.startTime){this._records.insertAtIndex(e,s+1);return}this._records.push(e)}};WI.Timeline.Event={Reset:"timeline-reset",RecordAdded:"timeline-record-added",TimesUpdated:"timeline-times-updated",Refreshed:"timeline-refreshed"};WI.Timeline.TimelineTypeCookieKey="timeline-type";WI.TimelineRange=class{constructor(e,t){this._startValue=e,this._endValue=t}get startValue(){return this._startValue}set startValue(e){this._startValue=e}get endValue(){return this._endValue}set endValue(e){this._endValue=e}};WI.TimelineRecord=class extends WI.Object{constructor(e,t,i,n,s){super(),console.assert(e),e in WI.TimelineRecord.Type&&(e=WI.TimelineRecord.Type[e]),this._type=e,this._startTime=t||NaN,this._endTime=i||NaN,this._callFrames=n||null,this._sourceCodeLocation=s||null,this._children=[]}static fromJSON(e){switch(e.type){case WI.TimelineRecord.Type.Network:return WI.ResourceTimelineRecord.fromJSON(e);case WI.TimelineRecord.Type.Layout:return WI.LayoutTimelineRecord.fromJSON(e);case WI.TimelineRecord.Type.Script:return WI.ScriptTimelineRecord.fromJSON(e);case WI.TimelineRecord.Type.RenderingFrame:return WI.RenderingFrameTimelineRecord.fromJSON(e);case WI.TimelineRecord.Type.CPU:return WI.CPUTimelineRecord.fromJSON(e);case WI.TimelineRecord.Type.Memory:return WI.MemoryTimelineRecord.fromJSON(e);case WI.TimelineRecord.Type.HeapAllocations:return WI.HeapAllocationsTimelineRecord.fromJSON(e);case WI.TimelineRecord.Type.Media:return WI.MediaTimelineRecord.fromJSON(e);default:return console.error("Unknown TimelineRecord.Type: "+e.type,e),null}}toJSON(){throw WI.NotImplementedError.subclassMustOverride()}get type(){return this._type}get startTime(){return this._startTime}get activeStartTime(){return this._startTime}get endTime(){return this._endTime}get duration(){return this.endTime-this.startTime}get inactiveDuration(){return this.activeStartTime-this.startTime}get activeDuration(){return this.endTime-this.activeStartTime}get updatesDynamically(){return!1}get usesActiveStartTime(){return!1}get callFrames(){return this._callFrames}get initiatorCallFrame(){if(!this._callFrames||!this._callFrames.length)return null;for(let e of this._callFrames)if(!e.nativeCode)return e;return null}get sourceCodeLocation(){return this._sourceCodeLocation}get parent(){return this._parent}set parent(e){this._parent!==e&&(this._parent=e)}get children(){return this._children}saveIdentityToCookie(e){e[WI.TimelineRecord.SourceCodeURLCookieKey]=this._sourceCodeLocation&&this._sourceCodeLocation.sourceCode.url?this._sourceCodeLocation.sourceCode.url.hash:null,e[WI.TimelineRecord.SourceCodeLocationLineCookieKey]=this._sourceCodeLocation?this._sourceCodeLocation.lineNumber:null,e[WI.TimelineRecord.SourceCodeLocationColumnCookieKey]=this._sourceCodeLocation?this._sourceCodeLocation.columnNumber:null,e[WI.TimelineRecord.TypeCookieKey]=this._type||null}};WI.TimelineRecord.Event={Updated:"timeline-record-updated"};WI.TimelineRecord.Type={Network:"timeline-record-type-network",Layout:"timeline-record-type-layout",Script:"timeline-record-type-script",RenderingFrame:"timeline-record-type-rendering-frame",CPU:"timeline-record-type-cpu",Memory:"timeline-record-type-memory",HeapAllocations:"timeline-record-type-heap-allocations",Media:"timeline-record-type-media"};WI.TimelineRecord.TypeIdentifier="timeline-record";WI.TimelineRecord.SourceCodeURLCookieKey="timeline-record-source-code-url";WI.TimelineRecord.SourceCodeLocationLineCookieKey="timeline-record-source-code-location-line";WI.TimelineRecord.SourceCodeLocationColumnCookieKey="timeline-record-source-code-location-column";WI.TimelineRecord.TypeCookieKey="timeline-record-type";WI.Resource=class tc extends WI.SourceCode{constructor(e,{mimeType:t,type:i,loaderIdentifier:n,targetId:s,requestIdentifier:a,requestMethod:d,requestHeaders:p,requestData:f,requestSentTimestamp:_,requestSentWalltime:b,initiatorCallFrames:w,initiatorSourceCodeLocation:S,initiatorNode:E,originalRequestWillBeSentTimestamp:k}={}){super(),console.assert(e),i in WI.Resource.Type&&(i=WI.Resource.Type[i]),this._url=e,this._urlComponents=null,this._mimeType=t,this._mimeTypeComponents=null,this._type=tc.resolvedType(i,t),this._loaderIdentifier=n||null,this._requestIdentifier=a||null,this._queryStringParameters=void 0,this._requestFormParameters=void 0,this._requestMethod=d||null,this._requestData=f||null,this._requestHeaders=p||{},this._responseHeaders={},this._requestCookies=null,this._responseCookies=null,this._serverTimingEntries=null,this._parentFrame=null,this._initiatorCallFrames=w||null,this._initiatorSourceCodeLocation=S||null,this._initiatorNode=E||null,this._initiatedResources=[],this._originalRequestWillBeSentTimestamp=k||null,this._requestSentTimestamp=_||NaN,this._requestSentWalltime=b||NaN,this._responseReceivedTimestamp=NaN,this._lastDataReceivedTimestamp=NaN,this._finishedOrFailedTimestamp=NaN,this._finishThenRequestContentPromise=null,this._statusCode=NaN,this._statusText=null,this._cached=!1,this._canceled=!1,this._finished=!1,this._failed=!1,this._failureReasonText=null,this._receivedNetworkLoadMetrics=!1,this._responseSource=WI.Resource.ResponseSource.Unknown,this._security=null,this._timingData=new WI.ResourceTimingData(this),this._protocol=null,this._priority=WI.Resource.NetworkPriority.Unknown,this._remoteAddress=null,this._connectionIdentifier=null,this._target=s?WI.targetManager.targetForIdentifier(s):WI.mainTarget,this._redirects=[],this._requestHeadersTransferSize=NaN,this._requestBodyTransferSize=NaN,this._responseHeadersTransferSize=NaN,this._responseBodyTransferSize=NaN,this._responseBodySize=NaN,this._cachedResponseBodySize=NaN,this._estimatedSize=NaN,this._estimatedTransferSize=NaN,this._estimatedResponseHeadersSize=NaN,this._initiatorSourceCodeLocation&&this._initiatorSourceCodeLocation.sourceCode instanceof WI.Resource&&this._initiatorSourceCodeLocation.sourceCode.addInitiatedResource(this)}static resolvedType(e,t){return e&&e!==WI.Resource.Type.Other?e:tc.typeFromMIMEType(t)}static typeFromMIMEType(e){return e?(e=parseMIMEType(e).type,e in WI.Resource._mimeTypeMap?WI.Resource._mimeTypeMap[e]:e.startsWith("image/")?WI.Resource.Type.Image:e.startsWith("font/")?WI.Resource.Type.Font:WI.Resource.Type.Other):WI.Resource.Type.Other}static displayNameForType(e,t){switch(e){case WI.Resource.Type.Document:return t?WI.UIString("Documents"):WI.UIString("Document");case WI.Resource.Type.Stylesheet:return t?WI.UIString("Stylesheets"):WI.UIString("Stylesheet");case WI.Resource.Type.Image:return t?WI.UIString("Images"):WI.UIString("Image");case WI.Resource.Type.Font:return t?WI.UIString("Fonts"):WI.UIString("Font");case WI.Resource.Type.Script:return t?WI.UIString("Scripts"):WI.UIString("Script");case WI.Resource.Type.XHR:return t?WI.UIString("XHRs"):WI.UIString("XHR");case WI.Resource.Type.Fetch:return t?WI.UIString("Fetches","Resources loaded via 'fetch' method"):WI.repeatedUIString.fetch();case WI.Resource.Type.Ping:return t?WI.UIString("Pings"):WI.UIString("Ping");case WI.Resource.Type.Beacon:return t?WI.UIString("Beacons"):WI.UIString("Beacon");case WI.Resource.Type.WebSocket:return t?WI.UIString("Sockets"):WI.UIString("Socket");case WI.Resource.Type.Other:return WI.UIString("Other");default:return console.error("Unknown resource type",e),null}}static classNameForResource(e){return e.type===WI.Resource.Type.Other&&e.requestedByteRange?"resource-type-range":e.type}static displayNameForProtocol(e){switch(e){case"h2":return"HTTP/2";case"http/1.0":return"HTTP/1.0";case"http/1.1":return"HTTP/1.1";case"spdy/2":return"SPDY/2";case"spdy/3":return"SPDY/3";case"spdy/3.1":return"SPDY/3.1";default:return null}}static comparePriority(e,t){console.assert(typeof e=="symbol"),console.assert(typeof t=="symbol");const i={[WI.Resource.NetworkPriority.Unknown]:0,[WI.Resource.NetworkPriority.Low]:1,[WI.Resource.NetworkPriority.Medium]:2,[WI.Resource.NetworkPriority.High]:3};let n=i[e]||0,s=i[t]||0;return n-s}static displayNameForPriority(e){switch(e){case WI.Resource.NetworkPriority.Low:return WI.UIString("Low");case WI.Resource.NetworkPriority.Medium:return WI.UIString("Medium");case WI.Resource.NetworkPriority.High:return WI.UIString("High");default:return null}}static responseSourceFromPayload(e){if(!e)return WI.Resource.ResponseSource.Unknown;switch(e){case NetworkAgent.ResponseSource.Unknown:return WI.Resource.ResponseSource.Unknown;case NetworkAgent.ResponseSource.Network:return WI.Resource.ResponseSource.Network;case NetworkAgent.ResponseSource.MemoryCache:return WI.Resource.ResponseSource.MemoryCache;case NetworkAgent.ResponseSource.DiskCache:return WI.Resource.ResponseSource.DiskCache;case NetworkAgent.ResponseSource.ServiceWorker:return WI.Resource.ResponseSource.ServiceWorker;default:return console.error("Unknown response source type",e),WI.Resource.ResponseSource.Unknown}}static networkPriorityFromPayload(e){switch(e){case NetworkAgent.MetricsPriority.Low:return WI.Resource.NetworkPriority.Low;case NetworkAgent.MetricsPriority.Medium:return WI.Resource.NetworkPriority.Medium;case NetworkAgent.MetricsPriority.High:return WI.Resource.NetworkPriority.High;default:return console.error("Unknown metrics priority",e),WI.Resource.NetworkPriority.Unknown}}static connectionIdentifierFromPayload(e){WI.Resource.connectionIdentifierMap||(WI.Resource.connectionIdentifierMap=new Map,WI.Resource.nextConnectionIdentifier=1);let t=WI.Resource.connectionIdentifierMap.get(e);return t||(t=WI.Resource.nextConnectionIdentifier++,WI.Resource.connectionIdentifierMap.set(e,t),t)}get url(){return this._url}get mimeType(){return this._mimeType}get target(){return this._target}get type(){return this._type}get loaderIdentifier(){return this._loaderIdentifier}get requestIdentifier(){return this._requestIdentifier}get requestMethod(){return this._requestMethod}get requestData(){return this._requestData}get initiatorCallFrames(){return this._initiatorCallFrames}get initiatorSourceCodeLocation(){return this._initiatorSourceCodeLocation}get initiatorNode(){return this._initiatorNode}get initiatedResources(){return this._initiatedResources}get originalRequestWillBeSentTimestamp(){return this._originalRequestWillBeSentTimestamp}get statusCode(){return this._statusCode}get statusText(){return this._statusText}get responseSource(){return this._responseSource}get security(){return this._security}get timingData(){return this._timingData}get protocol(){return this._protocol}get priority(){return this._priority}get remoteAddress(){return this._remoteAddress}get connectionIdentifier(){return this._connectionIdentifier}get parentFrame(){return this._parentFrame}get finished(){return this._finished}get failed(){return this._failed}get canceled(){return this._canceled}get failureReasonText(){return this._failureReasonText}get requestHeaders(){return this._requestHeaders}get responseHeaders(){return this._responseHeaders}get requestSentTimestamp(){return this._requestSentTimestamp}get requestSentWalltime(){return this._requestSentWalltime}get responseReceivedTimestamp(){return this._responseReceivedTimestamp}get lastDataReceivedTimestamp(){return this._lastDataReceivedTimestamp}get finishedOrFailedTimestamp(){return this._finishedOrFailedTimestamp}get cached(){return this._cached}get requestHeadersTransferSize(){return this._requestHeadersTransferSize}get requestBodyTransferSize(){return this._requestBodyTransferSize}get responseHeadersTransferSize(){return this._responseHeadersTransferSize}get responseBodyTransferSize(){return this._responseBodyTransferSize}get cachedResponseBodySize(){return this._cachedResponseBodySize}get redirects(){return this._redirects}get urlComponents(){return this._urlComponents||(this._urlComponents=parseURL(this._url)),this._urlComponents}get loadedSecurely(){return!(this.urlComponents.scheme!=="https"&&this.urlComponents.scheme!=="wss"&&this.urlComponents.scheme!=="sftp"||isNaN(this._timingData.secureConnectionStart)&&!isNaN(this._timingData.connectionStart))}get displayName(){return WI.displayNameForURL(this._url,this.urlComponents)}get displayURL(){return WI.truncateURL(this._url,!0,64)}get mimeTypeComponents(){return this._mimeTypeComponents||(this._mimeTypeComponents=parseMIMEType(this._mimeType)),this._mimeTypeComponents}get syntheticMIMEType(){if(this._type===WI.Resource.typeFromMIMEType(this._mimeType))return this._mimeType;switch(this._type){case WI.Resource.Type.Stylesheet:return"text/css";case WI.Resource.Type.Script:return"text/javascript"}return this._mimeType}createObjectURL(){let e=this.content;if(!e)return this._url;if(e instanceof Blob)return URL.createObjectURL(e);if(typeof e=="string"){let t=textToBlob(e,this._mimeType);return URL.createObjectURL(t)}return null}isMainResource(){return this._parentFrame?this._parentFrame.mainResource===this:!1}addInitiatedResource(e){e instanceof WI.Resource&&(this._initiatedResources.push(e),this.dispatchEventToListeners(WI.Resource.Event.InitiatedResourcesDidChange))}get queryStringParameters(){return this._queryStringParameters===void 0&&(this._queryStringParameters=parseQueryString(this.urlComponents.queryString,!0)),this._queryStringParameters}get requestFormParameters(){return this._requestFormParameters===void 0&&(this._requestFormParameters=this.hasRequestFormParameters()?parseQueryString(this.requestData,!0):null),this._requestFormParameters}get requestDataContentType(){return this._requestHeaders.valueForCaseInsensitiveKey("Content-Type")||null}get requestCookies(){return this._requestCookies||(this._requestCookies=WI.Cookie.parseCookieRequestHeader(this._requestHeaders.valueForCaseInsensitiveKey("Cookie"))),this._requestCookies}get responseCookies(){if(!this._responseCookies){let t=(this._responseHeaders.valueForCaseInsensitiveKey("Set-Cookie")||"").split(/, (?![0-9])/),i=[];for(let n of t){let s=WI.Cookie.parseSetCookieResponseHeader(n);s&&i.push(s)}this._responseCookies=i}return this._responseCookies}get requestSentDate(){return isNaN(this._requestSentWalltime)?null:new Date(this._requestSentWalltime*1e3)}get lastRedirectReceivedTimestamp(){return this._redirects.length?this._redirects.lastValue.timestamp:NaN}get firstTimestamp(){return this.timingData.startTime||this.lastRedirectReceivedTimestamp||this.responseReceivedTimestamp||this.lastDataReceivedTimestamp||this.finishedOrFailedTimestamp}get lastTimestamp(){return this.timingData.responseEnd||this.lastDataReceivedTimestamp||this.responseReceivedTimestamp||this.lastRedirectReceivedTimestamp||this.requestSentTimestamp}get latency(){return this.timingData.responseStart-this.timingData.requestStart}get receiveDuration(){return this.timingData.responseEnd-this.timingData.responseStart}get totalDuration(){return this.timingData.responseEnd-this.timingData.startTime}get size(){return isNaN(this._cachedResponseBodySize)?!isNaN(this._responseBodySize)&&this._responseBodySize!==0?this._responseBodySize:this._estimatedSize:this._cachedResponseBodySize}get networkEncodedSize(){return this._responseBodyTransferSize}get networkDecodedSize(){return this._responseBodySize}get networkTotalTransferSize(){return this._responseHeadersTransferSize+this._responseBodyTransferSize}get estimatedNetworkEncodedSize(){let e=this.networkEncodedSize;if(!isNaN(e))return e;if(this._cached)return 0;if(WI.Platform.name==="mac"){let t=Number(this._responseHeaders.valueForCaseInsensitiveKey("Content-Length"));if(!isNaN(t))return t}return isNaN(this._estimatedTransferSize)?Number(this._responseHeaders.valueForCaseInsensitiveKey("Content-Length")||this._estimatedSize):this._estimatedTransferSize}get estimatedTotalTransferSize(){let e=this.networkTotalTransferSize;return isNaN(e)?this.statusCode===304?this._estimatedResponseHeadersSize:this._cached?0:this._estimatedResponseHeadersSize+this.estimatedNetworkEncodedSize:e}get compressed(){let e=this._responseHeaders.valueForCaseInsensitiveKey("Content-Encoding");return!!(e&&/\b(?:gzip|deflate)\b/.test(e))}get requestedByteRange(){let e=this._requestHeaders.valueForCaseInsensitiveKey("Range");if(!e)return null;let t=e.match(/bytes=(\d+)-(\d+)/);if(!t)return null;let i=parseInt(t[1]);if(isNaN(i))return null;let n=parseInt(t[2]);return isNaN(n)?null:{start:i,end:n}}get scripts(){return this._scripts||[]}get serverTiming(){return this._serverTimingEntries||(this._serverTimingEntries=WI.ServerTimingEntry.parseHeaders(this._responseHeaders.valueForCaseInsensitiveKey("Server-Timing"))),this._serverTimingEntries}scriptForLocation(e){if(console.assert(!(this instanceof WI.SourceMapResource)),console.assert(e.sourceCode===this,"SourceCodeLocation must be in this Resource"),e.sourceCode!==this)return null;for(var t=e.lineNumber,i=e.columnNumber,n=0;n<this._scripts.length;++n){var s=this._scripts[n];if(s.range.startLine<=t&&s.range.endLine>=t){if(s.range.startLine===t&&i<s.range.startColumn||s.range.endLine===t&&i>s.range.endColumn)continue;return s}}return null}updateForRedirectResponse(e,t,i,n){console.assert(!this._finished),console.assert(!this._failed),console.assert(!this._canceled);let s=this._url,a=this._requestHeaders;e.url&&(this._url=e.url),this._requestHeaders=e.headers||{},this._requestCookies=null,this._redirects.push(new WI.Redirect(s,e.method,a,t.status,t.statusText,t.headers,i)),s!==e.url&&(this._urlComponents=null,this.dispatchEventToListeners(WI.Resource.Event.URLDidChange,{oldURL:s})),this.dispatchEventToListeners(WI.Resource.Event.RequestHeadersDidChange),this.dispatchEventToListeners(WI.Resource.Event.TimestampsDidChange)}hasResponse(){return!isNaN(this._statusCode)||this._finished||this._failed}hasRequestFormParameters(){let e=this.requestDataContentType;return e&&e.match(/^application\/x-www-form-urlencoded\s*(;.*)?$/i)}updateForResponse(e,t,i,n,s,a,d,p,f,_){console.assert(!this._finished),console.assert(!this._failed),console.assert(!this._canceled);let b=this._url,w=this._mimeType,S=this._type;i in WI.Resource.Type&&(i=WI.Resource.Type[i]),e&&(this._url=e),this._mimeType=t,this._type=tc.resolvedType(i,t),this._statusCode=s,this._statusText=a,this._responseHeaders=n||{},this._responseCookies=null,this._serverTimingEntries=null,this._responseReceivedTimestamp=d||NaN,this._timingData=WI.ResourceTimingData.fromPayload(p,this),f&&(this._responseSource=WI.Resource.responseSourceFromPayload(f)),this._security=_||{};const E=12,k=4;this._estimatedResponseHeadersSize=String(this._statusCode).length+this._statusText.length+E;for(let R in this._responseHeaders)this._estimatedResponseHeadersSize+=R.length+this._responseHeaders[R].length+k;this._cached||(s===304||this._responseSource===WI.Resource.ResponseSource.MemoryCache||this._responseSource===WI.Resource.ResponseSource.DiskCache)&&this.markAsCached(),b!==e&&(this._urlComponents=null,this.dispatchEventToListeners(WI.Resource.Event.URLDidChange,{oldURL:b})),w!==t&&(this._mimeTypeComponents=null,this.dispatchEventToListeners(WI.Resource.Event.MIMETypeDidChange,{oldMIMEType:w})),S!==i&&this.dispatchEventToListeners(WI.Resource.Event.TypeDidChange,{oldType:S}),console.assert(isNaN(this._estimatedSize)),console.assert(isNaN(this._estimatedTransferSize)),(s===304||this._responseHeaders.valueForCaseInsensitiveKey("Content-Length"))&&this.dispatchEventToListeners(WI.Resource.Event.TransferSizeDidChange),this.dispatchEventToListeners(WI.Resource.Event.ResponseReceived),this.dispatchEventToListeners(WI.Resource.Event.TimestampsDidChange)}updateWithMetrics(e){this._receivedNetworkLoadMetrics=!0,e.protocol&&(this._protocol=e.protocol),e.priority&&(this._priority=WI.Resource.networkPriorityFromPayload(e.priority)),e.remoteAddress&&(this._remoteAddress=e.remoteAddress),e.connectionIdentifier&&(this._connectionIdentifier=WI.Resource.connectionIdentifierFromPayload(e.connectionIdentifier)),e.requestHeaders&&(this._requestHeaders=e.requestHeaders,this._requestCookies=null,this.dispatchEventToListeners(WI.Resource.Event.RequestHeadersDidChange)),"requestHeaderBytesSent"in e&&(this._requestHeadersTransferSize=e.requestHeaderBytesSent,this._requestBodyTransferSize=e.requestBodyBytesSent,this._responseHeadersTransferSize=e.responseHeaderBytesReceived,this._responseBodyTransferSize=e.responseBodyBytesReceived,this._responseBodySize=e.responseBodyDecodedSize,console.assert(this._requestHeadersTransferSize>=0),console.assert(this._requestBodyTransferSize>=0),console.assert(this._responseHeadersTransferSize>=0),console.assert(this._responseBodyTransferSize>=0),console.assert(this._responseBodySize>=0),isNaN(this._estimatedSize)&&(this._estimatedSize=0),this.dispatchEventToListeners(WI.Resource.Event.SizeDidChange,{previousSize:this._estimatedSize}),this.dispatchEventToListeners(WI.Resource.Event.TransferSizeDidChange)),e.securityConnection&&(this._security||(this._security={}),this._security.connection=e.securityConnection),this.dispatchEventToListeners(WI.Resource.Event.MetricsDidChange)}setCachedResponseBodySize(e){console.assert(!isNaN(e),"Size should be a valid number."),console.assert(isNaN(this._cachedResponseBodySize),"This should only be set once."),console.assert(this._estimatedSize===e,"The legacy path was updated already and matches."),this._cachedResponseBodySize=e}requestContentFromBackend(){return this._requestIdentifier?NetworkAgent.getResponseBody(this._requestIdentifier):this._parentFrame?PageAgent.getResourceContent(this._parentFrame.id,this._url):Promise.reject(new Error("Content request failed."))}increaseSize(e,t){console.assert(e>=0),console.assert(!this._receivedNetworkLoadMetrics,"If we received metrics we don't need to change the estimated size."),isNaN(this._estimatedSize)&&(this._estimatedSize=0);let i=this._estimatedSize;this._estimatedSize+=e,this._lastDataReceivedTimestamp=t||NaN,this.dispatchEventToListeners(WI.Resource.Event.SizeDidChange,{previousSize:i}),isNaN(this._estimatedTransferSize)&&this._statusCode!==304&&!this._responseHeaders.valueForCaseInsensitiveKey("Content-Length")&&this.dispatchEventToListeners(WI.Resource.Event.TransferSizeDidChange)}increaseTransferSize(e){console.assert(e>=0),console.assert(!this._receivedNetworkLoadMetrics,"If we received metrics we don't need to change the estimated transfer size."),isNaN(this._estimatedTransferSize)&&(this._estimatedTransferSize=0),this._estimatedTransferSize+=e,this.dispatchEventToListeners(WI.Resource.Event.TransferSizeDidChange)}markAsCached(){this._cached=!0,this.dispatchEventToListeners(WI.Resource.Event.CacheStatusDidChange),this._statusCode!==304&&this.dispatchEventToListeners(WI.Resource.Event.TransferSizeDidChange)}markAsFinished(e){console.assert(!this._failed),console.assert(!this._canceled),this._finished=!0,this._finishedOrFailedTimestamp=e||NaN,this._timingData.markResponseEndTime(e||NaN),this._finishThenRequestContentPromise&&(this._finishThenRequestContentPromise=null),this.dispatchEventToListeners(WI.Resource.Event.LoadingDidFinish),this.dispatchEventToListeners(WI.Resource.Event.TimestampsDidChange)}markAsFailed(e,t,i){console.assert(!this._finished),this._failed=!0,this._canceled=e,this._finishedOrFailedTimestamp=t||NaN,this._failureReasonText||(this._failureReasonText=i||null),this.dispatchEventToListeners(WI.Resource.Event.LoadingDidFail),this.dispatchEventToListeners(WI.Resource.Event.TimestampsDidChange)}revertMarkAsFinished(){console.assert(!this._failed),console.assert(!this._canceled),console.assert(this._finished),this._finished=!1,this._finishedOrFailedTimestamp=NaN}legacyMarkServedFromMemoryCache(){console.assert(this._responseSource===WI.Resource.ResponseSource.Unknown),this._responseSource=WI.Resource.ResponseSource.MemoryCache,this.markAsCached()}legacyMarkServedFromDiskCache(){console.assert(this._responseSource===WI.Resource.ResponseSource.Unknown),this._responseSource=WI.Resource.ResponseSource.DiskCache,this.markAsCached()}isLoading(){return!this._finished&&!this._failed}hadLoadingError(){return this._failed||this._canceled||this._statusCode>=400}getImageSize(e){if(this.type!==WI.Resource.Type.Image)throw"Resource is not an image.";if(this._imageSize!==void 0){e(this._imageSize);return}var t=null;function i(){URL.revokeObjectURL(t),this._imageSize={width:s.width,height:s.height},e(this._imageSize)}function n(){this._imageSize=null,e(this._imageSize)}var s=new Image;s.addEventListener("load",i.bind(this),!1),this.requestContent().then(a=>{t=s.src=a.sourceCode.createObjectURL(),t||n.call(this)},n.bind(this))}requestContent(){return this._finished?super.requestContent():this._failed?Promise.resolve({error:WI.UIString("An error occurred trying to load the resource.")}):(this._finishThenRequestContentPromise||(this._finishThenRequestContentPromise=new Promise((e,t)=>{this.addEventListener(WI.Resource.Event.LoadingDidFinish,e),this.addEventListener(WI.Resource.Event.LoadingDidFail,t)}).then(WI.SourceCode.prototype.requestContent.bind(this))),this._finishThenRequestContentPromise)}associateWithScript(e){if(this._scripts||(this._scripts=[]),this._scripts.push(e),this._type===WI.Resource.Type.Other||this._type===WI.Resource.Type.XHR){let t=this._type;this._type=WI.Resource.Type.Script,this.dispatchEventToListeners(WI.Resource.Event.TypeDidChange,{oldType:t})}}saveIdentityToCookie(e){e[WI.Resource.URLCookieKey]=this.url.hash,e[WI.Resource.MainResourceCookieKey]=this.isMainResource()}generateCURLCommand(){function e(i){function n(s){let a=s.charCodeAt(0),d=a.toString(16);return a<256?"\\x"+d.padStart(2,"0"):"\\u"+d.padStart(4,"0")}return/[^\x20-\x7E]|'/.test(i)?"$'"+i.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/!/g,"\\041").replace(/[^\x20-\x7E]/g,n)+"'":`'${i}'`}let t=["curl "+e(this.url).replace(/[[{}\]]/g,"\\$&")];t.push(`-X${this.requestMethod}`);for(let i in this.requestHeaders)t.push("-H "+e(`${i}: ${this.requestHeaders[i]}`));return this.requestDataContentType&&this.requestMethod!=="GET"&&this.requestData&&(this.requestDataContentType.match(/^application\/x-www-form-urlencoded\s*(;.*)?$/i)?t.push("--data "+e(this.requestData)):t.push("--data-binary "+e(this.requestData))),t.join(` \\
`)}stringifyHTTPRequest(){let e=[],t=this.protocol||"";t==="h2"?(e.push(`:method: ${this.requestMethod}`),e.push(`:scheme: ${this.urlComponents.scheme}`),e.push(`:authority: ${WI.h2Authority(this.urlComponents)}`),e.push(`:path: ${WI.h2Path(this.urlComponents)}`)):e.push(`${this.requestMethod} ${this.urlComponents.path}${t?" "+t.toUpperCase():""}`);for(let i in this.requestHeaders)e.push(`${i}: ${this.requestHeaders[i]}`);return e.join(`
`)+`
`}stringifyHTTPResponse(){let e=[],t=this.protocol||"";t==="h2"?e.push(`:status: ${this.statusCode}`):e.push(`${t?t.toUpperCase()+" ":""}${this.statusCode} ${this.statusText}`);for(let i in this.responseHeaders)e.push(`${i}: ${this.responseHeaders[i]}`);return e.join(`
`)+`
`}async showCertificate(){let e=WI.UIString("Unable to show certificate for \u201C%s\u201D").format(this.url);try{let{serializedCertificate:i}=await NetworkAgent.getSerializedCertificate(this._requestIdentifier);if(InspectorFrontendHost.showCertificate(i))return}catch(i){throw console.error(i),e}let t=new WI.ConsoleMessage(this._target,WI.ConsoleMessage.MessageSource.Other,WI.ConsoleMessage.MessageLevel.Error,e);throw t.shouldRevealConsole=!0,WI.consoleLogViewController.appendConsoleMessage(t),e}};WI.Resource.TypeIdentifier="resource";WI.Resource.URLCookieKey="resource-url";WI.Resource.MainResourceCookieKey="resource-is-main-resource";WI.Resource.Event={URLDidChange:"resource-url-did-change",MIMETypeDidChange:"resource-mime-type-did-change",TypeDidChange:"resource-type-did-change",RequestHeadersDidChange:"resource-request-headers-did-change",ResponseReceived:"resource-response-received",LoadingDidFinish:"resource-loading-did-finish",LoadingDidFail:"resource-loading-did-fail",TimestampsDidChange:"resource-timestamps-did-change",SizeDidChange:"resource-size-did-change",TransferSizeDidChange:"resource-transfer-size-did-change",CacheStatusDidChange:"resource-cached-did-change",MetricsDidChange:"resource-metrics-did-change",InitiatedResourcesDidChange:"resource-initiated-resources-did-change"};WI.Resource.Type={Document:"resource-type-document",Stylesheet:"resource-type-stylesheet",Image:"resource-type-image",Font:"resource-type-font",Script:"resource-type-script",XHR:"resource-type-xhr",Fetch:"resource-type-fetch",Ping:"resource-type-ping",Beacon:"resource-type-beacon",WebSocket:"resource-type-websocket",Other:"resource-type-other"};WI.Resource.ResponseSource={Unknown:Symbol("unknown"),Network:Symbol("network"),MemoryCache:Symbol("memory-cache"),DiskCache:Symbol("disk-cache"),ServiceWorker:Symbol("service-worker")};WI.Resource.NetworkPriority={Unknown:Symbol("unknown"),Low:Symbol("low"),Medium:Symbol("medium"),High:Symbol("high")};WI.Resource.GroupingMode={Path:"group-resource-by-path",Type:"group-resource-by-type"};WI.settings.resourceGroupingMode=new WI.Setting("resource-grouping-mode",WI.Resource.GroupingMode.Type);WI.Resource._mimeTypeMap={"text/html":WI.Resource.Type.Document,"text/xml":WI.Resource.Type.Document,"text/plain":WI.Resource.Type.Document,"application/xhtml+xml":WI.Resource.Type.Document,"text/css":WI.Resource.Type.Stylesheet,"text/xsl":WI.Resource.Type.Stylesheet,"text/x-less":WI.Resource.Type.Stylesheet,"text/x-sass":WI.Resource.Type.Stylesheet,"text/x-scss":WI.Resource.Type.Stylesheet,"application/pdf":WI.Resource.Type.Image,"image/svg+xml":WI.Resource.Type.Image,"application/x-font-type1":WI.Resource.Type.Font,"application/x-font-ttf":WI.Resource.Type.Font,"application/x-font-woff":WI.Resource.Type.Font,"application/x-truetype-font":WI.Resource.Type.Font,"text/javascript":WI.Resource.Type.Script,"text/ecmascript":WI.Resource.Type.Script,"application/javascript":WI.Resource.Type.Script,"application/ecmascript":WI.Resource.Type.Script,"application/x-javascript":WI.Resource.Type.Script,"application/json":WI.Resource.Type.Script,"application/x-json":WI.Resource.Type.Script,"text/x-javascript":WI.Resource.Type.Script,"text/x-json":WI.Resource.Type.Script,"text/javascript1.1":WI.Resource.Type.Script,"text/javascript1.2":WI.Resource.Type.Script,"text/javascript1.3":WI.Resource.Type.Script,"text/jscript":WI.Resource.Type.Script,"text/livescript":WI.Resource.Type.Script,"text/x-livescript":WI.Resource.Type.Script,"text/typescript":WI.Resource.Type.Script,"text/typescript-jsx":WI.Resource.Type.Script,"text/jsx":WI.Resource.Type.Script,"text/x-clojure":WI.Resource.Type.Script,"text/x-coffeescript":WI.Resource.Type.Script};WI.Script=class extends WI.SourceCode{constructor(e,t,i,n,s,a,d,p){if(super(),console.assert(e instanceof WI.Target),console.assert(i instanceof WI.TextRange),this._target=e,this._id=t||null,this._range=i||null,this._url=n||null,this._sourceType=s||WI.Script.SourceType.Program,this._sourceURL=d||null,this._sourceMappingURL=p||null,this._injected=a||!1,this._dynamicallyAddedScriptElement=!1,this._scriptSyntaxTree=null,this._resource=this._resolveResource(),this._resource&&this._resource.type===WI.Resource.Type.Document&&!this._range.startLine&&!this._range.startColumn){console.assert(this._resource.isMainResource());let f=this._resource;this._resource=null,this._dynamicallyAddedScriptElement=!0,f.parentFrame.addExtraScript(this),this._dynamicallyAddedScriptElementNumber=f.parentFrame.extraScriptCollection.size}else this._resource&&this._resource.associateWithScript(this);isWebInspectorConsoleEvaluationScript(this._sourceURL)&&(this._uniqueDisplayNameNumber=this.constructor._nextUniqueConsoleDisplayNameNumber++),this._sourceMappingURL&&WI.networkManager.downloadSourceMap(this._sourceMappingURL,this._url,this)}static resetUniqueDisplayNameNumbers(){WI.Script._nextUniqueDisplayNameNumber=1,WI.Script._nextUniqueConsoleDisplayNameNumber=1}get target(){return this._target}get id(){return this._id}get range(){return this._range}get url(){return this._url}get sourceType(){return this._sourceType}get sourceURL(){return this._sourceURL}get sourceMappingURL(){return this._sourceMappingURL}get injected(){return this._injected}get contentIdentifier(){return this._url?this._url:!this._sourceURL||isWebInspectorConsoleEvaluationScript(this._sourceURL)||isWebInspectorInternalScript(this._sourceURL)?null:this._sourceURL}get urlComponents(){return this._urlComponents||(this._urlComponents=parseURL(this._url)),this._urlComponents}get mimeType(){return this._resource.mimeType}get displayName(){return this._url&&!this._dynamicallyAddedScriptElement?WI.displayNameForURL(this._url,this.urlComponents):isWebInspectorConsoleEvaluationScript(this._sourceURL)?(console.assert(this._uniqueDisplayNameNumber),WI.UIString("Console Evaluation %d").format(this._uniqueDisplayNameNumber)):this._sourceURL?(this._sourceURLComponents||(this._sourceURLComponents=parseURL(this._sourceURL)),WI.displayNameForURL(this._sourceURL,this._sourceURLComponents)):this._dynamicallyAddedScriptElement?WI.UIString("Script Element %d").format(this._dynamicallyAddedScriptElementNumber):(this._uniqueDisplayNameNumber||(this._uniqueDisplayNameNumber=this.constructor._nextUniqueDisplayNameNumber++),WI.UIString("Anonymous Script %d").format(this._uniqueDisplayNameNumber))}get displayURL(){return this._url?WI.truncateURL(this._url,!0,64):this._sourceURL?WI.truncateURL(this._sourceURL,!0,64):null}get dynamicallyAddedScriptElement(){return this._dynamicallyAddedScriptElement}get anonymous(){return!this._resource&&!this._url&&!this._sourceURL}get resource(){return this._resource}get scriptSyntaxTree(){return this._scriptSyntaxTree}isMainResource(){return this._target.mainResource===this}requestContentFromBackend(){return this._id?this._target.DebuggerAgent.getScriptSource(this._id):Promise.reject(new Error("There is no identifier to request content with."))}saveIdentityToCookie(e){e[WI.Script.URLCookieKey]=this.url,e[WI.Script.DisplayNameCookieKey]=this.displayName}requestScriptSyntaxTree(e){if(this._scriptSyntaxTree){setTimeout(()=>{e(this._scriptSyntaxTree)},0);return}var t=n=>{this._makeSyntaxTree(n),e(this._scriptSyntaxTree)},i=this.content;if(!i&&this._resource&&this._resource.type===WI.Resource.Type.Script&&this._resource.finished&&(i=this._resource.content),i){setTimeout(t,0,i);return}this.requestContent().then(function(n){t(n.sourceCode.content)}).catch(function(n){t(null)})}_resolveResource(){if(!this._url)return null;let e=WI.networkManager;this._target!==WI.mainTarget&&(e=this._target.resourceCollection);try{let t=e.resourceForURL(this._url);if(t)return t;let i=decodeURI(this._url);if(i!==this._url&&(t=e.resourceForURL(i),t))return t;let n=removeURLFragment(this._url);if(n!==this._url&&(t=e.resourceForURL(n),t))return t;let s=removeURLFragment(i);if(s!==i&&(t=e.resourceForURL(s),t))return t}catch{}if(!this.isMainResource()){for(let t of WI.networkManager.frames)if(t.mainResource.type===WI.Resource.Type.Document&&t.mainResource.url.startsWith(this._url))return t.mainResource}return null}_makeSyntaxTree(e){this._scriptSyntaxTree||!e||(this._scriptSyntaxTree=new WI.ScriptSyntaxTree(e,this))}};WI.Script.SourceType={Program:"script-source-type-program",Module:"script-source-type-module"};WI.Script.TypeIdentifier="script";WI.Script.URLCookieKey="script-url";WI.Script.DisplayNameCookieKey="script-display-name";WI.Script._nextUniqueDisplayNameNumber=1;WI.Script._nextUniqueConsoleDisplayNameNumber=1;WI.LocalScript=class extends WI.Script{constructor(e,t,i,n){super(e,null,WI.TextRange.fromText(n),t,i),this._text=n}requestContentFromBackend(){return Promise.resolve({scriptSource:this._text})}};WI.ApplicationCacheFrame=class{constructor(e,t,i){console.assert(e instanceof WI.Frame),console.assert(t instanceof WI.ApplicationCacheManifest),this._frame=e,this._manifest=t,this._status=i}get frame(){return this._frame}get manifest(){return this._manifest}get status(){return this._status}set status(e){this._status=e}saveIdentityToCookie(e){e[WI.ApplicationCacheFrame.FrameURLCookieKey]=this.frame.url,e[WI.ApplicationCacheFrame.ManifestURLCookieKey]=this.manifest.manifestURL}};WI.ApplicationCacheFrame.TypeIdentifier="application-cache-frame";WI.ApplicationCacheFrame.FrameURLCookieKey="application-cache-frame-url";WI.ApplicationCacheFrame.ManifestURLCookieKey="application-cache-frame-manifest-url";WI.ApplicationCacheManifest=class{constructor(e){this._manifestURL=e}get manifestURL(){return this._manifestURL}};WI.BackForwardEntry=class{constructor(e,t){this._contentView=e,this._tombstone=!1,this._cookie=t||{},this._scrollPositions=[],e.saveToCookie(this._cookie)}makeCopy(e){let t=new WI.BackForwardEntry(this._contentView,e||this.cookie);return t._tombstone=this._tombstone,t._scrollPositions=this._scrollPositions.slice(),t}get contentView(){return this._contentView}get cookie(){return Object.shallowCopy(this._cookie)}get tombstone(){return this._tombstone}set tombstone(e){this._tombstone=e}prepareToShow(e){console.assert(!this._tombstone,"Should not be calling shown on a tombstone"),this._restoreFromCookie(),this.contentView.visible=!0,e&&this.contentView.shown(),this.contentView.needsLayout()}prepareToHide(){console.assert(!this._tombstone,"Should not be calling hidden on a tombstone"),this.contentView.visible=!1,this.contentView.hidden(),this._saveScrollPositions(),this._contentView.shouldSaveStateWhenHidden&&(this._cookie={},this._contentView.saveToCookie(this._cookie))}isEqual(e){return e?this._contentView===e._contentView&&Object.shallowEqual(this._cookie,e._cookie):!1}_restoreFromCookie(){this._restoreScrollPositions(),this.contentView.restoreFromCookie(this.cookie)}_restoreScrollPositions(){if(!!this._scrollPositions.length){var e=this.contentView.scrollableElements||[];console.assert(this._scrollPositions.length===e.length);for(var t=0;t<e.length;++t){var i=this._scrollPositions[t],n=e[t];!n||(n.scrollTop=i.isScrolledToBottom?n.scrollHeight:i.scrollTop,n.scrollLeft=i.isScrolledToBottom?0:i.scrollLeft)}}}_saveScrollPositions(){for(var e=this.contentView.scrollableElements||[],t=[],i=0;i<e.length;++i){var n=e[i];if(!n)continue;let s={scrollTop:n.scrollTop,scrollLeft:n.scrollLeft};this.contentView.shouldKeepElementsScrolledToBottom&&(s.isScrolledToBottom=n.isScrolledToBottom()),t.push(s)}this._scrollPositions=t}};WI.Branch=class{constructor(e,t,i){console.assert(e),this._displayName=e,this._revisions=t instanceof Array?t.slice():[],this._locked=i||!1}get displayName(){return this._displayName}set displayName(e){console.assert(e),e&&(this._displayName=e)}get revisions(){return this._revisions}get locked(){return this._locked}revisionForRepresentedObject(e,t){for(var i=0;i<this._revisions.length;++i){var n=this._revisions[i];if(n instanceof WI.SourceCodeRevision&&n.sourceCode===e)return n}if(t)return null;if(e instanceof WI.SourceCode){var n=e.originalRevision.copy();return e.currentRevision=n,this.addRevision(n),n}return null}addRevision(e){console.assert(e instanceof WI.Revision),!this._locked&&(this._revisions.includes(e)||this._revisions.push(e))}removeRevision(e){console.assert(e instanceof WI.Revision),!this._locked&&this._revisions.remove(e)}reset(){this._locked||(this._revisions=[])}fork(e){var t=this._revisions.map(function(i){return i.copy()});return new WI.Branch(e,t)}apply(){for(var e=0;e<this._revisions.length;++e)this._revisions[e].apply()}revert(){for(var e=this._revisions.length-1;e>=0;--e)this._revisions[e].revert()}lock(){console.assert(!this._locked),this._locked=!0}unlock(){console.assert(this._locked),this._locked=!1}};WI.Breakpoint=class cp extends WI.Object{constructor(e,{contentIdentifier:t,disabled:i,condition:n,ignoreCount:s,autoContinue:a}={}){console.assert(e instanceof WI.SourceCodeLocation),console.assert(!t||typeof t=="string"),console.assert(!i||typeof i=="boolean"),console.assert(!n||typeof n=="string"),console.assert(!s||!isNaN(s)),console.assert(!a||typeof a=="boolean"),super(),this._id=null,this._sourceCodeLocation=e;let d=this._sourceCodeLocation.sourceCode;d?(this._contentIdentifier=d.contentIdentifier,console.assert(!t||t===this._contentIdentifier,"The content identifier from the source code should match the given value.")):this._contentIdentifier=t||null,console.assert(this._contentIdentifier||this._isSpecial(),"There should always be a content identifier for a breakpoint."),this._scriptIdentifier=d instanceof WI.Script?d.id:null,this._target=d instanceof WI.Script?d.target:null,this._disabled=i||!1,this._condition=n||"",this._ignoreCount=s||0,this._autoContinue=a||!1,this._actions=[],this._resolved=!1,this._sourceCodeLocation.addEventListener(WI.SourceCodeLocation.Event.LocationChanged,this._sourceCodeLocationLocationChanged,this),this._sourceCodeLocation.addEventListener(WI.SourceCodeLocation.Event.DisplayLocationChanged,this._sourceCodeLocationDisplayLocationChanged,this)}static fromJSON(e){let i=new cp(new WI.SourceCodeLocation(null,e.lineNumber||0,e.columnNumber||0),{contentIdentifier:e.contentIdentifier||e.url,disabled:e.disabled,condition:e.condition,ignoreCount:e.ignoreCount,autoContinue:e.autoContinue});return i._actions=e.actions.map(n=>WI.BreakpointAction.fromJSON(n,i)),i}toJSON(e){let t={contentIdentifier:this._contentIdentifier,lineNumber:this._sourceCodeLocation.lineNumber,columnNumber:this._sourceCodeLocation.columnNumber,disabled:this._disabled,condition:this._condition,ignoreCount:this._ignoreCount,actions:this._actions.map(i=>i.toJSON()),autoContinue:this._autoContinue};return e===WI.ObjectStore.toJSONSymbol&&(t[WI.objectStores.breakpoints.keyPath]=this._contentIdentifier+":"+this._sourceCodeLocation.lineNumber+":"+this._sourceCodeLocation.columnNumber),t}get sourceCodeLocation(){return this._sourceCodeLocation}get contentIdentifier(){return this._contentIdentifier}get scriptIdentifier(){return this._scriptIdentifier}get target(){return this._target}get identifier(){return this._id}set identifier(e){this._id=e||null}get resolved(){return this._resolved}set resolved(e){this._resolved!==e&&(console.assert(!e||this._sourceCodeLocation.sourceCode||this._isSpecial(),"Breakpoints must have a SourceCode to be resolved.",this),this._resolved=e||!1,this.dispatchEventToListeners(WI.Breakpoint.Event.ResolvedStateDidChange))}get disabled(){return this._disabled}set disabled(e){this._disabled!==e&&(this._disabled=e||!1,this.dispatchEventToListeners(WI.Breakpoint.Event.DisabledStateDidChange))}get condition(){return this._condition}set condition(e){this._condition!==e&&(this._condition=e,this.dispatchEventToListeners(WI.Breakpoint.Event.ConditionDidChange))}get ignoreCount(){return this._ignoreCount}set ignoreCount(e){console.assert(e>=0,"Ignore count cannot be negative."),!(e<0)&&this._ignoreCount!==e&&(this._ignoreCount=e,this.dispatchEventToListeners(WI.Breakpoint.Event.IgnoreCountDidChange))}get autoContinue(){return this._autoContinue}set autoContinue(e){this._autoContinue!==e&&(this._autoContinue=e,this.dispatchEventToListeners(WI.Breakpoint.Event.AutoContinueDidChange))}get actions(){return this._actions}get probeActions(){return this._actions.filter(function(e){return e.type===WI.BreakpointAction.Type.Probe})}cycleToNextMode(){if(this.disabled){this.autoContinue=!1,this.disabled=!1;return}if(this.autoContinue){this.disabled=!0;return}if(this.actions.length){this.autoContinue=!0;return}this.disabled=!0}createAction(e,t,i){var n=new WI.BreakpointAction(this,e,i||null);if(!t)this._actions.push(n);else{var s=this._actions.indexOf(t);console.assert(s!==-1),s===-1?this._actions.push(n):this._actions.splice(s+1,0,n)}return this.dispatchEventToListeners(WI.Breakpoint.Event.ActionsDidChange),n}recreateAction(e,t){let i=this._actions.indexOf(t);if(console.assert(i!==-1),i===-1)return null;const n=null;let s=new WI.BreakpointAction(this,e,n);return this._actions[i]=s,this.dispatchEventToListeners(WI.Breakpoint.Event.ActionsDidChange),s}removeAction(e){var t=this._actions.indexOf(e);console.assert(t!==-1),t!==-1&&(this._actions.splice(t,1),this._actions.length||(this.autoContinue=!1),this.dispatchEventToListeners(WI.Breakpoint.Event.ActionsDidChange))}clearActions(e){e?this._actions=this._actions.filter(function(t){return t.type!==e}):this._actions=[],this.dispatchEventToListeners(WI.Breakpoint.Event.ActionsDidChange)}saveIdentityToCookie(e){e["breakpoint-content-identifier"]=this._contentIdentifier,e["breakpoint-line-number"]=this._sourceCodeLocation.lineNumber,e["breakpoint-column-number"]=this._sourceCodeLocation.columnNumber}breakpointActionDidChange(e){var t=this._actions.indexOf(e);console.assert(t!==-1),t!==-1&&this.dispatchEventToListeners(WI.Breakpoint.Event.ActionsDidChange)}_isSpecial(){return this._sourceCodeLocation.isEqual(new WI.SourceCodeLocation(null,1/0,1/0))}_sourceCodeLocationLocationChanged(e){this.dispatchEventToListeners(WI.Breakpoint.Event.LocationDidChange,e.data)}_sourceCodeLocationDisplayLocationChanged(e){this.dispatchEventToListeners(WI.Breakpoint.Event.DisplayLocationDidChange,e.data)}};WI.Breakpoint.TypeIdentifier="breakpoint";WI.Breakpoint.Event={DisabledStateDidChange:"breakpoint-disabled-state-did-change",ResolvedStateDidChange:"breakpoint-resolved-state-did-change",ConditionDidChange:"breakpoint-condition-did-change",IgnoreCountDidChange:"breakpoint-ignore-count-did-change",ActionsDidChange:"breakpoint-actions-did-change",AutoContinueDidChange:"breakpoint-auto-continue-did-change",LocationDidChange:"breakpoint-location-did-change",DisplayLocationDidChange:"breakpoint-display-location-did-change"};WI.CPUInstrument=class extends WI.Instrument{constructor(){super(),console.assert(WI.CPUInstrument.supported())}static supported(){return InspectorBackend.domains.CPUProfiler}get timelineRecordType(){return WI.TimelineRecord.Type.CPU}startInstrumentation(e){e||CPUProfilerAgent.startTracking()}stopInstrumentation(e){e||CPUProfilerAgent.stopTracking()}};WI.CPUTimeline=class extends WI.Timeline{addRecord(e,t={}){let i=this.records.lastValue;if(i){let n=i.endTime;t.discontinuity&&(n=t.discontinuity.endTime),e.adjustStartTime(n)}super.addRecord(e,t)}};WI.CPUTimelineRecord=class up extends WI.TimelineRecord{constructor({timestamp:e,usage:t,threads:i}){super(WI.TimelineRecord.Type.CPU,e-up.samplingRatePerSecond,e),console.assert(typeof e=="number"),console.assert(typeof t=="number"),console.assert(t>=0),console.assert(i===void 0||Array.isArray(i)),this._timestamp=e,this._usage=t,this._threads=i||[],this._mainThreadUsage=0,this._webkitThreadUsage=0,this._workerThreadUsage=0,this._unknownThreadUsage=0,this._workersData=null;for(let n of this._threads){if(n.type===InspectorBackend.domains.CPUProfiler.ThreadInfoType.Main){console.assert(!this._mainThreadUsage,"There should only be one main thread."),this._mainThreadUsage+=n.usage;continue}if(n.type===InspectorBackend.domains.CPUProfiler.ThreadInfoType.WebKit){if(n.targetId){this._workersData||(this._workersData=[]),this._workersData.push(n),this._workerThreadUsage+=n.usage;continue}this._webkitThreadUsage+=n.usage;continue}this._unknownThreadUsage+=n.usage}}static get samplingRatePerSecond(){return .5}static fromJSON(e){return new WI.CPUTimelineRecord(e)}toJSON(){return{type:this.type,timestamp:this._timestamp,usage:this._usage,threads:this._threads}}get timestamp(){return this._timestamp}get usage(){return this._usage}get mainThreadUsage(){return this._mainThreadUsage}get webkitThreadUsage(){return this._webkitThreadUsage}get workerThreadUsage(){return this._workerThreadUsage}get unknownThreadUsage(){return this._unknownThreadUsage}get workersData(){return this._workersData}adjustStartTime(e){console.assert(e<this._endTime),this._startTime=e}};WI.CSSCompletions=class{constructor(e,t){if(this._values=[],this._shorthands={},e.length&&typeof e[0]=="string")this._values=this._values.concat(e);else for(var i of e){var n=i.name;console.assert(n),this._values.push(n);let f=i.aliases;f&&(this._values=this._values.concat(f));var s=i.longhands;if(s)for(var a=0;a<s.length;++a){var d=s[a],p=this._shorthands[d];p||(p=[],this._shorthands[d]=p),p.push(n)}}this._values.sort(),this._acceptEmptyPrefix=t}static initializeCSSCompletions(e){if(console.assert(e.CSSAgent),WI.CSSCompletions.cssNameCompletions)return;function t(n,s){if(n||(WI.CSSCompletions.cssNameCompletions=new WI.CSSCompletions(s,!1),WI.CSSKeywordCompletions.addCustomCompletions(s),!window.CodeMirror))return;var a={},d={inherit:!0,initial:!0,unset:!0,revert:!0,var:!0,env:!0},p={};function f(R){return R.replace(/^-[^-]+-/,"").replace(/\(\)$/,"").toLowerCase()}function _(R){var M=f(R);a[M]=!0,d[M]=!0}for(var b of s)_(b.name);for(var w in WI.CSSKeywordCompletions._propertyKeywordMap)for(var S=WI.CSSKeywordCompletions._propertyKeywordMap[w],E=0;E<S.length;++E)S[E]===WI.CSSKeywordCompletions.AllPropertyNamesPlaceholder||!isNaN(Number(S[E]))||(d[f(S[E])]=!0);WI.CSSKeywordCompletions._colors.forEach(function(R){p[f(R)]=!0});function k(R){var M=CodeMirror.resolveMode(R);console.assert(M.propertyKeywords),console.assert(M.valueKeywords),console.assert(M.colorKeywords),M.propertyKeywords=a,M.valueKeywords=d,M.colorKeywords=p,CodeMirror.defineMIME(R,M)}k("text/css"),k("text/x-scss")}function i(n,s){n||(WI.CSSKeywordCompletions.addPropertyCompletionValues("font-family",s),WI.CSSKeywordCompletions.addPropertyCompletionValues("font",s))}e.CSSAgent.getSupportedCSSProperties(t),e.CSSAgent.getSupportedSystemFontFamilyNames&&e.CSSAgent.getSupportedSystemFontFamilyNames(i)}static completeUnbalancedValue(e){const t={Data:0,SingleQuoteString:1,DoubleQuoteString:2,Comment:3};let i=t.Data,n=0,s=!1,a=e.length;for(let p=0;p<a;++p)switch(e[p]){case"'":i===t.Data?i=t.SingleQuoteString:i===t.SingleQuoteString&&(i=t.Data);break;case'"':i===t.Data?i=t.DoubleQuoteString:i===t.DoubleQuoteString&&(i=t.Data);break;case"(":i===t.Data&&++n;break;case")":i===t.Data&&n&&--n;break;case"/":i===t.Data&&e[p+1]==="*"&&(i=t.Comment);break;case"\\":p===a-1?s=!0:++p;break;case"*":i===t.Comment&&e[p+1]==="/"&&(i=t.Data);break}let d="";switch(s&&(d+="\\"),i){case t.SingleQuoteString:d+="'";break;case t.DoubleQuoteString:d+='"';break;case t.Comment:d+="*/";break}return d+=")".repeat(n),d}get values(){return this._values}startsWith(e){if(!e)return this._acceptEmptyPrefix?this._values.slice():[];let t=this._firstIndexOfPrefix(e);if(t===-1)return[];let i=[];for(;t<this._values.length&&this._values[t].startsWith(e);)i.push(this._values[t++]);return i}_firstIndexOfPrefix(e){if(!this._values.length)return-1;if(!e)return this._acceptEmptyPrefix?0:-1;var t=this._values.length-1,i=0,n;do{var s=t+i>>1;if(this._values[s].startsWith(e)){n=s;break}this._values[s]<e?i=s+1:t=s-1}while(i<=t);if(n===void 0)return-1;for(;n&&this._values[n-1].startsWith(e);)n--;return n}next(e,t){return this._closest(e,t,1)}previous(e,t){return this._closest(e,t,-1)}_closest(e,t,i){if(!e)return"";var n=this._values.indexOf(e);if(n===-1)return"";if(!t)return n=(n+this._values.length+i)%this._values.length,this._values[n];var s=this.startsWith(t),a=s.indexOf(e);return a=(a+s.length+i)%s.length,s[a]}isShorthandPropertyName(e){return WI.CSSKeywordCompletions.LonghandNamesForShorthandProperty.has(e)}shorthandsForLonghand(e){return this._shorthands[e]||[]}isValidPropertyName(e){return this._values.includes(e)}};WI.CSSCompletions.cssNameCompletions=null;WI.CSSKeywordCompletions={};WI.CSSKeywordCompletions.forProperty=function(c){let e=["initial","unset","revert","var()","env()"];function t(s){let a=s.charAt(0)!=="-";s in WI.CSSKeywordCompletions._propertyKeywordMap?e=e.concat(WI.CSSKeywordCompletions._propertyKeywordMap[s]):a&&"-webkit-"+s in WI.CSSKeywordCompletions._propertyKeywordMap&&(e=e.concat(WI.CSSKeywordCompletions._propertyKeywordMap["-webkit-"+s])),WI.CSSKeywordCompletions.isColorAwareProperty(s)&&(e=e.concat(WI.CSSKeywordCompletions._colors)),(WI.CSSKeywordCompletions.InheritedProperties.has(s)||a&&WI.CSSKeywordCompletions.InheritedProperties.has("-webkit-"+s))&&e.push("inherit")}t(c);let i=WI.CSSKeywordCompletions.PropertyNameForAlias.get(c);i&&t(i);let n=WI.CSSKeywordCompletions.LonghandNamesForShorthandProperty.get(c);if(n)for(let s of n)t(s);return e.includes(WI.CSSKeywordCompletions.AllPropertyNamesPlaceholder)&&WI.CSSCompletions.cssNameCompletions&&(e.remove(WI.CSSKeywordCompletions.AllPropertyNamesPlaceholder),e=e.concat(WI.CSSCompletions.cssNameCompletions.values)),new WI.CSSCompletions(Array.from(new Set(e)),!0)};WI.CSSKeywordCompletions.isColorAwareProperty=function(c){return!!(c in WI.CSSKeywordCompletions._colorAwareProperties||c.charAt(0)!=="-"&&"-webkit-"+c in WI.CSSKeywordCompletions._colorAwareProperties||c.endsWith("color"))};WI.CSSKeywordCompletions.forFunction=function(c){let e=["var()"];return c==="var"?e=[]:c==="calc"||c==="min"||c==="max"?e=e.concat(["calc()","min()","max()"]):c==="env"?e=e.concat(["safe-area-inset-top","safe-area-inset-right","safe-area-inset-bottom","safe-area-inset-left"]):c==="image-set"?e.push("url()"):c==="repeat"?e=e.concat(["auto","auto-fill","auto-fit","min-content","max-content"]):c.endsWith("gradient")&&(e=e.concat(["to","left","right","top","bottom"]),e=e.concat(WI.CSSKeywordCompletions._colors)),new WI.CSSCompletions(e,!0)};WI.CSSKeywordCompletions.addCustomCompletions=function(c){for(var e of c){if(e.aliases)for(let t of e.aliases)WI.CSSKeywordCompletions.PropertyNameForAlias.set(t,e.name);e.values&&WI.CSSKeywordCompletions.addPropertyCompletionValues(e.name,e.values),e.inherited&&WI.CSSKeywordCompletions.InheritedProperties.add(e.name),e.longhands&&WI.CSSKeywordCompletions.LonghandNamesForShorthandProperty.set(e.name,e.longhands)}};WI.CSSKeywordCompletions.addPropertyCompletionValues=function(c,e){var t=WI.CSSKeywordCompletions._propertyKeywordMap[c];if(!t){WI.CSSKeywordCompletions._propertyKeywordMap[c]=e;return}var i=new Set;for(var n of t)i.add(n);for(var n of e)i.add(n);WI.CSSKeywordCompletions._propertyKeywordMap[c]=[...i.values()]};WI.CSSKeywordCompletions.AllPropertyNamesPlaceholder="__all-properties__";WI.CSSKeywordCompletions.PropertyNameForAlias=new Map;WI.CSSKeywordCompletions.LonghandNamesForShorthandProperty=new Map;WI.CSSKeywordCompletions.InheritedProperties=new Set(["-apple-color-filter","-webkit-animation-trigger","-webkit-aspect-ratio","-webkit-border-horizontal-spacing","-webkit-border-vertical-spacing","-webkit-box-direction","-webkit-cursor-visibility","-webkit-font-kerning","-webkit-font-smoothing","-webkit-hyphenate-character","-webkit-hyphenate-limit-after","-webkit-hyphenate-limit-before","-webkit-hyphenate-limit-lines","-webkit-hyphens","-webkit-line-align","-webkit-line-break","-webkit-line-box-contain","-webkit-line-grid","-webkit-line-snap","-webkit-locale","-webkit-nbsp-mode","-webkit-overflow-scrolling","-webkit-print-color-adjust","-webkit-rtl-ordering","-webkit-ruby-position","-webkit-text-align-last","-webkit-text-combine","-webkit-text-decoration-skip","-webkit-text-decorations-in-effect","-webkit-text-emphasis","-webkit-text-emphasis-color","-webkit-text-emphasis-position","-webkit-text-emphasis-style","-webkit-text-fill-color","-webkit-text-justify","-webkit-text-orientation","-webkit-text-security","-webkit-text-size-adjust","-webkit-text-stroke","-webkit-text-stroke-color","-webkit-text-stroke-width","-webkit-text-underline-position","-webkit-text-zoom","-webkit-touch-callout","-webkit-user-modify","-webkit-user-select","border-collapse","border-spacing","caption-side","caret-color","clip-rule","color","color-interpolation","color-interpolation-filters","color-rendering","cursor","direction","empty-cells","fill","fill-opacity","fill-rule","font","font-family","font-feature-settings","font-optical-sizing","font-size","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","glyph-orientation-horizontal","glyph-orientation-vertical","hanging-punctuation","image-orientation","image-rendering","image-resolution","kerning","letter-spacing","line-break","line-height","list-style","list-style-image","list-style-position","list-style-type","marker","marker-end","marker-mid","marker-start","orphans","pointer-events","quotes","resize","shape-rendering","speak-as","stroke","stroke-color","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","text-align","text-anchor","text-indent","text-rendering","text-shadow","text-transform","visibility","white-space","widows","word-break","word-spacing","word-wrap","writing-mode"]);WI.CSSKeywordCompletions._colors=["aqua","black","blue","fuchsia","gray","green","lime","maroon","navy","olive","orange","purple","red","silver","teal","white","yellow","transparent","currentcolor","grey","aliceblue","antiquewhite","aquamarine","azure","beige","bisque","blanchedalmond","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","gainsboro","ghostwhite","gold","goldenrod","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","limegreen","linen","magenta","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","oldlace","olivedrab","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","rebeccapurple","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","thistle","tomato","turquoise","violet","wheat","whitesmoke","yellowgreen","rgb()","rgba()","hsl()","hsla()"];WI.CSSKeywordCompletions._colorAwareProperties=["background","background-color","background-image","border","border-color","border-top","border-right","border-bottom","border-left","border-top-color","border-right-color","border-bottom-color","border-left-color","box-shadow","color","fill","outline","outline-color","stroke","text-line-through","text-line-through-color","text-overline","text-overline-color","text-shadow","text-underline","text-underline-color","-webkit-box-shadow","-webkit-column-rule","-webkit-column-rule-color","-webkit-text-emphasis","-webkit-text-emphasis-color","-webkit-text-fill-color","-webkit-text-stroke","-webkit-text-stroke-color","-webkit-text-decoration-color","-webkit-tap-highlight-color"].keySet();WI.CSSKeywordCompletions._propertyKeywordMap={content:["list-item","close-quote","no-close-quote","no-open-quote","open-quote","attr()","counter()","counters()","url()","linear-gradient()","radial-gradient()","repeating-linear-gradient()","repeating-radial-gradient()","-webkit-canvas()","cross-fade()","image-set()"],"list-style-image":["none","url()","linear-gradient()","radial-gradient()","repeating-linear-gradient()","repeating-radial-gradient()","-webkit-canvas()","cross-fade()","image-set()"],"baseline-shift":["baseline","sub","super"],"border-bottom-width":["medium","thick","thin","calc()"],"font-stretch":["normal","wider","narrower","ultra-condensed","extra-condensed","condensed","semi-condensed","semi-expanded","expanded","extra-expanded","ultra-expanded"],"border-left-width":["medium","thick","thin","calc()"],"border-top-width":["medium","thick","thin","calc()"],"outline-color":["invert","-webkit-focus-ring-color"],cursor:["auto","default","none","context-menu","help","pointer","progress","wait","cell","crosshair","text","vertical-text","alias","copy","move","no-drop","not-allowed","grab","grabbing","e-resize","n-resize","ne-resize","nw-resize","s-resize","se-resize","sw-resize","w-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","col-resize","row-resize","all-scroll","zoom-in","zoom-out","-webkit-grab","-webkit-grabbing","-webkit-zoom-in","-webkit-zoom-out","url()","image-set()"],"border-width":["medium","thick","thin","calc()"],size:["a3","a4","a5","b4","b5","landscape","ledger","legal","letter","portrait"],background:["none","url()","linear-gradient()","radial-gradient()","repeating-linear-gradient()","repeating-radial-gradient()","-webkit-canvas()","cross-fade()","image-set()","repeat","repeat-x","repeat-y","no-repeat","space","round","scroll","fixed","local","auto","contain","cover","top","right","left","bottom","center","border-box","padding-box","content-box"],"background-image":["none","url()","linear-gradient()","radial-gradient()","repeating-linear-gradient()","repeating-radial-gradient()","-webkit-canvas()","cross-fade()","image-set()"],"background-size":["auto","contain","cover"],"background-attachment":["scroll","fixed","local"],"background-repeat":["repeat","repeat-x","repeat-y","no-repeat","space","round"],"background-blend-mode":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],"background-position":["top","right","left","bottom","center"],"background-origin":["border-box","padding-box","content-box"],"background-clip":["border-box","padding-box","content-box"],"enable-background":["accumulate","new"],"hanging-punctuation":["none","first","last","allow-end","force-end"],overflow:["hidden","auto","visible","scroll","marquee","-webkit-paged-x","-webkit-paged-y"],"-webkit-box-reflect":["none","left","right","above","below"],"margin-bottom":["auto"],"font-weight":["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"],"font-synthesis":["none","weight","style"],"font-style":["italic","oblique","normal"],outline:["none","hidden","inset","groove","ridge","outset","dotted","dashed","solid","double"],font:["caption","icon","menu","message-box","small-caption","-webkit-mini-control","-webkit-small-control","-webkit-control","status-bar","italic","oblique","small-caps","normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900","xx-small","x-small","small","medium","large","x-large","xx-large","-webkit-xxx-large","smaller","larger","serif","sans-serif","cursive","fantasy","monospace","-webkit-body","-webkit-pictograph","-apple-system","-apple-system-headline","-apple-system-body","-apple-system-subheadline","-apple-system-footnote","-apple-system-caption1","-apple-system-caption2","-apple-system-short-headline","-apple-system-short-body","-apple-system-short-subheadline","-apple-system-short-footnote","-apple-system-short-caption1","-apple-system-tall-body","-apple-system-title0","-apple-system-title1","-apple-system-title2","-apple-system-title3","-apple-system-title4","system-ui"],"outline-width":["medium","thick","thin","calc()"],"box-shadow":["none"],"text-shadow":["none"],"-webkit-box-shadow":["none"],"border-right-width":["medium","thick","thin"],"line-height":["normal"],"counter-increment":["none"],"counter-reset":["none"],"page-break-after":["left","right","auto","always","avoid"],"page-break-before":["left","right","auto","always","avoid"],"page-break-inside":["auto","avoid"],"-webkit-column-break-after":["left","right","auto","always","avoid"],"-webkit-column-break-before":["left","right","auto","always","avoid"],"-webkit-column-break-inside":["auto","avoid"],"border-image":["repeat","stretch","url()","linear-gradient()","radial-gradient()","repeating-linear-gradient()","repeating-radial-gradient()","-webkit-canvas()","cross-fade()","image-set()"],"border-image-repeat":["repeat","stretch","space","round"],"-webkit-mask-box-image-repeat":["repeat","stretch","space","round"],"font-family":["serif","sans-serif","cursive","fantasy","monospace","-webkit-body","-webkit-pictograph","-apple-system","-apple-system-headline","-apple-system-body","-apple-system-subheadline","-apple-system-footnote","-apple-system-caption1","-apple-system-caption2","-apple-system-short-headline","-apple-system-short-body","-apple-system-short-subheadline","-apple-system-short-footnote","-apple-system-short-caption1","-apple-system-tall-body","-apple-system-title0","-apple-system-title1","-apple-system-title2","-apple-system-title3","-apple-system-title4","system-ui"],"margin-left":["auto"],"margin-top":["auto"],zoom:["normal","document","reset"],"z-index":["auto"],width:["intrinsic","min-intrinsic","-webkit-min-content","-webkit-max-content","-webkit-fill-available","-webkit-fit-content","calc()"],height:["intrinsic","min-intrinsic","calc()"],"max-width":["none","intrinsic","min-intrinsic","-webkit-min-content","-webkit-max-content","-webkit-fill-available","-webkit-fit-content","calc()"],"min-width":["intrinsic","min-intrinsic","-webkit-min-content","-webkit-max-content","-webkit-fill-available","-webkit-fit-content","calc()"],"max-height":["none","intrinsic","min-intrinsic","calc()"],"min-height":["intrinsic","min-intrinsic","calc()"],"letter-spacing":["normal","calc()"],"word-spacing":["normal","calc()"],border:["none","hidden","inset","groove","ridge","outset","dotted","dashed","solid","double"],"font-size":["xx-small","x-small","small","medium","large","x-large","xx-large","-webkit-xxx-large","smaller","larger"],"font-variant":["small-caps","normal"],"font-variant-numeric":["normal","ordinal","slashed-zero","lining-nums","oldstyle-nums","proportional-nums","tabular-nums","diagonal-fractions","stacked-fractions"],"vertical-align":["baseline","middle","sub","super","text-top","text-bottom","top","bottom","-webkit-baseline-middle"],"text-indent":["-webkit-each-line","-webkit-hanging"],clip:["auto","rect()"],"clip-path":["none","url()","circle()","ellipse()","inset()","polygon()","margin-box","border-box","padding-box","content-box"],"shape-outside":["none","url()","circle()","ellipse()","inset()","polygon()","margin-box","border-box","padding-box","content-box"],orphans:["auto"],widows:["auto"],margin:["auto"],page:["auto"],perspective:["none"],"perspective-origin":["none","left","right","bottom","top","center"],"-webkit-marquee-increment":["small","large","medium"],"-webkit-marquee-repetition":["infinite"],"-webkit-marquee-speed":["normal","slow","fast"],"margin-right":["auto"],"-webkit-text-emphasis":["circle","filled","open","dot","double-circle","triangle","sesame"],"-webkit-text-emphasis-style":["circle","filled","open","dot","double-circle","triangle","sesame"],"-webkit-text-emphasis-position":["over","under","left","right"],transform:["none","scale()","scaleX()","scaleY()","scale3d()","rotate()","rotateX()","rotateY()","rotateZ()","rotate3d()","skew()","skewX()","skewY()","translate()","translateX()","translateY()","translateZ()","translate3d()","matrix()","matrix3d()","perspective()"],"text-decoration":["none","underline","overline","line-through","blink"],"-webkit-text-decorations-in-effect":["none","underline","overline","line-through","blink"],"-webkit-text-decoration-line":["none","underline","overline","line-through","blink"],"-webkit-text-decoration-skip":["auto","none","objects","ink"],"-webkit-text-underline-position":["auto","alphabetic","under"],transition:["none","ease","linear","ease-in","ease-out","ease-in-out","step-start","step-end","steps()","cubic-bezier()","spring()","all",WI.CSSKeywordCompletions.AllPropertyNamesPlaceholder],"transition-timing-function":["ease","linear","ease-in","ease-out","ease-in-out","step-start","step-end","steps()","cubic-bezier()","spring()"],"transition-property":["all","none",WI.CSSKeywordCompletions.AllPropertyNamesPlaceholder],"animation-direction":["normal","alternate","reverse","alternate-reverse"],"animation-fill-mode":["none","forwards","backwards","both"],"animation-iteration-count":["infinite"],"animation-play-state":["paused","running"],"animation-timing-function":["ease","linear","ease-in","ease-out","ease-in-out","step-start","step-end","steps()","cubic-bezier()","spring()"],"align-content":["auto","baseline","last-baseline","space-between","space-around","space-evenly","stretch","center","start","end","flex-start","flex-end","left","right","true","safe"],"justify-content":["auto","baseline","last-baseline","space-between","space-around","space-evenly","stretch","center","start","end","flex-start","flex-end","left","right","true","safe"],"align-items":["auto","stretch","baseline","last-baseline","center","start","end","self-start","self-end","flex-start","flex-end","left","right","true","safe"],"align-self":["auto","stretch","baseline","last-baseline","center","start","end","self-start","self-end","flex-start","flex-end","left","right","true","safe"],"justify-items":["auto","stretch","baseline","last-baseline","center","start","end","self-start","self-end","flex-start","flex-end","left","right","true","safe"],"justify-self":["auto","stretch","baseline","last-baseline","center","start","end","self-start","self-end","flex-start","flex-end","left","right","true","safe"],"flex-flow":["row","row-reverse","column","column-reverse","nowrap","wrap","wrap-reverse"],flex:["none"],"flex-basis":["auto"],grid:["none"],"grid-area":["auto"],"grid-auto-columns":["auto","-webkit-max-content","-webkit-min-content","minmax()"],"grid-auto-flow":["row","column","dense"],"grid-auto-rows":["auto","-webkit-max-content","-webkit-min-content","minmax()"],"grid-column":["auto"],"grid-column-start":["auto"],"grid-column-end":["auto"],"grid-row":["auto"],"grid-row-start":["auto"],"grid-row-end":["auto"],"grid-template":["none"],"grid-template-areas":["none"],"grid-template-columns":["none","auto","-webkit-max-content","-webkit-min-content","minmax()","repeat()"],"grid-template-rows":["none","auto","-webkit-max-content","-webkit-min-content","minmax()","repeat()"],"scroll-snap-align":["none","start","center","end"],"scroll-snap-type":["none","mandatory","proximity","x","y","inline","block","both"],"-webkit-background-composite":["clear","copy","source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","xor","plus-darker","plus-lighter"],"-webkit-mask-composite":["clear","copy","source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","xor","plus-darker","plus-lighter"],"-webkit-text-stroke-width":["medium","thick","thin","calc()"],"-webkit-aspect-ratio":["auto","from-dimensions","from-intrinsic","/"],filter:["none","grayscale()","sepia()","saturate()","hue-rotate()","invert()","opacity()","brightness()","contrast()","blur()","drop-shadow()","custom()"],"-webkit-backdrop-filter":["none","grayscale()","sepia()","saturate()","hue-rotate()","invert()","opacity()","brightness()","contrast()","blur()","drop-shadow()","custom()"],"-webkit-hyphenate-character":["none"],"-webkit-hyphenate-limit-after":["auto"],"-webkit-hyphenate-limit-before":["auto"],"-webkit-hyphenate-limit-lines":["no-limit"],"-webkit-line-grid":["none"],"-webkit-locale":["auto"],"-webkit-line-box-contain":["block","inline","font","glyphs","replaced","inline-box","none"],"font-feature-settings":["normal"],"-webkit-animation-trigger":["auto","container-scroll()"],"-webkit-text-size-adjust":["none","auto"],"-apple-pay-button-style":["black","white","white-outline"],"-apple-pay-button-type":["plain","buy","set-up","donate","check-out","book","subscribe"],"-webkit-alt":["attr()"],"-webkit-animation-direction":["normal","alternate","reverse","alternate-reverse"],"-webkit-animation-fill-mode":["none","forwards","backwards","both"],"-webkit-animation-iteration-count":["infinite"],"-webkit-animation-play-state":["paused","running"],"-webkit-animation-timing-function":["ease","linear","ease-in","ease-out","ease-in-out","step-start","step-end","steps()","cubic-bezier()","spring()"],"-webkit-appearance":["none","checkbox","radio","push-button","square-button","button","button-bevel","default-button","inner-spin-button","listbox","listitem","media-controls-background","media-controls-dark-bar-background","media-controls-fullscreen-background","media-controls-light-bar-background","media-current-time-display","media-enter-fullscreen-button","media-exit-fullscreen-button","media-fullscreen-volume-slider","media-fullscreen-volume-slider-thumb","media-mute-button","media-overlay-play-button","media-play-button","media-return-to-realtime-button","media-rewind-button","media-seek-back-button","media-seek-forward-button","media-slider","media-sliderthumb","media-time-remaining-display","media-toggle-closed-captions-button","media-volume-slider","media-volume-slider-container","media-volume-slider-mute-button","media-volume-sliderthumb","menulist","menulist-button","menulist-text","menulist-textfield","meter","progress-bar","progress-bar-value","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","caret","searchfield","searchfield-decoration","searchfield-results-decoration","searchfield-results-button","searchfield-cancel-button","snapshotted-plugin-overlay","textfield","relevancy-level-indicator","continuous-capacity-level-indicator","discrete-capacity-level-indicator","rating-level-indicator","image-controls-button","-apple-pay-button","textarea","attachment","borderless-attachment","caps-lock-indicator"],"-webkit-backface-visibility":["hidden","visible"],"-webkit-border-after-width":["medium","thick","thin","calc()"],"-webkit-border-before-width":["medium","thick","thin","calc()"],"-webkit-border-end-width":["medium","thick","thin","calc()"],"-webkit-border-fit":["border","lines"],"-webkit-border-start-width":["medium","thick","thin","calc()"],"-webkit-box-align":["baseline","center","stretch","start","end"],"-webkit-box-decoration-break":["clone","slice"],"-webkit-box-direction":["normal","reverse"],"-webkit-box-lines":["single","multiple"],"-webkit-box-orient":["horizontal","vertical","inline-axis","block-axis"],"-webkit-box-pack":["center","justify","start","end"],"-webkit-column-axis":["auto","horizontal","vertical"],"-webkit-column-count":["auto","calc()"],"-webkit-column-fill":["auto","balance"],"-webkit-column-gap":["normal","calc()"],"-webkit-column-progression":["normal","reverse"],"-webkit-column-rule-width":["medium","thick","thin","calc()"],"-webkit-column-span":["all","none","calc()"],"-webkit-column-width":["auto","calc()"],"-webkit-cursor-visibility":["auto","auto-hide"],"-webkit-font-kerning":["none","normal","auto"],"-webkit-font-smoothing":["none","auto","antialiased","subpixel-antialiased"],"-webkit-hyphens":["none","auto","manual"],"-webkit-line-align":["none","edges"],"-webkit-line-break":["auto","loose","normal","strict","after-white-space"],"-webkit-line-snap":["none","baseline","contain"],"-webkit-logical-height":["intrinsic","min-intrinsic","calc()"],"-webkit-logical-width":["intrinsic","min-intrinsic","-webkit-min-content","-webkit-max-content","-webkit-fill-available","-webkit-fit-content","calc()"],"-webkit-margin-after-collapse":["collapse","separate","discard"],"-webkit-margin-before-collapse":["collapse","separate","discard"],"-webkit-margin-bottom-collapse":["collapse","separate","discard"],"-webkit-margin-top-collapse":["collapse","separate","discard"],"-webkit-marquee-direction":["left","right","auto","reverse","forwards","backwards","ahead","up","down"],"-webkit-marquee-style":["none","scroll","slide","alternate"],"-webkit-max-logical-height":["none","intrinsic","min-intrinsic","calc()"],"-webkit-max-logical-width":["none","intrinsic","min-intrinsic","-webkit-min-content","-webkit-max-content","-webkit-fill-available","-webkit-fit-content","calc()"],"-webkit-min-logical-height":["intrinsic","min-intrinsic","calc()"],"-webkit-min-logical-width":["intrinsic","min-intrinsic","-webkit-min-content","-webkit-max-content","-webkit-fill-available","-webkit-fit-content","calc()"],"-webkit-nbsp-mode":["normal","space"],"-webkit-overflow-scrolling":["auto","touch"],"-webkit-print-color-adjust":["economy","exact"],"-webkit-rtl-ordering":["logical","visual"],"-webkit-ruby-position":["after","before","inter-character"],"-webkit-text-align-last":["auto","start","end","left","right","center","justify"],"-webkit-text-combine":["none","horizontal"],"-webkit-text-decoration-style":["dotted","dashed","solid","double","wavy"],"-webkit-text-justify":["auto","none","inter-word","inter-ideograph","inter-cluster","distribute","kashida"],"-webkit-text-orientation":["sideways","sideways-right","upright","mixed"],"-webkit-text-security":["none","disc","circle","square"],"-webkit-text-zoom":["normal","reset"],"-webkit-transform-style":["flat","preserve-3d"],"-webkit-user-drag":["none","auto","element"],"-webkit-user-modify":["read-only","read-write","read-write-plaintext-only"],"-webkit-user-select":["none","all","auto","text"],"-webkit-writing-mode":["lr","rl","tb","lr-tb","rl-tb","tb-rl","horizontal-tb","vertical-rl","vertical-lr","horizontal-bt"],"alignment-baseline":["baseline","middle","auto","alphabetic","before-edge","after-edge","central","text-before-edge","text-after-edge","ideographic","hanging","mathematical"],"border-block-end-style":["none","hidden","inset","groove","outset","ridge","dotted","dashed","solid","double"],"border-block-start-style":["none","hidden","inset","groove","outset","ridge","dotted","dashed","solid","double"],"border-bottom-style":["none","hidden","inset","groove","outset","ridge","dotted","dashed","solid","double"],"border-collapse":["collapse","separate"],"border-inline-end-style":["none","hidden","inset","groove","outset","ridge","dotted","dashed","solid","double"],"border-inline-start-style":["none","hidden","inset","groove","outset","ridge","dotted","dashed","solid","double"],"border-left-style":["none","hidden","inset","groove","outset","ridge","dotted","dashed","solid","double"],"border-right-style":["none","hidden","inset","groove","outset","ridge","dotted","dashed","solid","double"],"border-top-style":["none","hidden","inset","groove","outset","ridge","dotted","dashed","solid","double"],"box-sizing":["border-box","content-box"],"break-after":["left","right","auto","avoid","column","avoid-column","avoid-page","page","recto","verso"],"break-before":["left","right","auto","avoid","column","avoid-column","avoid-page","page","recto","verso"],"break-inside":["auto","avoid","avoid-column","avoid-page"],"buffered-rendering":["auto","static","dynamic"],"caption-side":["top","bottom","left","right"],clear:["none","left","right","both"],"clip-rule":["nonzero","evenodd"],"color-interpolation":["auto","sRGB","linearRGB"],"color-interpolation-filters":["auto","sRGB","linearRGB"],"color-rendering":["auto","optimizeSpeed","optimizeQuality"],"column-fill":["auto","balance"],"column-rule-style":["none","hidden","inset","groove","outset","ridge","dotted","dashed","solid","double"],direction:["ltr","rtl"],display:["none","inline","block","list-item","compact","inline-block","table","inline-table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption","-webkit-box","-webkit-inline-box","flex","-webkit-flex","inline-flex","-webkit-inline-flex","contents","grid","inline-grid"],"dominant-baseline":["middle","auto","alphabetic","central","text-before-edge","text-after-edge","ideographic","hanging","mathematical","use-script","no-change","reset-size"],"empty-cells":["hide","show"],"fill-rule":["nonzero","evenodd"],"flex-direction":["row","row-reverse","column","column-reverse"],"flex-wrap":["nowrap","wrap-reverse","wrap"],float:["none","left","right"],"font-optical-sizing":["none","auto"],"font-variant-alternates":["historical-forms","normal"],"font-variant-caps":["small-caps","all-small-caps","petite-caps","all-petite-caps","unicase","titling-caps","normal"],"font-variant-position":["normal","sub","super"],"image-rendering":["auto","optimizeSpeed","optimizeQuality","crisp-edges","pixelated","-webkit-crisp-edges","-webkit-optimize-contrast"],"image-resolution":["from-image","snap"],isolation:["auto","isolate"],"line-break":["normal","auto","loose","strict","after-white-space"],"list-style-position":["outside","inside"],"list-style-type":["none","disc","circle","square","decimal","decimal-leading-zero","arabic-indic","binary","bengali","cambodian","khmer","devanagari","gujarati","gurmukhi","kannada","lower-hexadecimal","lao","malayalam","mongolian","myanmar","octal","oriya","persian","urdu","telugu","tibetan","thai","upper-hexadecimal","lower-roman","upper-roman","lower-greek","lower-alpha","lower-latin","upper-alpha","upper-latin","afar","ethiopic-halehame-aa-et","ethiopic-halehame-aa-er","amharic","ethiopic-halehame-am-et","amharic-abegede","ethiopic-abegede-am-et","cjk-earthly-branch","cjk-heavenly-stem","ethiopic","ethiopic-halehame-gez","ethiopic-abegede","ethiopic-abegede-gez","hangul-consonant","hangul","lower-norwegian","oromo","ethiopic-halehame-om-et","sidama","ethiopic-halehame-sid-et","somali","ethiopic-halehame-so-et","tigre","ethiopic-halehame-tig","tigrinya-er","ethiopic-halehame-ti-er","tigrinya-er-abegede","ethiopic-abegede-ti-er","tigrinya-et","ethiopic-halehame-ti-et","tigrinya-et-abegede","ethiopic-abegede-ti-et","upper-greek","upper-norwegian","asterisks","footnotes","hebrew","armenian","lower-armenian","upper-armenian","georgian","cjk-ideographic","hiragana","katakana","hiragana-iroha","katakana-iroha"],"mask-type":["alpha","luminance"],"max-zoom":["auto"],"min-zoom":["auto"],"mix-blend-mode":["normal","plus-darker","plus-lighter","overlay","multiply","screen","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],"object-fit":["none","contain","cover","fill","scale-down"],orientation:["auto","portait","landscape"],"outline-style":["none","inset","groove","outset","ridge","dotted","dashed","solid","double","auto"],"overflow-wrap":["normal","break-word"],"overflow-x":["hidden","auto","visible","scroll"],"overflow-y":["hidden","auto","visible","scroll","-webkit-paged-x","-webkit-paged-y"],"pointer-events":["none","all","auto","visible","visiblePainted","visibleFill","visibleStroke","painted","fill","stroke"],position:["absolute","fixed","relative","static","sticky","-webkit-sticky"],resize:["none","auto","both","horizontal","vertical"],"shape-rendering":["auto","optimizeSpeed","geometricPrecision","crispedges"],"stroke-linecap":["square","round","butt"],"stroke-linejoin":["round","miter","bevel"],"table-layout":["auto","fixed"],"text-align":["-webkit-auto","left","right","center","justify","-webkit-left","-webkit-right","-webkit-center","-webkit-match-parent","start","end"],"text-anchor":["middle","start","end"],"text-line-through":["none","dotted","dashed","solid","double","dot-dash","dot-dot-dash","wave","continuous","skip-white-space"],"text-line-through-mode":["continuous","skip-white-space"],"text-line-through-style":["none","dotted","dashed","solid","double","dot-dash","dot-dot-dash","wave"],"text-line-through-width":["normal","medium","auto","thick","thin"],"text-overflow":["clip","ellipsis"],"text-overline-mode":["continuous","skip-white-space"],"text-overline-style":["none","dotted","dashed","solid","double","dot-dash","dot-dot-dash","wave"],"text-overline-width":["normal","medium","auto","thick","thin","calc()"],"text-rendering":["auto","optimizeSpeed","optimizeLegibility","geometricPrecision"],"text-transform":["none","capitalize","uppercase","lowercase"],"text-underline":["none","dotted","dashed","solid","double","dot-dash","dot-dot-dash","wave"],"text-underline-mode":["continuous","skip-white-space"],"text-underline-style":["none","dotted","dashed","solid","double","dot-dash","dot-dot-dash","wave"],"text-underline-width":["normal","medium","auto","thick","thin","calc()"],"transform-style":["flat","preserve-3d"],"unicode-bidi":["normal","bidi-override","embed","isolate-override","plaintext","-webkit-isolate","-webkit-isolate-override","-webkit-plaintext","isolate"],"user-zoom":["zoom","fixed"],"vector-effect":["none"],visibility:["hidden","visible","collapse"],"white-space":["normal","nowrap","pre","pre-line","pre-wrap"],"word-break":["normal","break-all","keep-all","break-word"],"word-wrap":["normal","break-word"],"writing-mode":["lr","rl","tb","lr-tb","rl-tb","tb-rl","horizontal-tb","vertical-rl","vertical-lr","horizontal-bt"]};WI.CSSMedia=class{constructor(e,t,i){console.assert(!i||i instanceof WI.SourceCodeLocation),this._type=e||null,this._text=t||"",this._sourceCodeLocation=i||null}get type(){return this._type}get text(){return this._text}get sourceCodeLocation(){return this._sourceCodeLocation}};WI.CSSMedia.Type={MediaRule:"css-media-type-media-rule",ImportRule:"css-media-type-import-rule",LinkedStyleSheet:"css-media-type-linked-stylesheet",InlineStyleSheet:"css-media-type-inline-stylesheet"};WI.CSSProperty=class extends WI.Object{constructor(e,t,i,n,s,a,d,p,f,_,b){super(),this._ownerStyle=null,this._index=e,this._overridingProperty=null,this._initialState=null,this._modified=!1,this.update(t,i,n,s,a,d,p,f,_,b,!0)}static isInheritedPropertyName(e){return console.assert(typeof e=="string"),WI.CSSKeywordCompletions.InheritedProperties.has(e)?!0:e.startsWith("--")}get ownerStyle(){return this._ownerStyle}set ownerStyle(e){this._ownerStyle=e||null}get index(){return this._index}set index(e){this._index=e}update(e,t,i,n,s,a,d,p,f,_,b){if(!(this._ownerStyle&&this._ownerStyle.locked&&e!==this._text)){e=e||"",t=t||"",i=i||"",n=n||"",s=s||!1,a=a||!1,d=d||!1,p=p||!1,f=f||!1;var w=!1;b||(w=this._name!==t||this._rawValue!==i||this._priority!==n||this._enabled!==s||this._implicit!==d||this._anonymous!==p||this._valid!==f),b?this._overridden=a:this.overridden=a,a||(this._overridingProperty=null),this._text=e,this._name=t,this._rawValue=i,this._priority=n,this._enabled=s,this._implicit=d,this._anonymous=p,this._inherited=WI.CSSProperty.isInheritedPropertyName(t),this._valid=f,this._variable=t.startsWith("--"),this._styleSheetTextRange=_||null,this._relatedShorthandProperty=null,this._relatedLonghandProperties=[],delete this._styleDeclarationTextRange,delete this._canonicalName,delete this._hasOtherVendorNameOrKeyword,w&&this.dispatchEventToListeners(WI.CSSProperty.Event.Changed)}}remove(){this._markModified(),this._name="";const e=!0;this._updateStyleText(e)}replaceWithText(e){this._markModified(),this._updateOwnerStyleText(this._text,e,!0)}commentOut(e){this._enabled!==!e&&(this._markModified(),this._enabled=!e,e?this.text="/* "+this._text+" */":this.text=this._text.slice(2,-2).trim())}get text(){return this._text}set text(e){this._text!==e&&(this._markModified(),this._updateOwnerStyleText(this._text,e),this._text=e)}get formattedText(){return this._name?`${this._name}: ${this._rawValue};`:""}get modified(){return this._modified}set modified(e){this._modified!==e&&(this._modified=e,this.dispatchEventToListeners(WI.CSSProperty.Event.ModifiedChanged))}get name(){return this._name}set name(e){e!==this._name&&(this._markModified(),this._name=e,this._updateStyleText())}get canonicalName(){return this._canonicalName?this._canonicalName:(this._canonicalName=WI.cssManager.canonicalNameForPropertyName(this.name),this._canonicalName)}get value(){return this._value||(this._value=this._rawValue.replace(/\s*!important\s*$/,"")),this._value}get rawValue(){return this._rawValue}set rawValue(e){if(e===this._rawValue)return;this._markModified();let t=WI.CSSCompletions.completeUnbalancedValue(e);t&&(e+=t),this._rawValue=e,this._value=void 0,this._updateStyleText()}get important(){return this.priority==="important"}get priority(){return this._priority}get attached(){return this._enabled&&this._ownerStyle&&(!isNaN(this._index)||this._ownerStyle.type===WI.CSSStyleDeclaration.Type.Computed)}get enabled(){return this._enabled}get overridden(){return this._overridden}set overridden(e){if(e=e||!1,this._overridden===e)return;e||(this._overridingProperty=null);var t=this._overridden;if(this._overridden=e,this._overriddenStatusChangedTimeout)return;function i(){delete this._overriddenStatusChangedTimeout,this._overridden!==t&&this.dispatchEventToListeners(WI.CSSProperty.Event.OverriddenStatusChanged)}this._overriddenStatusChangedTimeout=setTimeout(i.bind(this),0)}get overridingProperty(){return console.assert(this._overridden),this._overridingProperty}set overridingProperty(e){!WI.settings.experimentalEnableStylesJumpToEffective.value||(console.assert(this!==e,`Property "${this.formattedText}" can't override itself.`,this),this._overridingProperty=e||null)}get implicit(){return this._implicit}set implicit(e){this._implicit=e}get anonymous(){return this._anonymous}get inherited(){return this._inherited}get valid(){return this._valid}get variable(){return this._variable}get styleSheetTextRange(){return this._styleSheetTextRange}get initialState(){return this._initialState}get editable(){return!!(this._styleSheetTextRange&&this._ownerStyle&&this._ownerStyle.styleSheetTextRange)}get styleDeclarationTextRange(){if("_styleDeclarationTextRange"in this)return this._styleDeclarationTextRange;if(!this._ownerStyle||!this._styleSheetTextRange)return null;var e=this._ownerStyle.styleSheetTextRange;if(!e)return null;var t=this._styleSheetTextRange.startLine-e.startLine,i=this._styleSheetTextRange.endLine-e.startLine,n=this._styleSheetTextRange.startColumn;t||(n-=e.startColumn);var s=this._styleSheetTextRange.endColumn;return i||(s-=e.startColumn),this._styleDeclarationTextRange=new WI.TextRange(t,n,i,s),this._styleDeclarationTextRange}get relatedShorthandProperty(){return this._relatedShorthandProperty}set relatedShorthandProperty(e){this._relatedShorthandProperty=e||null}get relatedLonghandProperties(){return this._relatedLonghandProperties}addRelatedLonghandProperty(e){this._relatedLonghandProperties.push(e)}clearRelatedLonghandProperties(e){this._relatedLonghandProperties=[]}hasOtherVendorNameOrKeyword(){return"_hasOtherVendorNameOrKeyword"in this?this._hasOtherVendorNameOrKeyword:(this._hasOtherVendorNameOrKeyword=WI.cssManager.propertyNameHasOtherVendorPrefix(this.name)||WI.cssManager.propertyValueHasOtherVendorKeyword(this.value),this._hasOtherVendorNameOrKeyword)}equals(e){return e===this?!0:e?this._name===e.name&&this._rawValue===e.rawValue&&this._enabled===e.enabled:!1}clone(){let e=new WI.CSSProperty(this._index,this._text,this._name,this._rawValue,this._priority,this._enabled,this._overridden,this._implicit,this._anonymous,this._valid,this._styleSheetTextRange);return e.ownerStyle=this._ownerStyle,e}_updateStyleText(e=!1){let t="";this._name&&this._rawValue&&(t=this._name+": "+this._rawValue+";");let i=this._text;this._text=t,this._updateOwnerStyleText(i,this._text,e)}_updateOwnerStyleText(e,t,i=!1){if(e===t){i&&(this._ownerStyle.shiftPropertiesAfter(this,0,0,i),this._ownerStyle.updatePropertiesModifiedState());return}if(console.assert(this._ownerStyle),!this._ownerStyle)return;this._prependSemicolonIfNeeded();let n=this._ownerStyle.text||"",s=this._styleSheetTextRange.relativeTo(this._ownerStyle.styleSheetTextRange.startLine,this._ownerStyle.styleSheetTextRange.startColumn);if(s.resolveOffsets(n+`
`),console.assert(e===n.slice(s.startOffset,s.endOffset),"_styleSheetTextRange data is invalid."),WI.settings.enableStyleEditingDebugMode.value){let _=n.slice(0,s.startOffset),b=n.slice(s.endOffset);console.info(`${_}%c${e}%c${t}%c${b}`,"background: hsl(356, 100%, 90%); color: black","background: hsl(100, 100%, 91%); color: black","background: transparent")}let a=n.slice(0,s.startOffset)+t+n.slice(s.endOffset),d=t.lineCount-e.lineCount,p=t.lastLine.length-e.lastLine.length;this._styleSheetTextRange=this._styleSheetTextRange.cloneAndModify(0,0,d,p),this._ownerStyle.text=a;let f=!t;this._ownerStyle.shiftPropertiesAfter(this,d,p,f),this._ownerStyle.updatePropertiesModifiedState()}_prependSemicolonIfNeeded(){for(let e=this.index-1;e>=0;--e){let t=this._ownerStyle.properties[e];if(!t.enabled)continue;let i=t.text.match(/[^;\s](\s*)$/);i&&(t.text=t.text.trimRight()+";"+i[1]);break}}_markModified(){this._ownerStyle&&this._ownerStyle.markModified()}};WI.CSSProperty.Event={Changed:"css-property-changed",ModifiedChanged:"css-property-modified-changed",OverriddenStatusChanged:"css-property-overridden-status-changed"};WI.CSSRule=class extends WI.Object{constructor(e,t,i,n,s,a,d,p,f,_){super(),console.assert(e),this._nodeStyles=e,this._ownerStyleSheet=t||null,this._id=i||null,this._type=n||null,this._initialState=null,this.update(s,a,d,p,f,_,!0)}get id(){return this._id}get initialState(){return this._initialState}get ownerStyleSheet(){return this._ownerStyleSheet}get editable(){return!!this._id&&(this._type===WI.CSSStyleSheet.Type.Author||this._type===WI.CSSStyleSheet.Type.Inspector)}update(e,t,i,n,s,a){e=e||null,t=t||"",i=i||[],n=n||[],s=s||null,a=a||[],this._style&&(this._style.ownerRule=null),this._sourceCodeLocation=e,this._selectorText=t,this._selectors=i,this._matchedSelectorIndices=n,this._style=s,this._mediaList=a,this._style&&(this._style.ownerRule=this)}get type(){return this._type}get sourceCodeLocation(){return this._sourceCodeLocation}get selectorText(){return this._selectorText}set selectorText(e){if(console.assert(this.editable),!!this.editable){if(this._selectorText===e){this._selectorResolved(!0);return}this._nodeStyles.changeRuleSelector(this,e).then(this._selectorResolved.bind(this),this._selectorRejected.bind(this))}}get selectors(){return this._selectors}get matchedSelectorIndices(){return this._matchedSelectorIndices}get style(){return this._style}get mediaList(){return this._mediaList}isEqualTo(e){return e?Object.shallowEqual(this._id,e.id):!1}get nodeStyles(){return this._nodeStyles}_selectorRejected(e){this.dispatchEventToListeners(WI.CSSRule.Event.SelectorChanged,{valid:!e})}_selectorResolved(e){if(e){let t=e.selectorList.text;if(t!==this._selectorText){let i=WI.DOMNodeStyles.parseSelectorListPayload(e.selectorList),n=null,s=e.selectorList.range;s&&(n=WI.DOMNodeStyles.createSourceCodeLocation(e.sourceURL,{line:s.startLine,column:s.startColumn,documentNode:this._nodeStyles.node.ownerDocument})),this._ownerStyleSheet&&(!n&&this._ownerStyleSheet.isInspectorStyleSheet()&&(n=this._ownerStyleSheet.createSourceCodeLocation(s.startLine,s.startColumn)),n=this._ownerStyleSheet.offsetSourceCodeLocation(n)),this.update(n,t,i,[],this._style,this._mediaList)}}this.dispatchEventToListeners(WI.CSSRule.Event.SelectorChanged,{valid:!!e})}};WI.CSSRule.Event={SelectorChanged:"css-rule-invalid-selector"};WI.CSSSelector=class{constructor(e,t,i){console.assert(e),this._text=e,this._specificity=t||null,this._dynamic=i||!1}get text(){return this._text}get specificity(){return this._specificity}get dynamic(){return this._dynamic}isPseudoElementSelector(){return WI.CSSManager.PseudoElementNames.some(e=>this._text.includes(`:${e}`))}};WI.CSSStyleDeclaration=class extends WI.Object{constructor(e,t,i,n,s,a,d,p,f){super(),console.assert(e),this._nodeStyles=e,this._ownerRule=null,this._ownerStyleSheet=t||null,this._id=i||null,this._type=n||null,this._node=s||null,this._inherited=a||!1,this._initialState=null,this._updatesInProgressCount=0,this._pendingPropertiesChanged=!1,this._locked=!1,this._pendingProperties=[],this._propertyNameMap={},this._properties=[],this._enabledProperties=null,this._visibleProperties=null,this.update(d,p,f,{dontFireEvents:!0})}get initialState(){return this._initialState}get id(){return this._id}get stringId(){return this._id?this._id.styleSheetId+"/"+this._id.ordinal:""}get ownerStyleSheet(){return this._ownerStyleSheet}get type(){return this._type}get inherited(){return this._inherited}get node(){return this._node}get editable(){return this._id?this._type===WI.CSSStyleDeclaration.Type.Rule?this._ownerRule&&this._ownerRule.editable:this._type===WI.CSSStyleDeclaration.Type.Inline?!this._node.isInUserAgentShadowTree():!1:!1}get selectorEditable(){return this._ownerRule&&this._ownerRule.editable}get locked(){return this._locked}set locked(e){this._locked=e}update(e,t,i,n={}){let s=n.dontFireEvents||!1;if(this._updatesInProgressCount>0&&!n.forceUpdate){WI.settings.enableStyleEditingDebugMode.value&&e!==this._text&&console.warn("Style modified while editing:",e);return}if(this._locked&&!n.forceUpdate&&e!==this._text)return;e=e||"",t=t||[];let a=this._properties||[],d=this._text;this._text=e,this._properties=t,this._styleSheetTextRange=i,this._propertyNameMap={},this._enabledProperties=null,this._visibleProperties=null;let p=this.editable;for(let _ of this._properties)_.ownerStyle=this,p?this._pendingProperties.remove(_):this._propertyNameMap[_.name]=_;for(let _ of a)this.enabledProperties.includes(_)||(_.index=NaN,p&&this._pendingProperties.push(_));if(s||d===this._text&&!this._pendingPropertiesChanged&&this._type!==WI.CSSStyleDeclaration.Type.Computed)return;this._pendingPropertiesChanged=!1;function f(){this.dispatchEventToListeners(WI.CSSStyleDeclaration.Event.PropertiesChanged)}setTimeout(f.bind(this),0)}get ownerRule(){return this._ownerRule}set ownerRule(e){this._ownerRule=e||null}get text(){return this._text}set text(e){if(this._text===e)return;let t=e.trim();if(this._text===t)return;(!t.length||this._type===WI.CSSStyleDeclaration.Type.Inline)&&(e=t),this._text=e,++this._updatesInProgressCount;let i=setTimeout(()=>{console.error("Timed out when setting style text:",e),n()},2e3),n=()=>{!i||(clearTimeout(i),i=null,this._updatesInProgressCount=Math.max(0,this._updatesInProgressCount-1),this._pendingPropertiesChanged=!0)};this._nodeStyles.changeStyleText(this,e,n)}get enabledProperties(){return this._enabledProperties||(this._enabledProperties=this._properties.filter(e=>e.enabled)),this._enabledProperties}get properties(){return this._properties}set properties(e){e!==this._properties&&(this._properties=e,this._enabledProperties=null,this._visibleProperties=null)}get visibleProperties(){return this._visibleProperties||(this._visibleProperties=this._properties.filter(e=>!!e.styleDeclarationTextRange)),this._visibleProperties}get pendingProperties(){return this._pendingProperties}get styleSheetTextRange(){return this._styleSheetTextRange}get mediaList(){return this._ownerRule?this._ownerRule.mediaList:[]}get selectorText(){return this._ownerRule?this._ownerRule.selectorText:this._node.appropriateSelectorFor(!0)}propertyForName(e,t){if(console.assert(e),!e)return null;if(!this.editable)return this._propertyNameMap[e]||null;function i(a){for(var d=0;d<a.length;++d){var p=a[d];p.canonicalName!==e&&p.name!==e||n&&!n.overridden&&p.overridden||(n=p)}}var n=null;if(i(this.enabledProperties),n)return n;if(t||!this.editable)return null;if(i(this._pendingProperties,!0),n)return n;var s=new WI.CSSProperty(NaN,null,e);return s.ownerStyle=this,this._pendingProperties.push(s),s}newBlankProperty(e){let t,i,n,s,a,d,p,f=!0,_=!1,b=this._rangeAfterPropertyAtIndex(e-1);this.markModified();let w=new WI.CSSProperty(e,t,i,n,s,f,a,d,p,_,b);this._properties.insertAtIndex(w,e);for(let S=e+1;S<this._properties.length;S++)this._properties[S].index=S;return this.update(this._text,this._properties,this._styleSheetTextRange,{dontFireEvents:!0,forceUpdate:!0}),w}markModified(){if(!this._initialState){let e=this.visibleProperties.map(t=>t.clone());this._initialState=new WI.CSSStyleDeclaration(this._nodeStyles,this._ownerStyleSheet,this._id,this._type,this._node,this._inherited,this._text,e,this._styleSheetTextRange)}WI.cssManager.addModifiedStyle(this)}shiftPropertiesAfter(e,t,i,n){let s=this._properties.indexOf(e);if(s===-1)return;let a=e.styleSheetTextRange.endLine;for(let d=s+1;d<this._properties.length;d++){let p=this._properties[d];p._styleSheetTextRange&&(p.styleSheetTextRange.startLine===a?p._styleSheetTextRange=p._styleSheetTextRange.cloneAndModify(t,i,t,i):p._styleSheetTextRange=p._styleSheetTextRange.cloneAndModify(t,0,t,0)),n&&!isNaN(p._index)&&p._index--}n&&this._properties.splice(s,1),this._enabledProperties=null,this._visibleProperties=null}updatePropertiesModifiedState(){if(!this._initialState||this._type===WI.CSSStyleDeclaration.Type.Computed)return;let e=this._initialState.visibleProperties,t=this.visibleProperties,i=!1;function n(a,d){d!==0&&(i=!0),a.modified=d===1}function s(a,d){return a.equals(d)}Array.diffArrays(e,t,n,s),i||WI.cssManager.removeModifiedStyle(this)}get nodeStyles(){return this._nodeStyles}_rangeAfterPropertyAtIndex(e){return e<0?this._styleSheetTextRange.collapseToStart():e>=this.visibleProperties.length?this._styleSheetTextRange.collapseToEnd():this.visibleProperties[e].styleSheetTextRange.collapseToEnd()}};WI.CSSStyleDeclaration.Event={PropertiesChanged:"css-style-declaration-properties-changed"};WI.CSSStyleDeclaration.Type={Rule:"css-style-declaration-type-rule",Inline:"css-style-declaration-type-inline",Attribute:"css-style-declaration-type-attribute",Computed:"css-style-declaration-type-computed"};WI.CSSStyleSheet=class extends WI.SourceCode{constructor(e){super(),console.assert(e),this._id=e||null,this._url=null,this._parentFrame=null,this._origin=null,this._startLineNumber=0,this._startColumnNumber=0,this._inlineStyleAttribute=!1,this._inlineStyleTag=!1,this._hasInfo=!1}static resetUniqueDisplayNameNumbers(){WI.CSSStyleSheet._nextUniqueDisplayNameNumber=1}get id(){return this._id}get parentFrame(){return this._parentFrame}get origin(){return this._origin}get url(){return this._url}get urlComponents(){return this._urlComponents||(this._urlComponents=parseURL(this._url)),this._urlComponents}get mimeType(){return"text/css"}get displayName(){return this._url?WI.displayNameForURL(this._url,this.urlComponents):(this._uniqueDisplayNameNumber||(this._uniqueDisplayNameNumber=this.constructor._nextUniqueDisplayNameNumber++),WI.UIString("Anonymous StyleSheet %d").format(this._uniqueDisplayNameNumber))}get startLineNumber(){return this._startLineNumber}get startColumnNumber(){return this._startColumnNumber}hasInfo(){return this._hasInfo}isInspectorStyleSheet(){return this._origin===WI.CSSStyleSheet.Type.Inspector}isInlineStyleTag(){return this._inlineStyleTag}isInlineStyleAttributeStyleSheet(){return this._inlineStyleAttribute}markAsInlineStyleAttributeStyleSheet(){this._inlineStyleAttribute=!0}offsetSourceCodeLocation(e){if(!e)return null;if(!this._hasInfo)return e;let t=e.sourceCode,i=this._startLineNumber+e.lineNumber,n=this._startColumnNumber+e.columnNumber;return t.createSourceCodeLocation(i,n)}updateInfo(e,t,i,n,s,a){this._hasInfo=!0,this._url=e||null,this._urlComponents=void 0,this._parentFrame=t||null,this._origin=i,this._inlineStyleTag=n,this._startLineNumber=s,this._startColumnNumber=a}get revisionForRequestedContent(){return this.currentRevision}handleCurrentRevisionContentChange(){if(!this._id)return;function e(t){t||(DOMAgent.markUndoableState(),this.dispatchEventToListeners(WI.CSSStyleSheet.Event.ContentDidChange))}this._ignoreNextContentDidChangeNotification=!0,CSSAgent.setStyleSheetText(this._id,this.currentRevision.content,e.bind(this))}requestContentFromBackend(){return this._id?CSSAgent.getStyleSheetText(this._id):Promise.reject(new Error("There is no identifier to request content with."))}noteContentDidChange(){return this._ignoreNextContentDidChangeNotification?(this._ignoreNextContentDidChangeNotification=!1,!1):(this.markContentAsStale(),this.dispatchEventToListeners(WI.CSSStyleSheet.Event.ContentDidChange),!0)}};WI.CSSStyleSheet._nextUniqueDisplayNameNumber=1;WI.CSSStyleSheet.Event={ContentDidChange:"stylesheet-content-did-change"};WI.CSSStyleSheet.Type={Author:"css-stylesheet-type-author",User:"css-stylesheet-type-user",UserAgent:"css-stylesheet-type-user-agent",Inspector:"css-stylesheet-type-inspector"};WI.CallFrame=class{constructor(e,t,i,n,s,a,d,p,f){console.assert(e instanceof WI.Target),console.assert(!i||i instanceof WI.SourceCodeLocation),console.assert(!s||s instanceof WI.RemoteObject),console.assert(!a||a instanceof Array),this._isConsoleEvaluation=i&&isWebInspectorConsoleEvaluationScript(i.sourceCode.sourceURL),this._isConsoleEvaluation&&(n=WI.UIString("Console Evaluation"),p=!0),this._target=e,this._id=t||null,this._sourceCodeLocation=i||null,this._functionName=n||"",this._thisObject=s||null,this._scopeChain=a||[],this._nativeCode=d||!1,this._programCode=p||!1,this._isTailDeleted=f||!1}get target(){return this._target}get id(){return this._id}get sourceCodeLocation(){return this._sourceCodeLocation}get functionName(){return this._functionName}get nativeCode(){return this._nativeCode}get programCode(){return this._programCode}get thisObject(){return this._thisObject}get scopeChain(){return this._scopeChain}get isTailDeleted(){return this._isTailDeleted}get isConsoleEvaluation(){return this._isConsoleEvaluation}saveIdentityToCookie(){}collectScopeChainVariableNames(e){var t={this:!0,__proto__:null},i=this._scopeChain.length;function n(a){for(var d=0;a&&d<a.length;++d)t[a[d].name]=!0;--i||e(t)}for(var s=0;s<this._scopeChain.length;++s)this._scopeChain[s].objects[0].deprecatedGetAllProperties(n)}mergedScopeChain(){let e=[],t=this._scopeChain.slice(),i=null;function n(p){return!p.hash||p.type!==WI.ScopeChainNode.Type.Closure||p.hash===i?!1:(i=p.hash,p.__baseClosureScope=!0,!0)}function s(p,f,_){return!(!p||!f||!p.hash||!f.hash||p.type!==WI.ScopeChainNode.Type.Closure||f.type!==WI.ScopeChainNode.Type.Closure||p.hash!==f.hash||_&&p.hash===_.hash)}let a=null,d=null;for(let p=t.length-1;p>=0;--p){let f=t[p];if(n(f),s(f,a,d)){console.assert(a.__baseClosureScope);let _=WI.ScopeChainNode.Type.Closure,b=a.objects.concat(f.objects),w=new WI.ScopeChainNode(_,b,f.name,f.location);w.__baseClosureScope=!0,console.assert(b.length===2),e.pop(),e.push(w),d=w,a=null}else e.push(f),d=null,a=f}e=e.reverse();for(let p of e)if(p.type===WI.ScopeChainNode.Type.Closure){p.name===this._functionName&&p.convertToLocalScope();break}return e}static functionNameFromPayload(e){let t=e.functionName;return t==="global code"?WI.UIString("Global Code"):t==="eval code"?WI.UIString("Eval Code"):t==="module code"?WI.UIString("Module Code"):t}static programCodeFromPayload(e){return e.functionName.endsWith(" code")}static fromDebuggerPayload(e,t,i,n){let s=t.callFrameId,a=WI.RemoteObject.fromPayload(t.this,e),d=WI.CallFrame.functionNameFromPayload(t),p=!1,f=WI.CallFrame.programCodeFromPayload(t),_=t.isTailDeleted;return new WI.CallFrame(e,s,n,d,a,i,p,f,_)}static fromPayload(e,t){console.assert(t);let{url:i,scriptId:n}=t,s=!1,a=null,d=WI.CallFrame.functionNameFromPayload(t),p=WI.CallFrame.programCodeFromPayload(t);if(i==="[native code]")s=!0,i=null;else if(i||n){let S=null;if(n&&(S=WI.debuggerManager.scriptForIdentifier(n,e),S&&S.resource&&(S=S.resource)),S||(S=WI.networkManager.resourceForURL(i)),S||(S=WI.debuggerManager.scriptsForURL(i,e)[0]),S){let E=t.lineNumber-1;a=S.createLazySourceCodeLocation(E,t.columnNumber)}else console.assert(!i,"We should have detected source code for something with a url"),s=!0,i=null}const f=null,_=null,b=null,w=!1;return new WI.CallFrame(e,f,a,d,_,b,s,p,w)}};WI.CallingContextTree=class{constructor(e){this._type=e||WI.CallingContextTree.Type.TopDown,this.reset()}get type(){return this._type}get totalNumberOfSamples(){return this._totalNumberOfSamples}reset(){this._root=new WI.CallingContextTreeNode(-1,-1,-1,"<root>",null),this._totalNumberOfSamples=0}totalDurationInTimeRange(e,t){return this._root.filteredTimestampsAndDuration(e,t).duration}updateTreeWithStackTrace({timestamp:e,stackFrames:t},i){this._totalNumberOfSamples++;let n=this._root;switch(n.addTimestampAndExpressionLocation(e,i,null),this._type){case WI.CallingContextTree.Type.TopDown:for(let s=t.length;s--;){let a=t[s];n=n.findOrMakeChild(a),n.addTimestampAndExpressionLocation(e,i,a.expressionLocation||null,s===0)}break;case WI.CallingContextTree.Type.BottomUp:for(let s=0;s<t.length;++s){let a=t[s];n=n.findOrMakeChild(a),n.addTimestampAndExpressionLocation(e,i,a.expressionLocation||null,s===0)}break;case WI.CallingContextTree.Type.TopFunctionsTopDown:for(let s=t.length;s--;){n=this._root;for(let a=s+1;a--;){let d=t[a];n=n.findOrMakeChild(d),n.addTimestampAndExpressionLocation(e,i,d.expressionLocation||null,a===0)}}break;case WI.CallingContextTree.Type.TopFunctionsBottomUp:for(let s=0;s<t.length;s++){n=this._root;for(let a=s;a<t.length;a++){let d=t[a];n=n.findOrMakeChild(d),n.addTimestampAndExpressionLocation(e,i,d.expressionLocation||null,a===0)}}break;default:console.assert(!1,"This should not be reached.");break}}toCPUProfilePayload(e,t){let i={},n=[],s=this._root.filteredTimestampsAndDuration(e,t).timestamps.length;return this._root.forEachChild(a=>{a.hasStackTraceInTimeRange(e,t)&&n.push(a.toCPUProfileNode(s,e,t))}),i.rootNodes=n,i}forEachChild(e){this._root.forEachChild(e)}forEachNode(e){this._root.forEachNode(e)}static __test_makeTreeFromProtocolMessageObject(e){let t=new WI.CallingContextTree,i=e.params.samples.stackTraces;for(let n=0;n<i.length;n++)t.updateTreeWithStackTrace(i[n]);return t}__test_matchesStackTrace(e){let t=this.__test_buildLeafLinkedLists();e:for(let i of t){for(let n of e){for(let s of Object.getOwnPropertyNames(n))if(n[s]!==i[s])continue e;i=i.parent}return!0}return!1}__test_buildLeafLinkedLists(){let e=[],t=null;return this._root.__test_buildLeafLinkedLists(t,e),e}};WI.CallingContextTree.Type={TopDown:Symbol("TopDown"),BottomUp:Symbol("BottomUp"),TopFunctionsTopDown:Symbol("TopFunctionsTopDown"),TopFunctionsBottomUp:Symbol("TopFunctionsBottomUp")};WI.CallingContextTreeNode=class{constructor(e,t,i,n,s,a){this._children={},this._sourceID=e,this._line=t,this._column=i,this._name=n,this._url=s,this._uid=WI.CallingContextTreeNode.__uid++,this._timestamps=[],this._durations=[],this._leafTimestamps=[],this._leafDurations=[],this._expressionLocations={},this._hash=a||WI.CallingContextTreeNode._hash(this)}static _hash(e){return e.name+":"+e.sourceID+":"+e.line+":"+e.column}get sourceID(){return this._sourceID}get line(){return this._line}get column(){return this._column}get name(){return this._name}get uid(){return this._uid}get url(){return this._url}get hash(){return this._hash}hasChildrenInTimeRange(e,t){for(let i of Object.getOwnPropertyNames(this._children))if(this._children[i].hasStackTraceInTimeRange(e,t))return!0;return!1}hasStackTraceInTimeRange(e,t){if(console.assert(e<=t),e>t)return!1;let i=this._timestamps,n=i.length;if(!n)return!1;let s=i.lowerBound(e);return s===n?!1:(console.assert(e<=i[s]),i[s]<=t)}filteredTimestampsAndDuration(e,t){let i=this._timestamps.lowerBound(e),n=this._timestamps.upperBound(t),s=0;for(let a=i;a<n;++a)s+=this._durations[a];return{timestamps:this._timestamps.slice(i,n),duration:s}}filteredLeafTimestampsAndDuration(e,t){let i=this._leafTimestamps.lowerBound(e),n=this._leafTimestamps.upperBound(t),s=0;for(let a=i;a<n;++a)s+=this._leafDurations[a];return{leafTimestamps:this._leafTimestamps.slice(i,n),leafDuration:s}}hasChildren(){return!isEmptyObject(this._children)}findOrMakeChild(e){let t=WI.CallingContextTreeNode._hash(e),i=this._children[t];return i||(i=new WI.CallingContextTreeNode(e.sourceID,e.line,e.column,e.name,e.url,t),this._children[t]=i,i)}addTimestampAndExpressionLocation(e,t,i,n){if(console.assert(!this._timestamps.length||this._timestamps.lastValue<=e,"Expected timestamps to be added in sorted, increasing, order."),this._timestamps.push(e),this._durations.push(t),n&&(this._leafTimestamps.push(e),this._leafDurations.push(t)),!i)return;let{line:s,column:a}=i,d=s+":"+a,p=this._expressionLocations[d];p||(p=[],this._expressionLocations[d]=p),console.assert(!p.length||p.lastValue<=e,"Expected timestamps to be added in sorted, increasing, order."),p.push(e)}forEachChild(e){for(let t of Object.getOwnPropertyNames(this._children))e(this._children[t])}forEachNode(e){e(this),this.forEachChild(function(t){t.forEachNode(e)})}equals(e){return this._hash===e.hash}toCPUProfileNode(e,t,i){let n=[];this.forEachChild(f=>{f.hasStackTraceInTimeRange(t,i)&&n.push(f.toCPUProfileNode(e,t,i))});let s={id:this._uid,functionName:this._name,url:this._url,lineNumber:this._line,columnNumber:this._column,children:n},a=[],d=Number.MAX_VALUE,p=Number.MIN_VALUE;for(let f=0;f<this._timestamps.length;f++){let _=this._timestamps[f];t<=_&&_<=i&&(a.push(_),d=Math.min(d,_),p=Math.max(p,_))}return s.callInfo={callCount:a.length,startTime:d,endTime:p,totalTime:a.length/e*(i-t)},s}__test_buildLeafLinkedLists(e,t){let i={name:this._name,url:this._url,parent:e};this.hasChildren()?this.forEachChild(n=>{n.__test_buildLeafLinkedLists(i,t)}):t.push(i)}};WI.CallingContextTreeNode.__uid=0;WI.Canvas=class extends WI.Object{constructor(e,t,{domNode:i,cssCanvasName:n,contextAttributes:s,memoryCost:a,backtrace:d}={}){super(),console.assert(e),console.assert(t),this._identifier=e,this._contextType=t,this._domNode=i||null,this._cssCanvasName=n||"",this._contextAttributes=s||{},this._extensions=new Set,this._memoryCost=a||NaN,this._backtrace=d||[],this._cssCanvasClientNodes=null,this._shaderProgramCollection=new WI.ShaderProgramCollection,this._recordingCollection=new WI.RecordingCollection,this._nextShaderProgramDisplayNumber=1,this._requestNodePromise=null,this._recordingState=WI.Canvas.RecordingState.Inactive,this._recordingFrames=[],this._recordingBufferUsed=0}static fromPayload(e){let t=null;switch(e.contextType){case CanvasAgent.ContextType.Canvas2D:t=WI.Canvas.ContextType.Canvas2D;break;case CanvasAgent.ContextType.BitmapRenderer:t=WI.Canvas.ContextType.BitmapRenderer;break;case CanvasAgent.ContextType.WebGL:t=WI.Canvas.ContextType.WebGL;break;case CanvasAgent.ContextType.WebGL2:t=WI.Canvas.ContextType.WebGL2;break;case CanvasAgent.ContextType.WebGPU:t=WI.Canvas.ContextType.WebGPU;break;case CanvasAgent.ContextType.WebMetal:t=WI.Canvas.ContextType.WebMetal;break;default:console.error("Invalid canvas context type",e.contextType)}return new WI.Canvas(e.canvasId,t,{domNode:e.nodeId?WI.domManager.nodeForId(e.nodeId):null,cssCanvasName:e.cssCanvasName,contextAttributes:e.contextAttributes,memoryCost:e.memoryCost,backtrace:Array.isArray(e.backtrace)?e.backtrace.map(i=>WI.CallFrame.fromPayload(WI.mainTarget,i)):[]})}static displayNameForContextType(e){switch(e){case WI.Canvas.ContextType.Canvas2D:return WI.UIString("2D");case WI.Canvas.ContextType.BitmapRenderer:return WI.unlocalizedString("Bitmap Renderer");case WI.Canvas.ContextType.WebGL:return WI.unlocalizedString("WebGL");case WI.Canvas.ContextType.WebGL2:return WI.unlocalizedString("WebGL2");case WI.Canvas.ContextType.WebGPU:return WI.unlocalizedString("Web GPU");case WI.Canvas.ContextType.WebMetal:return WI.unlocalizedString("WebMetal");default:console.error("Invalid canvas context type",e)}}static resetUniqueDisplayNameNumbers(){WI.Canvas._nextUniqueDisplayNameNumber=1}get identifier(){return this._identifier}get contextType(){return this._contextType}get cssCanvasName(){return this._cssCanvasName}get contextAttributes(){return this._contextAttributes}get extensions(){return this._extensions}get backtrace(){return this._backtrace}get shaderProgramCollection(){return this._shaderProgramCollection}get recordingCollection(){return this._recordingCollection}get recordingFrameCount(){return this._recordingFrames.length}get recordingBufferUsed(){return this._recordingBufferUsed}get recordingActive(){return this._recordingState!==WI.Canvas.RecordingState.Inactive}get memoryCost(){return this._memoryCost}set memoryCost(e){e!==this._memoryCost&&(this._memoryCost=e,this.dispatchEventToListeners(WI.Canvas.Event.MemoryChanged))}get displayName(){if(this._cssCanvasName)return WI.UIString("CSS canvas \u201C%s\u201D").format(this._cssCanvasName);if(this._domNode){let e=this._domNode.escapedIdSelector;if(e)return WI.UIString("Canvas %s").format(e)}return this._uniqueDisplayNameNumber||(this._uniqueDisplayNameNumber=this.constructor._nextUniqueDisplayNameNumber++),WI.UIString("Canvas %d").format(this._uniqueDisplayNameNumber)}requestNode(){return this._requestNodePromise||(this._requestNodePromise=new Promise((e,t)=>{WI.domManager.ensureDocument(),CanvasAgent.requestNode(this._identifier).then(i=>{if(this._domNode=WI.domManager.nodeForId(i.nodeId),!this._domNode){t(`No DOM node for identifier: ${i.nodeId}.`);return}e(this._domNode)}).catch(t)})),this._requestNodePromise}requestContent(){return CanvasAgent.requestContent(this._identifier).then(e=>e.content).catch(e=>console.error(e))}requestCSSCanvasClientNodes(e){if(!this._cssCanvasName){e([]);return}if(this._cssCanvasClientNodes){e(this._cssCanvasClientNodes);return}WI.domManager.ensureDocument(),CanvasAgent.requestCSSCanvasClientNodes(this._identifier,(t,i)=>{if(t){e([]);return}i=Array.isArray(i)?i:[],this._cssCanvasClientNodes=i.map(n=>WI.domManager.nodeForId(n)),e(this._cssCanvasClientNodes)})}requestSize(){function e(i){function n(s){let a=Number(i.getAttribute(s));return!Number.isInteger(a)||a<0?NaN:a}return{width:n("width"),height:n("height")}}function t(i,n){return new Promise((s,a)=>{i.getProperty(n,(d,p)=>{if(d){a(d);return}s(p)})})}return this.requestNode().then(i=>{let n=e(i);if(!isNaN(n.width)&&!isNaN(n.height))return n;let s=null;return WI.RemoteObject.resolveNode(i).then(a=>(s=a,Promise.all([t(a,"width"),t(a,"height")]))).then(a=>{let d=a[0].value,p=a[1].value;return a[0].release(),a[1].release(),s.release(),{width:d,height:p}})})}startRecording(e){let t=i=>{if(i){console.error(i);return}this._recordingState=WI.Canvas.RecordingState.ActiveFrontend,!InspectorBackend.domains.Canvas.hasEvent("recordingStarted")&&(this._recordingFrames=[],this._recordingBufferUsed=0,this.dispatchEventToListeners(WI.Canvas.Event.RecordingStarted))};if(InspectorBackend.domains.Canvas.startRecording.supports("singleFrame")){CanvasAgent.startRecording(this._identifier,e,t);return}e?CanvasAgent.startRecording(this._identifier,1,t):CanvasAgent.startRecording(this._identifier,t)}stopRecording(){CanvasAgent.stopRecording(this._identifier,e=>{e&&console.error(e)})}saveIdentityToCookie(e){this._cssCanvasName?e[WI.Canvas.CSSCanvasNameCookieKey]=this._cssCanvasName:this._domNode&&(e[WI.Canvas.NodePathCookieKey]=this._domNode.path)}enableExtension(e){this._extensions.add(e),this.dispatchEventToListeners(WI.Canvas.Event.ExtensionEnabled,{extension:e})}cssCanvasClientNodesChanged(){!this._cssCanvasName||(this._cssCanvasClientNodes=null,this.dispatchEventToListeners(WI.Canvas.Event.CSSCanvasClientNodesChanged))}recordingStarted(e){e===RecordingAgent.Initiator.Console?this._recordingState=WI.Canvas.RecordingState.ActiveConsole:e===RecordingAgent.Initiator.AutoCapture?this._recordingState=WI.Canvas.RecordingState.ActiveAutoCapture:(console.assert(e===RecordingAgent.Initiator.Frontend),this._recordingState=WI.Canvas.RecordingState.ActiveFrontend),this._recordingFrames=[],this._recordingBufferUsed=0,this.dispatchEventToListeners(WI.Canvas.Event.RecordingStarted)}recordingProgress(e,t){this._recordingFrames.push(...e.map(WI.RecordingFrame.fromPayload)),this._recordingBufferUsed=t,this.dispatchEventToListeners(WI.Canvas.Event.RecordingProgress)}recordingFinished(e){let t=this._recordingState===WI.Canvas.RecordingState.ActiveFrontend;!t&&!InspectorBackend.domains.Canvas.hasEvent("recordingStarted")&&(t=!!this.recordingActive);let i=e?WI.Recording.fromPayload(e,this._recordingFrames):null;i&&(i.source=this,i.createDisplayName(e.name),this._recordingCollection.add(i)),this._recordingState=WI.Canvas.RecordingState.Inactive,this._recordingFrames=[],this._recordingBufferUsed=0,this.dispatchEventToListeners(WI.Canvas.Event.RecordingStopped,{recording:i,initiatedByUser:t})}nextShaderProgramDisplayNumber(){return this._nextShaderProgramDisplayNumber++}};WI.Canvas._nextUniqueDisplayNameNumber=1;WI.Canvas.FrameURLCookieKey="canvas-frame-url";WI.Canvas.CSSCanvasNameCookieKey="canvas-css-canvas-name";WI.Canvas.ContextType={Canvas2D:"canvas-2d",BitmapRenderer:"bitmaprenderer",WebGL:"webgl",WebGL2:"webgl2",WebGPU:"webgpu",WebMetal:"webmetal"};WI.Canvas.RecordingState={Inactive:"canvas-recording-state-inactive",ActiveFrontend:"canvas-recording-state-active-frontend",ActiveConsole:"canvas-recording-state-active-console",ActiveAutoCapture:"canvas-recording-state-active-auto-capture"};WI.Canvas.Event={MemoryChanged:"canvas-memory-changed",ExtensionEnabled:"canvas-extension-enabled",CSSCanvasClientNodesChanged:"canvas-css-canvas-client-nodes-changed",RecordingStarted:"canvas-recording-started",RecordingProgress:"canvas-recording-progress",RecordingStopped:"canvas-recording-stopped"};WI.Collection=class extends WI.Object{constructor(e=[]){super(),this._items=new Set;for(let t of e)this.add(t)}get size(){return this._items.size}get displayName(){throw WI.NotImplementedError.subclassMustOverride()}objectIsRequiredType(e){throw WI.NotImplementedError.subclassMustOverride()}add(e){let t=this.objectIsRequiredType(e);console.assert(t),t&&(console.assert(!this._items.has(e)),this._items.add(e),this.itemAdded(e),this.dispatchEventToListeners(WI.Collection.Event.ItemAdded,{item:e}))}remove(e){let t=this._items.delete(e);console.assert(t),this.itemRemoved(e),this.dispatchEventToListeners(WI.Collection.Event.ItemRemoved,{item:e})}has(...e){return this._items.has(...e)}clear(){let e=new Set(this._items);this._items.clear(),this.itemsCleared(e);for(let t of e)this.dispatchEventToListeners(WI.Collection.Event.ItemRemoved,{item:t})}toJSON(){return Array.from(this)}[Symbol.iterator](){return this._items[Symbol.iterator]()}itemAdded(e){}itemRemoved(e){}itemsCleared(e){}};WI.Collection.Event={ItemAdded:"collection-item-added",ItemRemoved:"collection-item-removed"};WI.CollectionEntry=class{constructor(e,t){console.assert(t instanceof WI.RemoteObject),console.assert(!e||e instanceof WI.RemoteObject),this._key=e,this._value=t}static fromPayload(e,t){return e.key&&(e.key=WI.RemoteObject.fromPayload(e.key,t)),e.value&&(e.value=WI.RemoteObject.fromPayload(e.value,t)),new WI.CollectionEntry(e.key,e.value)}get key(){return this._key}get value(){return this._value}};WI.CollectionEntryPreview=class{constructor(e,t){console.assert(t instanceof WI.ObjectPreview),console.assert(!e||e instanceof WI.ObjectPreview),this._key=e,this._value=t}static fromPayload(e){return e.key&&(e.key=WI.ObjectPreview.fromPayload(e.key)),e.value&&(e.value=WI.ObjectPreview.fromPayload(e.value)),new WI.CollectionEntryPreview(e.key,e.value)}get keyPreview(){return this._key}get valuePreview(){return this._value}};WI.FrameCollection=class extends WI.Collection{get displayName(){return WI.UIString("Frames")}objectIsRequiredType(e){return e instanceof WI.Frame}};WI.ScriptCollection=class extends WI.Collection{get displayName(){return WI.UIString("Scripts")}objectIsRequiredType(e){return e instanceof WI.Script}};WI.CSSStyleSheetCollection=class extends WI.Collection{get displayName(){return WI.UIString("Stylesheets")}objectIsRequiredType(e){return e instanceof WI.CSSStyleSheet}};WI.CanvasCollection=class extends WI.Collection{get displayName(){return WI.UIString("Canvases")}objectIsRequiredType(e){return e instanceof WI.Canvas}};WI.ShaderProgramCollection=class extends WI.Collection{get displayName(){return WI.UIString("Shader Programs")}objectIsRequiredType(e){return e instanceof WI.ShaderProgram}};WI.RecordingCollection=class extends WI.Collection{get displayName(){return WI.UIString("Recordings")}objectIsRequiredType(e){return e instanceof WI.Recording}};WI.Color=class{constructor(e,t){this.format=e,t.length===3&&t.push(1),e===WI.Color.Format.HSL||e===WI.Color.Format.HSLA?this._hsla=t:this._rgba=t,this.valid=!t.some(isNaN)}static fromString(e){const t=/^(?:#(?<hex>[0-9a-f]{3,8})|rgba?\((?<rgb>[^)]+)\)|(?<keyword>\w+)|hsla?\((?<hsl>[^)]+)\))$/i;let i=e.match(t);if(!i)return null;if(i.groups.hex){let f=i.groups.hex.toUpperCase();switch(f.length){case 3:return new WI.Color(WI.Color.Format.ShortHEX,[parseInt(f.charAt(0)+f.charAt(0),16),parseInt(f.charAt(1)+f.charAt(1),16),parseInt(f.charAt(2)+f.charAt(2),16),1]);case 6:return new WI.Color(WI.Color.Format.HEX,[parseInt(f.substring(0,2),16),parseInt(f.substring(2,4),16),parseInt(f.substring(4,6),16),1]);case 4:return new WI.Color(WI.Color.Format.ShortHEXAlpha,[parseInt(f.charAt(0)+f.charAt(0),16),parseInt(f.charAt(1)+f.charAt(1),16),parseInt(f.charAt(2)+f.charAt(2),16),parseInt(f.charAt(3)+f.charAt(3),16)/255]);case 8:return new WI.Color(WI.Color.Format.HEXAlpha,[parseInt(f.substring(0,2),16),parseInt(f.substring(2,4),16),parseInt(f.substring(4,6),16),parseInt(f.substring(6,8),16)/255])}return null}if(i.groups.keyword){let f=i.groups.keyword.toLowerCase();if(!WI.Color.Keywords.hasOwnProperty(f))return null;let _=new WI.Color(WI.Color.Format.Keyword,WI.Color.Keywords[f].slice());return _.keyword=f,_.original=e,_}function n(f){return f.trim().replace(/(\s*(,|\/)\s*|\s+)/g,"|").split("|")}function s(f){let _=parseFloat(f);return f.includes("%")&&(_/=100),Number.constrain(_,0,1)}if(i.groups.rgb){let _=function(w){let S=parseFloat(w);return w.includes("%")&&(S=S*255/100),Number.constrain(S,0,255)};var a=_;let f=n(i.groups.rgb);if(f.length!==3&&f.length!==4)return null;let b=1;return f.length===4&&(b=s(f[3])),new WI.Color(f.length===4?WI.Color.Format.RGBA:WI.Color.Format.RGB,[_(f[0]),_(f[1]),_(f[2]),b])}if(i.groups.hsl){let b=function(S){let E=parseFloat(S);return/(\b|\d)rad\b/.test(S)?E=E*180/Math.PI:/(\b|\d)grad\b/.test(S)?E=E*360/400:/(\b|\d)turn\b/.test(S)&&(E=E*360),Number.constrain(E,0,360)},w=function(S){let E=parseFloat(S);return Number.constrain(E,0,100)};var d=b,p=w;let f=n(i.groups.hsl);if(f.length!==3&&f.length!==4)return null;let _=1;return f.length===4&&(_=s(f[3])),new WI.Color(f.length===4?WI.Color.Format.HSLA:WI.Color.Format.HSL,[b(f[0]),w(f[1]),w(f[2]),_])}return null}static rgb2hsl(e,t,i){e=WI.Color._eightBitChannel(e)/255,t=WI.Color._eightBitChannel(t)/255,i=WI.Color._eightBitChannel(i)/255;let n=Math.min(e,t,i),s=Math.max(e,t,i),a=s-n,d=0,p=0,f=(s+n)/2;return a===0?d=0:s===e?d=60*((t-i)/a)%360:s===t?d=60*((i-e)/a)+120:s===i&&(d=60*((e-t)/a)+240),d<0&&(d+=360),a===0?p=0:p=a/(1-Math.abs(2*f-1)),[d,p*100,f*100]}static hsl2rgb(e,t,i){e=Number.constrain(e,0,360)%360,t=Number.constrain(t,0,100)/100,i=Number.constrain(i,0,100)/100;let n=(1-Math.abs(2*i-1))*t,s=n*(1-Math.abs(e/60%2-1)),a=i-n/2,d=0,p=0,f=0;return e<60?(d=n,p=s):e<120?(d=s,p=n):e<180?(p=n,f=s):e<240?(p=s,f=n):e<300?(d=s,f=n):e<360&&(d=n,f=s),[(d+a)*255,(p+a)*255,(f+a)*255]}static cmyk2rgb(e,t,i,n){return e=Number.constrain(e,0,1),t=Number.constrain(t,0,1),i=Number.constrain(i,0,1),n=Number.constrain(n,0,1),[255*(1-e)*(1-n),255*(1-t)*(1-n),255*(1-i)*(1-n)]}static normalized2rgb(e,t,i){return[WI.Color._eightBitChannel(e*255),WI.Color._eightBitChannel(t*255),WI.Color._eightBitChannel(i*255)]}static _eightBitChannel(e){return Number.constrain(Math.round(e),0,255)}nextFormat(e){switch(e=e||this.format,e){case WI.Color.Format.Original:case WI.Color.Format.HEX:case WI.Color.Format.HEXAlpha:return this.simple?WI.Color.Format.RGB:WI.Color.Format.RGBA;case WI.Color.Format.RGB:case WI.Color.Format.RGBA:return this.simple?WI.Color.Format.HSL:WI.Color.Format.HSLA;case WI.Color.Format.HSL:case WI.Color.Format.HSLA:return this.isKeyword()?WI.Color.Format.Keyword:this.simple?this.canBeSerializedAsShortHEX()?WI.Color.Format.ShortHEX:WI.Color.Format.HEX:this.canBeSerializedAsShortHEX()?WI.Color.Format.ShortHEXAlpha:WI.Color.Format.HEXAlpha;case WI.Color.Format.ShortHEX:return WI.Color.Format.HEX;case WI.Color.Format.ShortHEXAlpha:return WI.Color.Format.HEXAlpha;case WI.Color.Format.Keyword:return this.simple?this.canBeSerializedAsShortHEX()?WI.Color.Format.ShortHEX:WI.Color.Format.HEX:this.canBeSerializedAsShortHEX()?WI.Color.Format.ShortHEXAlpha:WI.Color.Format.HEXAlpha;default:return console.error("Unknown color format."),null}}get alpha(){return this._rgba?this._rgba[3]:this._hsla[3]}get simple(){return this.alpha===1}get rgb(){let e=this.rgba.slice();return e.pop(),e}get hsl(){let e=this.hsla.slice();return e.pop(),e}get rgba(){return this._rgba||(this._rgba=this._hslaToRGBA(this._hsla)),this._rgba}get hsla(){return this._hsla||(this._hsla=this._rgbaToHSLA(this.rgba)),this._hsla}copy(){switch(this.format){case WI.Color.Format.RGB:case WI.Color.Format.HEX:case WI.Color.Format.ShortHEX:case WI.Color.Format.HEXAlpha:case WI.Color.Format.ShortHEXAlpha:case WI.Color.Format.Keyword:case WI.Color.Format.RGBA:return new WI.Color(this.format,this.rgba);case WI.Color.Format.HSL:case WI.Color.Format.HSLA:return new WI.Color(this.format,this.hsla)}}toString(e){switch(e||(e=this.format),e){case WI.Color.Format.Original:return this._toOriginalString();case WI.Color.Format.RGB:return this._toRGBString();case WI.Color.Format.RGBA:return this._toRGBAString();case WI.Color.Format.HSL:return this._toHSLString();case WI.Color.Format.HSLA:return this._toHSLAString();case WI.Color.Format.HEX:return this._toHEXString();case WI.Color.Format.ShortHEX:return this._toShortHEXString();case WI.Color.Format.HEXAlpha:return this._toHEXAlphaString();case WI.Color.Format.ShortHEXAlpha:return this._toShortHEXAlphaString();case WI.Color.Format.Keyword:return this._toKeywordString()}return console.error("Invalid color format: "+e),""}isKeyword(){if(this.keyword)return!0;if(!this.simple)return Array.shallowEqual(this._rgba,[0,0,0,0])||Array.shallowEqual(this._hsla,[0,0,0,0]);let e=this._rgba&&this._rgba.slice(0,3)||WI.Color.hsl2rgb(...this._hsla);return Object.keys(WI.Color.Keywords).some(t=>Array.shallowEqual(WI.Color.Keywords[t],e))}canBeSerializedAsShortHEX(){let e=this.rgba||this._hslaToRGBA(this._hsla),t=this._componentToHexValue(e[0]);if(t[0]!==t[1])return!1;let i=this._componentToHexValue(e[1]);if(i[0]!==i[1])return!1;let n=this._componentToHexValue(e[2]);if(n[0]!==n[1])return!1;if(!this.simple){let s=this._componentToHexValue(Math.round(e[3]*255));if(s[0]!==s[1])return!1}return!0}_toOriginalString(){return this.original||this._toKeywordString()}_toKeywordString(){if(this.keyword)return this.keyword;let e=this.rgba;if(!this.simple)return e[0]===0&&e[1]===0&&e[2]===0&&e[3]===0?"transparent":this._toRGBAString();let t=WI.Color.Keywords;for(let i in t){if(!t.hasOwnProperty(i))continue;let n=t[i];if(n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2])return i}return this._toRGBString()}_toShortHEXString(){if(!this.simple)return this._toRGBAString();let e=this.rgba,t=this._componentToHexValue(e[0]),i=this._componentToHexValue(e[1]),n=this._componentToHexValue(e[2]);return t[0]===t[1]&&i[0]===i[1]&&n[0]===n[1]?"#"+t[0]+i[0]+n[0]:"#"+t+i+n}_toHEXString(){if(!this.simple)return this._toRGBAString();let e=this.rgba,t=this._componentToHexValue(e[0]),i=this._componentToHexValue(e[1]),n=this._componentToHexValue(e[2]);return"#"+t+i+n}_toShortHEXAlphaString(){let e=this.rgba,t=this._componentToHexValue(e[0]),i=this._componentToHexValue(e[1]),n=this._componentToHexValue(e[2]),s=this._componentToHexValue(Math.round(e[3]*255));return t[0]===t[1]&&i[0]===i[1]&&n[0]===n[1]&&s[0]===s[1]?"#"+t[0]+i[0]+n[0]+s[0]:"#"+t+i+n+s}_toHEXAlphaString(){let e=this.rgba,t=this._componentToHexValue(e[0]),i=this._componentToHexValue(e[1]),n=this._componentToHexValue(e[2]),s=this._componentToHexValue(Math.round(e[3]*255));return"#"+t+i+n+s}_toRGBString(){if(!this.simple)return this._toRGBAString();let e=WI.Color._eightBitChannel(Math.round(this.rgba[0])),t=WI.Color._eightBitChannel(Math.round(this.rgba[1])),i=WI.Color._eightBitChannel(Math.round(this.rgba[2]));return`rgb(${e}, ${t}, ${i})`}_toRGBAString(){let e=WI.Color._eightBitChannel(Math.round(this.rgba[0])),t=WI.Color._eightBitChannel(Math.round(this.rgba[1])),i=WI.Color._eightBitChannel(Math.round(this.rgba[2]));return`rgba(${e}, ${t}, ${i}, ${this.alpha})`}_toHSLString(){if(!this.simple)return this._toHSLAString();let e=this.hsla[0].maxDecimals(2),t=this.hsla[1].maxDecimals(2),i=this.hsla[2].maxDecimals(2);return`hsl(${e}, ${t}%, ${i}%)`}_toHSLAString(){let e=this.hsla[0].maxDecimals(2),t=this.hsla[1].maxDecimals(2),i=this.hsla[2].maxDecimals(2);return`hsla(${e}, ${t}%, ${i}%, ${this.alpha})`}_componentToHexValue(e){let t=WI.Color._eightBitChannel(e).toString(16);return t.length===1&&(t="0"+t),t}_rgbaToHSLA(e){let t=WI.Color.rgb2hsl(...e);return t.push(e[3]),t}_hslaToRGBA(e){let t=WI.Color.hsl2rgb(...e);return t.push(e[3]),t}};WI.Color.Format={Original:"color-format-original",Keyword:"color-format-keyword",HEX:"color-format-hex",ShortHEX:"color-format-short-hex",HEXAlpha:"color-format-hex-alpha",ShortHEXAlpha:"color-format-short-hex-alpha",RGB:"color-format-rgb",RGBA:"color-format-rgba",HSL:"color-format-hsl",HSLA:"color-format-hsla"};WI.Color.FunctionNames=new Set(["rgb","rgba","hsl","hsla"]);WI.Color.Keywords={aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[237,164,61,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],transparent:[0,0,0,0],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};WI.ConsoleCommandResultMessage=class extends WI.ConsoleMessage{constructor(e,t,i,n,s=!0){let a=WI.ConsoleMessage.MessageSource.JS,d=i?WI.ConsoleMessage.MessageLevel.Error:WI.ConsoleMessage.MessageLevel.Log,p=WI.ConsoleMessage.MessageType.Result;super(e,a,d,"",p,void 0,void 0,void 0,0,[t],void 0,void 0),this._savedResultIndex=n,this._shouldRevealConsole=s,this._savedResultIndex&&this._savedResultIndex>WI.ConsoleCommandResultMessage.maximumSavedResultIndex&&(WI.ConsoleCommandResultMessage.maximumSavedResultIndex=this._savedResultIndex)}static clearMaximumSavedResultIndex(){WI.ConsoleCommandResultMessage.maximumSavedResultIndex=0}get savedResultIndex(){return this._savedResultIndex}get shouldRevealConsole(){return this._shouldRevealConsole}};WI.ConsoleCommandResultMessage.maximumSavedResultIndex=0;WI.Cookie=class{constructor(e,t,i,{header:n,expires:s,maxAge:a,path:d,domain:p,secure:f,httpOnly:_,sameSite:b,size:w}={}){console.assert(Object.values(WI.Cookie.Type).includes(e)),console.assert(typeof t=="string"),console.assert(typeof i=="string"),console.assert(!n||typeof n=="string"),console.assert(!s||s instanceof Date),console.assert(!a||typeof a=="number"),console.assert(!d||typeof d=="string"),console.assert(!p||typeof p=="string"),console.assert(!f||typeof f=="boolean"),console.assert(!_||typeof _=="boolean"),console.assert(!b||Object.values(WI.Cookie.SameSiteType).includes(b)),console.assert(!w||typeof w=="number"),this._type=e,this._name=t,this._value=i,this._size=w||this._name.length+this._value.length,this._type===WI.Cookie.Type.Response&&(this._header=n||"",this._expires=s||null,this._maxAge=a||null,this._path=d||null,this._domain=p||null,this._secure=f||!1,this._httpOnly=_||!1,this._sameSite=b||WI.Cookie.SameSiteType.None)}static fromPayload(e){let{name:t,value:i,...n}=e;return n.expires=n.expires?new Date(n.expires):null,new WI.Cookie(WI.Cookie.Type.Response,t,i,n)}static parseCookieRequestHeader(e){if(!e)return[];if(e=e.trim(),!e)return[];let t=[],i=e.split(/; /);for(let n of i){let s=n.match(/^(?<name>[^\s=]+)[ \t]*=[ \t]*(?<value>.*)$/);if(!s){WI.reportInternalError("Failed to parse Cookie pair",{header:e,pair:n});continue}let{name:a,value:d}=s.groups;t.push(new WI.Cookie(WI.Cookie.Type.Request,a,d))}return t}static displayNameForSameSiteType(e){switch(e){case WI.Cookie.SameSiteType.None:return WI.unlocalizedString("None");case WI.Cookie.SameSiteType.Lax:return WI.unlocalizedString("Lax");case WI.Cookie.SameSiteType.Strict:return WI.unlocalizedString("Strict");default:return console.error("Invalid SameSite type",e),e}}static parseSameSiteAttributeValue(e){if(!e)return WI.Cookie.SameSiteType.None;switch(e.toLowerCase()){case"lax":return WI.Cookie.SameSiteType.Lax;case"strict":return WI.Cookie.SameSiteType.Strict}return WI.Cookie.SameSiteType.None}static parseSetCookieResponseHeader(e){if(!e)return null;let t=e.match(/^(?<name>[^\s=]+)[ \t]*=[ \t]*(?<value>[^;]*)/);if(!t)return WI.reportInternalError("Failed to parse Set-Cookie header",{header:e}),null;let{name:i,value:n}=t.groups,s=null,a=null,d=null,p=null,f=!1,_=!1,b=WI.Cookie.SameSiteType.None,S=e.substr(t[0].length).split(/; ?/);for(let E of S){if(!E)continue;let k=E.match(/^(?<name>[^\s=]+)(?:=(?<value>.*))?$/);if(!k){console.error("Failed to parse Set-Cookie attribute:",E);continue}let R=k.groups.name,M=k.groups.value;switch(R.toLowerCase()){case"expires":console.assert(M),s=new Date(M),isNaN(s.getTime())&&(console.warn("Invalid Expires date:",M),s=null);break;case"max-age":console.assert(M),a=parseInt(M,10),(isNaN(a)||!/^\d+$/.test(M))&&(console.warn("Invalid MaxAge value:",M),a=null);break;case"path":console.assert(M),d=M;break;case"domain":console.assert(M),p=M;break;case"secure":console.assert(!M),f=!0;break;case"httponly":console.assert(!M),_=!0;break;case"samesite":b=WI.Cookie.parseSameSiteAttributeValue(M);break;default:console.warn("Unknown Cookie attribute:",E);break}}return new WI.Cookie(WI.Cookie.Type.Response,i,n,{header:e,expires:s,maxAge:a,path:d,domain:p,secure:f,httpOnly:_,sameSite:b})}get type(){return this._type}get name(){return this._name}get value(){return this._value}get header(){return this._header}get expires(){return this._expires}get maxAge(){return this._maxAge}get path(){return this._path}get domain(){return this._domain}get secure(){return this._secure}get httpOnly(){return this._httpOnly}get sameSite(){return this._sameSite}get size(){return this._size}get url(){let e=this._secure?"https://":"http://";return e+=this._domain||"",e+=this._path||"",e}expirationDate(e){if(this._maxAge){let t=e||new Date;return new Date(t.getTime()+this._maxAge*1e3)}return this._expires}};WI.Cookie.Type={Request:"request",Response:"response"};WI.Cookie.SameSiteType={None:"None",Lax:"Lax",Strict:"Strict"};WI.CookieStorageObject=class{constructor(e){this._host=e}static cookieMatchesResourceURL(e,t){var i=parseURL(t);return!i||!WI.CookieStorageObject.cookieDomainMatchesResourceDomain(e.domain,i.host)?!1:i.path.startsWith(e.path)&&(!e.port||i.port===e.port)&&(!e.secure||i.scheme==="https")}static cookieDomainMatchesResourceDomain(e,t){return e.charAt(0)!=="."?t===e:!!t.match(new RegExp("^(?:[^\\.]+\\.)*"+e.substring(1).escapeForRegExp()+"$"),"i")}get host(){return this._host}saveIdentityToCookie(e){e[WI.CookieStorageObject.CookieHostCookieKey]=this.host}};WI.CookieStorageObject.TypeIdentifier="cookie-storage";WI.CookieStorageObject.CookieHostCookieKey="cookie-storage-host";WI.DOMBreakpoint=class extends WI.Object{constructor(e,t,{disabled:i}={}){console.assert(e instanceof WI.DOMNode||typeof e=="object",e),console.assert(Object.values(WI.DOMBreakpoint.Type).includes(t),t),super(),e instanceof WI.DOMNode?(this._domNodeIdentifier=e.id,this._path=e.path(),console.assert(WI.networkManager.mainFrame),this._url=WI.networkManager.mainFrame.url):e&&typeof e=="object"&&(this._domNodeIdentifier=null,this._path=e.path,this._url=e.url),this._type=t,this._disabled=i||!1}static deserialize(e){return new WI.DOMBreakpoint(e,e.type,{disabled:!!e.disabled})}get type(){return this._type}get url(){return this._url}get path(){return this._path}get disabled(){return this._disabled}set disabled(e){this._disabled!==e&&(this._disabled=e,this.dispatchEventToListeners(WI.DOMBreakpoint.Event.DisabledStateChanged))}get domNodeIdentifier(){return this._domNodeIdentifier}set domNodeIdentifier(e){if(this._domNodeIdentifier===e)return;let t={};e||(t.oldNodeIdentifier=this._domNodeIdentifier),this._domNodeIdentifier=e,this.dispatchEventToListeners(WI.DOMBreakpoint.Event.DOMNodeChanged,t)}saveIdentityToCookie(e){e["dom-breakpoint-url"]=this._url,e["dom-breakpoint-path"]=this._path,e["dom-breakpoint-type"]=this._type}toJSON(e){let t={url:this._url,path:this._path,type:this._type};return this._disabled&&(t.disabled=!0),e===WI.ObjectStore.toJSONSymbol&&(t[WI.objectStores.domBreakpoints.keyPath]=this._url+":"+this._path+":"+this._type),t}};WI.DOMBreakpoint.Type={SubtreeModified:"subtree-modified",AttributeModified:"attribute-modified",NodeRemoved:"node-removed"};WI.DOMBreakpoint.Event={DOMNodeChanged:"dom-breakpoint-dom-node-changed",DisabledStateChanged:"dom-breakpoint-disabled-state-changed"};WI.DOMNode=class pp extends WI.Object{constructor(e,t,i,n){if(super(),this._domManager=e,this._isInShadowTree=i,this.id=n.nodeId,this._domManager._idToDOMNode[this.id]=this,this._nodeType=n.nodeType,this._nodeName=n.nodeName,this._localName=n.localName,this._nodeValue=n.nodeValue,this._pseudoType=n.pseudoType,this._shadowRootType=n.shadowRootType,this._computedRole=null,this._contentSecurityPolicyHash=n.contentSecurityPolicyHash,this._nodeType===Node.DOCUMENT_NODE?this.ownerDocument=this:this.ownerDocument=t,this._frame=null,InspectorBackend.domains.Timeline&&!InspectorBackend.domains.Timeline.hasEvent("programmaticCaptureStarted")&&n.frameId&&(this._frame=WI.networkManager.frameForIdentifier(n.frameId)),!this._frame&&this.ownerDocument&&(this._frame=WI.networkManager.frameForIdentifier(this.ownerDocument.frameIdentifier)),this._attributes=[],this._attributesMap=new Map,n.attributes&&this._setAttributesPayload(n.attributes),this._childNodeCount=n.childNodeCount,this._children=null,this._filteredChildren=null,this._filteredChildrenNeedsUpdating=!0,this._nextSibling=null,this._previousSibling=null,this.parentNode=null,this._enabledPseudoClasses=[],this._shadowRoots=[],n.shadowRoots)for(var s=0;s<n.shadowRoots.length;++s){var a=n.shadowRoots[s],d=new WI.DOMNode(this._domManager,this.ownerDocument,!0,a);d.parentNode=this,this._shadowRoots.push(d)}if(n.children?this._setChildrenPayload(n.children):this._shadowRoots.length&&!this._childNodeCount&&(this._children=this._shadowRoots.slice()),this._nodeType===Node.ELEMENT_NODE?this._customElementState=n.customElementState||WI.DOMNode.CustomElementState.Builtin:this._customElementState=null,n.templateContent&&(this._templateContent=new WI.DOMNode(this._domManager,this.ownerDocument,!1,n.templateContent),this._templateContent.parentNode=this),this._pseudoElements=new Map,n.pseudoElements)for(var s=0;s<n.pseudoElements.length;++s){var d=new WI.DOMNode(this._domManager,this.ownerDocument,this._isInShadowTree,n.pseudoElements[s]);d.parentNode=this,this._pseudoElements.set(d.pseudoType(),d)}n.contentDocument&&(this._contentDocument=new WI.DOMNode(this._domManager,null,!1,n.contentDocument),this._children=[this._contentDocument],this._renumber()),this._nodeType===Node.ELEMENT_NODE?(this.ownerDocument&&!this.ownerDocument.documentElement&&this._nodeName==="HTML"&&(this.ownerDocument.documentElement=this),this.ownerDocument&&!this.ownerDocument.body&&this._nodeName==="BODY"&&(this.ownerDocument.body=this),n.documentURL&&(this.documentURL=n.documentURL)):this._nodeType===Node.DOCUMENT_TYPE_NODE?(this.publicId=n.publicId,this.systemId=n.systemId):this._nodeType===Node.DOCUMENT_NODE?(this.documentURL=n.documentURL,this.xmlVersion=n.xmlVersion):this._nodeType===Node.ATTRIBUTE_NODE&&(this.name=n.name,this.value=n.value),this._domEvents=[],this._powerEfficientPlaybackRanges=[],this._shouldListenForEventListeners()&&WI.DOMNode.addEventListener(WI.DOMNode.Event.DidFireEvent,this._handleDOMNodeDidFireEvent,this)}static getFullscreenDOMEvents(e){return e.reduce((t,i)=>(i.eventName==="webkitfullscreenchange"&&i.data&&(!t.length||t.lastValue.data.enabled!==i.data.enabled)&&t.push(i),t),[])}static isPlayEvent(e){return e==="play"||e==="playing"}static isPauseEvent(e){return e==="pause"||e==="stall"}static isStopEvent(e){return e==="emptied"||e==="ended"||e==="suspend"}get frame(){return this._frame}get domEvents(){return this._domEvents}get powerEfficientPlaybackRanges(){return this._powerEfficientPlaybackRanges}get attached(){for(let e=this;e;e=e.parentNode)if(e.ownerDocument===e)return!0;return!1}get children(){return this._children?WI.settings.showShadowDOM.value?this._children:(this._filteredChildrenNeedsUpdating&&(this._filteredChildrenNeedsUpdating=!1,this._filteredChildren=this._children.filter(function(e){return!e._isInShadowTree})),this._filteredChildren):null}get firstChild(){var e=this.children;return e&&e.length>0?e[0]:null}get lastChild(){var e=this.children;return e&&e.length>0?e.lastValue:null}get nextSibling(){if(WI.settings.showShadowDOM.value)return this._nextSibling;for(var e=this._nextSibling;e;){if(!e._isInShadowTree)return e;e=e._nextSibling}return null}get previousSibling(){if(WI.settings.showShadowDOM.value)return this._previousSibling;for(var e=this._previousSibling;e;){if(!e._isInShadowTree)return e;e=e._previousSibling}return null}get childNodeCount(){var e=this.children;return e?e.length:WI.settings.showShadowDOM.value?this._childNodeCount+this._shadowRoots.length:this._childNodeCount}set childNodeCount(e){this._childNodeCount=e}computedRole(){return this._computedRole}contentSecurityPolicyHash(){return this._contentSecurityPolicyHash}hasAttributes(){return this._attributes.length>0}hasChildNodes(){return this.childNodeCount>0}hasShadowRoots(){return!!this._shadowRoots.length}isInShadowTree(){return this._isInShadowTree}isInUserAgentShadowTree(){return this._isInShadowTree&&this.ancestorShadowRoot().isUserAgentShadowRoot()}isCustomElement(){return this._customElementState===WI.DOMNode.CustomElementState.Custom}customElementState(){return this._customElementState}isShadowRoot(){return!!this._shadowRootType}isUserAgentShadowRoot(){return this._shadowRootType===WI.DOMNode.ShadowRootType.UserAgent}ancestorShadowRoot(){if(!this._isInShadowTree)return null;let e=this;for(;e&&!e.isShadowRoot();)e=e.parentNode;return e}ancestorShadowHost(){let e=this.ancestorShadowRoot();return e?e.parentNode:null}isPseudoElement(){return this._pseudoType!==void 0}nodeType(){return this._nodeType}nodeName(){return this._nodeName}nodeNameInCorrectCase(){return this.isXMLNode()?this.nodeName():this.nodeName().toLowerCase()}setNodeName(e,t){DOMAgent.setNodeName(this.id,e,this._makeUndoableCallback(t))}localName(){return this._localName}templateContent(){return this._templateContent||null}pseudoType(){return this._pseudoType}hasPseudoElements(){return this._pseudoElements.size>0}pseudoElements(){return this._pseudoElements}beforePseudoElement(){return this._pseudoElements.get(WI.DOMNode.PseudoElementType.Before)||null}afterPseudoElement(){return this._pseudoElements.get(WI.DOMNode.PseudoElementType.After)||null}shadowRoots(){return this._shadowRoots}shadowRootType(){return this._shadowRootType}nodeValue(){return this._nodeValue}setNodeValue(e,t){DOMAgent.setNodeValue(this.id,e,this._makeUndoableCallback(t))}getAttribute(e){let t=this._attributesMap.get(e);return t?t.value:void 0}setAttribute(e,t,i){DOMAgent.setAttributesAsText(this.id,t,e,this._makeUndoableCallback(i))}setAttributeValue(e,t,i){DOMAgent.setAttributeValue(this.id,e,t,this._makeUndoableCallback(i))}attributes(){return this._attributes}removeAttribute(e,t){function i(n,s){if(!n){this._attributesMap.delete(e);for(var a=0;a<this._attributes.length;++a)if(this._attributes[a].name===e){this._attributes.splice(a,1);break}}this._makeUndoableCallback(t)(n)}DOMAgent.removeAttribute(this.id,e,i.bind(this))}toggleClass(e,t){if(!(!e||!e.length)){if(this.isPseudoElement()){this.parentNode.toggleClass(e,t);return}this.nodeType()===Node.ELEMENT_NODE&&WI.RemoteObject.resolveNode(this).then(i=>{function n(s,a){this.classList.toggle(s,a)}i.callFunction(n,[e,t]),i.release()})}}scrollIntoView(){WI.RemoteObject.resolveNode(this).then(e=>{function t(){this.scrollIntoViewIfNeeded(!0)}e.callFunction(t),e.release()})}getChildNodes(e){if(this.children){e&&e(this.children);return}function t(i){!i&&e&&e(this.children)}DOMAgent.requestChildNodes(this.id,t.bind(this))}getSubtree(e,t){function i(n){t&&t(n?null:this.children)}DOMAgent.requestChildNodes(this.id,e,i.bind(this))}getOuterHTML(e){DOMAgent.getOuterHTML(this.id,e)}setOuterHTML(e,t){DOMAgent.setOuterHTML(this.id,e,this._makeUndoableCallback(t))}insertAdjacentHTML(e,t){if(this.nodeType()===Node.ELEMENT_NODE){if(!DOMAgent.insertAdjacentHTML){WI.RemoteObject.resolveNode(this).then(i=>{function n(s,a){this.insertAdjacentHTML(s,a)}i.callFunction(n,[e,t]),i.release()});return}DOMAgent.insertAdjacentHTML(this.id,e,t,this._makeUndoableCallback())}}removeNode(e){DOMAgent.removeNode(this.id,this._makeUndoableCallback(e))}copyNode(){function e(t,i){t||InspectorFrontendHost.copyText(i)}DOMAgent.getOuterHTML(this.id,e)}getEventListeners(e){console.assert(WI.domManager.inspectedNode===this),DOMAgent.getEventListenersForNode(this.id,e)}accessibilityProperties(e){function t(i,n){!i&&e&&n&&(this._computedRole=n.role,e({activeDescendantNodeId:n.activeDescendantNodeId,busy:n.busy,checked:n.checked,childNodeIds:n.childNodeIds,controlledNodeIds:n.controlledNodeIds,current:n.current,disabled:n.disabled,exists:n.exists,expanded:n.expanded,flowedNodeIds:n.flowedNodeIds,focused:n.focused,ignored:n.ignored,ignoredByDefault:n.ignoredByDefault,invalid:n.invalid,isPopupButton:n.isPopUpButton,headingLevel:n.headingLevel,hierarchyLevel:n.hierarchyLevel,hidden:n.hidden,label:n.label,liveRegionAtomic:n.liveRegionAtomic,liveRegionRelevant:n.liveRegionRelevant,liveRegionStatus:n.liveRegionStatus,mouseEventNodeId:n.mouseEventNodeId,nodeId:n.nodeId,ownedNodeIds:n.ownedNodeIds,parentNodeId:n.parentNodeId,pressed:n.pressed,readonly:n.readonly,required:n.required,role:n.role,selected:n.selected,selectedChildNodeIds:n.selectedChildNodeIds}))}DOMAgent.getAccessibilityPropertiesForNode(this.id,t.bind(this))}path(){for(var e=[],t=this;t&&"index"in t&&t._nodeName.length;)e.push([t.index,t._nodeName]),t=t.parentNode;return e.reverse(),e.join(",")}get escapedIdSelector(){let e=this.getAttribute("id");return!e||(e=e.trim(),!e.length)?"":(e=CSS.escape(e),/[\s'"]/.test(e)?`[id="${e}"]`:`#${e}`)}get escapedClassSelector(){let e=this.getAttribute("class");if(!e||(e=e.trim(),!e.length))return"";let t=new Set;return e.split(/\s+/).reduce((i,n)=>!n.length||t.has(n)?i:(t.add(n),`${i}.${CSS.escape(n)}`),"")}get displayName(){return this.isPseudoElement()?"::"+this._pseudoType:this.nodeNameInCorrectCase()+this.escapedIdSelector+this.escapedClassSelector}appropriateSelectorFor(e){if(this.isPseudoElement())return this.parentNode.appropriateSelectorFor()+"::"+this._pseudoType;let t=this.localName()||this.nodeName().toLowerCase(),i=this.escapedIdSelector;if(i.length)return e?i:t+i;let n=this.escapedClassSelector;return n.length?e?n:t+n:t==="input"&&this.getAttribute("type")?t+'[type="'+this.getAttribute("type")+'"]':t}isAncestor(e){if(!e)return!1;for(var t=e.parentNode;t;){if(this===t)return!0;t=t.parentNode}return!1}isDescendant(e){return e!==null&&e.isAncestor(this)}get ownerSVGElement(){return this._nodeName==="svg"?this:this.parentNode?this.parentNode.ownerSVGElement:null}isSVGElement(){return!!this.ownerSVGElement}didFireEvent(e,t,i){this._addDOMEvent({eventName:e,timestamp:WI.timelineManager.computeElapsedTime(t),data:i})}powerEfficientPlaybackStateChanged(e,t){console.assert(this.canEnterPowerEfficientPlaybackState());let i=this._powerEfficientPlaybackRanges.lastValue;t?(console.assert(!i||i.endTimestamp),(!i||i.endTimestamp)&&this._powerEfficientPlaybackRanges.push({startTimestamp:e})):(console.assert(!i||i.startTimestamp),i?i.startTimestamp&&(i.endTimestamp=e):this._powerEfficientPlaybackRanges.push({endTimestamp:e})),this.dispatchEventToListeners(pp.Event.PowerEfficientPlaybackStateChanged,{isPowerEfficient:t,timestamp:e})}canEnterPowerEfficientPlaybackState(){return this.localName()==="video"||this.nodeName().toLowerCase()==="video"}_handleDOMNodeDidFireEvent(e){if(e.target===this||!e.target.isAncestor(this))return;let t=Object.shallowCopy(e.data.domEvent);t.originator=e.target,this._addDOMEvent(t)}_addDOMEvent(e){this._domEvents.push(e),this.dispatchEventToListeners(WI.DOMNode.Event.DidFireEvent,{domEvent:e})}_shouldListenForEventListeners(){let e=this.localName()||this.nodeName().toLowerCase();return e==="video"||e==="audio"}_setAttributesPayload(e){this._attributes=[],this._attributesMap=new Map;for(var t=0;t<e.length;t+=2)this._addAttribute(e[t],e[t+1])}_insertChild(e,t){var i=new WI.DOMNode(this._domManager,this.ownerDocument,this._isInShadowTree,t);return e?this._children.splice(this._children.indexOf(e)+1,0,i):this._children?this._children.unshift(i):this._children=this._shadowRoots.concat([i]),this._renumber(),i}_removeChild(e){e.isPseudoElement()?(this._pseudoElements.delete(e.pseudoType()),e.parentNode=null):(this._children.splice(this._children.indexOf(e),1),e.parentNode=null,this._renumber())}_setChildrenPayload(e){if(!this._contentDocument){this._children=this._shadowRoots.slice();for(var t=0;t<e.length;++t){var i=new WI.DOMNode(this._domManager,this.ownerDocument,this._isInShadowTree,e[t]);this._children.push(i)}this._renumber()}}_renumber(){this._filteredChildrenNeedsUpdating=!0;var e=this._children.length;if(e!==0)for(var t=0;t<e;++t){var i=this._children[t];i.index=t,i._nextSibling=t+1<e?this._children[t+1]:null,i._previousSibling=t-1>=0?this._children[t-1]:null,i.parentNode=this}}_addAttribute(e,t){let i={name:e,value:t,_node:this};this._attributesMap.set(e,i),this._attributes.push(i)}_setAttribute(e,t){let i=this._attributesMap.get(e);i?i.value=t:this._addAttribute(e,t)}_removeAttribute(e){let t=this._attributesMap.get(e);t&&(this._attributes.remove(t),this._attributesMap.delete(e))}moveTo(e,t,i){DOMAgent.moveTo(this.id,e.id,t?t.id:void 0,this._makeUndoableCallback(i))}isXMLNode(){return!!this.ownerDocument&&!!this.ownerDocument.xmlVersion}get enabledPseudoClasses(){return this._enabledPseudoClasses}setPseudoClassEnabled(e,t){var i=this._enabledPseudoClasses;if(t){if(i.includes(e))return;i.push(e)}else{if(!i.includes(e))return;i.remove(e)}function n(s){s||this.dispatchEventToListeners(WI.DOMNode.Event.EnabledPseudoClassesChanged)}CSSAgent.forcePseudoState(this.id,i,n.bind(this))}_makeUndoableCallback(e){return function(t){t||DOMAgent.markUndoableState(),e&&e.apply(null,arguments)}}};WI.DOMNode.Event={EnabledPseudoClassesChanged:"dom-node-enabled-pseudo-classes-did-change",AttributeModified:"dom-node-attribute-modified",AttributeRemoved:"dom-node-attribute-removed",EventListenersChanged:"dom-node-event-listeners-changed",DidFireEvent:"dom-node-did-fire-event",PowerEfficientPlaybackStateChanged:"dom-node-power-efficient-playback-state-changed"};WI.DOMNode.PseudoElementType={Before:"before",After:"after"};WI.DOMNode.ShadowRootType={UserAgent:"user-agent",Closed:"closed",Open:"open"};WI.DOMNode.CustomElementState={Builtin:"builtin",Custom:"custom",Waiting:"waiting",Failed:"failed"};WI.DOMNodeStyles=class cd extends WI.Object{constructor(e){super(),console.assert(e),this._node=e||null,this._rulesMap=new Map,this._stylesMap=new Multimap,this._matchedRules=[],this._inheritedRules=[],this._pseudoElements=new Map,this._inlineStyle=null,this._attributesStyle=null,this._computedStyle=null,this._orderedStyles=[],this._propertyNameToEffectivePropertyMap={},this._pendingRefreshTask=null,this.refresh()}static parseSelectorListPayload(e){let t=e.selectors;return t.length?typeof t[0]=="string"?t.map(function(i){return new WI.CSSSelector(i)}):t.map(function(i){return new WI.CSSSelector(i.text,i.specificity,i.dynamic)}):[]}static createSourceCodeLocation(e,{line:t,column:i,documentNode:n}={}){if(!e)return null;let s=null;if(n){let a=WI.networkManager.resourceForURL(n.documentURL);a&&(s=a.parentFrame.resourceForURL(e))}return s||(s=WI.networkManager.resourceForURL(e)),s?s.createSourceCodeLocation(t||0,i||0):null}static uniqueOrderedStyles(e){let t=[];for(let i of e){let n=i.ownerRule;if(!n){t.push(i);continue}let s=!1;for(let a of t)if(n.isEqualTo(a.ownerRule)){s=!0;break}s||t.push(i)}return t}get node(){return this._node}get needsRefresh(){return this._pendingRefreshTask||this._needsRefresh}refreshIfNeeded(){return this._pendingRefreshTask?this._pendingRefreshTask:this._needsRefresh?this.refresh():Promise.resolve(this)}refresh(){if(this._pendingRefreshTask)return this._pendingRefreshTask;this._needsRefresh=!1;let e=this._stylesMap.copy(),t=new WI.WrappedPromise,i=new WI.WrappedPromise,n=new WI.WrappedPromise;function s(_,b){return(...w)=>{try{_.apply(this,w)}catch(S){console.error(S),b.resolve()}}}let a=(_,b,w,S)=>{for(var E=[],k={},R=_.length-1;R>=0;--R){var M=this._parseRulePayload(_[R].rule,_[R].matchingSelectors,b,w,S,k);!M||E.push(M)}return E};function d(_,b,w,S){b=b||[],w=w||[],S=S||[],this._matchedRules=a(b,this._node),this._pseudoElements.clear();for(let{pseudoId:L,matches:V}of w){let H=a(V,this._node,!1,L);this._pseudoElements.set(L,{matchedRules:H})}this._inheritedRules=[];for(var E=0,k=this._node.parentNode;k&&E<S.length;){var R=S[E],M={node:k};M.inlineStyle=R.inlineStyle?this._parseStyleDeclarationPayload(R.inlineStyle,k,!0,null,WI.CSSStyleDeclaration.Type.Inline):null,M.matchedRules=R.matchedCSSRules?a(R.matchedCSSRules,k,!0):[],(M.inlineStyle||M.matchedRules.length)&&this._inheritedRules.push(M),k=k.parentNode,++E}t.resolve()}function p(_,b,w){this._inlineStyle=b?this._parseStyleDeclarationPayload(b,this._node,!1,null,WI.CSSStyleDeclaration.Type.Inline):null,this._attributesStyle=w?this._parseStyleDeclarationPayload(w,this._node,!1,null,WI.CSSStyleDeclaration.Type.Attribute):null,this._updateStyleCascade(),i.resolve()}function f(_,b){for(var w=[],S=0;b&&S<b.length;++S){var E=b[S],k=WI.cssManager.canonicalNameForPropertyName(E.name);E.implicit=!this._propertyNameToEffectivePropertyMap[k];var R=this._parseStylePropertyPayload(E,NaN,this._computedStyle);R.implicit||(R.implicit=!this._isPropertyFoundInMatchingRules(R.name)),w.push(R)}this._computedStyle?this._computedStyle.update(null,w):this._computedStyle=new WI.CSSStyleDeclaration(this,null,null,WI.CSSStyleDeclaration.Type.Computed,this._node,!1,null,w);let M=!1;for(let[L,V]of this._stylesMap.sets()){let H=e.get(L);if(H){let O=!1;for(let z of V)if(H.has(z)){O=!0;break}if(O)continue}if(!this._includeUserAgentRulesOnNextRefresh){let O=V.firstValue;if(O&&O.ownerRule&&O.ownerRule.type===WI.CSSStyleSheet.Type.UserAgent)continue}M=!0;break}if(!M){for(let[L,V]of e.sets())if(!this._stylesMap.has(L)){if(!this._includeUserAgentRulesOnNextRefresh){let H=V.firstValue;if(H&&H.ownerRule&&H.ownerRule.type===WI.CSSStyleSheet.Type.UserAgent)continue}M=!0;break}}this._includeUserAgentRulesOnNextRefresh=!1,this.dispatchEventToListeners(WI.DOMNodeStyles.Event.Refreshed,{significantChange:M}),n.resolve()}return WI.cssManager.fetchStyleSheetsIfNeeded(),CSSAgent.getMatchedStylesForNode.invoke({nodeId:this._node.id,includePseudo:!0,includeInherited:!0},s.call(this,d,t)),CSSAgent.getInlineStylesForNode.invoke({nodeId:this._node.id},s.call(this,p,i)),CSSAgent.getComputedStyleForNode.invoke({nodeId:this._node.id},s.call(this,f,n)),this._pendingRefreshTask=Promise.all([t.promise,i.promise,n.promise]).then(()=>(this._pendingRefreshTask=null,this)),this._pendingRefreshTask}addRule(e,t,i){e=e||this._node.appropriateSelectorFor(!0);function n(){DOMAgent.markUndoableState(),this.refresh()}function s(p,f){p||n.call(this)}function a(p,f){if(!p){if(!t||!t.length){n.call(this);return}CSSAgent.setStyleText(f.style.styleId,t,s.bind(this))}}if(!CSSAgent.createStyleSheet){CSSAgent.addRule.invoke({contextNodeId:this._node.id,selector:e},a.bind(this));return}function d(p){!p||CSSAgent.addRule(p.id,e,a.bind(this))}i?d.call(this,WI.cssManager.styleSheetForIdentifier(i)):WI.cssManager.preferredInspectorStyleSheetForFrame(this._node.frame,d.bind(this))}rulesForSelector(e){e=e||this._node.appropriateSelectorFor(!0);function t(n){return!n.mediaList.length&&n.selectorText===e}let i=this._matchedRules.filter(t);for(let n of this._pseudoElements.values())i=i.concat(n.matchedRules.filter(t));return i}get matchedRules(){return this._matchedRules}get inheritedRules(){return this._inheritedRules}get inlineStyle(){return this._inlineStyle}get attributesStyle(){return this._attributesStyle}get pseudoElements(){return this._pseudoElements}get computedStyle(){return this._computedStyle}get orderedStyles(){return this._orderedStyles}get uniqueOrderedStyles(){return WI.DOMNodeStyles.uniqueOrderedStyles(this._orderedStyles)}effectivePropertyForName(e){let t=this._propertyNameToEffectivePropertyMap[e];if(t)return t;let i=WI.cssManager.canonicalNameForPropertyName(e);return this._propertyNameToEffectivePropertyMap[i]||null}mediaQueryResultDidChange(){this._markAsNeedsRefresh()}pseudoClassesDidChange(e){this._includeUserAgentRulesOnNextRefresh=!0,this._markAsNeedsRefresh()}attributeDidChange(e,t){this._markAsNeedsRefresh()}changeRuleSelector(e,t){t=t||"";let i=new WI.WrappedPromise;function n(s,a){if(s){i.reject(s);return}DOMAgent.markUndoableState(),this.refresh().then(()=>{i.resolve(a)})}return this._needsRefresh=!0,this._ignoreNextContentDidChangeForStyleSheet=e.ownerStyleSheet,CSSAgent.setRuleSelector(e.id,t,n.bind(this)),i.promise}changeStyleText(e,t,i){if(!e.ownerStyleSheet||!e.styleSheetTextRange){i();return}t=t||"";let n=(s,a)=>{if(s){i(s);return}i(),this.refresh()};CSSAgent.setStyleText(e.id,t,n)}_parseSourceRangePayload(e){return e?new WI.TextRange(e.startLine,e.startColumn,e.endLine,e.endColumn):null}_parseStylePropertyPayload(e,t,i){var n=e.text||"",s=e.name,a=e.value||"",d=e.priority||"";let p=e.range||null;var f=!0,_=!1,b=e.implicit||!1,w=!1,S="parsedOk"in e?e.parsedOk:!0;switch(e.status||"style"){case"active":f=!0;break;case"inactive":_=!0,f=!0;break;case"disabled":f=!1;break;case"style":w=!0;break}if(p){let V=1+p.endLine-p.startLine;if(V>1){let H=n.lineCount;H===V-1&&(p.endLine=p.startLine+(H-1),p.endColumn=p.startColumn+n.lastLine.length)}}var E=this._parseSourceRangePayload(e.range);if(i){var k=isNaN(t)?i.propertyForName(s,!0):i.enabledProperties[t];if(k&&k.name===s&&(k.index===t||isNaN(k.index)&&isNaN(t)))return k.update(n,s,a,d,f,_,b,w,S,E),k;for(var R=i.pendingProperties,M=0;M<R.length;++M){var L=R[M];if(L.name===s&&isNaN(L.index))return L.index=t,L.update(n,s,a,d,f,_,b,w,S,E),L}}return new WI.CSSProperty(t,n,s,a,d,f,_,b,w,S,E)}_parseStyleDeclarationPayload(e,t,i,n,s,a){if(!e)return null;a=a||null,i=i||!1;var d=e.styleId,p=d?d.styleSheetId+":"+d.ordinal:null;n&&(p+=":"+n),s===WI.CSSStyleDeclaration.Type.Attribute&&(p+=":"+t.id+":attribute");let f=a?a.style:null,_=this._stylesMap.get(p);if(_&&!f){for(let H of _)if(H.node===t&&H.inherited===i){f=H;break}}f&&this._stylesMap.add(p,f);for(var b={},w=0;e.shorthandEntries&&w<e.shorthandEntries.length;++w){var S=e.shorthandEntries[w];b[S.name]=S.value}for(var E=0,k=[],w=0;e.cssProperties&&w<e.cssProperties.length;++w){var R=e.cssProperties[w];i&&WI.CSSProperty.isInheritedPropertyName(R.name)&&++E;let O=this._parseStylePropertyPayload(R,w,f);k.push(O)}let M=e.cssText;var L=this._parseSourceRangePayload(e.range);if(f)return f.update(M,k,L),f;var V=d?WI.cssManager.styleSheetForIdentifier(d.styleSheetId):null;return V&&(s===WI.CSSStyleDeclaration.Type.Inline&&V.markAsInlineStyleAttributeStyleSheet(),V.addEventListener(WI.CSSStyleSheet.Event.ContentDidChange,this._styleSheetContentDidChange,this)),i&&!E?null:(f=new WI.CSSStyleDeclaration(this,V,d,s,t,i,M,k,L),p&&this._stylesMap.add(p,f),f)}_parseRulePayload(e,t,i,n,s,a){if(!e)return null;var d=e.ruleId||e.style.styleId,p=d?d.styleSheetId+":"+d.ordinal+":"+(n?"I":"N")+":"+(s?s+":":"")+i.id:null,f=0;p&&(p in a?f=++a[p]:a[p]=f,p+=":"+f);let _=this._rulesMap.get(p);var b=this._parseStyleDeclarationPayload(e.style,i,n,s,WI.CSSStyleDeclaration.Type.Rule,_);if(!b)return null;var w=d?WI.cssManager.styleSheetForIdentifier(d.styleSheetId):null,S=e.selectorList.text;let E=cd.parseSelectorListPayload(e.selectorList);var k=WI.CSSManager.protocolStyleSheetOriginToEnum(e.origin),R=null,M=e.selectorList.range;M?R=cd.createSourceCodeLocation(e.sourceURL,{line:M.startLine,column:M.startColumn,documentNode:this._node.ownerDocument}):R=cd.createSourceCodeLocation(e.sourceURL,{line:e.sourceLine,documentNode:this._node.ownerDocument}),w&&(!R&&w.isInspectorStyleSheet()&&(R=w.createSourceCodeLocation(M.startLine,M.startColumn)),R=w.offsetSourceCodeLocation(R));for(var L=[],V=0;e.media&&V<e.media.length;++V){var H=e.media[V],O=WI.CSSManager.protocolMediaSourceToEnum(H.source),z=H.text;let K=cd.createSourceCodeLocation(H.sourceURL,{line:H.sourceLine});w&&(K=w.offsetSourceCodeLocation(K)),L.push(new WI.CSSMedia(O,z,K))}return _?(_.update(R,S,E,t,b,L),_):(w&&w.addEventListener(WI.CSSStyleSheet.Event.ContentDidChange,this._styleSheetContentDidChange,this),_=new WI.CSSRule(this,w,d,k,R,S,E,t,b,L),p&&this._rulesMap.set(p,_),_)}_markAsNeedsRefresh(){this._needsRefresh=!0,this.dispatchEventToListeners(WI.DOMNodeStyles.Event.NeedsRefresh)}_styleSheetContentDidChange(e){var t=e.target;if(console.assert(t),!!t){if(t===this._ignoreNextContentDidChangeForStyleSheet){this._ignoreNextContentDidChangeForStyleSheet=null;return}this._markAsNeedsRefresh()}}_updateStyleCascade(){for(var e=this._collectStylesInCascadeOrder(this._matchedRules,this._inlineStyle,this._attributesStyle),t=0;t<this._inheritedRules.length;++t){var i=this._inheritedRules[t],n=this._collectStylesInCascadeOrder(i.matchedRules,i.inlineStyle,null);e=e.concat(n)}this._orderedStyles=e,this._propertyNameToEffectivePropertyMap={},this._associateRelatedProperties(e,this._propertyNameToEffectivePropertyMap),this._markOverriddenProperties(e,this._propertyNameToEffectivePropertyMap);for(let s of this._pseudoElements.values())s.orderedStyles=this._collectStylesInCascadeOrder(s.matchedRules,null,null),this._associateRelatedProperties(s.orderedStyles),this._markOverriddenProperties(s.orderedStyles)}_collectStylesInCascadeOrder(e,t,i){var n=[];t&&n.push(t);for(var s=[],a=0;a<e.length;++a){var d=e[a];switch(d.type){case WI.CSSStyleSheet.Type.Inspector:case WI.CSSStyleSheet.Type.Author:n.push(d.style);break;case WI.CSSStyleSheet.Type.User:case WI.CSSStyleSheet.Type.UserAgent:s.push(d.style);break}}return i&&n.push(i),n=n.concat(s),n}_markOverriddenProperties(e,t){t=t||{};function i(b){let w=b.relatedShorthandProperty;if(!w||b.important&&!w.important)return!1;if(!b.important&&w.important)return!0;if(b.ownerStyle===w.ownerStyle)return w.index>b.index;let S=e.indexOf(b.ownerStyle);return e.indexOf(w.ownerStyle)>S}for(var n=0;n<e.length;++n)for(var s=e[n],a=s.enabledProperties,d=0;d<a.length;++d){var p=a[d];if(!p.attached||!p.valid){p.overridden=!1;continue}if(s.inherited&&!p.inherited){p.overridden=!1;continue}var f=p.canonicalName;if(f in t){var _=t[f];if(_.ownerStyle===p.ownerStyle){if(_.important&&!p.important){p.overridden=!0,p.overridingProperty=_;continue}}else if(_.important||!p.important||_.ownerStyle.node!==p.ownerStyle.node){p.overridden=!0,p.overridingProperty=_;continue}p.anonymous||(_.overridden=!0,_.overridingProperty=p)}i(p)?(p.overridden=!0,p.overridingProperty=p.relatedShorthandProperty):p.overridden=!1,t[f]=p}}_associateRelatedProperties(e,t){for(var i=0;i<e.length;++i){for(var n=e[i].enabledProperties,s={},a=0;a<n.length;++a){var d=n[a];if(!!d.valid&&!!WI.CSSCompletions.cssNameCompletions.isShorthandPropertyName(d.name)){if(s[d.canonicalName]&&!s[d.canonicalName].overridden){console.assert(d.overridden);continue}s[d.canonicalName]=d}}for(var a=0;a<n.length;++a){var d=n[a];if(!!d.valid){var p=null;if(!isEmptyObject(s)){for(var f=WI.CSSCompletions.cssNameCompletions.shorthandsForLonghand(d.canonicalName),_=0;_<f.length;++_)if(f[_]in s){p=s[f[_]];break}}if(!p||p.overridden!==d.overridden){d.relatedShorthandProperty=null,d.clearRelatedLonghandProperties();continue}p.addRelatedLonghandProperty(d),d.relatedShorthandProperty=p,t&&t[p.canonicalName]===p&&(t[d.canonicalName]=d)}}}}_isPropertyFoundInMatchingRules(e){return this._orderedStyles.some(t=>t.enabledProperties.some(i=>i.name===e))}};WI.DOMNodeStyles.Event={NeedsRefresh:"dom-node-styles-needs-refresh",Refreshed:"dom-node-styles-refreshed"};WI.DOMSearchMatchObject=class{constructor(e,t,i,n,s){console.assert(e instanceof WI.Resource),console.assert(t instanceof WI.DOMNode),this._resource=e,this._domNode=t,this._title=i,this._searchTerm=n,this._sourceCodeTextRange=e.createSourceCodeTextRange(s)}static titleForDOMNode(e){switch(e.nodeType()){case Node.ELEMENT_NODE:var s="<"+e.nodeNameInCorrectCase();for(var t of e.attributes())s+=" "+t.name,t.value.length&&(s+='="'+t.value+'"');return s+">";case Node.TEXT_NODE:return'"'+e.nodeValue()+'"';case Node.COMMENT_NODE:return"<!--"+e.nodeValue()+"-->";case Node.DOCUMENT_TYPE_NODE:var s="<!DOCTYPE "+e.nodeName();return e.publicId?(s+=' PUBLIC "'+e.publicId+'"',e.systemId&&(s+=' "'+e.systemId+'"')):e.systemId&&(s+=' SYSTEM "'+e.systemId+'"'),s+">";case Node.CDATA_SECTION_NODE:return"<![CDATA["+e+"]]>";case Node.PROCESSING_INSTRUCTION_NODE:var i=e.nodeValue(),n=i.length?" "+i:"",s="<?"+e.nodeNameInCorrectCase()+n+"?>";return s;default:return console.error("Unknown DOM node type: ",e.nodeType()),e.nodeNameInCorrectCase()}}get resource(){return this._resource}get domNode(){return this._domNode}get title(){return this._title}get className(){return this._className||(this._className=this._generateClassName()),this._className}get searchTerm(){return this._searchTerm}get sourceCodeTextRange(){return this._sourceCodeTextRange}saveIdentityToCookie(e){e[WI.DOMSearchMatchObject.URLCookieKey]=this._resource.url.hash,e[WI.DOMSearchMatchObject.TitleKey]=this._title;var t=this._sourceCodeTextRange.textRange;e[WI.DOMSearchMatchObject.TextRangeKey]=[t.startLine,t.startColumn,t.endLine,t.endColumn].join()}_generateClassName(){switch(this._domNode.nodeType()){case Node.ELEMENT_NODE:return WI.DOMSearchMatchObject.DOMMatchElementIconStyleClassName;case Node.TEXT_NODE:return WI.DOMSearchMatchObject.DOMMatchTextNodeIconStyleClassName;case Node.COMMENT_NODE:return WI.DOMSearchMatchObject.DOMMatchCommentIconStyleClassName;case Node.DOCUMENT_TYPE_NODE:return WI.DOMSearchMatchObject.DOMMatchDocumentTypeIconStyleClassName;case Node.CDATA_SECTION_NODE:return WI.DOMSearchMatchObject.DOMMatchCharacterDataIconStyleClassName;case Node.PROCESSING_INSTRUCTION_NODE:return WI.DOMSearchMatchObject.DOMMatchDocumentTypeIconStyleClassName;default:return console.error("Unknown DOM node type: ",this._domNode.nodeType()),WI.DOMSearchMatchObject.DOMMatchNodeIconStyleClassName}}};WI.DOMSearchMatchObject.DOMMatchElementIconStyleClassName="dom-match-element-icon";WI.DOMSearchMatchObject.DOMMatchTextNodeIconStyleClassName="dom-match-text-node-icon";WI.DOMSearchMatchObject.DOMMatchCommentIconStyleClassName="dom-match-comment-icon";WI.DOMSearchMatchObject.DOMMatchDocumentTypeIconStyleClassName="dom-match-document-type-icon";WI.DOMSearchMatchObject.DOMMatchCharacterDataIconStyleClassName="dom-match-character-data-icon";WI.DOMSearchMatchObject.DOMMatchNodeIconStyleClassName="dom-match-node-icon";WI.DOMSearchMatchObject.TypeIdentifier="dom-search-match-object";WI.DOMSearchMatchObject.URLCookieKey="resource-url";WI.DOMSearchMatchObject.TitleKey="title";WI.DOMSearchMatchObject.TextRangeKey="text-range";WI.DOMStorageObject=class extends WI.Object{constructor(e,t,i){super(),this._id=e,this._host=t,this._isLocalStorage=i,this._entries=new Map}get id(){return this._id}get host(){return this._host}get entries(){return this._entries}saveIdentityToCookie(e){e[WI.DOMStorageObject.HostCookieKey]=this.host,e[WI.DOMStorageObject.LocalStorageCookieKey]=this.isLocalStorage()}isLocalStorage(){return this._isLocalStorage}getEntries(e){function t(i,n){if(!i){for(let[s,a]of n)!s||!a||this._entries.set(s,a);e(i,n)}}DOMStorageAgent.getDOMStorageItems(this._id,t.bind(this))}removeItem(e){DOMStorageAgent.removeDOMStorageItem(this._id,e)}setItem(e,t){DOMStorageAgent.setDOMStorageItem(this._id,e,t)}itemsCleared(){this._entries.clear(),this.dispatchEventToListeners(WI.DOMStorageObject.Event.ItemsCleared)}itemRemoved(e){this._entries.delete(e),this.dispatchEventToListeners(WI.DOMStorageObject.Event.ItemRemoved,{key:e})}itemAdded(e,t){this._entries.set(e,t),this.dispatchEventToListeners(WI.DOMStorageObject.Event.ItemAdded,{key:e,value:t})}itemUpdated(e,t,i){this._entries.set(e,i),this.dispatchEventToListeners(WI.DOMStorageObject.Event.ItemUpdated,{key:e,oldValue:t,value:i})}};WI.DOMStorageObject.TypeIdentifier="dom-storage";WI.DOMStorageObject.HostCookieKey="dom-storage-object-host";WI.DOMStorageObject.LocalStorageCookieKey="dom-storage-object-local-storage";WI.DOMStorageObject.Event={ItemsCleared:"dom-storage-object-items-cleared",ItemAdded:"dom-storage-object-item-added",ItemRemoved:"dom-storage-object-item-removed",ItemUpdated:"dom-storage-object-updated"};WI.DOMTree=class extends WI.Object{constructor(e){super(),this._frame=e,this._rootDOMNode=null,this._requestIdentifier=0,this._frame.addEventListener(WI.Frame.Event.PageExecutionContextChanged,this._framePageExecutionContextChanged,this),WI.domManager.addEventListener(WI.DOMManager.Event.DocumentUpdated,this._documentUpdated,this),this._frame.isMainFrame()||(WI.domManager.addEventListener(WI.DOMManager.Event.NodeRemoved,this._nodeRemoved,this),this._frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._frameMainResourceDidChange,this))}get frame(){return this._frame}disconnect(){WI.domManager.removeEventListener(null,null,this),this._frame.removeEventListener(null,null,this)}invalidate(){if(this._rootDOMNode=null,this._pendingRootDOMNodeRequests=null,this._invalidateTimeoutIdentifier)return;function e(){this._invalidateTimeoutIdentifier=void 0,this.dispatchEventToListeners(WI.DOMTree.Event.RootDOMNodeInvalidated)}this._invalidateTimeoutIdentifier=setTimeout(e.bind(this),0)}requestRootDOMNode(e){if(console.assert(typeof e=="function"),typeof e=="function"){if(this._rootDOMNode){e(this._rootDOMNode);return}if(!this._frame.isMainFrame()&&!this._frame.pageExecutionContext){this._rootDOMNodeRequestWaitingForExecutionContext=!0,this._pendingRootDOMNodeRequests||(this._pendingRootDOMNodeRequests=[]),this._pendingRootDOMNodeRequests.push(e);return}if(this._pendingRootDOMNodeRequests){this._pendingRootDOMNodeRequests.push(e);return}this._pendingRootDOMNodeRequests=[e],this._requestRootDOMNode()}}_requestRootDOMNode(){console.assert(this._frame.isMainFrame()||this._frame.pageExecutionContext),console.assert(this._pendingRootDOMNodeRequests.length);var e=++this._requestIdentifier;function t(d,p){if(!(!this._pendingRootDOMNodeRequests||e!==this._requestIdentifier)){if(d){console.error(JSON.stringify(d)),this._rootDOMNode=null,s.call(this);return}var f=WI.RemoteObject.fromPayload(p);f.pushNodeToFrontend(i.bind(this,f))}}function i(d,p){if(d.release(),!(!this._pendingRootDOMNodeRequests||e!==this._requestIdentifier)){if(!p){this._rootDOMNode=null,s.call(this);return}if(this._rootDOMNode=WI.domManager.nodeForId(p),console.assert(this._rootDOMNode),!this._rootDOMNode){s.call(this);return}this._rootDOMNode.getChildNodes(s.bind(this))}}function n(d){this._rootDOMNode=d,s.call(this)}function s(){if(!(!this._pendingRootDOMNodeRequests||e!==this._requestIdentifier)){for(var d=0;d<this._pendingRootDOMNodeRequests.length;++d)this._pendingRootDOMNodeRequests[d](this._rootDOMNode);this._pendingRootDOMNodeRequests=null}}if(this._frame.isMainFrame())WI.domManager.requestDocument(n.bind(this));else{var a=this._frame.pageExecutionContext.id;RuntimeAgent.evaluate.invoke({expression:appendWebInspectorSourceURL("document"),objectGroup:"",includeCommandLineAPI:!1,doNotPauseOnExceptionsAndMuteConsole:!0,contextId:a,returnByValue:!1,generatePreview:!1},t.bind(this))}}_nodeRemoved(e){console.assert(!this._frame.isMainFrame()),e.data.node===this._rootDOMNode&&this.invalidate()}_documentUpdated(e){this.invalidate()}_frameMainResourceDidChange(e){console.assert(!this._frame.isMainFrame()),this.invalidate()}_framePageExecutionContextChanged(e){this._rootDOMNodeRequestWaitingForExecutionContext&&(console.assert(this._frame.pageExecutionContext),console.assert(this._pendingRootDOMNodeRequests&&this._pendingRootDOMNodeRequests.length),this._rootDOMNodeRequestWaitingForExecutionContext=!1,this._requestRootDOMNode())}};WI.DOMTree.Event={RootDOMNodeInvalidated:"dom-tree-root-dom-node-invalidated"};WI.DatabaseObject=class{constructor(e,t,i,n){this._id=e,this._host=t||WI.UIString("Local File"),this._name=i,this._version=n}get id(){return this._id}get host(){return this._host}get name(){return this._name}get version(){return this._version}saveIdentityToCookie(e){e[WI.DatabaseObject.HostCookieKey]=this.host,e[WI.DatabaseObject.NameCookieKey]=this.name}getTableNames(e){function t(i,n){i||e(n.sort())}DatabaseAgent.getDatabaseTableNames(this._id,t)}executeSQL(e,t,i){function n(s,a,d,p){if(s){i(WI.UIString("An unexpected error occurred."));return}if(p){switch(p.code){case SQLError.VERSION_ERR:i(WI.UIString("Database no longer has expected version."));break;case SQLError.TOO_LARGE_ERR:i(WI.UIString("Data returned from the database is too large."));break;default:i(WI.UIString("An unexpected error occurred."));break}return}t(a,d)}DatabaseAgent.executeSQL(this._id,e,n)}};WI.DatabaseObject.TypeIdentifier="database";WI.DatabaseObject.HostCookieKey="database-object-host";WI.DatabaseObject.NameCookieKey="database-object-name";WI.DatabaseTableObject=class{constructor(e,t){console.assert(t instanceof WI.DatabaseObject),this._name=e,this._database=t}get name(){return this._name}get database(){return this._database}saveIdentityToCookie(e){e[WI.DatabaseTableObject.NameCookieKey]=this.name}};WI.DatabaseTableObject.TypeIdentifier="database-table";WI.DatabaseTableObject.NameCookieKey="database-table-object-name";WI.DebuggerDashboard=class{};WI.DebuggerData=class{constructor(e){console.assert(e instanceof WI.Target),this._target=e,this._paused=!1,this._pausing=!1,this._pauseReason=null,this._pauseData=null,this._callFrames=[],this._asyncStackTrace=null,this._scriptIdMap=new Map,this._scriptContentIdentifierMap=new Map,this._makePausingAfterNextResume=!1}get target(){return this._target}get paused(){return this._paused}get pausing(){return this._pausing}get pauseReason(){return this._pauseReason}get pauseData(){return this._pauseData}get callFrames(){return this._callFrames}get asyncStackTrace(){return this._asyncStackTrace}get scripts(){return Array.from(this._scriptIdMap.values())}scriptForIdentifier(e){return this._scriptIdMap.get(e)}scriptsForURL(e){return this._scriptContentIdentifierMap.get(e)||[]}reset(){this._scriptIdMap.clear()}addScript(e){if(this._scriptIdMap.set(e.id,e),e.contentIdentifier){let t=this._scriptContentIdentifierMap.get(e.contentIdentifier);t||(t=[],this._scriptContentIdentifierMap.set(e.contentIdentifier,t)),t.push(e)}}pauseIfNeeded(){return this._paused||this._pausing?Promise.resolve():(this._pausing=!0,this._target.DebuggerAgent.pause())}resumeIfNeeded(){return!this._paused&&!this._pausing?Promise.resolve():(this._pausing=!1,this._target.DebuggerAgent.resume())}continueUntilNextRunLoop(){return!this._paused||this._pausing?Promise.resolve():(this._makePausingAfterNextResume=!0,this._target.DebuggerAgent.continueUntilNextRunLoop())}updateForPause(e,t,i,n){this._paused=!0,this._pausing=!1,this._pauseReason=t,this._pauseData=i,this._callFrames=e,this._asyncStackTrace=n,this._makePausingAfterNextResume=!1}updateForResume(){this._paused=!1,this._pausing=!1,this._pauseReason=null,this._pauseData=null,this._callFrames=[],this._asyncStackTrace=null,this._makePausingAfterNextResume&&(this._makePausingAfterNextResume=!1,this._pausing=!0)}};WI.DefaultDashboard=class extends WI.Object{constructor(){super(),this._waitingForFirstMainResourceToStartTrackingSize=!0,WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this),WI.timelineManager.addEventListener(WI.TimelineManager.Event.CapturingStateChanged,this._handleTimelineCapturingStateChanged,this),WI.Frame.addEventListener(WI.Frame.Event.ResourceWasAdded,this._resourceWasAdded,this),WI.Target.addEventListener(WI.Target.Event.ResourceAdded,this._resourceWasAdded,this),WI.networkManager.addEventListener(WI.NetworkManager.Event.FrameWasAdded,this._frameWasAdded,this),WI.consoleManager.addEventListener(WI.ConsoleManager.Event.Cleared,this._consoleWasCleared,this),WI.consoleManager.addEventListener(WI.ConsoleManager.Event.MessageAdded,this._consoleMessageAdded,this),WI.consoleManager.addEventListener(WI.ConsoleManager.Event.PreviousMessageRepeatCountUpdated,this._consoleMessageWasRepeated,this),this._transitioningPageTarget=!1,WI.notifications.addEventListener(WI.Notification.TransitionPageTarget,this._transitionPageTarget,this),this._resourcesCount=0,this._resourcesSize=0,this._time=0,this._logs=0,this._errors=0,this._issues=0}get resourcesCount(){return this._resourcesCount}set resourcesCount(e){this._resourcesCount=e,this._dataDidChange()}get resourcesSize(){return this._resourcesSize}set resourcesSize(e){this._resourcesSize=e,this._dataDidChange()}get time(){return this._time}set time(e){this._time=e,this._dataDidChange()}get logs(){return this._logs}set logs(e){this._logs=e,this._dataDidChange()}get errors(){return this._errors}set errors(e){this._errors=e,this._dataDidChange()}get issues(){return this._issues}set issues(e){this._issues=e,this._dataDidChange()}_dataDidChange(){this.dispatchEventToListeners(WI.DefaultDashboard.Event.DataDidChange)}_mainResourceDidChange(e){console.assert(e.target instanceof WI.Frame),e.target.isMainFrame()&&(this._transitioningPageTarget||(this._time=0,this._resourcesCount=1,this._resourcesSize=WI.networkManager.mainFrame.mainResource.size||0),this._waitingForFirstMainResourceToStartTrackingSize&&(this._waitingForFirstMainResourceToStartTrackingSize=!1,WI.Resource.addEventListener(WI.Resource.Event.SizeDidChange,this._resourceSizeDidChange,this)),this._dataDidChange(),this._transitioningPageTarget||this._startUpdatingTime(),this._transitioningPageTarget&&(this._transitioningPageTarget=!1))}_handleTimelineCapturingStateChanged(e){WI.timelineManager.isCapturing()||this._stopUpdatingTime()}_resourceWasAdded(e){++this.resourcesCount}_frameWasAdded(e){++this.resourcesCount}_resourceSizeDidChange(e){if(e.target.urlComponents.scheme==="data")return;let t=e.target.size-e.data.previousSize;console.assert(!isNaN(t),"Resource size change should never be NaN."),this.resourcesSize+=t}_startUpdatingTime(){this._stopUpdatingTime(),this.time=0,this._timelineBaseTime=Date.now(),this._timeIntervalDelay=50,this._timeIntervalIdentifier=setInterval(this._updateTime.bind(this),this._timeIntervalDelay)}_stopUpdatingTime(){!this._timeIntervalIdentifier||(clearInterval(this._timeIntervalIdentifier),this._timeIntervalIdentifier=void 0)}_updateTime(){var e=Date.now()-this._timelineBaseTime,t=this._timeIntervalDelay;e>=1e3?t=100:e>=6e4?t=1e3:e>=36e5&&(t=1e4),t!==this._timeIntervalDelay&&(this._timeIntervalDelay=t,clearInterval(this._timeIntervalIdentifier),this._timeIntervalIdentifier=setInterval(this._updateTime.bind(this),this._timeIntervalDelay));var i=WI.networkManager.mainFrame,n=i.mainResource.firstTimestamp,s=i.loadEventTimestamp;if(isNaN(n)||isNaN(s)){this.time=e/1e3;return}this.time=s-n,this._stopUpdatingTime()}_consoleMessageAdded(e){var t=e.data.message;this._lastConsoleMessageType=t.level,this._incrementConsoleMessageType(t.level,t.repeatCount)}_consoleMessageWasRepeated(e){this._incrementConsoleMessageType(this._lastConsoleMessageType,1)}_incrementConsoleMessageType(e,t){switch(e){case WI.ConsoleMessage.MessageLevel.Log:case WI.ConsoleMessage.MessageLevel.Info:case WI.ConsoleMessage.MessageLevel.Debug:this.logs+=t;break;case WI.ConsoleMessage.MessageLevel.Warning:this.issues+=t;break;case WI.ConsoleMessage.MessageLevel.Error:this.errors+=t;break}}_consoleWasCleared(e){this._logs=0,this._issues=0,this._errors=0,this._dataDidChange()}_transitionPageTarget(){this._transitioningPageTarget=!0,this._time=0,this._resourcesCount=0,this._resourcesSize=0,this._dataDidChange()}};WI.DefaultDashboard.Event={DataDidChange:"default-dashboard-data-did-change"};WI.EventBreakpoint=class extends WI.Object{constructor(e,t,{eventListener:i,disabled:n}={}){super(),console.assert(Object.values(WI.EventBreakpoint.Type).includes(e),e),console.assert(typeof t=="string",t),this._type=e,this._eventName=t,this._eventListener=i||null,this._disabled=n||!1}static deserialize(e){return new WI.EventBreakpoint(e.type,e.eventName,{disabled:!!e.disabled})}get type(){return this._type}get eventName(){return this._eventName}get eventListener(){return this._eventListener}get disabled(){return this._disabled}set disabled(e){this._disabled!==e&&(this._disabled=e,this.dispatchEventToListeners(WI.EventBreakpoint.Event.DisabledStateChanged))}saveIdentityToCookie(e){e["event-breakpoint-type"]=this._type,e["event-breakpoint-event-name"]=this._eventName}toJSON(e){let t={type:this._type,eventName:this._eventName};return this._disabled&&(t.disabled=!0),e===WI.ObjectStore.toJSONSymbol&&(t[WI.objectStores.eventBreakpoints.keyPath]=this._type+":"+this._eventName),t}};WI.EventBreakpoint.Type={AnimationFrame:"animation-frame",Listener:"listener",Timer:"timer"};WI.EventBreakpoint.Event={DisabledStateChanged:"event-breakpoint-disabled-state-changed"};WI.ExecutionContext=class{constructor(e,t,i,n,s){console.assert(e instanceof WI.Target),console.assert(typeof t=="number"||t===WI.RuntimeManager.TopLevelExecutionContextIdentifier),console.assert(typeof i=="string"),this._target=e,this._id=t,this._name=i,this._isPageContext=n||!1,this._frame=s||null}get target(){return this._target}get id(){return this._id}get name(){return this._name}get isPageContext(){return this._isPageContext}get frame(){return this._frame}};WI.ExecutionContextList=class{constructor(){this._contexts=[],this._pageExecutionContext=null}get pageExecutionContext(){return this._pageExecutionContext}get contexts(){return this._contexts}add(e){return e.isPageContext&&this._pageExecutionContext?(console.assert(e.id===this._pageExecutionContext.id),!1):(this._contexts.push(e),e.isPageContext?(console.assert(!this._pageExecutionContext),this._pageExecutionContext=e,!0):!1)}clear(){this._contexts=[],this._pageExecutionContext=null}};WI.FPSInstrument=class extends WI.Instrument{constructor(){super(),console.assert(WI.FPSInstrument.supported())}static supported(){return window.TimelineAgent&&TimelineAgent.EventType.RenderingFrame}get timelineRecordType(){return WI.TimelineRecord.Type.RenderingFrame}};WI.Frame=class extends WI.Object{constructor(e,t,i,n,s){super(),console.assert(e),this._id=e,this._name=null,this._securityOrigin=null,this._resourceCollection=new WI.ResourceCollection,this._provisionalResourceCollection=new WI.ResourceCollection,this._extraScriptCollection=new WI.ScriptCollection,this._childFrameCollection=new WI.FrameCollection,this._childFrameIdentifierMap=new Map,this._parentFrame=null,this._isMainFrame=!1,this._domContentReadyEventTimestamp=NaN,this._loadEventTimestamp=NaN,this._executionContextList=new WI.ExecutionContextList,this.initialize(t,i,n,s)}get resourceCollection(){return this._resourceCollection}get extraScriptCollection(){return this._extraScriptCollection}get childFrameCollection(){return this._childFrameCollection}initialize(e,t,i,n){console.assert(i),console.assert(n);var s=this._name,a=this._securityOrigin,d=this._mainResource;this._name=e||null,this._securityOrigin=t||null,this._loaderIdentifier=i||null,this._mainResource=n,this._mainResource._parentFrame=this,d&&this._mainResource!==d&&this._disassociateWithResource(d),this.removeAllResources(),this.removeAllChildFrames(),this.clearExecutionContexts(),this.clearProvisionalLoad(),this._mainResource!==d&&this._dispatchMainResourceDidChangeEvent(d),this._securityOrigin!==a&&this.dispatchEventToListeners(WI.Frame.Event.SecurityOriginDidChange,{oldSecurityOrigin:a}),this._name!==s&&this.dispatchEventToListeners(WI.Frame.Event.NameDidChange,{oldName:s})}startProvisionalLoad(e){console.assert(e),this._provisionalMainResource=e,this._provisionalMainResource._parentFrame=this,this._provisionalLoaderIdentifier=e.loaderIdentifier,this._provisionalResourceCollection.clear(),this.dispatchEventToListeners(WI.Frame.Event.ProvisionalLoadStarted)}commitProvisionalLoad(e){if(console.assert(this._provisionalMainResource),console.assert(this._provisionalLoaderIdentifier),!!this._provisionalLoaderIdentifier){var t=this._securityOrigin,i=this._mainResource;this._securityOrigin=e||null,this._loaderIdentifier=this._provisionalLoaderIdentifier,this._mainResource=this._provisionalMainResource,this._domContentReadyEventTimestamp=NaN,this._loadEventTimestamp=NaN,i&&this._mainResource!==i&&this._disassociateWithResource(i),this.removeAllResources(),this._resourceCollection=this._provisionalResourceCollection,this._provisionalResourceCollection=new WI.ResourceCollection,this._extraScriptCollection.clear(),this.clearExecutionContexts(!0),this.clearProvisionalLoad(!0),this.removeAllChildFrames(),this.dispatchEventToListeners(WI.Frame.Event.ProvisionalLoadCommitted),this._mainResource!==i&&this._dispatchMainResourceDidChangeEvent(i),this._securityOrigin!==t&&this.dispatchEventToListeners(WI.Frame.Event.SecurityOriginDidChange,{oldSecurityOrigin:t})}}clearProvisionalLoad(e){!this._provisionalLoaderIdentifier||(this._provisionalLoaderIdentifier=null,this._provisionalMainResource=null,this._provisionalResourceCollection.clear(),e||this.dispatchEventToListeners(WI.Frame.Event.ProvisionalLoadCleared))}get id(){return this._id}get loaderIdentifier(){return this._loaderIdentifier}get provisionalLoaderIdentifier(){return this._provisionalLoaderIdentifier}get name(){return this._name}get securityOrigin(){return this._securityOrigin}get url(){return this._mainResource._url}get domTree(){return this._domTree||(this._domTree=new WI.DOMTree(this)),this._domTree}get pageExecutionContext(){return this._executionContextList.pageExecutionContext}get executionContextList(){return this._executionContextList}clearExecutionContexts(e){if(this._executionContextList.contexts.length){let t=this._executionContextList.contexts.slice();this._executionContextList.clear(),this.dispatchEventToListeners(WI.Frame.Event.ExecutionContextsCleared,{committingProvisionalLoad:!!e,contexts:t})}}addExecutionContext(e){var t=this._executionContextList.add(e);t&&this.dispatchEventToListeners(WI.Frame.Event.PageExecutionContextChanged)}get mainResource(){return this._mainResource}get provisionalMainResource(){return this._provisionalMainResource}get parentFrame(){return this._parentFrame}get domContentReadyEventTimestamp(){return this._domContentReadyEventTimestamp}get loadEventTimestamp(){return this._loadEventTimestamp}isMainFrame(){return this._isMainFrame}markAsMainFrame(){this._isMainFrame=!0}unmarkAsMainFrame(){this._isMainFrame=!1}markDOMContentReadyEvent(e){this._domContentReadyEventTimestamp=e||NaN}markLoadEvent(e){this._loadEventTimestamp=e||NaN}isDetached(){for(var e=this;e;){if(e.isMainFrame())return!1;e=e.parentFrame}return!0}childFrameForIdentifier(e){return this._childFrameIdentifierMap.get(e)||null}addChildFrame(e){console.assert(e instanceof WI.Frame),e instanceof WI.Frame&&e._parentFrame!==this&&(e._parentFrame&&e._parentFrame.removeChildFrame(e),this._childFrameCollection.add(e),this._childFrameIdentifierMap.set(e._id,e),e._parentFrame=this,this.dispatchEventToListeners(WI.Frame.Event.ChildFrameWasAdded,{childFrame:e}))}removeChildFrame(e){console.assert(e);let t=e;t instanceof WI.Frame&&(t=e._id);let i=this.childFrameForIdentifier(t);console.assert(i instanceof WI.Frame),i instanceof WI.Frame&&(console.assert(i.parentFrame===this),this._childFrameCollection.remove(i),this._childFrameIdentifierMap.delete(i._id),i._detachFromParentFrame(),this.dispatchEventToListeners(WI.Frame.Event.ChildFrameWasRemoved,{childFrame:i}))}removeAllChildFrames(){this._detachFromParentFrame();for(let e of this._childFrameCollection)e.removeAllChildFrames();this._childFrameCollection.clear(),this._childFrameIdentifierMap.clear(),this.dispatchEventToListeners(WI.Frame.Event.AllChildFramesRemoved)}resourceForURL(e,t){var i=this._resourceCollection.resourceForURL(e);if(i)return i;for(let n of this._childFrameCollection)if(i=n.mainResource,i.url===e)return i;if(!t)return null;for(let n of this._childFrameCollection)if(i=n.resourceForURL(e,!0),i)return i;return null}resourceCollectionForType(e){return this._resourceCollection.resourceCollectionForType(e)}addResource(e){console.assert(e instanceof WI.Resource),e instanceof WI.Resource&&e.parentFrame!==this&&(e.parentFrame&&e.parentFrame.remove(e),this._associateWithResource(e),this._isProvisionalResource(e)?(this._provisionalResourceCollection.add(e),this.dispatchEventToListeners(WI.Frame.Event.ProvisionalResourceWasAdded,{resource:e})):(this._resourceCollection.add(e),this.dispatchEventToListeners(WI.Frame.Event.ResourceWasAdded,{resource:e})))}removeResource(e){this._resourceCollection.remove(e),this._disassociateWithResource(e),this.dispatchEventToListeners(WI.Frame.Event.ResourceWasRemoved,{resource:e})}removeAllResources(){if(!!this._resourceCollection.size){for(let e of this._resourceCollection)this._disassociateWithResource(e);this._resourceCollection.clear(),this.dispatchEventToListeners(WI.Frame.Event.AllResourcesRemoved)}}addExtraScript(e){this._extraScriptCollection.add(e),this.dispatchEventToListeners(WI.Frame.Event.ExtraScriptAdded,{script:e})}saveIdentityToCookie(e){e[WI.Frame.MainResourceURLCookieKey]=this.mainResource.url.hash,e[WI.Frame.IsMainFrameCookieKey]=this._isMainFrame}_detachFromParentFrame(){this._domTree&&(this._domTree.disconnect(),this._domTree=null),this._parentFrame=null}_isProvisionalResource(e){return e.loaderIdentifier&&this._provisionalLoaderIdentifier&&e.loaderIdentifier===this._provisionalLoaderIdentifier}_associateWithResource(e){console.assert(!e._parentFrame),!e._parentFrame&&(e._parentFrame=this)}_disassociateWithResource(e){console.assert(e.parentFrame===this),e.parentFrame===this&&(e._parentFrame=null)}_dispatchMainResourceDidChangeEvent(e){this.dispatchEventToListeners(WI.Frame.Event.MainResourceDidChange,{oldMainResource:e})}};WI.Frame.Event={NameDidChange:"frame-name-did-change",SecurityOriginDidChange:"frame-security-origin-did-change",MainResourceDidChange:"frame-main-resource-did-change",ProvisionalLoadStarted:"frame-provisional-load-started",ProvisionalLoadCommitted:"frame-provisional-load-committed",ProvisionalLoadCleared:"frame-provisional-load-cleared",ProvisionalResourceWasAdded:"frame-provisional-resource-was-added",ResourceWasAdded:"frame-resource-was-added",ResourceWasRemoved:"frame-resource-was-removed",AllResourcesRemoved:"frame-all-resources-removed",ExtraScriptAdded:"frame-extra-script-added",ChildFrameWasAdded:"frame-child-frame-was-added",ChildFrameWasRemoved:"frame-child-frame-was-removed",AllChildFramesRemoved:"frame-all-child-frames-removed",PageExecutionContextChanged:"frame-page-execution-context-changed",ExecutionContextsCleared:"frame-execution-contexts-cleared"};WI.Frame.TypeIdentifier="Frame";WI.Frame.MainResourceURLCookieKey="frame-main-resource-url";WI.Frame.IsMainFrameCookieKey="frame-is-main-frame";WI.GarbageCollection=class{constructor(e,t,i){console.assert(i>=t),this._type=e,this._startTime=t,this._endTime=i}static fromPayload(e){let t=WI.GarbageCollection.Type.Full;return e.type===HeapAgent.GarbageCollectionType.Partial&&(t=WI.GarbageCollection.Type.Partial),new WI.GarbageCollection(t,e.startTime,e.endTime)}static fromJSON(e){let{type:t,startTime:i,endTime:n}=e;return new WI.GarbageCollection(t,i,n)}toJSON(){return{__type:"GarbageCollection",type:this.type,startTime:this.startTime,endTime:this.endTime}}get type(){return this._type}get startTime(){return this._startTime}get endTime(){return this._endTime}get duration(){return this._endTime-this._startTime}};WI.GarbageCollection.Type={Partial:"partial",Full:"full"};WI.Point=class{constructor(e,t){this.x=e||0,this.y=t||0}static fromEvent(e){return new WI.Point(e.pageX,e.pageY)}static fromEventInElement(e,t){var i=window.webkitConvertPointFromPageToNode(t,new WebKitPoint(e.pageX,e.pageY));return new WI.Point(i.x,i.y)}toString(){return"WI.Point["+this.x+","+this.y+"]"}copy(){return new WI.Point(this.x,this.y)}equals(e){return this.x===e.x&&this.y===e.y}distance(e){let t=e.x-this.x,i=e.y-this.y;return Math.sqrt(t*t+i*i)}};WI.Size=class{constructor(e,t){this.width=e||0,this.height=t||0}toString(){return"WI.Size["+this.width+","+this.height+"]"}copy(){return new WI.Size(this.width,this.height)}equals(e){return this.width===e.width&&this.height===e.height}};WI.Size.ZERO_SIZE=new WI.Size(0,0);WI.Rect=class{constructor(e,t,i,n){this.origin=new WI.Point(e||0,t||0),this.size=new WI.Size(i||0,n||0)}static rectFromClientRect(e){return new WI.Rect(e.left,e.top,e.width,e.height)}static unionOfRects(e){for(var t=e[0],i=1;i<e.length;++i)t=t.unionWithRect(e[i]);return t}toString(){return"WI.Rect["+[this.origin.x,this.origin.y,this.size.width,this.size.height].join(", ")+"]"}copy(){return new WI.Rect(this.origin.x,this.origin.y,this.size.width,this.size.height)}equals(e){return this.origin.equals(e.origin)&&this.size.equals(e.size)}inset(e){return new WI.Rect(this.origin.x+e.left,this.origin.y+e.top,this.size.width-e.left-e.right,this.size.height-e.top-e.bottom)}pad(e){return new WI.Rect(this.origin.x-e,this.origin.y-e,this.size.width+e*2,this.size.height+e*2)}minX(){return this.origin.x}minY(){return this.origin.y}midX(){return this.origin.x+this.size.width/2}midY(){return this.origin.y+this.size.height/2}maxX(){return this.origin.x+this.size.width}maxY(){return this.origin.y+this.size.height}intersectionWithRect(e){var t=Math.max(this.minX(),e.minX()),i=Math.min(this.maxX(),e.maxX());if(t>i)return WI.Rect.ZERO_RECT;var n=new WI.Rect;n.origin.x=t,n.size.width=i-t;var s=Math.max(this.minY(),e.minY()),a=Math.min(this.maxY(),e.maxY());return s>a?WI.Rect.ZERO_RECT:(n.origin.y=s,n.size.height=a-s,n)}unionWithRect(e){var t=Math.min(this.minX(),e.minX()),i=Math.min(this.minY(),e.minY()),n=Math.max(this.maxX(),e.maxX())-t,s=Math.max(this.maxY(),e.maxY())-i;return new WI.Rect(t,i,n,s)}round(){return new WI.Rect(Math.floor(this.origin.x),Math.floor(this.origin.y),Math.ceil(this.size.width),Math.ceil(this.size.height))}};WI.Rect.ZERO_RECT=new WI.Rect(0,0,0,0);WI.EdgeInsets=class{constructor(e,t,i,n){console.assert(arguments.length===1||arguments.length===4),arguments.length===1?(this.top=e,this.right=e,this.bottom=e,this.left=e):arguments.length===4&&(this.top=e,this.right=t,this.bottom=i,this.left=n)}equals(e){return this.top===e.top&&this.right===e.right&&this.bottom===e.bottom&&this.left===e.left}copy(){return new WI.EdgeInsets(this.top,this.right,this.bottom,this.left)}};WI.RectEdge={MIN_X:0,MIN_Y:1,MAX_X:2,MAX_Y:3};WI.Quad=class{constructor(e){this.points=[new WI.Point(e[0],e[1]),new WI.Point(e[2],e[3]),new WI.Point(e[4],e[5]),new WI.Point(e[6],e[7])],this.width=Math.round(Math.sqrt(Math.pow(e[0]-e[2],2)+Math.pow(e[1]-e[3],2))),this.height=Math.round(Math.sqrt(Math.pow(e[0]-e[6],2)+Math.pow(e[1]-e[7],2)))}static fromJSON(e){return new WI.Quad(e)}toJSON(){return this.toProtocol()}toProtocol(){return[this.points[0].x,this.points[0].y,this.points[1].x,this.points[1].y,this.points[2].x,this.points[2].y,this.points[3].x,this.points[3].y]}};WI.Polygon=class{constructor(e){this.points=e}bounds(){var e=Number.MAX_VALUE,t=Number.MAX_VALUE,i=-Number.MAX_VALUE,n=-Number.MAX_VALUE;for(var s of this.points)e=Math.min(e,s.x),i=Math.max(i,s.x),t=Math.min(t,s.y),n=Math.max(n,s.y);return new WI.Rect(e,t,i-e,n-t)}};WI.CubicBezier=class{constructor(e,t,i,n){this._inPoint=new WI.Point(e,t),this._outPoint=new WI.Point(i,n),this._curveInfo={x:{c:3*e},y:{c:3*t}},this._curveInfo.x.b=3*(i-e)-this._curveInfo.x.c,this._curveInfo.x.a=1-this._curveInfo.x.c-this._curveInfo.x.b,this._curveInfo.y.b=3*(n-t)-this._curveInfo.y.c,this._curveInfo.y.a=1-this._curveInfo.y.c-this._curveInfo.y.b}static fromCoordinates(e){return!e||e.length<4||(e=e.map(Number),e.includes(NaN))?null:new WI.CubicBezier(e[0],e[1],e[2],e[3])}static fromString(e){if(!e||!e.length)return null;var t=e.toLowerCase().replace(/\s/g,"");if(!t.length)return null;if(Object.keys(WI.CubicBezier.keywordValues).includes(t))return WI.CubicBezier.fromCoordinates(WI.CubicBezier.keywordValues[t]);var i=t.match(/^cubic-bezier\(([-\d.]+),([-\d.]+),([-\d.]+),([-\d.]+)\)$/);return i?(i.splice(0,1),WI.CubicBezier.fromCoordinates(i)):null}get inPoint(){return this._inPoint}get outPoint(){return this._outPoint}copy(){return new WI.CubicBezier(this._inPoint.x,this._inPoint.y,this._outPoint.x,this._outPoint.y)}toString(){var e=[this._inPoint.x,this._inPoint.y,this._outPoint.x,this._outPoint.y];for(var t in WI.CubicBezier.keywordValues)if(Array.shallowEqual(WI.CubicBezier.keywordValues[t],e))return t;return"cubic-bezier("+e.join(", ")+")"}solve(e,t){return this._sampleCurveY(this._solveCurveX(e,t))}_sampleCurveX(e){return((this._curveInfo.x.a*e+this._curveInfo.x.b)*e+this._curveInfo.x.c)*e}_sampleCurveY(e){return((this._curveInfo.y.a*e+this._curveInfo.y.b)*e+this._curveInfo.y.c)*e}_sampleCurveDerivativeX(e){return(3*this._curveInfo.x.a*e+2*this._curveInfo.x.b)*e+this._curveInfo.x.c}_solveCurveX(e,t){var i,n,s,a,d,p;for(s=e,p=0;p<8;p++){if(a=this._sampleCurveX(s)-e,Math.abs(a)<t)return s;if(d=this._sampleCurveDerivativeX(s),Math.abs(d)<1e-6)break;s=s-a/d}if(i=0,n=1,s=e,s<i)return i;if(s>n)return n;for(;i<n;){if(a=this._sampleCurveX(s),Math.abs(a-e)<t)return s;e>a?i=s:n=s,s=(n-i)*.5+i}return s}};WI.CubicBezier.keywordValues={ease:[.25,.1,.25,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1],linear:[0,0,1,1]};WI.Spring=class{constructor(e,t,i,n){this.mass=Math.max(1,e),this.stiffness=Math.max(1,t),this.damping=Math.max(0,i),this.initialVelocity=n}static fromValues(e){return!e||e.length<4||(e=e.map(Number),e.includes(NaN))?null:new WI.Spring(...e)}static fromString(e){if(!e||!e.length)return null;let t=e.toLowerCase().trim();if(!t.length)return null;let i=t.match(/^spring\(([\d.]+)\s+([\d.]+)\s+([\d.]+)\s+([-\d.]+)\)$/);return i?WI.Spring.fromValues(i.slice(1)):null}copy(){return new WI.Spring(this.mass,this.stiffness,this.damping,this.initialVelocity)}toString(){return`spring(${this.mass} ${this.stiffness} ${this.damping} ${this.initialVelocity})`}solve(e){let t=Math.sqrt(this.stiffness/this.mass),i=this.damping/(2*Math.sqrt(this.stiffness*this.mass)),n=0,s=1,a=-this.initialVelocity+t;return i<1&&(n=t*Math.sqrt(1-i*i),s=1,a=(i*t+-this.initialVelocity)/n),i<1?e=Math.exp(-e*i*t)*(s*Math.cos(n*e)+a*Math.sin(n*e)):e=(s+a*e)*Math.exp(-e*t),1-e}calculateDuration(e){e=e||1e-4;let t=0,i=0,n=Number.POSITIVE_INFINITY;for(;i>=e||n>=e;)i=Math.abs(1-this.solve(t)),n<e&&i>=e?n=Number.POSITIVE_INFINITY:i<n&&(n=i),t+=.1;return t}};WI.Gradient=class{constructor(e,t){this.type=e,this.stops=t}static fromString(e){var t,i=e.indexOf("("),n=e.substring(0,i);if(n.indexOf(WI.Gradient.Types.Linear)!==-1)t=WI.Gradient.Types.Linear;else if(n.indexOf(WI.Gradient.Types.Radial)!==-1)t=WI.Gradient.Types.Radial;else return null;for(var s=[],a=[],d="",p=0,f=i+1,_=null;_=e[f];){_==="("&&p++,_===")"&&p--;var b=_===",",w=/\s/.test(_);if(p===0&&(w?(d!==""&&a.push(d),d=""):b&&(a.push(d),s.push(a),a=[],d="")),p===-1){a.push(d),s.push(a);break}(p>0||!b&&!w)&&(d+=_),f++}if(p!==-1)return null;var S;return t===WI.Gradient.Types.Linear?S=WI.LinearGradient.fromComponents(s):S=WI.RadialGradient.fromComponents(s),S&&(S.repeats=n.startsWith("repeating")),S}static stopsWithComponents(e){var t=e.map(function(a){for(;a.length;){var d=WI.Color.fromString(a.shift());if(!!d){var p={color:d};return a.length&&a[0].substr(-1)==="%"&&(p.offset=parseFloat(a.shift())/100),p}}});if(!t.length)return null;for(var i=0,n=t.length;i<n;++i){var s=t[i];if(!s)return null;s.offset||(s.offset=i/(n-1))}return t}stringFromStops(e){var t=e.length-1;return e.map(function(i,n){var s=i.color;return i.offset!==n/t&&(s+=" "+Math.round(i.offset*1e4)/100+"%"),s}).join(", ")}copy(){}toString(){}};WI.Gradient.Types={Linear:"linear-gradient",Radial:"radial-gradient"};WI.LinearGradient=class extends WI.Gradient{constructor(e,t){super(WI.Gradient.Types.Linear,t),this._angle=e}static fromComponents(e){let t={value:180,units:WI.LinearGradient.AngleUnits.DEG};if(e[0].length===1&&!WI.Color.fromString(e[0][0])){let n=e[0][0].match(/([-\d\.]+)(\w+)/);if(!n||!Object.values(WI.LinearGradient.AngleUnits).includes(n[2]))return null;t.value=parseFloat(n[1]),t.units=n[2],e.shift()}else if(e[0][0]==="to"){switch(e[0].shift(),e[0].sort().join(" ")){case"top":t.value=0;break;case"right top":t.value=45;break;case"right":t.value=90;break;case"bottom right":t.value=135;break;case"bottom":t.value=180;break;case"bottom left":t.value=225;break;case"left":t.value=270;break;case"left top":t.value=315;break;default:return null}e.shift()}else if(e[0].length!==1&&!WI.Color.fromString(e[0][0]))return null;var i=WI.Gradient.stopsWithComponents(e);return i?new WI.LinearGradient(t,i):null}set angleValue(e){this._angle.value=e}get angleValue(){return this._angle.value.maxDecimals(2)}set angleUnits(e){e!==this._angle.units&&(this._angle.value=this._angleValueForUnits(e),this._angle.units=e)}get angleUnits(){return this._angle.units}copy(){return new WI.LinearGradient(this._angle,this.stops.concat())}toString(){let e="",t=this._angleValueForUnits(WI.LinearGradient.AngleUnits.DEG);return t===0?e+="to top":t===45?e+="to top right":t===90?e+="to right":t===135?e+="to bottom right":t===225?e+="to bottom left":t===270?e+="to left":t===315?e+="to top left":t!==180&&(e+=this.angleValue+this.angleUnits),e!==""&&(e+=", "),e+=this.stringFromStops(this.stops),(this.repeats?"repeating-":"")+this.type+"("+e+")"}_angleValueForUnits(e){if(e===this._angle.units)return this._angle.value;let t=0;switch(this._angle.units){case WI.LinearGradient.AngleUnits.DEG:t=this._angle.value;break;case WI.LinearGradient.AngleUnits.RAD:t=this._angle.value*180/Math.PI;break;case WI.LinearGradient.AngleUnits.GRAD:t=this._angle.value/400*360;break;case WI.LinearGradient.AngleUnits.TURN:t=this._angle.value*360;break;default:return WI.reportInternalError(`Unknown angle units "${this._angle.units}"`),0}let i=0;switch(e){case WI.LinearGradient.AngleUnits.DEG:i=t;break;case WI.LinearGradient.AngleUnits.RAD:i=t*Math.PI/180;break;case WI.LinearGradient.AngleUnits.GRAD:i=t/360*400;break;case WI.LinearGradient.AngleUnits.TURN:i=t/360;break}return i}};WI.LinearGradient.AngleUnits={DEG:"deg",RAD:"rad",GRAD:"grad",TURN:"turn"};WI.RadialGradient=class extends WI.Gradient{constructor(e,t){super(WI.Gradient.Types.Radial,t),this.sizing=e}static fromComponents(e){var t=WI.Color.fromString(e[0].join(" "))?"":e.shift().join(" "),i=WI.Gradient.stopsWithComponents(e);return i?new WI.RadialGradient(t,i):null}copy(){return new WI.RadialGradient(this.sizing,this.stops.concat())}toString(){var e=this.sizing;return e!==""&&(e+=", "),e+=this.stringFromStops(this.stops),(this.repeats?"repeating-":"")+this.type+"("+e+")"}};WI.HeapAllocationsInstrument=class extends WI.Instrument{constructor(){super(),console.assert(WI.HeapAllocationsInstrument.supported()),this._snapshotIntervalIdentifier=void 0}static supported(){return window.HeapAgent}get timelineRecordType(){return WI.TimelineRecord.Type.HeapAllocations}startInstrumentation(e){e||HeapAgent.startTracking();const t=1e4;this._snapshotIntervalIdentifier=setInterval(this._takeHeapSnapshot.bind(this),t)}stopInstrumentation(e){e||HeapAgent.stopTracking(),window.clearInterval(this._snapshotIntervalIdentifier),this._snapshotIntervalIdentifier=void 0}_takeHeapSnapshot(){HeapAgent.snapshot(function(e,t,i){WI.HeapSnapshotWorkerProxy.singleton().createSnapshot(i,({objectId:s,snapshot:a})=>{let d=WI.HeapSnapshotProxy.deserialize(s,a);d.snapshotStringData=i,WI.timelineManager.heapSnapshotAdded(t,d)})})}};WI.HeapAllocationsTimelineRecord=class extends WI.TimelineRecord{constructor(e,t){super(WI.TimelineRecord.Type.HeapAllocations,e,e),console.assert(typeof e=="number"),console.assert(t instanceof WI.HeapSnapshotProxy),this._timestamp=e,this._heapSnapshot=t}static fromJSON(e){let{timestamp:t,title:i,snapshotStringData:n}=e;return WI.HeapSnapshotWorkerProxy.singleton().createImportedSnapshot(n,i,({objectId:a,snapshot:d})=>{let p=WI.HeapSnapshotProxy.deserialize(a,d);p.snapshotStringData=n,WI.timelineManager.heapSnapshotAdded(t,p)}),null}toJSON(){return{type:this.type,timestamp:this._timestamp,title:WI.TimelineTabContentView.displayNameForRecord(this),snapshotStringData:this._heapSnapshot.snapshotStringData}}get timestamp(){return this._timestamp}get heapSnapshot(){return this._heapSnapshot}};WI.HeapSnapshotRootPath=class{constructor(e,t,i,n){console.assert(!e||e instanceof WI.HeapSnapshotNodeProxy),console.assert(!t||typeof t=="string"),console.assert(!i||i instanceof WI.HeapSnapshotRootPath),this._node=e||null,this._parent=i||null,this._pathComponent=typeof t=="string"?t:null,this._isGlobalScope=n||!1,this._parent&&this._parent.isEmpty()&&(this._parent=null)}static emptyPath(){return new WI.HeapSnapshotRootPath(null)}static pathComponentForIndividualEdge(e){switch(e.type){case WI.HeapSnapshotEdgeProxy.EdgeType.Internal:return null;case WI.HeapSnapshotEdgeProxy.EdgeType.Index:return"["+e.data+"]";case WI.HeapSnapshotEdgeProxy.EdgeType.Property:case WI.HeapSnapshotEdgeProxy.EdgeType.Variable:return WI.HeapSnapshotRootPath.canPropertyNameBeDotAccess(e.data)?e.data:"["+doubleQuotedString(e.data)+"]"}}static canPropertyNameBeDotAccess(e){return/^(?![0-9])\w+$/.test(e)}get node(){return this._node}get parent(){return this._parent}get pathComponent(){return this._pathComponent}get rootNode(){return this._parent?this._parent.rootNode:this._node}get fullPath(){let e=[];for(let t=this;t&&t.pathComponent;t=t.parent)e.push(t.pathComponent);return e.reverse(),e.join("")}isRoot(){return!this._parent}isEmpty(){return!this._node}isGlobalScope(){return this._isGlobalScope}isPathComponentImpossible(){return this._pathComponent&&this._pathComponent.startsWith("@")}isFullPathImpossible(){return this.isEmpty()||this.isPathComponentImpossible()?!0:this._parent?this._parent.isFullPathImpossible():!1}appendInternal(e){return new WI.HeapSnapshotRootPath(e,WI.HeapSnapshotRootPath.SpecialPathComponent.InternalPropertyName,this)}appendArrayIndex(e,t){let i="["+t+"]";return new WI.HeapSnapshotRootPath(e,i,this)}appendPropertyName(e,t){let i=WI.HeapSnapshotRootPath.canPropertyNameBeDotAccess(t)?"."+t:"["+doubleQuotedString(t)+"]";return new WI.HeapSnapshotRootPath(e,i,this)}appendVariableName(e,t){return this._isGlobalScope?this.appendPropertyName(e,t):new WI.HeapSnapshotRootPath(e,t,this)}appendGlobalScopeName(e,t){return new WI.HeapSnapshotRootPath(e,t,this,!0)}appendEdge(e){switch(console.assert(e instanceof WI.HeapSnapshotEdgeProxy),e.type){case WI.HeapSnapshotEdgeProxy.EdgeType.Internal:return this.appendInternal(e.to);case WI.HeapSnapshotEdgeProxy.EdgeType.Index:return this.appendArrayIndex(e.to,e.data);case WI.HeapSnapshotEdgeProxy.EdgeType.Property:return this.appendPropertyName(e.to,e.data);case WI.HeapSnapshotEdgeProxy.EdgeType.Variable:return this.appendVariableName(e.to,e.data)}console.error("Unexpected edge type",e.type)}};WI.HeapSnapshotRootPath.SpecialPathComponent={InternalPropertyName:"@internal"};WI.IndexedDatabase=class{constructor(e,t,i,n){this._name=e,this._securityOrigin=t,this._host=parseSecurityOrigin(t).host,this._version=i,this._objectStores=n||[];for(var s of this._objectStores)s.establishRelationship(this)}get name(){return this._name}get securityOrigin(){return this._securityOrigin}get host(){return this._host}get version(){return this._version}get objectStores(){return this._objectStores}saveIdentityToCookie(e){e[WI.IndexedDatabase.NameCookieKey]=this._name,e[WI.IndexedDatabase.HostCookieKey]=this._host}};WI.IndexedDatabase.TypeIdentifier="indexed-database";WI.IndexedDatabase.NameCookieKey="indexed-database-name";WI.IndexedDatabase.HostCookieKey="indexed-database-host";WI.IndexedDatabaseObjectStore=class{constructor(e,t,i,n){this._name=e,this._keyPath=t,this._autoIncrement=i||!1,this._indexes=n||[],this._parentDatabase=null;for(var s of this._indexes)s.establishRelationship(this)}get name(){return this._name}get keyPath(){return this._keyPath}get autoIncrement(){return this._autoIncrement}get parentDatabase(){return this._parentDatabase}get indexes(){return this._indexes}saveIdentityToCookie(e){e[WI.IndexedDatabaseObjectStore.NameCookieKey]=this._name,e[WI.IndexedDatabaseObjectStore.KeyPathCookieKey]=this._keyPath}establishRelationship(e){this._parentDatabase=e||null}};WI.IndexedDatabaseObjectStore.TypeIdentifier="indexed-database-object-store";WI.IndexedDatabaseObjectStore.NameCookieKey="indexed-database-object-store-name";WI.IndexedDatabaseObjectStore.KeyPathCookieKey="indexed-database-object-store-key-path";WI.IndexedDatabaseObjectStoreIndex=class{constructor(e,t,i,n){this._name=e,this._keyPath=t,this._unique=i||!1,this._multiEntry=n||!1,this._parentObjectStore=null}get name(){return this._name}get keyPath(){return this._keyPath}get unique(){return this._unique}get multiEntry(){return this._multiEntry}get parentObjectStore(){return this._parentObjectStore}saveIdentityToCookie(e){e[WI.IndexedDatabaseObjectStoreIndex.NameCookieKey]=this._name,e[WI.IndexedDatabaseObjectStoreIndex.KeyPathCookieKey]=this._keyPath}establishRelationship(e){this._parentObjectStore=e||null}};WI.IndexedDatabaseObjectStoreIndex.TypeIdentifier="indexed-database-object-store-index";WI.IndexedDatabaseObjectStoreIndex.NameCookieKey="indexed-database-object-store-index-name";WI.IndexedDatabaseObjectStoreIndex.KeyPathCookieKey="indexed-database-object-store-index-key-path";WI.IssueMessage=class extends WI.Object{constructor(e){switch(super(),console.assert(e instanceof WI.ConsoleMessage),this._consoleMessage=e,this._text=this._issueText(),this._consoleMessage.source){case"javascript":var t=/^([^:]+): (?:DOM Exception \d+: )?/,i=t.exec(this._text);i&&i[1]in WI.IssueMessage.Type._prefixTypeMap?(this._type=WI.IssueMessage.Type._prefixTypeMap[i[1]],this._text=this._text.substring(i[0].length)):this._type=WI.IssueMessage.Type.OtherIssue;break;case"css":case"xml":this._type=WI.IssueMessage.Type.PageIssue;break;case"network":this._type=WI.IssueMessage.Type.NetworkIssue;break;case"security":this._type=WI.IssueMessage.Type.SecurityIssue;break;case"console-api":case"storage":case"appcache":case"rendering":case"other":case"media":case"mediasource":case"webrtc":this._type=WI.IssueMessage.Type.OtherIssue;break;default:console.error("Unknown issue source:",this._consoleMessage.source),this._type=WI.IssueMessage.Type.OtherIssue}this._sourceCodeLocation=e.sourceCodeLocation,this._sourceCodeLocation&&this._sourceCodeLocation.addEventListener(WI.SourceCodeLocation.Event.DisplayLocationChanged,this._sourceCodeLocationDisplayLocationChanged,this)}static displayName(e){switch(e){case WI.IssueMessage.Type.SemanticIssue:return WI.UIString("Semantic Issue");case WI.IssueMessage.Type.RangeIssue:return WI.UIString("Range Issue");case WI.IssueMessage.Type.ReferenceIssue:return WI.UIString("Reference Issue");case WI.IssueMessage.Type.TypeIssue:return WI.UIString("Type Issue");case WI.IssueMessage.Type.PageIssue:return WI.UIString("Page Issue");case WI.IssueMessage.Type.NetworkIssue:return WI.UIString("Network Issue");case WI.IssueMessage.Type.SecurityIssue:return WI.UIString("Security Issue");case WI.IssueMessage.Type.OtherIssue:return WI.UIString("Other Issue");default:return console.error("Unknown issue message type:",e),WI.UIString("Other Issue")}}get text(){return this._text}get type(){return this._type}get level(){return this._consoleMessage.level}get source(){return this._consoleMessage.source}get url(){return this._consoleMessage.url}get sourceCodeLocation(){return this._sourceCodeLocation}saveIdentityToCookie(e){e[WI.IssueMessage.URLCookieKey]=this.url,e[WI.IssueMessage.LineNumberCookieKey]=this._sourceCodeLocation?this._sourceCodeLocation.lineNumber:0,e[WI.IssueMessage.ColumnNumberCookieKey]=this._sourceCodeLocation?this._sourceCodeLocation.columnNumber:0}_issueText(){let e=this._consoleMessage.parameters;if(!e)return this._consoleMessage.messageText;if(e[0].type!=="string")return this._consoleMessage.messageText;function t(d){return d.description}let i={};i.o=t,i.s=t,i.f=t,i.i=t,i.d=t;function n(d,p){return d+=p,d}let s=String.format(e[0].description,e.slice(1),i,"",n),a=s.formattedResult;for(let d=0;d<s.unusedSubstitutions.length;++d)a+=" "+s.unusedSubstitutions[d].description;return a}_sourceCodeLocationDisplayLocationChanged(e){this.dispatchEventToListeners(WI.IssueMessage.Event.DisplayLocationDidChange,e.data)}};WI.IssueMessage.Level={Error:"error",Warning:"warning"};WI.IssueMessage.Type={SemanticIssue:"issue-message-type-semantic-issue",RangeIssue:"issue-message-type-range-issue",ReferenceIssue:"issue-message-type-reference-issue",TypeIssue:"issue-message-type-type-issue",PageIssue:"issue-message-type-page-issue",NetworkIssue:"issue-message-type-network-issue",SecurityIssue:"issue-message-type-security-issue",OtherIssue:"issue-message-type-other-issue"};WI.IssueMessage.TypeIdentifier="issue-message";WI.IssueMessage.URLCookieKey="issue-message-url";WI.IssueMessage.LineNumberCookieKey="issue-message-line-number";WI.IssueMessage.ColumnNumberCookieKey="issue-message-column-number";WI.IssueMessage.Event={LocationDidChange:"issue-message-location-did-change",DisplayLocationDidChange:"issue-message-display-location-did-change"};WI.IssueMessage.Type._prefixTypeMap={SyntaxError:WI.IssueMessage.Type.SemanticIssue,URIError:WI.IssueMessage.Type.SemanticIssue,EvalError:WI.IssueMessage.Type.SemanticIssue,INVALID_CHARACTER_ERR:WI.IssueMessage.Type.SemanticIssue,SYNTAX_ERR:WI.IssueMessage.Type.SemanticIssue,RangeError:WI.IssueMessage.Type.RangeIssue,INDEX_SIZE_ERR:WI.IssueMessage.Type.RangeIssue,DOMSTRING_SIZE_ERR:WI.IssueMessage.Type.RangeIssue,ReferenceError:WI.IssueMessage.Type.ReferenceIssue,HIERARCHY_REQUEST_ERR:WI.IssueMessage.Type.ReferenceIssue,INVALID_STATE_ERR:WI.IssueMessage.Type.ReferenceIssue,NOT_FOUND_ERR:WI.IssueMessage.Type.ReferenceIssue,WRONG_DOCUMENT_ERR:WI.IssueMessage.Type.ReferenceIssue,TypeError:WI.IssueMessage.Type.TypeIssue,INVALID_NODE_TYPE_ERR:WI.IssueMessage.Type.TypeIssue,TYPE_MISMATCH_ERR:WI.IssueMessage.Type.TypeIssue,SECURITY_ERR:WI.IssueMessage.Type.SecurityIssue,NETWORK_ERR:WI.IssueMessage.Type.NetworkIssue,ABORT_ERR:WI.IssueMessage.Type.OtherIssue,DATA_CLONE_ERR:WI.IssueMessage.Type.OtherIssue,INUSE_ATTRIBUTE_ERR:WI.IssueMessage.Type.OtherIssue,INVALID_ACCESS_ERR:WI.IssueMessage.Type.OtherIssue,INVALID_MODIFICATION_ERR:WI.IssueMessage.Type.OtherIssue,NAMESPACE_ERR:WI.IssueMessage.Type.OtherIssue,NOT_SUPPORTED_ERR:WI.IssueMessage.Type.OtherIssue,NO_DATA_ALLOWED_ERR:WI.IssueMessage.Type.OtherIssue,NO_MODIFICATION_ALLOWED_ERR:WI.IssueMessage.Type.OtherIssue,QUOTA_EXCEEDED_ERR:WI.IssueMessage.Type.OtherIssue,TIMEOUT_ERR:WI.IssueMessage.Type.OtherIssue,URL_MISMATCH_ERR:WI.IssueMessage.Type.OtherIssue,VALIDATION_ERR:WI.IssueMessage.Type.OtherIssue};WI.KeyboardShortcut=class{constructor(e,t,i,n){if(console.assert(t),console.assert(!i||typeof i=="function"),console.assert(!n||n instanceof Element),typeof t=="string"&&(t=t[0].toUpperCase(),t=new WI.Key(t.charCodeAt(0),t)),i&&!n&&(n=document),this._modifiers=e||WI.KeyboardShortcut.Modifier.None,this._key=t,this._targetElement=n,this._callback=i,this._disabled=!1,this._implicitlyPreventsDefault=!0,n){var s=n._keyboardShortcuts;s||(s=n._keyboardShortcuts=[]),s.push(this),WI.KeyboardShortcut._registeredKeyDownListener||(WI.KeyboardShortcut._registeredKeyDownListener=!0,window.addEventListener("keydown",WI.KeyboardShortcut._handleKeyDown))}}static _handleKeyDown(e){if(!e.defaultPrevented){for(var t=e.target;t;t=t.parentNode)if(!!t._keyboardShortcuts)for(var i=0;i<t._keyboardShortcuts.length;++i){var n=t._keyboardShortcuts[i];if(!!n.matchesEvent(e)&&!!n.callback){n.callback(e,n),n.implicitlyPreventsDefault&&e.preventDefault();return}}}}get modifiers(){return this._modifiers}get key(){return this._key}get displayName(){var e="";return this._modifiers&WI.KeyboardShortcut.Modifier.Control&&(e+="\u2303"),this._modifiers&WI.KeyboardShortcut.Modifier.Option&&(e+=WI.Platform.name==="mac"?"\u2325":"\u2387"),this._modifiers&WI.KeyboardShortcut.Modifier.Shift&&(e+="\u21E7"),this._modifiers&WI.KeyboardShortcut.Modifier.Command&&(e+="\u2318"),e+=this._key.toString(),e}get callback(){return this._callback}set callback(e){console.assert(!e||typeof e=="function"),this._callback=e||null}get disabled(){return this._disabled}set disabled(e){this._disabled=e||!1}get implicitlyPreventsDefault(){return this._implicitlyPreventsDefault}set implicitlyPreventsDefault(e){this._implicitlyPreventsDefault=e}unbind(){if(this._disabled=!0,!!this._targetElement){var e=this._targetElement._keyboardShortcuts;!e||e.remove(this)}}matchesEvent(e){if(this._disabled||this._key.keyCode!==e.keyCode)return!1;var t=WI.KeyboardShortcut.Modifier.None;return e.shiftKey&&(t|=WI.KeyboardShortcut.Modifier.Shift),e.ctrlKey&&(t|=WI.KeyboardShortcut.Modifier.Control),e.altKey&&(t|=WI.KeyboardShortcut.Modifier.Option),e.metaKey&&(t|=WI.KeyboardShortcut.Modifier.Command),this._modifiers===t}};WI.Key=class{constructor(e,t){this._keyCode=e,this._displayName=t}get keyCode(){return this._keyCode}get displayName(){return this._displayName}toString(){return this._displayName}};WI.KeyboardShortcut.Modifier={None:0,Shift:1,Control:2,Option:4,Command:8,get CommandOrControl(){return WI.Platform.name==="mac"?this.Command:this.Control}};WI.KeyboardShortcut.Key={Backspace:new WI.Key(8,"\u232B"),Tab:new WI.Key(9,"\u21E5"),Enter:new WI.Key(13,"\u21A9"),Escape:new WI.Key(27,"\u238B"),Space:new WI.Key(32,"Space"),PageUp:new WI.Key(33,"\u21DE"),PageDown:new WI.Key(34,"\u21DF"),End:new WI.Key(35,"\u2198"),Home:new WI.Key(36,"\u2196"),Left:new WI.Key(37,"\u2190"),Up:new WI.Key(38,"\u2191"),Right:new WI.Key(39,"\u2192"),Down:new WI.Key(40,"\u2193"),Delete:new WI.Key(46,"\u2326"),Zero:new WI.Key(48,"0"),F1:new WI.Key(112,"F1"),F2:new WI.Key(113,"F2"),F3:new WI.Key(114,"F3"),F4:new WI.Key(115,"F4"),F5:new WI.Key(116,"F5"),F6:new WI.Key(117,"F6"),F7:new WI.Key(118,"F7"),F8:new WI.Key(119,"F8"),F9:new WI.Key(120,"F9"),F10:new WI.Key(121,"F10"),F11:new WI.Key(122,"F11"),F12:new WI.Key(123,"F12"),Semicolon:new WI.Key(186,";"),Plus:new WI.Key(187,"+"),Comma:new WI.Key(188,","),Minus:new WI.Key(189,"-"),Period:new WI.Key(190,"."),Slash:new WI.Key(191,"/"),Apostrophe:new WI.Key(192,"`"),LeftCurlyBrace:new WI.Key(219,"{"),Backslash:new WI.Key(220,"\\"),RightCurlyBrace:new WI.Key(221,"}"),SingleQuote:new WI.Key(222,"'")};WI.Layer=class{constructor(e,t,i,n,s,a,d,p,f,_,b,w){console.assert(typeof i=="object"),this._layerId=e,this._nodeId=t,this._bounds=i,this._paintCount=n,this._memory=s,this._compositedBounds=a,this._isInShadowTree=d,this._isReflection=p,this._isGeneratedContent=f,this._isAnonymous=_,this._pseudoElementId=b,this._pseudoElement=w,this._compositedBounds.x=this._bounds.x,this._compositedBounds.y=this._bounds.y}static fromPayload(e){return new WI.Layer(e.layerId,e.nodeId,e.bounds,e.paintCount,e.memory,e.compositedBounds,e.isInShadowTree,e.isReflection,e.isGeneratedContent,e.isAnonymous,e.pseudoElementId,e.pseudoElement)}get layerId(){return this._layerId}get nodeId(){return this._nodeId}get bounds(){return this._bounds}get paintCount(){return this._paintCount}get memory(){return this._memory}get compositedBounds(){return this._compositedBounds}get isInShadowTree(){return this._isInShadowTree}get isReflection(){return this._isReflection}get isGeneratedContent(){return this._isGeneratedContent}get isAnonymous(){return this._isAnonymous}get pseudoElementId(){return this._pseudoElementId}get pseudoElement(){return this._pseudoElement}};WI.LayoutInstrument=class extends WI.Instrument{get timelineRecordType(){return WI.TimelineRecord.Type.Layout}};WI.LayoutTimelineRecord=class extends WI.TimelineRecord{constructor(e,t,i,n,s,a){super(WI.TimelineRecord.Type.Layout,t,i,n,s),console.assert(e),console.assert(!a||a instanceof WI.Quad),e in WI.LayoutTimelineRecord.EventType&&(e=WI.LayoutTimelineRecord.EventType[e]),this._eventType=e,this._quad=a||null}static displayNameForEventType(e){switch(e){case WI.LayoutTimelineRecord.EventType.InvalidateStyles:return WI.UIString("Styles Invalidated");case WI.LayoutTimelineRecord.EventType.RecalculateStyles:return WI.UIString("Styles Recalculated");case WI.LayoutTimelineRecord.EventType.InvalidateLayout:return WI.UIString("Layout Invalidated");case WI.LayoutTimelineRecord.EventType.ForcedLayout:return WI.UIString("Forced Layout","Layout phase records that were imperative (forced)");case WI.LayoutTimelineRecord.EventType.Layout:return WI.repeatedUIString.timelineRecordLayout();case WI.LayoutTimelineRecord.EventType.Paint:return WI.repeatedUIString.timelineRecordPaint();case WI.LayoutTimelineRecord.EventType.Composite:return WI.repeatedUIString.timelineRecordComposite()}}static fromJSON(e){let{eventType:t,startTime:i,endTime:n,callFrames:s,sourceCodeLocation:a,quad:d}=e;return d=d?WI.Quad.fromJSON(d):null,new WI.LayoutTimelineRecord(t,i,n,s,a,d)}toJSON(){return{type:this.type,eventType:this._eventType,startTime:this.startTime,endTime:this.endTime,quad:this._quad||void 0}}get eventType(){return this._eventType}get width(){return this._quad?this._quad.width:NaN}get height(){return this._quad?this._quad.height:NaN}get area(){return this.width*this.height}get quad(){return this._quad}saveIdentityToCookie(e){super.saveIdentityToCookie(e),e[WI.LayoutTimelineRecord.EventTypeCookieKey]=this._eventType}};WI.LayoutTimelineRecord.EventType={InvalidateStyles:"invalidate-styles",RecalculateStyles:"recalculate-styles",InvalidateLayout:"invalidate-layout",ForcedLayout:"forced-layout",Layout:"layout",Paint:"paint",Composite:"composite"};WI.LayoutTimelineRecord.TypeIdentifier="layout-timeline-record";WI.LayoutTimelineRecord.EventTypeCookieKey="layout-timeline-record-event-type";WI.LazySourceCodeLocation=class extends WI.SourceCodeLocation{constructor(e,t,i){super(null,t,i),console.assert(e),this._initialized=!1,this._lazySourceCode=e}isEqual(e){return e?this._lazySourceCode===e._sourceCode&&this._lineNumber===e._lineNumber&&this._columnNumber===e._columnNumber:!1}get sourceCode(){return this._lazySourceCode}set sourceCode(e){this.setSourceCode(e)}get formattedLineNumber(){return this._lazyInitialization(),this._formattedLineNumber}get formattedColumnNumber(){return this._lazyInitialization(),this._formattedColumnNumber}formattedPosition(){return this._lazyInitialization(),new WI.SourceCodePosition(this._formattedLineNumber,this._formattedColumnNumber)}hasFormattedLocation(){return this._lazyInitialization(),super.hasFormattedLocation()}hasDifferentDisplayLocation(){return this._lazyInitialization(),super.hasDifferentDisplayLocation()}resolveMappedLocation(){this._lazyInitialization(),super.resolveMappedLocation()}_lazyInitialization(){this._initialized||(this._initialized=!0,this.sourceCode=this._lazySourceCode)}};WI.LineWidget=class{constructor(e,t){console.assert(t instanceof Element),this._codeMirrorLineWidget=e,this._widgetElement=t}get codeMirrorLineWidget(){return this._codeMirrorLineWidget}get widgetElement(){return this._widgetElement}clear(){this._codeMirrorLineWidget.clear()}update(){this._codeMirrorLineWidget.update&&this._codeMirrorLineWidget.update()}};WI.LogObject=class{};WI.LoggingChannel=class{constructor(e,t){console.assert(typeof e=="string"),console.assert(e===WI.ConsoleMessage.MessageSource.Media||e===WI.ConsoleMessage.MessageSource.WebRTC||e===WI.ConsoleMessage.MessageSource.MediaSource),console.assert(typeof t=="string"),console.assert(Object.values(WI.LoggingChannel.Level).includes(t)),this._source=e,this._level=t}static fromPayload(e){return new WI.LoggingChannel(e.source,e.level)}get source(){return this._source}get level(){return this._level}};WI.LoggingChannel.Level={Off:"off",Basic:"basic",Verbose:"verbose"};WI.MediaInstrument=class extends WI.Instrument{constructor(){super(),console.assert(WI.MediaInstrument.supported())}static supported(){return InspectorBackend.domains.DOM&&InspectorBackend.domains.DOM.hasEvent("didFireEvent")}get timelineRecordType(){return WI.TimelineRecord.Type.Media}startInstrumentation(e){}stopInstrumentation(e){}};WI.MediaTimelineRecord=class Pu extends WI.TimelineRecord{constructor(e,t,{domNode:i,domEvent:n,isPowerEfficient:s}={}){console.assert(Object.values(WI.MediaTimelineRecord.EventType).includes(e)),super(WI.TimelineRecord.Type.Media,t,t),this._eventType=e,this._domNode=i||null,this._domEvent=n||null,this._isPowerEfficient=s||!1}static fromJSON(e){let{eventType:t,timestamp:i}=e;return"isLowPower"in e&&!("isPowerEfficient"in e)&&(e.isPowerEfficient=e.isLowPower),new WI.MediaTimelineRecord(t,i,e)}toJSON(){let e=this._domEvent;return e&&e.originator&&(e=Object.shallowCopy(e),e.originator=void 0),{type:this.type,eventType:this._eventType,timestamp:this.startTime,domEvent:e,isPowerEfficient:this._isPowerEfficient}}get eventType(){return this._eventType}get domNode(){return this._domNode}get domEvent(){return this._domEvent}get isPowerEfficient(){return this._isPowerEfficient}get displayName(){if(this._eventType===WI.MediaTimelineRecord.EventType.DOMEvent&&this._domEvent){let e=this._domEvent.eventName;return e==="webkitfullscreenchange"&&this._domEvent.data?this._domEvent.data.enabled?WI.UIString("Entered Full-Screen Mode"):WI.UIString("Exited Full-Screen Mode"):e}return this._eventType===Pu.EventType.PowerEfficientPlaybackStateChanged?this._isPowerEfficient?WI.UIString("Power Efficient Playback Started"):WI.UIString("Power Efficient Playback Stopped"):this._domNode?this._domNode.displayName:(console.error("Unknown media record event type: ",this._eventType,this),WI.UIString("Media Event"))}saveIdentityToCookie(e){super.saveIdentityToCookie(e),e["media-timeline-record-event-type"]=this._eventType,this._eventType===Pu.EventType.PowerEfficientPlaybackStateChanged&&(e["media-timeline-record-power-efficient-playback"]=this._isPowerEfficient),this._domNode&&(e["media-timeline-record-dom-node"]=this._domNode.path()),this._domEvent&&(e["media-timeline-record-dom-event"]=this._domEvent.eventName,this._domEvent.data&&this._domEvent.data.enabled&&(e["media-timeline-record-dom-event-active"]=!0))}};WI.MediaTimelineRecord.EventType={DOMEvent:"dom-event",PowerEfficientPlaybackStateChanged:"power-efficient-playback-state-changed"};WI.MemoryCategory=class{constructor(e,t){console.assert(typeof e=="string"),console.assert(typeof t=="number"),console.assert(t>=0),this.type=e,this.size=t}};WI.MemoryCategory.Type={JavaScript:"javascript",Images:"images",Layers:"layers",Page:"page"};WI.MemoryInstrument=class extends WI.Instrument{constructor(){super(),console.assert(WI.MemoryInstrument.supported())}static supported(){return window.MemoryAgent}get timelineRecordType(){return WI.TimelineRecord.Type.Memory}startInstrumentation(e){e||MemoryAgent.startTracking()}stopInstrumentation(e){e||MemoryAgent.stopTracking()}};WI.MemoryPressureEvent=class{constructor(e,t){this._timestamp=e,this._severity=t}static fromPayload(e,t){let i;switch(t){case MemoryAgent.MemoryPressureSeverity.Critical:i=WI.MemoryPressureEvent.Severity.Critical;break;case MemoryAgent.MemoryPressureSeverity.NonCritical:i=WI.MemoryPressureEvent.Severity.NonCritical;break;default:console.error("Unexpected memory pressure severity",t),i=WI.MemoryPressureEvent.Severity.NonCritical;break}return new WI.MemoryPressureEvent(e,i)}static fromJSON(e){let{timestamp:t,severity:i}=e;return new WI.MemoryPressureEvent(t,i)}toJSON(){return{timestamp:this._timestamp,severity:this._severity}}get timestamp(){return this._timestamp}get severity(){return this._severity}};WI.MemoryPressureEvent.Severity={Critical:"critical",NonCritical:"non-critical"};WI.MemoryTimeline=class extends WI.Timeline{get memoryPressureEvents(){return this._pressureEvents}addMemoryPressureEvent(e){console.assert(e instanceof WI.MemoryPressureEvent),this._pressureEvents.push(e),this.dispatchEventToListeners(WI.MemoryTimeline.Event.MemoryPressureEventAdded,{memoryPressureEvent:e})}reset(e){super.reset(e),this._pressureEvents=[]}addRecord(e,t={}){let i=this.records.lastValue;if(i){let n=i.endTime;t.discontinuity&&(n=t.discontinuity.endTime),e.adjustStartTime(n)}super.addRecord(e,t)}};WI.MemoryTimeline.Event={MemoryPressureEventAdded:"memory-timeline-memory-pressure-event-added"};WI.MemoryTimelineRecord=class mp extends WI.TimelineRecord{constructor(e,t){super(WI.TimelineRecord.Type.Memory,e-mp.samplingRatePerSecond,e),console.assert(typeof e=="number"),console.assert(t instanceof Array),this._timestamp=e,this._categories=WI.MemoryTimelineRecord.memoryCategoriesFromProtocol(t),this._exportCategories=t,this._totalSize=0;for(let{size:i}of t)this._totalSize+=i}static get samplingRatePerSecond(){return .5}static memoryCategoriesFromProtocol(e){let t=0,i=0,n=0,s=0;for(let{type:a,size:d}of e)switch(a){case MemoryAgent.CategoryDataType.JavaScript:case MemoryAgent.CategoryDataType.JIT:t+=d;break;case MemoryAgent.CategoryDataType.Images:i+=d;break;case MemoryAgent.CategoryDataType.Layers:n+=d;break;case MemoryAgent.CategoryDataType.Page:case MemoryAgent.CategoryDataType.Other:s+=d;break;default:console.warn("Unhandled Memory.CategoryDataType: "+a);break}return[{type:WI.MemoryCategory.Type.JavaScript,size:t},{type:WI.MemoryCategory.Type.Images,size:i},{type:WI.MemoryCategory.Type.Layers,size:n},{type:WI.MemoryCategory.Type.Page,size:s}]}static fromJSON(e){let{timestamp:t,categories:i}=e;return new WI.MemoryTimelineRecord(t,i)}toJSON(){return{type:this.type,timestamp:this.startTime,categories:this._exportCategories}}get timestamp(){return this._timestamp}get categories(){return this._categories}get totalSize(){return this._totalSize}adjustStartTime(e){console.assert(e<this._endTime),this._startTime=e}};WI.NativeConstructorFunctionParameters={Object:{assign:"target, ...sources",create:"prototype, [propertiesObject]",defineProperties:"object, properties",defineProperty:"object, propertyName, descriptor",freeze:"object",getOwnPropertyDescriptor:"object, propertyName",getOwnPropertyNames:"object",getOwnPropertySymbols:"object",getPrototypeOf:"object",is:"value1, value2",isExtensible:"object",isFrozen:"object",isSealed:"object",keys:"object",preventExtensions:"object",seal:"object",setPrototypeOf:"object, prototype",__proto__:null},Array:{from:"arrayLike, [mapFunction], [thisArg]",isArray:"object",of:"[...values]",__proto__:null},ArrayBuffer:{isView:"object",transfer:"oldBuffer, [newByteLength=length]",__proto__:null},Number:{isFinite:"value",isInteger:"value",isNaN:"value",isSafeInteger:"value",parseFloat:"string",parseInt:"string, [radix]",__proto__:null},Math:{abs:"x",acos:"x",acosh:"x",asin:"x",asinh:"x",atan2:"y, x",atan:"x",atanh:"x",cbrt:"x",ceil:"x",clz32:"x",cos:"x",cosh:"x",exp:"x",expm1:"x",floor:"x",fround:"x",hypot:"[...x]",imul:"x",log:"x",log1p:"x",log2:"x",log10:"x",max:"[...x]",min:"[...x]",pow:"x, y",round:"x",sign:"x",sin:"x",sinh:"x",sqrt:"x",tan:"x",tanh:"x",trunc:"x",__proto__:null},JSON:{parse:"text, [reviver]",stringify:"value, [replacer], [space]",__proto__:null},Date:{parse:"dateString",UTC:"year, [month], [day], [hour], [minute], [second], [ms]",__proto__:null},Promise:{all:"iterable",race:"iterable",reject:"reason",resolve:"value",__proto__:null},Reflect:{apply:"target, thisArgument, argumentsList",construct:"target, argumentsList, [newTarget=target]",defineProperty:"target, propertyKey, attributes",deleteProperty:"target, propertyKey",get:"target, propertyKey, [receiver]",getOwnPropertyDescriptor:"target, propertyKey",getPrototypeOf:"target",has:"target, propertyKey",isExtensible:"target",ownKeys:"target",preventExtensions:"target",set:"target, propertyKey, value, [receiver]",setPrototypeOf:"target, prototype",__proto__:null},String:{fromCharCode:"...codeUnits",fromCodePoint:"...codePoints",raw:"template, ...substitutions",__proto__:null},Symbol:{for:"key",keyFor:"symbol",__proto__:null},Console:{assert:"condition, [message], [...values]",count:'label = "default"',countReset:'label = "default"',debug:"message, [...values]",dir:"object",dirxml:"object",error:"message, [...values]",group:"[name]",groupCollapsed:"[name]",groupEnd:"[name]",info:"message, [...values]",log:"message, [...values]",profile:"name",profileEnd:"name",record:"object, [options]",recordEnd:"object",screenshot:"[node]",table:"data, [columns]",takeHeapSnapshot:"[label]",time:'label = "default"',timeLog:'label = "default"',timeEnd:'label = "default"',timeStamp:"[label]",trace:"message, [...values]",warn:"message, [...values]",__proto__:null},IDBKeyRangeConstructor:{bound:"lower, upper, [lowerOpen], [upperOpen]",lowerBound:"lower, [open]",only:"value",upperBound:"upper, [open]",__proto__:null},MediaSourceConstructor:{isTypeSupported:"type",__proto__:null},MediaStreamTrackConstructor:{getSources:"callback",__proto__:null},NotificationConstructor:{requestPermission:"[callback]",__proto__:null},URLConstructor:{createObjectURL:"blob",revokeObjectURL:"url",__proto__:null},WebKitMediaKeysConstructor:{isTypeSupported:"keySystem, [type]",__proto__:null}};WI.NativePrototypeFunctionParameters={Object:{__defineGetter__:"propertyName, getterFunction",__defineSetter__:"propertyName, setterFunction",__lookupGetter__:"propertyName",__lookupSetter__:"propertyName",hasOwnProperty:"propertyName",isPrototypeOf:"property",propertyIsEnumerable:"propertyName",__proto__:null},Array:{concat:"value, ...",copyWithin:"targetIndex, startIndex, [endIndex=length]",every:"callback, [thisArg]",fill:"value, [startIndex=0], [endIndex=length]",filter:"callback, [thisArg]",find:"callback, [thisArg]",findIndex:"callback, [thisArg]",forEach:"callback, [thisArg]",includes:"searchValue, [startIndex=0]",indexOf:"searchValue, [startIndex=0]",join:'[separator=","]',lastIndexOf:"searchValue, [startIndex=length]",map:"callback, [thisArg]",push:"value, ...",reduce:"callback, [initialValue]",reduceRight:"callback, [initialValue]",slice:"[startIndex=0], [endIndex=length]",some:"callback, [thisArg]",sort:"[compareFunction]",splice:"startIndex, [deleteCount=0], ...itemsToAdd",__proto__:null},ArrayBuffer:{slice:"startIndex, [endIndex=byteLength]",__proto__:null},DataView:{setInt8:"byteOffset, value",setInt16:"byteOffset, value, [littleEndian=false]",setInt23:"byteOffset, value, [littleEndian=false]",setUint8:"byteOffset, value",setUint16:"byteOffset, value, [littleEndian=false]",setUint32:"byteOffset, value, [littleEndian=false]",setFloat32:"byteOffset, value, [littleEndian=false]",setFloat64:"byteOffset, value, [littleEndian=false]",getInt8:"byteOffset",getInt16:"byteOffset, [littleEndian=false]",getInt23:"byteOffset, [littleEndian=false]",getUint8:"byteOffset",getUint16:"byteOffset, [littleEndian=false]",getUint32:"byteOffset, [littleEndian=false]",getFloat32:"byteOffset, [littleEndian=false]",getFloat64:"byteOffset, [littleEndian=false]",__proto__:null},Date:{setDate:"day",setFullYear:"year, [month=getMonth()], [day=getDate()]",setHours:"hours, [minutes=getMinutes()], [seconds=getSeconds()], [ms=getMilliseconds()]",setMilliseconds:"ms",setMinutes:"minutes, [seconds=getSeconds()], [ms=getMilliseconds()]",setMonth:"month, [day=getDate()]",setSeconds:"seconds, [ms=getMilliseconds()]",setTime:"time",setUTCDate:"day",setUTCFullYear:"year, [month=getUTCMonth()], [day=getUTCDate()]",setUTCHours:"hours, [minutes=getUTCMinutes()], [seconds=getUTCSeconds()], [ms=getUTCMilliseconds()]",setUTCMilliseconds:"ms",setUTCMinutes:"minutes, [seconds=getUTCSeconds()], [ms=getUTCMilliseconds()]",setUTCMonth:"month, [day=getUTCDate()]",setUTCSeconds:"seconds, [ms=getUTCMilliseconds()]",setUTCTime:"time",setYear:"year",__proto__:null},Function:{apply:"thisObject, [argumentsArray]",bind:"thisObject, ...arguments",call:"thisObject, ...arguments",__proto__:null},Map:{delete:"key",forEach:"callback, [thisArg]",get:"key",has:"key",set:"key, value",__proto__:null},Number:{toExponential:"[digits]",toFixed:"[digits]",toPrecision:"[significantDigits]",toString:"[radix=10]",__proto__:null},RegExp:{compile:"pattern, flags",exec:"string",test:"string",__proto__:null},Set:{delete:"value",forEach:"callback, [thisArg]",has:"value",add:"value",__proto__:null},String:{charAt:"index",charCodeAt:"index",codePoints:"index",concat:"string, ...",includes:"searchValue, [startIndex=0]",indexOf:"searchValue, [startIndex=0]",lastIndexOf:"searchValue, [startIndex=length]",localeCompare:"string",match:"regex",repeat:"count",replace:"regex|string, replaceString|replaceHandler, [flags]",search:"regex",slice:"startIndex, [endIndex=length]",split:"[separator], [limit]",substr:"startIndex, [numberOfCharacters]",substring:"startIndex, [endIndex=length]",__proto__:null},WeakMap:{delete:"key",get:"key",has:"key",set:"key, value",__proto__:null},WeakSet:{delete:"value",has:"value",add:"value",__proto__:null},Promise:{catch:"rejectionHandler",then:"resolvedHandler, rejectionHandler",__proto__:null},Generator:{next:"value",return:"value",throw:"exception",__proto__:null},Element:{closest:"selectors",getAttribute:"attributeName",getAttributeNS:"namespace, attributeName",getAttributeNode:"attributeName",getAttributeNodeNS:"namespace, attributeName",hasAttribute:"attributeName",hasAttributeNS:"namespace, attributeName",matches:"selector",removeAttribute:"attributeName",removeAttributeNS:"namespace, attributeName",removeAttributeNode:"attributeName",scrollIntoView:"[alignWithTop]",scrollIntoViewIfNeeded:"[centerIfNeeded]",setAttribute:"name, value",setAttributeNS:"namespace, name, value",setAttributeNode:"attributeNode",setAttributeNodeNS:"namespace, attributeNode",webkitMatchesSelector:"selectors",__proto__:null},Node:{appendChild:"child",cloneNode:"[deep]",compareDocumentPosition:"[node]",contains:"[node]",insertBefore:"insertElement, referenceElement",isDefaultNamespace:"[namespace]",isEqualNode:"[node]",lookupNamespaceURI:"prefix",removeChild:"node",replaceChild:"newChild, oldChild",__proto__:null},Window:{alert:"[message]",atob:"encodedData",btoa:"stringToEncode",cancelAnimationFrame:"id",clearInterval:"intervalId",clearTimeout:"timeoutId",confirm:"[message]",find:"string, [caseSensitive], [backwards], [wrapAround]",getComputedStyle:"[element], [pseudoElement]",getMatchedCSSRules:"[element], [pseudoElement]",matchMedia:"mediaQueryString",moveBy:"[deltaX], [deltaY]",moveTo:"[screenX], [screenY]",open:"url, windowName, [featuresString]",openDatabase:"name, version, displayName, estimatedSize, [creationCallback]",postMessage:"message, targetOrigin, [...transferables]",prompt:"[message], [value]",requestAnimationFrame:"callback",resizeBy:"[deltaX], [deltaY]",resizeTo:"[width], [height]",scrollBy:"[deltaX], [deltaY]",scrollTo:"[x], [y]",setInterval:"func, [delay], [...params]",setTimeout:"func, [delay], [...params]",showModalDialog:"url, [arguments], [options]",__proto__:null},Document:{adoptNode:"[node]",caretRangeFromPoint:"[x], [y]",createAttribute:"attributeName",createAttributeNS:"namespace, qualifiedName",createCDATASection:"data",createComment:"data",createElement:"tagName",createElementNS:"namespace, qualifiedName",createEntityReference:"name",createEvent:"type",createExpression:"xpath, resolver",createNSResolver:"node",createNodeIterator:"root, whatToShow, filter",createProcessingInstruction:"target, data",createTextNode:"data",createTreeWalker:"root, whatToShow, filter, entityReferenceExpansion",elementFromPoint:"x, y",evaluate:"xpath, contextNode, namespaceResolver, resultType, result",execCommand:"command, userInterface, value",getCSSCanvasContext:"contextId, name, width, height",getElementById:"id",getElementsByName:"name",importNode:"node, deep",queryCommandEnabled:"command",queryCommandIndeterm:"command",queryCommandState:"command",queryCommandSupported:"command",queryCommandValue:"command",__proto__:null},ANGLEInstancedArrays:{drawArraysInstancedANGLE:"mode, first, count, primcount",drawElementsInstancedANGLE:"mode, count, type, offset, primcount",vertexAttribDivisorANGLE:"index, divisor",__proto__:null},AnalyserNode:{getByteFrequencyData:"array",getByteTimeDomainData:"array",getFloatFrequencyData:"array",__proto__:null},AudioBuffer:{getChannelData:"channelIndex",__proto__:null},AudioBufferCallback:{handleEvent:"audioBuffer",__proto__:null},AudioBufferSourceNode:{noteGrainOn:"when, grainOffset, grainDuration",noteOff:"when",noteOn:"when",start:"[when], [grainOffset], [grainDuration]",stop:"[when]",__proto__:null},AudioListener:{setOrientation:"x, y, z, xUp, yUp, zUp",setPosition:"x, y, z",setVelocity:"x, y, z",__proto__:null},AudioNode:{connect:"destination, [output], [input]",disconnect:"[output]",__proto__:null},AudioParam:{cancelScheduledValues:"startTime",exponentialRampToValueAtTime:"value, time",linearRampToValueAtTime:"value, time",setTargetAtTime:"target, time, timeConstant",setTargetValueAtTime:"targetValue, time, timeConstant",setValueAtTime:"value, time",setValueCurveAtTime:"values, time, duration",__proto__:null},AudioTrackList:{getTrackById:"id",item:"index",__proto__:null},BiquadFilterNode:{getFrequencyResponse:"frequencyHz, magResponse, phaseResponse",__proto__:null},Blob:{slice:"[start], [end], [contentType]",__proto__:null},CSS:{supports:"property, value",__proto__:null},CSSKeyframesRule:{appendRule:"[rule]",deleteRule:"[key]",findRule:"[key]",insertRule:"[rule]",__proto__:null},CSSMediaRule:{deleteRule:"[index]",insertRule:"[rule], [index]",__proto__:null},CSSPrimitiveValue:{getFloatValue:"[unitType]",setFloatValue:"[unitType], [floatValue]",setStringValue:"[stringType], [stringValue]",__proto__:null},CSSRuleList:{item:"[index]",__proto__:null},CSSStyleDeclaration:{getPropertyCSSValue:"[propertyName]",getPropertyPriority:"[propertyName]",getPropertyShorthand:"[propertyName]",getPropertyValue:"[propertyName]",isPropertyImplicit:"[propertyName]",item:"[index]",removeProperty:"[propertyName]",setProperty:"[propertyName], [value], [priority]",__proto__:null},CSSStyleSheet:{addRule:"[selector], [style], [index]",deleteRule:"[index]",insertRule:"[rule], [index]",removeRule:"[index]",__proto__:null},CSSSupportsRule:{deleteRule:"[index]",insertRule:"[rule], [index]",__proto__:null},CSSValueList:{item:"[index]",__proto__:null},CanvasGradient:{addColorStop:"[offset], [color]",__proto__:null},CanvasRenderingContext2D:{arc:"x, y, radius, startAngle, endAngle, [anticlockwise]",arcTo:"x1, y1, x2, y2, radius",bezierCurveTo:"cp1x, cp1y, cp2x, cp2y, x, y",clearRect:"x, y, width, height",clip:"path, [winding]",createImageData:"imagedata",createLinearGradient:"x0, y0, x1, y1",createPattern:"canvas, repetitionType",createRadialGradient:"x0, y0, r0, x1, y1, r1",drawFocusIfNeeded:"element",drawImage:"image, x, y",drawImageFromRect:"image, [sx], [sy], [sw], [sh], [dx], [dy], [dw], [dh], [compositeOperation]",ellipse:"x, y, radiusX, radiusY, rotation, startAngle, endAngle, [anticlockwise]",fill:"path, [winding]",fillRect:"x, y, width, height",fillText:"text, x, y, [maxWidth]",getImageData:"sx, sy, sw, sh",isPointInPath:"path, x, y, [winding]",isPointInStroke:"path, x, y",lineTo:"x, y",measureText:"text",moveTo:"x, y",putImageData:"imagedata, dx, dy",quadraticCurveTo:"cpx, cpy, x, y",rect:"x, y, width, height",rotate:"angle",scale:"sx, sy",setAlpha:"[alpha]",setCompositeOperation:"[compositeOperation]",setFillColor:"color, [alpha]",setLineCap:"[cap]",setLineDash:"dash",setLineJoin:"[join]",setLineWidth:"[width]",setMiterLimit:"[limit]",setShadow:"width, height, blur, [color], [alpha]",setStrokeColor:"color, [alpha]",setTransform:"m11, m12, m21, m22, dx, dy",stroke:"path",strokeRect:"x, y, width, height",strokeText:"text, x, y, [maxWidth]",transform:"m11, m12, m21, m22, dx, dy",translate:"tx, ty",__proto__:null},CharacterData:{appendData:"[data]",deleteData:"[offset], [length]",insertData:"[offset], [data]",replaceData:"[offset], [length], [data]",substringData:"[offset], [length]",__proto__:null},CommandLineAPIHost:{copyText:"text",databaseId:"database",getEventListeners:"target",inspect:"objectId, hints",storageId:"storage",__proto__:null},CompositionEvent:{initCompositionEvent:"[typeArg], [canBubbleArg], [cancelableArg], [viewArg], [dataArg]",__proto__:null},Crypto:{getRandomValues:"array",__proto__:null},CustomElementRegistry:{define:"name, constructor",get:"name",whenDefined:"name",__proto__:null},CustomEvent:{initCustomEvent:"type, [bubbles], [cancelable], [detail]",__proto__:null},DOMApplicationCache:{__proto__:null},DOMImplementation:{createCSSStyleSheet:"[title], [media]",createDocument:"[namespaceURI], [qualifiedName], [doctype]",createDocumentType:"[qualifiedName], [publicId], [systemId]",createHTMLDocument:"[title]",hasFeature:"[feature], [version]",__proto__:null},DOMParser:{parseFromString:"[str], [contentType]",__proto__:null},DOMStringList:{contains:"[string]",item:"[index]",__proto__:null},DOMTokenList:{add:"tokens...",contains:"token",item:"index",remove:"tokens...",toggle:"token, [force]",__proto__:null},DataTransfer:{clearData:"[type]",getData:"type",setData:"type, data",setDragImage:"image, x, y",__proto__:null},DataTransferItem:{getAsString:"[callback]",__proto__:null},DataTransferItemList:{add:"file",item:"[index]",__proto__:null},Database:{changeVersion:"oldVersion, newVersion, [callback], [errorCallback], [successCallback]",readTransaction:"callback, [errorCallback], [successCallback]",transaction:"callback, [errorCallback], [successCallback]",__proto__:null},DatabaseCallback:{handleEvent:"database",__proto__:null},DedicatedWorkerGlobalScope:{postMessage:"message, [messagePorts]",__proto__:null},DeviceMotionEvent:{initDeviceMotionEvent:"[type], [bubbles], [cancelable], [acceleration], [accelerationIncludingGravity], [rotationRate], [interval]",__proto__:null},DeviceOrientationEvent:{initDeviceOrientationEvent:"[type], [bubbles], [cancelable], [alpha], [beta], [gamma], [absolute]",__proto__:null},DocumentFragment:{getElementById:"id",querySelector:"selectors",querySelectorAll:"selectors",__proto__:null},Event:{initEvent:"type, [bubbles], [cancelable]",__proto__:null},FileList:{item:"index",__proto__:null},FileReader:{readAsArrayBuffer:"blob",readAsBinaryString:"blob",readAsDataURL:"blob",readAsText:"blob, [encoding]",__proto__:null},FileReaderSync:{readAsArrayBuffer:"blob",readAsBinaryString:"blob",readAsDataURL:"blob",readAsText:"blob, [encoding]",__proto__:null},FontFaceSet:{add:"font",check:'font, [text=" "]',delete:"font",load:'font, [text=" "]',__proto__:null},FormData:{append:"[name], [value], [filename]",__proto__:null},Geolocation:{clearWatch:"watchID",getCurrentPosition:"successCallback, [errorCallback], [options]",watchPosition:"successCallback, [errorCallback], [options]",__proto__:null},HTMLAllCollection:{item:"[index]",namedItem:"name",tags:"name",__proto__:null},HTMLButtonElement:{setCustomValidity:"error",__proto__:null},HTMLCanvasElement:{getContext:"contextId",toDataURL:"[type]",__proto__:null},HTMLCollection:{item:"[index]",namedItem:"[name]",__proto__:null},HTMLDocument:{write:"[html]",writeln:"[html]",__proto__:null},HTMLElement:{insertAdjacentElement:"[position], [element]",insertAdjacentHTML:"[position], [html]",insertAdjacentText:"[position], [text]",__proto__:null},HTMLFieldSetElement:{setCustomValidity:"error",__proto__:null},HTMLFormControlsCollection:{namedItem:"[name]",__proto__:null},HTMLInputElement:{setCustomValidity:"error",setRangeText:"replacement",setSelectionRange:"start, end, [direction]",stepDown:"[n]",stepUp:"[n]",__proto__:null},HTMLKeygenElement:{setCustomValidity:"error",__proto__:null},HTMLMediaElement:{addTextTrack:"kind, [label], [language]",canPlayType:"[type], [keySystem]",fastSeek:"time",webkitAddKey:"keySystem, key, [initData], [sessionId]",webkitCancelKeyRequest:"keySystem, [sessionId]",webkitGenerateKeyRequest:"keySystem, [initData]",webkitSetMediaKeys:"mediaKeys",__proto__:null},HTMLObjectElement:{setCustomValidity:"error",__proto__:null},HTMLOptionsCollection:{add:"element, [before]",namedItem:"[name]",remove:"[index]",__proto__:null},HTMLOutputElement:{setCustomValidity:"error",__proto__:null},HTMLSelectElement:{add:"element, [before]",item:"index",namedItem:"[name]",setCustomValidity:"error",__proto__:null},HTMLSlotElement:{assignedNodes:"[options]",__proto__:null},HTMLTableElement:{deleteRow:"index",insertRow:"[index]",__proto__:null},HTMLTableRowElement:{deleteCell:"index",insertCell:"[index]",__proto__:null},HTMLTableSectionElement:{deleteRow:"index",insertRow:"[index]",__proto__:null},HTMLTextAreaElement:{setCustomValidity:"error",setRangeText:"replacement",setSelectionRange:"[start], [end], [direction]",__proto__:null},HTMLVideoElement:{webkitSetPresentationMode:"mode",webkitSupportsPresentationMode:"mode",__proto__:null},HashChangeEvent:{initHashChangeEvent:"[type], [canBubble], [cancelable], [oldURL], [newURL]",__proto__:null},History:{go:"[distance]",pushState:"data, title, [url]",replaceState:"data, title, [url]",__proto__:null},IDBCursor:{advance:"count",continue:"[key]",update:"value",__proto__:null},IDBDatabase:{createObjectStore:"name, [options]",deleteObjectStore:"name",transaction:"storeName, [mode]",__proto__:null},IDBFactory:{cmp:"first, second",deleteDatabase:"name",open:"name, [version]",__proto__:null},IDBIndex:{count:"[range]",get:"key",getKey:"key",openCursor:"[range], [direction]",openKeyCursor:"[range], [direction]",__proto__:null},IDBObjectStore:{add:"value, [key]",count:"[range]",createIndex:"name, keyPath, [options]",delete:"keyRange",deleteIndex:"name",get:"key",index:"name",openCursor:"[range], [direction]",put:"value, [key]",__proto__:null},IDBTransaction:{objectStore:"name",__proto__:null},ImageBitmapRenderingContext:{transferFromImageBitmap:"[bitmap]",__proto__:null},KeyboardEvent:{initKeyboardEvent:"[type], [canBubble], [cancelable], [view], [keyIdentifier], [location], [ctrlKey], [altKey], [shiftKey], [metaKey], [altGraphKey]",__proto__:null},Location:{assign:"[url]",reload:"[force=false]",replace:"[url]",__proto__:null},MediaController:{__proto__:null},MediaControlsHost:{displayNameForTrack:"track",mediaUIImageData:"partID",setSelectedTextTrack:"track",sortedTrackListForMenu:"trackList",__proto__:null},MediaList:{appendMedium:"[newMedium]",deleteMedium:"[oldMedium]",item:"[index]",__proto__:null},MediaQueryList:{addListener:"[listener]",removeListener:"[listener]",__proto__:null},MediaQueryListListener:{queryChanged:"[list]",__proto__:null},MediaSource:{addSourceBuffer:"type",endOfStream:"[error]",removeSourceBuffer:"buffer",__proto__:null},MediaStreamTrack:{applyConstraints:"constraints",__proto__:null},MediaStreamTrackSourcesCallback:{handleEvent:"sources",__proto__:null},MessageEvent:{initMessageEvent:"type, [bubbles], [cancelable], [data], [origin], [lastEventId], [source], [messagePorts]",__proto__:null},MessagePort:{__proto__:null},MimeTypeArray:{item:"[index]",namedItem:"[name]",__proto__:null},MouseEvent:{initMouseEvent:"[type], [canBubble], [cancelable], [view], [detail], [screenX], [screenY], [clientX], [clientY], [ctrlKey], [altKey], [shiftKey], [metaKey], [button], [relatedTarget]",__proto__:null},MutationEvent:{initMutationEvent:"[type], [canBubble], [cancelable], [relatedNode], [prevValue], [newValue], [attrName], [attrChange]",__proto__:null},MutationObserver:{observe:"target, options",__proto__:null},NamedNodeMap:{getNamedItem:"[name]",getNamedItemNS:"[namespaceURI], [localName]",item:"[index]",removeNamedItem:"[name]",removeNamedItemNS:"[namespaceURI], [localName]",setNamedItem:"[node]",setNamedItemNS:"[node]",__proto__:null},Navigator:{getUserMedia:"options, successCallback, errorCallback",__proto__:null},NavigatorUserMediaErrorCallback:{handleEvent:"error",__proto__:null},NavigatorUserMediaSuccessCallback:{handleEvent:"stream",__proto__:null},NodeFilter:{acceptNode:"[n]",__proto__:null},NodeList:{item:"index",__proto__:null},Notification:{__proto__:null},NotificationCenter:{createNotification:"iconUrl, title, body",requestPermission:"[callback]",__proto__:null},NotificationPermissionCallback:{handleEvent:"permission",__proto__:null},OESVertexArrayObject:{bindVertexArrayOES:"[arrayObject]",deleteVertexArrayOES:"[arrayObject]",isVertexArrayOES:"[arrayObject]",__proto__:null},OscillatorNode:{noteOff:"when",noteOn:"when",setPeriodicWave:"wave",start:"[when]",stop:"[when]",__proto__:null},Path2D:{addPath:"path, [transform]",arc:"[x], [y], [radius], [startAngle], [endAngle], [anticlockwise]",arcTo:"[x1], [y1], [x2], [y2], [radius]",bezierCurveTo:"[cp1x], [cp1y], [cp2x], [cp2y], [x], [y]",ellipse:"x, y, radiusX, radiusY, rotation, startAngle, endAngle, [anticlockwise]",lineTo:"[x], [y]",moveTo:"[x], [y]",quadraticCurveTo:"[cpx], [cpy], [x], [y]",rect:"[x], [y], [width], [height]",__proto__:null},Performance:{clearMarks:"[name]",clearMeasures:"name",getEntriesByName:"name, [type]",getEntriesByType:"type",mark:"name",measure:"name, [startMark], [endMark]",__proto__:null},PerformanceObserver:{observe:"options",__proto__:null},PerformanceObserverEntryList:{getEntriesByName:"name, [type]",getEntriesByType:"type",__proto__:null},Plugin:{item:"[index]",namedItem:"[name]",__proto__:null},PluginArray:{item:"[index]",namedItem:"[name]",refresh:"[reload]",__proto__:null},PositionCallback:{handleEvent:"position",__proto__:null},PositionErrorCallback:{handleEvent:"error",__proto__:null},QuickTimePluginReplacement:{postEvent:"eventName",__proto__:null},RTCDTMFSender:{insertDTMF:"tones, [duration], [interToneGap]",__proto__:null},RTCDataChannel:{send:"data",__proto__:null},RTCPeerConnectionErrorCallback:{handleEvent:"error",__proto__:null},RTCSessionDescriptionCallback:{handleEvent:"sdp",__proto__:null},RTCStatsCallback:{handleEvent:"response",__proto__:null},RTCStatsReport:{stat:"name",__proto__:null},RTCStatsResponse:{namedItem:"[name]",__proto__:null},Range:{collapse:"[toStart]",compareBoundaryPoints:"[how], [sourceRange]",compareNode:"[refNode]",comparePoint:"[refNode], [offset]",createContextualFragment:"[html]",expand:"[unit]",insertNode:"[newNode]",intersectsNode:"[refNode]",isPointInRange:"[refNode], [offset]",selectNode:"[refNode]",selectNodeContents:"[refNode]",setEnd:"[refNode], [offset]",setEndAfter:"[refNode]",setEndBefore:"[refNode]",setStart:"[refNode], [offset]",setStartAfter:"[refNode]",setStartBefore:"[refNode]",surroundContents:"[newParent]",__proto__:null},ReadableStream:{cancel:"reason",pipeThrough:"dest, options",pipeTo:"streams, options",__proto__:null},WritableStream:{abort:"reason",close:"",write:"chunk",__proto__:null},RequestAnimationFrameCallback:{handleEvent:"highResTime",__proto__:null},SQLResultSetRowList:{item:"index",__proto__:null},SQLStatementCallback:{handleEvent:"transaction, resultSet",__proto__:null},SQLStatementErrorCallback:{handleEvent:"transaction, error",__proto__:null},SQLTransaction:{executeSql:"sqlStatement, arguments, [callback], [errorCallback]",__proto__:null},SQLTransactionCallback:{handleEvent:"transaction",__proto__:null},SQLTransactionErrorCallback:{handleEvent:"error",__proto__:null},SVGAngle:{convertToSpecifiedUnits:"unitType",newValueSpecifiedUnits:"unitType, valueInSpecifiedUnits",__proto__:null},SVGAnimationElement:{beginElementAt:"[offset]",endElementAt:"[offset]",hasExtension:"[extension]",__proto__:null},SVGColor:{setColor:"colorType, rgbColor, iccColor",setRGBColor:"rgbColor",setRGBColorICCColor:"rgbColor, iccColor",__proto__:null},SVGCursorElement:{hasExtension:"[extension]",__proto__:null},SVGDocument:{createEvent:"[eventType]",__proto__:null},SVGElement:{getPresentationAttribute:"[name]",__proto__:null},SVGFEDropShadowElement:{setStdDeviation:"[stdDeviationX], [stdDeviationY]",__proto__:null},SVGFEGaussianBlurElement:{setStdDeviation:"[stdDeviationX], [stdDeviationY]",__proto__:null},SVGFEMorphologyElement:{setRadius:"[radiusX], [radiusY]",__proto__:null},SVGFilterElement:{setFilterRes:"[filterResX], [filterResY]",__proto__:null},SVGGraphicsElement:{getTransformToElement:"[element]",hasExtension:"[extension]",__proto__:null},SVGLength:{convertToSpecifiedUnits:"unitType",newValueSpecifiedUnits:"unitType, valueInSpecifiedUnits",__proto__:null},SVGLengthList:{appendItem:"item",getItem:"index",initialize:"item",insertItemBefore:"item, index",removeItem:"index",replaceItem:"item, index",__proto__:null},SVGMarkerElement:{setOrientToAngle:"[angle]",__proto__:null},SVGMaskElement:{hasExtension:"[extension]",__proto__:null},SVGMatrix:{multiply:"secondMatrix",rotate:"angle",rotateFromVector:"x, y",scale:"scaleFactor",scaleNonUniform:"scaleFactorX, scaleFactorY",skewX:"angle",skewY:"angle",translate:"x, y",__proto__:null},SVGNumberList:{appendItem:"item",getItem:"index",initialize:"item",insertItemBefore:"item, index",removeItem:"index",replaceItem:"item, index",__proto__:null},SVGPaint:{setPaint:"paintType, uri, rgbColor, iccColor",setUri:"uri",__proto__:null},SVGPathElement:{createSVGPathSegArcAbs:"[x], [y], [r1], [r2], [angle], [largeArcFlag], [sweepFlag]",createSVGPathSegArcRel:"[x], [y], [r1], [r2], [angle], [largeArcFlag], [sweepFlag]",createSVGPathSegCurvetoCubicAbs:"[x], [y], [x1], [y1], [x2], [y2]",createSVGPathSegCurvetoCubicRel:"[x], [y], [x1], [y1], [x2], [y2]",createSVGPathSegCurvetoCubicSmoothAbs:"[x], [y], [x2], [y2]",createSVGPathSegCurvetoCubicSmoothRel:"[x], [y], [x2], [y2]",createSVGPathSegCurvetoQuadraticAbs:"[x], [y], [x1], [y1]",createSVGPathSegCurvetoQuadraticRel:"[x], [y], [x1], [y1]",createSVGPathSegCurvetoQuadraticSmoothAbs:"[x], [y]",createSVGPathSegCurvetoQuadraticSmoothRel:"[x], [y]",createSVGPathSegLinetoAbs:"[x], [y]",createSVGPathSegLinetoHorizontalAbs:"[x]",createSVGPathSegLinetoHorizontalRel:"[x]",createSVGPathSegLinetoRel:"[x], [y]",createSVGPathSegLinetoVerticalAbs:"[y]",createSVGPathSegLinetoVerticalRel:"[y]",createSVGPathSegMovetoAbs:"[x], [y]",createSVGPathSegMovetoRel:"[x], [y]",getPathSegAtLength:"[distance]",getPointAtLength:"[distance]",__proto__:null},SVGPathSegList:{appendItem:"newItem",getItem:"index",initialize:"newItem",insertItemBefore:"newItem, index",removeItem:"index",replaceItem:"newItem, index",__proto__:null},SVGPatternElement:{hasExtension:"[extension]",__proto__:null},SVGPoint:{matrixTransform:"matrix",__proto__:null},SVGPointList:{appendItem:"item",getItem:"index",initialize:"item",insertItemBefore:"item, index",removeItem:"index",replaceItem:"item, index",__proto__:null},SVGSVGElement:{checkEnclosure:"[element], [rect]",checkIntersection:"[element], [rect]",createSVGTransformFromMatrix:"[matrix]",getElementById:"[elementId]",getEnclosureList:"[rect], [referenceElement]",getIntersectionList:"[rect], [referenceElement]",setCurrentTime:"[seconds]",suspendRedraw:"[maxWaitMilliseconds]",unsuspendRedraw:"[suspendHandleId]",__proto__:null},SVGStringList:{appendItem:"item",getItem:"index",initialize:"item",insertItemBefore:"item, index",removeItem:"index",replaceItem:"item, index",__proto__:null},SVGTextContentElement:{getCharNumAtPosition:"[point]",getEndPositionOfChar:"[offset]",getExtentOfChar:"[offset]",getRotationOfChar:"[offset]",getStartPositionOfChar:"[offset]",getSubStringLength:"[offset], [length]",selectSubString:"[offset], [length]",__proto__:null},SVGTransform:{setMatrix:"matrix",setRotate:"angle, cx, cy",setScale:"sx, sy",setSkewX:"angle",setSkewY:"angle",setTranslate:"tx, ty",__proto__:null},SVGTransformList:{appendItem:"item",createSVGTransformFromMatrix:"matrix",getItem:"index",initialize:"item",insertItemBefore:"item, index",removeItem:"index",replaceItem:"item, index",__proto__:null},SecurityPolicy:{allowsConnectionTo:"url",allowsFontFrom:"url",allowsFormAction:"url",allowsFrameFrom:"url",allowsImageFrom:"url",allowsMediaFrom:"url",allowsObjectFrom:"url",allowsPluginType:"type",allowsScriptFrom:"url",allowsStyleFrom:"url",__proto__:null},Selection:{addRange:"[range]",collapse:"[node], [index]",containsNode:"[node], [allowPartial]",extend:"[node], [offset]",getRangeAt:"[index]",modify:"[alter], [direction], [granularity]",selectAllChildren:"[node]",setBaseAndExtent:"[baseNode], [baseOffset], [extentNode], [extentOffset]",setPosition:"[node], [offset]",__proto__:null},SourceBuffer:{appendBuffer:"data",remove:"start, end",__proto__:null},SourceBufferList:{item:"index",__proto__:null},SpeechSynthesis:{speak:"utterance",__proto__:null},SpeechSynthesisUtterance:{__proto__:null},Storage:{getItem:"key",key:"index",removeItem:"key",setItem:"key, data",__proto__:null},StorageErrorCallback:{handleEvent:"error",__proto__:null},StorageEvent:{initStorageEvent:"[typeArg], [canBubbleArg], [cancelableArg], [keyArg], [oldValueArg], [newValueArg], [urlArg], [storageAreaArg]",__proto__:null},StorageInfo:{queryUsageAndQuota:"storageType, [usageCallback], [errorCallback]",requestQuota:"storageType, newQuotaInBytes, [quotaCallback], [errorCallback]",__proto__:null},StorageQuota:{queryUsageAndQuota:"usageCallback, [errorCallback]",requestQuota:"newQuotaInBytes, [quotaCallback], [errorCallback]",__proto__:null},StorageQuotaCallback:{handleEvent:"grantedQuotaInBytes",__proto__:null},StorageUsageCallback:{handleEvent:"currentUsageInBytes, currentQuotaInBytes",__proto__:null},StringCallback:{handleEvent:"data",__proto__:null},StyleMedia:{matchMedium:"[mediaquery]",__proto__:null},StyleSheetList:{item:"[index]",__proto__:null},Text:{replaceWholeText:"[content]",splitText:"offset",__proto__:null},TextEvent:{initTextEvent:"[typeArg], [canBubbleArg], [cancelableArg], [viewArg], [dataArg]",__proto__:null},TextTrack:{addCue:"cue",addRegion:"region",removeCue:"cue",removeRegion:"region",__proto__:null},TextTrackCue:{__proto__:null},TextTrackCueList:{getCueById:"id",item:"index",__proto__:null},TextTrackList:{getTrackById:"id",item:"index",__proto__:null},TimeRanges:{end:"index",start:"index",__proto__:null},TouchEvent:{initTouchEvent:"[touches], [targetTouches], [changedTouches], [type], [view], [screenX], [screenY], [clientX], [clientY], [ctrlKey], [altKey], [shiftKey], [metaKey]",__proto__:null},TouchList:{item:"index",__proto__:null},UIEvent:{initUIEvent:"[type], [canBubble], [cancelable], [view], [detail]",__proto__:null},UserMessageHandler:{postMessage:"message",__proto__:null},VTTRegionList:{getRegionById:"id",item:"index",__proto__:null},VideoTrackList:{getTrackById:"id",item:"index",__proto__:null},WebGL2RenderingContext:{beginQuery:"target, query",beginTransformFeedback:"primitiveMode",bindBufferBase:"target, index, buffer",bindBufferRange:"target, index, buffer, offset, size",bindSampler:"unit, sampler",bindTransformFeedback:"target, id",bindVertexArray:"vertexArray",blitFramebuffer:"srcX0, srcY0, srcX1, srcY1, dstX0, dstY0, dstX1, dstY1, mask, filter",clearBufferfi:"buffer, drawbuffer, depth, stencil",clearBufferfv:"buffer, drawbuffer, value",clearBufferiv:"buffer, drawbuffer, value",clearBufferuiv:"buffer, drawbuffer, value",clientWaitSync:"sync, flags, timeout",compressedTexImage3D:"target, level, internalformat, width, height, depth, border, imageSize, data",compressedTexSubImage3D:"target, level, xoffset, yoffset, zoffset, width, height, depth, format, imageSize, data",copyBufferSubData:"readTarget, writeTarget, readOffset, writeOffset, size",copyTexSubImage3D:"target, level, xoffset, yoffset, zoffset, x, y, width, height",deleteQuery:"query",deleteSampler:"sampler",deleteSync:"sync",deleteTransformFeedback:"id",deleteVertexArray:"vertexArray",drawArraysInstanced:"mode, first, count, instanceCount",drawBuffers:"buffers",drawElementsInstanced:"mode, count, type, offset, instanceCount",drawRangeElements:"mode, start, end, count, type, offset",endQuery:"target",fenceSync:"condition, flags",framebufferTextureLayer:"target, attachment, texture, level, layer",getActiveUniformBlockName:"program, uniformBlockIndex",getActiveUniformBlockParameter:"program, uniformBlockIndex, pname",getActiveUniforms:"program, uniformIndices, pname",getBufferSubData:"target, offset, returnedData",getFragDataLocation:"program, name",getIndexedParameter:"target, index",getInternalformatParameter:"target, internalformat, pname",getQuery:"target, pname",getQueryParameter:"query, pname",getSamplerParameter:"sampler, pname",getSyncParameter:"sync, pname",getTransformFeedbackVarying:"program, index",getUniformBlockIndex:"program, uniformBlockName",getUniformIndices:"program, uniformNames",invalidateFramebuffer:"target, attachments",invalidateSubFramebuffer:"target, attachments, x, y, width, height",isQuery:"query",isSampler:"sampler",isSync:"sync",isTransformFeedback:"id",isVertexArray:"vertexArray",readBuffer:"src",renderbufferStorageMultisample:"target, samples, internalformat, width, height",samplerParameterf:"sampler, pname, param",samplerParameteri:"sampler, pname, param",texImage3D:"target, level, internalformat, width, height, depth, border, format, type, pixels",texStorage2D:"target, levels, internalformat, width, height",texStorage3D:"target, levels, internalformat, width, height, depth",texSubImage3D:"target, level, xoffset, yoffset, zoffset, width, height, depth, format, type, pixels",transformFeedbackVaryings:"program, varyings, bufferMode",uniform1ui:"location, v0",uniform1uiv:"location, value",uniform2ui:"location, v0, v1",uniform2uiv:"location, value",uniform3ui:"location, v0, v1, v2",uniform3uiv:"location, value",uniform4ui:"location, v0, v1, v2, v3",uniform4uiv:"location, value",uniformBlockBinding:"program, uniformBlockIndex, uniformBlockBinding",uniformMatrix2x3fv:"location, transpose, value",uniformMatrix2x4fv:"location, transpose, value",uniformMatrix3x2fv:"location, transpose, value",uniformMatrix3x4fv:"location, transpose, value",uniformMatrix4x2fv:"location, transpose, value",uniformMatrix4x3fv:"location, transpose, value",vertexAttribDivisor:"index, divisor",vertexAttribI4i:"index, x, y, z, w",vertexAttribI4iv:"index, v",vertexAttribI4ui:"index, x, y, z, w",vertexAttribI4uiv:"index, v",vertexAttribIPointer:"index, size, type, stride, offset",waitSync:"sync, flags, timeout",__proto__:null},WebGLDebugShaders:{getTranslatedShaderSource:"shader",__proto__:null},WebGLDrawBuffers:{drawBuffersWEBGL:"buffers",__proto__:null},WebGLRenderingContextBase:{activeTexture:"texture",attachShader:"program, shader",bindAttribLocation:"program, index, name",bindBuffer:"target, buffer",bindFramebuffer:"target, framebuffer",bindRenderbuffer:"target, renderbuffer",bindTexture:"target, texture",blendColor:"red, green, blue, alpha",blendEquation:"mode",blendEquationSeparate:"modeRGB, modeAlpha",blendFunc:"sfactor, dfactor",blendFuncSeparate:"srcRGB, dstRGB, srcAlpha, dstAlpha",bufferData:"target, data, usage",bufferSubData:"target, offset, data",checkFramebufferStatus:"target",clear:"mask",clearColor:"red, green, blue, alpha",clearDepth:"depth",clearStencil:"s",colorMask:"red, green, blue, alpha",compileShader:"shader",compressedTexImage2D:"target, level, internalformat, width, height, border, data",compressedTexSubImage2D:"target, level, xoffset, yoffset, width, height, format, data",copyTexImage2D:"target, level, internalformat, x, y, width, height, border",copyTexSubImage2D:"target, level, xoffset, yoffset, x, y, width, height",createShader:"type",cullFace:"mode",deleteBuffer:"buffer",deleteFramebuffer:"framebuffer",deleteProgram:"program",deleteRenderbuffer:"renderbuffer",deleteShader:"shader",deleteTexture:"texture",depthFunc:"func",depthMask:"flag",depthRange:"zNear, zFar",detachShader:"program, shader",disable:"cap",disableVertexAttribArray:"index",drawArrays:"mode, first, count",drawElements:"mode, count, type, offset",enable:"cap",enableVertexAttribArray:"index",framebufferRenderbuffer:"target, attachment, renderbuffertarget, renderbuffer",framebufferTexture2D:"target, attachment, textarget, texture, level",frontFace:"mode",generateMipmap:"target",getActiveAttrib:"program, index",getActiveUniform:"program, index",getAttachedShaders:"program",getAttribLocation:"program, name",getBufferParameter:"target, pname",getExtension:"name",getFramebufferAttachmentParameter:"target, attachment, pname",getParameter:"pname",getProgramInfoLog:"program",getProgramParameter:"program, pname",getRenderbufferParameter:"target, pname",getShaderInfoLog:"shader",getShaderParameter:"shader, pname",getShaderPrecisionFormat:"shadertype, precisiontype",getShaderSource:"shader",getTexParameter:"target, pname",getUniform:"program, location",getUniformLocation:"program, name",getVertexAttrib:"index, pname",getVertexAttribOffset:"index, pname",hint:"target, mode",isBuffer:"buffer",isEnabled:"cap",isFramebuffer:"framebuffer",isProgram:"program",isRenderbuffer:"renderbuffer",isShader:"shader",isTexture:"texture",lineWidth:"width",linkProgram:"program",pixelStorei:"pname, param",polygonOffset:"factor, units",readPixels:"x, y, width, height, format, type, pixels",renderbufferStorage:"target, internalformat, width, height",sampleCoverage:"value, invert",scissor:"x, y, width, height",shaderSource:"shader, string",stencilFunc:"func, ref, mask",stencilFuncSeparate:"face, func, ref, mask",stencilMask:"mask",stencilMaskSeparate:"face, mask",stencilOp:"fail, zfail, zpass",stencilOpSeparate:"face, fail, zfail, zpass",texImage2D:"target, level, internalformat, width, height, border, format, type, pixels",texParameterf:"target, pname, param",texParameteri:"target, pname, param",texSubImage2D:"target, level, xoffset, yoffset, width, height, format, type, pixels",uniform1f:"location, x",uniform1fv:"location, v",uniform1i:"location, x",uniform1iv:"location, v",uniform2f:"location, x, y",uniform2fv:"location, v",uniform2i:"location, x, y",uniform2iv:"location, v",uniform3f:"location, x, y, z",uniform3fv:"location, v",uniform3i:"location, x, y, z",uniform3iv:"location, v",uniform4f:"location, x, y, z, w",uniform4fv:"location, v",uniform4i:"location, x, y, z, w",uniform4iv:"location, v",uniformMatrix2fv:"location, transpose, array",uniformMatrix3fv:"location, transpose, array",uniformMatrix4fv:"location, transpose, array",useProgram:"program",validateProgram:"program",vertexAttrib1f:"indx, x",vertexAttrib1fv:"indx, values",vertexAttrib2f:"indx, x, y",vertexAttrib2fv:"indx, values",vertexAttrib3f:"indx, x, y, z",vertexAttrib3fv:"indx, values",vertexAttrib4f:"indx, x, y, z, w",vertexAttrib4fv:"indx, values",vertexAttribPointer:"indx, size, type, normalized, stride, offset",viewport:"x, y, width, height",__proto__:null},WebKitCSSMatrix:{multiply:"[secondMatrix]",rotate:"[rotX], [rotY], [rotZ]",rotateAxisAngle:"[x], [y], [z], [angle]",scale:"[scaleX], [scaleY], [scaleZ]",setMatrixValue:"[string]",skewX:"[angle]",skewY:"[angle]",translate:"[x], [y], [z]",__proto__:null},WebKitMediaKeySession:{update:"key",__proto__:null},WebKitMediaKeys:{createSession:"[type], [initData]",__proto__:null},WebKitNamedFlow:{getRegionsByContent:"contentNode",__proto__:null},WebKitNamedFlowCollection:{item:"index",namedItem:"name",__proto__:null},WebKitSubtleCrypto:{decrypt:"algorithm, key, data",digest:"algorithm, data",encrypt:"algorithm, key, data",exportKey:"format, key",generateKey:"algorithm, [extractable], [keyUsages]",importKey:"format, keyData, algorithm, [extractable], [keyUsages]",sign:"algorithm, key, data",unwrapKey:"format, wrappedKey, unwrappingKey, unwrapAlgorithm, unwrappedKeyAlgorithm, [extractable], [keyUsages]",verify:"algorithm, key, signature, data",wrapKey:"format, key, wrappingKey, wrapAlgorithm",__proto__:null},WebSocket:{close:"[code], [reason]",send:"data",__proto__:null},WheelEvent:{initWebKitWheelEvent:"[wheelDeltaX], [wheelDeltaY], [view], [screenX], [screenY], [clientX], [clientY], [ctrlKey], [altKey], [shiftKey], [metaKey]",__proto__:null},Worker:{postMessage:"message, [messagePorts]",__proto__:null},WorkerGlobalScope:{clearInterval:"[handle]",clearTimeout:"[handle]",setInterval:"handler, [timeout]",setTimeout:"handler, [timeout]",__proto__:null},XMLHttpRequest:{getResponseHeader:"header",open:"method, url, [async], [user], [password]",overrideMimeType:"override",setRequestHeader:"header, value",__proto__:null},XMLHttpRequestUpload:{__proto__:null},XMLSerializer:{serializeToString:"[node]",__proto__:null},XPathEvaluator:{createExpression:"[expression], [resolver]",createNSResolver:"[nodeResolver]",evaluate:"[expression], [contextNode], [resolver], [type], [inResult]",__proto__:null},XPathExpression:{evaluate:"[contextNode], [type], [inResult]",__proto__:null},XPathNSResolver:{lookupNamespaceURI:"[prefix]",__proto__:null},XPathResult:{snapshotItem:"[index]",__proto__:null},XSLTProcessor:{getParameter:"namespaceURI, localName",importStylesheet:"[stylesheet]",removeParameter:"namespaceURI, localName",setParameter:"namespaceURI, localName, value",transformToDocument:"[source]",transformToFragment:"[source], [docVal]",__proto__:null},webkitAudioContext:{createBuffer:"numberOfChannels, numberOfFrames, sampleRate",createChannelMerger:"[numberOfInputs]",createChannelSplitter:"[numberOfOutputs]",createDelay:"[maxDelayTime]",createDelayNode:"[maxDelayTime]",createJavaScriptNode:"bufferSize, [numberOfInputChannels], [numberOfOutputChannels]",createMediaElementSource:"mediaElement",createPeriodicWave:"real, imag",createScriptProcessor:"bufferSize, [numberOfInputChannels], [numberOfOutputChannels]",decodeAudioData:"audioData, successCallback, [errorCallback]",__proto__:null},webkitAudioPannerNode:{setOrientation:"x, y, z",setPosition:"x, y, z",setVelocity:"x, y, z",__proto__:null},webkitMediaStream:{addTrack:"track",getTrackById:"trackId",removeTrack:"track",__proto__:null},webkitRTCPeerConnection:{addIceCandidate:"candidate, successCallback, failureCallback",addStream:"stream",createAnswer:"successCallback, failureCallback, [answerOptions]",createDTMFSender:"track",createDataChannel:"label, [options]",createOffer:"successCallback, failureCallback, [offerOptions]",getStats:"successCallback, failureCallback, [selector]",getStreamById:"streamId",removeStream:"stream",setLocalDescription:"description, successCallback, failureCallback",setRemoteDescription:"description, successCallback, failureCallback",updateIce:"configuration",__proto__:null},EventTarget:{addEventListener:"type, listener, [useCapture=false]",removeEventListener:"type, listener, [useCapture=false]",dispatchEvent:"event",__proto__:null}};(function(){var c=WI.NativePrototypeFunctionParameters.EventTarget,e=["Node","Window","AudioNode","AudioTrackList","DOMApplicationCache","FileReader","MediaController","MediaStreamTrack","MessagePort","Notification","RTCDTMFSender","SpeechSynthesisUtterance","TextTrack","TextTrackCue","TextTrackList","VideoTrackList","WebKitMediaKeySession","WebKitNamedFlow","WebSocket","WorkerGlobalScope","XMLHttpRequest","webkitMediaStream","webkitRTCPeerConnection"];for(var t of e)Object.assign(WI.NativePrototypeFunctionParameters[t],c);var i={getElementsByClassName:"classNames",getElementsByTagName:"tagName",getElementsByTagNameNS:"namespace, localName",querySelector:"selectors",querySelectorAll:"selectors"};Object.assign(WI.NativePrototypeFunctionParameters.Element,i),Object.assign(WI.NativePrototypeFunctionParameters.Document,i);var n={after:"[node|string]...",before:"[node|string]...",replaceWith:"[node|string]..."};Object.assign(WI.NativePrototypeFunctionParameters.Element,n),Object.assign(WI.NativePrototypeFunctionParameters.CharacterData,n);var s={append:"[node|string]...",prepend:"[node|string]..."};Object.assign(WI.NativePrototypeFunctionParameters.Element,s),Object.assign(WI.NativePrototypeFunctionParameters.Document,s),Object.assign(WI.NativePrototypeFunctionParameters.DocumentFragment,s),WI.NativePrototypeFunctionParameters.Console=WI.NativeConstructorFunctionParameters.Console})();WI.NetworkInstrument=class extends WI.Instrument{get timelineRecordType(){return WI.TimelineRecord.Type.Network}startInstrumentation(e){}stopInstrumentation(e){}};WI.NetworkTimeline=class extends WI.Timeline{recordForResource(e){return console.assert(e instanceof WI.Resource),this._resourceRecordMap.get(e)||null}reset(e){this._resourceRecordMap=new Map,super.reset(e)}addRecord(e,t={}){console.assert(e instanceof WI.ResourceTimelineRecord),!this._resourceRecordMap.has(e.resource)&&(this._resourceRecordMap.set(e.resource,e),super.addRecord(e,t))}};WI.ObjectPreview=class{constructor(e,t,i,n,s,a,d,p){console.assert(e),console.assert(typeof n=="boolean"),console.assert(!a||!a.length||a[0]instanceof WI.PropertyPreview),console.assert(!d||!d.length||d[0]instanceof WI.CollectionEntryPreview),this._type=e,this._subtype=t,this._description=i||"",this._lossless=n,this._overflow=s||!1,this._size=p,this._properties=a||null,this._entries=d||null}static fromPayload(e){if(e.properties&&(e.properties=e.properties.map(WI.PropertyPreview.fromPayload)),e.entries&&(e.entries=e.entries.map(WI.CollectionEntryPreview.fromPayload)),e.subtype==="array"){var t=e.description.match(/\[(\d+)\]$/);t&&(e.size=parseInt(t[1]),e.description=e.description.replace(/\[\d+\]$/,""))}return new WI.ObjectPreview(e.type,e.subtype,e.description,e.lossless,e.overflow,e.properties,e.entries,e.size)}get type(){return this._type}get subtype(){return this._subtype}get description(){return this._description}get lossless(){return this._lossless}get overflow(){return this._overflow}get propertyPreviews(){return this._properties}get collectionEntryPreviews(){return this._entries}get size(){return this._size}hasSize(){return this._size!==void 0&&(this._subtype==="array"||this._subtype==="set"||this._subtype==="map"||this._subtype==="weakmap"||this._subtype==="weakset")}};WI.ProbeSample=class{constructor(e,t,i,n){console.assert(n instanceof WI.RemoteObject),this.sampleId=e,this.batchId=t,this.timestamp=i,this.object=n}};WI.Probe=class extends WI.Object{constructor(e,t,i){super(),console.assert(e),console.assert(t instanceof WI.Breakpoint),this._id=e,this._breakpoint=t,this._expression=i,this._samples=[]}get id(){return this._id}get breakpoint(){return this._breakpoint}get expression(){return this._expression}set expression(e){if(this._expression!==e){var t={oldValue:this._expression,newValue:e};this._expression=e,this.clearSamples(),this.dispatchEventToListeners(WI.Probe.Event.ExpressionChanged,t)}}get samples(){return this._samples.slice()}clearSamples(){this._samples=[],this.dispatchEventToListeners(WI.Probe.Event.SamplesCleared)}addSample(e){console.assert(e instanceof WI.ProbeSample,"Wrong object type passed as probe sample: ",e),this._samples.push(e),this.dispatchEventToListeners(WI.Probe.Event.SampleAdded,e)}};WI.Probe.Event={ExpressionChanged:"probe-object-expression-changed",SampleAdded:"probe-object-sample-added",SamplesCleared:"probe-object-samples-cleared"};WI.ProbeSet=class extends WI.Object{constructor(e){super(),console.assert(e instanceof WI.Breakpoint,"Unknown breakpoint argument: ",e),this._breakpoint=e,this._probes=[],this._probesByIdentifier=new Map,this._createDataTable(),WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceChanged,this),WI.Probe.addEventListener(WI.Probe.Event.SampleAdded,this._sampleCollected,this),WI.Breakpoint.addEventListener(WI.Breakpoint.Event.ResolvedStateDidChange,this._breakpointResolvedStateDidChange,this)}get breakpoint(){return this._breakpoint}get probes(){return this._probes.slice()}get dataTable(){return this._dataTable}clear(){this._breakpoint.clearActions(WI.BreakpointAction.Type.Probe)}clearSamples(){for(var e of this._probes)e.clearSamples();var t=this._dataTable;this._createDataTable(),this.dispatchEventToListeners(WI.ProbeSet.Event.SamplesCleared,{oldTable:t})}createProbe(e){this.breakpoint.createAction(WI.BreakpointAction.Type.Probe,null,e)}addProbe(e){console.assert(e instanceof WI.Probe,"Tried to add non-probe ",e," to probe group",this),console.assert(e.breakpoint===this.breakpoint,"Probe and ProbeSet must have same breakpoint.",e,this),this._probes.push(e),this._probesByIdentifier.set(e.id,e),this.dataTable.addProbe(e),this.dispatchEventToListeners(WI.ProbeSet.Event.ProbeAdded,e)}removeProbe(e){console.assert(e instanceof WI.Probe,"Tried to remove non-probe ",e," to probe group",this),console.assert(this._probes.indexOf(e)!==-1,"Tried to remove probe",e," not in group ",this),console.assert(this._probesByIdentifier.has(e.id),"Tried to remove probe",e," not in group ",this),this._probes.splice(this._probes.indexOf(e),1),this._probesByIdentifier.delete(e.id),this.dataTable.removeProbe(e),this.dispatchEventToListeners(WI.ProbeSet.Event.ProbeRemoved,e)}willRemove(){console.assert(!this._probes.length,"ProbeSet.willRemove called, but probes still associated with group: ",this._probes),WI.Frame.removeEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceChanged,this),WI.Probe.removeEventListener(WI.Probe.Event.SampleAdded,this._sampleCollected,this),WI.Breakpoint.removeEventListener(WI.Breakpoint.Event.ResolvedStateDidChange,this._breakpointResolvedStateDidChange,this)}_mainResourceChanged(){this.dataTable.mainResourceChanged()}_createDataTable(){this.dataTable&&this.dataTable.willRemove(),this._dataTable=new WI.ProbeSetDataTable(this)}_sampleCollected(e){var t=e.data;console.assert(t instanceof WI.ProbeSample,"Tried to add non-sample to probe group: ",t);var i=e.target;!this._probesByIdentifier.has(i.id)||(console.assert(this.dataTable),this.dataTable.addSampleForProbe(i,t),this.dispatchEventToListeners(WI.ProbeSet.Event.SampleAdded,{probe:i,sample:t}))}_breakpointResolvedStateDidChange(e){this.dispatchEventToListeners(WI.ProbeSet.Event.ResolvedStateDidChange)}};WI.ProbeSet.Event={ProbeAdded:"probe-set-probe-added",ProbeRemoved:"probe-set-probe-removed",ResolvedStateDidChange:"probe-set-resolved-state-did-change",SampleAdded:"probe-set-sample-added",SamplesCleared:"probe-set-samples-cleared"};WI.ProbeSetDataFrame=class{constructor(e){this._count=0,this._index=e,this._separator=!1}static compare(e,t){return console.assert(e instanceof WI.ProbeSetDataFrame,e),console.assert(t instanceof WI.ProbeSetDataFrame,t),e.index-t.index}get key(){return String(this._index)}get count(){return this._count}get index(){return this._index}get isSeparator(){return this._separator}set isSeparator(e){this._separator=!!e}addSampleForProbe(e,t){this[e.id]=t,this._count++}missingKeys(e){return e.probes.filter(function(t){return!this.hasOwnProperty(t.id)},this)}isComplete(e){return!this.missingKeys(e).length}fillMissingValues(e){for(var t of this.missingKeys(e))this[t]=WI.ProbeSetDataFrame.MissingValue}};WI.ProbeSetDataFrame.MissingValue="?";WI.ProbeSetDataTable=class extends WI.Object{constructor(e){super(),this._probeSet=e,this._frames=[],this._previousBatchIdentifier=WI.ProbeSetDataTable.SentinelValue}get frames(){return this._frames.slice()}get separators(){return this._frames.filter(function(e){return e.isSeparator})}willRemove(){this.dispatchEventToListeners(WI.ProbeSetDataTable.Event.WillRemove),this._frames=[],delete this._probeSet}mainResourceChanged(){this.addSeparator()}addSampleForProbe(e,t){t.batchId!==this._previousBatchIdentifier&&(this._openFrame&&(this._openFrame.fillMissingValues(this._probeSet),this.addFrame(this._openFrame)),this._openFrame=this.createFrame(),this._previousBatchIdentifier=t.batchId),console.assert(this._openFrame,"Should always have an open frame before adding sample.",this,e,t),this._openFrame.addSampleForProbe(e,t),this._openFrame.count===this._probeSet.probes.length&&(this.addFrame(this._openFrame),this._openFrame=null)}addProbe(e){for(var t of this.frames)t[e.id]||(t[e.id]=WI.ProbeSetDataTable.UnknownValue)}removeProbe(e){for(var t of this.frames)delete t[e.id]}createFrame(){return new WI.ProbeSetDataFrame(this._frames.length)}addFrame(e){this._frames.push(e),this.dispatchEventToListeners(WI.ProbeSetDataTable.Event.FrameInserted,e)}addSeparator(){if(!!this._frames.length){var e=this._frames.lastValue;e.isSeparator||(e.isSeparator=!0,this.dispatchEventToListeners(WI.ProbeSetDataTable.Event.SeparatorInserted,e))}}};WI.ProbeSetDataTable.Event={FrameInserted:"probe-set-data-table-frame-inserted",SeparatorInserted:"probe-set-data-table-separator-inserted",WillRemove:"probe-set-data-table-will-remove"};WI.ProbeSetDataTable.SentinelValue=-1;WI.ProbeSetDataTable.UnknownValue="?";WI.Profile=class{constructor(e){e=e||[],console.assert(e instanceof Array),console.assert(e.reduce(function(t,i){return t&&i instanceof WI.ProfileNode},!0)),this._topDownRootNodes=e}get topDownRootNodes(){return this._topDownRootNodes}get bottomUpRootNodes(){return[]}};WI.ProfileNode=class{constructor(e,t,i,n,s,a,d){d=d||[],console.assert(e),console.assert(!a||a instanceof Array),console.assert(!a||a.length>=1),console.assert(!a||a.every(f=>f instanceof WI.ProfileNodeCall)),console.assert(d instanceof Array),console.assert(d.every(f=>f instanceof WI.ProfileNode)),this._id=e,this._type=t||WI.ProfileNode.Type.Function,this._functionName=i||null,this._sourceCodeLocation=n||null,this._calls=a||null,this._callInfo=s||null,this._childNodes=d,this._parentNode=null,this._previousSibling=null,this._nextSibling=null,this._computedTotalTimes=!1,this._callInfo&&(this._startTime=this._callInfo.startTime,this._endTime=this._callInfo.endTime,this._totalTime=this._callInfo.totalTime,this._callCount=this._callInfo.callCount);for(var p=0;p<this._childNodes.length;++p)this._childNodes[p].establishRelationships(this,this._childNodes[p-1],this._childNodes[p+1]);if(this._calls)for(var p=0;p<this._calls.length;++p)this._calls[p].establishRelationships(this,this._calls[p-1],this._calls[p+1])}get id(){return this._id}get type(){return this._type}get functionName(){return this._functionName}get sourceCodeLocation(){return this._sourceCodeLocation}get startTime(){return this._startTime===void 0&&(this._startTime=Math.max(0,this._calls[0].startTime)),this._startTime}get endTime(){return this._endTime===void 0&&(this._endTime=Math.min(this._calls.lastValue.endTime,1/0)),this._endTime}get selfTime(){return this._computeTotalTimesIfNeeded(),this._selfTime}get totalTime(){return this._computeTotalTimesIfNeeded(),this._totalTime}get callInfo(){return this._callInfo}get calls(){return this._calls}get previousSibling(){return this._previousSibling}get nextSibling(){return this._nextSibling}get parentNode(){return this._parentNode}get childNodes(){return this._childNodes}computeCallInfoForTimeRange(e,t){if(console.assert(typeof e=="number"),console.assert(typeof t=="number"),this._callInfo){if(this._selfTime===void 0){var _=0;for(var i of this._childNodes)_+=i.totalTime;this._selfTime=this._totalTime-_,this._selfTime<1e-4&&(this._selfTime=0)}return{callCount:this._callCount,startTime:this._startTime,endTime:this._endTime,selfTime:this._selfTime,totalTime:this._totalTime,averageTime:this._selfTime/this._callCount}}var n=!0,s=0;function a(S,E){return e>E.endTime||t<E.startTime?S:(n&&++s,S+Math.min(E.endTime,t)-Math.max(e,E.startTime))}var d=Math.max(e,this._calls[0].startTime),p=Math.min(this._calls.lastValue.endTime,t),f=this._calls.reduce(a,0);n=!1;var _=0;for(var i of this._childNodes)_+=i.calls.reduce(a,0);var b=f-_,w=b/s;return{startTime:d,endTime:p,totalTime:f,selfTime:b,callCount:s,averageTime:w}}traverseNextProfileNode(e){var t=this._childNodes[0];if(t)return t;if(this===e)return null;if(t=this._nextSibling,t)return t;for(t=this;t&&!t.nextSibling&&t.parentNode!==e;)t=t.parentNode;return t?t.nextSibling:null}saveIdentityToCookie(e){e[WI.ProfileNode.TypeCookieKey]=this._type||null,e[WI.ProfileNode.FunctionNameCookieKey]=this._functionName||null,e[WI.ProfileNode.SourceCodeURLCookieKey]=this._sourceCodeLocation&&this._sourceCodeLocation.sourceCode.url?this._sourceCodeLocation.sourceCode.url.hash:null,e[WI.ProfileNode.SourceCodeLocationLineCookieKey]=this._sourceCodeLocation?this._sourceCodeLocation.lineNumber:null,e[WI.ProfileNode.SourceCodeLocationColumnCookieKey]=this._sourceCodeLocation?this._sourceCodeLocation.columnNumber:null}establishRelationships(e,t,i){this._parentNode=e||null,this._previousSibling=t||null,this._nextSibling=i||null}_computeTotalTimesIfNeeded(){if(!this._computedTotalTimes){this._computedTotalTimes=!0;var e=this.computeCallInfoForTimeRange(0,1/0);this._startTime=e.startTime,this._endTime=e.endTime,this._selfTime=e.selfTime,this._totalTime=e.totalTime}}};WI.ProfileNode.Type={Function:"profile-node-type-function",Program:"profile-node-type-program"};WI.ProfileNode.TypeIdentifier="profile-node";WI.ProfileNode.TypeCookieKey="profile-node-type";WI.ProfileNode.FunctionNameCookieKey="profile-node-function-name";WI.ProfileNode.SourceCodeURLCookieKey="profile-node-source-code-url";WI.ProfileNode.SourceCodeLocationLineCookieKey="profile-node-source-code-location-line";WI.ProfileNode.SourceCodeLocationColumnCookieKey="profile-node-source-code-location-column";WI.ProfileNodeCall=class{constructor(e,t){console.assert(e),this._startTime=e,this._totalTime=t||0,this._parentNode=null,this._previousSibling=null,this._nextSibling=null}get startTime(){return this._startTime}get totalTime(){return this._totalTime}get endTime(){return this._startTime+this._totalTime}establishRelationships(e,t,i){this._parentNode=e||null,this._previousSibling=t||null,this._nextSibling=i||null}};WI.PropertyDescriptor=class{constructor(e,t,i,n,s,a){console.assert(e),console.assert(e.name),console.assert(!e.value||e.value instanceof WI.RemoteObject),console.assert(!e.get||e.get instanceof WI.RemoteObject),console.assert(!e.set||e.set instanceof WI.RemoteObject),console.assert(!t||t instanceof WI.RemoteObject),this._name=e.name,this._value=e.value,this._hasValue="value"in e,this._get=e.get,this._set=e.set,this._symbol=t,this._writable=e.writable||!1,this._configurable=e.configurable||!1,this._enumerable=e.enumerable||!1,this._own=i||!1,this._wasThrown=n||!1,this._nativeGetterValue=s||!1,this._internal=a||!1}static fromPayload(e,t,i){return e.value&&(e.value=WI.RemoteObject.fromPayload(e.value,i)),e.get&&(e.get=WI.RemoteObject.fromPayload(e.get,i)),e.set&&(e.set=WI.RemoteObject.fromPayload(e.set,i)),e.symbol&&(e.symbol=WI.RemoteObject.fromPayload(e.symbol,i)),t&&(console.assert(e.value),e.writable=e.configurable=e.enumerable=!1,e.isOwn=!0),new WI.PropertyDescriptor(e,e.symbol,e.isOwn,e.wasThrown,e.nativeGetter,t)}get name(){return this._name}get value(){return this._value}get get(){return this._get}get set(){return this._set}get writable(){return this._writable}get configurable(){return this._configurable}get enumerable(){return this._enumerable}get symbol(){return this._symbol}get isOwnProperty(){return this._own}get wasThrown(){return this._wasThrown}get nativeGetter(){return this._nativeGetterValue}get isInternalProperty(){return this._internal}hasValue(){return this._hasValue}hasGetter(){return this._get&&this._get.type==="function"}hasSetter(){return this._set&&this._set.type==="function"}isIndexProperty(){return!isNaN(Number(this._name))}isSymbolProperty(){return!!this._symbol}};WI.PropertyPath=class{constructor(e,t,i,n){if(console.assert(e instanceof WI.RemoteObject||e===null),console.assert(!t||typeof t=="string"),console.assert(!i||i instanceof WI.PropertyPath),console.assert(!i||t.length),i&&!i.object)throw new Error("Attempted to append to a PropertyPath with null object.");this._object=e,this._pathComponent=typeof t=="string"?t:null,this._parent=i||null,this._isPrototype=n||!1}static emptyPropertyPathForScope(e){return new WI.PropertyPath(e,WI.PropertyPath.SpecialPathComponent.EmptyPathComponentForScope)}get object(){return this._object}get parent(){return this._parent}get isPrototype(){return this._isPrototype}get pathComponent(){return this._pathComponent}get rootObject(){return this._parent?this._parent.rootObject:this._object}get lastNonPrototypeObject(){if(!this._parent)return this._object;for(var e=this._parent;e&&!(!e.isPrototype||!e.parent);)e=e.parent;return e.object}get fullPath(){for(var e=[],t=this;t&&t.pathComponent;t=t.parent)e.push(t.pathComponent);return e.reverse(),e.join("")}get reducedPath(){for(var e=[],t=this;t&&t.isPrototype;t=t.parent)e.push(t.pathComponent);for(;t&&t.pathComponent;t=t.parent)t.isPrototype||e.push(t.pathComponent);return e.reverse(),e.join("")}displayPath(e){return e===WI.PropertyPath.Type.Value?this.reducedPath:this.fullPath}isRoot(){return!this._parent}isScope(){return this._pathComponent===WI.PropertyPath.SpecialPathComponent.EmptyPathComponentForScope}isPathComponentImpossible(){return this._pathComponent&&this._pathComponent.startsWith("@")}isFullPathImpossible(){return this.isPathComponentImpossible()?!0:this._parent?this._parent.isFullPathImpossible():!1}appendPropertyName(e,t){var i=t==="__proto__";if(this.isScope())return new WI.PropertyPath(e,t,this,i);var n=this._canPropertyNameBeDotAccess(t)?"."+t:"["+doubleQuotedString(t)+"]";return new WI.PropertyPath(e,n,this,i)}appendPropertySymbol(e,t){var i=WI.PropertyPath.SpecialPathComponent.SymbolPropertyName+(t.length?"("+t+")":"");return new WI.PropertyPath(e,i,this)}appendInternalPropertyName(e,t){var i=WI.PropertyPath.SpecialPathComponent.InternalPropertyName+"["+t+"]";return new WI.PropertyPath(e,i,this)}appendGetterPropertyName(e,t){var i=".__lookupGetter__("+doubleQuotedString(t)+")";return new WI.PropertyPath(e,i,this)}appendSetterPropertyName(e,t){var i=".__lookupSetter__("+doubleQuotedString(t)+")";return new WI.PropertyPath(e,i,this)}appendArrayIndex(e,t){var i="["+t+"]";return new WI.PropertyPath(e,i,this)}appendMapKey(e){var t=WI.PropertyPath.SpecialPathComponent.MapKey;return new WI.PropertyPath(e,t,this)}appendMapValue(e,t){if(console.assert(!t||t instanceof WI.RemoteObject),t&&t.hasValue()){if(t.type==="string"){var i=".get("+doubleQuotedString(t.description)+")";return new WI.PropertyPath(e,i,this)}var i=".get("+t.description+")";return new WI.PropertyPath(e,i,this)}var i=WI.PropertyPath.SpecialPathComponent.MapValue;return new WI.PropertyPath(e,i,this)}appendSetIndex(e){var t=WI.PropertyPath.SpecialPathComponent.SetIndex;return new WI.PropertyPath(e,t,this)}appendSymbolProperty(e){var t=WI.PropertyPath.SpecialPathComponent.SymbolPropertyName;return new WI.PropertyPath(e,t,this)}appendPropertyDescriptor(e,t,i){return console.assert(t instanceof WI.PropertyDescriptor),t.isInternalProperty?this.appendInternalPropertyName(e,t.name):t.symbol?this.appendSymbolProperty(e):i===WI.PropertyPath.Type.Getter?this.appendGetterPropertyName(e,t.name):i===WI.PropertyPath.Type.Setter?this.appendSetterPropertyName(e,t.name):(console.assert(i===WI.PropertyPath.Type.Value),this._object.subtype==="array"&&!isNaN(parseInt(t.name))?this.appendArrayIndex(e,t.name):this.appendPropertyName(e,t.name))}_canPropertyNameBeDotAccess(e){return/^(?![0-9])\w+$/.test(e)}};WI.PropertyPath.SpecialPathComponent={InternalPropertyName:"@internal",SymbolPropertyName:"@symbol",MapKey:"@mapkey",MapValue:"@mapvalue",SetIndex:"@setindex",EmptyPathComponentForScope:""};WI.PropertyPath.Type={Value:"value",Getter:"getter",Setter:"setter"};WI.PropertyPreview=class{constructor(e,t,i,n,s,a){console.assert(typeof e=="string"),console.assert(t),console.assert(!n||typeof n=="string"),console.assert(!s||s instanceof WI.ObjectPreview),this._name=e,this._type=t,this._subtype=i,this._value=n,this._valuePreview=s,this._internal=a}static fromPayload(e){return e.valuePreview&&(e.valuePreview=WI.ObjectPreview.fromPayload(e.valuePreview)),new WI.PropertyPreview(e.name,e.type,e.subtype,e.value,e.valuePreview,e.internal)}get name(){return this._name}get type(){return this._type}get subtype(){return this._subtype}get value(){return this._value}get valuePreview(){return this._valuePreview}get internal(){return this._internal}};WI.Recording=class extends WI.Object{constructor(e,t,i,n,s){super(),this._version=e,this._type=t,this._initialState=i,this._frames=n,this._data=s,this._displayName=WI.UIString("Recording"),this._swizzle=null,this._actions=[new WI.RecordingInitialStateAction].concat(...this._frames.map(a=>a.actions)),this._visualActionIndexes=[],this._source=null,this._processContext=null,this._processStates=[],this._processing=!1}static fromPayload(e,t){if(typeof e!="object"||e===null)return null;if(typeof e.version!="number")return WI.Recording.synthesizeError(WI.UIString("non-number %s").format(WI.unlocalizedString("version"))),null;if(e.version<1||e.version>WI.Recording.Version)return WI.Recording.synthesizeError(WI.UIString("unsupported %s").format(WI.unlocalizedString("version"))),null;parseInt(e.version)!==e.version&&(WI.Recording.synthesizeWarning(WI.UIString("non-integer %s").format(WI.unlocalizedString("version"))),e.version=parseInt(e.version));let i=null;switch(e.type){case RecordingAgent.Type.Canvas2D:i=WI.Recording.Type.Canvas2D;break;case RecordingAgent.Type.CanvasBitmapRenderer:i=WI.Recording.Type.CanvasBitmapRenderer;break;case RecordingAgent.Type.CanvasWebGL:i=WI.Recording.Type.CanvasWebGL;break;case RecordingAgent.Type.CanvasWebGL2:i=WI.Recording.Type.CanvasWebGL2;break;default:WI.Recording.synthesizeWarning(WI.UIString('unknown %s "%s"').format(WI.unlocalizedString("type"),e.type)),i=String(e.type);break}if((typeof e.initialState!="object"||e.initialState===null)&&("initialState"in e&&WI.Recording.synthesizeWarning(WI.UIString("non-object %s").format(WI.unlocalizedString("initialState"))),e.initialState={}),(typeof e.initialState.attributes!="object"||e.initialState.attributes===null)&&("attributes"in e.initialState&&WI.Recording.synthesizeWarning(WI.UIString("non-object %s").format(WI.unlocalizedString("initialState.attributes"))),e.initialState.attributes={}),(!Array.isArray(e.initialState.states)||e.initialState.states.some(n=>typeof n!="object"||n===null))&&("states"in e.initialState&&WI.Recording.synthesizeWarning(WI.UIString("non-array %s").format(WI.unlocalizedString("initialState.states"))),e.initialState.states=[],!isEmptyObject(e.initialState.attributes))){let{width:n,height:s,...a}=e.initialState.attributes;isEmptyObject(a)||e.initialState.states.push(a)}return Array.isArray(e.initialState.parameters)||("parameters"in e.initialState&&WI.Recording.synthesizeWarning(WI.UIString("non-array %s").format(WI.unlocalizedString("initialState.attributes"))),e.initialState.parameters=[]),typeof e.initialState.content!="string"&&("content"in e.initialState&&WI.Recording.synthesizeWarning(WI.UIString("non-string %s").format(WI.unlocalizedString("initialState.content"))),e.initialState.content=""),Array.isArray(e.frames)||("frames"in e&&WI.Recording.synthesizeWarning(WI.UIString("non-array %s").format(WI.unlocalizedString("frames"))),e.frames=[]),Array.isArray(e.data)||("data"in e&&WI.Recording.synthesizeWarning(WI.UIString("non-array %s").format(WI.unlocalizedString("data"))),e.data=[]),t||(t=e.frames.map(WI.RecordingFrame.fromPayload)),new WI.Recording(e.version,i,e.initialState,t,e.data)}static displayNameForSwizzleType(e){switch(e){case WI.Recording.Swizzle.None:return WI.unlocalizedString("None");case WI.Recording.Swizzle.Number:return WI.unlocalizedString("Number");case WI.Recording.Swizzle.Boolean:return WI.unlocalizedString("Boolean");case WI.Recording.Swizzle.String:return WI.unlocalizedString("String");case WI.Recording.Swizzle.Array:return WI.unlocalizedString("Array");case WI.Recording.Swizzle.TypedArray:return WI.unlocalizedString("TypedArray");case WI.Recording.Swizzle.Image:return WI.unlocalizedString("Image");case WI.Recording.Swizzle.ImageData:return WI.unlocalizedString("ImageData");case WI.Recording.Swizzle.DOMMatrix:return WI.unlocalizedString("DOMMatrix");case WI.Recording.Swizzle.Path2D:return WI.unlocalizedString("Path2D");case WI.Recording.Swizzle.CanvasGradient:return WI.unlocalizedString("CanvasGradient");case WI.Recording.Swizzle.CanvasPattern:return WI.unlocalizedString("CanvasPattern");case WI.Recording.Swizzle.WebGLBuffer:return WI.unlocalizedString("WebGLBuffer");case WI.Recording.Swizzle.WebGLFramebuffer:return WI.unlocalizedString("WebGLFramebuffer");case WI.Recording.Swizzle.WebGLRenderbuffer:return WI.unlocalizedString("WebGLRenderbuffer");case WI.Recording.Swizzle.WebGLTexture:return WI.unlocalizedString("WebGLTexture");case WI.Recording.Swizzle.WebGLShader:return WI.unlocalizedString("WebGLShader");case WI.Recording.Swizzle.WebGLProgram:return WI.unlocalizedString("WebGLProgram");case WI.Recording.Swizzle.WebGLUniformLocation:return WI.unlocalizedString("WebGLUniformLocation");case WI.Recording.Swizzle.ImageBitmap:return WI.unlocalizedString("ImageBitmap");case WI.Recording.Swizzle.WebGLQuery:return WI.unlocalizedString("WebGLQuery");case WI.Recording.Swizzle.WebGLSampler:return WI.unlocalizedString("WebGLSampler");case WI.Recording.Swizzle.WebGLSync:return WI.unlocalizedString("WebGLSync");case WI.Recording.Swizzle.WebGLTransformFeedback:return WI.unlocalizedString("WebGLTransformFeedback");case WI.Recording.Swizzle.WebGLVertexArrayObject:return WI.unlocalizedString("WebGLVertexArrayObject");default:return console.error("Unknown swizzle type",e),null}}static synthesizeWarning(e){if(e=WI.UIString("Recording Warning: %s").format(e),window.InspectorTest){console.warn(e);return}let t=new WI.ConsoleMessage(WI.mainTarget,WI.ConsoleMessage.MessageSource.Other,WI.ConsoleMessage.MessageLevel.Warning,e);t.shouldRevealConsole=!0,WI.consoleLogViewController.appendConsoleMessage(t)}static synthesizeError(e){if(e=WI.UIString("Recording Error: %s").format(e),window.InspectorTest){console.error(e);return}let t=new WI.ConsoleMessage(WI.mainTarget,WI.ConsoleMessage.MessageSource.Other,WI.ConsoleMessage.MessageLevel.Error,e);t.shouldRevealConsole=!0,WI.consoleLogViewController.appendConsoleMessage(t)}get displayName(){return this._displayName}get type(){return this._type}get initialState(){return this._initialState}get frames(){return this._frames}get data(){return this._data}get actions(){return this._actions}get visualActionIndexes(){return this._visualActionIndexes}get source(){return this._source}set source(e){this._source=e}get processing(){return this._processing}get ready(){return this._actions.lastValue.ready}startProcessing(){console.assert(!this._processing,"Cannot start an already started process()."),console.assert(!this.ready,"Cannot start a completed process()."),!(this._processing||this.ready)&&(this._processing=!0,this._process())}stopProcessing(){console.assert(this._processing,"Cannot stop an already stopped process()."),console.assert(!this.ready,"Cannot stop a completed process()."),!(!this._processing||this.ready)&&(this._processing=!1)}createDisplayName(e){let t;this._source?(t=this._source[WI.Recording.CanvasRecordingNamesSymbol],t||(this._source[WI.Recording.CanvasRecordingNamesSymbol]=t=new Set)):t=WI.Recording._importedRecordingNameSet;let i;if(e){i=e;let n=2;for(;t.has(i);)i=`${e} (${n++})`}else{let n=1;do i=WI.UIString("Recording %d").format(n++);while(t.has(i))}t.add(i),this._displayName=i}async swizzle(e,t){if(this._swizzle||(this._swizzle={}),typeof this._swizzle[e]!="object"&&(this._swizzle[e]={}),t===WI.Recording.Swizzle.Number)return parseFloat(e);if(t===WI.Recording.Swizzle.Boolean)return!!e;if(t===WI.Recording.Swizzle.Array)return Array.isArray(e)?e:[];if(t===WI.Recording.Swizzle.DOMMatrix)return new DOMMatrix(e);if(t===WI.Recording.Swizzle.TypedArray||t===WI.Recording.Swizzle.WebGLBuffer||t===WI.Recording.Swizzle.WebGLFramebuffer||t===WI.Recording.Swizzle.WebGLRenderbuffer||t===WI.Recording.Swizzle.WebGLTexture||t===WI.Recording.Swizzle.WebGLShader||t===WI.Recording.Swizzle.WebGLProgram||t===WI.Recording.Swizzle.WebGLUniformLocation||t===WI.Recording.Swizzle.WebGLQuery||t===WI.Recording.Swizzle.WebGLSampler||t===WI.Recording.Swizzle.WebGLSync||t===WI.Recording.Swizzle.WebGLTransformFeedback||t===WI.Recording.Swizzle.WebGLVertexArrayObject)return e;if(!(t in this._swizzle[e]))try{let i=this._data[e];switch(t){case WI.Recording.Swizzle.None:this._swizzle[e][t]=i;break;case WI.Recording.Swizzle.String:Array.isArray(i)?this._swizzle[e][t]=await Promise.all(i.map(n=>this.swizzle(n,WI.Recording.Swizzle.String))):this._swizzle[e][t]=String(i);break;case WI.Recording.Swizzle.Image:this._swizzle[e][t]=await WI.ImageUtilities.promisifyLoad(i),this._swizzle[e][t].__data=i;break;case WI.Recording.Swizzle.ImageData:{let[n,s,a]=await Promise.all([this.swizzle(i[0],WI.Recording.Swizzle.Array),this.swizzle(i[1],WI.Recording.Swizzle.Number),this.swizzle(i[2],WI.Recording.Swizzle.Number)]);n=await Promise.all(n.map(d=>this.swizzle(d,WI.Recording.Swizzle.Number))),this._swizzle[e][t]=new ImageData(new Uint8ClampedArray(n),s,a),this._swizzle[e][t].__data={data:n,width:s,height:a};break}case WI.Recording.Swizzle.Path2D:this._swizzle[e][t]=new Path2D(i),this._swizzle[e][t].__data=i;break;case WI.Recording.Swizzle.CanvasGradient:{let[n,s]=await Promise.all([this.swizzle(i[0],WI.Recording.Swizzle.String),this.swizzle(i[1],WI.Recording.Swizzle.Array)]);s=await Promise.all(s.map(d=>this.swizzle(d,WI.Recording.Swizzle.Number))),WI.ImageUtilities.scratchCanvasContext2D(d=>{this._swizzle[e][t]=n==="radial-gradient"?d.createRadialGradient(...s):d.createLinearGradient(...s)});let a=[];for(let d of i[2]){let[p,f]=await Promise.all([this.swizzle(d[0],WI.Recording.Swizzle.Number),this.swizzle(d[1],WI.Recording.Swizzle.String)]);this._swizzle[e][t].addColorStop(p,f),a.push({offset:p,color:f})}this._swizzle[e][t].__data={type:n,points:s,stops:a};break}case WI.Recording.Swizzle.CanvasPattern:{let[n,s]=await Promise.all([this.swizzle(i[0],WI.Recording.Swizzle.Image),this.swizzle(i[1],WI.Recording.Swizzle.String)]);WI.ImageUtilities.scratchCanvasContext2D(a=>{this._swizzle[e][t]=a.createPattern(n,s),this._swizzle[e][t].__image=n}),this._swizzle[e][t].__data={image:n.__data,repeat:s};break}case WI.Recording.Swizzle.ImageBitmap:{let n=await this.swizzle(e,WI.Recording.Swizzle.Image);this._swizzle[e][t]=await createImageBitmap(n),this._swizzle[e][t].__data=i;break}case WI.Recording.Swizzle.CallStack:{let n=await this.swizzle(i,WI.Recording.Swizzle.Array);this._swizzle[e][t]=await Promise.all(n.map(s=>this.swizzle(s,WI.Recording.Swizzle.CallFrame)));break}case WI.Recording.Swizzle.CallFrame:{let n=await this.swizzle(i,WI.Recording.Swizzle.Array),[s,a]=await Promise.all([this.swizzle(n[0],WI.Recording.Swizzle.String),this.swizzle(n[1],WI.Recording.Swizzle.String)]);this._swizzle[e][t]=WI.CallFrame.fromPayload(WI.assumingMainTarget(),{functionName:s,url:a,lineNumber:n[2],columnNumber:n[3]});break}}}catch{}return this._swizzle[e][t]}createContext(){let e=t=>{let i=document.createElement("canvas");return"width"in this._initialState.attributes&&(i.width=this._initialState.attributes.width),"height"in this._initialState.attributes&&(i.height=this._initialState.attributes.height),i.getContext(t,...this._initialState.parameters)};return this._type===WI.Recording.Type.Canvas2D?e("2d"):this._type===WI.Recording.Type.CanvasBitmapRenderer?e("bitmaprenderer"):this._type===WI.Recording.Type.CanvasWebGL?e("webgl"):this._type===WI.Recording.Type.CanvasWebGL2?e("webgl2"):(console.error("Unknown recording type",this._type),null)}toJSON(){let e={};return isEmptyObject(this._initialState.attributes)||(e.attributes=this._initialState.attributes),this._initialState.states.length&&(e.states=this._initialState.states),this._initialState.parameters.length&&(e.parameters=this._initialState.parameters),this._initialState.content&&this._initialState.content.length&&(e.content=this._initialState.content),{version:this._version,type:this._type,initialState:e,frames:this._frames.map(t=>t.toJSON()),data:this._data}}toHTML(){console.assert(this._type===WI.Recording.Type.Canvas2D),console.assert(this.ready);let e=[],t=[];function i(d){return t.push({object:d,index:t.length}),`objects[${t.length-1}]`}function n(d){return typeof d=="object"&&!Array.isArray(d)?i(d):JSON.stringify(d)}function s(d){return d.replace(/[^0-9A-Za-z ]/g,p=>`&#${p.charCodeAt(0)};`)}e.push("<!DOCTYPE html>"),e.push("<head>"),e.push(`<title>${s(this._displayName)}</title>`),e.push("<style>"),e.push("    body {"),e.push("        margin: 0;"),e.push("    }"),e.push("    canvas {"),e.push("        max-width: calc(100% - 40px);"),e.push("        max-height: calc(100% - 40px);"),e.push("        padding: 20px;"),e.push("    }"),e.push("</style>"),e.push("</head>"),e.push("<body>"),e.push("<script>"),e.push('"use strict";'),e.push(""),e.push("let promises = [];"),e.push("let objects = {};"),e.push(""),e.push('let canvas = document.body.appendChild(document.createElement("canvas"));');for(let[d,p]of Object.entries(this._initialState.attributes))e.push(`canvas.${d} = ${JSON.stringify(p)};`);e.push("");let a=this._initialState.parameters.map(n).join(", ");if(e.push(`let context = canvas.getContext("2d"${a?", "+a:""});`),e.push(""),e.push("let frames = ["),e.push("    function initialState() {"),this._initialState.content){let d=new Image;d.__data=this._initialState.content,e.push(`        context.drawImage(${i(d)}, 0, 0);`),e.push("")}for(let d of this._actions[0].states){for(let[p,f]of d){if(p==="getPath"||p==="currentX"||p==="currentY")continue;let _="context";p==="setPath"&&(e.push(`        if (${JSON.stringify(p)} in context)`),_="    "+_);let b="";WI.RecordingAction.isFunctionForType(this._type,p)?b="("+f.map(n).join(", ")+")":b=` = ${n(f)}`,e.push(`        ${_}.${p}${b};`)}d!==this._actions[0].states.lastValue&&(e.push("        context.save();"),e.push(""))}e.push("    },"),e.push("    function startRecording() {"),e.push('        if (typeof console.record === "function")'),e.push(`            console.record(context, {name: ${JSON.stringify(this._displayName)}});`),e.push("    },");for(let d=0;d<this._frames.length;++d){e.push(`    function frame${d+1}() {`);for(let p of this._frames[d].actions){let f="context";p.contextReplacer&&(f+=`.${p.contextReplacer}`),p.valid||(f="// "+f);let _="";p.isFunction?_+="("+p.parameters.map(n).join(", ")+")":p.isGetter||(_+=" = "+n(p.parameters[0])),e.push(`        ${f}.${p.name}${_};`)}e.push("    },")}if(e.push("    function stopRecording() {"),e.push('        if (typeof console.recordEnd === "function")'),e.push("            console.recordEnd(context);"),e.push("    },"),e.push("];"),e.push(""),t.length){t.some(({object:d})=>d instanceof CanvasGradient)&&(e.push("function rebuildCanvasGradient(key, data) {"),e.push("    let gradient = null;"),e.push('    if (data.type === "radial-gradient")'),e.push("        gradient = context.createRadialGradient(data.points[0], data.points[1], data.points[2], data.points[3], data.points[4], data.points[5]);"),e.push("    else"),e.push("        gradient = context.createLinearGradient(data.points[0], data.points[1], data.points[2], data.points[3]);"),e.push("    for (let stop of data.stops)"),e.push("        gradient.addColorStop(stop.offset, stop.color);"),e.push("    objects[key] = gradient;"),e.push("}")),t.some(({object:d})=>d instanceof CanvasPattern)&&(e.push("function rebuildCanvasPattern(key, data) {"),e.push("    promises.push(new Promise(function(resolve, reject) {"),e.push("        let image = new Image;"),e.push("        function resolveWithImage(event) {"),e.push("            objects[key] = context.createPattern(image, data.repeat);"),e.push("            resolve();"),e.push("        }"),e.push('        image.addEventListener("load", resolveWithImage);'),e.push('        image.addEventListener("error", resolveWithImage);'),e.push("        image.src = data.image;"),e.push("    }));"),e.push("}")),t.some(({object:d})=>d instanceof DOMMatrix)&&(e.push("function rebuildDOMMatrix(key, data) {"),e.push("    objects[key] = new DOMMatrix(data);"),e.push("}")),t.some(({object:d})=>d instanceof Image)&&(e.push("function rebuildImage(key, data) {"),e.push("    promises.push(new Promise(function(resolve, reject) {"),e.push("        let image = new Image;"),e.push("        function resolveWithImage(event) {"),e.push("            objects[key] = image;"),e.push("            resolve();"),e.push("        }"),e.push('        image.addEventListener("load", resolveWithImage);'),e.push('        image.addEventListener("error", resolveWithImage);'),e.push("        image.src = data;"),e.push("    }));"),e.push("}")),t.some(({object:d})=>d instanceof ImageBitmap)&&(e.push("function rebuildImageBitmap(key, data) {"),e.push("    promises.push(new Promise(function(resolve, reject) {"),e.push("        let image = new Image;"),e.push("        function resolveWithImage(event) {"),e.push("            createImageBitmap(image).then(function(imageBitmap) {"),e.push("                objects[key] = imageBitmap;"),e.push("                resolve();"),e.push("            });"),e.push("        }"),e.push('        image.addEventListener("load", resolveWithImage);'),e.push('        image.addEventListener("error", resolveWithImage);'),e.push("        image.src = data;"),e.push("    }));"),e.push("}")),t.some(({object:d})=>d instanceof ImageData)&&(e.push("function rebuildImageData(key, data) {"),e.push("    objects[key] = new ImageData(new Uint8ClampedArray(data.data), parseInt(data.width), parseInt(data.height));"),e.push("}")),t.some(({object:d})=>d instanceof Path2D)&&(e.push("function rebuildPath2D(key, data) {"),e.push("    objects[key] = new Path2D(data);"),e.push("}")),e.push("");for(let{object:d,index:p}of t){if(d instanceof CanvasGradient){e.push(`rebuildCanvasGradient(${p}, ${JSON.stringify(d.__data)});`);continue}if(d instanceof CanvasPattern){e.push(`rebuildCanvasPattern(${p}, ${JSON.stringify(d.__data)});`);continue}if(d instanceof DOMMatrix){e.push(`rebuildDOMMatrix(${p}, ${JSON.stringify(d.toString())});`);continue}if(d instanceof Image){e.push(`rebuildImage(${p}, ${JSON.stringify(d.__data)});`);continue}if(d instanceof ImageBitmap){e.push(`rebuildImageBitmap(${p}, ${JSON.stringify(d.__data)});`);continue}if(d instanceof ImageData){e.push(`rebuildImageData(${p}, ${JSON.stringify(d.__data)});`);continue}if(d instanceof Path2D){e.push(`rebuildPath2D(${p}, ${JSON.stringify(d.__data||"")});`);continue}}e.push("")}return e.push("Promise.all(promises).then(function() {"),e.push("    window.requestAnimationFrame(function executeFrame() {"),e.push("        frames.shift()();"),e.push("        if (frames.length)"),e.push("            window.requestAnimationFrame(executeFrame);"),e.push("    });"),e.push("});"),e.push("<\/script>"),e.push("</body>"),e.join(`
`)}async _process(){if(!this._processContext&&(this._processContext=this.createContext(),this._type===WI.Recording.Type.Canvas2D)){let s=await WI.ImageUtilities.promisifyLoad(this._initialState.content);this._processContext.drawImage(s,0,0);for(let a of this._initialState.states)(await WI.RecordingState.swizzleInitialState(this,a)).apply(this._type,this._processContext),a!==this._initialState.states.lastValue&&(this._processContext.save(),this._processStates.push(WI.RecordingState.fromContext(this._type,this._processContext)))}this._actions[0].ready||(this._actions[0].process(this,this._processContext,this._processStates),this.dispatchEventToListeners(WI.Recording.Event.ProcessedAction,{action:this._actions[0],index:0}));const e=10;let t=Date.now(),i=0,n=this._actions[i];for(let s=0;s<this._frames.length;++s){let a=this._frames[s];if(a.actions.lastValue.ready){i+=a.actions.length,n=a.actions.lastValue;continue}for(let d=0;d<a.actions.length;++d){++i;let p=a.actions[d];if(p.ready){n=p;continue}if(await p.swizzle(this),p.process(this,this._processContext,this._processStates,{lastAction:n}),p.isVisual&&this._visualActionIndexes.push(i),d||this.dispatchEventToListeners(WI.Recording.Event.StartProcessingFrame,{frame:a,index:s}),this.dispatchEventToListeners(WI.Recording.Event.ProcessedAction,{action:p,index:i}),Date.now()-t>e&&(await Promise.delay(),t=Date.now()),n=p,!this._processing)return}if(!this._processing)return}this._swizzle=null,this._processContext=null,this._processing=!1}};WI.Recording.Version=1;WI.Recording.Event={ProcessedAction:"recording-processed-action",StartProcessingFrame:"recording-start-processing-frame"};WI.Recording._importedRecordingNameSet=new Set;WI.Recording.CanvasRecordingNamesSymbol=Symbol("canvas-recording-names");WI.Recording.Type={Canvas2D:"canvas-2d",CanvasBitmapRenderer:"canvas-bitmaprenderer",CanvasWebGL:"canvas-webgl",CanvasWebGL2:"canvas-webgl2"};WI.Recording.Swizzle={None:0,Number:1,Boolean:2,String:3,Array:4,TypedArray:5,Image:6,ImageData:7,DOMMatrix:8,Path2D:9,CanvasGradient:10,CanvasPattern:11,WebGLBuffer:12,WebGLFramebuffer:13,WebGLRenderbuffer:14,WebGLTexture:15,WebGLShader:16,WebGLProgram:17,WebGLUniformLocation:18,ImageBitmap:19,WebGLQuery:20,WebGLSampler:21,WebGLSync:22,WebGLTransformFeedback:23,WebGLVertexArrayObject:24,CallStack:Symbol("CallStack"),CallFrame:Symbol("CallFrame")};WI.RecordingAction=class extends WI.Object{constructor(e,t,i,n,s){super(),this._payloadName=e,this._payloadParameters=t,this._payloadSwizzleTypes=i,this._payloadTrace=n,this._payloadSnapshot=s||-1,this._name="",this._parameters=[],this._trace=[],this._snapshot="",this._valid=!0,this._isFunction=!1,this._isGetter=!1,this._isVisual=!1,this._contextReplacer=null,this._states=[],this._stateModifiers=new Set,this._warning=null,this._swizzled=!1,this._processed=!1}static fromPayload(e){return Array.isArray(e)||(e=[]),typeof e[0]!="number"&&(e.length>0&&WI.Recording.synthesizeWarning(WI.UIString("non-number %s").format(WI.unlocalizedString("name"))),e[0]=-1),Array.isArray(e[1])||(e.length>1&&WI.Recording.synthesizeWarning(WI.UIString("non-array %s").format(WI.unlocalizedString("parameters"))),e[1]=[]),Array.isArray(e[2])||(e.length>2&&WI.Recording.synthesizeWarning(WI.UIString("non-array %s").format(WI.unlocalizedString("swizzleTypes"))),e[2]=[]),(typeof e[3]!="number"||isNaN(e[3])||!e[3]&&e[3]!==0)&&(Array.isArray(e[3])||(e.length>3&&WI.Recording.synthesizeWarning(WI.UIString("non-number %s").format(WI.unlocalizedString("trace"))),e[3]=[])),(typeof e[4]!="number"||isNaN(e[4]))&&(e.length>4&&WI.Recording.synthesizeWarning(WI.UIString("non-number %s").format(WI.unlocalizedString("snapshot"))),e[4]=-1),new WI.RecordingAction(...e)}static isFunctionForType(e,t){let i=WI.RecordingAction._prototypeForType(e);if(!i)return!1;let n=Object.getOwnPropertyDescriptor(i,t);return n?typeof n.value=="function":!1}static constantNameForParameter(e,t,i,n,s){let a=WI.RecordingAction._constantIndexes[e];if(!a)return null;let d=a[t];if(!d||Array.isArray(d)&&!d.includes(n))return null;if(typeof d=="object"){let f=d[s];if(!f||Array.isArray(f)&&!f.includes(n))return null}if(i===0&&(e===WI.Recording.Type.CanvasWebGL||e===WI.Recording.Type.CanvasWebGL2)){if(t==="blendFunc"||t==="blendFuncSeparate")return"ZERO";if(n===0){if(t==="drawArrays"||t==="drawElements")return"POINTS";if(t==="pixelStorei")return"NONE"}}let p=WI.RecordingAction._prototypeForType(e);if(p)for(let f in p){let _=Object.getOwnPropertyDescriptor(p,f);if(_&&_.value===i)return f}return null}static _prototypeForType(e){switch(e){case WI.Recording.Type.Canvas2D:return CanvasRenderingContext2D.prototype;case WI.Recording.Type.CanvasBitmapRenderer:if(window.ImageBitmapRenderingContext)return ImageBitmapRenderingContext.prototype;break;case WI.Recording.Type.CanvasWebGL:if(window.WebGLRenderingContext)return WebGLRenderingContext.prototype;break;case WI.Recording.Type.CanvasWebGL2:if(window.WebGL2RenderingContext)return WebGL2RenderingContext.prototype;break}return WI.reportInternalError("Unknown recording type: "+e),null}get name(){return this._name}get parameters(){return this._parameters}get swizzleTypes(){return this._payloadSwizzleTypes}get trace(){return this._trace}get snapshot(){return this._snapshot}get valid(){return this._valid}get isFunction(){return this._isFunction}get isGetter(){return this._isGetter}get isVisual(){return this._isVisual}get contextReplacer(){return this._contextReplacer}get states(){return this._states}get stateModifiers(){return this._stateModifiers}get warning(){return this._warning}get ready(){return this._swizzled&&this._processed}process(e,t,i,{lastAction:n}={}){if(console.assert(this._swizzled,"You must swizzle() before you can process()."),console.assert(!this._processed,"You should only process() once."),this._processed=!0,e.type===WI.Recording.Type.CanvasWebGL||e.type===WI.Recording.Type.CanvasWebGL2){if(this._valid&&this._isVisual){let p=e.visualActionIndexes.length?e.actions[e.visualActionIndexes.lastValue].snapshot:e.initialState.content;this._snapshot===p&&(this._warning=WI.UIString("This action causes no visual change"))}return}function s(){if(t instanceof CanvasRenderingContext2D)return t.getImageData(0,0,t.canvas.width,t.canvas.height).data;if(window.WebGLRenderingContext&&t instanceof WebGLRenderingContext||window.WebGL2RenderingContext&&t instanceof WebGL2RenderingContext){let p=new Uint8Array(t.drawingBufferWidth*t.drawingBufferHeight*4);return t.readPixels(0,0,t.canvas.width,t.canvas.height,t.RGBA,t.UNSIGNED_BYTE,p),p}return t.canvas instanceof HTMLCanvasElement?[t.canvas.toDataURL()]:(console.assert("Unknown context type",t),[])}let a=null,d=this._valid&&this._isVisual;if(d&&(a=s()),this.apply(t),d){let p=s();Array.shallowEqual(a,p)&&(this._warning=WI.UIString("This action causes no visual change"))}if(e.type===WI.Recording.Type.Canvas2D){let p=WI.RecordingState.fromContext(e.type,t,{source:this});console.assert(p),this.name==="save"?i.push(p):this.name==="restore"&&i.pop(),this._states=i.slice(),this._states.push(p);let f=null;if(n){f=n.states.lastValue;for(let[_,b]of p){let w=f.get(_);b!==w&&!Object.shallowEqual(b,w)&&this._stateModifiers.add(_)}}if(WI.ImageUtilities.supportsCanvasPathDebugging()){let _=p.get("currentX"),b=(_<0||_>=t.canvas.width)&&(!f||_!==f.get("currentX")),w=p.get("currentY"),S=(w<0||w>=t.canvas.height)&&(!f||w!==f.get("currentY"));(b||S)&&(this._warning=WI.UIString("This action moves the path outside the visible area"))}}}async swizzle(e,t){if(console.assert(!this._swizzled,"You should only swizzle() once."),!this._valid){this._swizzled=!0;return}let i=(f,_)=>e.swizzle(f,this._payloadSwizzleTypes[_]),n=[e.swizzle(this._payloadName,WI.Recording.Swizzle.String),Promise.all(this._payloadParameters.map(i))];isNaN(this._payloadTrace)?n.push(Promise.all(this._payloadTrace.map(f=>e.swizzle(f,WI.Recording.Swizzle.CallFrame)))):n.push(e.swizzle(this._payloadTrace,WI.Recording.Swizzle.CallStack)),this._payloadSnapshot>=0&&n.push(e.swizzle(this._payloadSnapshot,WI.Recording.Swizzle.String));let[s,a,d,p]=await Promise.all(n);if(this._name=s,this._parameters=a,this._trace=d,this._payloadSnapshot>=0&&(this._snapshot=p),(e.type===WI.Recording.Type.Canvas2D||e.type===WI.Recording.Type.CanvasBitmapRenderer||e.type===WI.Recording.Type.CanvasWebGL||e.type===WI.Recording.Type.CanvasWebGL2)&&(this._name==="width"||this._name==="height")&&(this._contextReplacer="canvas",this._isFunction=!1,this._isGetter=!this._parameters.length,this._isVisual=!this._isGetter),!this._contextReplacer){if(this._isFunction=WI.RecordingAction.isFunctionForType(e.type,this._name),this._isGetter=!this._isFunction&&!this._parameters.length,this._snapshot)this._isVisual=!0;else{let f=WI.RecordingAction._visualNames[e.type];this._isVisual=f?f.has(this._name):!1}if(this._valid){let f=WI.RecordingAction._prototypeForType(e.type);f&&!(s in f)&&(this.markInvalid(),WI.Recording.synthesizeWarning(WI.UIString('"%s" is not valid for %s').format(s,f.constructor.name)))}}if(this._valid){let f=this._parameters.every(b=>b!==void 0),_=this._payloadSwizzleTypes.every(b=>b!==WI.Recording.Swizzle.None);(!f||!_)&&this.markInvalid()}if(this._valid){let f=WI.RecordingAction._stateModifiers[e.type];if(f){this._stateModifiers.add(this._name);let _=f[this._name]||[];for(let b of _)this._stateModifiers.add(b)}}this._swizzled=!0}apply(e,t={}){if(console.assert(this._swizzled,"You must swizzle() before you can apply()."),console.assert(this._processed,"You must process() before you can apply()."),!!this.valid)try{let i=t.nameOverride||this._name;this._contextReplacer&&(e=e[this._contextReplacer]),this.isFunction?e[i](...this._parameters):this.isGetter?e[i]:e[i]=this._parameters[0]}catch{this.markInvalid(),WI.Recording.synthesizeWarning(WI.UIString('"%s" threw an error').format(this._name))}}markInvalid(){!this._valid||(this._valid=!1,this.dispatchEventToListeners(WI.RecordingAction.Event.ValidityChanged))}getColorParameters(){switch(this._name){case"fillStyle":case"strokeStyle":case"shadowColor":case"setFillColor":case"setStrokeColor":case"blendColor":case"clearColor":case"colorMask":return this._parameters;case"setShadow":return this._parameters.slice(3)}return[]}getImageParameters(){switch(this._name){case"createImageData":case"createPattern":case"drawImage":case"fillStyle":case"putImageData":case"strokeStyle":case"drawImageFromRect":case"transferFromImageBitmap":return this._parameters.slice(0,1);case"texImage2D":case"texSubImage2D":case"compressedTexImage2D":return[this._parameters.lastValue]}return[]}toJSON(){let e=[this._payloadName,this._payloadParameters,this._payloadSwizzleTypes,this._payloadTrace];return this._payloadSnapshot>=0&&e.push(this._payloadSnapshot),e}};WI.RecordingAction.Event={ValidityChanged:"recording-action-marked-invalid"};WI.RecordingAction._constantIndexes={[WI.Recording.Type.CanvasWebGL]:{activeTexture:!0,bindBuffer:!0,bindFramebuffer:!0,bindRenderbuffer:!0,bindTexture:!0,blendEquation:!0,blendEquationSeparate:!0,blendFunc:!0,blendFuncSeparate:!0,bufferData:[0,2],bufferSubData:[0],checkFramebufferStatus:!0,compressedTexImage2D:[0,2],compressedTexSubImage2D:[0],copyTexImage2D:[0,2],copyTexSubImage2D:[0],createShader:!0,cullFace:!0,depthFunc:!0,disable:!0,drawArrays:[0],drawElements:[0,2],enable:!0,framebufferRenderbuffer:!0,framebufferTexture2D:[0,1,2],frontFace:!0,generateMipmap:!0,getBufferParameter:!0,getFramebufferAttachmentParameter:!0,getParameter:!0,getProgramParameter:!0,getRenderbufferParameter:!0,getShaderParameter:!0,getShaderPrecisionFormat:!0,getTexParameter:!0,getVertexAttrib:[1],getVertexAttribOffset:[1],hint:!0,isEnabled:!0,pixelStorei:[0],readPixels:[4,5],renderbufferStorage:[0,1],stencilFunc:[0],stencilFuncSeparate:[0,1],stencilMaskSeparate:[0],stencilOp:!0,stencilOpSeparate:!0,texImage2D:{5:[0,2,3,4],6:[0,2,3,4],8:[0,2,6,7],9:[0,2,6,7]},texParameterf:[0,1],texParameteri:[0,1],texSubImage2D:{6:[0,4,5],7:[0,4,5],8:[0,6,7],9:[0,6,7]},vertexAttribPointer:[2]},[WI.Recording.Type.CanvasWebGL2]:{activeTexture:!0,beginQuery:[0],beginTransformFeedback:!0,bindBuffer:!0,bindBufferBase:[0],bindBufferRange:[0],bindFramebuffer:!0,bindRenderbuffer:!0,bindTexture:!0,bindTransformFeedback:[0],blendEquation:!0,blendEquationSeparate:!0,blendFunc:!0,blendFuncSeparate:!0,blitFramebuffer:[10],bufferData:[0,2],bufferSubData:[0],checkFramebufferStatus:!0,clearBufferfi:[0],clearBufferfv:[0],clearBufferiv:[0],clearBufferuiv:[0],compressedTexImage2D:[0,2],compressedTexSubImage2D:[0],compressedTexSubImage3D:[0],copyBufferSubData:[0,1],copyTexImage2D:[0,2],copyTexSubImage2D:[0],copyTexSubImage3D:[0],createShader:!0,cullFace:!0,depthFunc:!0,disable:!0,drawArrays:[0],drawArraysInstanced:[0],drawBuffers:!0,drawElements:[0,2],drawElementsInstanced:[0,2],drawRangeElements:[0,4],enable:!0,endQuery:!0,fenceSync:[0],framebufferRenderbuffer:!0,framebufferTexture2D:[0,1,2],framebufferTextureLayer:[0,1],frontFace:!0,generateMipmap:!0,getActiveUniformBlockParameter:[2],getActiveUniforms:[2],getBufferParameter:!0,getBufferSubData:[0],getFramebufferAttachmentParameter:!0,getIndexedParameter:[0],getInternalformatParameter:!0,getParameter:!0,getProgramParameter:!0,getQuery:!0,getQueryParameter:[1],getRenderbufferParameter:!0,getSamplerParameter:[1],getShaderParameter:!0,getShaderPrecisionFormat:!0,getSyncParameter:[1],getTexParameter:!0,getVertexAttrib:[1],getVertexAttribOffset:[1],hint:!0,invalidateFramebuffer:[0,1],invalidateSubFramebuffer:[0,1],isEnabled:!0,pixelStorei:[0],readBuffer:!0,readPixels:[4,5],renderbufferStorage:[0,1],renderbufferStorageMultisample:[0,2],samplerParameterf:[1],samplerParameteri:[1],stencilFunc:[0],stencilFuncSeparate:[0,1],stencilMaskSeparate:[0],stencilOp:!0,stencilOpSeparate:!0,texImage2D:{5:[0,2,3,4],6:[0,2,3,4],8:[0,2,6,7],9:[0,2,6,7],10:[0,2,6,7],11:[0,2,7,8]},texParameterf:[0,1],texParameteri:[0,1],texStorage2D:[0,2],texSubImage2D:{6:[0,4,5],7:[0,4,5],8:[0,6,7],9:[0,6,7],10:[0,6,7],11:[0,8,9],12:[0,8,9]},transformFeedbackVaryings:[2],vertexAttribIPointer:[2],vertexAttribPointer:[2]}};WI.RecordingAction._visualNames={[WI.Recording.Type.Canvas2D]:new Set(["clearRect","drawFocusIfNeeded","drawImage","drawImageFromRect","fill","fillRect","fillText","putImageData","stroke","strokeRect","strokeText"]),[WI.Recording.Type.CanvasBitmapRenderer]:new Set(["transferFromImageBitmap"]),[WI.Recording.Type.CanvasWebGL]:new Set(["clear","drawArrays","drawElements"]),[WI.Recording.Type.CanvasWebGL2]:new Set(["clear","drawArrays","drawArraysInstanced","drawElements","drawElementsInstanced"])};WI.RecordingAction._stateModifiers={[WI.Recording.Type.Canvas2D]:{arc:["currentX","currentY"],arcTo:["currentX","currentY"],beginPath:["currentX","currentY"],bezierCurveTo:["currentX","currentY"],clearShadow:["shadowOffsetX","shadowOffsetY","shadowBlur","shadowColor"],closePath:["currentX","currentY"],ellipse:["currentX","currentY"],lineTo:["currentX","currentY"],moveTo:["currentX","currentY"],quadraticCurveTo:["currentX","currentY"],rect:["currentX","currentY"],resetTransform:["transform"],rotate:["transform"],scale:["transform"],setAlpha:["globalAlpha"],setCompositeOperation:["globalCompositeOperation"],setFillColor:["fillStyle"],setLineCap:["lineCap"],setLineJoin:["lineJoin"],setLineWidth:["lineWidth"],setMiterLimit:["miterLimit"],setShadow:["shadowOffsetX","shadowOffsetY","shadowBlur","shadowColor"],setStrokeColor:["strokeStyle"],setTransform:["transform"],translate:["transform"]}};WI.RecordingFrame=class{constructor(e,{duration:t,incomplete:i}={}){this._actions=e,this._duration=t||NaN,this._incomplete=i||!1}static fromPayload(e){(typeof e!="object"||e===null)&&(e={}),Array.isArray(e.actions)||("actions"in e&&WI.Recording.synthesizeWarning(WI.UIString("non-array %s").format(WI.unlocalizedString("actions"))),e.actions=[]);let t=e.actions.map(WI.RecordingAction.fromPayload);return new WI.RecordingFrame(t,{duration:e.duration||NaN,incomplete:!!e.incomplete})}get actions(){return this._actions}get duration(){return this._duration}get incomplete(){return this._incomplete}toJSON(){let e={actions:this._actions.map(t=>t.toJSON())};return isNaN(this._duration)||(e.duration=this._duration),this._incomplete&&(e.incomplete=this._incomplete),e}};WI.RecordingInitialStateAction=class extends WI.RecordingAction{constructor(){super(),this._name=WI.UIString("Initial State"),this._valid=!1,this._swizzled=!0}};WI.RecordingState=class{constructor(e,{source:t}={}){this._data=e,this._source=t||null}static fromContext(e,t,i={}){if(e!==WI.Recording.Type.Canvas2D)return null;let n=t.getTransform(),s={};return WI.ImageUtilities.supportsCanvasPathDebugging()&&(s.currentX=t.currentX,s.currentY=t.currentY),s.direction=t.direction,s.fillStyle=t.fillStyle,s.font=t.font,s.globalAlpha=t.globalAlpha,s.globalCompositeOperation=t.globalCompositeOperation,s.imageSmoothingEnabled=t.imageSmoothingEnabled,s.imageSmoothingQuality=t.imageSmoothingQuality,s.lineCap=t.lineCap,s.lineDash=t.getLineDash(),s.lineDashOffset=t.lineDashOffset,s.lineJoin=t.lineJoin,s.lineWidth=t.lineWidth,s.miterLimit=t.miterLimit,s.shadowBlur=t.shadowBlur,s.shadowColor=t.shadowColor,s.shadowOffsetX=t.shadowOffsetX,s.shadowOffsetY=t.shadowOffsetY,s.strokeStyle=t.strokeStyle,s.textAlign=t.textAlign,s.textBaseline=t.textBaseline,s.transform=[n.a,n.b,n.c,n.d,n.e,n.f],s.webkitImageSmoothingEnabled=t.webkitImageSmoothingEnabled,s.webkitLineDash=t.webkitLineDash,s.webkitLineDashOffset=t.webkitLineDashOffset,WI.ImageUtilities.supportsCanvasPathDebugging()&&(s.setPath=[t.getPath()]),new WI.RecordingState(s,i)}static async swizzleInitialState(e,t){if(e.type===WI.Recording.Type.Canvas2D){let a={};for(let[d,p]of Object.entries(t)){let f=parseInt(d);switch(isNaN(f)||(d=await e.swizzle(f,WI.Recording.Swizzle.String)),d){case"setTransform":p=[await e.swizzle(p,WI.Recording.Swizzle.DOMMatrix)];break;case"fillStyle":case"strokeStyle":var[i,n,s]=await Promise.all([e.swizzle(p,WI.Recording.Swizzle.CanvasGradient),e.swizzle(p,WI.Recording.Swizzle.CanvasPattern),e.swizzle(p,WI.Recording.Swizzle.String)]);i&&!n?p=i:n&&!i?p=n:p=s;break;case"direction":case"font":case"globalCompositeOperation":case"imageSmoothingQuality":case"lineCap":case"lineJoin":case"shadowColor":case"textAlign":case"textBaseline":p=await e.swizzle(p,WI.Recording.Swizzle.String);break;case"globalAlpha":case"lineWidth":case"miterLimit":case"shadowOffsetX":case"shadowOffsetY":case"shadowBlur":case"lineDashOffset":p=await e.swizzle(p,WI.Recording.Swizzle.Number);break;case"setPath":p=[await e.swizzle(p[0],WI.Recording.Swizzle.Path2D)];break}p===void 0||Array.isArray(p)&&p.includes(void 0)||(a[d]=p)}return new WI.RecordingState(a)}return null}get source(){return this._source}has(e){return e in this._data}get(e){return this._data[e]}apply(e,t){for(let[i,n]of this)if(i in t&&!(i==="currentX"||i==="currentY"))try{WI.RecordingAction.isFunctionForType(e,i)?t[i](...n):t[i]=n}catch{}}toJSON(){return this._data}[Symbol.iterator](){return Object.entries(this._data)[Symbol.iterator]()}};WI.Redirect=class{constructor(e,t,i,n,s,a,d){console.assert(typeof e=="string"),console.assert(typeof t=="string"),console.assert(typeof i=="object"),console.assert(!isNaN(n)),console.assert(typeof s=="string"),console.assert(typeof a=="object"),console.assert(!isNaN(d)),this._url=e,this._urlComponents=null,this._requestMethod=t,this._requestHeaders=i,this._responseStatusCode=n,this._responseStatusText=s,this._responseHeaders=a,this._timestamp=d}get url(){return this._url}get requestMethod(){return this._requestMethod}get requestHeaders(){return this._requestHeaders}get responseStatusCode(){return this._responseStatusCode}get responseStatusText(){return this._responseStatusText}get responseHeaders(){return this._responseHeaders}get timestamp(){return this._timestamp}get urlComponents(){return this._urlComponents||(this._urlComponents=parseURL(this._url)),this._urlComponents}};WI.RenderingFrameTimelineRecord=class extends WI.TimelineRecord{constructor(e,t){super(WI.TimelineRecord.Type.RenderingFrame,e,t),this._durationByTaskType=new Map,this._frameIndex=-1}static resetFrameIndex(){WI.RenderingFrameTimelineRecord._nextFrameIndex=0}static displayNameForTaskType(e){switch(e){case WI.RenderingFrameTimelineRecord.TaskType.Script:return WI.UIString("Script");case WI.RenderingFrameTimelineRecord.TaskType.Layout:return WI.repeatedUIString.timelineRecordLayout();case WI.RenderingFrameTimelineRecord.TaskType.Paint:return WI.repeatedUIString.timelineRecordPaint();case WI.RenderingFrameTimelineRecord.TaskType.Other:return WI.UIString("Other")}}static taskTypeForTimelineRecord(e){switch(e.type){case WI.TimelineRecord.Type.Script:return WI.RenderingFrameTimelineRecord.TaskType.Script;case WI.TimelineRecord.Type.Layout:return e.eventType===WI.LayoutTimelineRecord.EventType.Paint||e.eventType===WI.LayoutTimelineRecord.EventType.Composite?WI.RenderingFrameTimelineRecord.TaskType.Paint:WI.RenderingFrameTimelineRecord.TaskType.Layout;default:return console.error("Unsupported timeline record type: "+e.type),null}}static fromJSON(e){let{startTime:t,endTime:i}=e,n=new WI.RenderingFrameTimelineRecord(t,i);return n.setupFrameIndex(),n}toJSON(){return{type:this.type,startTime:this.startTime,endTime:this.endTime}}get frameIndex(){return this._frameIndex}get frameNumber(){return this._frameIndex+1}setupFrameIndex(){console.assert(this._frameIndex===-1,"Frame index should only be set once."),!(this._frameIndex>=0)&&(this._frameIndex=WI.RenderingFrameTimelineRecord._nextFrameIndex++)}durationForTask(e){if(this._durationByTaskType.has(e))return this._durationByTaskType.get(e);var t;return e===WI.RenderingFrameTimelineRecord.TaskType.Other?t=this._calculateDurationRemainder():(t=this.children.reduce(function(i,n){if(e!==WI.RenderingFrameTimelineRecord.taskTypeForTimelineRecord(n))return i;var s=n.duration;return n.usesActiveStartTime&&(s-=n.inactiveDuration),i+s},0),e===WI.RenderingFrameTimelineRecord.TaskType.Script&&(t-=this.children.reduce(function(i,n){return n.type===WI.TimelineRecord.Type.Layout&&(n.sourceCodeLocation||n.callFrames)?i+n.duration:i},0))),this._durationByTaskType.set(e,t),t}_calculateDurationRemainder(){return Object.keys(WI.RenderingFrameTimelineRecord.TaskType).reduce((e,t)=>{let i=WI.RenderingFrameTimelineRecord.TaskType[t];return i===WI.RenderingFrameTimelineRecord.TaskType.Other?e:e-this.durationForTask(i)},this.duration)}};WI.RenderingFrameTimelineRecord.TaskType={Script:"rendering-frame-timeline-record-script",Layout:"rendering-frame-timeline-record-layout",Paint:"rendering-frame-timeline-record-paint",Other:"rendering-frame-timeline-record-other"};WI.RenderingFrameTimelineRecord.TypeIdentifier="rendering-frame-timeline-record";WI.RenderingFrameTimelineRecord._nextFrameIndex=0;WI.ResourceCollection=class extends WI.Collection{constructor(e){super(),this._resourceType=e||null,this._resourceURLMap=new Map,this._resourcesTypeMap=new Map}get resourceType(){return this._resourceType}get displayName(){return this._resourceType?WI.Resource.displayNameForType(this._resourceType,!0):WI.UIString("Resources")}objectIsRequiredType(e){return this._resourceType===WI.Resource.Type.Stylesheet&&e instanceof WI.CSSStyleSheet?!0:e instanceof WI.Resource?this._resourceType?e.type===this._resourceType:!0:!1}resourceForURL(e){return this._resourceURLMap.get(e)||null}resourceCollectionForType(e){if(this._resourceType)return console.assert(e===this._resourceType),this;let t=this._resourcesTypeMap.get(e);return t||(t=new WI.ResourceCollection(e),this._resourcesTypeMap.set(e,t)),t}clear(){super.clear(),this._resourceURLMap.clear(),this._resourceType||this._resourcesTypeMap.clear()}itemAdded(e){this._associateWithResource(e)}itemRemoved(e){this._disassociateWithResource(e)}itemsCleared(e){for(let i of e)this._disassociateWithResource(i,!0)}_associateWithResource(e){this._resourceURLMap.set(e.url,e),this._resourceType||this.resourceCollectionForType(e.type).add(e),e.addEventListener(WI.Resource.Event.URLDidChange,this._resourceURLDidChange,this),e.addEventListener(WI.Resource.Event.TypeDidChange,this._resourceTypeDidChange,this)}_disassociateWithResource(e,t){e.removeEventListener(WI.Resource.Event.URLDidChange,this._resourceURLDidChange,this),e.removeEventListener(WI.Resource.Event.TypeDidChange,this._resourceTypeDidChange,this),!t&&(this._resourceType||this.resourceCollectionForType(e.type).remove(e),this._resourceURLMap.delete(e.url))}_resourceURLDidChange(e){let t=e.target;if(console.assert(t instanceof WI.Resource),!(t instanceof WI.Resource))return;let i=e.data.oldURL;console.assert(i),i&&(this._resourceURLMap.set(t.url,t),this._resourceURLMap.delete(i))}_resourceTypeDidChange(e){let t=e.target;if(console.assert(t instanceof WI.Resource),!(t instanceof WI.Resource))return;if(this._resourceType){console.assert(t.type!==this._resourceType),this.remove(t);return}console.assert(e.data.oldType),this.resourceCollectionForType(t.type).add(t)}};WI.ResourceQueryMatch=class{constructor(e,t,i){this._type=e,this._index=t,this._queryIndex=i}get type(){return this._type}get index(){return this._index}get queryIndex(){return this._queryIndex}};WI.ResourceQueryMatch.Type={Normal:Symbol("normal"),Special:Symbol("special")};WI.ResourceQueryResult=class{constructor(e,t,i){console.assert(t.length,"Query matches list can't be empty."),this._resource=e,this._matches=t,this._cookie=i||null}get resource(){return this._resource}get cookie(){return this._cookie}get rank(){return this._rank===void 0&&this._calculateRank(),this._rank}get matchingTextRanges(){return this._matchingTextRanges||(this._matchingTextRanges=this._createMatchingTextRanges()),this._matchingTextRanges}_calculateRank(){function n(d){return d.type===WI.ResourceQueryMatch.Type.Special?5:1}this._rank=0;let s=null,a=null;for(let d of this._matches){this._rank+=10*n(d);let p=s&&s.index===d.index-1;p?(a||(a=s),this._rank+=5*n(a)*(d.index-a.index)):a&&(a=null),s=d,p||(this._rank-=d.index*n(d))}}_createMatchingTextRanges(){if(!this._matches.length)return[];let e=[],t=this._matches[0].index,i=t;for(let n=1;n<this._matches.length;++n){let s=this._matches[n];if(s.index===i+1){i++;continue}e.push(new WI.TextRange(0,t,0,i+1)),t=s.index,i=t}return e.push(new WI.TextRange(0,t,0,i+1)),e}__test_createMatchesMask(){let e=this._resource.displayName,t=-1,i="";for(let n of this._matches){let s=" ".repeat(n.index-t-1);i+=s,i+=e[n.index],t=n.index}return i}};WI.ResourceTimelineRecord=class extends WI.TimelineRecord{constructor(e){super(WI.TimelineRecord.Type.Network),this._resource=e,this._resource.addEventListener(WI.Resource.Event.TimestampsDidChange,this._dispatchUpdatedEvent,this)}static fromJSON(e){let{entry:t,archiveStartTime:i}=e,n=WI.LocalResource.fromHAREntry(t,i);return new WI.ResourceTimelineRecord(n)}toJSON(){const e="";return{type:this.type,archiveStartTime:this._resource.requestSentWalltime-this.startTime,entry:WI.HARBuilder.entry(this._resource,e)}}get resource(){return this._resource}get updatesDynamically(){return!0}get usesActiveStartTime(){return!0}get startTime(){return this._resource.timingData.startTime}get activeStartTime(){return this._resource.timingData.responseStart}get endTime(){return this._resource.timingData.responseEnd}_dispatchUpdatedEvent(){this.dispatchEventToListeners(WI.TimelineRecord.Event.Updated)}};WI.ResourceTimingData=class{constructor(e,t){t=t||{},console.assert(isNaN(t.startTime)||t.startTime<=t.fetchStart),console.assert(isNaN(t.redirectStart)===isNaN(t.redirectEnd)),console.assert(isNaN(t.domainLookupStart)===isNaN(t.domainLookupEnd)),console.assert(isNaN(t.connectStart)===isNaN(t.connectEnd)),this._resource=e,this._startTime=t.startTime||NaN,this._redirectStart=t.redirectStart||NaN,this._redirectEnd=t.redirectEnd||NaN,this._fetchStart=t.fetchStart||NaN,this._domainLookupStart=t.domainLookupStart||NaN,this._domainLookupEnd=t.domainLookupEnd||NaN,this._connectStart=t.connectStart||NaN,this._connectEnd=t.connectEnd||NaN,this._secureConnectionStart=t.secureConnectionStart||NaN,this._requestStart=t.requestStart||NaN,this._responseStart=t.responseStart||NaN,this._responseEnd=t.responseEnd||NaN,this._domainLookupStart>=this._domainLookupEnd&&(this._domainLookupStart=this._domainLookupEnd=NaN),this._connectStart>=this._connectEnd&&(this._connectStart=this._connectEnd=NaN)}static fromPayload(e,t){e=e||{},typeof e.navigationStart=="number"&&(e={});let i=e.startTime,n=e.fetchStart,s=e.redirectStart,a=e.redirectEnd;(isNaN(n)||n<i)&&(n=i),(s<i||s>n||s>a)&&(s=NaN),(a<i||a>n||a<s)&&(a=NaN);function d(f){return f>0?n+f/1e3:NaN}let p={startTime:i,redirectStart:s,redirectEnd:a,fetchStart:n,domainLookupStart:d(e.domainLookupStart),domainLookupEnd:d(e.domainLookupEnd),connectStart:d(e.connectStart),connectEnd:d(e.connectEnd),secureConnectionStart:d(e.secureConnectionStart),requestStart:d(e.requestStart),responseStart:d(e.responseStart),responseEnd:d(e.responseEnd)};return isNaN(p.connectStart)&&!isNaN(p.secureConnectionStart)&&(p.connectStart=p.secureConnectionStart),new WI.ResourceTimingData(t,p)}get startTime(){return this._startTime||this._resource.requestSentTimestamp}get redirectStart(){return this._redirectStart}get redirectEnd(){return this._redirectEnd}get fetchStart(){return this._fetchStart||this._resource.requestSentTimestamp}get domainLookupStart(){return this._domainLookupStart}get domainLookupEnd(){return this._domainLookupEnd}get connectStart(){return this._connectStart}get connectEnd(){return this._connectEnd}get secureConnectionStart(){return this._secureConnectionStart}get requestStart(){return this._requestStart||this._startTime||this._resource.requestSentTimestamp}get responseStart(){return this._responseStart||this._startTime||this._resource.responseReceivedTimestamp||this._resource.finishedOrFailedTimestamp}get responseEnd(){return this._responseEnd||this._resource.finishedOrFailedTimestamp}markResponseEndTime(e){console.assert(typeof e=="number"),console.assert(isNaN(e)||e>=this.startTime,"responseEnd time should be greater than the start time",this.startTime,e),console.assert(isNaN(e)||e>=this.requestStart,"responseEnd time should be greater than the request time",this.requestStart,e),this._responseEnd=e}};WI.Revision=class{apply(){console.error("Needs to be implemented by a subclass.")}revert(){console.error("Needs to be implemented by a subclass.")}copy(){return this}};WI.ScopeChainNode=class{constructor(e,t,i,n,s){console.assert(typeof e=="string"),console.assert(t.every(a=>a instanceof WI.RemoteObject)),e in WI.ScopeChainNode.Type&&(e=WI.ScopeChainNode.Type[e]),this._type=e||null,this._objects=t||[],this._name=i||"",this._location=n||null,this._empty=s||!1}get type(){return this._type}get objects(){return this._objects}get name(){return this._name}get location(){return this._location}get empty(){return this._empty}get hash(){return this._hash?this._hash:(this._hash=this._name,this._location&&(this._hash+=`:${this._location.scriptId}:${this._location.lineNumber}:${this._location.columnNumber}`),this._hash)}convertToLocalScope(){this._type=WI.ScopeChainNode.Type.Local}};WI.ScopeChainNode.Type={Local:"scope-chain-type-local",Global:"scope-chain-type-global",GlobalLexicalEnvironment:"scope-chain-type-global-lexical-environment",With:"scope-chain-type-with",Closure:"scope-chain-type-closure",Catch:"scope-chain-type-catch",FunctionName:"scope-chain-type-function-name",Block:"scope-chain-type-block"};WI.ScriptInstrument=class extends WI.Instrument{get timelineRecordType(){return WI.TimelineRecord.Type.Script}startInstrumentation(e){if(!window.ScriptProfilerAgent){super.startInstrumentation();return}const t=!0;e||ScriptProfilerAgent.startTracking(t)}stopInstrumentation(e){if(!window.ScriptProfilerAgent){super.stopInstrumentation();return}e||ScriptProfilerAgent.stopTracking()}};WI.ScriptSyntaxTree=class{constructor(e,t){console.assert(t&&t instanceof WI.Script,t),this._script=t;try{let i=this._script.sourceType===WI.Script.SourceType.Module?"module":"script",n=esprima.parse(e,{loc:!0,range:!0,sourceType:i});this._syntaxTree=this._createInternalSyntaxTree(n),this._parsedSuccessfully=!0}catch(i){this._parsedSuccessfully=!1,this._syntaxTree=null,console.error("Couldn't parse JavaScript File: "+t.url,i)}}get parsedSuccessfully(){return this._parsedSuccessfully}forEachNode(e){console.assert(this._parsedSuccessfully),this._parsedSuccessfully&&this._recurse(this._syntaxTree,e,this._defaultParserState())}filter(e,t){if(console.assert(t&&this._parsedSuccessfully),!this._parsedSuccessfully)return[];var i=[];function n(s,a){e(s)?i.push(s):a.skipChildNodes=!0}return this._recurse(t,n,this._defaultParserState()),i}containersOfPosition(e){if(console.assert(this._parsedSuccessfully),!this._parsedSuccessfully)return[];let t=[];return this.forEachNode((i,n)=>{i.endPosition.isBefore(e)?n.skipChildNodes=!0:i.startPosition.isAfter(e)?n.shouldStopEarly=!0:t.push(i)}),t}filterByRange(e,t){if(console.assert(this._parsedSuccessfully),!this._parsedSuccessfully)return[];var i=[];function n(s,a){if(s.endPosition.isBefore(e)){a.skipChildNodes=!0;return}if(s.startPosition.isWithin(e,t)){i.push(s);return}s.startPosition.isAfter(t)&&(a.shouldStopEarly=!0)}return this.forEachNode(n),i}containsNonEmptyReturnStatement(e){if(console.assert(e&&this._parsedSuccessfully),!this._parsedSuccessfully)return!1;if(e.attachments._hasNonEmptyReturnStatement!==void 0)return e.attachments._hasNonEmptyReturnStatement;function t(d){return d.type!==WI.ScriptSyntaxTree.NodeType.FunctionExpression&&d.type!==WI.ScriptSyntaxTree.NodeType.FunctionDeclaration&&d.type!==WI.ScriptSyntaxTree.NodeType.ArrowFunctionExpression}var i=this.filter(t,e),n=!1,s=WI.ScriptSyntaxTree.NodeType.ReturnStatement;for(var a of i)if(a.type===s&&a.argument){n=!0;break}return e.attachments._hasNonEmptyReturnStatement=n,n}static functionReturnDivot(e){return console.assert(e.type===WI.ScriptSyntaxTree.NodeType.FunctionDeclaration||e.type===WI.ScriptSyntaxTree.NodeType.FunctionExpression||e.type===WI.ScriptSyntaxTree.NodeType.MethodDefinition||e.type===WI.ScriptSyntaxTree.NodeType.ArrowFunctionExpression),InspectorBackend.domains.DOM.hasEvent("pseudoElementAdded")?e.typeProfilingReturnDivot:e.body.range[0]}updateTypes(e,t){if(console.assert(this._script.target.RuntimeAgent.getRuntimeTypesForVariablesAtOffsets),console.assert(Array.isArray(e)&&this._parsedSuccessfully),!this._parsedSuccessfully)return;var i=[],n=[],s=this._script.id;for(var a of e)switch(a.type){case WI.ScriptSyntaxTree.NodeType.FunctionDeclaration:case WI.ScriptSyntaxTree.NodeType.FunctionExpression:case WI.ScriptSyntaxTree.NodeType.ArrowFunctionExpression:for(var d of a.params)for(var p of this._gatherIdentifiersInDeclaration(d))i.push({typeInformationDescriptor:WI.ScriptSyntaxTree.TypeProfilerSearchDescriptor.NormalExpression,sourceID:s,divot:p.range[0]}),n.push(p);i.push({typeInformationDescriptor:WI.ScriptSyntaxTree.TypeProfilerSearchDescriptor.FunctionReturn,sourceID:s,divot:WI.ScriptSyntaxTree.functionReturnDivot(a)}),n.push(a);break;case WI.ScriptSyntaxTree.NodeType.VariableDeclarator:for(var p of this._gatherIdentifiersInDeclaration(a.id))i.push({typeInformationDescriptor:WI.ScriptSyntaxTree.TypeProfilerSearchDescriptor.NormalExpression,sourceID:s,divot:p.range[0]}),n.push(p);break}console.assert(i.length===n.length);function f(_,b){if(!_){console.assert(b.length===i.length);for(var w=0;w<b.length;w++){var S=n[w],E=WI.TypeDescription.fromPayload(b[w]);i[w].typeInformationDescriptor===WI.ScriptSyntaxTree.TypeProfilerSearchDescriptor.FunctionReturn?S.attachments.returnTypes=E:S.attachments.types=E}t(n)}}this._script.target.RuntimeAgent.getRuntimeTypesForVariablesAtOffsets(i,f)}_gatherIdentifiersInDeclaration(e){function t(i){switch(i.type){case WI.ScriptSyntaxTree.NodeType.Identifier:return[i];case WI.ScriptSyntaxTree.NodeType.Property:return t(i.value);case WI.ScriptSyntaxTree.NodeType.ObjectPattern:var a=[];for(var n of i.properties)for(var s of t(n))a.push(s);return a;case WI.ScriptSyntaxTree.NodeType.ArrayPattern:var a=[];for(var d of i.elements)for(var s of t(d))a.push(s);return a;case WI.ScriptSyntaxTree.NodeType.AssignmentPattern:return t(i.left);case WI.ScriptSyntaxTree.NodeType.RestElement:case WI.ScriptSyntaxTree.NodeType.RestProperty:return t(i.argument);default:return console.assert(!1,"Unexpected node type in variable declarator: "+i.type),[]}}return console.assert(e.type===WI.ScriptSyntaxTree.NodeType.Identifier||e.type===WI.ScriptSyntaxTree.NodeType.ObjectPattern||e.type===WI.ScriptSyntaxTree.NodeType.ArrayPattern||e.type===WI.ScriptSyntaxTree.NodeType.RestElement||e.type===WI.ScriptSyntaxTree.NodeType.RestProperty),t(e)}_defaultParserState(){return{shouldStopEarly:!1,skipChildNodes:!1}}_recurse(e,t,i){if(!!e&&!(i.shouldStopEarly||i.skipChildNodes)){switch(t(e,i),e.type){case WI.ScriptSyntaxTree.NodeType.AssignmentExpression:this._recurse(e.left,t,i),this._recurse(e.right,t,i);break;case WI.ScriptSyntaxTree.NodeType.ArrayExpression:case WI.ScriptSyntaxTree.NodeType.ArrayPattern:this._recurseArray(e.elements,t,i);break;case WI.ScriptSyntaxTree.NodeType.AssignmentPattern:this._recurse(e.left,t,i),this._recurse(e.right,t,i);break;case WI.ScriptSyntaxTree.NodeType.AwaitExpression:this._recurse(e.argument,t,i);break;case WI.ScriptSyntaxTree.NodeType.BlockStatement:this._recurseArray(e.body,t,i);break;case WI.ScriptSyntaxTree.NodeType.BinaryExpression:this._recurse(e.left,t,i),this._recurse(e.right,t,i);break;case WI.ScriptSyntaxTree.NodeType.BreakStatement:this._recurse(e.label,t,i);break;case WI.ScriptSyntaxTree.NodeType.CatchClause:this._recurse(e.param,t,i),this._recurse(e.body,t,i);break;case WI.ScriptSyntaxTree.NodeType.CallExpression:this._recurse(e.callee,t,i),this._recurseArray(e.arguments,t,i);break;case WI.ScriptSyntaxTree.NodeType.ClassBody:this._recurseArray(e.body,t,i);break;case WI.ScriptSyntaxTree.NodeType.ClassDeclaration:case WI.ScriptSyntaxTree.NodeType.ClassExpression:this._recurse(e.id,t,i),this._recurse(e.superClass,t,i),this._recurse(e.body,t,i);break;case WI.ScriptSyntaxTree.NodeType.ContinueStatement:this._recurse(e.label,t,i);break;case WI.ScriptSyntaxTree.NodeType.DoWhileStatement:this._recurse(e.body,t,i),this._recurse(e.test,t,i);break;case WI.ScriptSyntaxTree.NodeType.ExpressionStatement:this._recurse(e.expression,t,i);break;case WI.ScriptSyntaxTree.NodeType.ForStatement:this._recurse(e.init,t,i),this._recurse(e.test,t,i),this._recurse(e.update,t,i),this._recurse(e.body,t,i);break;case WI.ScriptSyntaxTree.NodeType.ForInStatement:case WI.ScriptSyntaxTree.NodeType.ForOfStatement:this._recurse(e.left,t,i),this._recurse(e.right,t,i),this._recurse(e.body,t,i);break;case WI.ScriptSyntaxTree.NodeType.FunctionDeclaration:case WI.ScriptSyntaxTree.NodeType.FunctionExpression:case WI.ScriptSyntaxTree.NodeType.ArrowFunctionExpression:this._recurse(e.id,t,i),this._recurseArray(e.params,t,i),this._recurse(e.body,t,i);break;case WI.ScriptSyntaxTree.NodeType.IfStatement:this._recurse(e.test,t,i),this._recurse(e.consequent,t,i),this._recurse(e.alternate,t,i);break;case WI.ScriptSyntaxTree.NodeType.LabeledStatement:this._recurse(e.label,t,i),this._recurse(e.body,t,i);break;case WI.ScriptSyntaxTree.NodeType.LogicalExpression:this._recurse(e.left,t,i),this._recurse(e.right,t,i);break;case WI.ScriptSyntaxTree.NodeType.MemberExpression:this._recurse(e.object,t,i),this._recurse(e.property,t,i);break;case WI.ScriptSyntaxTree.NodeType.MethodDefinition:this._recurse(e.key,t,i),this._recurse(e.value,t,i);break;case WI.ScriptSyntaxTree.NodeType.NewExpression:this._recurse(e.callee,t,i),this._recurseArray(e.arguments,t,i);break;case WI.ScriptSyntaxTree.NodeType.ObjectExpression:case WI.ScriptSyntaxTree.NodeType.ObjectPattern:this._recurseArray(e.properties,t,i);break;case WI.ScriptSyntaxTree.NodeType.Program:this._recurseArray(e.body,t,i);break;case WI.ScriptSyntaxTree.NodeType.Property:this._recurse(e.key,t,i),this._recurse(e.value,t,i);break;case WI.ScriptSyntaxTree.NodeType.RestElement:this._recurse(e.argument,t,i);break;case WI.ScriptSyntaxTree.NodeType.RestProperty:this._recurse(e.argument,t,i);break;case WI.ScriptSyntaxTree.NodeType.ReturnStatement:this._recurse(e.argument,t,i);break;case WI.ScriptSyntaxTree.NodeType.SequenceExpression:this._recurseArray(e.expressions,t,i);break;case WI.ScriptSyntaxTree.NodeType.SpreadElement:this._recurse(e.argument,t,i);break;case WI.ScriptSyntaxTree.NodeType.SpreadProperty:this._recurse(e.argument,t,i);break;case WI.ScriptSyntaxTree.NodeType.SwitchStatement:this._recurse(e.discriminant,t,i),this._recurseArray(e.cases,t,i);break;case WI.ScriptSyntaxTree.NodeType.SwitchCase:this._recurse(e.test,t,i),this._recurseArray(e.consequent,t,i);break;case WI.ScriptSyntaxTree.NodeType.ConditionalExpression:this._recurse(e.test,t,i),this._recurse(e.consequent,t,i),this._recurse(e.alternate,t,i);break;case WI.ScriptSyntaxTree.NodeType.TaggedTemplateExpression:this._recurse(e.tag,t,i),this._recurse(e.quasi,t,i);break;case WI.ScriptSyntaxTree.NodeType.TemplateLiteral:this._recurseArray(e.quasis,t,i),this._recurseArray(e.expressions,t,i);break;case WI.ScriptSyntaxTree.NodeType.ThrowStatement:this._recurse(e.argument,t,i);break;case WI.ScriptSyntaxTree.NodeType.TryStatement:this._recurse(e.block,t,i),this._recurse(e.handler,t,i),this._recurse(e.finalizer,t,i);break;case WI.ScriptSyntaxTree.NodeType.UnaryExpression:this._recurse(e.argument,t,i);break;case WI.ScriptSyntaxTree.NodeType.UpdateExpression:this._recurse(e.argument,t,i);break;case WI.ScriptSyntaxTree.NodeType.VariableDeclaration:this._recurseArray(e.declarations,t,i);break;case WI.ScriptSyntaxTree.NodeType.VariableDeclarator:this._recurse(e.id,t,i),this._recurse(e.init,t,i);break;case WI.ScriptSyntaxTree.NodeType.WhileStatement:this._recurse(e.test,t,i),this._recurse(e.body,t,i);break;case WI.ScriptSyntaxTree.NodeType.WithStatement:this._recurse(e.object,t,i),this._recurse(e.body,t,i);break;case WI.ScriptSyntaxTree.NodeType.YieldExpression:this._recurse(e.argument,t,i);break;case WI.ScriptSyntaxTree.NodeType.ExportAllDeclaration:this._recurse(e.source,t,i);break;case WI.ScriptSyntaxTree.NodeType.ExportNamedDeclaration:this._recurse(e.declaration,t,i),this._recurseArray(e.specifiers,t,i),this._recurse(e.source,t,i);break;case WI.ScriptSyntaxTree.NodeType.ExportDefaultDeclaration:this._recurse(e.declaration,t,i);break;case WI.ScriptSyntaxTree.NodeType.ExportSpecifier:this._recurse(e.local,t,i),this._recurse(e.exported,t,i);break;case WI.ScriptSyntaxTree.NodeType.ImportDeclaration:this._recurseArray(e.specifiers,t,i),this._recurse(e.source,t,i);break;case WI.ScriptSyntaxTree.NodeType.ImportDefaultSpecifier:this._recurse(e.local,t,i);break;case WI.ScriptSyntaxTree.NodeType.ImportNamespaceSpecifier:this._recurse(e.local,t,i);break;case WI.ScriptSyntaxTree.NodeType.ImportSpecifier:this._recurse(e.imported,t,i),this._recurse(e.local,t,i);break;case WI.ScriptSyntaxTree.NodeType.DebuggerStatement:case WI.ScriptSyntaxTree.NodeType.EmptyStatement:case WI.ScriptSyntaxTree.NodeType.Identifier:case WI.ScriptSyntaxTree.NodeType.Import:case WI.ScriptSyntaxTree.NodeType.Literal:case WI.ScriptSyntaxTree.NodeType.MetaProperty:case WI.ScriptSyntaxTree.NodeType.Super:case WI.ScriptSyntaxTree.NodeType.ThisExpression:case WI.ScriptSyntaxTree.NodeType.TemplateElement:break}i.skipChildNodes=!1}}_recurseArray(e,t,i){for(var n of e)this._recurse(n,t,i)}_createInternalSyntaxTree(e){if(!e)return null;var t=null;switch(e.type){case"ArrayExpression":t={type:WI.ScriptSyntaxTree.NodeType.ArrayExpression,elements:e.elements.map(this._createInternalSyntaxTree,this)};break;case"ArrayPattern":t={type:WI.ScriptSyntaxTree.NodeType.ArrayPattern,elements:e.elements.map(this._createInternalSyntaxTree,this)};break;case"ArrowFunctionExpression":t={type:WI.ScriptSyntaxTree.NodeType.ArrowFunctionExpression,id:this._createInternalSyntaxTree(e.id),params:e.params.map(this._createInternalSyntaxTree,this),body:this._createInternalSyntaxTree(e.body),generator:e.generator,expression:e.expression,async:e.async,typeProfilingReturnDivot:e.range[0]};break;case"AssignmentExpression":t={type:WI.ScriptSyntaxTree.NodeType.AssignmentExpression,operator:e.operator,left:this._createInternalSyntaxTree(e.left),right:this._createInternalSyntaxTree(e.right)};break;case"AssignmentPattern":t={type:WI.ScriptSyntaxTree.NodeType.AssignmentPattern,left:this._createInternalSyntaxTree(e.left),right:this._createInternalSyntaxTree(e.right)};break;case"AwaitExpression":t={type:WI.ScriptSyntaxTree.NodeType.AwaitExpression,argument:this._createInternalSyntaxTree(e.argument)};break;case"BlockStatement":t={type:WI.ScriptSyntaxTree.NodeType.BlockStatement,body:e.body.map(this._createInternalSyntaxTree,this)};break;case"BinaryExpression":t={type:WI.ScriptSyntaxTree.NodeType.BinaryExpression,operator:e.operator,left:this._createInternalSyntaxTree(e.left),right:this._createInternalSyntaxTree(e.right)};break;case"BreakStatement":t={type:WI.ScriptSyntaxTree.NodeType.BreakStatement,label:this._createInternalSyntaxTree(e.label)};break;case"CallExpression":t={type:WI.ScriptSyntaxTree.NodeType.CallExpression,callee:this._createInternalSyntaxTree(e.callee),arguments:e.arguments.map(this._createInternalSyntaxTree,this)};break;case"CatchClause":t={type:WI.ScriptSyntaxTree.NodeType.CatchClause,param:this._createInternalSyntaxTree(e.param),body:this._createInternalSyntaxTree(e.body)};break;case"ClassBody":t={type:WI.ScriptSyntaxTree.NodeType.ClassBody,body:e.body.map(this._createInternalSyntaxTree,this)};break;case"ClassDeclaration":t={type:WI.ScriptSyntaxTree.NodeType.ClassDeclaration,id:this._createInternalSyntaxTree(e.id),superClass:this._createInternalSyntaxTree(e.superClass),body:this._createInternalSyntaxTree(e.body)};break;case"ClassExpression":t={type:WI.ScriptSyntaxTree.NodeType.ClassExpression,id:this._createInternalSyntaxTree(e.id),superClass:this._createInternalSyntaxTree(e.superClass),body:this._createInternalSyntaxTree(e.body)};break;case"ConditionalExpression":t={type:WI.ScriptSyntaxTree.NodeType.ConditionalExpression,test:this._createInternalSyntaxTree(e.test),consequent:this._createInternalSyntaxTree(e.consequent),alternate:this._createInternalSyntaxTree(e.alternate)};break;case"ContinueStatement":t={type:WI.ScriptSyntaxTree.NodeType.ContinueStatement,label:this._createInternalSyntaxTree(e.label)};break;case"DoWhileStatement":t={type:WI.ScriptSyntaxTree.NodeType.DoWhileStatement,body:this._createInternalSyntaxTree(e.body),test:this._createInternalSyntaxTree(e.test)};break;case"DebuggerStatement":t={type:WI.ScriptSyntaxTree.NodeType.DebuggerStatement};break;case"EmptyStatement":t={type:WI.ScriptSyntaxTree.NodeType.EmptyStatement};break;case"ExpressionStatement":t={type:WI.ScriptSyntaxTree.NodeType.ExpressionStatement,expression:this._createInternalSyntaxTree(e.expression)};break;case"ForStatement":t={type:WI.ScriptSyntaxTree.NodeType.ForStatement,init:this._createInternalSyntaxTree(e.init),test:this._createInternalSyntaxTree(e.test),update:this._createInternalSyntaxTree(e.update),body:this._createInternalSyntaxTree(e.body)};break;case"ForInStatement":t={type:WI.ScriptSyntaxTree.NodeType.ForInStatement,left:this._createInternalSyntaxTree(e.left),right:this._createInternalSyntaxTree(e.right),body:this._createInternalSyntaxTree(e.body)};break;case"ForOfStatement":t={type:WI.ScriptSyntaxTree.NodeType.ForOfStatement,left:this._createInternalSyntaxTree(e.left),right:this._createInternalSyntaxTree(e.right),body:this._createInternalSyntaxTree(e.body)};break;case"FunctionDeclaration":t={type:WI.ScriptSyntaxTree.NodeType.FunctionDeclaration,id:this._createInternalSyntaxTree(e.id),params:e.params.map(this._createInternalSyntaxTree,this),body:this._createInternalSyntaxTree(e.body),generator:e.generator,async:e.async,typeProfilingReturnDivot:e.range[0]};break;case"FunctionExpression":t={type:WI.ScriptSyntaxTree.NodeType.FunctionExpression,id:this._createInternalSyntaxTree(e.id),params:e.params.map(this._createInternalSyntaxTree,this),body:this._createInternalSyntaxTree(e.body),generator:e.generator,async:e.async,typeProfilingReturnDivot:e.range[0]};break;case"Identifier":t={type:WI.ScriptSyntaxTree.NodeType.Identifier,name:e.name};break;case"IfStatement":t={type:WI.ScriptSyntaxTree.NodeType.IfStatement,test:this._createInternalSyntaxTree(e.test),consequent:this._createInternalSyntaxTree(e.consequent),alternate:this._createInternalSyntaxTree(e.alternate)};break;case"Literal":t={type:WI.ScriptSyntaxTree.NodeType.Literal,value:e.value,raw:e.raw};break;case"LabeledStatement":t={type:WI.ScriptSyntaxTree.NodeType.LabeledStatement,label:this._createInternalSyntaxTree(e.label),body:this._createInternalSyntaxTree(e.body)};break;case"LogicalExpression":t={type:WI.ScriptSyntaxTree.NodeType.LogicalExpression,left:this._createInternalSyntaxTree(e.left),right:this._createInternalSyntaxTree(e.right),operator:e.operator};break;case"MemberExpression":t={type:WI.ScriptSyntaxTree.NodeType.MemberExpression,object:this._createInternalSyntaxTree(e.object),property:this._createInternalSyntaxTree(e.property),computed:e.computed};break;case"MetaProperty":t={type:WI.ScriptSyntaxTree.NodeType.MetaProperty,meta:this._createInternalSyntaxTree(e.meta),property:this._createInternalSyntaxTree(e.property)};break;case"MethodDefinition":t={type:WI.ScriptSyntaxTree.NodeType.MethodDefinition,key:this._createInternalSyntaxTree(e.key),value:this._createInternalSyntaxTree(e.value),computed:e.computed,kind:e.kind,static:e.static},t.value.typeProfilingReturnDivot=e.range[0];break;case"NewExpression":t={type:WI.ScriptSyntaxTree.NodeType.NewExpression,callee:this._createInternalSyntaxTree(e.callee),arguments:e.arguments.map(this._createInternalSyntaxTree,this)};break;case"ObjectExpression":t={type:WI.ScriptSyntaxTree.NodeType.ObjectExpression,properties:e.properties.map(this._createInternalSyntaxTree,this)};break;case"ObjectPattern":t={type:WI.ScriptSyntaxTree.NodeType.ObjectPattern,properties:e.properties.map(this._createInternalSyntaxTree,this)};break;case"Program":t={type:WI.ScriptSyntaxTree.NodeType.Program,sourceType:e.sourceType,body:e.body.map(this._createInternalSyntaxTree,this)};break;case"Property":t={type:WI.ScriptSyntaxTree.NodeType.Property,key:this._createInternalSyntaxTree(e.key),value:this._createInternalSyntaxTree(e.value),kind:e.kind,method:e.method,computed:e.computed},(t.kind==="get"||t.kind==="set"||t.method)&&(t.value.typeProfilingReturnDivot=e.range[0]);break;case"RestElement":t={type:WI.ScriptSyntaxTree.NodeType.RestElement,argument:this._createInternalSyntaxTree(e.argument)};break;case"RestProperty":t={type:WI.ScriptSyntaxTree.NodeType.RestProperty,argument:this._createInternalSyntaxTree(e.argument)};break;case"ReturnStatement":t={type:WI.ScriptSyntaxTree.NodeType.ReturnStatement,argument:this._createInternalSyntaxTree(e.argument)};break;case"SequenceExpression":t={type:WI.ScriptSyntaxTree.NodeType.SequenceExpression,expressions:e.expressions.map(this._createInternalSyntaxTree,this)};break;case"SpreadElement":t={type:WI.ScriptSyntaxTree.NodeType.SpreadElement,argument:this._createInternalSyntaxTree(e.argument)};break;case"SpreadProperty":t={type:WI.ScriptSyntaxTree.NodeType.SpreadProperty,argument:this._createInternalSyntaxTree(e.argument)};break;case"Super":t={type:WI.ScriptSyntaxTree.NodeType.Super};break;case"SwitchStatement":t={type:WI.ScriptSyntaxTree.NodeType.SwitchStatement,discriminant:this._createInternalSyntaxTree(e.discriminant),cases:e.cases.map(this._createInternalSyntaxTree,this)};break;case"SwitchCase":t={type:WI.ScriptSyntaxTree.NodeType.SwitchCase,test:this._createInternalSyntaxTree(e.test),consequent:e.consequent.map(this._createInternalSyntaxTree,this)};break;case"TaggedTemplateExpression":t={type:WI.ScriptSyntaxTree.NodeType.TaggedTemplateExpression,tag:this._createInternalSyntaxTree(e.tag),quasi:this._createInternalSyntaxTree(e.quasi)};break;case"TemplateElement":t={type:WI.ScriptSyntaxTree.NodeType.TemplateElement,value:e.value,tail:e.tail};break;case"TemplateLiteral":t={type:WI.ScriptSyntaxTree.NodeType.TemplateLiteral,quasis:e.quasis.map(this._createInternalSyntaxTree,this),expressions:e.expressions.map(this._createInternalSyntaxTree,this)};break;case"ThisExpression":t={type:WI.ScriptSyntaxTree.NodeType.ThisExpression};break;case"ThrowStatement":t={type:WI.ScriptSyntaxTree.NodeType.ThrowStatement,argument:this._createInternalSyntaxTree(e.argument)};break;case"TryStatement":t={type:WI.ScriptSyntaxTree.NodeType.TryStatement,block:this._createInternalSyntaxTree(e.block),handler:this._createInternalSyntaxTree(e.handler),finalizer:this._createInternalSyntaxTree(e.finalizer)};break;case"UnaryExpression":t={type:WI.ScriptSyntaxTree.NodeType.UnaryExpression,operator:e.operator,argument:this._createInternalSyntaxTree(e.argument)};break;case"UpdateExpression":t={type:WI.ScriptSyntaxTree.NodeType.UpdateExpression,operator:e.operator,prefix:e.prefix,argument:this._createInternalSyntaxTree(e.argument)};break;case"VariableDeclaration":t={type:WI.ScriptSyntaxTree.NodeType.VariableDeclaration,declarations:e.declarations.map(this._createInternalSyntaxTree,this),kind:e.kind};break;case"VariableDeclarator":t={type:WI.ScriptSyntaxTree.NodeType.VariableDeclarator,id:this._createInternalSyntaxTree(e.id),init:this._createInternalSyntaxTree(e.init)};break;case"WhileStatement":t={type:WI.ScriptSyntaxTree.NodeType.WhileStatement,test:this._createInternalSyntaxTree(e.test),body:this._createInternalSyntaxTree(e.body)};break;case"WithStatement":t={type:WI.ScriptSyntaxTree.NodeType.WithStatement,object:this._createInternalSyntaxTree(e.object),body:this._createInternalSyntaxTree(e.body)};break;case"YieldExpression":t={type:WI.ScriptSyntaxTree.NodeType.YieldExpression,argument:this._createInternalSyntaxTree(e.argument),delegate:e.delegate};break;case"ExportAllDeclaration":t={type:WI.ScriptSyntaxTree.NodeType.ExportAllDeclaration,source:this._createInternalSyntaxTree(e.source)};break;case"ExportNamedDeclaration":t={type:WI.ScriptSyntaxTree.NodeType.ExportNamedDeclaration,declaration:this._createInternalSyntaxTree(e.declaration),specifiers:e.specifiers.map(this._createInternalSyntaxTree,this),source:this._createInternalSyntaxTree(e.source)};break;case"ExportDefaultDeclaration":t={type:WI.ScriptSyntaxTree.NodeType.ExportDefaultDeclaration,declaration:this._createInternalSyntaxTree(e.declaration)};break;case"ExportSpecifier":t={type:WI.ScriptSyntaxTree.NodeType.ExportSpecifier,local:this._createInternalSyntaxTree(e.local),exported:this._createInternalSyntaxTree(e.exported)};break;case"Import":t={type:WI.ScriptSyntaxTree.NodeType.Import};break;case"ImportDeclaration":t={type:WI.ScriptSyntaxTree.NodeType.ImportDeclaration,specifiers:e.specifiers.map(this._createInternalSyntaxTree,this),source:this._createInternalSyntaxTree(e.source)};break;case"ImportDefaultSpecifier":t={type:WI.ScriptSyntaxTree.NodeType.ImportDefaultSpecifier,local:this._createInternalSyntaxTree(e.local)};break;case"ImportNamespaceSpecifier":t={type:WI.ScriptSyntaxTree.NodeType.ImportNamespaceSpecifier,local:this._createInternalSyntaxTree(e.local)};break;case"ImportSpecifier":t={type:WI.ScriptSyntaxTree.NodeType.ImportSpecifier,imported:this._createInternalSyntaxTree(e.imported),local:this._createInternalSyntaxTree(e.local)};break;default:return console.error("Unsupported Syntax Tree Node: "+e.type,e),null}let{start:i,end:n}=e.loc;return t.startPosition=new WI.SourceCodePosition(i.line-1,i.column),t.endPosition=new WI.SourceCodePosition(n.line-1,n.column),t.range=e.range,t.attachments={},t}};WI.ScriptSyntaxTree.TypeProfilerSearchDescriptor={NormalExpression:1,FunctionReturn:2};WI.ScriptSyntaxTree.NodeType={ArrayExpression:Symbol("array-expression"),ArrayPattern:Symbol("array-pattern"),ArrowFunctionExpression:Symbol("arrow-function-expression"),AssignmentExpression:Symbol("assignment-expression"),AssignmentPattern:Symbol("assignment-pattern"),AwaitExpression:Symbol("await-expression"),BinaryExpression:Symbol("binary-expression"),BlockStatement:Symbol("block-statement"),BreakStatement:Symbol("break-statement"),CallExpression:Symbol("call-expression"),CatchClause:Symbol("catch-clause"),ClassBody:Symbol("class-body"),ClassDeclaration:Symbol("class-declaration"),ClassExpression:Symbol("class-expression"),ConditionalExpression:Symbol("conditional-expression"),ContinueStatement:Symbol("continue-statement"),DebuggerStatement:Symbol("debugger-statement"),DoWhileStatement:Symbol("do-while-statement"),EmptyStatement:Symbol("empty-statement"),ExportAllDeclaration:Symbol("export-all-declaration"),ExportDefaultDeclaration:Symbol("export-default-declaration"),ExportNamedDeclaration:Symbol("export-named-declaration"),ExportSpecifier:Symbol("export-specifier"),ExpressionStatement:Symbol("expression-statement"),ForInStatement:Symbol("for-in-statement"),ForOfStatement:Symbol("for-of-statement"),ForStatement:Symbol("for-statement"),FunctionDeclaration:Symbol("function-declaration"),FunctionExpression:Symbol("function-expression"),Identifier:Symbol("identifier"),IfStatement:Symbol("if-statement"),Import:Symbol("import"),ImportDeclaration:Symbol("import-declaration"),ImportDefaultSpecifier:Symbol("import-default-specifier"),ImportNamespaceSpecifier:Symbol("import-namespace-specifier"),ImportSpecifier:Symbol("import-specifier"),LabeledStatement:Symbol("labeled-statement"),Literal:Symbol("literal"),LogicalExpression:Symbol("logical-expression"),MemberExpression:Symbol("member-expression"),MetaProperty:Symbol("meta-property"),MethodDefinition:Symbol("method-definition"),NewExpression:Symbol("new-expression"),ObjectExpression:Symbol("object-expression"),ObjectPattern:Symbol("object-pattern"),Program:Symbol("program"),Property:Symbol("property"),RestElement:Symbol("rest-element"),RestProperty:Symbol("rest-property"),ReturnStatement:Symbol("return-statement"),SequenceExpression:Symbol("sequence-expression"),SpreadElement:Symbol("spread-element"),SpreadProperty:Symbol("spread-property"),Super:Symbol("super"),SwitchCase:Symbol("switch-case"),SwitchStatement:Symbol("switch-statement"),TaggedTemplateExpression:Symbol("tagged-template-expression"),TemplateElement:Symbol("template-element"),TemplateLiteral:Symbol("template-literal"),ThisExpression:Symbol("this-expression"),ThrowStatement:Symbol("throw-statement"),TryStatement:Symbol("try-statement"),UnaryExpression:Symbol("unary-expression"),UpdateExpression:Symbol("update-expression"),VariableDeclaration:Symbol("variable-declaration"),VariableDeclarator:Symbol("variable-declarator"),WhileStatement:Symbol("while-statement"),WithStatement:Symbol("with-statement"),YieldExpression:Symbol("yield-expression")};WI.ScriptTimelineRecord=class extends WI.TimelineRecord{constructor(e,t,i,n,s,a,d,p){super(WI.TimelineRecord.Type.Script,t,i,n,s),console.assert(e),e in WI.ScriptTimelineRecord.EventType&&(e=WI.ScriptTimelineRecord.EventType[e]),this._eventType=e,this._details=a||"",this._profilePayload=d||null,this._profile=null,this._extraDetails=p||null,window.ScriptProfilerAgent?this._callCountOrSamples=0:this._callCountOrSamples=NaN}static fromJSON(e){let{eventType:t,startTime:i,endTime:n,callFrames:s,sourceCodeLocation:a,details:d,profilePayload:p,extraDetails:f}=e;return typeof d=="object"&&d.__type==="GarbageCollection"&&(d=WI.GarbageCollection.fromJSON(d)),new WI.ScriptTimelineRecord(t,i,n,s,a,d,p,f)}toJSON(){return{type:this.type,eventType:this._eventType,startTime:this.startTime,endTime:this.endTime,details:this._details,extraDetails:this._extraDetails}}get eventType(){return this._eventType}get details(){return this._details}get extraDetails(){return this._extraDetails}get callCountOrSamples(){return this._callCountOrSamples}get profile(){return this._initializeProfileFromPayload(),this._profile}isGarbageCollection(){return this._eventType===WI.ScriptTimelineRecord.EventType.GarbageCollected}saveIdentityToCookie(e){super.saveIdentityToCookie(e),e[WI.ScriptTimelineRecord.EventTypeCookieKey]=this._eventType,e[WI.ScriptTimelineRecord.DetailsCookieKey]=this._details}get profilePayload(){return this._profilePayload}set profilePayload(e){this._profilePayload=e}_initializeProfileFromPayload(t){if(this._profile||!this._profilePayload)return;var t=this._profilePayload;this._profilePayload=void 0,console.assert(t.rootNodes instanceof Array);function i(f){if(console.assert("id"in f),f.url){var _=WI.networkManager.resourceForURL(f.url);_||(_=WI.debuggerManager.scriptsForURL(f.url,WI.assumingMainTarget())[0]);var b=f.lineNumber-1,w=_?_.createLazySourceCodeLocation(b,f.columnNumber):null}var S=f.functionName==="(program)",E=f.functionName==="(anonymous function)",k=S?WI.ProfileNode.Type.Program:WI.ProfileNode.Type.Function,R=!S&&!E&&f.functionName!=="(unknown)"?f.functionName:null,M=null;return"calls"in f&&(console.assert(f.calls instanceof Array),M=f.calls.map(n)),new WI.ProfileNode(f.id,k,R,w,f.callInfo,M,f.children)}function n(f){console.assert("startTime"in f),console.assert("totalTime"in f);var _=WI.timelineManager.computeElapsedTime(f.startTime);return new WI.ProfileNodeCall(_,f.totalTime)}for(var s=t.rootNodes,a=[{parent:{children:s},index:0,root:!0}];a.length;){var d=a.lastValue;if(d.index<d.parent.children.length){var p=d.parent.children[d.index];p.children&&p.children.length&&a.push({parent:p,index:0}),++d.index}else d.root?s=s.map(i):d.parent.children=d.parent.children.map(i),a.pop()}if(window.ScriptProfilerAgent)for(let f=0;f<s.length;f++)this._callCountOrSamples+=s[f].callInfo.callCount;this._profile=new WI.Profile(s)}};WI.ScriptTimelineRecord.EventType={ScriptEvaluated:"script-evaluated",APIScriptEvaluated:"api-script-evaluated",MicrotaskDispatched:"microtask-dispatched",EventDispatched:"event-dispatched",ProbeSampleRecorded:"probe-sample-recorded",TimerFired:"timer-fired",TimerInstalled:"timer-installed",TimerRemoved:"timer-removed",AnimationFrameFired:"animation-frame-fired",AnimationFrameRequested:"animation-frame-requested",AnimationFrameCanceled:"animation-frame-canceled",ObserverCallback:"observer-callback",ConsoleProfileRecorded:"console-profile-recorded",GarbageCollected:"garbage-collected"};WI.ScriptTimelineRecord.EventType.displayName=function(c,e,t){if(e&&!WI.ScriptTimelineRecord._eventDisplayNames){var i=new Map;i.set("DOMActivate","DOM Activate"),i.set("DOMCharacterDataModified","DOM Character Data Modified"),i.set("DOMContentLoaded","DOM Content Loaded"),i.set("DOMFocusIn","DOM Focus In"),i.set("DOMFocusOut","DOM Focus Out"),i.set("DOMNodeInserted","DOM Node Inserted"),i.set("DOMNodeInsertedIntoDocument","DOM Node Inserted Into Document"),i.set("DOMNodeRemoved","DOM Node Removed"),i.set("DOMNodeRemovedFromDocument","DOM Node Removed From Document"),i.set("DOMSubtreeModified","DOM Sub-Tree Modified"),i.set("addsourcebuffer","Add Source Buffer"),i.set("addstream","Add Stream"),i.set("addtrack","Add Track"),i.set("animationend","Animation End"),i.set("animationiteration","Animation Iteration"),i.set("animationstart","Animation Start"),i.set("audioend","Audio End"),i.set("audioprocess","Audio Process"),i.set("audiostart","Audio Start"),i.set("beforecopy","Before Copy"),i.set("beforecut","Before Cut"),i.set("beforeload","Before Load"),i.set("beforepaste","Before Paste"),i.set("beforeunload","Before Unload"),i.set("canplay","Can Play"),i.set("canplaythrough","Can Play Through"),i.set("chargingchange","Charging Change"),i.set("chargingtimechange","Charging Time Change"),i.set("compositionend","Composition End"),i.set("compositionstart","Composition Start"),i.set("compositionupdate","Composition Update"),i.set("contextmenu","Context Menu"),i.set("cuechange","Cue Change"),i.set("datachannel","Data Channel"),i.set("dblclick","Double Click"),i.set("devicemotion","Device Motion"),i.set("deviceorientation","Device Orientation"),i.set("dischargingtimechange","Discharging Time Change"),i.set("dragend","Drag End"),i.set("dragenter","Drag Enter"),i.set("dragleave","Drag Leave"),i.set("dragover","Drag Over"),i.set("dragstart","Drag Start"),i.set("durationchange","Duration Change"),i.set("focusin","Focus In"),i.set("focusout","Focus Out"),i.set("gesturechange","Gesture Change"),i.set("gestureend","Gesture End"),i.set("gesturescrollend","Gesture Scroll End"),i.set("gesturescrollstart","Gesture Scroll Start"),i.set("gesturescrollupdate","Gesture Scroll Update"),i.set("gesturestart","Gesture Start"),i.set("gesturetap","Gesture Tap"),i.set("gesturetapdown","Gesture Tap Down"),i.set("hashchange","Hash Change"),i.set("icecandidate","ICE Candidate"),i.set("iceconnectionstatechange","ICE Connection State Change"),i.set("keydown","Key Down"),i.set("keypress","Key Press"),i.set("keyup","Key Up"),i.set("levelchange","Level Change"),i.set("loadeddata","Loaded Data"),i.set("loadedmetadata","Loaded Metadata"),i.set("loadend","Load End"),i.set("loadingdone","Loading Done"),i.set("loadstart","Load Start"),i.set("mousedown","Mouse Down"),i.set("mouseenter","Mouse Enter"),i.set("mouseleave","Mouse Leave"),i.set("mousemove","Mouse Move"),i.set("mouseout","Mouse Out"),i.set("mouseover","Mouse Over"),i.set("mouseup","Mouse Up"),i.set("mousewheel","Mouse Wheel"),i.set("negotiationneeded","Negotiation Needed"),i.set("nomatch","No Match"),i.set("noupdate","No Update"),i.set("orientationchange","Orientation Change"),i.set("overflowchanged","Overflow Changed"),i.set("pagehide","Page Hide"),i.set("pageshow","Page Show"),i.set("popstate","Pop State"),i.set("ratechange","Rate Change"),i.set("readystatechange","Ready State Change"),i.set("removesourcebuffer","Remove Source Buffer"),i.set("removestream","Remove Stream"),i.set("removetrack","Remove Track"),i.set("resize","Resize"),i.set("securitypolicyviolation","Security Policy Violation"),i.set("selectionchange","Selection Change"),i.set("selectstart","Select Start"),i.set("signalingstatechange","Signaling State Change"),i.set("soundend","Sound End"),i.set("soundstart","Sound Start"),i.set("sourceclose","Source Close"),i.set("sourceended","Source Ended"),i.set("sourceopen","Source Open"),i.set("speechend","Speech End"),i.set("speechstart","Speech Start"),i.set("textInput","Text Input"),i.set("timeupdate","Time Update"),i.set("tonechange","Tone Change"),i.set("touchcancel","Touch Cancel"),i.set("touchend","Touch End"),i.set("touchmove","Touch Move"),i.set("touchstart","Touch Start"),i.set("transitionend","Transition End"),i.set("updateend","Update End"),i.set("updateready","Update Ready"),i.set("updatestart","Update Start"),i.set("upgradeneeded","Upgrade Needed"),i.set("versionchange","Version Change"),i.set("visibilitychange","Visibility Change"),i.set("volumechange","Volume Change"),i.set("webglcontextcreationerror","WebGL Context Creation Error"),i.set("webglcontextlost","WebGL Context Lost"),i.set("webglcontextrestored","WebGL Context Restored"),i.set("webkitAnimationEnd","Animation End"),i.set("webkitAnimationIteration","Animation Iteration"),i.set("webkitAnimationStart","Animation Start"),i.set("webkitBeforeTextInserted","Before Text Inserted"),i.set("webkitEditableContentChanged","Editable Content Changed"),i.set("webkitTransitionEnd","Transition End"),i.set("webkitaddsourcebuffer","Add Source Buffer"),i.set("webkitbeginfullscreen","Begin Full-Screen"),i.set("webkitcurrentplaybacktargetiswirelesschanged","Current Playback Target Is Wireless Changed"),i.set("webkitendfullscreen","End Full-Screen"),i.set("webkitfullscreenchange","Full-Screen Change"),i.set("webkitfullscreenerror","Full-Screen Error"),i.set("webkitkeyadded","Key Added"),i.set("webkitkeyerror","Key Error"),i.set("webkitkeymessage","Key Message"),i.set("webkitneedkey","Need Key"),i.set("webkitnetworkinfochange","Network Info Change"),i.set("webkitplaybacktargetavailabilitychanged","Playback Target Availability Changed"),i.set("webkitpointerlockchange","Pointer Lock Change"),i.set("webkitpointerlockerror","Pointer Lock Error"),i.set("webkitregionoversetchange","Region Overset Change"),i.set("webkitremovesourcebuffer","Remove Source Buffer"),i.set("webkitresourcetimingbufferfull","Resource Timing Buffer Full"),i.set("webkitsourceclose","Source Close"),i.set("webkitsourceended","Source Ended"),i.set("webkitsourceopen","Source Open"),i.set("webkitspeechchange","Speech Change"),i.set("writeend","Write End"),i.set("writestart","Write Start"),WI.ScriptTimelineRecord._eventDisplayNames=i}switch(c){case WI.ScriptTimelineRecord.EventType.ScriptEvaluated:case WI.ScriptTimelineRecord.EventType.APIScriptEvaluated:return WI.UIString("Script Evaluated");case WI.ScriptTimelineRecord.EventType.MicrotaskDispatched:return WI.UIString("Microtask Dispatched");case WI.ScriptTimelineRecord.EventType.EventDispatched:if(e&&(e instanceof String||typeof e=="string")){var n=WI.ScriptTimelineRecord._eventDisplayNames.get(e)||e.capitalize();return WI.UIString("%s Event Dispatched").format(n)}return WI.UIString("Event Dispatched");case WI.ScriptTimelineRecord.EventType.ProbeSampleRecorded:return WI.UIString("Probe Sample Recorded");case WI.ScriptTimelineRecord.EventType.ConsoleProfileRecorded:return e&&(e instanceof String||typeof e=="string")?WI.UIString("\u201C%s\u201D Profile Recorded").format(e):WI.UIString("Console Profile Recorded");case WI.ScriptTimelineRecord.EventType.GarbageCollected:if(console.assert(e),e&&e instanceof WI.GarbageCollection&&t)switch(e.type){case WI.GarbageCollection.Type.Partial:return WI.UIString("Partial Garbage Collection");case WI.GarbageCollection.Type.Full:return WI.UIString("Full Garbage Collection")}return WI.UIString("Garbage Collection");case WI.ScriptTimelineRecord.EventType.TimerFired:return e&&t?WI.UIString("Timer %d Fired").format(e):WI.UIString("Timer Fired");case WI.ScriptTimelineRecord.EventType.TimerInstalled:return e&&t?WI.UIString("Timer %d Installed").format(e.timerId):WI.UIString("Timer Installed");case WI.ScriptTimelineRecord.EventType.TimerRemoved:return e&&t?WI.UIString("Timer %d Removed").format(e):WI.UIString("Timer Removed");case WI.ScriptTimelineRecord.EventType.AnimationFrameFired:return e&&t?WI.UIString("Animation Frame %d Fired").format(e):WI.UIString("Animation Frame Fired");case WI.ScriptTimelineRecord.EventType.ObserverCallback:return e&&(e instanceof String||typeof e=="string")?WI.UIString("%s Callback").format(e):WI.UIString("Observer Callback");case WI.ScriptTimelineRecord.EventType.AnimationFrameRequested:return e&&t?WI.UIString("Animation Frame %d Requested").format(e):WI.UIString("Animation Frame Requested");case WI.ScriptTimelineRecord.EventType.AnimationFrameCanceled:return e&&t?WI.UIString("Animation Frame %d Canceled").format(e):WI.UIString("Animation Frame Canceled")}};WI.ScriptTimelineRecord.TypeIdentifier="script-timeline-record";WI.ScriptTimelineRecord.EventTypeCookieKey="script-timeline-record-event-type";WI.ScriptTimelineRecord.DetailsCookieKey="script-timeline-record-details";WI.ServerTimingEntry=class{constructor(e){this._name=e,this._duration=void 0,this._description=void 0}static parseHeaders(e=""){function t(){e=e.trimStart()}function i(b){return console.assert(b.length===1),t(),e.charAt(0)!==b?!1:(e=e.substring(1),!0)}function n(){let b=/^(?:\s*)([\w!#$%&'*+\-.^`|~]+)(?:\s*)(.*)/.exec(e);return b?(e=b[2],b[1]):null}function s(){return t(),e.charAt(0)==='"'?a():n()}function a(){console.assert(e.charAt(0)==='"'),e=e.substring(1);let b="";for(let w=0;w<e.length;++w){let S=e.charAt(w);switch(S){case"\\":++w,w<e.length&&(b+=e.charAt(w));break;case'"':return e=e.substring(w+1),b;default:b+=S;break}}return e="",null}function d(){let b=/([,;].*)/.exec(e);b&&(e=b[1])}function p(b){switch(b){case"dur":return function(w,S){if(w!==null){let E=parseFloat(w);if(!isNaN(E)){S.duration=E;return}}S.duration=0};case"desc":return function(w,S){S.description=w||""};default:return null}}let f=[],_;for(;(_=n())!==null;){let b=new WI.ServerTimingEntry(_);for(;i(";");){let w;if((w=n())===null)continue;w=w.toLowerCase();let S=p(w),E=null;i("=")&&(E=s(),d()),S?S(E,b):console.warn("Unknown Server-Timing parameter:",w,E)}if(f.push(b),!i(","))break}return f}get name(){return this._name}get duration(){return this._duration}get description(){return this._description}set duration(e){if(this._duration!==void 0){console.warn("Ignoring redundant duration.");return}this._duration=e}set description(e){if(this._description!==void 0){console.warn("Ignoring redundant description.");return}this._description=e}};WI.ShaderProgram=class{constructor(e,t){console.assert(e),console.assert(t instanceof WI.Canvas),this._identifier=e,this._canvas=t,this._uniqueDisplayNumber=t.nextShaderProgramDisplayNumber(),this._disabled=!1}get identifier(){return this._identifier}get canvas(){return this._canvas}get disabled(){return this._disabled}get displayName(){return WI.UIString("Program %d").format(this._uniqueDisplayNumber)}requestVertexShaderSource(e){this._requestShaderSource(CanvasAgent.ShaderType.Vertex,e)}requestFragmentShaderSource(e){this._requestShaderSource(CanvasAgent.ShaderType.Fragment,e)}updateVertexShader(e){this._updateShader(CanvasAgent.ShaderType.Vertex,e)}updateFragmentShader(e){this._updateShader(CanvasAgent.ShaderType.Fragment,e)}toggleDisabled(e){CanvasAgent.setShaderProgramDisabled(this._identifier,!this._disabled,t=>{console.assert(!t,t),!t&&(this._disabled=!this._disabled,e())})}showHighlight(){CanvasAgent.setShaderProgramHighlighted(this._identifier,!0,t=>{console.assert(!t,t)})}hideHighlight(){CanvasAgent.setShaderProgramHighlighted(this._identifier,!1,t=>{console.assert(!t,t)})}_requestShaderSource(e,t){CanvasAgent.requestShaderSource(this._identifier,e,(i,n)=>{if(i){t(null);return}t(n)})}_updateShader(e,t){CanvasAgent.updateShader(this._identifier,e,t,i=>{console.assert(!i,i)})}};WI.ShaderProgram.ShaderType={Fragment:"shader-type-fragment",Vertex:"shader-type-vertex"};WI.SourceCodePosition=class{constructor(e,t){this._lineNumber=e||0,this._columnNumber=t||0}get lineNumber(){return this._lineNumber}get columnNumber(){return this._columnNumber}offsetColumn(e){return console.assert(this._columnNumber+e>=0),new WI.SourceCodePosition(this._lineNumber,this._columnNumber+e)}equals(e){return this._lineNumber===e.lineNumber&&this._columnNumber===e.columnNumber}isBefore(e){return this._lineNumber<e.lineNumber||this._lineNumber===e.lineNumber&&this._columnNumber<e.columnNumber}isAfter(e){return this._lineNumber>e.lineNumber||this._lineNumber===e.lineNumber&&this._columnNumber>e.columnNumber}isWithin(e,t){return console.assert(e.isBefore(t)||e.equals(t)),!!(this.equals(e)||this.equals(t)||this.isAfter(e)&&this.isBefore(t))}toCodeMirror(){return{line:this._lineNumber,ch:this._columnNumber}}};WI.SourceCodeRevision=class extends WI.Revision{constructor(e,t){super(),console.assert(e instanceof WI.SourceCode),this._sourceCode=e,this._content=t||""}get sourceCode(){return this._sourceCode}get content(){return this._content}set content(e){e=e||"",this._content!==e&&(this._content=e,this._sourceCode.revisionContentDidChange(this))}apply(){this._sourceCode.currentRevision=this}revert(){this._sourceCode.currentRevision=this._sourceCode.originalRevision}copy(){return new WI.SourceCodeRevision(this._sourceCode,this._content)}};WI.SourceCodeSearchMatchObject=class{constructor(e,t,i,n){console.assert(e instanceof WI.SourceCode),this._sourceCode=e,this._lineText=t,this._searchTerm=i,this._sourceCodeTextRange=e.createSourceCodeTextRange(n)}get sourceCode(){return this._sourceCode}get title(){return this._lineText}get searchTerm(){return this._searchTerm}get sourceCodeTextRange(){return this._sourceCodeTextRange}get className(){return"source-code-match"}saveIdentityToCookie(e){this._sourceCode.url&&(e[WI.SourceCodeSearchMatchObject.URLCookieKey]=this._sourceCode.url.hash);var t=this._sourceCodeTextRange.textRange;e[WI.SourceCodeSearchMatchObject.TextRangeKey]=[t.startLine,t.startColumn,t.endLine,t.endColumn].join()}};WI.SourceCodeSearchMatchObject.TypeIdentifier="source-code-search-match-object";WI.SourceCodeSearchMatchObject.URLCookieKey="source-code-url";WI.SourceCodeSearchMatchObject.TextRangeKey="text-range";WI.SourceCodeTextRange=class extends WI.Object{constructor(e){if(super(),console.assert(e instanceof WI.SourceCode),console.assert(arguments.length===2||arguments.length===3),this._sourceCode=e,arguments.length===2){var t=arguments[1];console.assert(t instanceof WI.TextRange),this._startLocation=e.createSourceCodeLocation(t.startLine,t.startColumn),this._endLocation=e.createSourceCodeLocation(t.endLine,t.endColumn)}else console.assert(arguments[1]instanceof WI.SourceCodeLocation),console.assert(arguments[2]instanceof WI.SourceCodeLocation),this._startLocation=arguments[1],this._endLocation=arguments[2];this._startLocation.addEventListener(WI.SourceCodeLocation.Event.LocationChanged,this._sourceCodeLocationChanged,this),this._endLocation.addEventListener(WI.SourceCodeLocation.Event.LocationChanged,this._sourceCodeLocationChanged,this)}get sourceCode(){return this._sourceCode}get textRange(){var e=this._startLocation.lineNumber,t=this._startLocation.columnNumber,i=this._endLocation.lineNumber,n=this._endLocation.columnNumber;return new WI.TextRange(e,t,i,n)}get formattedTextRange(){var e=this._startLocation.formattedLineNumber,t=this._startLocation.formattedColumnNumber,i=this._endLocation.formattedLineNumber,n=this._endLocation.formattedColumnNumber;return new WI.TextRange(e,t,i,n)}get displaySourceCode(){return this._startAndEndLocationsInSameMappedResource()?this._startLocation.displaySourceCode:this._sourceCode}get displayTextRange(){if(!this._startAndEndLocationsInSameMappedResource())return this.formattedTextRange;var e=this._startLocation.displayLineNumber,t=this._startLocation.displayColumnNumber,i=this._endLocation.displayLineNumber,n=this._endLocation.displayColumnNumber;return new WI.TextRange(e,t,i,n)}get synthesizedTextValue(){return this._sourceCode.url+":"+(this._startLocation.lineNumber+1)}_startAndEndLocationsInSameMappedResource(){return this._startLocation.hasMappedLocation()&&this._endLocation.hasMappedLocation()&&this._startLocation.displaySourceCode===this._endLocation.displaySourceCode}_sourceCodeLocationChanged(e){this.dispatchEventToListeners(WI.SourceCodeLocation.Event.RangeChanged)}};WI.SourceCodeTextRange.Event={RangeChanged:"source-code-text-range-range-changed"};WI.SourceCodeTimeline=class extends WI.Timeline{constructor(e,t,i,n){super(),console.assert(e),console.assert(!t||t.sourceCode===e),console.assert(i),this._sourceCode=e,this._sourceCodeLocation=t||null,this._recordType=i,this._recordEventType=n||null}get sourceCode(){return this._sourceCode}get sourceCodeLocation(){return this._sourceCodeLocation}get recordType(){return this._recordType}get recordEventType(){return this._recordEventType}saveIdentityToCookie(e){e[WI.SourceCodeTimeline.SourceCodeURLCookieKey]=this._sourceCode.url?this._sourceCode.url.hash:null,e[WI.SourceCodeTimeline.SourceCodeLocationLineCookieKey]=this._sourceCodeLocation?this._sourceCodeLocation.lineNumber:null,e[WI.SourceCodeTimeline.SourceCodeLocationColumnCookieKey]=this._sourceCodeLocation?this._sourceCodeLocation.columnNumber:null,e[WI.SourceCodeTimeline.RecordTypeCookieKey]=this._recordType||null,e[WI.SourceCodeTimeline.RecordEventTypeCookieKey]=this._recordEventType||null}};WI.SourceCodeTimeline.TypeIdentifier="source-code-timeline";WI.SourceCodeTimeline.SourceCodeURLCookieKey="source-code-timeline-source-code-url";WI.SourceCodeTimeline.SourceCodeLocationLineCookieKey="source-code-timeline-source-code-location-line";WI.SourceCodeTimeline.SourceCodeLocationColumnCookieKey="source-code-timeline-source-code-location-column";WI.SourceCodeTimeline.SourceCodeURLCookieKey="source-code-timeline-source-code-url";WI.SourceCodeTimeline.RecordTypeCookieKey="source-code-timeline-record-type";WI.SourceCodeTimeline.RecordEventTypeCookieKey="source-code-timeline-record-event-type";WI.SourceMap=class{constructor(e,t,i){if(!WI.SourceMap._base64Map){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";WI.SourceMap._base64Map={};for(var s=0;s<n.length;++s)WI.SourceMap._base64Map[n.charAt(s)]=s}this._originalSourceCode=i||null,this._sourceMapResources={},this._sourceMapResourcesList=[],this._sourceMappingURL=e,this._reverseMappingsBySourceURL={},this._mappings=[],this._sources={},this._sourceRoot=null,this._sourceContentByURL={},this._parseMappingPayload(t)}get originalSourceCode(){return this._originalSourceCode}get sourceMappingBasePathURLComponents(){if(this._sourceMappingURLBasePathComponents)return this._sourceMappingURLBasePathComponents;if(this._sourceRoot){var e=absoluteURL(this._sourceRoot,this._sourceMappingURL);if(console.assert(e),e){var t=parseURL(e);return/\/$/.test(t.path)||(t.path+="/"),this._sourceMappingURLBasePathComponents=t,this._sourceMappingURLBasePathComponents}}var t=parseURL(this._sourceMappingURL);return t.path||(t.path=this._sourceMappingURL||""),t.path=t.path.substr(0,t.path.lastIndexOf(t.lastPathComponent)),t.lastPathComponent=null,this._sourceMappingURLBasePathComponents=t,this._sourceMappingURLBasePathComponents}get resources(){return this._sourceMapResourcesList}addResource(e){console.assert(!(e.url in this._sourceMapResources)),this._sourceMapResources[e.url]=e,this._sourceMapResourcesList.push(e)}resourceForURL(e){return this._sourceMapResources[e]}sources(){return Object.keys(this._sources)}sourceContent(e){return this._sourceContentByURL[e]}_parseMappingPayload(e){e.sections?this._parseSections(e.sections):this._parseMap(e,0,0)}_parseSections(e){for(var t=0;t<e.length;++t){var i=e[t];this._parseMap(i.map,i.offset.line,i.offset.column)}}findEntry(e,t){for(var i=0,n=this._mappings.length;n>1;){var s=n>>1,a=i+s,d=this._mappings[a];e<d[0]||e===d[0]&&t<d[1]?n=s:(i=a,n-=s)}var p=this._mappings[i];return!i&&p&&(e<p[0]||e===p[0]&&t<p[1])?null:p}findEntryReversed(e,t){for(var i=this._reverseMappingsBySourceURL[e];t<i.length;++t){var n=i[t];if(n)return n}return this._mappings[0]}_parseMap(e,t,i){for(var n=0,s=0,a=0,d=0,p=[],f={},_=0;_<e.sources.length;++_){var b=e.sources[_],w=b;e.sourceRoot&&w.charAt(0)!=="/"&&(w=e.sourceRoot.replace(/\/+$/,"")+"/"+w);var S=absoluteURL(w,this._sourceMappingURL)||w;f[b]=S,p.push(S),this._sources[S]=!0,e.sourcesContent&&e.sourcesContent[_]&&(this._sourceContentByURL[S]=e.sourcesContent[_])}this._sourceRoot=e.sourceRoot||null;for(var E=new WI.SourceMap.StringCharIterator(e.mappings),k=p[n];;){if(E.peek()===",")E.next();else{for(;E.peek()===";";)t+=1,i=0,E.next();if(!E.hasNext())break}if(i+=this._decodeVLQ(E),this._isSeparator(E.peek())){this._mappings.push([t,i]);continue}var R=this._decodeVLQ(E);R&&(n+=R,k=p[n]),s+=this._decodeVLQ(E),a+=this._decodeVLQ(E),this._isSeparator(E.peek())||(d+=this._decodeVLQ(E)),this._mappings.push([t,i,k,s,a])}for(var _=0;_<this._mappings.length;++_){var M=this._mappings[_],S=M[2];if(!!S){this._reverseMappingsBySourceURL[S]||(this._reverseMappingsBySourceURL[S]=[]);var L=this._reverseMappingsBySourceURL[S],V=M[3];L[V]||(L[V]=[M[0],M[1]])}}}_isSeparator(e){return e===","||e===";"}_decodeVLQ(e){var t=0,i=0;do{var n=WI.SourceMap._base64Map[e.next()];t+=(n&WI.SourceMap.VLQ_BASE_MASK)<<i,i+=WI.SourceMap.VLQ_BASE_SHIFT}while(n&WI.SourceMap.VLQ_CONTINUATION_MASK);var s=t&1;return t>>=1,s?-t:t}};WI.SourceMap.VLQ_BASE_SHIFT=5;WI.SourceMap.VLQ_BASE_MASK=(1<<5)-1;WI.SourceMap.VLQ_CONTINUATION_MASK=1<<5;WI.SourceMap.StringCharIterator=class{constructor(e){this._string=e,this._position=0}next(){return this._string.charAt(this._position++)}peek(){return this._string.charAt(this._position)}hasNext(){return this._position<this._string.length}};WI.StackTrace=class{constructor(e,t,i,n){console.assert(e&&e.every(s=>s instanceof WI.CallFrame)),this._callFrames=e,this._topCallFrameIsBoundary=t||!1,this._truncated=i||!1,this._parentStackTrace=n||null}static fromPayload(e,t){let i=null,n=null;for(;t;){let s=t.callFrames.map(d=>WI.CallFrame.fromPayload(e,d)),a=new WI.StackTrace(s,t.topCallFrameIsBoundary,t.truncated);i||(i=a),n&&(n._parentStackTrace=a),n=a,t=t.parentStackTrace}return i}static fromString(e,t){let i=WI.StackTrace._parseStackTrace(t);return WI.StackTrace.fromPayload(e,{callFrames:i})}static isLikelyStackTrace(e){if(e.length<16 .length*2)return!1;const i=5e3;if(e.length>i||/^[^a-z$_]/i.test(e[0]))return!1;if(!WI.StackTrace._likelyStackTraceRegex){const d=`(global code|eval code|module code|\\w+)?([^:]{1,${10}}://[^:]{1,${500}}:\\d+:\\d+|[^@]{1,${120}}@\\[native code\\])`;WI.StackTrace._likelyStackTraceRegex=new RegExp(`^${d}([\\n\\r]${d})+$`)}return WI.StackTrace._likelyStackTraceRegex.lastIndex=0,WI.StackTrace._likelyStackTraceRegex.test(e)}static _parseStackTrace(e){var t=e.split(/\n/g),i=[];for(var n of t){var s="",a="",d=0,p=0,f=n.indexOf("@");f!==-1?(s=n.slice(0,f),{url:a,lineNumber:d,columnNumber:p}=WI.StackTrace._parseLocation(n.slice(f+1))):n.includes("/")?{url:a,lineNumber:d,columnNumber:p}=WI.StackTrace._parseLocation(n):s=n,i.push({functionName:s,url:a,lineNumber:d,columnNumber:p})}return i}static _parseLocation(e){var t={url:"",lineNumber:0,columnNumber:0},i=/(.+?)(?::(\d+)(?::(\d+))?)?$/,n=e.match(i);return n&&(t.url=n[1],n[2]&&(t.lineNumber=parseInt(n[2])),n[3]&&(t.columnNumber=parseInt(n[3]))),t}get callFrames(){return this._callFrames}get firstNonNativeCallFrame(){for(let e of this._callFrames)if(!e.nativeCode)return e;return null}get firstNonNativeNonAnonymousCallFrame(){for(let e of this._callFrames)if(!e.nativeCode){if(e.sourceCodeLocation){let t=e.sourceCodeLocation.sourceCode;if(t instanceof WI.Script&&t.anonymous)continue}return e}return null}get topCallFrameIsBoundary(){return this._topCallFrameIsBoundary}get truncated(){return this._truncated}get parentStackTrace(){return this._parentStackTrace}};WI.StructureDescription=class{constructor(e,t,i,n,s){console.assert(!e||e.every(a=>typeof a=="string")),console.assert(!t||t.every(a=>typeof a=="string")),console.assert(!i||typeof i=="string"),console.assert(!n||n instanceof WI.StructureDescription),this._fields=e||null,this._optionalFields=t||null,this._constructorName=i||"",this._prototypeStructure=n||null,this._imprecise=s||!1}static fromPayload(e){return e.prototypeStructure&&(e.prototypeStructure=WI.StructureDescription.fromPayload(e.prototypeStructure)),new WI.StructureDescription(e.fields,e.optionalFields,e.constructorName,e.prototypeStructure,e.imprecise)}get fields(){return this._fields}get optionalFields(){return this._optionalFields}get constructorName(){return this._constructorName}get prototypeStructure(){return this._prototypeStructure}get imprecise(){return this._imprecise}};WI.TextMarker=class{constructor(e,t){this._codeMirrorTextMarker=e,e.__webInspectorTextMarker=this,this._type=t||WI.TextMarker.Type.Plain}static textMarkerForCodeMirrorTextMarker(e){return e.__webInspectorTextMarker||new WI.TextMarker(e)}get codeMirrorTextMarker(){return this._codeMirrorTextMarker}get type(){return this._type}get range(){var e=this._codeMirrorTextMarker.find();return e?new WI.TextRange(e.from.line,e.from.ch,e.to.line,e.to.ch):null}get rects(){var e=this._codeMirrorTextMarker.find();return e?this._codeMirrorTextMarker.doc.cm.rectsForRange({start:e.from,end:e.to}):WI.Rect.ZERO_RECT}clear(){this._codeMirrorTextMarker.clear()}};WI.TextMarker.Type={Color:"text-marker-type-color",Gradient:"text-marker-type-gradient",Plain:"text-marker-type-plain",CubicBezier:"text-marker-type-cubic-bezier",Spring:"text-marker-type-spring",Variable:"text-marker-type-variable"};WI.TextRange=class{constructor(e,t,i,n){arguments.length===4?(console.assert(e<=i),console.assert(e!==i||t<=n),this._startLine=typeof e=="number"?e:NaN,this._startColumn=typeof t=="number"?t:NaN,this._endLine=typeof i=="number"?i:NaN,this._endColumn=typeof n=="number"?n:NaN,this._startOffset=NaN,this._endOffset=NaN):arguments.length===2&&(console.assert(e<=t),this._startOffset=typeof e=="number"?e:NaN,this._endOffset=typeof t=="number"?t:NaN,this._startLine=NaN,this._startColumn=NaN,this._endLine=NaN,this._endColumn=NaN)}static fromText(e){let t=e.split(`
`);return new WI.TextRange(0,0,t.length-1,t.lastValue.length)}get startLine(){return this._startLine}get startColumn(){return this._startColumn}get endLine(){return this._endLine}get endColumn(){return this._endColumn}get startOffset(){return this._startOffset}get endOffset(){return this._endOffset}startPosition(){return new WI.SourceCodePosition(this._startLine,this._startColumn)}endPosition(){return new WI.SourceCodePosition(this._endLine,this._endColumn)}resolveOffsets(e){if(console.assert(typeof e=="string"),typeof e=="string"&&(console.assert(!isNaN(this._startLine)),console.assert(!isNaN(this._startColumn)),console.assert(!isNaN(this._endLine)),console.assert(!isNaN(this._endColumn)),!(isNaN(this._startLine)||isNaN(this._startColumn)||isNaN(this._endLine)||isNaN(this._endColumn)))){for(var t=0,i=0;i<this._startLine;++i)t=e.indexOf(`
`,t)+1;this._startOffset=t+this._startColumn;for(var i=this._startLine;i<this._endLine;++i)t=e.indexOf(`
`,t)+1;this._endOffset=t+this._endColumn}}contains(e,t){return console.assert(!isNaN(this._startLine),"TextRange needs line/column data"),!(e<this._startLine||e>this._endLine||e===this._startLine&&t<this._startColumn||e===this._endLine&&t>this._endColumn)}clone(){return console.assert(!isNaN(this._startLine),"TextRange needs line/column data."),new WI.TextRange(this._startLine,this._startColumn,this._endLine,this._endColumn)}cloneAndModify(e,t,i,n){console.assert(!isNaN(this._startLine),"TextRange needs line/column data.");let s=this._startLine+e,a=this._startColumn+t,d=this._endLine+i,p=this._endColumn+n;return console.assert(s>=0&&a>=0&&d>=0&&p>=0,`Cannot have negative numbers in TextRange ${s}:${a}...${d}:${p}`),new WI.TextRange(s,a,d,p)}collapseToStart(){return console.assert(!isNaN(this._startLine),"TextRange needs line/column data."),new WI.TextRange(this._startLine,this._startColumn,this._startLine,this._startColumn)}collapseToEnd(){return console.assert(!isNaN(this._endLine),"TextRange needs line/column data."),new WI.TextRange(this._endLine,this._endColumn,this._endLine,this._endColumn)}relativeTo(e,t){let i=0;this._startLine===e&&(i=-t);let n=0;return this._endLine===e&&(n=-t),this.cloneAndModify(-e,i,-e,n)}};WI.TimelineMarker=class extends WI.Object{constructor(e,t,i){super(),console.assert(t),this._time=e||0,this._type=t,this._details=i||null}static fromJSON(e){let{time:t,type:i,details:n}=e;return new WI.TimelineMarker(t,i,n)}toJSON(){return{time:this._time,type:this._type,details:this._details||void 0}}get type(){return this._type}get details(){return this._details}get time(){return this._time}set time(e){console.assert(typeof e=="number","Time should be a number."),e=e||0,this._time!==e&&(this._time=e,this.dispatchEventToListeners(WI.TimelineMarker.Event.TimeChanged))}};WI.TimelineMarker.Event={TimeChanged:"timeline-marker-time-changed"};WI.TimelineMarker.Type={CurrentTime:"current-time",LoadEvent:"load-event",DOMContentEvent:"dom-content-event",TimeStamp:"timestamp",Scanner:"scanner"};WI.TimelineRecording=class extends WI.Object{constructor(e,t,i){super(),this._identifier=e,this._timelines=new Map,this._displayName=t,this._capturing=!1,this._readonly=!1,this._imported=!1,this._instruments=i||[],this._startTime=NaN,this._endTime=NaN,this._discontinuityStartTime=NaN,this._discontinuities=null,this._firstRecordOfTypeAfterDiscontinuity=new Set,this._exportDataRecords=null,this._exportDataMarkers=null,this._exportDataMemoryPressureEvents=null,this._exportDataSampleStackTraces=null,this._exportDataSampleDurations=null,this._topDownCallingContextTree=new WI.CallingContextTree(WI.CallingContextTree.Type.TopDown),this._bottomUpCallingContextTree=new WI.CallingContextTree(WI.CallingContextTree.Type.BottomUp),this._topFunctionsTopDownCallingContextTree=new WI.CallingContextTree(WI.CallingContextTree.Type.TopFunctionsTopDown),this._topFunctionsBottomUpCallingContextTree=new WI.CallingContextTree(WI.CallingContextTree.Type.TopFunctionsBottomUp);for(let n of WI.TimelineManager.availableTimelineTypes()){let s=WI.Timeline.create(n);this._timelines.set(n,s),s.addEventListener(WI.Timeline.Event.TimesUpdated,this._timelineTimesUpdated,this)}this._legacyFirstRecordedTimestamp=NaN,this.reset(!0)}static sourceCodeTimelinesSupported(){return WI.sharedApp.debuggableType===WI.DebuggableType.Web}static import(e,t,i){let{startTime:n,endTime:s,discontinuities:a,instrumentTypes:d,records:p,markers:f,memoryPressureEvents:_,sampleStackTraces:b,sampleDurations:w}=t,S=WI.UIString("Imported - %s").format(i),E=d.map(R=>WI.Instrument.createForTimelineType(R)),k=new WI.TimelineRecording(e,S,E);k._readonly=!0,k._imported=!0,k._startTime=n,k._endTime=s,k._discontinuities=a,k.initializeCallingContextTrees(b,w);for(let R of p){let M=WI.TimelineRecord.fromJSON(R);M&&(k.addRecord(M),M instanceof WI.ScriptTimelineRecord&&(M.profilePayload=k._topDownCallingContextTree.toCPUProfilePayload(M.startTime,M.endTime)))}for(let R of _){let M=WI.MemoryPressureEvent.fromJSON(R);M&&k.addMemoryPressureEvent(M)}return setTimeout(()=>{k.__importing=!0;for(let R of f){let M=WI.TimelineMarker.fromJSON(R);M&&k.addEventMarker(M)}k.__importing=!1}),k}exportData(){return console.assert(this.canExport(),"Attempted to export a recording which should not be exportable."),{displayName:this._displayName,startTime:this._startTime,endTime:this._endTime,discontinuities:this._discontinuities,instrumentTypes:this._instruments.map(e=>e.timelineRecordType),records:this._exportDataRecords,markers:this._exportDataMarkers,memoryPressureEvents:this._exportDataMemoryPressureEvents,sampleStackTraces:this._exportDataSampleStackTraces,sampleDurations:this._exportDataSampleDurations}}get displayName(){return this._displayName}get identifier(){return this._identifier}get timelines(){return this._timelines}get instruments(){return this._instruments}get capturing(){return this._capturing}get readonly(){return this._readonly}get imported(){return this._imported}get startTime(){return this._startTime}get endTime(){return this._endTime}get topDownCallingContextTree(){return this._topDownCallingContextTree}get bottomUpCallingContextTree(){return this._bottomUpCallingContextTree}get topFunctionsTopDownCallingContextTree(){return this._topFunctionsTopDownCallingContextTree}get topFunctionsBottomUpCallingContextTree(){return this._topFunctionsBottomUpCallingContextTree}start(e){console.assert(!this._capturing,"Attempted to start an already started session."),console.assert(!this._readonly,"Attempted to start a readonly session."),this._capturing=!0;for(let t of this._instruments)t.startInstrumentation(e);if(!isNaN(this._discontinuityStartTime))for(let t of this._instruments)this._firstRecordOfTypeAfterDiscontinuity.add(t.timelineRecordType)}stop(e){console.assert(this._capturing,"Attempted to stop an already stopped session."),console.assert(!this._readonly,"Attempted to stop a readonly session."),this._capturing=!1;for(let t of this._instruments)t.stopInstrumentation(e)}capturingStarted(e){isNaN(this._discontinuityStartTime)||(this._discontinuities.push({startTime:this._discontinuityStartTime,endTime:e}),this._discontinuityStartTime=NaN)}capturingStopped(e){this._discontinuityStartTime=e}saveIdentityToCookie(){}isEmpty(){for(var e of this._timelines.values())if(e.records.length)return!1;return!0}unloaded(e){console.assert(e||!this.isEmpty(),"Shouldn't unload an empty recording; it should be reused instead."),this._readonly=!0,this.dispatchEventToListeners(WI.TimelineRecording.Event.Unloaded)}reset(e){console.assert(!this._readonly,"Can't reset a read-only recording."),this._sourceCodeTimelinesMap=new Map,this._startTime=NaN,this._endTime=NaN,this._discontinuityStartTime=NaN,this._discontinuities=[],this._firstRecordOfTypeAfterDiscontinuity.clear(),this._exportDataRecords=[],this._exportDataMarkers=[],this._exportDataMemoryPressureEvents=[],this._exportDataSampleStackTraces=[],this._exportDataSampleDurations=[],this._topDownCallingContextTree.reset(),this._bottomUpCallingContextTree.reset(),this._topFunctionsTopDownCallingContextTree.reset(),this._topFunctionsBottomUpCallingContextTree.reset();for(var t of this._timelines.values())t.reset(e);WI.RenderingFrameTimelineRecord.resetFrameIndex(),e||(this.dispatchEventToListeners(WI.TimelineRecording.Event.Reset),this.dispatchEventToListeners(WI.TimelineRecording.Event.TimesUpdated))}get sourceCodeTimelines(){let e=[];for(let t of this._sourceCodeTimelinesMap.values())e=e.concat(Array.from(t.values()));return e}timelineForInstrument(e){return this._timelines.get(e.timelineRecordType)}instrumentForTimeline(e){return this._instruments.find(t=>t.timelineRecordType===e.type)}timelineForRecordType(e){return this._timelines.get(e)}addInstrument(e){console.assert(e instanceof WI.Instrument,e),console.assert(!this._instruments.includes(e),this._instruments,e),this._instruments.push(e),this.dispatchEventToListeners(WI.TimelineRecording.Event.InstrumentAdded,{instrument:e})}removeInstrument(e){console.assert(e instanceof WI.Instrument,e),console.assert(this._instruments.includes(e),this._instruments,e),this._instruments.remove(e),this.dispatchEventToListeners(WI.TimelineRecording.Event.InstrumentRemoved,{instrument:e})}addEventMarker(e){this._exportDataMarkers.push(e),!(!this._capturing&&!this.__importing)&&this.dispatchEventToListeners(WI.TimelineRecording.Event.MarkerAdded,{marker:e})}addRecord(e){this._exportDataRecords.push(e);let t=this._timelines.get(e.type);if(console.assert(t,e,this._timelines),!t)return;let i=null;if(this._firstRecordOfTypeAfterDiscontinuity.take(e.type)&&(i=this._discontinuities.lastValue),t.addRecord(e,{discontinuity:i}),e.type===WI.TimelineRecord.Type.Network||e.type===WI.TimelineRecord.Type.RenderingFrame||e.type===WI.TimelineRecord.Type.CPU||e.type===WI.TimelineRecord.Type.Memory||e.type===WI.TimelineRecord.Type.HeapAllocations||!WI.TimelineRecording.sourceCodeTimelinesSupported())return;let n=null;e.sourceCodeLocation?n=e.sourceCodeLocation.sourceCode:e.type===WI.TimelineRecord.Type.Media&&e.domNode&&e.domNode.frame&&(n=e.domNode.frame.mainResource),n||(n=WI.networkManager.mainFrame.provisionalMainResource||WI.networkManager.mainFrame.mainResource);var s=this._sourceCodeTimelinesMap.get(n);s||(s=new Map,this._sourceCodeTimelinesMap.set(n,s));var a=!1,d=this._keyForRecord(e),p=s.get(d);p||(p=new WI.SourceCodeTimeline(n,e.sourceCodeLocation,e.type,e.eventType),s.set(d,p),a=!0),p.addRecord(e),a&&this.dispatchEventToListeners(WI.TimelineRecording.Event.SourceCodeTimelineAdded,{sourceCodeTimeline:p})}addMemoryPressureEvent(e){this._exportDataMemoryPressureEvents.push(e);let t=this._timelines.get(WI.TimelineRecord.Type.Memory);console.assert(t,this._timelines),t&&t.addMemoryPressureEvent(e)}discontinuitiesInTimeRange(e,t){return this._discontinuities.filter(i=>i.startTime<=t&&i.endTime>=e)}addScriptInstrumentForProgrammaticCapture(){for(let t of this._instruments)if(t instanceof WI.ScriptInstrument)return;this.addInstrument(new WI.ScriptInstrument);let e=this._instruments.map(t=>t.timelineRecordType);WI.timelineManager.enabledTimelineTypes=e}computeElapsedTime(e){return!e||isNaN(e)?NaN:(WI.TimelineRecording.isLegacy===void 0&&(WI.TimelineRecording.isLegacy=e>WI.TimelineRecording.TimestampThresholdForLegacyRecordConversion),WI.TimelineRecording.isLegacy?(e<WI.TimelineRecording.TimestampThresholdForLegacyAssumedMilliseconds&&(e*=1e3),isNaN(this._legacyFirstRecordedTimestamp)&&(this._legacyFirstRecordedTimestamp=e),(e-this._legacyFirstRecordedTimestamp)/1e3):e)}setLegacyBaseTimestamp(e){console.assert(isNaN(this._legacyFirstRecordedTimestamp)),e<WI.TimelineRecording.TimestampThresholdForLegacyAssumedMilliseconds&&(e*=1e3),this._legacyFirstRecordedTimestamp=e}initializeTimeBoundsIfNecessary(e){isNaN(this._startTime)&&(console.assert(isNaN(this._endTime)),this._startTime=e,this._endTime=e,this.dispatchEventToListeners(WI.TimelineRecording.Event.TimesUpdated))}initializeCallingContextTrees(e,t){this._exportDataSampleStackTraces=this._exportDataSampleStackTraces.concat(e),this._exportDataSampleDurations=this._exportDataSampleDurations.concat(t);for(let i=0;i<e.length;i++)this._topDownCallingContextTree.updateTreeWithStackTrace(e[i],t[i]),this._bottomUpCallingContextTree.updateTreeWithStackTrace(e[i],t[i]),this._topFunctionsTopDownCallingContextTree.updateTreeWithStackTrace(e[i],t[i]),this._topFunctionsBottomUpCallingContextTree.updateTreeWithStackTrace(e[i],t[i])}canExport(){return!(this._capturing||isNaN(this._startTime))}_keyForRecord(e){var t=e.type;return(e instanceof WI.ScriptTimelineRecord||e instanceof WI.LayoutTimelineRecord)&&(t+=":"+e.eventType),e instanceof WI.ScriptTimelineRecord&&e.eventType===WI.ScriptTimelineRecord.EventType.EventDispatched&&(t+=":"+e.details),e instanceof WI.MediaTimelineRecord&&(t+=":"+e.eventType,e.eventType===WI.MediaTimelineRecord.EventType.DOMEvent?e.domEvent&&e.domEvent.eventName&&(t+=":"+e.domEvent.eventName):e.eventType===WI.MediaTimelineRecord.EventType.PowerEfficientPlaybackStateChanged&&(t+=":"+(e.isPowerEfficient?"enabled":"disabled"))),e.sourceCodeLocation&&(t+=":"+e.sourceCodeLocation.lineNumber+":"+e.sourceCodeLocation.columnNumber),t}_timelineTimesUpdated(e){var t=e.target,i=!1;(isNaN(this._startTime)||t.startTime<this._startTime)&&(this._startTime=t.startTime,i=!0),(isNaN(this._endTime)||this._endTime<t.endTime)&&(this._endTime=t.endTime,i=!0),i&&this.dispatchEventToListeners(WI.TimelineRecording.Event.TimesUpdated)}};WI.TimelineRecording.Event={Reset:"timeline-recording-reset",Unloaded:"timeline-recording-unloaded",SourceCodeTimelineAdded:"timeline-recording-source-code-timeline-added",InstrumentAdded:"timeline-recording-instrument-added",InstrumentRemoved:"timeline-recording-instrument-removed",TimesUpdated:"timeline-recording-times-updated",MarkerAdded:"timeline-recording-marker-added"};WI.TimelineRecording.isLegacy=void 0;WI.TimelineRecording.TimestampThresholdForLegacyRecordConversion=1e7;WI.TimelineRecording.TimestampThresholdForLegacyAssumedMilliseconds=14200992e5;WI.TimelineRecording.SerializationVersion=1;WI.TypeDescription=class{constructor(e,t,i,n,s){console.assert(!e||typeof e=="string"),console.assert(!t||t instanceof WI.TypeSet),console.assert(!i||i.every(a=>a instanceof WI.StructureDescription)),this._leastCommonAncestor=e||null,this._typeSet=t||null,this._structures=i||null,this._valid=n||!1,this._truncated=s||!1}static fromPayload(e){var t=void 0;e.typeSet&&(t=WI.TypeSet.fromPayload(e.typeSet));var i=void 0;return e.structures&&(i=e.structures.map(WI.StructureDescription.fromPayload)),new WI.TypeDescription(e.leastCommonAncestor,t,i,e.isValid,e.isTruncated)}get leastCommonAncestor(){return this._leastCommonAncestor}get typeSet(){return this._typeSet}get structures(){return this._structures}get valid(){return this._valid}get truncated(){return this._truncated}};WI.TypeSet=class{constructor(e){console.assert(e);var t=0;e.isFunction&&(t|=WI.TypeSet.TypeBit.Function),e.isUndefined&&(t|=WI.TypeSet.TypeBit.Undefined),e.isNull&&(t|=WI.TypeSet.TypeBit.Null),e.isBoolean&&(t|=WI.TypeSet.TypeBit.Boolean),e.isInteger&&(t|=WI.TypeSet.TypeBit.Integer),e.isNumber&&(t|=WI.TypeSet.TypeBit.Number),e.isString&&(t|=WI.TypeSet.TypeBit.String),e.isObject&&(t|=WI.TypeSet.TypeBit.Object),e.isSymbol&&(t|=WI.TypeSet.TypeBit.Symbol),console.assert(t),this._typeSet=e,this._bitString=t,this._primitiveTypeNames=null}static fromPayload(e){return new WI.TypeSet(e)}isContainedIn(e){return this._bitString&&(this._bitString&e)===this._bitString}get primitiveTypeNames(){if(this._primitiveTypeNames)return this._primitiveTypeNames;this._primitiveTypeNames=[];var e=this._typeSet;return e.isUndefined&&this._primitiveTypeNames.push("Undefined"),e.isNull&&this._primitiveTypeNames.push("Null"),e.isBoolean&&this._primitiveTypeNames.push("Boolean"),e.isString&&this._primitiveTypeNames.push("String"),e.isSymbol&&this._primitiveTypeNames.push("Symbol"),e.isNumber?this._primitiveTypeNames.push("Number"):e.isInteger&&this._primitiveTypeNames.push("Integer"),this._primitiveTypeNames}};WI.TypeSet.TypeBit={Function:1,Undefined:2,Null:4,Boolean:8,Integer:16,Number:32,String:64,Object:128,Symbol:256};WI.TypeSet.NullOrUndefinedTypeBits=WI.TypeSet.TypeBit.Null|WI.TypeSet.TypeBit.Undefined;WI.URLBreakpoint=class extends WI.Object{constructor(e,t,{disabled:i}={}){console.assert(Object.values(WI.URLBreakpoint.Type).includes(e),e),console.assert(typeof t=="string",t),super(),this._type=e,this._url=t,this._disabled=i||!1}static deserialize(e){return new WI.URLBreakpoint(e.type,e.url,{disabled:!!e.disabled})}get type(){return this._type}get url(){return this._url}get disabled(){return this._disabled}set disabled(e){this._disabled!==e&&(this._disabled=e,this.dispatchEventToListeners(WI.URLBreakpoint.Event.DisabledStateChanged))}saveIdentityToCookie(e){e["url-breakpoint-type"]=this._type,e["url-breakpoint-url"]=this._url}toJSON(e){let t={type:this._type,url:this._url};return this._disabled&&(t.disabled=!0),e===WI.ObjectStore.toJSONSymbol&&(t[WI.objectStores.urlBreakpoints.keyPath]=this._type+":"+this._url),t}};WI.URLBreakpoint.Event={DisabledStateChanged:"url-breakpoint-disabled-state-changed"};WI.URLBreakpoint.Type={Text:"text",RegularExpression:"regex"};WI.WebSocketResource=class extends WI.Resource{constructor(e,{loaderIdentifier:t,requestIdentifier:i,requestHeaders:n,timestamp:s,walltime:a,requestSentTimestamp:d}={}){super(e,{type:WI.Resource.Type.WebSocket,loaderIdentifier:t,requestIdentifier:i,requestMethod:"GET",requestHeaders:n,requestSentTimestamp:d}),this._timestamp=s,this._walltime=a,this._readyState=WI.WebSocketResource.ReadyState.Connecting,this._frames=[]}get frames(){return this._frames}get walltime(){return this._walltime}get readyState(){return this._readyState}set readyState(e){if(e===this._readyState)return;let t=this._readyState;this._readyState=e,this.dispatchEventToListeners(WI.WebSocketResource.Event.ReadyStateChanged,{previousState:t,state:e})}addFrame(e,t,i,n,s,a){let d;n===WI.WebSocketResource.OpCodes.BinaryFrame?d=null:d=e;let p={data:d,isOutgoing:i,opcode:n,walltime:this._walltimeForWebSocketTimestamp(s)};this._frames.push(p),t===void 0&&(t=new TextEncoder("utf-8").encode(e).length),this.increaseSize(t,a),this.dispatchEventToListeners(WI.WebSocketResource.Event.FrameAdded,p)}_walltimeForWebSocketTimestamp(e){return this._walltime+(e-this._timestamp)}};WI.WebSocketResource.Event={FrameAdded:Symbol("web-socket-frame-added"),ReadyStateChanged:Symbol("web-socket-resource-ready-state-changed")};WI.WebSocketResource.ReadyState={Closed:Symbol("closed"),Connecting:Symbol("connecting"),Open:Symbol("open")};WI.WebSocketResource.OpCodes={ContinuationFrame:0,TextFrame:1,BinaryFrame:2,ConnectionCloseFrame:8,PingFrame:9,PongFrame:10};WI.WrappedPromise=class{constructor(e){this._settled=!1,this._promise=new Promise((t,i)=>{if(this._resolveCallback=t,this._rejectCallback=i,e&&typeof e=="function")return e(this.resolve.bind(this),this.reject.bind(this))})}get settled(){return this._settled}get promise(){return this._promise}resolve(e){if(this._settled)throw new Error("Promise is already settled, cannot call resolve().");this._settled=!0,this._resolveCallback(e)}reject(e){if(this._settled)throw new Error("Promise is already settled, cannot call reject().");this._settled=!0,this._rejectCallback(e)}};WI.LocalResource=class Au extends WI.Resource{constructor({request:e,response:t,metrics:i,timing:n}){console.assert(e),console.assert(typeof e.url=="string"),console.assert(t),i=i||{},n=n||{},super(e.url,{mimeType:t.mimeType||(t.headers||{}).valueForCaseInsensitiveKey("Content-Type")||null,requestMethod:e.method,requestHeaders:e.headers,requestData:e.data,requestSentTimestamp:e.timestamp,requestSentWalltime:e.walltime}),this._finishedOrFailedTimestamp=e.finishedTimestamp||NaN,this._statusCode=t.statusCode||NaN,this._statusText=t.statusText||null,this._responseHeaders=t.headers||{},this._failureReasonText=t.failureReasonText,this._timingData=new WI.ResourceTimingData(this,n),this._responseSource=i.responseSource||WI.Resource.ResponseSource.Unknown,this._protocol=i.protocol||null,this._priority=i.priority||WI.Resource.NetworkPriority.Unknown,this._remoteAddress=i.remoteAddress||null,this._connectionIdentifier=i.connectionIdentifier||null,this._requestHeadersTransferSize=isNaN(i.requestHeaderBytesSent)?NaN:i.requestHeaderBytesSent,this._requestBodyTransferSize=isNaN(i.requestBodyBytesSent)?NaN:i.requestBodyBytesSent,this._responseHeadersTransferSize=isNaN(i.responseHeaderBytesReceived)?NaN:i.responseHeaderBytesReceived,this._responseBodyTransferSize=isNaN(i.responseBodyBytesReceived)?NaN:i.responseBodyBytesReceived,this._responseBodySize=isNaN(i.responseBodyDecodedSize)?NaN:i.responseBodyDecodedSize,this._localContent=t.content,this._localContentIsBase64Encoded=t.base64Encoded,this._finished=!0,this._failed=!1,this._cached=!1}static headersArrayToHeadersObject(e){let t={};if(e)for(let{name:i,value:n}of e)t[i]=n;return t}static fromHAREntry(e,t){let{request:i,response:n,startedDateTime:s,timings:a}=e,d=WI.HARBuilder.dateFromHARDate(s)/1e3,p=d-t,f=NaN,_={startTime:NaN,domainLookupStart:NaN,domainLookupEnd:NaN,connectStart:NaN,connectEnd:NaN,secureConnectionStart:NaN,requestStart:NaN,responseStart:NaN,responseEnd:NaN};if(!isNaN(d)&&!isNaN(t)){let w=a.blocked!==-1,S=a.dns!==-1,E=a.connect!==-1,k=a.ssl!==-1;_.startTime=p||Number.EPSILON,_.fetchStart=_.startTime;let R=_.startTime;w&&(R+=a.blocked/1e3),S&&(_.domainLookupStart=R,R+=a.dns/1e3,_.domainLookupEnd=R),E&&(_.connectStart=R,R+=a.connect/1e3,_.connectEnd=R,k&&(_.secureConnectionStart=_.connectEnd-a.ssl/1e3)),R+=a.send/1e3,_.requestStart=R,R+=a.wait/1e3,_.responseStart=R,R+=a.receive/1e3,_.responseEnd=R,f=_.responseEnd}let b=e.serverIPAddress||null;return b&&typeof e._serverPort=="number"&&(b+=":"+e._serverPort),new WI.LocalResource({request:{url:i.url,method:i.method,headers:Au.headersArrayToHeadersObject(i.headers),timestamp:p,walltime:d,finishedTimestamp:f,data:i.postData?i.postData.text:null},response:{headers:Au.headersArrayToHeadersObject(n.headers),mimeType:n.content.mimeType,statusCode:n.status,statusText:n.statusText,failureReasonText:n._error||null,content:n.content.text,base64Encoded:n.content.encoding==="base64"},metrics:{responseSource:WI.HARBuilder.responseSourceFromHARFetchType(e._fetchType),protocol:WI.HARBuilder.protocolFromHARProtocol(n.httpVersion),priority:WI.HARBuilder.networkPriorityFromHARPriority(e._priority),remoteAddress:b,connectionIdentifier:e.connection?parseInt(e.connection):null,requestHeaderBytesSent:i.headersSize>=0?i.headersSize:NaN,requestBodyBytesSent:i.bodySize>=0?i.bodySize:NaN,responseHeaderBytesReceived:n.headersSize>=0?n.headersSize:NaN,responseBodyBytesReceived:n.bodySize>=0?n.bodySize:NaN,responseBodyDecodedSize:n.content.size||NaN},timing:_})}hasContent(){return!!this._localContent}setContent(e,t){console.assert(!this._localContent),t&&WI.shouldTreatMIMETypeAsText(this._mimeType)&&(e=atob(e),t=!1),this._localContent=e,this._localContentIsBase64Encoded=t}requestContentFromBackend(){return Promise.resolve({content:this._localContent,base64Encoded:this._localContentIsBase64Encoded})}};WI.SourceMapResource=class extends WI.Resource{constructor(e,t){super(e),console.assert(e),console.assert(t),this._sourceMap=t;var i=this._sourceMap.originalSourceCode instanceof WI.Resource?this._sourceMap.originalSourceCode.syntheticMIMEType:null,n=WI.fileExtensionForURL(e)||"",s=WI.mimeTypeForFileExtension(n,!0);this._mimeType=s||i||"text/javascript",this._type=WI.Resource.typeFromMIMEType(this._mimeType),this.markAsFinished()}get sourceMap(){return this._sourceMap}get sourceMapDisplaySubpath(){var e=this._sourceMap.sourceMappingBasePathURLComponents,t=this.urlComponents;return t.path||(t.path=this.url),t.scheme!==e.scheme||t.host!==e.host?t.host+(t.port?":"+t.port:"")+t.path:t.path.startsWith(e.path)?t.path.substring(e.path.length,t.length):relativePath(t.path,e.path)}requestContentFromBackend(){this.revertMarkAsFinished();var e=this._sourceMap.sourceContent(this.url);if(e)return n.call(this,{content:e,mimeType:this.mimeType,statusCode:200});function t(a,d,p,f){return this.markAsFailed(),Promise.resolve({error:WI.UIString("An error occurred trying to load the resource."),content:d,mimeType:p,statusCode:f})}function i(a){return console.error(a||"There was an unknown error calling NetworkAgent.loadResource."),this.markAsFailed(),Promise.resolve({error:WI.UIString("An error occurred trying to load the resource.")})}function n(a){var{error:d,content:p,mimeType:f,statusCode:_}=a,b=!1;return _>=400||d?t(d,p,f,_):(this.markAsFinished(),Promise.resolve({content:p,mimeType:f,base64encoded:b,statusCode:_}))}if(!window.NetworkAgent)return i.call(this);var s=null;return this._sourceMap.originalSourceCode instanceof WI.Resource&&this._sourceMap.originalSourceCode.parentFrame&&(s=this._sourceMap.originalSourceCode.parentFrame.id),s||(s=WI.networkManager.mainFrame?WI.networkManager.mainFrame.id:""),NetworkAgent.loadResource(s,this.url).then(n.bind(this)).catch(i.bind(this))}createSourceCodeLocation(e,t){var i=this._sourceMap.findEntryReversed(this.url,e),n=i[0],s=i[1],a=this._sourceMap.originalSourceCode;a instanceof WI.Script&&(n===0&&(s+=a.range.startColumn),n+=a.range.startLine);var d=a.createSourceCodeLocation(n,s);return d._setMappedLocation(this,e,t),d}createSourceCodeTextRange(e){var t=this.createSourceCodeLocation(e.startLine,e.startColumn),i=this.createSourceCodeLocation(e.endLine,e.endColumn);return new WI.SourceCodeTextRange(this._sourceMap.originalSourceCode,t,i)}};WI.AuditTestBase=class fp extends WI.Object{constructor(e,{description:t,supports:i,setup:n,disabled:s}={}){console.assert(typeof e=="string"),console.assert(!t||typeof t=="string"),console.assert(i===void 0||typeof i=="number"),console.assert(!n||typeof n=="string"),console.assert(s===void 0||typeof s=="boolean"),super(),console.assert(this.constructor!==WI.AuditTestBase&&this instanceof WI.AuditTestBase),this._name=e,this._description=t||null,this._supports=i,this._setup=n||null,this._supported=!0,typeof this._supports=="number"&&(this._supports>WI.AuditTestBase.Version?(WI.AuditManager.synthesizeWarning(WI.UIString('"%s" is too new to run in this Web Inspector').format(this.name)),this._supported=!1):InspectorBackend.domains.Audit&&this._supports>InspectorBackend.domains.Audit.VERSION&&(WI.AuditManager.synthesizeWarning(WI.UIString('"%s" is too new to run on this inspected page').format(this.name)),this._supported=!1)),this.supported||(s=!0),this._runningState=s?WI.AuditManager.RunningState.Disabled:WI.AuditManager.RunningState.Inactive,this._result=null}get name(){return this._name}get description(){return this._description}get runningState(){return this._runningState}get result(){return this._result}get supported(){return this._supported}set supported(e){this._supported=e,this._supported||(this.disabled=!0)}get disabled(){return this._runningState===WI.AuditManager.RunningState.Disabled}set disabled(e){if(console.assert(this._runningState===WI.AuditManager.RunningState.Disabled||this._runningState===WI.AuditManager.RunningState.Inactive),this._runningState!==WI.AuditManager.RunningState.Disabled&&this._runningState!==WI.AuditManager.RunningState.Inactive)return;this.supported||(e=!0);let t=e?WI.AuditManager.RunningState.Disabled:WI.AuditManager.RunningState.Inactive;t!==this._runningState&&(this._runningState=t,this.dispatchEventToListeners(WI.AuditTestBase.Event.DisabledChanged))}async setup(){if(!this._setup)return;let e=null,t={};InspectorBackend.domains.Audit?(e=AuditAgent.run,t.test=this._setup):(e=RuntimeAgent.evaluate,t.expression=`(function() { "use strict"; return eval(\`(${this._setup.replace(/`/g,"\\`")})\`)(); })()`,t.objectGroup=fp.ObjectGroup,t.doNotPauseOnExceptionsAndMuteConsole=!0);try{let i=await e.invoke(t);if(i.result.type==="object"&&i.result.className==="Promise"&&(WI.RuntimeManager.supportsAwaitPromise()?i=await RuntimeAgent.awaitPromise(i.result.objectId):(i=null,WI.AuditManager.synthesizeError(WI.UIString("Async audits are not supported.")))),i){let n=WI.RemoteObject.fromPayload(i.result,WI.mainTarget);(i.wasThrown||n.type==="object"&&n.subtype==="error")&&WI.AuditManager.synthesizeError(n.description)}}catch(i){WI.AuditManager.synthesizeError(i.message)}}async start(){this.disabled||(console.assert(this.supported),console.assert(WI.auditManager.runningState===WI.AuditManager.RunningState.Active),console.assert(this._runningState===WI.AuditManager.RunningState.Inactive),this._runningState===WI.AuditManager.RunningState.Inactive&&(this._runningState=WI.AuditManager.RunningState.Active,this.dispatchEventToListeners(WI.AuditTestBase.Event.Scheduled),await this.run(),this._runningState=WI.AuditManager.RunningState.Inactive,this.dispatchEventToListeners(WI.AuditTestBase.Event.Completed)))}stop(){this.disabled||(console.assert(this.supported),console.assert(WI.auditManager.runningState===WI.AuditManager.RunningState.Stopping),this._runningState===WI.AuditManager.RunningState.Active&&(this._runningState=WI.AuditManager.RunningState.Stopping,this.dispatchEventToListeners(WI.AuditTestBase.Event.Stopping)))}clearResult(e={}){return this._result?(this._result=null,e.suppressResultChangedEvent||this.dispatchEventToListeners(WI.AuditTestBase.Event.ResultChanged),!0):!1}saveIdentityToCookie(e){e["audit-"+this.constructor.TypeIdentifier+"-name"]=this._name}toJSON(e){let t={type:this.constructor.TypeIdentifier,name:this._name};return this._description&&(t.description=this._description),typeof this._supports=="number"&&(t.supports=this._supports),this._setup&&(t.setup=this._setup),e===WI.ObjectStore.toJSONSymbol&&(t.disabled=this.disabled),t}async run(){throw WI.NotImplementedError.subclassMustOverride()}};WI.AuditTestBase.Version=3;WI.AuditTestBase.ObjectGroup="audit";WI.AuditTestBase.Event={Completed:"audit-test-base-completed",DisabledChanged:"audit-test-base-disabled-changed",Progress:"audit-test-base-progress",ResultChanged:"audit-test-base-result-changed",Scheduled:"audit-test-base-scheduled",Stopping:"audit-test-base-stopping"};WI.AuditTestCase=class extends WI.AuditTestBase{constructor(e,t,i={}){console.assert(typeof t=="string"),super(e,i),this._test=t}static async fromPayload(e){if(typeof e!="object"||e===null||e.type!==WI.AuditTestCase.TypeIdentifier)return null;if(typeof e.name!="string")return WI.AuditManager.synthesizeError(WI.UIString('"%s" has a non-string "%s" value').format(e.name,WI.unlocalizedString("name"))),null;if(typeof e.test!="string")return WI.AuditManager.synthesizeError(WI.UIString('"%s" has a non-string "%s" value').format(e.name,WI.unlocalizedString("test"))),null;let t={};return typeof e.description=="string"?t.description=e.description:"description"in e&&WI.AuditManager.synthesizeWarning(WI.UIString('"%s" has a non-string "%s" value').format(e.name,WI.unlocalizedString("description"))),typeof e.supports=="number"?t.supports=e.supports:"supports"in e&&WI.AuditManager.synthesizeWarning(WI.UIString('"%s" has a non-number "%s" value').format(e.name,WI.unlocalizedString("supports"))),typeof e.setup=="string"?t.setup=e.setup:"setup"in e&&WI.AuditManager.synthesizeWarning(WI.UIString('"%s" has a non-string "%s" value').format(e.name,WI.unlocalizedString("setup"))),typeof e.disabled=="boolean"&&(t.disabled=e.disabled),new WI.AuditTestCase(e.name,e.test,t)}get test(){return this._test}toJSON(e){let t=super.toJSON(e);return t.test=this._test,t}async run(){const e=Object.values(WI.AuditTestCaseResult.Level);let t=null,i={},n={url:WI.networkManager.mainFrame.url,startTimestamp:null,endTimestamp:null},s=null;function a(w){let S=e.indexOf(w);if(S<0){d(WI.UIString("Return string must be one of %s").format(JSON.stringify(e)));return}S<=e.indexOf(t)||(t=w)}function d(w){a(WI.AuditTestCaseResult.Level.Error),i.errors||(i.errors=[]),i.errors.push(w)}async function p(w){let S=WI.RemoteObject.fromPayload(w.result,WI.mainTarget);if(w.wasThrown||S.type==="object"&&S.subtype==="error"){d(S.description);return}if(S.type==="boolean"){a(S.value?WI.AuditTestCaseResult.Level.Pass:WI.AuditTestCaseResult.Level.Fail);return}if(S.type==="string"){a(S.value.trim().toLowerCase());return}if(S.type!=="object"||S.subtype){d(WI.UIString("Return value is not an object, string, or boolean"));return}const E={ownProperties:!0};function k(V,H,O,z){function K(q){let Y=null;q==="object"||q==="array"?Y=WI.UIString('"%s" must be an %s'):Y=WI.UIString('"%s" must be a %s'),d(Y.format(V,q))}return H.subtype!==z?(K(z),null):H.type!==O?(K(O),null):O==="boolean"||O==="string"?H.value:H}async function R(V,H,O){let z=k(V,H,"object","array");if(!z)return;let K=await new Promise((q,Y)=>z.getPropertyDescriptors(q,E));for(let q=0;q<z.size;++q){let Y=K.find(se=>se.name===String(q));Y&&await O(Y)}}let M=await new Promise((V,H)=>S.getPropertyDescriptors(V,E));for(let V of M){let H=V.name;if(H==="__proto__")continue;let O=V.value;switch(H){case"level":{let z=k(H,O,"string");z&&a(z.trim().toLowerCase());break}case"pass":k(H,O,"boolean")&&a(WI.AuditTestCaseResult.Level.Pass);break;case"warn":k(H,O,"boolean")&&a(WI.AuditTestCaseResult.Level.Warn);break;case"fail":k(H,O,"boolean")&&a(WI.AuditTestCaseResult.Level.Fail);break;case"error":k(H,O,"boolean")&&a(WI.AuditTestCaseResult.Level.Error);break;case"unsupported":k(H,O,"boolean")&&a(WI.AuditTestCaseResult.Level.Unsupported);break;case"domNodes":await R(H,O,async z=>{if(!z||!z.value||z.value.type!=="object"||z.value.subtype!=="node"){d(WI.UIString('All items in "%s" must be valid DOM nodes').format(WI.unlocalizedString("domNodes")));return}let K=await new Promise((Y,se)=>z.value.pushNodeToFrontend(Y)),q=WI.domManager.nodeForId(K);!q||(i.domNodes||(i.domNodes=[]),i.domNodes.push(WI.cssPath(q,{full:!0})),s||(s=[]),s.push(q))});break;case"domAttributes":await R(H,O,z=>{if(!z||!z.value||z.value.type!=="string"||!z.value.value.length){d(WI.UIString('All items in "%s" must be non-empty strings').format(WI.unlocalizedString("domAttributes")));return}i.domAttributes||(i.domAttributes=[]),i.domAttributes.push(z.value.value)});break;case"errors":await R(H,O,z=>{if(!z||!z.value||z.value.type!=="object"||z.value.subtype!=="error"){d(WI.UIString('All items in "%s" must be error objects').format(WI.unlocalizedString("errors")));return}d(z.value.description)});break;default:if(O.objectId)try{let z=function(){return JSON.stringify(this)};var L=z;let K=await O.callFunction(z);i[H]=JSON.parse(K.value)}catch{d(WI.UIString('"%s" is not JSON serializable').format(H))}else i[H]=O.value;break}}}let f=null,_={};InspectorBackend.domains.Audit?(f=AuditAgent.run,_.test=this._test):(f=RuntimeAgent.evaluate,_.expression=`(function() { "use strict"; return eval(\`(${this._test.replace(/`/g,"\\`")})\`)(); })()`,_.objectGroup=WI.AuditTestCase.ObjectGroup,_.doNotPauseOnExceptionsAndMuteConsole=!0);try{n.startTimestamp=new Date;let w=await f.invoke(_);n.endTimestamp=new Date,w.result.type==="object"&&w.result.className==="Promise"&&(WI.RuntimeManager.supportsAwaitPromise()?(n.asyncTimestamp=n.endTimestamp,w=await RuntimeAgent.awaitPromise(w.result.objectId),n.endTimestamp=new Date):(w=null,d(WI.UIString("Async audits are not supported.")),a(WI.AuditTestCaseResult.Level.Unsupported))),w&&await p(w)}catch(w){n.endTimestamp=new Date,d(w.message)}t||d(WI.UIString("Missing result level"));let b={description:this.description,metadata:n};isEmptyObject(i)||(b.data=i),s&&(b.resolvedDOMNodes=s),this._result=new WI.AuditTestCaseResult(this.name,t,b),this.dispatchEventToListeners(WI.AuditTestBase.Event.ResultChanged)}};WI.AuditTestCase.TypeIdentifier="test-case";WI.AuditTestGroup=class extends WI.AuditTestBase{constructor(e,t,i={}){console.assert(Array.isArray(t));let n=i.disabled;i.disabled=!1,super(e,i),this._tests=t,this._preventDisabledPropagation=!1,(n||!this.supported)&&(this.disabled=!0);let s=!1;for(let a of this._tests)this.supported?a.supported&&(s=!0):a.supported=!1,a.addEventListener(WI.AuditTestBase.Event.Completed,this._handleTestCompleted,this),a.addEventListener(WI.AuditTestBase.Event.DisabledChanged,this._handleTestDisabledChanged,this),a.addEventListener(WI.AuditTestBase.Event.Progress,this._handleTestProgress,this);s||(this.supported=!1)}static async fromPayload(e){if(typeof e!="object"||e===null||e.type!==WI.AuditTestGroup.TypeIdentifier)return null;if(typeof e.name!="string")return WI.AuditManager.synthesizeError(WI.UIString('"%s" has a non-string "%s" value').format(e.name,WI.unlocalizedString("name"))),null;if(!Array.isArray(e.tests))return WI.AuditManager.synthesizeError(WI.UIString('"%s" has a non-array "%s" value').format(e.name,WI.unlocalizedString("tests"))),null;let t=await Promise.all(e.tests.map(async n=>{let s=await WI.AuditTestCase.fromPayload(n);if(s)return s;let a=await WI.AuditTestGroup.fromPayload(n);return a||null}));if(t=t.filter(n=>!!n),!t.length)return null;let i={};return typeof e.description=="string"?i.description=e.description:"description"in e&&WI.AuditManager.synthesizeWarning(WI.UIString('"%s" has a non-string "%s" value').format(e.name,WI.unlocalizedString("description"))),typeof e.supports=="number"?i.supports=e.supports:"supports"in e&&WI.AuditManager.synthesizeWarning(WI.UIString('"%s" has a non-number "%s" value').format(e.name,WI.unlocalizedString("supports"))),typeof e.setup=="string"?i.setup=e.setup:"setup"in e&&WI.AuditManager.synthesizeWarning(WI.UIString('"%s" has a non-string "%s" value').format(e.name,WI.unlocalizedString("setup"))),typeof e.disabled=="boolean"&&(i.disabled=e.disabled),new WI.AuditTestGroup(e.name,t,i)}get tests(){return this._tests}get supported(){return super.supported}set supported(e){for(let t of this._tests)t.supported=e;super.supported=e}get disabled(){return super.disabled}set disabled(e){if(!this._preventDisabledPropagation)for(let t of this._tests)t.disabled=e;super.disabled=e}stop(){for(let e of this._tests)e.stop();super.stop()}clearResult(e={}){let t=!!this._result;for(let i of this._tests)i.clearResult(e)&&(t=!0);return super.clearResult({...e,suppressResultChangedEvent:!t})}toJSON(e){let t=super.toJSON(e);return t.tests=this._tests.map(i=>i.toJSON(e)),t}async run(){let e=this._tests.length;for(let t=0;t<e&&this._runningState===WI.AuditManager.RunningState.Active;++t){let i=this._tests[t];i.disabled||(await i.start(),i instanceof WI.AuditTestCase&&this.dispatchEventToListeners(WI.AuditTestBase.Event.Progress,{index:t,count:e}))}this._updateResult()}_updateResult(){let e=this._tests.map(t=>t.result).filter(t=>!!t);!e.length||(this._result=new WI.AuditTestGroupResult(this.name,e,{description:this.description}),this.dispatchEventToListeners(WI.AuditTestBase.Event.ResultChanged))}_handleTestCompleted(e){this._runningState!==WI.AuditManager.RunningState.Active&&(this._updateResult(),this.dispatchEventToListeners(WI.AuditTestBase.Event.Completed))}_handleTestDisabledChanged(e){let t=this._tests.filter(i=>!i.disabled).length;e.target.disabled&&!t?this.disabled=!0:!e.target.disabled&&t===1?(this._preventDisabledPropagation=!0,this.disabled=!1,this._preventDisabledPropagation=!1):this.dispatchEventToListeners(WI.AuditTestBase.Event.DisabledChanged)}_handleTestProgress(e){if(this._runningState!==WI.AuditManager.RunningState.Active)return;let t=i=>{let n=0;for(let s of i)s.disabled||(s instanceof WI.AuditTestCase?++n:s instanceof WI.AuditTestGroup&&(n+=t(s.tests)));return n};this.dispatchEventToListeners(WI.AuditTestBase.Event.Progress,{index:e.data.index+t(this._tests.slice(0,this._tests.indexOf(e.target))),count:t(this._tests)})}};WI.AuditTestGroup.TypeIdentifier="test-group";WI.AuditTestResultBase=class{constructor(e,{description:t}={}){console.assert(typeof e=="string"),console.assert(!t||typeof t=="string"),this._name=e,this._description=t||null}get name(){return this._name}get description(){return this._description}get result(){return this}get didPass(){throw WI.NotImplementedError.subclassMustOverride()}get didWarn(){throw WI.NotImplementedError.subclassMustOverride()}get didFail(){throw WI.NotImplementedError.subclassMustOverride()}get didError(){throw WI.NotImplementedError.subclassMustOverride()}get unsupported(){throw WI.NotImplementedError.subclassMustOverride()}saveIdentityToCookie(e){e["audit-"+this.constructor.TypeIdentifier+"-name"]=this._name}toJSON(){let e={type:this.constructor.TypeIdentifier,name:this._name};return this._description&&(e.description=this._description),e}};WI.AuditTestCaseResult=class extends WI.AuditTestResultBase{constructor(e,t,{description:i,data:n,metadata:s,resolvedDOMNodes:a}={}){console.assert(Object.values(WI.AuditTestCaseResult.Level).includes(t)),console.assert(!n||typeof n=="object"),console.assert(!s||typeof s=="object"),super(e,{description:i}),this._level=t,this._data=n||{},this._metadata=s||{},this._resolvedDOMNodes=a||[]}static async fromPayload(e){if(typeof e!="object"||e===null||e.type!==WI.AuditTestCaseResult.TypeIdentifier)return null;if(typeof e.name!="string")return WI.AuditManager.synthesizeError(WI.UIString('"%s" has a non-string "%s" value').format(e.name,WI.unlocalizedString("name"))),null;if(!Object.values(WI.AuditTestCaseResult.Level).includes(e.level))return WI.AuditManager.synthesizeError(WI.UIString('"%s" has an invalid "%s" value').format(e.name,WI.unlocalizedString("level"))),null;if(typeof e.data!="object"||e.data===null)"data"in e&&WI.AuditManager.synthesizeWarning(WI.UIString('"%s" has a non-object "%s" value').format(e.name,WI.unlocalizedString("data"))),e.data={};else{let n=function(s){s in e.data&&(Array.isArray(e.data[s])||(WI.AuditManager.synthesizeWarning(WI.UIString('"%s" has a non-array "%s" value').format(e.name,WI.unlocalizedString("data.%s").format(s))),e.data[s]=[]),e.data[s]=e.data[s].filter(a=>typeof a=="string"))};var i=n;n("domNodes"),n("domAttributes"),n("errors")}typeof e.metadata!="object"||e.metadata===null?("metadata"in e&&WI.AuditManager.synthesizeWarning(WI.UIString('"%s" has a non-object "%s" value').format(e.name,WI.unlocalizedString("metadata"))),e.metadata={}):(typeof e.metadata.startTimestamp=="string"?e.metadata.startTimestamp=new Date(e.metadata.startTimestamp):("startTimestamp"in e.metadata&&WI.AuditManager.synthesizeWarning(WI.UIString('"%s" has a non-object "%s" value').format(e.name,WI.unlocalizedString("metadata.startTimestamp"))),e.metadata.startTimestamp=null),typeof e.metadata.asyncTimestamp=="string"?e.metadata.asyncTimestamp=new Date(e.metadata.asyncTimestamp):("asyncTimestamp"in e.metadata&&WI.AuditManager.synthesizeWarning(WI.UIString('"%s" has a non-object "%s" value').format(e.name,WI.unlocalizedString("metadata.asyncTimestamp"))),e.metadata.asyncTimestamp=null),typeof e.metadata.endTimestamp=="string"?e.metadata.endTimestamp=new Date(e.metadata.endTimestamp):("endTimestamp"in e.metadata&&WI.AuditManager.synthesizeWarning(WI.UIString('"%s" has a non-object "%s" value').format(e.name,WI.unlocalizedString("metadata.endTimestamp"))),e.metadata.endTimestamp=null),typeof e.metadata.url!="string"&&("url"in e.metadata&&WI.AuditManager.synthesizeWarning(WI.UIString('"%s" has a non-object "%s" value').format(e.name,WI.unlocalizedString("metadata.url"))),e.metadata.url=null));let t={};if(typeof e.description=="string"?t.description=e.description:"description"in e&&WI.AuditManager.synthesizeWarning(WI.UIString('"%s" has a non-string "%s" value').format(e.name,WI.unlocalizedString("description"))),!isEmptyObject(e.data)){t.data={};for(let n in e.data)if(!((n==="domNodes"||n==="domAttributes"||n==="errors")&&!e.data[n].length)){if(n==="domNodes"&&window.DOMAgent&&(!e.metadata.url||e.metadata.url===WI.networkManager.mainFrame.url)){let s=await new Promise(a=>WI.domManager.requestDocument(a));t.resolvedDOMNodes=await Promise.all(e.data.domNodes.map(async a=>{let d=0;try{d=await WI.domManager.querySelector(s,a)}catch{}return WI.domManager.nodeForId(d)||null}))}t.data[n]=e.data[n]}}return isEmptyObject(e.metadata)||(t.metadata={},e.metadata.startTimestamp&&!isNaN(e.metadata.startTimestamp)&&(t.metadata.startTimestamp=e.metadata.startTimestamp),e.metadata.asyncTimestamp&&!isNaN(e.metadata.asyncTimestamp)&&(t.metadata.asyncTimestamp=e.metadata.asyncTimestamp),e.metadata.endTimestamp&&!isNaN(e.metadata.endTimestamp)&&(t.metadata.endTimestamp=e.metadata.endTimestamp),e.metadata.url&&(t.metadata.url=e.metadata.url)),new WI.AuditTestCaseResult(e.name,e.level,t)}get level(){return this._level}get data(){return this._data}get metadata(){return this._metadata}get resolvedDOMNodes(){return this._resolvedDOMNodes}get result(){return this}get didPass(){return this._level===WI.AuditTestCaseResult.Level.Pass}get didWarn(){return this._level===WI.AuditTestCaseResult.Level.Warn}get didFail(){return this._level===WI.AuditTestCaseResult.Level.Fail}get didError(){return this._level===WI.AuditTestCaseResult.Level.Error}get unsupported(){return this._level===WI.AuditTestCaseResult.Level.Unsupported}toJSON(){let e=super.toJSON();e.level=this._level;let t={};for(let n in this._data)(n==="domNodes"||n==="domAttributes"||n==="errors")&&!this._data[n].length||(t[n]=this._data[n]);isEmptyObject(t)||(e.data=t);let i={};return this._metadata.startTimestamp&&!isNaN(this._metadata.startTimestamp)&&(i.startTimestamp=this._metadata.startTimestamp),this._metadata.asyncTimestamp&&!isNaN(this._metadata.asyncTimestamp)&&(i.asyncTimestamp=this._metadata.asyncTimestamp),this._metadata.endTimestamp&&!isNaN(this._metadata.endTimestamp)&&(i.endTimestamp=this._metadata.endTimestamp),this._metadata.url&&(i.url=this._metadata.url),isEmptyObject(i)||(e.metadata=i),e}};WI.AuditTestCaseResult.TypeIdentifier="test-case-result";WI.AuditTestCaseResult.Level={Pass:"pass",Warn:"warn",Fail:"fail",Error:"error",Unsupported:"unsupported"};WI.AuditTestGroupResult=class extends WI.AuditTestResultBase{constructor(e,t,{description:i}={}){console.assert(Array.isArray(t)),super(e,{description:i}),this._results=t}static async fromPayload(e){if(typeof e!="object"||e===null||e.type!==WI.AuditTestGroupResult.TypeIdentifier)return null;if(typeof e.name!="string")return WI.AuditManager.synthesizeError(WI.UIString('"%s" has a non-string "%s" value').format(e.name,WI.unlocalizedString("name"))),null;if(!Array.isArray(e.results))return WI.AuditManager.synthesizeError(WI.UIString('"%s" has a non-array "%s" value').format(e.name,WI.unlocalizedString("results"))),null;let t=await Promise.all(e.results.map(async n=>{let s=await WI.AuditTestCaseResult.fromPayload(n);if(s)return s;let a=await WI.AuditTestGroupResult.fromPayload(n);return a||null}));if(t=t.filter(n=>!!n),!t.length)return null;let i={};return typeof e.description=="string"?i.description=e.description:"description"in e&&WI.AuditManager.synthesizeWarning(WI.UIString('"%s" has a non-string "%s" value').format(e.name,WI.unlocalizedString("description"))),new WI.AuditTestGroupResult(e.name,t,i)}get results(){return this._results}get levelCounts(){let e={};for(let t of Object.values(WI.AuditTestCaseResult.Level))e[t]=0;for(let t of this._results)if(t instanceof WI.AuditTestCaseResult)++e[t.level];else if(t instanceof WI.AuditTestGroupResult)for(let[i,n]of Object.entries(t.levelCounts))e[i]+=n;return e}get didPass(){return this._results.some(e=>e.didPass)}get didWarn(){return this._results.some(e=>e.didWarn)}get didFail(){return this._results.some(e=>e.didFail)}get didError(){return this._results.some(e=>e.didError)}get unsupported(){return this._results.some(e=>e.unsupported)}toJSON(){let e=super.toJSON();return e.results=this._results.map(t=>t.toJSON()),e}};WI.AuditTestGroupResult.TypeIdentifier="test-group-result";WI.FormatterWorkerProxy=class ud{constructor(){this._formatterWorker=new Worker("Workers/Formatter/FormatterWorker.js"),this._formatterWorker.addEventListener("message",this._handleMessage.bind(this)),this._nextCallId=1,this._callbacks=new Map}static singleton(){return ud.instance||(ud.instance=new ud),ud.instance}formatJavaScript(e,t,i,n){this.performAction("formatJavaScript",...arguments)}formatCSS(e,t,i){this.performAction("formatCSS",...arguments)}performAction(e){let t=this._nextCallId++,i=arguments[arguments.length-1],n=Array.prototype.slice.call(arguments,1,arguments.length-1);console.assert(typeof e=="string","performAction should always have an actionName"),console.assert(typeof i=="function","performAction should always have a callback"),this._callbacks.set(t,i),this._postMessage({callId:t,actionName:e,actionArguments:n})}_postMessage(){this._formatterWorker.postMessage(...arguments)}_handleMessage(e){let t=e.data;if(t.callId){let i=this._callbacks.get(t.callId);this._callbacks.delete(t.callId),i(t.result);return}console.error("Unexpected FormatterWorker message",t)}};WI.HeapSnapshotDiffProxy=class extends WI.Object{constructor(e,t,i,n,s,a){super(),this._proxyObjectId=e,console.assert(t instanceof WI.HeapSnapshotProxy),console.assert(i instanceof WI.HeapSnapshotProxy),this._snapshot1=t,this._snapshot2=i,this._totalSize=n,this._totalObjectCount=s,this._categories=Map.fromObject(a)}static deserialize(e,t){let{snapshot1:i,snapshot2:n,totalSize:s,totalObjectCount:a,categories:d}=t,p=WI.HeapSnapshotProxy.deserialize(e,i),f=WI.HeapSnapshotProxy.deserialize(e,n);return new WI.HeapSnapshotDiffProxy(e,p,f,s,a,d)}get snapshot1(){return this._snapshot1}get snapshot2(){return this._snapshot2}get totalSize(){return this._totalSize}get totalObjectCount(){return this._totalObjectCount}get categories(){return this._categories}get invalid(){return this._snapshot1.invalid||this._snapshot2.invalid}updateForCollectionEvent(e){console.assert(!this.invalid),e.data.affectedSnapshots.includes(this._snapshot2._identifier)&&this.update(()=>{this.dispatchEventToListeners(WI.HeapSnapshotProxy.Event.CollectedNodes,e.data)})}allocationBucketCounts(e,t){console.assert(!this.invalid),WI.HeapSnapshotWorkerProxy.singleton().callMethod(this._proxyObjectId,"allocationBucketCounts",e,t)}instancesWithClassName(e,t){console.assert(!this.invalid),WI.HeapSnapshotWorkerProxy.singleton().callMethod(this._proxyObjectId,"instancesWithClassName",e,i=>{t(i.map(WI.HeapSnapshotNodeProxy.deserialize.bind(null,this._proxyObjectId)))})}update(e){console.assert(!this.invalid),WI.HeapSnapshotWorkerProxy.singleton().callMethod(this._proxyObjectId,"update",({liveSize:t,categories:i})=>{this._categories=Map.fromObject(i),e()})}nodeWithIdentifier(e,t){console.assert(!this.invalid),WI.HeapSnapshotWorkerProxy.singleton().callMethod(this._proxyObjectId,"nodeWithIdentifier",e,i=>{t(WI.HeapSnapshotNodeProxy.deserialize(this._proxyObjectId,i))})}};WI.HeapSnapshotEdgeProxy=class{constructor(e,t,i,n,s){this._proxyObjectId=e,console.assert(n in WI.HeapSnapshotEdgeProxy.EdgeType),this.fromIdentifier=t,this.toIdentifier=i,this.type=n,this.data=s,this.from=null,this.to=null}isPrivateSymbol(){return WI.isDebugUIEnabled()?!1:typeof this.data=="string"&&this.data.startsWith("PrivateSymbol")}static deserialize(e,t){let{from:i,to:n,type:s,data:a}=t;return new WI.HeapSnapshotEdgeProxy(e,i,n,s,a)}};WI.HeapSnapshotEdgeProxy.EdgeType={Internal:"Internal",Property:"Property",Index:"Index",Variable:"Variable"};WI.HeapSnapshotNodeProxy=class{constructor(e,{id:t,className:i,size:n,retainedSize:s,internal:a,isObjectType:d,gcRoot:p,dead:f,dominatorNodeIdentifier:_,hasChildren:b}){this._proxyObjectId=e,this.id=t,this.className=i,this.size=n,this.retainedSize=s,this.internal=a,this.isObjectType=d,this.gcRoot=p,this.dead=f,this.dominatorNodeIdentifier=_,this.hasChildren=b}static deserialize(e,t){return new WI.HeapSnapshotNodeProxy(e,t)}shortestGCRootPath(e){WI.HeapSnapshotWorkerProxy.singleton().callMethod(this._proxyObjectId,"shortestGCRootPath",this.id,t=>{let i=!1,n=t.map(s=>(i=!i,i?WI.HeapSnapshotNodeProxy.deserialize(this._proxyObjectId,s):WI.HeapSnapshotEdgeProxy.deserialize(this._proxyObjectId,s)));for(let s=1;s<n.length;s+=2){console.assert(n[s]instanceof WI.HeapSnapshotEdgeProxy);let a=n[s];a.from=n[s-1],a.to=n[s+1]}e(n)})}dominatedNodes(e){WI.HeapSnapshotWorkerProxy.singleton().callMethod(this._proxyObjectId,"dominatedNodes",this.id,t=>{e(t.map(WI.HeapSnapshotNodeProxy.deserialize.bind(null,this._proxyObjectId)))})}retainedNodes(e){WI.HeapSnapshotWorkerProxy.singleton().callMethod(this._proxyObjectId,"retainedNodes",this.id,({retainedNodes:t,edges:i})=>{let n=t.map(WI.HeapSnapshotNodeProxy.deserialize.bind(null,this._proxyObjectId)),s=i.map(WI.HeapSnapshotEdgeProxy.deserialize.bind(null,this._proxyObjectId));e(n,s)})}retainers(e){WI.HeapSnapshotWorkerProxy.singleton().callMethod(this._proxyObjectId,"retainers",this.id,({retainers:t,edges:i})=>{let n=t.map(WI.HeapSnapshotNodeProxy.deserialize.bind(null,this._proxyObjectId)),s=i.map(WI.HeapSnapshotEdgeProxy.deserialize.bind(null,this._proxyObjectId));e(n,s)})}};WI.HeapSnapshotProxy=class extends WI.Object{constructor(e,t,i,n,s,a,d,p){super(),this._proxyObjectId=e,this._identifier=t,this._title=i,this._totalSize=n,this._totalObjectCount=s,this._liveSize=a,this._categories=Map.fromObject(d),this._imported=p,this._snapshotStringData=null,console.assert(!this.invalid),WI.HeapSnapshotProxy.ValidSnapshotProxies||(WI.HeapSnapshotProxy.ValidSnapshotProxies=[]),WI.HeapSnapshotProxy.ValidSnapshotProxies.push(this)}static deserialize(e,t){let{identifier:i,title:n,totalSize:s,totalObjectCount:a,liveSize:d,categories:p,imported:f}=t;return new WI.HeapSnapshotProxy(e,i,n,s,a,d,p,f)}static invalidateSnapshotProxies(){if(!!WI.HeapSnapshotProxy.ValidSnapshotProxies){for(let e of WI.HeapSnapshotProxy.ValidSnapshotProxies)e._invalidate();WI.HeapSnapshotProxy.ValidSnapshotProxies=null}}get proxyObjectId(){return this._proxyObjectId}get identifier(){return this._identifier}get title(){return this._title}get totalSize(){return this._totalSize}get totalObjectCount(){return this._totalObjectCount}get liveSize(){return this._liveSize}get categories(){return this._categories}get imported(){return this._imported}get invalid(){return this._proxyObjectId===0}get snapshotStringData(){return this._snapshotStringData}set snapshotStringData(e){this._snapshotStringData=e}updateForCollectionEvent(e){console.assert(!this.invalid),e.data.affectedSnapshots.includes(this._identifier)&&this.update(()=>{this.dispatchEventToListeners(WI.HeapSnapshotProxy.Event.CollectedNodes,e.data)})}allocationBucketCounts(e,t){console.assert(!this.invalid),WI.HeapSnapshotWorkerProxy.singleton().callMethod(this._proxyObjectId,"allocationBucketCounts",e,t)}instancesWithClassName(e,t){console.assert(!this.invalid),WI.HeapSnapshotWorkerProxy.singleton().callMethod(this._proxyObjectId,"instancesWithClassName",e,i=>{t(i.map(WI.HeapSnapshotNodeProxy.deserialize.bind(null,this._proxyObjectId)))})}update(e){console.assert(!this.invalid),WI.HeapSnapshotWorkerProxy.singleton().callMethod(this._proxyObjectId,"update",({liveSize:t,categories:i})=>{this._liveSize=t,this._categories=Map.fromObject(i),e()})}nodeWithIdentifier(e,t){console.assert(!this.invalid),WI.HeapSnapshotWorkerProxy.singleton().callMethod(this._proxyObjectId,"nodeWithIdentifier",e,i=>{t(WI.HeapSnapshotNodeProxy.deserialize(this._proxyObjectId,i))})}_invalidate(){this._proxyObjectId=0,this._liveSize=0,this.dispatchEventToListeners(WI.HeapSnapshotProxy.Event.Invalidated)}};WI.HeapSnapshotProxy.Event={CollectedNodes:"heap-snapshot-proxy-collected-nodes",Invalidated:"heap-snapshot-proxy-invalidated"};WI.HeapSnapshotWorkerProxy=class pd extends WI.Object{constructor(){super(),this._heapSnapshotWorker=new Worker("Workers/HeapSnapshot/HeapSnapshotWorker.js"),this._heapSnapshotWorker.addEventListener("message",this._handleMessage.bind(this)),this._nextCallId=1,this._callbacks=new Map,WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this)}static singleton(){return pd.instance||(pd.instance=new pd),pd.instance}clearSnapshots(e){this.performAction("clearSnapshots",e)}createSnapshot(e,t){this.performAction("createSnapshot",...arguments)}createSnapshotDiff(e,t,i){this.performAction("createSnapshotDiff",...arguments)}createImportedSnapshot(e,t,i){this.performAction("createSnapshot",e,t,!0,i)}performAction(e){let t=this._nextCallId++,i=arguments[arguments.length-1],n=Array.prototype.slice.call(arguments,1,arguments.length-1);console.assert(typeof e=="string","performAction should always have an actionName"),console.assert(typeof i=="function","performAction should always have a callback"),this._callbacks.set(t,i),this._postMessage({callId:t,actionName:e,actionArguments:n})}callMethod(e,t){let i=this._nextCallId++,n=arguments[arguments.length-1],s=Array.prototype.slice.call(arguments,2,arguments.length-1);console.assert(typeof e=="number","callMethod should always have an objectId"),console.assert(typeof t=="string","callMethod should always have a methodName"),console.assert(typeof n=="function","callMethod should always have a callback"),this._callbacks.set(i,n),this._postMessage({callId:i,objectId:e,methodName:t,methodArguments:s})}_mainResourceDidChange(e){!e.target.isMainFrame()||this.clearSnapshots(()=>{WI.HeapSnapshotProxy.invalidateSnapshotProxies()})}_postMessage(){this._heapSnapshotWorker.postMessage(...arguments)}_handleMessage(e){let t=e.data;if(t.error){console.assert(t.callId),this._callbacks.delete(t.callId);return}if(t.eventName){this.dispatchEventToListeners(t.eventName,t.eventData);return}if(t.callId){let i=this._callbacks.get(t.callId);this._callbacks.delete(t.callId),i(t.result);return}console.error("Unexpected HeapSnapshotWorker message",t)}};WI.View=class extends WI.Object{constructor(e){super(),this._element=e||document.createElement("div"),this._element.__view=this,this._parentView=null,this._subviews=[],this._dirty=!1,this._dirtyDescendantsCount=0,this._isAttachedToRoot=!1,this._layoutReason=null,this._didInitialLayout=!1}static fromElement(e){return!e||!(e instanceof HTMLElement)?null:e.__view instanceof WI.View?e.__view:null}static rootView(){return WI.View._rootView||(WI.View._rootView=new WI.View(document.body),WI.View._rootView._isAttachedToRoot=!0),WI.View._rootView}get element(){return this._element}get layoutPending(){return this._dirty}get parentView(){return this._parentView}get subviews(){return this._subviews}get isAttached(){return this._isAttachedToRoot}isDescendantOf(e){let t=this._parentView;for(;t;){if(t===e)return!0;t=t.parentView}return!1}addSubview(e){this.insertSubviewBefore(e,null)}insertSubviewBefore(e,t){if(console.assert(e instanceof WI.View),console.assert(!t||t instanceof WI.View),console.assert(e!==WI.View._rootView,"Root view cannot be a subview."),this._subviews.includes(e)){console.assert(!1,"Cannot add view that is already a subview.",e);return}const i=t?this._subviews.indexOf(t):this._subviews.length;if(i===-1){console.assert(!1,"Cannot insert view. Invalid reference view.",t);return}this._subviews.insertAtIndex(e,i),console.assert(!e.element.parentNode||this._element.contains(e.element.parentNode),"Subview DOM element must be a descendant of the parent view element."),e.element.parentNode||this._element.insertBefore(e.element,t?t.element:null),e._didMoveToParent(this)}removeSubview(e){console.assert(e instanceof WI.View),console.assert(this._element.contains(e.element),"Subview DOM element must be a child of the parent view element.");let t=this._subviews.lastIndexOf(e);if(t===-1){console.assert(!1,"Cannot remove view which isn't a subview.",e);return}this._subviews.splice(t,1),e.element.remove(),e._didMoveToParent(null)}removeAllSubviews(){for(let e of this._subviews)e._didMoveToParent(null);this._subviews=[],this._element.removeChildren()}replaceSubview(e,t){console.assert(e!==t,"Cannot replace subview with itself."),e!==t&&(this.insertSubviewBefore(t,e),this.removeSubview(e))}updateLayout(e){this.cancelLayout(),this._setLayoutReason(e),this._layoutSubtree()}updateLayoutIfNeeded(e){!this._dirty&&this._didInitialLayout||this.updateLayout(e)}needsLayout(e){this._setLayoutReason(e),!this._dirty&&WI.View._scheduleLayoutForView(this)}cancelLayout(){WI.View._cancelScheduledLayoutForView(this)}get layoutReason(){return this._layoutReason}get didInitialLayout(){return this._didInitialLayout}attached(){}detached(){}initialLayout(){}layout(){}didLayoutSubtree(){}sizeDidChange(){}_didMoveToParent(e){this._parentView=e;let t=this.isDescendantOf(WI.View._rootView);if(this._didMoveToWindow(t),!this._parentView)return;let i=this._dirtyDescendantsCount;this._dirty&&i++;let n=this._parentView;for(;n;)n._dirtyDescendantsCount+=i,n=n.parentView}_didMoveToWindow(e){if(this._isAttachedToRoot!==e){this._isAttachedToRoot=e,this._isAttachedToRoot?(WI.View._scheduleLayoutForView(this),this.attached()):(this._dirty&&this.cancelLayout(),this.detached());for(let t of this._subviews)t._didMoveToWindow(e)}}_layoutSubtree(){this._dirty=!1,this._dirtyDescendantsCount=0;let e=!this._didInitialLayout;e&&(this.initialLayout(),this._didInitialLayout=!0),(this._layoutReason===WI.View.LayoutReason.Resize||e)&&this.sizeDidChange();let t=this._layoutReason;e&&this._setLayoutReason(),this.layout(),this._layoutReason=t,WI.settings.enableLayoutFlashing.value&&this._drawLayoutFlashingOutline(e);for(let i of this._subviews)i._setLayoutReason(this._layoutReason),i._layoutSubtree();this._layoutReason=null,this.didLayoutSubtree()}_setLayoutReason(e){this._layoutReason=e||WI.View.LayoutReason.Dirty}_drawLayoutFlashingOutline(e){this._layoutFlashingTimeout?clearTimeout(this._layoutFlashingTimeout):this._layoutFlashingPreviousOutline=this._element.style.outline;let t=e?20:40;this._element.style.outline=`1px solid hsla(${t}, 100%, 51%, 0.8)`,this._layoutFlashingTimeout=setTimeout(()=>{this._element&&(this._element.style.outline=this._layoutFlashingPreviousOutline),this._layoutFlashingTimeout=void 0,this._layoutFlashingPreviousOutline=null},500)}static _scheduleLayoutForView(e){e._dirty=!0;let t=e.parentView;for(;t;)t._dirtyDescendantsCount++,t=t.parentView;!e._isAttachedToRoot||WI.View._scheduledLayoutUpdateIdentifier||(WI.View._scheduledLayoutUpdateIdentifier=requestAnimationFrame(WI.View._visitViewTreeForLayout))}static _cancelScheduledLayoutForView(e){let t=e._dirtyDescendantsCount;e.layoutPending&&t++;let i=e.parentView;for(;i;)i._dirtyDescendantsCount=Math.max(0,i._dirtyDescendantsCount-t),i=i.parentView;if(e._dirty=!1,!WI.View._scheduledLayoutUpdateIdentifier)return;let n=WI.View._rootView;!n||n._dirtyDescendantsCount||(cancelAnimationFrame(WI.View._scheduledLayoutUpdateIdentifier),WI.View._scheduledLayoutUpdateIdentifier=void 0)}static _visitViewTreeForLayout(){console.assert(WI.View._rootView,"Cannot layout view tree without a root."),WI.View._scheduledLayoutUpdateIdentifier=void 0;let e=[WI.View._rootView];for(;e.length;){let t=e.shift();t.layoutPending?t._layoutSubtree():t._dirtyDescendantsCount&&(e=e.concat(t.subviews),t._dirtyDescendantsCount=0)}}};WI.View.LayoutReason={Dirty:Symbol("layout-reason-dirty"),Resize:Symbol("layout-reason-resize")};WI.View._rootView=null;WI.View._scheduledLayoutUpdateIdentifier=void 0;WI.SelectionController=class extends WI.Object{constructor(e,t){super(),console.assert(e),console.assert(typeof t=="function"),this._delegate=e,this._comparator=t,this._allowsEmptySelection=!0,this._allowsMultipleSelection=!1,this._lastSelectedItem=null,this._shiftAnchorItem=null,this._selectedItems=new Set,this._suppressSelectionDidChange=!1,console.assert(this._delegate.selectionControllerFirstSelectableItem,"SelectionController delegate must implement selectionControllerFirstSelectableItem."),console.assert(this._delegate.selectionControllerLastSelectableItem,"SelectionController delegate must implement selectionControllerLastSelectableItem."),console.assert(this._delegate.selectionControllerNextSelectableItem,"SelectionController delegate must implement selectionControllerNextSelectableItem."),console.assert(this._delegate.selectionControllerPreviousSelectableItem,"SelectionController delegate must implement selectionControllerPreviousSelectableItem.")}get delegate(){return this._delegate}get lastSelectedItem(){return this._lastSelectedItem}get selectedItems(){return this._selectedItems}get allowsEmptySelection(){return this._allowsEmptySelection}set allowsEmptySelection(e){this._allowsEmptySelection=e}get allowsMultipleSelection(){return this._allowsMultipleSelection}set allowsMultipleSelection(e){this._allowsMultipleSelection!==e&&(this._allowsMultipleSelection=e,!this._allowsMultipleSelection&&this._selectedItems.size>1&&this._updateSelectedItems(new Set([this._lastSelectedItem])))}hasSelectedItem(e){return this._selectedItems.has(e)}selectItem(e,t=!1){console.assert(e,"Invalid item for selection."),console.assert(!t||this._allowsMultipleSelection,"Cannot extend selection with multiple selection disabled."),this._allowsMultipleSelection||(t=!1),this._lastSelectedItem=e,this._shiftAnchorItem=null;let i=new Set(t?this._selectedItems:null);i.add(e),this._updateSelectedItems(i)}selectItems(e){console.assert(this._allowsMultipleSelection,"Cannot select multiple items with multiple selection disabled."),this._allowsMultipleSelection&&((!this._lastSelectedItem||!e.has(this._lastSelectedItem))&&(this._lastSelectedItem=e.lastValue),(!this._shiftAnchorItem||!e.has(this._shiftAnchorItem))&&(this._shiftAnchorItem=this._lastSelectedItem),this._updateSelectedItems(e))}deselectItem(e){if(console.assert(e,"Invalid item for selection."),!this.hasSelectedItem(e)||!this._allowsEmptySelection&&this._selectedItems.size===1)return;let t=new Set(this._selectedItems);if(t.delete(e),this._lastSelectedItem===e&&(this._lastSelectedItem=null,t.size)){let i=e,n=e;for(;!this._lastSelectedItem&&i&&n;){if(i=this._previousSelectableItem(i),this.hasSelectedItem(i)){this._lastSelectedItem=i;break}if(n=this._nextSelectableItem(n),this.hasSelectedItem(n)){this._lastSelectedItem=n;break}}}this._shiftAnchorItem===e&&(this._shiftAnchorItem=null),this._updateSelectedItems(t)}selectAll(){if(!this._allowsMultipleSelection)return;this.reset();let e=new Set;this._addRange(e,this._firstSelectableItem(),this._lastSelectableItem()),this.selectItems(e)}deselectAll(){this._deselectAllAndSelect(null)}removeSelectedItems(){if(!this._selectedItems.size)return;let e=Array.from(this._selectedItems).sort(this._comparator),t=e[0],i=this._previousSelectableItem(t);if(!i){for(i=t;i&&this.hasSelectedItem(i);)i=this._nextSelectableItem(i);(!i||this.hasSelectedItem(i))&&(i=this._nextSelectableItem(e.lastValue))}this._deselectAllAndSelect(i)}reset(){this._lastSelectedItem=null,this._shiftAnchorItem=null,this._selectedItems.clear()}didRemoveItems(e){console.assert(e instanceof Set),!(!e.size||!this._selectedItems.size)&&this._updateSelectedItems(this._selectedItems.difference(e))}handleKeyDown(e){return e.key==="a"&&e.commandOrControlKey?(this.selectAll(),!0):e.metaKey||e.ctrlKey?!1:e.keyIdentifier==="Up"||e.keyIdentifier==="Down"?(this._selectItemsFromArrowKey(e.keyIdentifier==="Up",e.shiftKey),e.preventDefault(),e.stopPropagation(),!0):!1}handleItemMouseDown(e,t){if(console.assert(e,"Invalid item for selection."),t.button!==0||t.ctrlKey)return;if(t.commandOrControlKey){this.hasSelectedItem(e)?this.deselectItem(e):this.selectItem(e,this._allowsMultipleSelection);return}if(!(this._allowsMultipleSelection&&t.shiftKey)){this.selectItem(e);return}let n=new Set(this._selectedItems);if(!n.size){this._lastSelectedItem=e,this._shiftAnchorItem=this._firstSelectableItem(),this._addRange(n,this._shiftAnchorItem,this._lastSelectedItem),this._updateSelectedItems(n);return}this._shiftAnchorItem||(this._shiftAnchorItem=this._lastSelectedItem);let s=(p,f)=>[p,f].sort(this._comparator);if(this._shiftAnchorItem!==this._lastSelectedItem){let[p,f]=s(this._shiftAnchorItem,this._lastSelectedItem);this._deleteRange(n,p,f)}let[a,d]=s(this._shiftAnchorItem,e);this._addRange(n,a,d),this._lastSelectedItem=e,this._updateSelectedItems(n)}_deselectAllAndSelect(e){if(!this._selectedItems.size&&!e||this._selectedItems.size===1&&this.hasSelectedItem(e))return;this._lastSelectedItem=e,this._shiftAnchorItem=null;let t=new Set;e&&t.add(e),this._updateSelectedItems(t)}_selectItemsFromArrowKey(e,t){if(!this._selectedItems.size){this.selectItem(e?this._lastSelectableItem():this._firstSelectableItem());return}let i=e?this._previousSelectableItem(this._lastSelectedItem):this._nextSelectableItem(this._lastSelectedItem);if(!i)return;let n=t&&this._allowsMultipleSelection;if(!n||!this.hasSelectedItem(i)){this.selectItem(i,n);return}let s=e?this._nextSelectableItem(this._lastSelectedItem):this._previousSelectableItem(this._lastSelectedItem);if(!s||!this.hasSelectedItem(s)){this.deselectItem(this._lastSelectedItem);return}for(;i;){if(!this.hasSelectedItem(i)){this.selectItem(i,n);break}this._lastSelectedItem=i,i=e?this._previousSelectableItem(i):this._nextSelectableItem(i)}}_firstSelectableItem(){return this._delegate.selectionControllerFirstSelectableItem(this)}_lastSelectableItem(){return this._delegate.selectionControllerLastSelectableItem(this)}_previousSelectableItem(e){return this._delegate.selectionControllerPreviousSelectableItem(this,e)}_nextSelectableItem(e){return this._delegate.selectionControllerNextSelectableItem(this,e)}_updateSelectedItems(e){let t=this._selectedItems;if(this._selectedItems=e,this._suppressSelectionDidChange||!this._delegate.selectionControllerSelectionDidChange)return;let i=t.difference(e),n=e.difference(t);(i.size||n.size)&&this._delegate.selectionControllerSelectionDidChange(this,i,n)}_addRange(e,t,i){let n=t;for(;n&&(e.add(n),n!==i);)n=this._nextSelectableItem(n);console.assert(!i||e.has(i),"End of range could not be reached.")}_deleteRange(e,t,i){let n=t;for(;n&&(e.delete(n),n!==i);)n=this._nextSelectableItem(n);console.assert(!i||!e.has(i),"End of range could not be reached.")}};WI.ConsoleCommandView=class{constructor(e,t){this._commandText=e,this._className=t||""}render(){this._element=document.createElement("div"),this._element.classList.add("console-user-command"),this._element.setAttribute("data-labelprefix",WI.UIString("Input: ")),this._className&&this._element.classList.add(this._className),this._formattedCommandElement=this._element.appendChild(document.createElement("span")),this._formattedCommandElement.classList.add("console-message-body"),this._formattedCommandElement.textContent=this._commandText,this._element.__commandView=this}get element(){return this._element}get commandText(){return this._commandText}toClipboardString(e){return(e?"":"> ")+this._commandText.removeWordBreakCharacters()}};WI.ConsoleMessageView=class extends WI.Object{constructor(e){super(),console.assert(e instanceof WI.ConsoleMessage),this._message=e,this._expandable=!1,this._repeatCount=e._repeatCount||0,this._extraParameters=e.parameters}render(){switch(this._element=document.createElement("div"),this._element.classList.add("console-message"),this._element.__message=this._message,this._element.__messageView=this,this._message.type===WI.ConsoleMessage.MessageType.Result?(this._element.classList.add("console-user-command-result"),this._element.setAttribute("data-labelprefix",WI.UIString("Output: "))):(this._message.type===WI.ConsoleMessage.MessageType.StartGroup||this._message.type===WI.ConsoleMessage.MessageType.StartGroupCollapsed)&&this._element.classList.add("console-group-title"),this._message.level){case WI.ConsoleMessage.MessageLevel.Log:this._element.classList.add("console-log-level"),this._element.setAttribute("data-labelprefix",WI.UIString("Log: "));break;case WI.ConsoleMessage.MessageLevel.Info:this._element.classList.add("console-info-level"),this._element.setAttribute("data-labelprefix",WI.UIString("Info: "));break;case WI.ConsoleMessage.MessageLevel.Debug:this._element.classList.add("console-debug-level"),this._element.setAttribute("data-labelprefix",WI.UIString("Debug: "));break;case WI.ConsoleMessage.MessageLevel.Warning:this._element.classList.add("console-warning-level"),this._element.setAttribute("data-labelprefix",WI.UIString("Warning: "));break;case WI.ConsoleMessage.MessageLevel.Error:this._element.classList.add("console-error-level"),this._element.setAttribute("data-labelprefix",WI.UIString("Error: "));break}this._appendLocationLink(),this._messageBodyElement=this._element.appendChild(document.createElement("span")),this._messageBodyElement.classList.add("console-top-level-message","console-message-body"),this._appendMessageTextAndArguments(this._messageBodyElement),this._appendSavedResultIndex(),this._appendExtraParameters(),this._appendStackTrace(),this._renderRepeatCount(),this._message.type===WI.ConsoleMessage.MessageType.Image&&(this._element.classList.add("console-image-container"),this._element.addEventListener("contextmenu",this._handleContextMenu.bind(this)))}get element(){return this._element}get message(){return this._message}get repeatCount(){return this._repeatCount}set repeatCount(e){console.assert(typeof e=="number"),this._repeatCount!==e&&(this._repeatCount=e,this._element&&this._renderRepeatCount())}_renderRepeatCount(){let e=this._repeatCount;if(e<=1){this._repeatCountElement&&(this._repeatCountElement.remove(),this._repeatCountElement=null);return}this._repeatCountElement||(this._repeatCountElement=document.createElement("span"),this._repeatCountElement.classList.add("repeat-count"),this._element.insertBefore(this._repeatCountElement,this._element.firstChild)),this._repeatCountElement.textContent=Number.abbreviate(e)}get expandable(){return!!(this._expandable||this._objectTree)}expand(){this._expandable&&this._element.classList.add("expanded"),this._objectTree&&this._message.type!==WI.ConsoleMessage.MessageType.Trace&&(!this._extraParameters||this._extraParameters.length<=1)&&this._objectTree.expand()}collapse(){this._expandable&&this._element.classList.remove("expanded"),this._objectTree&&(!this._extraParameters||this._extraParameters.length<=1)&&this._objectTree.collapse()}toggle(){this._element.classList.contains("expanded")?this.collapse():this.expand()}toClipboardString(e){let t=this._messageBodyElement.innerText.removeWordBreakCharacters();this._message.savedResultIndex&&(t=t.replace(/\s*=\s*(\$\d+)$/,""));let i=this._shouldShowStackTrace();if(!i){let n=this.repeatCount>1?"x"+this.repeatCount:"",s="";if(this._message.url){let a=[WI.displayNameForURL(this._message.url),"line "+this._message.line];n&&a.push(n),s=" ("+a.join(", ")+")"}else n&&(s=" ("+n+")");if(s){let a=t.split(`
`);a[0]+=s,t=a.join(`
`)}}return this._extraElementsList&&(t+=`
`+this._extraElementsList.innerText.removeWordBreakCharacters().trim()),i&&this._message.stackTrace.callFrames.forEach(function(n){t+=`
	`+(n.functionName||WI.UIString("(anonymous function)")),n.sourceCodeLocation&&(t+=" ("+n.sourceCodeLocation.originalLocationString()+")")}),!e||this._enforcesClipboardPrefixString()?this._clipboardPrefixString()+t:t}_appendMessageTextAndArguments(e){if(this._message.source===WI.ConsoleMessage.MessageSource.ConsoleAPI){switch(this._message.type){case WI.ConsoleMessage.MessageType.Trace:var n=[WI.UIString("Trace")];if(this._message.parameters)if(this._message.parameters[0].type==="string"){var t=WI.UIString("Trace: %s").format(this._message.parameters[0].description);n=[t].concat(this._message.parameters.slice(1))}else n=n.concat(this._message.parameters);this._appendFormattedArguments(e,n);break;case WI.ConsoleMessage.MessageType.Assert:var n=[WI.UIString("Assertion Failed")];if(this._message.parameters)if(this._message.parameters[0].type==="string"){var t=WI.UIString("Assertion Failed: %s").format(this._message.parameters[0].description);n=[t].concat(this._message.parameters.slice(1))}else n=n.concat(this._message.parameters);this._appendFormattedArguments(e,n);break;case WI.ConsoleMessage.MessageType.Dir:var i=this._message.parameters?this._message.parameters[0]:void 0;this._appendFormattedArguments(e,["%O",i]);break;case WI.ConsoleMessage.MessageType.Table:var n=this._message.parameters;e.appendChild(this._formatParameterAsTable(n)),this._extraParameters=null;break;case WI.ConsoleMessage.MessageType.StartGroup:case WI.ConsoleMessage.MessageType.StartGroupCollapsed:var n=this._message.parameters||[this._message.messageText||WI.UIString("Group")];this._formatWithSubstitutionString(n,e),this._extraParameters=null;break;case WI.ConsoleMessage.MessageType.Timing:{let a=[this._message.messageText];this._extraParameters&&(a=a.concat(this._extraParameters)),this._appendFormattedArguments(e,a);break}case WI.ConsoleMessage.MessageType.Image:{let a=e.appendChild(document.createElement("img"));a.classList.add("console-image","show-grid"),a.src=this._message.messageText,a.setAttribute("filename",WI.FileUtilities.screenshotString()+".png"),a.addEventListener("load",d=>{a.width>=a.height?a.width=a.width/window.devicePixelRatio:a.height=a.height/window.devicePixelRatio});break}default:var n=this._message.parameters||[this._message.messageText];this._appendFormattedArguments(e,n);break}return}var n=this._message.parameters||[this._message.messageText];this._appendFormattedArguments(e,n)}_appendSavedResultIndex(e){if(!!this._message.savedResultIndex){console.assert(this._message instanceof WI.ConsoleCommandResultMessage),console.assert(this._message.type===WI.ConsoleMessage.MessageType.Result);var t=document.createElement("span");t.classList.add("console-saved-variable"),t.textContent=" = $"+this._message.savedResultIndex,this._objectTree?this._objectTree.appendTitleSuffix(t):this._messageBodyElement.appendChild(t)}}_appendLocationLink(){if(this._message.source===WI.ConsoleMessage.MessageSource.Network){if(this._message.url){var e=WI.linkifyURLAsNode(this._message.url,this._message.url,"console-message-url");e.classList.add("console-message-location"),this._element.appendChild(e)}return}var t=this._message.stackTrace.firstNonNativeNonAnonymousCallFrame,i;if(t?i=t:this._message.url&&!this._shouldHideURL(this._message.url)&&(i=WI.CallFrame.fromPayload(this._message.target,{functionName:"",url:this._message.url,lineNumber:this._message.line,columnNumber:this._message.column})),i&&(!i.isConsoleEvaluation||WI.isDebugUIEnabled())){const a=!!i.functionName;var n=new WI.CallFrameView(i,a);n.classList.add("console-message-location"),this._element.appendChild(n);return}if(this._message.parameters&&this._message.parameters.length===1){var s=this._createRemoteObjectIfNeeded(this._message.parameters[0]);s.findFunctionSourceCodeLocation().then(a=>{if(a===WI.RemoteObject.SourceCodeLocationPromise.NoSourceFound||a===WI.RemoteObject.SourceCodeLocationPromise.MissingObjectId)return;let d=WI.linkifySourceCode(a.sourceCode,new WI.SourceCodePosition(a.lineNumber,a.columnNumber),{className:"console-message-url",ignoreNetworkTab:!0,ignoreSearchTab:!0});d.classList.add("console-message-location"),this._element.hasChildNodes()?this._element.insertBefore(d,this._element.firstChild):this._element.appendChild(d)})}}_appendExtraParameters(){if(!(!this._extraParameters||!this._extraParameters.length)){this._makeExpandable(),this._extraParameters.length>1&&this.expand(),this._extraElementsList=this._element.appendChild(document.createElement("ol")),this._extraElementsList.classList.add("console-message-extra-parameters-container");for(var e of this._extraParameters){var t=this._extraElementsList.appendChild(document.createElement("li"));const i=e.type==="object"&&e.subtype!=="null"&&e.subtype!=="regexp"&&e.subtype!=="node"&&e.subtype!=="error";t.classList.add("console-message-extra-parameter"),t.appendChild(this._formatParameter(e,i))}}}_appendStackTrace(){if(!!this._shouldShowStackTrace()){this._makeExpandable(),this._message.type===WI.ConsoleMessage.MessageType.Trace&&WI.settings.consoleAutoExpandTrace.value&&this.expand(),this._stackTraceElement=this._element.appendChild(document.createElement("div")),this._stackTraceElement.classList.add("console-message-body","console-message-stack-trace-container");var e=new WI.StackTraceView(this._message.stackTrace).element;this._stackTraceElement.appendChild(e)}}_createRemoteObjectIfNeeded(e){return e instanceof WI.RemoteObject?e:typeof e=="object"?WI.RemoteObject.fromPayload(e,this._message.target):WI.RemoteObject.fromPrimitiveValue(e)}_appendFormattedArguments(e,t){if(!t.length)return;for(let d=0;d<t.length;++d)t[d]=this._createRemoteObjectIfNeeded(t[d]);let i=e.appendChild(document.createElement("span")),n=t[0].type==="string"&&this._message.type!==WI.ConsoleMessage.MessageType.Result;if(t.length===1&&!n){this._extraParameters=null,i.appendChild(this._formatParameter(t[0],!1));return}console.assert(this._message.type!==WI.ConsoleMessage.MessageType.Result),n&&this._isStackTrace(t[0])&&(n=!1);let s=!1;function a(){if(!s)return null;let d=i.appendChild(document.createElement("span"));return d.classList.add("console-message-preview-divider"),d.textContent=` ${enDash} `,d}if(n&&(t=this._formatWithSubstitutionString(t,i).unusedSubstitutions,this._extraParameters=t,s=!0),t.length){let d=0;for(let p of t){if(!this._hasSimpleDisplay(p))break;d++}if(d){let p=t.splice(0,d);this._extraParameters=t;for(let f of p){let _=a();_&&_.classList.add("inline-lossless");let b=i.appendChild(document.createElement("span"));b.classList.add("inline-lossless");let w=WI.FormattedValue.createObjectPreviewOrFormattedValueForRemoteObject(f,WI.ObjectPreviewView.Mode.Brief),S=w instanceof WI.ObjectPreviewView;S&&w.setOriginatingObjectInfo(f,null);let E=S?w.element:w;b.appendChild(E),s=!0,console.assert(S&&w.lossless||!S&&this._shouldConsiderObjectLossless(f))}}if(t.length===1&&!this._isStackTrace(t[0])){let p=t[0],f=a(),_=i.appendChild(document.createElement("span"));_.classList.add("console-message-preview");let b=WI.FormattedValue.createObjectPreviewOrFormattedValueForRemoteObject(p,WI.ObjectPreviewView.Mode.Brief),w=b instanceof WI.ObjectPreviewView;w&&b.setOriginatingObjectInfo(p,null);let S=w?b.element:b;_.appendChild(S),s=!0,(w&&b.lossless||!w&&this._shouldConsiderObjectLossless(p))&&(this._extraParameters=null,f&&f.classList.add("inline-lossless"),_.classList.add("inline-lossless"))}else if(t.length){let p=document.createElement("span");i.append(" ",p),p.classList.add("console-message-enclosed"),p.textContent="("+t.length+")"}}}_hasSimpleDisplay(e){return console.assert(e instanceof WI.RemoteObject),WI.FormattedValue.hasSimpleDisplay(e)&&!this._isStackTrace(e)}_isStackTrace(e){return console.assert(e instanceof WI.RemoteObject),e.type==="string"&&WI.StackTrace.isLikelyStackTrace(e.description)}_shouldConsiderObjectLossless(e){if(e.type==="string"){const t=e.description,i=WI.FormattedValue.MAX_PREVIEW_STRING_LENGTH;return!(t.length>i||t.slice(0,i).includes(`
`))}return e.type!=="object"||e.subtype==="null"||e.subtype==="regexp"}_formatParameter(e,t){var i;t?i="object":e instanceof WI.RemoteObject?i=e.subtype||e.type:(console.assert(!1,"no longer reachable"),i=typeof e);var n={object:this._formatParameterAsObject,error:this._formatParameterAsError,map:this._formatParameterAsObject,set:this._formatParameterAsObject,weakmap:this._formatParameterAsObject,weakset:this._formatParameterAsObject,iterator:this._formatParameterAsObject,class:this._formatParameterAsObject,proxy:this._formatParameterAsObject,array:this._formatParameterAsArray,node:this._formatParameterAsNode,string:this._formatParameterAsString},s=n[i]||this._formatParameterAsValue;const a=document.createDocumentFragment();return s.call(this,e,a,t),a}_formatParameterAsValue(e,t){t.appendChild(WI.FormattedValue.createElementForRemoteObject(e))}_formatParameterAsString(e,t){if(this._isStackTrace(e)){let i=WI.StackTrace.fromString(this._message.target,e.description);if(i.callFrames.length){let n=new WI.StackTraceView(i);t.appendChild(n.element);return}}t.appendChild(WI.FormattedValue.createLinkifiedElementString(e.description))}_formatParameterAsNode(e,t){t.appendChild(WI.FormattedValue.createElementForNode(e))}_formatParameterAsObject(e,t,i){this._objectTree=new WI.ObjectTreeView(e,null,this._rootPropertyPathForObject(e),i),t.appendChild(this._objectTree.element)}_formatParameterAsError(e,t){this._objectTree=new WI.ErrorObjectView(e),t.appendChild(this._objectTree.element)}_formatParameterAsArray(e,t){this._objectTree=new WI.ObjectTreeView(e,WI.ObjectTreeView.Mode.Properties,this._rootPropertyPathForObject(e)),t.appendChild(this._objectTree.element)}_rootPropertyPathForObject(e){return this._message.savedResultIndex?new WI.PropertyPath(e,"$"+this._message.savedResultIndex):null}_formatWithSubstitutionString(e,t){function i(w,S){return this._formatParameter(S,w)}function n(w){return w.description}function s(w,S){let E=typeof w.value=="number"?w.value:w.description;return String.standardFormatters.f(E,S)}function a(w){let S=typeof w.value=="number"?w.value:w.description;return String.standardFormatters.d(S)}var d=null;function p(w){d={};var S=document.createElement("span");S.setAttribute("style",w.description);for(var E=0;E<S.style.length;E++){var k=S.style[E];f(k)&&(d[k]=S.style[k])}}function f(w){for(var S of["background","border","color","font","line","margin","padding","text"])if(w.startsWith(S)||w.startsWith("-webkit-"+S))return!0;return!1}var _={};_.o=i.bind(this,!1),_.s=n,_.f=s,_.i=a,_.d=a,_.c=p,_.O=i.bind(this,!0);function b(w,S){if(S instanceof Node)w.appendChild(S);else if(S!==void 0){var E=WI.linkifyStringAsFragment(S.toString());if(d){var k=document.createElement("span");for(var R in d)k.style[R]=d[R];k.appendChild(E),E=k}w.appendChild(E)}return w}return String.format(e[0].description,e.slice(1),_,t,b)}_shouldShowStackTrace(){return this._message.stackTrace.callFrames.length?this._message.source===WI.ConsoleMessage.MessageSource.Network||this._message.level===WI.ConsoleMessage.MessageLevel.Error||this._message.type===WI.ConsoleMessage.MessageType.Trace:!1}_shouldHideURL(e){return e==="undefined"||e==="[native code]"}_userProvidedColumnNames(e){if(!e)return null;if(console.assert(e instanceof WI.RemoteObject),e.type==="string"||e.type==="number")return[String(e.value)];if(e.type!=="object"||e.subtype!=="array"||!e.preview||!e.preview.propertyPreviews)return null;var t=[];for(var i of e.preview.propertyPreviews)(i.type==="string"||i.type==="number")&&t.push(String(i.value));return t.length?t:null}_formatParameterAsTable(e){var t=document.createElement("span"),i=e[0];if(!i||!i.preview)return t;var n=[],s=[],a=[],d=i.preview,p=!1,f=this._userProvidedColumnNames(e[1]);if(f&&(p=!0,s=f),d.propertyPreviews)for(var _=0;_<d.propertyPreviews.length;++_){var b=d.propertyPreviews[_],w=b.valuePreview;if(!(!w||!w.propertyPreviews)){for(var S={},E=15,k=0;k<w.propertyPreviews.length;++k){var R=w.propertyPreviews[k],M=s.includes(R.name);if(!M){if(p||s.length===E)continue;M=!0,s.push(R.name)}S[R.name]=WI.FormattedValue.createElementForPropertyPreview(R)}n.push([b.name,S])}}if(n.length){s.unshift(WI.UIString("(Index)"));for(var _=0;_<n.length;++_){var L=n[_][0],S=n[_][1];a.push(L);for(var k=1;k<s.length;++k){var V=s[k];V in S?a.push(S[V]):a.push(emDash)}}}if(!a.length&&d.propertyPreviews)for(var _=0;_<d.propertyPreviews.length;++_){var b=d.propertyPreviews[_];"value"in b&&(s.length||(s.push(WI.UIString("Index")),s.push(WI.UIString("Value"))),a.push(b.name),a.push(WI.FormattedValue.createElementForPropertyPreview(b)))}if(!a.length)return t;var H=WI.DataGrid.createSortableDataGrid(s,a);return H.inline=!0,H.variableHeightRows=!0,t.appendChild(H.element),H.updateLayoutIfNeeded(),t}_levelString(){switch(this._message.level){case WI.ConsoleMessage.MessageLevel.Log:return"Log";case WI.ConsoleMessage.MessageLevel.Info:return"Info";case WI.ConsoleMessage.MessageLevel.Warning:return"Warning";case WI.ConsoleMessage.MessageLevel.Debug:return"Debug";case WI.ConsoleMessage.MessageLevel.Error:return"Error"}}_enforcesClipboardPrefixString(){return this._message.type!==WI.ConsoleMessage.MessageType.Result}_clipboardPrefixString(){return this._message.type===WI.ConsoleMessage.MessageType.Result?"< ":"["+this._levelString()+"] "}_makeExpandable(){this._expandable||(this._expandable=!0,this._element.classList.add("expandable"),this._boundClickHandler=this.toggle.bind(this),this._messageBodyElement.addEventListener("click",this._boundClickHandler))}_handleContextMenu(e){let t=e.target.closest(".console-image");if(!t)return;let i=WI.ContextMenu.createFromEvent(e);i.appendItem(WI.UIString("Save Image"),()=>{WI.FileUtilities.save({url:WI.FileUtilities.inspectorURLForFilename(t.getAttribute("filename")),content:parseDataURL(this._message.messageText).data,base64Encoded:!0},!0)}),i.appendSeparator()}};WI.ContentBrowser=class extends WI.View{constructor(e,t,i,n,s,a){if(super(e),this.element.classList.add("content-browser"),this._navigationBar=new WI.NavigationBar,this.addSubview(this._navigationBar),this._contentViewContainer=new WI.ContentViewContainer,this._contentViewContainer.addEventListener(WI.ContentViewContainer.Event.CurrentContentViewDidChange,this._currentContentViewDidChange,this),this.addSubview(this._contentViewContainer),!i){let d=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL,p=()=>{this.goBack()},f=()=>{this.goForward()},_=d?WI.KeyboardShortcut.Key.Right:WI.KeyboardShortcut.Key.Left,b=d?WI.KeyboardShortcut.Key.Left:WI.KeyboardShortcut.Key.Right;this._backKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl|WI.KeyboardShortcut.Modifier.Control,_,p,this.element),this._forwardKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl|WI.KeyboardShortcut.Modifier.Control,b,f,this.element);let w="Images/BackForwardArrows.svg#left-arrow-mask",S="Images/BackForwardArrows.svg#right-arrow-mask",E=d?S:w,k=d?w:S;this._backNavigationItem=new WI.ButtonNavigationItem("back",WI.UIString("Back (%s)").format(this._backKeyboardShortcut.displayName),E,8,13),this._backNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,p),this._backNavigationItem.enabled=!1,this._forwardNavigationItem=new WI.ButtonNavigationItem("forward",WI.UIString("Forward (%s)").format(this._forwardKeyboardShortcut.displayName),k,8,13),this._forwardNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,f),this._forwardNavigationItem.enabled=!1;let R=new WI.GroupNavigationItem([this._backNavigationItem,this._forwardNavigationItem]);this._navigationBar.addNavigationItem(R)}n||(this._findBanner=new WI.FindBanner(this),this._findBanner.addEventListener(WI.FindBanner.Event.DidShow,this._findBannerDidShow,this),this._findBanner.addEventListener(WI.FindBanner.Event.DidHide,this._findBannerDidHide,this)),this._hierarchicalPathNavigationItem=new WI.HierarchicalPathNavigationItem,this._hierarchicalPathNavigationItem.addEventListener(WI.HierarchicalPathNavigationItem.Event.PathComponentWasSelected,this._hierarchicalPathComponentWasSelected,this),this._navigationBar.addNavigationItem(this._hierarchicalPathNavigationItem),this._contentViewSelectionPathNavigationItem=new WI.HierarchicalPathNavigationItem,this._flexibleNavigationItem=s||new WI.FlexibleSpaceNavigationItem,this._navigationBar.addNavigationItem(this._flexibleNavigationItem),this._currentContentViewNavigationItemsGroup=a||null,WI.ContentView.addEventListener(WI.ContentView.Event.SelectionPathComponentsDidChange,this._contentViewSelectionPathComponentDidChange,this),WI.ContentView.addEventListener(WI.ContentView.Event.SupplementalRepresentedObjectsDidChange,this._contentViewSupplementalRepresentedObjectsDidChange,this),WI.ContentView.addEventListener(WI.ContentView.Event.NumberOfSearchResultsDidChange,this._contentViewNumberOfSearchResultsDidChange,this),WI.ContentView.addEventListener(WI.ContentView.Event.NavigationItemsDidChange,this._contentViewNavigationItemsDidChange,this),this._delegate=t||null,this._currentContentViewNavigationItems=[],this._dispatchCurrentRepresentedObjectsDidChangeDebouncer=new Debouncer(()=>{this.dispatchEventToListeners(WI.ContentBrowser.Event.CurrentRepresentedObjectsDidChange)})}get navigationBar(){return this._navigationBar}get contentViewContainer(){return this._contentViewContainer}get delegate(){return this._delegate}set delegate(e){this._delegate=e||null}get currentContentView(){return this._contentViewContainer.currentContentView}get currentRepresentedObjects(){var e=[],t=this._hierarchicalPathNavigationItem.lastComponent;t&&t.representedObject&&e.push(t.representedObject),t=this._contentViewSelectionPathNavigationItem.lastComponent,t&&t.representedObject&&e.push(t.representedObject);var i=this.currentContentView;if(i){var n=i.supplementalRepresentedObjects;n&&n.length&&(e=e.concat(n))}return e}showContentViewForRepresentedObject(e,t,i){var n=this.contentViewForRepresentedObject(e,!1,i);return this._contentViewContainer.showContentView(n,t)}showContentView(e,t){return this._contentViewContainer.showContentView(e,t)}contentViewForRepresentedObject(e,t,i){return this._contentViewContainer.contentViewForRepresentedObject(e,t,i)}updateHierarchicalPathForCurrentContentView(){var e=this.currentContentView;this._updateHierarchicalPathNavigationItem(e?e.representedObject:null)}canGoBack(){var e=this.currentContentView;return e&&e.canGoBack()?!0:this._contentViewContainer.canGoBack()}canGoForward(){var e=this.currentContentView;return e&&e.canGoForward()?!0:this._contentViewContainer.canGoForward()}goBack(){var e=this.currentContentView;if(e&&e.canGoBack()){e.goBack(),this._updateBackForwardButtons();return}this._contentViewContainer.goBack()}goForward(){var e=this.currentContentView;if(e&&e.canGoForward()){e.goForward(),this._updateBackForwardButtons();return}this._contentViewContainer.goForward()}showFindBanner(){if(!!this._findBanner){var e=this.currentContentView;if(!(!e||!e.supportsSearch)){if(e.supportsCustomFindBanner){e.showCustomFindBanner();return}this._findBanner.show()}}}shown(){this._updateContentViewSelectionPathNavigationItem(this.currentContentView),this.updateHierarchicalPathForCurrentContentView(),this._contentViewContainer.shown()}hidden(){this._contentViewContainer.hidden()}handlePopulateFindShortcut(){let e=this.currentContentView;if(!e||!e.supportsSearch)return;let t=e.searchQueryWithSelection();!t||(this._findBanner.searchQuery=t,e.performSearch(this._findBanner.searchQuery))}handleFindNextShortcut(){this.findBannerRevealNextResult(this._findBanner)}handleFindPreviousShortcut(){this.findBannerRevealPreviousResult(this._findBanner)}findBannerPerformSearch(e,t){let i=this.currentContentView;!i||!i.supportsSearch||i.performSearch(t)}findBannerSearchCleared(e){let t=this.currentContentView;!t||!t.supportsSearch||t.searchCleared()}findBannerRevealPreviousResult(e){let t=this.currentContentView;!t||!t.supportsSearch||t.revealPreviousSearchResult(!e.showing)}findBannerRevealNextResult(e){let t=this.currentContentView;!t||!t.supportsSearch||t.revealNextSearchResult(!e.showing)}_findBannerDidShow(e){var t=this.currentContentView;!t||!t.supportsSearch||(t.automaticallyRevealFirstSearchResult=!0,this._findBanner.searchQuery!==""&&t.performSearch(this._findBanner.searchQuery))}_findBannerDidHide(e){var t=this.currentContentView;!t||!t.supportsSearch||(t.automaticallyRevealFirstSearchResult=!1,t.searchHidden())}_contentViewNumberOfSearchResultsDidChange(e){!this._findBanner||e.target===this.currentContentView&&(this._findBanner.numberOfResults=this.currentContentView.numberOfSearchResults)}_updateHierarchicalPathNavigationItem(e){if(!(!this.delegate||typeof this.delegate.contentBrowserTreeElementForRepresentedObject!="function")){for(var t=e?this.delegate.contentBrowserTreeElementForRepresentedObject(this,e):null,i=[];t&&!t.root;){var n=new WI.GeneralTreeElementPathComponent(t);i.unshift(n),t=t.parent}this._hierarchicalPathNavigationItem.components=i}}_updateContentViewSelectionPathNavigationItem(e){var t=e?e.selectionPathComponents||[]:[];if(this._contentViewSelectionPathNavigationItem.components=t,!this._currentContentViewNavigationItemsGroup){if(!t.length){this._hierarchicalPathNavigationItem.alwaysShowLastPathComponentSeparator=!1,this._navigationBar.removeNavigationItem(this._contentViewSelectionPathNavigationItem);return}if(!this._navigationBar.navigationItems.includes(this._contentViewSelectionPathNavigationItem)){var i=this._navigationBar.navigationItems.indexOf(this._hierarchicalPathNavigationItem);console.assert(i!==-1),this._navigationBar.insertNavigationItem(this._contentViewSelectionPathNavigationItem,i+1),this._hierarchicalPathNavigationItem.alwaysShowLastPathComponentSeparator=!0}}}_updateBackForwardButtons(){!this._backNavigationItem||!this._forwardNavigationItem||(this._backNavigationItem.enabled=this.canGoBack(),this._forwardNavigationItem.enabled=this.canGoForward())}_updateContentViewNavigationItems(e){let t=this.currentContentView;if(!t){this._removeAllNavigationItems(),this._currentContentViewNavigationItems=[],this._currentContentViewNavigationItemsGroup&&this._currentContentViewNavigationItems.push(this._contentViewSelectionPathNavigationItem);return}if(t.parentContainer!==this._contentViewContainer)return;if(!e){let d=this._currentContentViewNavigationItems.filter(f=>!(f instanceof WI.DividerNavigationItem));if(Array.shallowEqual(d,t.navigationItems))return}this._removeAllNavigationItems();let i=this.navigationBar,n=i.navigationItems.indexOf(this._flexibleNavigationItem)+1;console.assert(n>=0);let s=[],a=!this._currentContentViewNavigationItemsGroup;t.navigationItems.forEach(function(d,p){a&&i.insertNavigationItem(d,n++),s.push(d)}),this._currentContentViewNavigationItemsGroup&&(this._currentContentViewNavigationItemsGroup.navigationItems=[this._contentViewSelectionPathNavigationItem].concat(s)),this._currentContentViewNavigationItems=s}_removeAllNavigationItems(){if(this._currentContentViewNavigationItemsGroup)this._currentContentViewNavigationItemsGroup.navigationItems=[];else for(let e of this._currentContentViewNavigationItems)e.parentNavigationBar&&e.parentNavigationBar.removeNavigationItem(e)}_updateFindBanner(e){if(!!this._findBanner){if(!e){this._findBanner.targetElement=null,this._findBanner.numberOfResults=null;return}this._findBanner.targetElement=e.element,this._findBanner.numberOfResults=e.hasPerformedSearch?e.numberOfSearchResults:null,e.supportsSearch&&this._findBanner.searchQuery&&(e.automaticallyRevealFirstSearchResult=this._findBanner.showing,e.performSearch(this._findBanner.searchQuery))}}_contentViewSelectionPathComponentDidChange(e){e.target===this.currentContentView&&e.target.parentContainer===this._contentViewContainer&&(this._updateContentViewSelectionPathNavigationItem(e.target),this._updateBackForwardButtons(),this._updateContentViewNavigationItems(),this._navigationBar.needsLayout(),this._dispatchCurrentRepresentedObjectsDidChangeDebouncer.delayForTime(0))}_contentViewSupplementalRepresentedObjectsDidChange(e){e.target===this.currentContentView&&e.target.parentContainer===this._contentViewContainer&&this._dispatchCurrentRepresentedObjectsDidChangeDebouncer.delayForTime(0)}_currentContentViewDidChange(e){var t=this.currentContentView;this._updateHierarchicalPathNavigationItem(t?t.representedObject:null),this._updateContentViewSelectionPathNavigationItem(t),this._updateBackForwardButtons(),this._updateContentViewNavigationItems(),this._updateFindBanner(t),this._navigationBar.needsLayout(),this.dispatchEventToListeners(WI.ContentBrowser.Event.CurrentContentViewDidChange),this._dispatchCurrentRepresentedObjectsDidChangeDebouncer.force()}_contentViewNavigationItemsDidChange(e){if(e.target!==this.currentContentView||e.target.parentContainer!==this._contentViewContainer)return;const t=!0;this._updateContentViewNavigationItems(t),this._navigationBar.needsLayout()}_hierarchicalPathComponentWasSelected(e){console.assert(e.data.pathComponent instanceof WI.GeneralTreeElementPathComponent);for(var t=e.data.pathComponent.generalTreeElement,i=t;t&&!WI.ContentView.isViewable(t.representedObject);)t=t.traverseNextTreeElement(!1,i,!1);!t||t.revealAndSelect()}};WI.ContentBrowser.Event={CurrentRepresentedObjectsDidChange:"content-browser-current-represented-objects-did-change",CurrentContentViewDidChange:"content-browser-current-content-view-did-change"};WI.ContentView=class extends WI.View{constructor(e,t){console.assert(!e||WI.ContentView.isViewable(e),e),super(),this._representedObject=e,this.element.classList.add("content-view"),this._parentContainer=null}static createFromRepresentedObject(e,t){if(console.assert(e),e instanceof WI.Frame)return new WI.ResourceClusterContentView(e.mainResource,t);if(e instanceof WI.Resource)return new WI.ResourceClusterContentView(e,t);if(e instanceof WI.Script)return new WI.ScriptContentView(e,t);if(e instanceof WI.CSSStyleSheet)return new WI.TextResourceContentView(e,t);if(e instanceof WI.Canvas)return new WI.CanvasContentView(e,t);if(e instanceof WI.CanvasCollection)return new WI.CanvasOverviewContentView(e,t);if(e instanceof WI.ShaderProgram)return new WI.ShaderProgramContentView(e,t);if(e instanceof WI.TimelineRecording)return new WI.TimelineRecordingContentView(e,t);if(e instanceof WI.Timeline){var i=e.type;if(i===WI.TimelineRecord.Type.Network)return new WI.NetworkTimelineView(e,t);if(i===WI.TimelineRecord.Type.Layout)return new WI.LayoutTimelineView(e,t);if(i===WI.TimelineRecord.Type.Script)return new WI.ScriptClusterTimelineView(e,t);if(i===WI.TimelineRecord.Type.RenderingFrame)return new WI.RenderingFrameTimelineView(e,t);if(i===WI.TimelineRecord.Type.CPU)return new WI.CPUTimelineView(e,t);if(i===WI.TimelineRecord.Type.Memory)return new WI.MemoryTimelineView(e,t);if(i===WI.TimelineRecord.Type.HeapAllocations)return new WI.HeapAllocationsTimelineView(e,t);if(i===WI.TimelineRecord.Type.Media)return new WI.MediaTimelineView(e,t)}if((e instanceof WI.Breakpoint||e instanceof WI.IssueMessage)&&e.sourceCodeLocation)return WI.ContentView.createFromRepresentedObject(e.sourceCodeLocation.displaySourceCode,t);if(e instanceof WI.DOMStorageObject)return new WI.DOMStorageContentView(e,t);if(e instanceof WI.CookieStorageObject)return new WI.CookieStorageContentView(e,t);if(e instanceof WI.DatabaseTableObject)return new WI.DatabaseTableContentView(e,t);if(e instanceof WI.DatabaseObject)return new WI.DatabaseContentView(e,t);if(e instanceof WI.IndexedDatabase)return new WI.IndexedDatabaseContentView(e,t);if(e instanceof WI.IndexedDatabaseObjectStore)return new WI.IndexedDatabaseObjectStoreContentView(e,t);if(e instanceof WI.IndexedDatabaseObjectStoreIndex)return new WI.IndexedDatabaseObjectStoreContentView(e,t);if(e instanceof WI.ApplicationCacheFrame)return new WI.ApplicationCacheFrameContentView(e,t);if(e instanceof WI.DOMTree)return new WI.FrameDOMTreeContentView(e,t);if(e instanceof WI.DOMSearchMatchObject){var n=new WI.FrameDOMTreeContentView(WI.networkManager.mainFrame.domTree,t);return n.restoreFromCookie({nodeToSelect:e.domNode}),n}if(e instanceof WI.DOMNode&&e.frame){let d=WI.ContentView.createFromRepresentedObject(e.frame,t);return d.restoreFromCookie({nodeToSelect:e}),d}if(e instanceof WI.SourceCodeSearchMatchObject){var n;e.sourceCode instanceof WI.Resource?n=new WI.ResourceClusterContentView(e.sourceCode,t):e.sourceCode instanceof WI.Script?n=new WI.ScriptContentView(e.sourceCode,t):console.error("Unknown SourceCode",e.sourceCode);var s=e.sourceCodeTextRange.formattedTextRange,a=s.startPosition();return n.restoreFromCookie({lineNumber:a.lineNumber,columnNumber:a.columnNumber}),n}if(e instanceof WI.LogObject)return new WI.LogContentView(e,t);if(e instanceof WI.CallingContextTree)return new WI.ProfileView(e,t);if(e instanceof WI.HeapSnapshotProxy||e instanceof WI.HeapSnapshotDiffProxy)return new WI.HeapSnapshotClusterContentView(e,t);if(e instanceof WI.Recording)return new WI.RecordingContentView(e,t);if(e instanceof WI.ResourceCollection)return new WI.ResourceCollectionContentView(e,t);if(e instanceof WI.AuditTestCase||e instanceof WI.AuditTestCaseResult)return new WI.AuditTestCaseContentView(e,t);if(e instanceof WI.AuditTestGroup||e instanceof WI.AuditTestGroupResult)return new WI.AuditTestGroupContentView(e,t);if(e instanceof WI.Collection)return new WI.CollectionContentView(e,t);if(typeof e=="string"||e instanceof String)return new WI.TextContentView(e,t);throw console.assert(!WI.ContentView.isViewable(e)),new Error("Can't make a ContentView for an unknown representedObject of type: "+e.constructor.name)}static contentViewForRepresentedObject(e,t,i){console.assert(e);let n=WI.ContentView.resolvedRepresentedObjectForRepresentedObject(e);if(!n)return null;let s=n[WI.ContentView.ContentViewForRepresentedObjectSymbol];if(console.assert(!s||s instanceof WI.ContentView),s)return s;if(t)return null;let a=WI.ContentView.createFromRepresentedObject(e,i);return console.assert(a instanceof WI.ContentView),a?(console.assert(a.representedObject===n,"createFromRepresentedObject and resolvedRepresentedObjectForRepresentedObject are out of sync for type",e.constructor.name),typeof n=="object"&&(a.representedObject[WI.ContentView.ContentViewForRepresentedObjectSymbol]=a),a):null}static closedContentViewForRepresentedObject(e){let t=WI.ContentView.resolvedRepresentedObjectForRepresentedObject(e);typeof t=="object"&&(t[WI.ContentView.ContentViewForRepresentedObjectSymbol]=null)}static resolvedRepresentedObjectForRepresentedObject(e){return e instanceof WI.Frame?e.mainResource:(e instanceof WI.Breakpoint||e instanceof WI.IssueMessage)&&e.sourceCodeLocation?e.sourceCodeLocation.displaySourceCode:e instanceof WI.DOMBreakpoint&&e.domNode?WI.ContentView.resolvedRepresentedObjectForRepresentedObject(e.domNode):e instanceof WI.DOMNode&&e.frame?WI.ContentView.resolvedRepresentedObjectForRepresentedObject(e.frame):e instanceof WI.DOMSearchMatchObject?WI.networkManager.mainFrame.domTree:e instanceof WI.SourceCodeSearchMatchObject?e.sourceCode:e}static isViewable(e){return e instanceof WI.Frame||e instanceof WI.Resource||e instanceof WI.Script||e instanceof WI.CSSStyleSheet||e instanceof WI.Canvas||e instanceof WI.CanvasCollection||e instanceof WI.ShaderProgram||e instanceof WI.TimelineRecording||e instanceof WI.Timeline?!0:e instanceof WI.Breakpoint||e instanceof WI.IssueMessage?e.sourceCodeLocation:e instanceof WI.DOMStorageObject||e instanceof WI.CookieStorageObject||e instanceof WI.DatabaseTableObject||e instanceof WI.DatabaseObject||e instanceof WI.IndexedDatabase||e instanceof WI.IndexedDatabaseObjectStore||e instanceof WI.IndexedDatabaseObjectStoreIndex||e instanceof WI.ApplicationCacheFrame||e instanceof WI.DOMTree||e instanceof WI.DOMSearchMatchObject||e instanceof WI.SourceCodeSearchMatchObject||e instanceof WI.LogObject||e instanceof WI.CallingContextTree||e instanceof WI.HeapSnapshotProxy||e instanceof WI.HeapSnapshotDiffProxy||e instanceof WI.Recording||e instanceof WI.AuditTestCase||e instanceof WI.AuditTestGroup||e instanceof WI.AuditTestCaseResult||e instanceof WI.AuditTestGroupResult||e instanceof WI.Collection||typeof e=="string"||e instanceof String}get representedObject(){return this._representedObject}get navigationItems(){return[]}get parentContainer(){return this._parentContainer}get visible(){return this._visible}set visible(e){this._visible=e}get scrollableElements(){return[]}get shouldKeepElementsScrolledToBottom(){return!1}get shouldSaveStateWhenHidden(){return!1}get selectionPathComponents(){return[]}get supplementalRepresentedObjects(){return[]}get supportsSplitContentBrowser(){return WI.dockedConfigurationSupportsSplitContentBrowser()}shown(){}hidden(){}closed(){}saveToCookie(e){}restoreFromCookie(e){}canGoBack(){return!1}canGoForward(){return!1}goBack(){}goForward(){}get supportsSearch(){return!1}get supportsCustomFindBanner(){return!1}showCustomFindBanner(){}get numberOfSearchResults(){return null}get hasPerformedSearch(){return!1}set automaticallyRevealFirstSearchResult(e){}performSearch(e){}searchHidden(){}searchCleared(){}searchQueryWithSelection(){let e=window.getSelection();return e.isCollapsed?null:e.toString().removeWordBreakCharacters()}revealPreviousSearchResult(e){}revealNextSearchResult(e){}};WI.ContentView.Event={SelectionPathComponentsDidChange:"content-view-selection-path-components-did-change",SupplementalRepresentedObjectsDidChange:"content-view-supplemental-represented-objects-did-change",NumberOfSearchResultsDidChange:"content-view-number-of-search-results-did-change",NavigationItemsDidChange:"content-view-navigation-items-did-change"};WI.ContentView.ContentViewForRepresentedObjectSymbol=Symbol("content-view-for-represented-object");WI.DataGrid=class extends WI.View{constructor(e,{editCallback:t,copyCallback:i,deleteCallback:n,preferredColumnOrder:s}={}){if(super(),this.columns=new Map,this.orderedColumns=[],this._settingsIdentifier=null,this._sortColumnIdentifier=null,this._sortColumnIdentifierSetting=null,this._sortOrder=WI.DataGrid.SortOrder.Indeterminate,this._sortOrderSetting=null,this._columnVisibilitySetting=null,this._columnChooserEnabled=!1,this._headerVisible=!0,this._rows=[],this.children=[],this.selectedNode=null,this.expandNodesWhenArrowing=!1,this.root=!0,this.hasChildren=!1,this.expanded=!0,this.revealed=!0,this.selected=!1,this.dataGrid=this,this.indentWidth=15,this.rowHeight=20,this.resizers=[],this._columnWidthsInitialized=!1,this._scrollbarWidth=0,this._cachedScrollTop=NaN,this._cachedScrollableOffsetHeight=NaN,this._previousRevealedRowCount=NaN,this._topDataTableMarginHeight=NaN,this._bottomDataTableMarginHeight=NaN,this._filterText="",this._filterDelegate=null,this._filterDidModifyNodeWhileProcessingItems=!1,this.element.className="data-grid",this.element.tabIndex=0,this.element.addEventListener("keydown",this._keyDown.bind(this),!1),this.element.copyHandler=this,this._headerWrapperElement=document.createElement("div"),this._headerWrapperElement.classList.add("header-wrapper"),this._headerTableElement=document.createElement("table"),this._headerTableElement.className="header",this._headerWrapperElement.appendChild(this._headerTableElement),this._headerTableColumnGroupElement=this._headerTableElement.createChild("colgroup"),this._headerTableBodyElement=this._headerTableElement.createChild("tbody"),this._headerTableRowElement=this._headerTableBodyElement.createChild("tr"),this._headerTableRowElement.addEventListener("contextmenu",this._contextMenuInHeader.bind(this),!0),this._headerTableCellElements=new Map,this._scrollContainerElement=document.createElement("div"),this._scrollContainerElement.className="data-container",this._scrollListener=()=>this._noteScrollPositionChanged(),this._updateScrollListeners(),this._topDataTableMarginElement=this._scrollContainerElement.createChild("div"),this._dataTableElement=this._scrollContainerElement.createChild("table","data"),this._bottomDataTableMarginElement=this._scrollContainerElement.createChild("div"),this._dataTableElement.addEventListener("mousedown",this._mouseDownInDataTable.bind(this)),this._dataTableElement.addEventListener("click",this._clickInDataTable.bind(this)),this._dataTableElement.addEventListener("contextmenu",this._contextMenuInDataTable.bind(this),!0),t&&(this._dataTableElement.addEventListener("dblclick",this._ondblclick.bind(this),!1),this._editCallback=t),i&&(this._copyCallback=i),n&&(this._deleteCallback=n),this._dataTableColumnGroupElement=this._headerTableColumnGroupElement.cloneNode(!0),this._dataTableElement.appendChild(this._dataTableColumnGroupElement),this.dataTableBodyElement=this._dataTableElement.createChild("tbody"),this._fillerRowElement=this.dataTableBodyElement.createChild("tr","filler"),this.element.appendChild(this._headerWrapperElement),this.element.appendChild(this._scrollContainerElement),s)for(var a of s)this.insertColumn(a,e[a]);else for(var a in e)this.insertColumn(a,e[a]);this._updateScrollbarPadding(),this._copyTextDelimiter="	"}_updateScrollbarPadding(){if(this._inline)return;let e=this._scrollContainerElement.offsetWidth-this._scrollContainerElement.scrollWidth;this._scrollbarWidth!==e&&(WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?this._headerWrapperElement.style.setProperty("padding-left",`${e}px`):this._headerWrapperElement.style.setProperty("padding-right",`${e}px`),this._scrollbarWidth=e)}static createSortableDataGrid(e,t){var i=e.length;if(!i)return null;var n={};for(var s of e)n[s]={width:s.length,title:s,sortable:!0};let a=new WI.DataGrid(n,{preferredColumnOrder:e});for(var d=0;d<t.length/i;++d){for(var p={},f=0;f<e.length;++f)p[e[f]]=t[i*d+f];var _=new WI.DataGridNode(p,!1);a.appendChild(_)}function b(){var w=a.sortColumnIdentifier,S=!0;for(var E of a.children){var k=a.textForDataGridNodeColumn(E,w);isNaN(Number(k))&&(S=!1)}function R(M,L){var V=a.textForDataGridNodeColumn(M,w),H=a.textForDataGridNodeColumn(L,w),O;if(S){var z=parseFloat(V),K=parseFloat(H);O=z<K?-1:z>K?1:0}else O=V<H?-1:V>H?1:0;return O}a.sortNodes(R)}return a.addEventListener(WI.DataGrid.Event.SortChanged,b,this),a.sortOrder=WI.DataGrid.SortOrder.Ascending,a.sortColumnIdentifier=e[0],a}get headerVisible(){return this._headerVisible}set headerVisible(e){e!==this._headerVisible&&(this._headerVisible=e,this.element.classList.toggle("no-header",!this._headerVisible))}get columnChooserEnabled(){return this._columnChooserEnabled}set columnChooserEnabled(e){this._columnChooserEnabled=e}get copyTextDelimiter(){return this._copyTextDelimiter}set copyTextDelimiter(e){this._copyTextDelimiter=e}get refreshCallback(){return this._refreshCallback}set refreshCallback(e){this._refreshCallback=e}get sortOrder(){return this._sortOrder}set sortOrder(e){if(!(!e||e===this._sortOrder)&&(this._sortOrder=e,this._sortOrderSetting&&(this._sortOrderSetting.value=this._sortOrder),!!this._sortColumnIdentifier)){var t=this._headerTableCellElements.get(this._sortColumnIdentifier);t.classList.toggle(WI.DataGrid.SortColumnAscendingStyleClassName,this._sortOrder===WI.DataGrid.SortOrder.Ascending),t.classList.toggle(WI.DataGrid.SortColumnDescendingStyleClassName,this._sortOrder===WI.DataGrid.SortOrder.Descending),this.dispatchEventToListeners(WI.DataGrid.Event.SortChanged)}}get sortColumnIdentifier(){return this._sortColumnIdentifier}set sortColumnIdentifier(e){if(console.assert(e&&this.columns.has(e)),console.assert("sortable"in this.columns.get(e)),this._sortColumnIdentifier===e)return;let t=this._sortColumnIdentifier;this._sortColumnIdentifier=e,this._updateSortedColumn(t)}get inline(){return this._inline}set inline(e){this._inline!==e&&(this._inline=e||!1,this._element.classList.toggle("inline",this._inline),this._updateScrollListeners())}get variableHeightRows(){return this._variableHeightRows}set variableHeightRows(e){this._variableHeightRows!==e&&(this._variableHeightRows=e||!1,this._element.classList.toggle("variable-height-rows",this._variableHeightRows),this._updateScrollListeners())}get filterText(){return this._filterText}set filterText(e){this._filterText!==e&&(this._filterText=e,this.filterDidChange())}get filterDelegate(){return this._filterDelegate}set filterDelegate(e){this._filterDelegate=e,this.filterDidChange()}filterDidChange(){this._scheduledFilterUpdateIdentifier||(this._applyFilterToNodesTask&&(this._applyFilterToNodesTask.cancel(),this._applyFilterToNodesTask=null),this._scheduledFilterUpdateIdentifier=requestAnimationFrame(this._updateFilter.bind(this)))}hasFilters(){return this._textFilterRegex||this._hasFilterDelegate()}matchNodeAgainstCustomFilters(e){return this._hasFilterDelegate()?this._filterDelegate.dataGridMatchNodeAgainstCustomFilters(e):!0}createSettings(e){if(console.assert(e&&typeof e=="string"),this._settingsIdentifier===e||(this._settingsIdentifier=e,this._sortColumnIdentifierSetting=new WI.Setting(this._settingsIdentifier+"-sort",this._sortColumnIdentifier),this._sortOrderSetting=new WI.Setting(this._settingsIdentifier+"-sort-order",this._sortOrder),this._columnVisibilitySetting=new WI.Setting(this._settingsIdentifier+"-column-visibility",{}),!this.columns))return;this._sortColumnIdentifierSetting.value&&(this.sortColumnIdentifier=this._sortColumnIdentifierSetting.value,this.sortOrder=this._sortOrderSetting.value);let t=this._columnVisibilitySetting.value;for(let i in t){let n=t[i];this.setColumnVisible(i,n)}}_updateScrollListeners(){this._inline||this._variableHeightRows?(this._scrollContainerElement.removeEventListener("scroll",this._scrollListener),this._scrollContainerElement.removeEventListener("mousewheel",this._scrollListener)):(this._scrollContainerElement.addEventListener("scroll",this._scrollListener),this._scrollContainerElement.addEventListener("mousewheel",this._scrollListener))}_applyFiltersToNodeAndDispatchEvent(e){const t=e.hidden;return this._applyFiltersToNode(e),t!==e.hidden&&this.dispatchEventToListeners(WI.DataGrid.Event.NodeWasFiltered,{node:e}),t!==e.hidden}_applyFiltersToNode(e){if(!this.hasFilters()){e.hidden=!1,e.expanded&&e[WI.DataGrid.WasExpandedDuringFilteringSymbol]&&(e[WI.DataGrid.WasExpandedDuringFilteringSymbol]=!1,e.collapse());return}let t=e.filterableData||[],i={expandNode:!1},n=this._textFilterRegex;function s(){return!t.length||!n?!0:t.some(d=>n.test(d))?(i.expandNode=!0,!0):!1}function a(){e.hidden=!1;let d=e.parent;for(;d&&!d.root;)d.hidden=!1,i.expandNode&&!d.expanded&&(d[WI.DataGrid.WasExpandedDuringFilteringSymbol]=!0,d.expand()),d=d.parent}if(s()&&this.matchNodeAgainstCustomFilters(e)){a(),!i.expandNode&&e.expanded&&e[WI.DataGrid.WasExpandedDuringFilteringSymbol]&&(e[WI.DataGrid.WasExpandedDuringFilteringSymbol]=!1,e.collapse());return}e.hidden=!0}_updateSortedColumn(e){if(this._sortColumnIdentifierSetting&&(this._sortColumnIdentifierSetting.value=this._sortColumnIdentifier),e){let t=this._headerTableCellElements.get(e);t.classList.remove(WI.DataGrid.SortColumnAscendingStyleClassName),t.classList.remove(WI.DataGrid.SortColumnDescendingStyleClassName)}if(this._sortColumnIdentifier){let t=this._headerTableCellElements.get(this._sortColumnIdentifier);t.classList.toggle(WI.DataGrid.SortColumnAscendingStyleClassName,this._sortOrder===WI.DataGrid.SortOrder.Ascending),t.classList.toggle(WI.DataGrid.SortColumnDescendingStyleClassName,this._sortOrder===WI.DataGrid.SortOrder.Descending)}this.dispatchEventToListeners(WI.DataGrid.Event.SortChanged)}_hasFilterDelegate(){return this._filterDelegate&&typeof this._filterDelegate.dataGridMatchNodeAgainstCustomFilters=="function"}_ondblclick(e){this._editing||this._editingNode||this._startEditing(e.target)}_startEditingNodeAtColumnIndex(e,t){console.assert(e,"Invalid argument: must provide DataGridNode to edit."),this.updateLayoutIfNeeded(),this._editing=!0,this._editingNode=e,this._editingNode.select();var i=this._editingNode.element.children[t];WI.startEditing(i,this._startEditingConfig(i)),window.getSelection().setBaseAndExtent(i,0,i,1)}_startEditing(e){var t=e.closest("td");if(!!t){if(this._editingNode=this.dataGridNodeFromNode(e),!this._editingNode){if(!this.placeholderNode)return;this._editingNode=this.placeholderNode}if(this._editingNode.isPlaceholderNode)return this._startEditingNodeAtColumnIndex(this._editingNode,0);this._editing=!0,WI.startEditing(t,this._startEditingConfig(t)),window.getSelection().setBaseAndExtent(t,0,t,1)}}_startEditingConfig(e){return new WI.EditingConfig(this._editingCommitted.bind(this),this._editingCancelled.bind(this),e.textContent)}_editingCommitted(e,t,i,n,s){var a=e.__columnIdentifier,d=this.orderedColumns.indexOf(a),p=this._editingNode.data[a]||"",f=this._editingNode;f.data[a]=t.trim();function _(S){if(s==="forward"){if(d<this.orderedColumns.length-1)return{shouldSort:!1,editingNode:f,columnIndex:d+1};var E=f.traverseNextNode(!0,null,!0);return{shouldSort:!0,editingNode:E||f,columnIndex:0}}if(s==="backward"){if(d>0)return{shouldSort:!1,editingNode:f,columnIndex:d-1};var k=f.traversePreviousNode(!0,null,!0);return{shouldSort:!0,editingNode:k||f,columnIndex:this.orderedColumns.length-1}}return{shouldSort:!0}}function b(S){var E=_.call(this,S);E.shouldSort&&this._sortAfterEditingCallback&&(this._sortAfterEditingCallback(),this._sortAfterEditingCallback=null),E.editingNode&&this._startEditingNodeAtColumnIndex(E.editingNode,E.columnIndex)}this._editingCancelled(e),this._editCallback(f,a,p,t,s);var w=p.trim()!==t.trim();b.call(this,w)}_editingCancelled(e){console.assert(this._editingNode.element===e.closest("tr")),this._editingNode.refresh(),this._editing=!1,this._editingNode=null}autoSizeColumns(e,t,i){e&&(e=Math.min(e,Math.floor(100/this.orderedColumns.length)));var n={};for(var[s,a]of this.columns)n[s]=(a.title||"").length;var d=i?this._enumerateChildren(this,[],i+1):this.children;for(var p of d)for(var s of this.columns.keys()){var f=this.textForDataGridNodeColumn(p,s);f.length>n[s]&&(n[s]=f.length)}var _=0;for(var s of this.columns.keys())_+=n[s];var b=0;for(var s of this.columns.keys()){var w=Math.round(100*n[s]/_);e&&w<e?(b+=e-w,w=e):t&&w>t&&(b-=w-t,w=t),n[s]=w}for(;e&&b>0;)for(var s of this.columns.keys())if(n[s]>e&&(--n[s],--b,!b))break;for(;t&&b<0;)for(var s of this.columns.keys())if(n[s]<t&&(++n[s],++b,!b))break;for(var[s,a]of this.columns)a.element.style.width=n[s]+"%",a.bodyElement.style.width=n[s]+"%";this._columnWidthsInitialized=!1,this.needsLayout()}insertColumn(e,t,i){i===void 0&&(i=this.orderedColumns.length),i=Number.constrain(i,0,this.orderedColumns.length);var n=new WI.EventListenerSet(this,"DataGrid column DOM listeners"),s=Object.shallowCopy(t);s.listeners=n,s.ordinal=i,s.columnIdentifier=e,this.orderedColumns.splice(i,0,e);for(var[a,d]of this.columns){var p=d.ordinal;p>=i&&(d.ordinal=p+1)}this.columns.set(e,s),s.disclosure&&(this.disclosureColumnIdentifier=e);var f=document.createElement("col");s.width&&(f.style.width=s.width),s.element=f;var E=this._headerTableColumnGroupElement.children[i];this._headerTableColumnGroupElement.insertBefore(f,E);var _=document.createElement("th");_.className=e+"-column",_.columnIdentifier=e,s.aligned&&_.classList.add(s.aligned),this._headerTableCellElements.set(e,_);var E=this._headerTableRowElement.children[i];if(this._headerTableRowElement.insertBefore(_,E),s.headerView){let k=s.headerView;console.assert(k instanceof WI.View),_.appendChild(k.element),this.addSubview(k)}else{let k=_.createChild("div");s.titleDOMFragment?k.appendChild(s.titleDOMFragment):k.textContent=s.title||""}if(s.sortable&&(n.register(_,"click",this._headerCellClicked),_.classList.add(WI.DataGrid.SortableColumnStyleClassName)),s.group&&_.classList.add("column-group-"+s.group),s.tooltip&&(_.title=s.tooltip),s.collapsesGroup){console.assert(s.group!==s.collapsesGroup),_.createChild("div","divider");var b=_.createChild("div","collapser-button");b.title=this._collapserButtonCollapseColumnsToolTip(),n.register(b,"mouseover",this._mouseoverColumnCollapser),n.register(b,"mouseout",this._mouseoutColumnCollapser),n.register(b,"click",this._clickInColumnCollapser),_.collapsesGroup=s.collapsesGroup,_.classList.add("collapser")}this._headerTableColumnGroupElement.span=this.orderedColumns.length;var w=f.cloneNode(),E=this._dataTableColumnGroupElement.children[i];this._dataTableColumnGroupElement.insertBefore(w,E),s.bodyElement=w;var S=document.createElement("td");S.className=e+"-column",S.__columnIdentifier=e,s.group&&S.classList.add("column-group-"+s.group);var E=this._fillerRowElement.children[i];this._fillerRowElement.insertBefore(S,E),n.install(),this.setColumnVisible(e,!s.hidden)}removeColumn(e){console.assert(this.columns.has(e));var t=this.columns.get(e);this.columns.delete(e),this.orderedColumns.splice(this.orderedColumns.indexOf(e),1);var i=t.ordinal;for(var[n,s]of this.columns){var a=s.ordinal;a>i&&(s.ordinal=a-1)}t.listeners.uninstall(!0),t.disclosure&&(this.disclosureColumnIdentifier=void 0),this.sortColumnIdentifier===e&&(this.sortColumnIdentifier=null),this._headerTableCellElements.delete(e),this._headerTableRowElement.children[i].remove(),this._headerTableColumnGroupElement.children[i].remove(),this._dataTableColumnGroupElement.children[i].remove(),this._fillerRowElement.children[i].remove(),this._headerTableColumnGroupElement.span=this.orderedColumns.length;for(var d of this.children)d.refresh()}_enumerateChildren(e,t,i){if(e.root||t.push(e),!!i){for(var n=0;n<e.children.length;++n)this._enumerateChildren(e.children[n],t,i-1);return t}}layout(){if(!this._columnWidthsInitialized&&this.element.offsetWidth){let e=this._headerTableColumnGroupElement.children,t=this._dataTableElement.offsetWidth,i=e.length,n=this._headerTableBodyElement.rows[0].cells,s=[];for(let a=0;a<i;++a){let d=n[a];if(this.isColumnVisible(d.columnIdentifier)){let f=d.offsetWidth/t*100+"%";s.push(f)}else s.push(0)}for(let a=0;a<i;a++){let d=s[a];this._headerTableColumnGroupElement.children[a].style.width=d,this._dataTableColumnGroupElement.children[a].style.width=d}this._columnWidthsInitialized=!0,this._updateHeaderAndScrollbar()}this.updateVisibleRows()}sizeDidChange(){this._updateHeaderAndScrollbar()}_updateHeaderAndScrollbar(){this._positionResizerElements(),this._positionHeaderViews(),this._updateScrollbarPadding(),this._cachedScrollTop=NaN,this._cachedScrollableOffsetHeight=NaN}isColumnVisible(e){return!this.columns.get(e).hidden}setColumnVisible(e,t){let i=this.columns.get(e);if(console.assert(i,"Missing column info for identifier: "+e),console.assert(typeof t=="boolean","New visible state should be explicit boolean",typeof t),!(!i||t===!i.hidden)){if(i.element.style.width=t?i.width:0,i.hidden=!t,this._columnVisibilitySetting&&this._columnVisibilitySetting.value[e]!==t){let n=Object.shallowCopy(this._columnVisibilitySetting.value);n[e]=t,this._columnVisibilitySetting.value=n}this._columnWidthsInitialized=!1,this.updateLayout()}}get scrollContainer(){return this._scrollContainerElement}isScrolledToLastRow(){return this._scrollContainerElement.isScrolledToBottom()}scrollToLastRow(){this._scrollContainerElement.scrollTop=this._scrollContainerElement.scrollHeight-this._scrollContainerElement.offsetHeight}_positionResizerElements(){let e=0;for(var t=null,i=this.orderedColumns.length-1,n=this._headerTableBodyElement.rows[0].cells,s=[],a=0;a<i;++a)e+=n[a].getBoundingClientRect().width,s.push(e);for(var a=0;a<i;++a){var d=this.resizers[a];d||(d=this.resizers[a]=new WI.Resizer(WI.Resizer.RuleOrientation.Vertical,this),this.element.appendChild(d.element)),e=s[a],this.isColumnVisible(this.orderedColumns[a])?(d.element.style.removeProperty("display"),d.element.style.setProperty(WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?"right":"left",`${e}px`),d[WI.DataGrid.PreviousColumnOrdinalSymbol]=a,t&&(t[WI.DataGrid.NextColumnOrdinalSymbol]=a),t=d):(d.element.style.setProperty("display","none"),d[WI.DataGrid.PreviousColumnOrdinalSymbol]=0,d[WI.DataGrid.NextColumnOrdinalSymbol]=0)}t&&(t[WI.DataGrid.NextColumnOrdinalSymbol]=this.orderedColumns.length-1)}_positionHeaderViews(){let e=0,t=[],i=[],n=[];for(let s of this.orderedColumns){let a=this.columns.get(s);if(console.assert(a,"Missing column data for header cell with columnIdentifier "+s),!a)continue;let d=this._headerTableCellElements.get(s).offsetWidth,p=a.headerView;p&&(t.push(p),i.push(e),n.push(d)),e+=d}for(let s=0;s<t.length;++s){let a=t[s];a.element.style.setProperty(WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?"right":"left",`${i[s]}px`),a.element.style.width=n[s]+"px",a.updateLayout(WI.View.LayoutReason.Resize)}}_noteRowsChanged(){this._previousRevealedRowCount=NaN,this.needsLayout()}_noteRowRemoved(e){if(this._inline||this._variableHeightRows){e.element&&e.element.parentNode&&e.element.parentNode.removeChild(e.element);return}this._noteRowsChanged()}_noteScrollPositionChanged(){this._cachedScrollTop=NaN,this.needsLayout()}updateVisibleRows(e){if(this._inline||this._variableHeightRows){let b=this.dataTableBodyElement.lastChild;for(let w=this._rows.length-1;w>=0;--w){let S=this._rows[w].element;S.nextSibling!==b&&this.dataTableBodyElement.insertBefore(S,b),b=S}e&&e.element.scrollIntoViewIfNeeded(!1);return}let t=this.rowHeight,i=t*5,n=i*3;isNaN(this._cachedScrollTop)&&(this._cachedScrollTop=this._scrollContainerElement.scrollTop),isNaN(this._cachedScrollableOffsetHeight)&&(this._cachedScrollableOffsetHeight=this._scrollContainerElement.offsetHeight);let s=Math.ceil((this._cachedScrollableOffsetHeight+n*2)/t);if(!e){let b=this._topDataTableMarginHeight,w=this._bottomDataTableMarginHeight,S=b+s*t,E=!b||this._cachedScrollTop>b+i,k=!w||this._cachedScrollTop+this._cachedScrollableOffsetHeight<S-i;if(E&&k&&!isNaN(this._previousRevealedRowCount))return}let a=this._rows.filter(b=>b.revealed&&!b.hidden);if(this._previousRevealedRowCount=a.length,e){let b=a.indexOf(e),w=this._cachedScrollTop/t;(b<w||b>w+s)&&(this._scrollContainerElement.scrollTop=this._cachedScrollTop=b*t-this._cachedScrollableOffsetHeight/2+t/2)}let d=Math.max(0,Math.floor((this._cachedScrollTop-n)/t)),p=Math.max(0,this._previousRevealedRowCount-d-s),f=d*t,_=p*t;this._topDataTableMarginHeight!==f&&(this._topDataTableMarginHeight=f,this._topDataTableMarginElement.style.height=f+"px"),this._bottomDataTableMarginElement!==_&&(this._bottomDataTableMarginHeight=_,this._bottomDataTableMarginElement.style.height=_+"px"),this._dataTableElement.classList.toggle("odd-first-zebra-stripe",!!(d%2)),this.dataTableBodyElement.removeChildren();for(let b=d;b<d+s;++b){let w=a[b];!w||this.dataTableBodyElement.appendChild(w.element)}this.dataTableBodyElement.appendChild(this._fillerRowElement)}addPlaceholderNode(){this.placeholderNode&&this.placeholderNode.makeNormal();var e={};for(var t of this.columns.keys())e[t]="";this.placeholderNode=new WI.PlaceholderDataGridNode(e),this.appendChild(this.placeholderNode)}appendChild(e){this.insertChild(e,this.children.length)}insertChild(e,t){if(console.assert(e),!!e&&(console.assert(e.parent!==this),e.parent!==this)){e.parent&&e.parent.removeChild(e),this.children.splice(t,0,e),this.hasChildren=!0,e.parent=this,e.dataGrid=this.dataGrid,e._recalculateSiblings(t),delete e._depth,delete e._revealed,delete e._attached,delete e._leftPadding,e._shouldRefreshChildren=!0;for(var i=e.children[0];i;)i.dataGrid=this.dataGrid,delete i._depth,delete i._revealed,delete i._attached,delete i._leftPadding,i._shouldRefreshChildren=!0,i=i.traverseNextNode(!1,e,!0);this.expanded&&e._attach(),this.dataGrid.hasFilters()&&this.dataGrid._applyFiltersToNodeAndDispatchEvent(e)}}removeChild(e){console.assert(e),e&&(console.assert(e.parent===this),e.parent===this&&(e.deselect(),e._detach(),this.children.remove(e,!0),e.previousSibling&&(e.previousSibling.nextSibling=e.nextSibling),e.nextSibling&&(e.nextSibling.previousSibling=e.previousSibling),e.dataGrid=null,e.parent=null,e.nextSibling=null,e.previousSibling=null,this.children.length<=0&&(this.hasChildren=!1),console.assert(!e.isPlaceholderNode,"Shouldn't delete the placeholder node.")))}removeChildren(){for(var e=0;e<this.children.length;++e){var t=this.children[e];t.deselect(),t._detach(),t.dataGrid=null,t.parent=null,t.nextSibling=null,t.previousSibling=null}this.children=[],this.hasChildren=!1}findNode(e,t,i,n){console.assert(typeof e=="function");let s=this._rows[0];for(;s&&!s.root;){if(!s.isPlaceholderNode&&!(t&&s.hidden)&&e(s))return s;s=s.traverseNextNode(t,i,n)}return null}sortNodes(e){this._sortNodesComparator=e,!this._sortNodesRequestId&&(this._sortNodesRequestId=window.requestAnimationFrame(()=>{this._sortNodesComparator&&this._sortNodesCallback(this._sortNodesComparator)}))}sortNodesImmediately(e){this._sortNodesCallback(e)}_sortNodesCallback(e){function t(n,s){if(console.assert(!n.hasChildren,"This sort method can't be used with parent nodes, children will be displayed out of order."),console.assert(!s.hasChildren,"This sort method can't be used with parent nodes, children will be displayed out of order."),n.isPlaceholderNode)return 1;if(s.isPlaceholderNode)return-1;var a=this.sortOrder!==WI.DataGrid.SortOrder.Ascending?-1:1;return a*e(n,s)}if(this._sortNodesRequestId=void 0,this._sortNodesComparator=null,this._editing){this._sortAfterEditingCallback=this.sortNodes.bind(this,e);return}this._rows.sort(t.bind(this)),this._noteRowsChanged();let i=null;for(let n of this._rows)n.previousSibling=i,i&&(i.nextSibling=n),i=n;i&&(i.nextSibling=null),this.parentView||this.updateLayoutIfNeeded()}_toggledSortOrder(){return this._sortOrder!==WI.DataGrid.SortOrder.Descending?WI.DataGrid.SortOrder.Descending:WI.DataGrid.SortOrder.Ascending}_selectSortColumnAndSetOrder(e,t){this.sortColumnIdentifier=e,this.sortOrder=t}_keyDown(e){if(!this.selectedNode||e.shiftKey||e.metaKey||e.ctrlKey||this._editing)return;let t=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL;var i=!1,n;if(e.keyIdentifier==="Up"&&!e.altKey){for(n=this.selectedNode.traversePreviousNode(!0);n&&!n.selectable;)n=n.traversePreviousNode(!0);i=!!n}else if(e.keyIdentifier==="Down"&&!e.altKey){for(n=this.selectedNode.traverseNextNode(!0);n&&!n.selectable;)n=n.traverseNextNode(!0);i=!!n}else!t&&e.keyIdentifier==="Left"||t&&e.keyIdentifier==="Right"?this.selectedNode.expanded?(e.altKey?this.selectedNode.collapseRecursively():this.selectedNode.collapse(),i=!0):this.selectedNode.parent&&!this.selectedNode.parent.root&&(i=!0,this.selectedNode.parent.selectable?(n=this.selectedNode.parent,i=!!n):this.selectedNode.parent&&this.selectedNode.parent.collapse()):!t&&e.keyIdentifier==="Right"||t&&e.keyIdentifier==="Left"?this.selectedNode.revealed?this.selectedNode.hasChildren&&(i=!0,this.selectedNode.expanded?(n=this.selectedNode.children[0],i=!!n):e.altKey?this.selectedNode.expandRecursively():this.selectedNode.expand()):(this.selectedNode.reveal(),i=!0):e.keyCode===8||e.keyCode===46?this._deleteCallback&&(i=!0,this._deleteCallback(this.selectedNode)):isEnterKey(e)&&this._editCallback&&(i=!0,this._startEditing(this.selectedNode.element.children[0]));n&&(n.reveal(),n.select()),i&&(e.preventDefault(),e.stopPropagation())}closed(){}expand(){}collapse(){}reveal(){}revealAndSelect(){}dataGridNodeFromNode(e){var t=e.closest("tr");return t&&t._dataGridNode}dataGridNodeFromPoint(e,t){var i=this._dataTableElement.ownerDocument.elementFromPoint(e,t),n=i.closest("tr");return n&&n._dataGridNode}_headerCellClicked(e){let t=e.target.closest("th");if(!t||!t.columnIdentifier||!t.classList.contains(WI.DataGrid.SortableColumnStyleClassName))return;let i=this._sortColumnIdentifier===t.columnIdentifier?this._toggledSortOrder():this.sortOrder;this._selectSortColumnAndSetOrder(t.columnIdentifier,i)}_mouseoverColumnCollapser(e){var t=e.target.closest("th");!t||!t.collapsesGroup||t.classList.add("mouse-over-collapser")}_mouseoutColumnCollapser(e){var t=e.target.closest("th");!t||!t.collapsesGroup||t.classList.remove("mouse-over-collapser")}_clickInColumnCollapser(e){var t=e.target.closest("th");!t||!t.collapsesGroup||(this._collapseColumnGroupWithCell(t),e.stopPropagation(),e.preventDefault())}collapseColumnGroup(e){var t=null;for(var[i,n]of this.columns)if(n.collapsesGroup===e){t=i;break}if(console.assert(t),!!t){var s=this._headerTableCellElements.get(t);this._collapseColumnGroupWithCell(s)}}_collapseColumnGroupWithCell(e){var t=e.classList.toggle("collapsed");this.willToggleColumnGroup(e.collapsesGroup,t);for(var[i,n]of this.columns)n.group===e.collapsesGroup&&this.setColumnVisible(i,!t);var s=e.querySelector(".collapser-button");s&&(s.title=t?this._collapserButtonExpandColumnsToolTip():this._collapserButtonCollapseColumnsToolTip()),this.didToggleColumnGroup(e.collapsesGroup,t)}_collapserButtonCollapseColumnsToolTip(){return WI.UIString("Collapse columns")}_collapserButtonExpandColumnsToolTip(){return WI.UIString("Expand columns")}willToggleColumnGroup(e,t){}didToggleColumnGroup(e,t){}headerTableHeader(e){return this._headerTableCellElements.get(e)}_mouseDownInDataTable(e){var t=this.dataGridNodeFromNode(e.target);if(!t){this.selectedNode&&this.selectedNode.deselect();return}!t.selectable||t.isEventWithinDisclosureTriangle(e)||(e.metaKey&&t.selected?t.deselect():t.select())}_contextMenuInHeader(e){let t=WI.ContextMenu.createFromEvent(e);this._hasCopyableData()&&t.appendItem(WI.UIString("Copy Table"),this._copyTable.bind(this));let i=e.target.closest("th");if(!i)return;let n=i.columnIdentifier,s=this.columns.get(n);if(console.assert(s,"Missing column info for identifier: "+n),!!s&&(s.sortable&&(t.appendSeparator(),(this.sortColumnIdentifier!==n||this.sortOrder!==WI.DataGrid.SortOrder.Ascending)&&t.appendItem(WI.UIString("Sort Ascending"),()=>{this._selectSortColumnAndSetOrder(n,WI.DataGrid.SortOrder.Ascending)}),(this.sortColumnIdentifier!==n||this.sortOrder!==WI.DataGrid.SortOrder.Descending)&&t.appendItem(WI.UIString("Sort Descending"),()=>{this._selectSortColumnAndSetOrder(n,WI.DataGrid.SortOrder.Descending)})),this._columnChooserEnabled)){let a=!1;for(let[d,p]of this.columns)if(!p.locked){if(!a){t.appendSeparator(),a=!0;const f=!0;t.appendItem(WI.UIString("Displayed Columns"),()=>{},f)}t.appendCheckboxItem(p.title,()=>{this.setColumnVisible(d,!!p.hidden)},!p.hidden)}}}_contextMenuInDataTable(e){let t=WI.ContextMenu.createFromEvent(e),i=this.dataGridNodeFromNode(e.target);if(i&&i.appendContextMenuItems(t),this.dataGrid._refreshCallback&&(!i||i!==this.placeholderNode)&&t.appendItem(WI.UIString("Refresh"),this._refreshCallback.bind(this)),i){if(i.selectable&&i.copyable&&!i.isEventWithinDisclosureTriangle(e)){if(t.appendItem(WI.UIString("Copy Row"),this._copyRow.bind(this,e.target)),t.appendItem(WI.UIString("Copy Table"),this._copyTable.bind(this)),this.dataGrid._editCallback)if(i===this.placeholderNode)t.appendItem(WI.UIString("Add New"),this._startEditing.bind(this,e.target));else{let s=e.target.closest("td").__columnIdentifier,a=this.dataGrid.columns.get(s).title;t.appendItem(WI.UIString("Edit \u201C%s\u201D").format(a),this._startEditing.bind(this,e.target))}this.dataGrid._deleteCallback&&i!==this.placeholderNode&&t.appendItem(WI.UIString("Delete"),this._deleteCallback.bind(this,i))}(i.children.some(n=>n.hasChildren)||i.hasChildren&&!i.children.length)&&(t.appendSeparator(),t.appendItem(WI.UIString("Expand All"),i.expandRecursively.bind(i)),t.appendItem(WI.UIString("Collapse All"),i.collapseRecursively.bind(i)))}}_clickInDataTable(e){var t=this.dataGridNodeFromNode(e.target);!t||!t.hasChildren||!t.isEventWithinDisclosureTriangle(e)||(t.expanded?e.altKey?t.collapseRecursively():t.collapse():e.altKey?t.expandRecursively():t.expand())}textForDataGridNodeColumn(e,t){var i=e.data[t];return(i instanceof Node?i.textContent:i)||""}_copyTextForDataGridNode(e){return e.dataGrid.orderedColumns.map(i=>{let n=this.textForDataGridNodeColumn(e,i);return this._copyCallback&&(n=this._copyCallback(e,i,n)),n}).join(this._copyTextDelimiter)}_copyTextForDataGridHeaders(){return this.orderedColumns.map(t=>this.headerTableHeader(t).textContent).join(this._copyTextDelimiter)}handleBeforeCopyEvent(e){this.selectedNode&&window.getSelection().isCollapsed&&e.preventDefault()}handleCopyEvent(e){if(!(!this.selectedNode||!window.getSelection().isCollapsed)){var t=this._copyTextForDataGridNode(this.selectedNode);e.clipboardData.setData("text/plain",t),e.stopPropagation(),e.preventDefault()}}_copyRow(e){var t=this.dataGridNodeFromNode(e);if(!!t){var i=this._copyTextForDataGridNode(t);InspectorFrontendHost.copyText(i)}}_copyTable(){let e=[];e.push(this._copyTextForDataGridHeaders());for(let t of this.children)!t.copyable||e.push(this._copyTextForDataGridNode(t));InspectorFrontendHost.copyText(e.join(`
`))}_hasCopyableData(){let e=this.children[0];return e&&e.selectable&&e.copyable}resizerDragStarted(e){if(!e[WI.DataGrid.NextColumnOrdinalSymbol])return!0;this._currentResizer=e}resizerDragging(e,t){if(console.assert(e===this._currentResizer,e,this._currentResizer),e!==this._currentResizer)return;let i=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL;i&&(t*=-1);let n=0;i?n+=this.element.totalOffsetRight-e.initialPosition-t:n+=e.initialPosition-this.element.totalOffsetLeft-t;var s=e[WI.DataGrid.PreviousColumnOrdinalSymbol],a=e[WI.DataGrid.NextColumnOrdinalSymbol],d=this._headerTableBodyElement.rows[0].cells;let p=0;for(let V=0;V<s;++V)p+=d[V].offsetWidth;let f=p+d[s].offsetWidth+d[a].offsetWidth,_=p+WI.DataGrid.ColumnResizePadding,b=f-WI.DataGrid.ColumnResizePadding;n=Number.constrain(n,_,b),e.element.style.setProperty(i?"right":"left",`${n-this.CenterResizerOverBorderAdjustment}px`);let w=(n-p)/this._dataTableElement.offsetWidth*100+"%";this._headerTableColumnGroupElement.children[s].style.width=w,this._dataTableColumnGroupElement.children[s].style.width=w;let S=(f-n)/this._dataTableElement.offsetWidth*100+"%";this._headerTableColumnGroupElement.children[a].style.width=S,this._dataTableColumnGroupElement.children[a].style.width=S,this._positionResizerElements(),this._positionHeaderViews();const E=!0,k=!0;let R=this.orderedColumns[s],M=this.orderedColumns[a],L=this.children[0];for(;L;)L.didResizeColumn(R),L.didResizeColumn(M),L=L.traverseNextNode(E,this,k);event.preventDefault()}resizerDragEnded(e){console.assert(e===this._currentResizer,e,this._currentResizer),e===this._currentResizer&&(this._currentResizer=null)}_updateFilter(){if(this._scheduledFilterUpdateIdentifier&&(cancelAnimationFrame(this._scheduledFilterUpdateIdentifier),this._scheduledFilterUpdateIdentifier=void 0),!this._rows.length)return;this._textFilterRegex=this._filterText?WI.SearchUtilities.regExpForString(this._filterText,WI.SearchUtilities.defaultSettings):null,this._applyFilterToNodesTask&&this._applyFilterToNodesTask.processing&&this._applyFilterToNodesTask.cancel();function*e(){let i=!this.hasFilters(),n=this._rows[0];for(;n&&!n.root;)yield n,n=n.traverseNextNode(!1,null,i)}let t=e.call(this);this._applyFilterToNodesTask=new WI.YieldableTask(this,t,{workInterval:100}),this._filterDidModifyNodeWhileProcessingItems=!1,this._applyFilterToNodesTask.start()}yieldableTaskWillProcessItem(e,t){this._applyFiltersToNodeAndDispatchEvent(t)&&(this._filterDidModifyNodeWhileProcessingItems=!0)}yieldableTaskDidYield(e,t,i){!this._filterDidModifyNodeWhileProcessingItems||(this._filterDidModifyNodeWhileProcessingItems=!1,this.dispatchEventToListeners(WI.DataGrid.Event.FilterDidChange))}yieldableTaskDidFinish(e){this._applyFilterToNodesTask=null}};WI.DataGrid.Event={SortChanged:"datagrid-sort-changed",SelectedNodeChanged:"datagrid-selected-node-changed",ExpandedNode:"datagrid-expanded-node",CollapsedNode:"datagrid-collapsed-node",FilterDidChange:"datagrid-filter-did-change",NodeWasFiltered:"datagrid-node-was-filtered"};WI.DataGrid.SortOrder={Indeterminate:"data-grid-sort-order-indeterminate",Ascending:"data-grid-sort-order-ascending",Descending:"data-grid-sort-order-descending"};WI.DataGrid.PreviousColumnOrdinalSymbol=Symbol("previous-column-ordinal");WI.DataGrid.NextColumnOrdinalSymbol=Symbol("next-column-ordinal");WI.DataGrid.WasExpandedDuringFilteringSymbol=Symbol("was-expanded-during-filtering");WI.DataGrid.ColumnResizePadding=10;WI.DataGrid.CenterResizerOverBorderAdjustment=3;WI.DataGrid.SortColumnAscendingStyleClassName="sort-ascending";WI.DataGrid.SortColumnDescendingStyleClassName="sort-descending";WI.DataGrid.SortableColumnStyleClassName="sortable";WI.DataGridNode=class extends WI.Object{constructor(e,t,i){super(),this._expanded=!1,this._hidden=!1,this._selected=!1,this._copyable=!0,this._shouldRefreshChildren=!0,this._data=e||{},this.hasChildren=t||!1,this.children=[],this.dataGrid=null,this.parent=null,this.previousSibling=null,this.nextSibling=null,this.disclosureToggleWidth=10,this._classNames=i||[]}get hidden(){return this._hidden}set hidden(e){e=!!e,this._hidden!==e&&(this._hidden=e,this._element&&this._element.classList.toggle("hidden",this._hidden),this.dataGrid&&this.dataGrid._noteRowsChanged())}get selectable(){return this._element&&!this._hidden}get copyable(){return this._copyable}set copyable(e){this._copyable=e}get element(){return this._element?this._element:this.dataGrid?(this._element=document.createElement("tr"),this._element._dataGridNode=this,this.hasChildren&&this._element.classList.add("parent"),this.expanded&&this._element.classList.add("expanded"),this.selected&&this._element.classList.add("selected"),this.revealed&&this._element.classList.add("revealed"),this._hidden&&this._element.classList.add("hidden"),this._element.classList.add(...this._classNames),this.createCells(),this._element):null}createCells(){for(var e of this.dataGrid.orderedColumns)this._element.appendChild(this.createCell(e))}refreshIfNeeded(){!this._needsRefresh||(this._needsRefresh=!1,this.refresh())}needsRefresh(){this._needsRefresh=!0,this._revealed&&(this._scheduledRefreshIdentifier||(this._scheduledRefreshIdentifier=requestAnimationFrame(this.refresh.bind(this))))}get data(){return this._data}set data(e){console.assert(typeof e=="object","Data should be an object."),e=e||{},!Object.shallowEqual(this._data,e)&&(this._data=e,this.needsRefresh())}get filterableData(){if(this._cachedFilterableData)return this._cachedFilterableData;this._cachedFilterableData=[];for(let e of this.dataGrid.columns.values()){if(e.hidden)continue;let t=this.filterableDataForColumn(e.columnIdentifier);!t||(t instanceof Array||(t=[t]),t.length&&(this._cachedFilterableData=this._cachedFilterableData.concat(t)))}return this._cachedFilterableData}get revealed(){if("_revealed"in this)return this._revealed;for(var e=this.parent;e&&!e.root;){if(!e.expanded)return this._revealed=!1,!1;e=e.parent}return this._revealed=!0,!0}set hasChildren(e){this._hasChildren!==e&&(this._hasChildren=e,this._element&&(this._hasChildren?(this._element.classList.add("parent"),this.expanded&&this._element.classList.add("expanded")):this._element.classList.remove("parent","expanded")))}get hasChildren(){return this._hasChildren}set revealed(e){if(this._revealed!==e){this._revealed=e,this._element&&(this._revealed?this._element.classList.add("revealed"):this._element.classList.remove("revealed")),this.refreshIfNeeded();for(var t=0;t<this.children.length;++t)this.children[t].revealed=e&&this.expanded}}get depth(){return"_depth"in this?this._depth:(this.parent&&!this.parent.root?this._depth=this.parent.depth+1:this._depth=0,this._depth)}get indentPadding(){return typeof this._indentPadding=="number"?this._indentPadding:(this._indentPadding=this.depth*this.dataGrid.indentWidth,this._indentPadding)}get shouldRefreshChildren(){return this._shouldRefreshChildren}set shouldRefreshChildren(e){this._shouldRefreshChildren=e,e&&this.expanded&&this.expand()}get selected(){return this._selected}set selected(e){e?this.select():this.deselect()}get expanded(){return this._expanded}set expanded(e){e?this.expand():this.collapse()}hasAncestor(e){if(!e)return!1;let t=this.parent;for(;t;){if(e===t)return!0;t=t.parent}return!1}refresh(){!this._element||!this.dataGrid||(this._scheduledRefreshIdentifier&&(cancelAnimationFrame(this._scheduledRefreshIdentifier),this._scheduledRefreshIdentifier=void 0),this._cachedFilterableData=null,this._needsRefresh=!1,this._element.removeChildren(),this.createCells())}refreshRecursively(){this.refresh(),this.forEachChildInSubtree(e=>e.refresh())}updateLayout(){}createCell(e){var t=document.createElement("td");t.className=e+"-column",t.__columnIdentifier=e;var i=t.createChild("div","cell-content"),n=this.createCellContent(e,t);i.append(n);let s=this.dataGrid.columns.get(e);if(s&&(s.aligned&&t.classList.add(s.aligned),s.group&&t.classList.add("column-group-"+s.group),s.icon)){let a=document.createElement("div");a.classList.add("icon"),i.insertBefore(a,i.firstChild)}return e===this.dataGrid.disclosureColumnIdentifier&&(t.classList.add("disclosure"),this.indentPadding&&(WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?t.style.setProperty("padding-right",`${this.indentPadding}px`):t.style.setProperty("padding-left",`${this.indentPadding}px`))),t}createCellContent(e){if(!(e in this.data))return zeroWidthSpace;let t=this.data[e];return typeof t=="number"?t.maxDecimals(2).toLocaleString():t}elementWithColumnIdentifier(e){if(!this.dataGrid)return null;let t=this.dataGrid.orderedColumns.indexOf(e);return t===-1?null:this.element.children[t]}appendChild(){return WI.DataGrid.prototype.appendChild.apply(this,arguments)}insertChild(){return WI.DataGrid.prototype.insertChild.apply(this,arguments)}removeChild(){return WI.DataGrid.prototype.removeChild.apply(this,arguments)}removeChildren(){return WI.DataGrid.prototype.removeChildren.apply(this,arguments)}_recalculateSiblings(e){if(!!this.parent){var t=e>0?this.parent.children[e-1]:null;t?(t.nextSibling=this,this.previousSibling=t):this.previousSibling=null;var i=this.parent.children[e+1];i?(i.previousSibling=this,this.nextSibling=i):this.nextSibling=null}}collapse(){this._element&&this._element.classList.remove("expanded"),this._expanded=!1;for(var e=0;e<this.children.length;++e)this.children[e].revealed=!1;this.dispatchEventToListeners("collapsed"),this.dataGrid&&(this.dataGrid.dispatchEventToListeners(WI.DataGrid.Event.CollapsedNode,{dataGridNode:this}),this.dataGrid._noteRowsChanged())}collapseRecursively(){for(var e=this;e;)e.expanded&&e.collapse(),e=e.traverseNextNode(!1,this,!0)}expand(){if(!(!this.hasChildren||this.expanded)){if(this.revealed&&!this._shouldRefreshChildren)for(var e=0;e<this.children.length;++e)this.children[e].revealed=!0;if(this._shouldRefreshChildren){for(var e=0;e<this.children.length;++e)this.children[e]._detach();if(this.dispatchEventToListeners("populate"),this._attached)for(var e=0;e<this.children.length;++e){var t=this.children[e];this.revealed&&(t.revealed=!0),t._attach()}this._shouldRefreshChildren=!1}this._element&&this._element.classList.add("expanded"),this._expanded=!0,this.dispatchEventToListeners("expanded"),this.dataGrid&&(this.dataGrid.dispatchEventToListeners(WI.DataGrid.Event.ExpandedNode,{dataGridNode:this}),this.dataGrid._noteRowsChanged())}}expandRecursively(){for(var e=this;e;)e.expand(),e=e.traverseNextNode(!1,this)}forEachImmediateChild(e){for(let t of this.children)e(t)}forEachChildInSubtree(e){let t=this.traverseNextNode(!1,this,!0);for(;t;)e(t),t=t.traverseNextNode(!1,this,!0)}isInSubtreeOfNode(e){let t=e;for(;t;){if(t===this)return!0;t=t.traverseNextNode(!1,e,!0)}return!1}reveal(){for(var e=this.parent;e&&!e.root;)e.expanded||e.expand(),e=e.parent;this.dataGrid.updateVisibleRows(this),this.dispatchEventToListeners("revealed")}select(e){if(!this.dataGrid||!this.selectable||this.selected)return;let t=this.dataGrid.selectedNode;t&&t.deselect(!0),this._selected=!0,this.dataGrid.selectedNode=this,this._element&&this._element.classList.add("selected"),e||this.dataGrid.dispatchEventToListeners(WI.DataGrid.Event.SelectedNodeChanged,{oldSelectedNode:t})}revealAndSelect(e){this.reveal(),this.select(e)}deselect(e){!this.dataGrid||this.dataGrid.selectedNode!==this||!this.selected||(this._selected=!1,this.dataGrid.selectedNode=null,this._element&&this._element.classList.remove("selected"),e||this.dataGrid.dispatchEventToListeners(WI.DataGrid.Event.SelectedNodeChanged,{oldSelectedNode:this}))}traverseNextNode(e,t,i,n){!i&&this.hasChildren&&this.dispatchEventToListeners("populate"),n&&(n.depthChange=0);var s=!e||this.revealed?this.children[0]:null;if(s&&(!e||this.expanded))return n&&(n.depthChange=1),s;if(this===t)return null;if(s=!e||this.revealed?this.nextSibling:null,s)return s;for(s=this;s&&!s.root&&!((!e||s.revealed)&&s.nextSibling)&&s.parent!==t;)n&&(n.depthChange-=1),s=s.parent;return s&&(!e||s.revealed)?s.nextSibling:null}traversePreviousNode(e,t){var i=!e||this.revealed?this.previousSibling:null;for(!t&&i&&i.hasChildren&&i.dispatchEventToListeners("populate");i&&(!e||i.revealed&&i.expanded?i.children.lastValue:null);)!t&&i.hasChildren&&i.dispatchEventToListeners("populate"),i=!e||i.revealed&&i.expanded?i.children.lastValue:null;return i||(!this.parent||this.parent.root?null:this.parent)}isEventWithinDisclosureTriangle(e){if(!this.hasChildren)return!1;let t=e.target.closest("td");if(!t||!t.classList.contains("disclosure"))return!1;let i=window.getComputedStyle(t),n=0;return WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?n+=t.totalOffsetRight-i.getPropertyCSSValue("padding-right").getFloatValue(CSSPrimitiveValue.CSS_PX)-this.disclosureToggleWidth:n+=t.totalOffsetLeft+i.getPropertyCSSValue("padding-left").getFloatValue(CSSPrimitiveValue.CSS_PX),e.pageX>=n&&e.pageX<=n+this.disclosureToggleWidth}_attach(){if(!this.dataGrid||this._attached)return;this._attached=!0;let e=-1;if(!this.isPlaceholderNode){var t=this.traversePreviousNode(!0,!0);e=this.dataGrid._rows.indexOf(t),e===-1?e=0:e++}if(e===-1?this.dataGrid._rows.push(this):this.dataGrid._rows.insertAtIndex(this,e),this.dataGrid._noteRowsChanged(),this.expanded)for(var i=0;i<this.children.length;++i)this.children[i]._attach()}_detach(){if(!!this._attached){this._attached=!1,this.dataGrid._rows.remove(this,!0),this.dataGrid._noteRowRemoved(this);for(var e=0;e<this.children.length;++e)this.children[e]._detach()}}savePosition(){this._savedPosition||(console.assert(this.parent),this.parent&&(this._savedPosition={parent:this.parent,index:this.parent.children.indexOf(this)}))}restorePosition(){!this._savedPosition||(this.parent!==this._savedPosition.parent&&this._savedPosition.parent.insertChild(this,this._savedPosition.index),this._savedPosition=null)}appendContextMenuItems(e){return null}filterableDataForColumn(e){let t=this.data[e];return typeof t=="string"?t:null}didResizeColumn(e){}};WI.PlaceholderDataGridNode=class extends WI.DataGridNode{constructor(e){super(e,!1),this.isPlaceholderNode=!0}makeNormal(){this.isPlaceholderNode=!1}};WI.DetailsSectionRow=class extends WI.Object{constructor(e){super(),this._element=document.createElement("div"),this._element.className="row",this._emptyMessage=e||""}get element(){return this._element}get emptyMessage(){return this._emptyMessage}set emptyMessage(e){this._emptyMessage=e||"",this._element.childNodes.length||this.showEmptyMessage()}showEmptyMessage(){this.element.classList.add(WI.DetailsSectionRow.EmptyStyleClassName),this._emptyMessage instanceof Node?(this.element.removeChildren(),this.element.appendChild(this._emptyMessage)):this.element.textContent=this._emptyMessage}hideEmptyMessage(){this.element.classList.remove(WI.DetailsSectionRow.EmptyStyleClassName),this.element.removeChildren()}};WI.DetailsSectionRow.EmptyStyleClassName="empty";WI.Dialog=class extends WI.View{constructor(e){super(),this._delegate=e,this._dismissing=!1,this._representedObject=null,this._cookie=null,this._visible=!1}get visible(){return this._visible}get delegate(){return this._delegate}get representedObject(){return this._representedObject}get cookie(){return this._cookie}present(e){console.assert(!this.element.parentNode),e.appendChild(this.element),this._visible=!0,this.didPresentDialog()}dismiss(e,t){this._dismissing||!this.element.parentNode||(this._dismissing=!0,this._representedObject=e||null,this._cookie=t||null,this._visible=!1,this.element.remove(),this.representedObjectIsValid(this._representedObject)&&this._delegate&&typeof this._delegate.dialogWasDismissedWithRepresentedObject=="function"&&this._delegate.dialogWasDismissedWithRepresentedObject(this,this._representedObject),this._dismissing=!1,this.didDismissDialog())}didDismissDialog(){}didPresetDialog(){}representedObjectIsValid(e){return this.delegate&&typeof this.delegate.isDialogRepresentedObjectValid=="function"?this.delegate.isDialogRepresentedObjectValid(this,e):!0}};WI.HierarchicalPathComponent=class extends WI.Object{constructor(e,t,i,n,s){super(),console.assert(e),console.assert(t),this._representedObject=i||null,this._element=document.createElement("div"),this._element.className="hierarchical-path-component",Array.isArray(t)||(t=[t]),this._element.classList.add(...t),n?this._element.classList.add("text-only"):(this._iconElement=document.createElement("img"),this._iconElement.className="icon",this._element.appendChild(this._iconElement)),this._titleElement=document.createElement("div"),this._titleElement.className="title",this._titleElement.setAttribute("dir","auto"),this._element.appendChild(this._titleElement),this._titleContentElement=document.createElement("div"),this._titleContentElement.className="content",this._titleElement.appendChild(this._titleContentElement),this._separatorElement=document.createElement("div"),this._separatorElement.className="separator",this._element.appendChild(this._separatorElement),this._selectElement=document.createElement("select"),this._selectElement.setAttribute("dir","auto"),this._selectElement.addEventListener("mouseover",this._selectElementMouseOver.bind(this)),this._selectElement.addEventListener("mouseout",this._selectElementMouseOut.bind(this)),this._selectElement.addEventListener("mousedown",this._selectElementMouseDown.bind(this)),this._selectElement.addEventListener("mouseup",this._selectElementMouseUp.bind(this)),this._selectElement.addEventListener("change",this._selectElementSelectionChanged.bind(this)),this._element.appendChild(this._selectElement),this._previousSibling=null,this._nextSibling=null,this._truncatedDisplayNameLength=0,this._collapsed=!1,this._hidden=!1,this._selectorArrows=!1,this.displayName=e,this.tooltip=e,this.selectorArrows=s}get selectedPathComponent(){let e=this._selectElement[this._selectElement.selectedIndex];return!e&&this._selectElement.options.length===1&&(e=this._selectElement.options[0]),e&&e._pathComponent||null}get element(){return this._element}get representedObject(){return this._representedObject}get displayName(){return this._displayName}set displayName(e){console.assert(e),e!==this._displayName&&(this._displayName=e,this._updateElementTitleAndText())}get truncatedDisplayNameLength(){return this._truncatedDisplayNameLength}set truncatedDisplayNameLength(e){e=e||0,e!==this._truncatedDisplayNameLength&&(this._truncatedDisplayNameLength=e,this._updateElementTitleAndText())}get minimumWidth(){return this._collapsed?WI.HierarchicalPathComponent.MinimumWidthCollapsed:this._selectorArrows?WI.HierarchicalPathComponent.MinimumWidth+WI.HierarchicalPathComponent.SelectorArrowsWidth:WI.HierarchicalPathComponent.MinimumWidth}get forcedWidth(){let e=this._element.style.getProperty("width");return typeof e=="string"?parseInt(e):null}set forcedWidth(e){if(typeof e=="number"){let t=WI.HierarchicalPathComponent.MinimumWidthForOneCharacterTruncatedTitle;this.selectorArrows&&(t+=WI.HierarchicalPathComponent.SelectorArrowsWidth),e<t&&(e=0),this._element.style.setProperty("width",Math.max(1,e)+"px")}else this._element.style.removeProperty("width")}get hidden(){return this._hidden}set hidden(e){this._hidden!==e&&(this._hidden=e,this._element.classList.toggle("hidden",this._hidden))}get collapsed(){return this._collapsed}set collapsed(e){this._collapsed!==e&&(this._collapsed=e,this._element.classList.toggle("collapsed",this._collapsed))}get selectorArrows(){return this._selectorArrows}set selectorArrows(e){this._selectorArrows!==e&&(this._selectorArrows=e,this._selectorArrows?(this._selectorArrowsElement=WI.ImageUtilities.useSVGSymbol("data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 5 12'%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='square' d='M 0.5 3.5 L 2.5 1.5 L 4.5 3.5'/%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='square' d='M 0.5 8.5 L 2.5 10.5 L 4.5 8.5'/%3e %3c/svg%3e","selector-arrows"),this._element.insertBefore(this._selectorArrowsElement,this._separatorElement)):this._selectorArrowsElement&&(this._selectorArrowsElement.remove(),this._selectorArrowsElement=null),this._element.classList.toggle("show-selector-arrows",!!this._selectorArrows))}get tooltip(){return this._tooltip}set tooltip(e){e!==this._tooltip&&(this._tooltip=e,this._updateElementTitleAndText())}get hideTooltip(){return this._hideTooltip}set hideTooltip(e){this._hideTooltip=e,this._updateElementTitleAndText()}get previousSibling(){return this._previousSibling}set previousSibling(e){this._previousSibling=e||null}get nextSibling(){return this._nextSibling}set nextSibling(e){this._nextSibling=e||null}_updateElementTitleAndText(){let e=this._displayName;this._truncatedDisplayNameLength&&e.length>this._truncatedDisplayNameLength&&(e=e.substring(0,this._truncatedDisplayNameLength)+ellipsis),this._titleContentElement.textContent=e,this.hideTooltip?this._element.title="":this._element.title=this._tooltip}_updateSelectElement(){this._selectElement.removeChildren();function e(n){let s=document.createElement("option"),a=130;return s.textContent=n.displayName.length<=a?n.displayName:n.displayName.substring(0,a)+ellipsis,s._pathComponent=n,s}let t=0,i=this.previousSibling;for(;i;)this._selectElement.insertBefore(e(i),this._selectElement.firstChild),i=i.previousSibling,++t;for(this._selectElement.appendChild(e(this)),i=this.nextSibling;i;)this._selectElement.appendChild(e(i)),i=i.nextSibling;this._selectElement.selectedIndex=t}_selectElementMouseOver(e){typeof this.mouseOver=="function"&&this.mouseOver()}_selectElementMouseOut(e){typeof this.mouseOut=="function"&&this.mouseOut()}_selectElementMouseDown(e){this._updateSelectElement(),this._selectElement.options.length===1&&(e.preventDefault(),this._selectElementSelectionChanged())}_selectElementMouseUp(e){this.dispatchEventToListeners(WI.HierarchicalPathComponent.Event.Clicked,{pathComponent:this.selectedPathComponent})}_selectElementSelectionChanged(e){this.dispatchEventToListeners(WI.HierarchicalPathComponent.Event.SiblingWasSelected,{pathComponent:this.selectedPathComponent})}};WI.HierarchicalPathComponent.MinimumWidth=32;WI.HierarchicalPathComponent.MinimumWidthCollapsed=24;WI.HierarchicalPathComponent.MinimumWidthForOneCharacterTruncatedTitle=54;WI.HierarchicalPathComponent.SelectorArrowsWidth=12;WI.HierarchicalPathComponent.Event={SiblingWasSelected:"hierarchical-path-component-sibling-was-selected",Clicked:"hierarchical-path-component-clicked"};WI.NavigationItem=class extends WI.Object{constructor(e,t,i){super(),this._identifier=e||null,this._element=document.createElement("div"),this._hidden=!1,this._parentNavigationBar=null,this._visibilityPriority=WI.NavigationItem.VisibilityPriority.Normal,this._cachedWidth=NaN,t&&this._element.setAttribute("role",t),i&&this._element.setAttribute("aria-label",i),this._element.classList.add(...this._classNames),this._element.navigationItem=this}get identifier(){return this._identifier}get element(){return this._element}get minimumWidth(){return this.width}get parentNavigationBar(){return this._parentNavigationBar}get width(){return isNaN(this._cachedWidth)&&(this._cachedWidth=this._element.realOffsetWidth),this._cachedWidth}get visibilityPriority(){return this._visibilityPriority}set visibilityPriority(e){this._visibilityPriority=e}updateLayout(e){this._cachedWidth=NaN}get hidden(){return this._hidden}set hidden(e){this._hidden!==e&&(this._hidden=e,this._element.classList.toggle("hidden",e),this._parentNavigationBar&&this._parentNavigationBar.needsLayout())}get tooltip(){return this.element.title}set tooltip(e){this.element.title=e}didAttach(e){console.assert(e instanceof WI.NavigationBar),this._parentNavigationBar=e}didDetach(){this._cachedWidth=NaN,this._parentNavigationBar=null}get _classNames(){var e=["item"];return this._identifier&&e.push(this._identifier),this.additionalClassNames instanceof Array&&(e=e.concat(this.additionalClassNames)),e}};WI.NavigationItem.VisibilityPriority={Low:-100,Normal:0,High:100};WI.Popover=class extends WI.Object{constructor(e){super(),this.delegate=e,this._edge=null,this._frame=new WI.Rect,this._content=null,this._targetFrame=new WI.Rect,this._anchorPoint=new WI.Point,this._preferredEdges=null,this._resizeHandler=null,this._contentNeedsUpdate=!1,this._dismissing=!1,this._element=document.createElement("div"),this._element.className="popover",this._element.addEventListener("transitionend",this,!0),this._container=this._element.appendChild(document.createElement("div")),this._container.className="container",this._drawBackgroundAnimationIdentifier=void 0}get element(){return this._element}get visible(){return this._element.parentNode===document.body&&!this._element.classList.contains(WI.Popover.FadeOutClassName)}get frame(){return this._frame}set frame(e){this._element.style.left=e.minX()+"px",this._element.style.top=e.minY()+"px",this._element.style.width=e.size.width+"px",this._element.style.height=e.size.height+"px",this._element.style.backgroundSize=e.size.width+"px "+e.size.height+"px",this._frame=e}set content(e){e!==this._content&&(this._content=e,this._contentNeedsUpdate=!0,this.visible&&this._update(!0))}set windowResizeHandler(e){console.assert(typeof e=="function"),this._resizeHandler=e}resize(){this.visible&&this._resizeHandler&&this._resizeHandler()}update(e=!0){if(!!this.visible){var t=document.activeElement;this._contentNeedsUpdate=!0,this._update(e),t&&t.focus()}}present(e,t){this._targetFrame=e,this._preferredEdges=t,this._content&&(this._addListenersIfNeeded(),this._update())}presentNewContentWithFrame(e,t,i){this._content=e,this._contentNeedsUpdate=!0,this._targetFrame=t,this._preferredEdges=i,this._addListenersIfNeeded();var n=this.visible;this._update(n)}dismiss(){this._dismissing||this._element.parentNode!==document.body||(this._dismissing=!0,console.assert(this._isListeningForPopoverEvents),this._isListeningForPopoverEvents=!1,window.removeEventListener("mousedown",this,!0),window.removeEventListener("scroll",this,!0),window.removeEventListener("resize",this,!0),window.removeEventListener("keypress",this,!0),this._prefersDarkColorSchemeMediaQueryList.removeListener(this._boundUpdate),WI.quickConsole.keyboardShortcutDisabled=!1,this._element.classList.add(WI.Popover.FadeOutClassName),this.delegate&&typeof this.delegate.willDismissPopover=="function"&&this.delegate.willDismissPopover(this))}handleEvent(e){switch(e.type){case"mousedown":case"scroll":!this._element.contains(e.target)&&!e.target.closest("."+WI.Popover.IgnoreAutoDismissClassName)&&!e[WI.Popover.EventPreventDismissSymbol]&&this.dismiss();break;case"resize":this.resize();break;case"keypress":e.keyCode===WI.KeyboardShortcut.Key.Escape.keyCode&&this.dismiss();break;case"transitionend":if(e.target===this._element){document.body.removeChild(this._element),this._element.classList.remove(WI.Popover.FadeOutClassName),this._container.textContent="",this.delegate&&typeof this.delegate.didDismissPopover=="function"&&this.delegate.didDismissPopover(this),this._dismissing=!1;break}break}}_update(e){if(e)var t=this._edge;var i=this._targetFrame,n=this._preferredEdges;if(this._element.parentNode!==document.body?document.body.appendChild(this._element):this._element.classList.remove(WI.Popover.FadeOutClassName),this._dismissing=!1,this._edge!==null&&this._element.classList.remove(this._cssClassNameForEdge()),this._contentNeedsUpdate){this._element.style.removeProperty("left"),this._element.style.removeProperty("top"),this._element.style.removeProperty("width"),this._element.style.removeProperty("height"),this._container.replaceWith(this._content);var s=this._element.getBoundingClientRect();this._preferredSize=new WI.Size(Math.ceil(s.width),Math.ceil(s.height))}var a=WI.Platform.name==="mac"?22:0,d=new WI.Rect(0,a,window.innerWidth,window.innerHeight-a);d=d.inset(WI.Popover.ShadowEdgeInsets);var p=new Array(n.length);for(var f in WI.RectEdge){var _=WI.RectEdge[f],b={edge:_,metrics:this._bestMetricsForEdge(this._preferredSize,i,d,_)},w=n.indexOf(_);w!==-1?p[w]=b:p.push(b)}function S(H){return Math.max(0,H.width)*Math.max(0,H.height)}for(var E=p[0].edge,k=p[0].metrics,R=1;R<p.length;R++){var M=p[R].metrics;S(M.contentSize)>S(k.contentSize)&&(E=p[R].edge,k=M)}console.assert(S(k.contentSize)>0);var L,V=k.frame.round();if(this._edge=E,V===WI.Rect.ZERO_RECT)this.dismiss();else{switch(E){case WI.RectEdge.MIN_X:L=new WI.Point(V.size.width-WI.Popover.ShadowPadding,i.midY()-V.minY());break;case WI.RectEdge.MAX_X:L=new WI.Point(WI.Popover.ShadowPadding,i.midY()-V.minY());break;case WI.RectEdge.MIN_Y:L=new WI.Point(i.midX()-V.minX(),V.size.height-WI.Popover.ShadowPadding);break;case WI.RectEdge.MAX_Y:L=new WI.Point(i.midX()-V.minX(),WI.Popover.ShadowPadding);break}this._element.classList.add(this._cssClassNameForEdge()),e&&this._edge===t?this._animateFrame(V,L):(this.frame=V,this._setAnchorPoint(L),this._drawBackground()),this._preferredSize.width<WI.Popover.MinWidth||this._preferredSize.height<WI.Popover.MinHeight?this._container.classList.add("center"):this._container.classList.remove("center")}this._contentNeedsUpdate&&(this._container.textContent="",this._content.replaceWith(this._container),this._container.appendChild(this._content)),this._contentNeedsUpdate=!1}_cssClassNameForEdge(){switch(this._edge){case WI.RectEdge.MIN_X:return"arrow-right";case WI.RectEdge.MAX_X:return"arrow-left";case WI.RectEdge.MIN_Y:return"arrow-down";case WI.RectEdge.MAX_Y:return"arrow-up"}return console.error("Unknown edge."),"arrow-up"}_setAnchorPoint(e){e.x=Math.floor(e.x),e.y=Math.floor(e.y),this._anchorPoint=e}_animateFrame(e,t){var i=Date.now(),n=350,s=1/(200*n),a=new WI.CubicBezier(.25,.1,.25,1),d=this._frame.copy(),p=this._anchorPoint.copy();function f(b,w,S){return b+(w-b)*S}function _(){var b=a.solve(Math.min((Date.now()-i)/n,1),s);this.frame=new WI.Rect(f(d.minX(),e.minX(),b),f(d.minY(),e.minY(),b),f(d.size.width,e.size.width,b),f(d.size.height,e.size.height,b)).round(),this._setAnchorPoint(new WI.Point(f(p.x,t.x,b),f(p.y,t.y,b))),this._drawBackground(),b<1&&(this._drawBackgroundAnimationIdentifier=requestAnimationFrame(_.bind(this)))}_.call(this)}_drawBackground(){this._drawBackgroundAnimationIdentifier&&(cancelAnimationFrame(this._drawBackgroundAnimationIdentifier),this._drawBackgroundAnimationIdentifier=void 0);let e=window.devicePixelRatio,t=this._frame.size.width,i=this._frame.size.height,n=t*e,s=i*e,a;switch(this._edge){case WI.RectEdge.MIN_X:a=new WI.Rect(0,0,t-WI.Popover.AnchorSize,i);break;case WI.RectEdge.MAX_X:a=new WI.Rect(WI.Popover.AnchorSize,0,t-WI.Popover.AnchorSize,i);break;case WI.RectEdge.MIN_Y:a=new WI.Rect(0,0,t,i-WI.Popover.AnchorSize);break;case WI.RectEdge.MAX_Y:a=new WI.Rect(0,WI.Popover.AnchorSize,t,i-WI.Popover.AnchorSize);break}a=a.inset(WI.Popover.ShadowEdgeInsets);let d=window.getComputedStyle(this._element,null),p=document.getCSSCanvasContext("2d","popover",n,s);p.clearRect(0,0,n,s);function f(_){p.save(),_(),p.restore()}f(()=>{p.scale(e,e),this._drawFrame(p,a,this._edge,this._anchorPoint),f(()=>{p.shadowBlur=4,p.shadowColor=d.getPropertyValue("--popover-shadow-color").trim(),p.strokeStyle=d.getPropertyValue("--popover-border-color").trim(),p.lineWidth=2,p.stroke()}),f(()=>{p.fillStyle=d.getPropertyValue("--popover-background-color").trim(),p.fill()})})}_bestMetricsForEdge(e,t,i,n){var s,a,d=e.width+WI.Popover.ShadowPadding*2+WI.Popover.ContentPadding*2,p=e.height+WI.Popover.ShadowPadding*2+WI.Popover.ContentPadding*2;switch(n){case WI.RectEdge.MIN_X:d+=WI.Popover.AnchorSize,s=t.origin.x-d+WI.Popover.ShadowPadding,a=t.origin.y-(p-t.size.height)/2;break;case WI.RectEdge.MAX_X:d+=WI.Popover.AnchorSize,s=t.origin.x+t.size.width-WI.Popover.ShadowPadding,a=t.origin.y-(p-t.size.height)/2;break;case WI.RectEdge.MIN_Y:p+=WI.Popover.AnchorSize,s=t.origin.x-(d-t.size.width)/2,a=t.origin.y-p+WI.Popover.ShadowPadding;break;case WI.RectEdge.MAX_Y:p+=WI.Popover.AnchorSize,s=t.origin.x-(d-t.size.width)/2,a=t.origin.y+t.size.height-WI.Popover.ShadowPadding;break}n!==WI.RectEdge.MIN_X&&s<i.minX()&&(s=i.minX()),n!==WI.RectEdge.MAX_X&&s+d>i.maxX()&&(s=i.maxX()-d),n!==WI.RectEdge.MIN_Y&&a<i.minY()&&(a=i.minY()),n!==WI.RectEdge.MAX_Y&&a+p>i.maxY()&&(a=i.maxY()-p);var f=new WI.Rect(s,a,d,p),_=f.intersectionWithRect(i);switch(d=_.size.width-WI.Popover.ShadowPadding*2,p=_.size.height-WI.Popover.ShadowPadding*2,n){case WI.RectEdge.MIN_X:case WI.RectEdge.MAX_X:d-=WI.Popover.AnchorSize;break;case WI.RectEdge.MIN_Y:case WI.RectEdge.MAX_Y:p-=WI.Popover.AnchorSize;break}return{frame:_,contentSize:new WI.Size(d,p)}}_drawFrame(e,t,i){let n=WI.Popover.CornerRadius,s=this._anchorPoint,a=n+WI.Popover.AnchorSize;switch(i===WI.RectEdge.MIN_Y||i===WI.RectEdge.MAX_Y?s.x=Number.constrain(s.x,t.minX()+a,t.maxX()-a):s.y=Number.constrain(s.y,t.minY()+a,t.maxY()-a),e.beginPath(),i){case WI.RectEdge.MIN_X:e.moveTo(t.maxX(),t.minY()+n),e.lineTo(t.maxX(),s.y-WI.Popover.AnchorSize),e.lineTo(s.x,s.y),e.lineTo(t.maxX(),s.y+WI.Popover.AnchorSize),e.arcTo(t.maxX(),t.maxY(),t.minX(),t.maxY(),n),e.arcTo(t.minX(),t.maxY(),t.minX(),t.minY(),n),e.arcTo(t.minX(),t.minY(),t.maxX(),t.minY(),n),e.arcTo(t.maxX(),t.minY(),t.maxX(),t.maxY(),n);break;case WI.RectEdge.MAX_X:e.moveTo(t.minX(),t.maxY()-n),e.lineTo(t.minX(),s.y+WI.Popover.AnchorSize),e.lineTo(s.x,s.y),e.lineTo(t.minX(),s.y-WI.Popover.AnchorSize),e.arcTo(t.minX(),t.minY(),t.maxX(),t.minY(),n),e.arcTo(t.maxX(),t.minY(),t.maxX(),t.maxY(),n),e.arcTo(t.maxX(),t.maxY(),t.minX(),t.maxY(),n),e.arcTo(t.minX(),t.maxY(),t.minX(),t.minY(),n);break;case WI.RectEdge.MIN_Y:e.moveTo(t.maxX()-n,t.maxY()),e.lineTo(s.x+WI.Popover.AnchorSize,t.maxY()),e.lineTo(s.x,s.y),e.lineTo(s.x-WI.Popover.AnchorSize,t.maxY()),e.arcTo(t.minX(),t.maxY(),t.minX(),t.minY(),n),e.arcTo(t.minX(),t.minY(),t.maxX(),t.minY(),n),e.arcTo(t.maxX(),t.minY(),t.maxX(),t.maxY(),n),e.arcTo(t.maxX(),t.maxY(),t.minX(),t.maxY(),n);break;case WI.RectEdge.MAX_Y:e.moveTo(t.minX()+n,t.minY()),e.lineTo(s.x-WI.Popover.AnchorSize,t.minY()),e.lineTo(s.x,s.y),e.lineTo(s.x+WI.Popover.AnchorSize,t.minY()),e.arcTo(t.maxX(),t.minY(),t.maxX(),t.maxY(),n),e.arcTo(t.maxX(),t.maxY(),t.minX(),t.maxY(),n),e.arcTo(t.minX(),t.maxY(),t.minX(),t.minY(),n),e.arcTo(t.minX(),t.minY(),t.maxX(),t.minY(),n);break}e.closePath()}_addListenersIfNeeded(){this._isListeningForPopoverEvents||(this._isListeningForPopoverEvents=!0,window.addEventListener("mousedown",this,!0),window.addEventListener("scroll",this,!0),window.addEventListener("resize",this,!0),window.addEventListener("keypress",this,!0),this._boundUpdate||(this._boundUpdate=this._update.bind(this)),this._prefersDarkColorSchemeMediaQueryList||(this._prefersDarkColorSchemeMediaQueryList=window.matchMedia("(prefers-color-scheme: dark)")),this._prefersDarkColorSchemeMediaQueryList.addListener(this._boundUpdate),WI.quickConsole.keyboardShortcutDisabled=!0)}};WI.Popover.FadeOutClassName="fade-out";WI.Popover.CornerRadius=5;WI.Popover.MinWidth=40;WI.Popover.MinHeight=40;WI.Popover.ShadowPadding=5;WI.Popover.ContentPadding=5;WI.Popover.AnchorSize=11;WI.Popover.ShadowEdgeInsets=new WI.EdgeInsets(WI.Popover.ShadowPadding);WI.Popover.IgnoreAutoDismissClassName="popover-ignore-auto-dismiss";WI.Popover.EventPreventDismissSymbol=Symbol("popover-event-prevent-dismiss");WI.SidebarPanel=class extends WI.View{constructor(e,t){super(),this._identifier=e,this._displayName=t,this._selected=!1,this._savedScrollPosition=0,this.element.classList.add("panel",e),this.element.setAttribute("role","group"),this.element.setAttribute("aria-label",t),this._contentView=new WI.View,this._contentView.element.classList.add("content"),this.addSubview(this._contentView)}get identifier(){return this._identifier}get contentView(){return this._contentView}get displayName(){return this._displayName}get visible(){return this.selected&&this.parentSidebar&&!this.parentSidebar.collapsed}get selected(){return this._selected}set selected(e){e!==this._selected&&(this._selected=e||!1,this.element.classList.toggle("selected",this._selected))}get parentSidebar(){return this.parentView}get minimumWidth(){return 0}shown(){this.scrollElement.scrollTop=this._savedScrollPosition,this.updateLayoutIfNeeded()}hidden(){this._savedScrollPosition=this.scrollElement.scrollTop}visibilityDidChange(){}get scrollElement(){return this.contentView.element}};WI.TabBar=class extends WI.View{constructor(e,t){if(super(e),this.element.classList.add("tab-bar"),this.element.setAttribute("role","tablist"),this.element.addEventListener("mousedown",this._handleMouseDown.bind(this)),this.element.addEventListener("click",this._handleClick.bind(this)),this.element.addEventListener("mouseleave",this._handleMouseLeave.bind(this)),this.element.addEventListener("contextmenu",this._handleContextMenu.bind(this)),this.element.createChild("div","top-border"),this._tabBarItems=[],this._hiddenTabBarItems=[],t)for(let i in t)this.addTabBarItem(i);this._tabPickerTabBarItem=new WI.PinnedTabBarItem("data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2018 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 16'%3e %3cpath fill='none' stroke='currentColor' d='M 2 4 L 6 8 L 2 12'/%3e %3cpath fill='none' stroke='currentColor' d='M 7 4 L 11 8 L 7 12'/%3e %3c/svg%3e",WI.UIString("Show hidden tabs")),this._tabPickerTabBarItem.element.classList.add("tab-picker","hidden"),this._tabPickerTabBarItem.element.addEventListener("contextmenu",this._handleTabPickerTabContextMenu.bind(this)),this.addTabBarItem(this._tabPickerTabBarItem,{suppressAnimations:!0})}addTabBarItem(e,t={}){return this.insertTabBarItem(e,this._tabBarItems.length,t)}insertTabBarItem(e,t,i={}){if(console.assert(e instanceof WI.TabBarItem),!(e instanceof WI.TabBarItem)||e.parentTabBar===this)return null;if(this._tabAnimatedClosedSinceMouseEnter)return this._finishExpandingTabsAfterClose().then(()=>{this.insertTabBarItem(e,t,i)}),null;e.parentTabBar&&e.parentTabBar.removeTabBarItem(e),e.parentTabBar=this,e instanceof WI.GeneralTabBarItem?t=Number.constrain(t,0,this.normalTabCount):t=Number.constrain(t,this.normalTabCount,this._tabBarItems.length),this.element.classList.contains("animating")&&(requestAnimationFrame(p.bind(this)),i.suppressAnimations=!0);var n;i.suppressAnimations||(n=this._recordTabBarItemSizesAndPositions()),this._tabBarItems.splice(t,0,e);var s=this._tabBarItems[t+1];let a=s?s.element:this._tabBarItems.lastValue.element;this.element.contains(a)?this.element.insertBefore(e.element,a):this.element.appendChild(e.element),this.element.classList.toggle("single-tab",!this._hasMoreThanOneNormalTab()),e.element.style.left=null,e.element.style.width=null;function d(){this.element.classList.add("animating"),this.element.classList.add("inserting-tab"),this._applyTabBarItemSizesAndPositions(f),this.element.addEventListener("webkitTransitionEnd",_)}function p(){this.element.classList.remove("static-layout"),this.element.classList.remove("animating"),this.element.classList.remove("inserting-tab"),e.element.classList.remove("being-inserted"),this._clearTabBarItemSizesAndPositions(),this.element.removeEventListener("webkitTransitionEnd",_)}if(i.suppressAnimations)this.needsLayout();else{var f=this._recordTabBarItemSizesAndPositions();this.updateLayout();let b=this._tabBarItemsFromLeftToRight(),w=b[b.indexOf(e)-1]||null,S=w?n.get(w):null;S?n.set(e,{left:S.left+S.width,width:0}):n.set(e,{left:0,width:0}),this.element.classList.add("static-layout"),e.element.classList.add("being-inserted"),this._applyTabBarItemSizesAndPositions(n);var _=p.bind(this);requestAnimationFrame(d.bind(this))}return this.dispatchEventToListeners(WI.TabBar.Event.TabBarItemAdded,{tabBarItem:e}),e}removeTabBarItem(e,t={}){let i=this._findTabBarItem(e);if(!i||i instanceof WI.PinnedTabBarItem||!i.isEphemeral&&this.normalTabCount===1)return null;if(i.parentTabBar=null,this._selectedTabBarItem===i){var n=this._tabBarItems.indexOf(i),s=this._tabBarItems[n+1];(!s||s instanceof WI.PinnedTabBarItem)&&(s=this._tabBarItems[n-1]),this.selectedTabBarItem=s}this.element.classList.contains("animating")&&(requestAnimationFrame(b.bind(this)),t.suppressAnimations=!0);var a;t.suppressAnimations||(a=this._recordTabBarItemSizesAndPositions());let d=this._tabBarItems.indexOf(i)===this.normalTabCount-1;this._tabBarItems.remove(i),i.element.remove();var p=this._hasMoreThanOneNormalTab();if(this.element.classList.toggle("single-tab",!p),!p||d||!t.suppressExpansion)return t.suppressAnimations?this.needsLayout():(this._tabAnimatedClosedSinceMouseEnter=!0,this._finishExpandingTabsAfterClose(a)),this.dispatchEventToListeners(WI.TabBar.Event.TabBarItemRemoved,{tabBarItem:i}),i;var f;function _(){this.element.classList.add("animating"),this.element.classList.add("closing-tab");let S=0;if(WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL){S=this.element.getBoundingClientRect().width;for(let k of this._tabBarItemsFromLeftToRight())S-=k.element.getBoundingClientRect().width}let E=0;for(let k of this._tabBarItemsFromLeftToRight()){let R=a.get(k);k instanceof WI.PinnedTabBarItem?E=R.left+R.width:(k.element.style.left=S+E+"px",E+=R.width,f=k)}this._selectedTabBarItem&&(this._selectedTabBarItem.element.style.width=parseFloat(this._selectedTabBarItem.element.style.width)+1+"px"),f!==this._selectedTabBarItem&&(f.element.style.width=parseFloat(f.element.style.width)+1+"px"),this.element.addEventListener("webkitTransitionEnd",w)}function b(){this._selectedTabBarItem&&this._selectedTabBarItem!==f&&(this._selectedTabBarItem.element.style.width=parseFloat(this._selectedTabBarItem.element.style.width)-1+"px"),this.element.classList.remove("animating"),this.element.classList.remove("closing-tab"),this.updateLayout(),this.element.removeEventListener("webkitTransitionEnd",w)}if(t.suppressAnimations)this.needsLayout();else{this.element.classList.add("static-layout"),this._tabAnimatedClosedSinceMouseEnter=!0,this._applyTabBarItemSizesAndPositions(a);var w=b.bind(this);requestAnimationFrame(_.bind(this))}return this.dispatchEventToListeners(WI.TabBar.Event.TabBarItemRemoved,{tabBarItem:i}),i}selectPreviousTab(){if(!(this._tabBarItems.length<=1)){var e=this._tabBarItems.indexOf(this._selectedTabBarItem),t=e;do if(t===0?t=this._tabBarItems.length-1:t--,!(this._tabBarItems[t]instanceof WI.PinnedTabBarItem))break;while(t!==e);t!==e&&(this.selectedTabBarItem=this._tabBarItems[t])}}selectNextTab(){if(!(this._tabBarItems.length<=1)){var e=this._tabBarItems.indexOf(this._selectedTabBarItem),t=e;do if(t===this._tabBarItems.length-1?t=0:t++,!(this._tabBarItems[t]instanceof WI.PinnedTabBarItem))break;while(t!==e);t!==e&&(this.selectedTabBarItem=this._tabBarItems[t])}}get selectedTabBarItem(){return this._selectedTabBarItem}set selectedTabBarItem(e){let t=this._findTabBarItem(e);t===this._tabPickerTabBarItem&&(t=this._tabBarItems[this.normalTabCount-1]),this._selectedTabBarItem!==t&&(this._selectedTabBarItem&&(this._selectedTabBarItem.selected=!1),this._selectedTabBarItem=t||null,this._selectedTabBarItem&&(this._selectedTabBarItem.selected=!0,this._selectedTabBarItem.element.classList.contains("hidden")&&this.needsLayout()),this.dispatchEventToListeners(WI.TabBar.Event.TabBarItemSelected))}get tabBarItems(){return this._tabBarItems}get normalTabCount(){return this._tabBarItems.filter(e=>!(e instanceof WI.PinnedTabBarItem)).length}get saveableTabCount(){return this._tabBarItems.filter(e=>e.representedObject&&e.representedObject.constructor.shouldSaveTab()).length}layout(){if(this.element.classList.contains("static-layout"))return;this.element.classList.add("calculate-width"),this.element.classList.remove("collapsed");function e(a,d){a.element.classList.toggle("hidden",!!d)}for(let a of this._tabBarItems)e(a,a===this._tabPickerTabBarItem);function t(a){return a[WI.TabBar.CachedWidthSymbol]||(a[WI.TabBar.CachedWidthSymbol]=a.element.realOffsetWidth),a[WI.TabBar.CachedWidthSymbol]}let i=()=>this._tabBarItems.reduce((a,d)=>(d[WI.TabBar.CachedWidthSymbol]=void 0,a+t(d)),0);this._hiddenTabBarItems=[];let n=i(),s=this.element.realOffsetWidth;if(n>s){this.element.classList.add("collapsed"),n=i(),n>s&&(e(this._tabPickerTabBarItem,!1),n+=t(this._tabPickerTabBarItem));let a=this._tabBarItemsFromLeftToRight(),d=a.length;for(;n>s&&--d>=0;){let p=a[d];p===this.selectedTabBarItem||p instanceof WI.PinnedTabBarItem||(n-=t(p),e(p,!0),this._hiddenTabBarItems.push(p))}}this.element.classList.remove("calculate-width")}_tabBarItemsFromLeftToRight(){return WI.resolvedLayoutDirection()===WI.LayoutDirection.LTR?this._tabBarItems:this._tabBarItems.slice().reverse()}_findTabBarItem(e){return typeof e=="number"?this._tabBarItems[e]||null:e instanceof WI.TabBarItem&&this._tabBarItems.includes(e)?e:null}_hasMoreThanOneNormalTab(){let e=0;for(let t of this._tabBarItems)if(!(t instanceof WI.PinnedTabBarItem)&&(++e,e>=2))return!0;return!1}_recordTabBarItemSizesAndPositions(){var e=new Map;const t=this.element.getBoundingClientRect();for(var i of this._tabBarItems){var n=i.element.getBoundingClientRect();e.set(i,{left:n.left-t.left,width:n.width})}return e}_applyTabBarItemSizesAndPositions(e,t){for(var[i,n]of e)t&&i===t||(i.element.style.left=n.left+"px",i.element.style.width=n.width+"px")}_clearTabBarItemSizesAndPositions(e){for(var t of this._tabBarItems)e&&t===e||(t.element.style.left=null,t.element.style.width=null)}_finishExpandingTabsAfterClose(e){return new Promise(function(t,i){console.assert(this._tabAnimatedClosedSinceMouseEnter),this._tabAnimatedClosedSinceMouseEnter=!1,e||(e=this._recordTabBarItemSizesAndPositions()),this.element.classList.remove("static-layout"),this._clearTabBarItemSizesAndPositions();var n=this._recordTabBarItemSizesAndPositions();this._applyTabBarItemSizesAndPositions(e),this.element.classList.add("static-layout");function s(){this.element.classList.add("static-layout"),this.element.classList.add("animating"),this.element.classList.add("expanding-tabs"),this._applyTabBarItemSizesAndPositions(n),this.element.addEventListener("webkitTransitionEnd",d)}function a(){this.element.classList.remove("static-layout"),this.element.classList.remove("animating"),this.element.classList.remove("expanding-tabs"),this._clearTabBarItemSizesAndPositions(),this.updateLayout(),this.element.removeEventListener("webkitTransitionEnd",d),t()}var d=a.bind(this);requestAnimationFrame(s.bind(this))}.bind(this))}_handleMouseDown(e){if(e.button!==0||e.ctrlKey)return;let t=e.target.closest("."+WI.TabBarItem.StyleClassName);if(!t)return;let i=t[WI.TabBarItem.ElementReferenceSymbol];if(!i||i.disabled)return;if(i===this._tabPickerTabBarItem){if(!this._hiddenTabBarItems.length||this._ignoreTabPickerMouseDown)return;this._ignoreTabPickerMouseDown=!0;let s=WI.ContextMenu.createFromEvent(e);s.addBeforeShowCallback(()=>{this._ignoreTabPickerMouseDown=!1});for(let a of this._hiddenTabBarItems)s.appendItem(a.title,()=>{this.selectedTabBarItem=a});s.show();return}if(!e.target.closest("."+WI.TabBarItem.CloseButtonStyleClassName)&&(this.selectedTabBarItem=i,!(i instanceof WI.PinnedTabBarItem||!this._hasMoreThanOneNormalTab()))){this._firstNormalTabItemIndex=0;for(let s=0;s<this._tabBarItems.length;++s)if(!(this._tabBarItems[s]instanceof WI.PinnedTabBarItem)){this._firstNormalTabItemIndex=s;break}this._mouseIsDown=!0,this._mouseMovedEventListener=this._handleMouseMoved.bind(this),this._mouseUpEventListener=this._handleMouseUp.bind(this),document.addEventListener("mousemove",this._mouseMovedEventListener,!0),document.addEventListener("mouseup",this._mouseUpEventListener,!0),e.preventDefault(),e.stopPropagation()}}_handleClick(e){var t=e.target.closest("."+WI.TabBarItem.StyleClassName);if(!t)return;var i=t[WI.TabBarItem.ElementReferenceSymbol];if(!i||i.disabled)return;const n=e.button===1;var s=e.target.closest("."+WI.TabBarItem.CloseButtonStyleClassName);if(s||n){if(this.element.classList.contains("single-tab"))return;if(!e.altKey){this.removeTabBarItem(i,{suppressExpansion:!0});return}for(let a=this._tabBarItems.length-1;a>=0;--a){let d=this._tabBarItems[a];d===i||d instanceof WI.PinnedTabBarItem||this.removeTabBarItem(d)}}}_handleMouseMoved(e){if(console.assert(e.button===0),console.assert(this._mouseIsDown),!this._mouseIsDown||(console.assert(this._selectedTabBarItem),!this._selectedTabBarItem))return;e.preventDefault(),e.stopPropagation(),this.element.classList.contains("static-layout")||(this._applyTabBarItemSizesAndPositions(this._recordTabBarItemSizesAndPositions()),this.element.classList.add("static-layout"),this.element.classList.add("dragging-tab")),this._mouseOffset===void 0&&(this._mouseOffset=e.pageX-this._selectedTabBarItem.element.totalOffsetLeft);var t=e.pageX-this.element.totalOffsetLeft,i=t-this._mouseOffset;this._selectedTabBarItem.element.style.left=i+"px";var n=i+this._selectedTabBarItem.element.realOffsetWidth/2,s=this._tabBarItems.indexOf(this._selectedTabBarItem),a=s;for(let b of this._tabBarItems)if(b!==this._selectedTabBarItem){var d=b.element.getBoundingClientRect();if(!(n<d.left||n>d.right)){a=this._tabBarItems.indexOf(b);break}}if(a=Number.constrain(a,this._firstNormalTabItemIndex,this.normalTabCount-1),s===a)return;this._tabBarItems.splice(s,1),this._tabBarItems.splice(a,0,this._selectedTabBarItem);let p=this._tabBarItems[a+1],f=p?p.element:null;this.element.insertBefore(this._selectedTabBarItem.element,f);let _=0;for(let b of this._tabBarItemsFromLeftToRight())b!==this._selectedTabBarItem&&parseFloat(b.element.style.left)!==_&&(b.element.style.left=_+"px"),_+=parseFloat(b.element.style.width)}_handleMouseUp(e){if(console.assert(e.button===0),console.assert(this._mouseIsDown),!!this._mouseIsDown){if(this.element.classList.remove("dragging-tab"),!this._tabAnimatedClosedSinceMouseEnter)this.element.classList.remove("static-layout"),this._clearTabBarItemSizesAndPositions();else{let t=0;for(let i of this._tabBarItemsFromLeftToRight())i===this._selectedTabBarItem&&(i.element.style.left=t+"px"),t+=parseFloat(i.element.style.width)}this._mouseIsDown=!1,this._mouseOffset=void 0,document.removeEventListener("mousemove",this._mouseMovedEventListener,!0),document.removeEventListener("mouseup",this._mouseUpEventListener,!0),this._mouseMovedEventListener=null,this._mouseUpEventListener=null,e.preventDefault(),e.stopPropagation(),this.dispatchEventToListeners(WI.TabBar.Event.TabBarItemsReordered)}}_handleMouseLeave(e){if(this._mouseIsDown||!this._tabAnimatedClosedSinceMouseEnter||!this.element.classList.contains("static-layout")||this.element.classList.contains("animating"))return;const t=this.element.getBoundingClientRect();e.pageY>t.top&&e.pageY<t.bottom&&e.pageX>t.left&&e.pageX<t.right||this._finishExpandingTabsAfterClose()}_handleContextMenu(e){let t=WI.ContextMenu.createFromEvent(e);for(let i of WI.knownTabClasses()){if(!i.isTabAllowed()||i.tabInfo().isEphemeral)continue;let n=null;for(let d of this._tabBarItems){let p=d.representedObject;if(p instanceof WI.TabContentView&&p.type===i.Type){n=d;break}}let s=!!n,a=s&&this.normalTabCount===1;t.appendCheckboxItem(i.tabInfo().title,()=>{n?this.removeTabBarItem(n):WI.createNewTabWithType(i.Type,{shouldShowNewTab:!0})},s,a)}}_handleTabPickerTabContextMenu(e){if(!this._hiddenTabBarItems.length)return;let t=WI.ContextMenu.createFromEvent(e);for(let i of this._hiddenTabBarItems)t.appendItem(i.title,()=>{this.selectedTabBarItem=i})}};WI.TabBar.CachedWidthSymbol=Symbol("cached-width");WI.TabBar.Event={TabBarItemSelected:"tab-bar-tab-bar-item-selected",TabBarItemAdded:"tab-bar-tab-bar-item-added",TabBarItemRemoved:"tab-bar-tab-bar-item-removed",TabBarItemsReordered:"tab-bar-tab-bar-items-reordered",OpenDefaultTab:"tab-bar-open-default-tab"};WI.TabBarItem=class extends WI.Object{constructor(e,t,i){super(),this._parentTabBar=null,this._element=document.createElement("div"),this._element.classList.add(WI.TabBarItem.StyleClassName),this._element.setAttribute("role","tab"),this._element.tabIndex=0,this._element[WI.TabBarItem.ElementReferenceSymbol]=this,this._element.createChild("div","flex-space"),this._iconElement=document.createElement("img"),this._iconElement.classList.add("icon"),this._element.appendChild(this._iconElement),this._element.createChild("div","flex-space"),this.title=t,this.image=e,this.representedObject=i}get element(){return this._element}get representedObject(){return this._representedObject}set representedObject(e){this._representedObject=e||null}get parentTabBar(){return this._parentTabBar}set parentTabBar(e){this._parentTabBar=e||null}get selected(){return this._element.classList.contains("selected")}set selected(e){this._element.classList.toggle("selected",e),e?this._element.setAttribute("aria-selected","true"):this._element.removeAttribute("aria-selected")}get disabled(){return this._element.classList.contains("disabled")}set disabled(e){this._element.classList.toggle("disabled",e)}get isDefaultTab(){return this._element.classList.contains("default-tab")}set isDefaultTab(e){this._element.classList.toggle("default-tab",e)}get image(){return this._iconElement.src}set image(e){this._iconElement.src=e||""}get title(){return this._title}set title(e){e=e||"",this._title!==e&&(this._title=e,this.titleDidChange())}titleDidChange(){}};WI.TabBarItem.StyleClassName="item";WI.TabBarItem.CloseButtonStyleClassName="close";WI.TabBarItem.ElementReferenceSymbol=Symbol("tab-bar-item");WI.TabBrowser=class extends WI.View{constructor(e,t,i,n){console.assert(t,"Must provide a TabBar."),super(e),this.element.classList.add("tab-browser"),this._tabBar=t,this._navigationSidebar=i||null,this._detailsSidebar=n||null,this._navigationSidebar&&(this._navigationSidebar.addEventListener(WI.Sidebar.Event.CollapsedStateDidChange,this._sidebarCollapsedStateDidChange,this),this._navigationSidebar.addEventListener(WI.Sidebar.Event.WidthDidChange,this._sidebarWidthDidChange,this)),this._detailsSidebar&&(this._detailsSidebar.addEventListener(WI.Sidebar.Event.CollapsedStateDidChange,this._sidebarCollapsedStateDidChange,this),this._detailsSidebar.addEventListener(WI.Sidebar.Event.SidebarPanelSelected,this._sidebarPanelSelected,this),this._detailsSidebar.addEventListener(WI.Sidebar.Event.WidthDidChange,this._sidebarWidthDidChange,this)),this._contentViewContainer=new WI.ContentViewContainer,this.addSubview(this._contentViewContainer);let s=()=>{this._showNextTab()},a=()=>{this._showPreviousTab()},d=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL,p=d?WI.KeyboardShortcut.Key.LeftCurlyBrace:WI.KeyboardShortcut.Key.RightCurlyBrace,f=d?WI.KeyboardShortcut.Key.RightCurlyBrace:WI.KeyboardShortcut.Key.LeftCurlyBrace;this._showNextTabKeyboardShortcut1=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl|WI.KeyboardShortcut.Modifier.Shift,p,s),this._showPreviousTabKeyboardShortcut1=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl|WI.KeyboardShortcut.Modifier.Shift,f,a);let _=d?WI.KeyboardShortcut.Modifier.Shift:0,b=d?0:WI.KeyboardShortcut.Modifier.Shift;this._showNextTabKeyboardShortcut2=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.Control|_,WI.KeyboardShortcut.Key.Tab,s),this._showPreviousTabKeyboardShortcut2=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.Control|b,WI.KeyboardShortcut.Key.Tab,a);let w=d?WI.KeyboardShortcut.Key.Right:WI.KeyboardShortcut.Key.Left,S=d?WI.KeyboardShortcut.Key.Left:WI.KeyboardShortcut.Key.Right;this._previousTabKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl|WI.KeyboardShortcut.Modifier.Shift,w,this._showPreviousTabCheckingForEditableField.bind(this)),this._previousTabKeyboardShortcut.implicitlyPreventsDefault=!1,this._nextTabKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl|WI.KeyboardShortcut.Modifier.Shift,S,this._showNextTabCheckingForEditableField.bind(this)),this._nextTabKeyboardShortcut.implicitlyPreventsDefault=!1,this._tabBar.addEventListener(WI.TabBar.Event.TabBarItemSelected,this._tabBarItemSelected,this),this._tabBar.addEventListener(WI.TabBar.Event.TabBarItemAdded,this._tabBarItemAdded,this),this._tabBar.addEventListener(WI.TabBar.Event.TabBarItemRemoved,this._tabBarItemRemoved,this),this._recentTabContentViews=[],this._closedTabClasses=new Set}get tabBar(){return this._tabBar}get navigationSidebar(){return this._navigationSidebar}get detailsSidebar(){return this._detailsSidebar}get selectedTabContentView(){return this._contentViewContainer.currentContentView}bestTabContentViewForClass(e){console.assert(!this.selectedTabContentView||this.selectedTabContentView===this._recentTabContentViews[0]);for(var t of this._recentTabContentViews)if(t instanceof e)return t;return null}bestTabContentViewForRepresentedObject(e,t={}){console.assert(!this.selectedTabContentView||this.selectedTabContentView===this._recentTabContentViews[0]);let i=this._recentTabContentViews.find(n=>n.type===t.preferredTabType);if(i&&i.canShowRepresentedObject(e))return i;for(let n of this._recentTabContentViews)if(!(t.ignoreSearchTab&&n instanceof WI.SearchTabContentView)&&!(t.ignoreNetworkTab&&n instanceof WI.NetworkTabContentView)&&n.canShowRepresentedObject(e))return n;return null}addTabForContentView(e,t={}){if(console.assert(e instanceof WI.TabContentView),!(e instanceof WI.TabContentView))return!1;let i=e.tabBarItem;return console.assert(i instanceof WI.TabBarItem),i instanceof WI.TabBarItem?(i.representedObject!==e&&(i.representedObject=e),i.parentTabBar===this._tabBar||(this._recentTabContentViews.length&&this.selectedTabContentView?this._recentTabContentViews.splice(1,0,e):this._recentTabContentViews.push(e),typeof t.insertionIndex=="number"?this._tabBar.insertTabBarItem(i,t.insertionIndex,t):this._tabBar.addTabBarItem(i,t),console.assert(this._recentTabContentViews.length===this._tabBar.saveableTabCount),console.assert(!this.selectedTabContentView||this.selectedTabContentView===this._recentTabContentViews[0])),!0):!1}showTabForContentView(e,t={}){return this.addTabForContentView(e,t)?(this._tabBar.selectedTabBarItem=e.tabBarItem,this.needsLayout(),!0):!1}closeTabForContentView(e,t={}){return console.assert(e instanceof WI.TabContentView),!(e instanceof WI.TabContentView)||(console.assert(e.tabBarItem instanceof WI.TabBarItem),!(e.tabBarItem instanceof WI.TabBarItem))||e.tabBarItem.parentTabBar!==this._tabBar?!1:(this._tabBar.removeTabBarItem(e.tabBarItem,t),console.assert(this._recentTabContentViews.length===this._tabBar.saveableTabCount),console.assert(!this.selectedTabContentView||this.selectedTabContentView===this._recentTabContentViews[0]),!0)}sizeDidChange(){super.sizeDidChange();for(let e of this._recentTabContentViews)e[WI.TabBrowser.NeedsResizeLayoutSymbol]=e!==this.selectedTabContentView}_tabBarItemSelected(e){let t=this._tabBar.selectedTabBarItem?this._tabBar.selectedTabBarItem.representedObject:null;if(t){let i=t.constructor.shouldSaveTab();i&&(this._recentTabContentViews.remove(t),this._recentTabContentViews.unshift(t)),this._contentViewContainer.showContentView(t),console.assert(this.selectedTabContentView),console.assert(this._recentTabContentViews.length===this._tabBar.saveableTabCount),console.assert(this.selectedTabContentView===this._recentTabContentViews[0]||!i)}else this._contentViewContainer.closeAllContentViews(),console.assert(!this.selectedTabContentView);this._showNavigationSidebarPanelForTabContentView(t),this._showDetailsSidebarPanelsForTabContentView(t),t&&t[WI.TabBrowser.NeedsResizeLayoutSymbol]&&(t[WI.TabBrowser.NeedsResizeLayoutSymbol]=!1,t.updateLayout(WI.View.LayoutReason.Resize)),this.dispatchEventToListeners(WI.TabBrowser.Event.SelectedTabContentViewDidChange)}_tabBarItemAdded(e){let t=e.data.tabBarItem.representedObject;console.assert(t),t&&this._closedTabClasses.delete(t.constructor)}_tabBarItemRemoved(e){let t=e.data.tabBarItem.representedObject;console.assert(t),t&&(this._recentTabContentViews.remove(t),t.constructor.tabInfo().isEphemeral||this._closedTabClasses.add(t.constructor),this._contentViewContainer.closeContentView(t),console.assert(this._recentTabContentViews.length===this._tabBar.saveableTabCount),console.assert(!this.selectedTabContentView||this.selectedTabContentView===this._recentTabContentViews[0]))}_sidebarPanelSelected(e){if(!this._ignoreSidebarEvents){var t=this.selectedTabContentView;if(!!t&&(console.assert(e.target===this._detailsSidebar),!t.managesDetailsSidebarPanels)){var i=this._detailsSidebar.selectedSidebarPanel;t.detailsSidebarSelectedPanelSetting.value=i?i.identifier:null}}}_sidebarCollapsedStateDidChange(e){if(!this._ignoreSidebarEvents){var t=this.selectedTabContentView;!t||(e.target===this._navigationSidebar&&!t.managesNavigationSidebarPanel?t.navigationSidebarCollapsedSetting.value=this._navigationSidebar.collapsed:e.target===this._detailsSidebar&&!t.managesDetailsSidebarPanels&&(t.detailsSidebarCollapsedSetting.value=this._detailsSidebar.collapsed))}}_sidebarWidthDidChange(e){if(this._ignoreSidebarEvents||!e.data)return;let t=this.selectedTabContentView;if(!!t)switch(e.target){case this._navigationSidebar:t.navigationSidebarWidthSetting.value=e.data.newWidth;break;case this._detailsSidebar:t.detailsSidebarWidthSetting.value=e.data.newWidth;break}}_showNavigationSidebarPanelForTabContentView(e){if(!!this._navigationSidebar){if(this._ignoreSidebarEvents=!0,this._navigationSidebar.removeSidebarPanel(0),console.assert(!this._navigationSidebar.sidebarPanels.length),!e){this._ignoreSidebarEvents=!1;return}e.navigationSidebarWidthSetting.value&&(this._navigationSidebar.width=e.navigationSidebarWidthSetting.value);var t=e.navigationSidebarPanel;if(!t){this._navigationSidebar.collapsed=!0,this._ignoreSidebarEvents=!1;return}if(e.managesNavigationSidebarPanel){e.showNavigationSidebarPanel(),this._ignoreSidebarEvents=!1;return}this._navigationSidebar.addSidebarPanel(t),this._navigationSidebar.selectedSidebarPanel=t,this._navigationSidebar.collapsed=e.navigationSidebarCollapsedSetting.value,this._ignoreSidebarEvents=!1}}_showDetailsSidebarPanelsForTabContentView(e){if(!!this._detailsSidebar){this._ignoreSidebarEvents=!0;for(var t=this._detailsSidebar.sidebarPanels.length-1;t>=0;--t)this._detailsSidebar.removeSidebarPanel(t);if(console.assert(!this._detailsSidebar.sidebarPanels.length),!e){this._ignoreSidebarEvents=!1;return}if(e.detailsSidebarWidthSetting.value&&(this._detailsSidebar.width=e.detailsSidebarWidthSetting.value),e.managesDetailsSidebarPanels){e.showDetailsSidebarPanels(),this._ignoreSidebarEvents=!1;return}var i=e.detailsSidebarPanels;if(!i){this._detailsSidebar.collapsed=!0,this._ignoreSidebarEvents=!1;return}for(var n of i)this._detailsSidebar.addSidebarPanel(n);this._detailsSidebar.selectedSidebarPanel=e.detailsSidebarSelectedPanelSetting.value||i[0],this._detailsSidebar.collapsed=e.detailsSidebarCollapsedSetting.value||!i.length,this._ignoreSidebarEvents=!1}}_showPreviousTab(e){this._tabBar.selectPreviousTab()}_showNextTab(e){this._tabBar.selectNextTab()}_showNextTabCheckingForEditableField(e){WI.isEventTargetAnEditableField(e)||(this._showNextTab(e),e.preventDefault())}_showPreviousTabCheckingForEditableField(e){WI.isEventTargetAnEditableField(e)||(this._showPreviousTab(e),e.preventDefault())}};WI.TabBrowser.NeedsResizeLayoutSymbol=Symbol("needs-resize-layout");WI.TabBrowser.Event={SelectedTabContentViewDidChange:"tab-browser-selected-tab-content-view-did-change"};WI.Table=class extends WI.View{constructor(e,t,i,n){super(),console.assert(typeof e=="string"),console.assert(t),console.assert(i),console.assert(n>0),this._identifier=e,this._dataSource=t,this._delegate=i,this._rowHeight=n,this.element.classList.add("table",e),this.element.tabIndex=0,this.element.addEventListener("keydown",this._handleKeyDown.bind(this)),this._headerElement=this.element.appendChild(document.createElement("div")),this._headerElement.className="header";let s=this._handleScroll.bind(this);this._scrollContainerElement=this.element.appendChild(document.createElement("div")),this._scrollContainerElement.className="data-container",this._scrollContainerElement.addEventListener("scroll",s),this._scrollContainerElement.addEventListener("mousewheel",s),this._scrollContainerElement.addEventListener("mousedown",this._handleMouseDown.bind(this)),this._delegate.tableCellContextMenuClicked&&this._scrollContainerElement.addEventListener("contextmenu",this._handleContextMenu.bind(this)),this._topSpacerElement=this._scrollContainerElement.appendChild(document.createElement("div")),this._topSpacerElement.className="spacer",this._listElement=this._scrollContainerElement.appendChild(document.createElement("ul")),this._listElement.className="data-list",this._bottomSpacerElement=this._scrollContainerElement.appendChild(document.createElement("div")),this._bottomSpacerElement.className="spacer",this._fillerRow=this._listElement.appendChild(document.createElement("li")),this._fillerRow.className="filler",this._resizersElement=this._element.appendChild(document.createElement("div")),this._resizersElement.className="resizers",this._cachedRows=new Map,this._columnSpecs=new Map,this._columnOrder=[],this._visibleColumns=[],this._hiddenColumns=[],this._widthGeneration=1,this._columnWidths=null,this._fillerHeight=0,this._selectionController=new WI.SelectionController(this,(a,d)=>this._indexForRepresentedObject(a)-this._indexForRepresentedObject(d)),this._resizers=[],this._currentResizer=null,this._resizeLeftColumns=null,this._resizeRightColumns=null,this._resizeOriginalColumnWidths=null,this._lastColumnIndexToAcceptRemainderPixel=0,this._sortOrderSetting=new WI.Setting(this._identifier+"-sort-order",WI.Table.SortOrder.Indeterminate),this._sortColumnIdentifierSetting=new WI.Setting(this._identifier+"-sort",null),this._columnVisibilitySetting=new WI.Setting(this._identifier+"-column-visibility",{}),this._sortOrder=this._sortOrderSetting.value,this._sortColumnIdentifier=this._sortColumnIdentifierSetting.value,this._cachedWidth=NaN,this._cachedHeight=NaN,this._cachedScrollTop=NaN,this._previousCachedWidth=NaN,this._previousRevealedRowCount=NaN,this._topSpacerHeight=NaN,this._bottomSpacerHeight=NaN,this._visibleRowIndexStart=NaN,this._visibleRowIndexEnd=NaN,console.assert(this._dataSource.tableNumberOfRows,"Table data source must implement tableNumberOfRows."),console.assert(this._dataSource.tableIndexForRepresentedObject,"Table data source must implement tableIndexForRepresentedObject."),console.assert(this._dataSource.tableRepresentedObjectForIndex,"Table data source must implement tableRepresentedObjectForIndex."),console.assert(this._delegate.tablePopulateCell,"Table delegate must implement tablePopulateCell.")}get identifier(){return this._identifier}get dataSource(){return this._dataSource}get delegate(){return this._delegate}get rowHeight(){return this._rowHeight}get selectedRow(){let e=this._selectionController.lastSelectedItem,t=this._indexForRepresentedObject(e);return t>=0?t:NaN}get selectedRows(){let e=[];for(let t of this._selectionController.selectedItems)e.push(this._indexForRepresentedObject(t));return e}get scrollContainer(){return this._scrollContainerElement}get numberOfRows(){return this._dataSource.tableNumberOfRows(this)}get sortOrder(){return this._sortOrder}set sortOrder(e){if(!(e===this._sortOrder&&this.didInitialLayout)&&(console.assert(e===WI.Table.SortOrder.Indeterminate||e===WI.Table.SortOrder.Ascending||e===WI.Table.SortOrder.Descending),this._sortOrder=e,this._sortOrderSetting.value=e,this._sortColumnIdentifier)){let t=this._columnSpecs.get(this._sortColumnIdentifier),i=this._visibleColumns.indexOf(t);if(i!==-1){let n=this._headerElement.children[i];n.classList.toggle("sort-ascending",this._sortOrder===WI.Table.SortOrder.Ascending),n.classList.toggle("sort-descending",this._sortOrder===WI.Table.SortOrder.Descending)}this._dataSource.tableSortChanged&&this._dataSource.tableSortChanged(this)}}get sortColumnIdentifier(){return this._sortColumnIdentifier}set sortColumnIdentifier(e){if(e===this._sortColumnIdentifier&&this.didInitialLayout)return;let t=this._columnSpecs.get(e);if(console.assert(t,"Column not found.",e),!t||(console.assert(t.sortable,"Column is not sortable.",e),!t.sortable))return;let i=this._sortColumnIdentifier;if(this._sortColumnIdentifier=e,this._sortColumnIdentifierSetting.value=e,i){let n=this._columnSpecs.get(i),s=this._visibleColumns.indexOf(n);s!==-1&&this._headerElement.children[s].classList.remove("sort-ascending","sort-descending")}if(this._sortColumnIdentifier){let n=this._visibleColumns.indexOf(t);if(n!==-1){let s=this._headerElement.children[n];s.classList.toggle("sort-ascending",this._sortOrder===WI.Table.SortOrder.Ascending),s.classList.toggle("sort-descending",this._sortOrder===WI.Table.SortOrder.Descending)}else this._sortColumnIdentifier=null}this._dataSource.tableSortChanged&&this._dataSource.tableSortChanged(this)}get allowsMultipleSelection(){return this._selectionController.allowsMultipleSelection}set allowsMultipleSelection(e){this._selectionController.allowsMultipleSelection=e}get columns(){return Array.from(this._columnSpecs.values())}isRowSelected(e){return this._selectionController.hasSelectedItem(this._representedObjectForIndex(e))}reloadData(){this._cachedRows.clear(),this._selectionController.reset(),this._previousRevealedRowCount=NaN,this.needsLayout()}reloadDataAddedToEndOnly(){this._previousRevealedRowCount=NaN,this.needsLayout()}reloadRow(e){if(this._isRowVisible(e)){let t=this._cachedRows.get(e);if(!t)return;this._populateRow(t);return}this._cachedRows.delete(e)}reloadVisibleColumnCells(e){let t=this._visibleColumns.indexOf(e);if(t===-1)return;let i=Math.min(this._visibleRowIndexEnd,this.numberOfRows);for(let n=this._visibleRowIndexStart;n<i;++n){let s=this._cachedRows.get(n);if(!s)continue;let a=s.children[t];!a||this._delegate.tablePopulateCell(this,a,e,n)}}reloadCell(e,t){let i=this._columnSpecs.get(t),n=this._visibleColumns.indexOf(i);if(n!==-1){if(this._isRowVisible(e)){let s=this._cachedRows.get(e);if(!s)return;let a=s.children[n];if(!a)return;this._delegate.tablePopulateCell(this,a,i,e);return}this._cachedRows.delete(e)}}selectRow(e,t=!1){this._selectionController.selectItem(this._representedObjectForIndex(e),t)}deselectRow(e){this._selectionController.deselectItem(this._representedObjectForIndex(e))}selectAll(){this._selectionController.selectAll()}deselectAll(){this._selectionController.deselectAll()}removeRow(e){console.assert(e>=0&&e<this.numberOfRows),this.isRowSelected(e)&&this.deselectRow(e),this._removeRows(new Set([this._representedObjectForIndex(e)]))}removeSelectedRows(){let e=this._selectionController.selectedItems;!e.size||(this._selectionController.removeSelectedItems(),this._removeRows(e))}revealRow(e){if(console.assert(e>=0&&e<this.numberOfRows),!(e<0||e>=this.numberOfRows))if(this._isRowVisible(e)){let t=this._cachedRows.get(e);console.assert(t,"Visible rows should always be in the cache."),t&&(t.scrollIntoViewIfNeeded(!1),this._cachedScrollTop=NaN,this.needsLayout())}else{let t=e*this._rowHeight,i=this._calculateOffsetHeight(),n=this._calculateScrollTop(),s=NaN;t+this._rowHeight<n?s=t:t>n+i&&(s=n+i-this._rowHeight),isNaN(s)||(this._scrollContainerElement.scrollTop=s,this.updateLayout())}}columnWithIdentifier(e){return this._columnSpecs.get(e)}cellForRowAndColumn(e,t){if(!this._isRowVisible(e))return null;let i=this._cachedRows.get(e);if(!i)return null;let n=this._visibleColumns.indexOf(t);return n===-1?null:i.children[n]}addColumn(e){this._columnSpecs.set(e.identifier,e),this._columnOrder.push(e.identifier),e.hidden?(this._hiddenColumns.push(e),e.width=NaN):(this._visibleColumns.push(e),this._headerElement.appendChild(this._createHeaderCell(e)),this._fillerRow.appendChild(this._createFillerCell(e)),e.headerView&&this.addSubview(e.headerView));let t=this._columnVisibilitySetting.value;e.identifier in t&&(t[e.identifier]?this.showColumn(e):this.hideColumn(e)),this.reloadData()}showColumn(e){if(console.assert(this._columnSpecs.get(e.identifier)===e,"Column not in this table."),console.assert(!e.locked,"Locked columns should always be shown."),e.locked||!e.hidden)return;e.hidden=!1;let t=this._hiddenColumns.indexOf(e);this._hiddenColumns.splice(t,1);let i=this._indexToInsertColumn(e);this._visibleColumns.insertAtIndex(e,i);let n=this._columnVisibilitySetting.value;if(n[e.identifier]!==!0){let a=Object.shallowCopy(n);e.defaultHidden?a[e.identifier]=!0:delete a[e.identifier],this._columnVisibilitySetting.value=a}if(this._headerElement.insertBefore(this._createHeaderCell(e),this._headerElement.children[i]),this._fillerRow.insertBefore(this._createFillerCell(e),this._fillerRow.children[i]),e.headerView&&this.addSubview(e.headerView),this._sortColumnIdentifier===e.identifier){let a=this._headerElement.children[i];a.classList.toggle("sort-ascending",this._sortOrder===WI.Table.SortOrder.Ascending),a.classList.toggle("sort-descending",this._sortOrder===WI.Table.SortOrder.Descending)}if(!this._columnWidths)return;let s=[];for(let a of this._listElement.children)if(a!==this._fillerRow){let d=this._createCell(e,i);s.push(d),a.insertBefore(d,a.children[i])}this._widthGeneration++,this._columnWidths=null,this._resizeColumnsAndFiller();for(let a of s)this._delegate.tablePopulateCell(this,a,e,a.parentElement.__index);for(let a of this._visibleColumns)a!==e&&a.needsReloadOnResize&&this.reloadVisibleColumnCells(a)}hideColumn(e){if(console.assert(this._columnSpecs.get(e.identifier)===e,"Column not in this table."),console.assert(!e.locked,"Locked columns should always be shown."),e.locked||(console.assert(e.hideable,"Column is not hideable so should always be shown."),!e.hideable)||e.hidden)return;e.hidden=!0,this._hiddenColumns.push(e);let t=this._visibleColumns.indexOf(e);this._visibleColumns.splice(t,1);let i=this._columnVisibilitySetting.value;if(i[e.identifier]!==!1){let n=Object.shallowCopy(i);e.defaultHidden?delete n[e.identifier]:n[e.identifier]=!1,this._columnVisibilitySetting.value=n}if(this._headerElement.removeChild(this._headerElement.children[t]),this._fillerRow.removeChild(this._fillerRow.children[t]),e.headerView&&this.removeSubview(e.headerView),!!this._columnWidths){for(let n of this._listElement.children)n!==this._fillerRow&&n.removeChild(n.children[t]);this._widthGeneration++,this._columnWidths=null,this._resizeColumnsAndFiller();for(let n of this._visibleColumns)n.needsReloadOnResize&&this.reloadVisibleColumnCells(n)}}restoreScrollPosition(){this._cachedScrollTop&&!this._scrollContainerElement.scrollTop&&(this._scrollContainerElement.scrollTop=this._cachedScrollTop)}initialLayout(){this.sortOrder=this._sortOrderSetting.value;let e=this._sortColumnIdentifierSetting.value;this._columnSpecs.has(e)?this.sortColumnIdentifier=e:this._sortColumnIdentifierSetting.value=null}layout(){this._updateVisibleRows(),this._resizeColumnsAndFiller()}sizeDidChange(){super.sizeDidChange(),this._previousCachedWidth=this._cachedWidth,this._cachedWidth=NaN,this._cachedHeight=NaN}selectionControllerSelectionDidChange(e,t,i){for(let n of t){let s=this._indexForRepresentedObject(n),a=this._cachedRows.get(s);a&&a.classList.toggle("selected",!1)}for(let n of i){let s=this._indexForRepresentedObject(n),a=this._cachedRows.get(s);a&&a.classList.toggle("selected",!0)}if(this._selectionController.lastSelectedItem){let n=this._indexForRepresentedObject(this._selectionController.lastSelectedItem);this.revealRow(n)}this._delegate.tableSelectionDidChange&&this._delegate.tableSelectionDidChange(this)}selectionControllerFirstSelectableItem(e){return this._representedObjectForIndex(0)}selectionControllerLastSelectableItem(e){return this._representedObjectForIndex(this.numberOfRows-1)}selectionControllerPreviousSelectableItem(e,t){let i=this._indexForRepresentedObject(t);return console.assert(i>=0&&i<this.numberOfRows),i>0?this._representedObjectForIndex(i-1):null}selectionControllerNextSelectableItem(e,t){let i=this._indexForRepresentedObject(t);return console.assert(i>=0&&i<this.numberOfRows),i<this.numberOfRows-1?this._representedObjectForIndex(i+1):null}resizerDragStarted(e){console.assert(!this._currentResizer,e,this._currentResizer);let t=this._resizers.indexOf(e);this._currentResizer=e,this._resizeLeftColumns=this._visibleColumns.slice(0,t+1).reverse(),this._resizeRightColumns=this._visibleColumns.slice(t+1),this._resizeOriginalColumnWidths=[].concat(this._columnWidths)}resizerDragging(e,t){if(console.assert(e===this._currentResizer,e,this._currentResizer),e!==this._currentResizer)return;if(WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL&&(t=-t),this._columnWidths=[].concat(this._resizeOriginalColumnWidths),!t){this._applyColumnWidths();return}let i=Math.abs(t),n=t>0,s=!n,a=this._columnWidths,d=this._visibleColumns;function p(S){let E=a[d.indexOf(S)];return S.maxWidth?S.maxWidth-E:1/0}function f(S){let E=a[d.indexOf(S)];return S.minWidth?E-S.minWidth:E}function _(S){return p(S)>0}function b(S){return f(S)>0}function w(S,E){for(let R of S)if(!!R.flexible&&(E?b(R):_(R)))return R;let k=S[0];return E&&b(k)||!E&&_(k)?k:null}for(;i>0;){let S=w(this._resizeLeftColumns,n),E=w(this._resizeRightColumns,s);if(!S||!E)break;let k=Math.min(i,f(n?S:E),p(n?E:S)),R=this._visibleColumns.indexOf(S),M=this._visibleColumns.indexOf(E);n?(this._columnWidths[R]-=k,this._columnWidths[M]+=k):(this._columnWidths[R]+=k,this._columnWidths[M]-=k),i-=k}this._widthGeneration++,this._applyColumnWidths(),this._positionHeaderViews()}resizerDragEnded(e){console.assert(e===this._currentResizer,e,this._currentResizer),e===this._currentResizer&&(this._currentResizer=null,this._resizeLeftColumns=null,this._resizeRightColumns=null,this._resizeOriginalColumnWidths=null,this._positionResizerElements(),this._positionHeaderViews())}_createHeaderCell(e){let t=document.createElement("span");return t.classList.add("cell",e.identifier),t.textContent=e.name,e.align&&t.classList.add("align-"+e.align),e.sortable&&(t.classList.add("sortable"),t.addEventListener("click",this._handleHeaderCellClicked.bind(this,e))),t.addEventListener("contextmenu",this._handleHeaderContextMenu.bind(this,e)),t}_createFillerCell(e){let t=document.createElement("span");return t.classList.add("cell",e.identifier),t}_createCell(e,t){let i=document.createElement("span");return i.classList.add("cell",e.identifier),e.align&&i.classList.add("align-"+e.align),this._columnWidths&&(i.style.width=this._columnWidths[t]+"px"),i}_getOrCreateRow(e){let t=this._cachedRows.get(e);if(t)return t;let i=document.createElement("li");return i.__index=e,i.__widthGeneration=0,this.isRowSelected(e)&&i.classList.add("selected"),this._cachedRows.set(e,i),i}_populatedCellForColumnAndRow(e,t,i){console.assert(i!==void 0,"Tried to populate a row that did not know its index. Is this the filler row?");let n=this._createCell(e,t);return this._delegate.tablePopulateCell(this,n,e,i),n}_populateRow(e){e.removeChildren();let t=e.__index;for(let i=0;i<this._visibleColumns.length;++i){let n=this._visibleColumns[i],s=this._populatedCellForColumnAndRow(n,i,t);e.appendChild(s)}}_resizeColumnsAndFiller(){if((isNaN(this._cachedWidth)||!this._cachedWidth)&&(this._cachedWidth=this._scrollContainerElement.realOffsetWidth),!this._cachedWidth)return;let e=this._cachedWidth,t=this._cachedHeight,i=this.numberOfRows*this._rowHeight;if(this._fillerHeight=Math.max(t-i,0),this._columnWidths&&this._cachedWidth===this._previousCachedWidth){this._updateFillerRowWithNewHeight(),this._applyColumnWidthsToColumnsIfNeeded();return}this._previousCachedWidth=this._cachedWidth;let n=0,s=0,a=0;for(let b of this._visibleColumns)b.locked?(n+=b.width,s++,a+=b.width):b.minWidth&&(a+=b.minWidth);let d=e-n,p=this._visibleColumns.length-s;function f(b,w){if(!b)return;let S=(this._lastColumnIndexToAcceptRemainderPixel+1)%this._visibleColumns.length,E=!1;for(;b>0;){let k=b;for(let R=S;R<this._columnWidths.length;++R){let M=this._visibleColumns[R];if(!M.locked&&(w?(E||M.minWidth&&this._columnWidths[R]>M.minWidth)&&(this._columnWidths[R]--,b--):E||M.maxWidth&&this._columnWidths[R]<M.maxWidth?(this._columnWidths[R]++,b--):M.maxWidth||(this._columnWidths[R]++,b--),!b)){this._lastColumnIndexToAcceptRemainderPixel=R;break}}if(b===k&&!S){if(E)break;E=!0}S=0}console.assert(!b,"Should not have undistributed pixels.")}if(this._columnWidths){console.assert(this._columnWidths.length===this._visibleColumns.length,"Number of columns should not change in a resize.");let b=0;for(let E of this._columnWidths)b+=E;let w=Math.abs(e-b),S=e<b;f.call(this,w,S)}else{let S=function(R){for(;;){let M=p-w;if(!M)return;let L=d-b,V=Math.floor(L/M),H=!1;for(let O=0;O<this._visibleColumns.length;++O){if(this._columnWidths[O])continue;let z=this._visibleColumns[O];console.assert(z.flexible,"Non-flexible columns should have been sized earlier",z);let K=R(z,V);K!==-1&&(this._columnWidths[O]=K,b+=K,w++,H=!0)}if(!H)return}};var _=S;this._columnWidths=[],this._lastColumnIndexToAcceptRemainderPixel=0;let b=0,w=0;for(let R=0;R<this._visibleColumns.length;++R){let M=this._visibleColumns[R];M.locked&&(this._columnWidths[R]=M.width)}S.call(this,(R,M)=>!R.preferredInitialWidth||M<=R.preferredInitialWidth?-1:R.preferredInitialWidth),S.call(this,(R,M)=>!R.maxWidth||M<=R.maxWidth?-1:R.maxWidth),S.call(this,(R,M)=>!R.minWidth||M>=R.minWidth?-1:R.minWidth),S.call(this,(R,M)=>M);let E=e-(n+b),k=E<0;f.call(this,Math.abs(E),k)}this._widthGeneration++,this._updateFillerRowWithNewHeight(),this._applyColumnWidths(),this._positionResizerElements(),this._positionHeaderViews()}_updateVisibleRows(){let e=this._rowHeight,t=e*10,i=t*3,n=this._calculateScrollTop(),s=this._calculateOffsetHeight(),a=Math.ceil((s+i*2)/e),d=this._topSpacerHeight,p=this._bottomSpacerHeight,f=d+a*e,_=!d||n>d+t,b=!p||n+s<f-t;if(_&&b&&!isNaN(this._previousRevealedRowCount))return;let w=this.numberOfRows;if(this._previousRevealedRowCount=w,n){let M=Math.ceil(s/e);if(w>=M){let L=Math.max(0,w*e-s);n>L&&(this._scrollContainerElement.scrollTop=L,this._cachedScrollTop=L)}}let S=Math.max(0,Math.floor((n-i)/e)),E=Math.max(0,this._previousRevealedRowCount-S-a),k=S*e,R=E*e;this._topSpacerHeight!==k&&(this._topSpacerHeight=k,this._topSpacerElement.style.height=k+"px"),this._bottomDataTableMarginElement!==R&&(this._bottomSpacerHeight=R,this._bottomSpacerElement.style.height=R+"px"),this._visibleRowIndexStart=S,this._visibleRowIndexEnd=this._visibleRowIndexStart+a,this._listElement.removeChildren(),this._listElement.classList.toggle("odd-first-zebra-stripe",!!(S%2));for(let M=this._visibleRowIndexStart;M<this._visibleRowIndexEnd&&M<w;++M){let L=this._getOrCreateRow(M);this._listElement.appendChild(L)}this._listElement.appendChild(this._fillerRow)}_updateFillerRowWithNewHeight(){if(!this._fillerHeight){this._scrollContainerElement.classList.remove("not-scrollable"),this._fillerRow.remove();return}this._scrollContainerElement.classList.add("not-scrollable"),this._cachedScrollTop&&(this._scrollContainerElement.scrollTop=0,this._cachedScrollTop=0);const e=200;this._fillerHeight+=e;for(let t of this._fillerRow.children)t.style.height=this._fillerHeight+"px";this._fillerRow.parentElement||this._listElement.appendChild(this._fillerRow)}_applyColumnWidths(){for(let e=0;e<this._headerElement.children.length;++e)this._headerElement.children[e].style.width=this._columnWidths[e]+"px";for(let e of this._listElement.children){for(let t=0;t<e.children.length;++t)e.children[t].style.width=this._columnWidths[t]+"px";e.__widthGeneration=this._widthGeneration}for(let e=0;e<this._visibleColumns.length;++e)this._visibleColumns[e].width=this._columnWidths[e];for(let e of this._listElement.children)e!==this._fillerRow&&e.children.length!==this._visibleColumns.length&&this._populateRow(e)}_applyColumnWidthsToColumnsIfNeeded(){for(let e of this._listElement.children)if(e.__widthGeneration!==this._widthGeneration){for(let t=0;t<e.children.length;++t)e.children[t].style.width=this._columnWidths[t]+"px";e!==this._fillerRow&&e.children.length!==this._visibleColumns.length&&this._populateRow(e),e.__widthGeneration=this._widthGeneration}}_positionResizerElements(){console.assert(this._visibleColumns.length===this._columnWidths.length);let e=this._visibleColumns.length-1;if(this._resizers.length!==e)if(this._resizers.length<e)do{let s=new WI.Resizer(WI.Resizer.RuleOrientation.Vertical,this);this._resizers.push(s),this._resizersElement.appendChild(s.element)}while(this._resizers.length<e);else do{let s=this._resizers.pop();this._resizersElement.removeChild(s.element)}while(this._resizers.length>e);const t=3;let i=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?"right":"left",n=0;for(let s=0;s<e;++s)n+=this._columnWidths[s],this._resizers[s].element.style[i]=n-t+"px"}_positionHeaderViews(){if(!this.subviews.length)return;let e=0,t=[];for(let n=0;n<this._visibleColumns.length;++n){let s=this._visibleColumns[n],a=this._columnWidths[n];s.headerView&&t.push({headerView:s.headerView,offset:e,width:a}),e+=a}let i=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?"right":"left";for(let{headerView:n,offset:s,width:a}of t)n.element.style.setProperty(i,s+"px"),n.element.style.width=a+"px",n.updateLayout(WI.View.LayoutReason.Resize)}_isRowVisible(e){return this._previousRevealedRowCount?e>=this._visibleRowIndexStart&&e<=this._visibleRowIndexEnd:!1}_indexToInsertColumn(e){let t=0;for(let i of this._columnOrder){if(i===e.identifier)return t;if(i===this._visibleColumns[t].identifier&&(t++,t>=this._visibleColumns.length))break}return t}_handleScroll(e){e.type==="mousewheel"&&!e.wheelDeltaY||(this._cachedScrollTop=NaN,this.needsLayout())}_handleKeyDown(e){this._selectionController.handleKeyDown(e)}_handleMouseDown(e){let t=e.target.closest(".cell");if(!t)return;let i=t.parentElement;if(i===this._fillerRow)return;let n=i.__index;if(!this.isRowSelected(n)&&this._delegate.tableShouldSelectRow){let s=Array.from(i.children).indexOf(t),a=this._visibleColumns[s];if(!this._delegate.tableShouldSelectRow(this,t,a,n))return}this._selectionController.handleItemMouseDown(this._representedObjectForIndex(n),e)}_handleContextMenu(e){let t=e.target.closest(".cell");if(!t)return;let i=t.parentElement;if(i===this._fillerRow)return;let n=Array.from(i.children).indexOf(t),s=this._visibleColumns[n],a=i.__index;this._delegate.tableCellContextMenuClicked(this,t,s,a,e)}_handleHeaderCellClicked(e,t){let i=this._sortOrder;i===WI.Table.SortOrder.Indeterminate?i=WI.Table.SortOrder.Descending:this._sortColumnIdentifier===e.identifier&&(i=i===WI.Table.SortOrder.Ascending?WI.Table.SortOrder.Descending:WI.Table.SortOrder.Ascending),this.sortColumnIdentifier=e.identifier,this.sortOrder=i}_handleHeaderContextMenu(e,t){let i=WI.ContextMenu.createFromEvent(t);e.sortable&&((this.sortColumnIdentifier!==e.identifier||this.sortOrder!==WI.Table.SortOrder.Ascending)&&i.appendItem(WI.UIString("Sort Ascending"),()=>{this.sortColumnIdentifier=e.identifier,this.sortOrder=WI.Table.SortOrder.Ascending}),(this.sortColumnIdentifier!==e.identifier||this.sortOrder!==WI.Table.SortOrder.Descending)&&i.appendItem(WI.UIString("Sort Descending"),()=>{this.sortColumnIdentifier=e.identifier,this.sortOrder=WI.Table.SortOrder.Descending})),i.appendSeparator();let n=!1;for(let[s,a]of this._columnSpecs){if(a.locked||!a.hideable)continue;n||(i.appendItem(WI.UIString("Displayed Columns"),()=>{},!0),n=!0);let d=!a.hidden;i.appendCheckboxItem(a.name,()=>{a.hidden?this.showColumn(a):this.hideColumn(a)},d)}}_removeRows(e){let t=0,i=a=>{let d=this._cachedRows.get(a);d&&(this._cachedRows.delete(a),d.__index-=t,this._cachedRows.set(d.__index,d))},n=[];for(let a of e)n.push(this._indexForRepresentedObject(a));n.sort((a,d)=>a-d);let s=n.lastValue;for(let a=n[0];a<=s;++a){if(n.binaryIndexOf(a)>=0){let d=this._cachedRows.get(a);d&&(this._cachedRows.delete(a),d.remove()),t++;continue}t&&i(a)}if(!!t){for(let a=s+1;a<this.numberOfRows;++a)i(a);this._selectionController.didRemoveItems(e),this._delegate.tableDidRemoveRows&&this._delegate.tableDidRemoveRows(this,n)}}_indexForRepresentedObject(e){return this.dataSource.tableIndexForRepresentedObject(this,e)}_representedObjectForIndex(e){return this.dataSource.tableRepresentedObjectForIndex(this,e)}_calculateOffsetHeight(){return isNaN(this._cachedHeight)&&(this._cachedHeight=this._scrollContainerElement.realOffsetHeight),this._cachedHeight}_calculateScrollTop(){return isNaN(this._cachedScrollTop)&&(this._cachedScrollTop=this._scrollContainerElement.scrollTop),this._cachedScrollTop}};WI.Table.SortOrder={Indeterminate:"table-sort-order-indeterminate",Ascending:"table-sort-order-ascending",Descending:"table-sort-order-descending"};WI.TableColumn=class ic extends WI.Object{constructor(e,t,{initialWidth:i,minWidth:n,maxWidth:s,hidden:a,sortable:d,hideable:p,align:f,resizeType:_,headerView:b,needsReloadOnResize:w}={}){super(),console.assert(e),console.assert(t),console.assert(!i||i>0),console.assert(!n||n>=0),console.assert(!s||s>=0),this._identifier=e,this._name=t,this._width=i||NaN,this._minWidth=n||50,this._maxWidth=s||0,this._initialWidth=i||NaN,this._hidden=a||!1,this._defaultHidden=a||!1,this._sortable=typeof d=="boolean"?d:!0,this._hideable=typeof p=="boolean"?p:!0,this._align=f||null,this._resizeType=_||ic.ResizeType.Auto,this._headerView=b||null,this._needsReloadOnResize=w||!1,console.assert(!this._minWidth||!this._maxWidth||this._minWidth<=this._maxWidth,"Invalid min/max",this._minWidth,this._maxWidth),console.assert(isNaN(this._width)||!this._minWidth||this._width>=this._minWidth,"Initial width is less than min",this._width,this._minWidth),console.assert(isNaN(this._width)||!this._maxWidth||this._width<=this._maxWidth,"Initial width is greater than max",this._width,this._maxWidth),console.assert(!this.locked||this.width,"A locked column should aways have an initial width"),console.assert(!this.locked||!this.hidden,"A locked column should never be hidden")}get identifier(){return this._identifier}get name(){return this._name}get minWidth(){return this._minWidth}get maxWidth(){return this._maxWidth}get preferredInitialWidth(){return this._initialWidth}get defaultHidden(){return this._defaultHidden}get sortable(){return this._sortable}get hideable(){return this._hideable}get align(){return this._align}get headerView(){return this._headerView}get needsReloadOnResize(){return this._needsReloadOnResize}get locked(){return this._resizeType===ic.ResizeType.Locked}get flexible(){return this._resizeType===ic.ResizeType.Auto}get width(){return this._width}set width(e){this._width!==e&&(this._width=e,this.dispatchEventToListeners(WI.TableColumn.Event.WidthDidChange))}get hidden(){return this._hidden}set hidden(e){console.assert(!this.locked&&this._hideable,"Should not be able to hide a non-hideable column."),this._hidden=e}};WI.TableColumn.ResizeType={Auto:"auto",Locked:"locked"};WI.TableColumn.Event={WidthDidChange:"table-column-width-did-change"};WI.TextEditor=class extends WI.View{constructor(e,t,i){super(e),this.element.classList.add("text-editor",WI.SyntaxHighlightedStyleClassName),this._codeMirror=WI.CodeMirrorEditor.create(this.element,{readOnly:!0,lineNumbers:!0,matchBrackets:!0,autoCloseBrackets:!0,styleSelectedText:!0}),this._codeMirror.on("focus",this._editorFocused.bind(this)),this._codeMirror.on("change",this._contentChanged.bind(this)),this._codeMirror.on("gutterClick",this._gutterMouseDown.bind(this)),this._codeMirror.on("gutterContextMenu",this._gutterContextMenu.bind(this)),this._codeMirror.getScrollerElement().addEventListener("click",this._openClickedLinks.bind(this),!0),this._completionController=new WI.CodeMirrorCompletionController(this._codeMirror,this),this._tokenTrackingController=new WI.CodeMirrorTokenTrackingController(this._codeMirror,this),this._initialStringNotSet=!0,this.mimeType=t,this._breakpoints={},this._executionLineNumber=NaN,this._executionColumnNumber=NaN,this._executionLineHandle=null,this._executionMultilineHandles=[],this._executionRangeHighlightMarker=null,this._searchQuery=null,this._searchResults=[],this._currentSearchResultIndex=-1,this._ignoreCodeMirrorContentDidChangeEvent=0,this._formatted=!1,this._formattingPromise=null,this._formatterSourceMap=null,this._deferReveal=!1,this._repeatReveal=!1,this._delegate=i||null}get visible(){return this._visible}get string(){return this._codeMirror.getValue()}set string(e){let t=this._repeatReveal?this.selectedTextRange:null;function i(){if(this._initialStringNotSet&&this._codeMirror.removeLineClass(0,"wrap"),this._codeMirror.getValue()!==e?this._codeMirror.setValue(e):this.layout(),this._initialStringNotSet){if(this._codeMirror.clearHistory(),this._codeMirror.markClean(),this._initialStringNotSet=!1,this._searchQuery){let s=this._searchQuery;this._searchQuery=null,this.performSearch(s)}this._codeMirror.getMode().name==="null"&&this._attemptToDetermineMIMEType()}this._updateExecutionLine(),this._updateExecutionRangeHighlight();for(var n in this._breakpoints)this._setBreakpointStylesOnLine(n);if(this._revealPendingPositionIfPossible(),t){this.selectedTextRange=t;let s=this._codeMirrorPositionFromTextRange(t);this._scrollIntoViewCentered(s.start)}}this._ignoreCodeMirrorContentDidChangeEvent++,this._codeMirror.operation(i.bind(this)),this._ignoreCodeMirrorContentDidChangeEvent--,console.assert(this._ignoreCodeMirrorContentDidChangeEvent>=0)}get readOnly(){return this._codeMirror.getOption("readOnly")||!1}set readOnly(e){this._codeMirror.setOption("readOnly",e),this._codeMirror.getWrapperElement().classList.toggle("read-only",!!e)}get formatted(){return this._formatted}get hasModified(){let e=this._codeMirror.historySize().undo;return this._formatted&&e--,e>0}updateFormattedState(e){return this._format(e)}hasFormatter(){let e=this._codeMirror.getMode().name;return e==="javascript"||e==="css"}canBeFormatted(){return this.hasFormatter()}canShowTypeAnnotations(){return!1}canShowCoverageHints(){return!1}get selectedTextRange(){var e=this._codeMirror.getCursor(!0),t=this._codeMirror.getCursor(!1);return this._textRangeFromCodeMirrorPosition(e,t)}set selectedTextRange(e){document.activeElement===document.body&&this.focus();var t=this._codeMirrorPositionFromTextRange(e);this._codeMirror.setSelection(t.start,t.end)}get mimeType(){return this._mimeType}set mimeType(e){e=parseMIMEType(e).type,this._mimeType=e,this._codeMirror.setOption("mode",{name:e,globalVars:!0}),this.dispatchEventToListeners(WI.TextEditor.Event.MIMETypeChanged)}get executionLineNumber(){return this._executionLineNumber}get executionColumnNumber(){return this._executionColumnNumber}get formatterSourceMap(){return this._formatterSourceMap}get tokenTrackingController(){return this._tokenTrackingController}get delegate(){return this._delegate}set delegate(e){this._delegate=e||null}get numberOfSearchResults(){return this._searchResults.length}get currentSearchQuery(){return this._searchQuery}set automaticallyRevealFirstSearchResult(e){this._automaticallyRevealFirstSearchResult=e,this._automaticallyRevealFirstSearchResult&&this._searchResults.length>0&&this._currentSearchResultIndex===-1&&this._revealFirstSearchResultAfterCursor()}set deferReveal(e){this._deferReveal=e}set repeatReveal(e){this._repeatReveal=e}performSearch(e){if(this._searchQuery===e||(this.searchCleared(),this._searchQuery=e,this._initialStringNotSet)||typeof this.customPerformSearch=="function"&&!this.formatted&&this.customPerformSearch(e))return;let t=WI.SearchUtilities.regExpForString(e,WI.SearchUtilities.defaultSettings);var i=this._codeMirror.getSearchCursor(t,{line:0,ch:0},!1),n=d.bind(this),s=null;function a(){s&&(clearTimeout(s),s=null),this.dispatchEventToListeners(WI.TextEditor.Event.NumberOfSearchResultsDidChange)}function d(){if(this._searchQuery===e){for(var p=[],f=!1,_=0;_<WI.TextEditor.NumberOfFindsPerSearchBatch&&(f=i.findNext());++_){var b=this._textRangeFromCodeMirrorPosition(i.from(),i.to());p.push(b)}this.addSearchResults(p),s||(s=setTimeout(a.bind(this),500)),f?setTimeout(n,50):a.call(this)}}n()}setExecutionLineAndColumn(e,t){!this._executionLineHandle&&isNaN(e)||(this._executionLineNumber=e,this._executionColumnNumber=t,this._initialStringNotSet||(this._updateExecutionLine(),this._updateExecutionRangeHighlight()),this.dispatchEventToListeners(WI.TextEditor.Event.ExecutionLineNumberDidChange))}addSearchResults(e){if(console.assert(e),!e||!e.length)return;function t(){for(var i=0;i<e.length;++i){var n=this._codeMirrorPositionFromTextRange(e[i]),s=this._codeMirror.markText(n.start,n.end,{className:WI.TextEditor.SearchResultStyleClassName});this._searchResults.push(s)}this._automaticallyRevealFirstSearchResult&&this._currentSearchResultIndex===-1&&this._revealFirstSearchResultAfterCursor()}this._codeMirror.operation(t.bind(this))}searchCleared(){this._codeMirror.operation(()=>{for(let e of this._searchResults)e.clear()}),this._searchQuery=null,this._searchResults=[],this._currentSearchResultIndex=-1}searchQueryWithSelection(){return this._codeMirror.somethingSelected()?this._codeMirror.getSelection():null}revealPreviousSearchResult(e){if(!!this._searchResults.length){if(this._currentSearchResultIndex===-1||this._cursorDoesNotMatchLastRevealedSearchResult()){this._revealFirstSearchResultBeforeCursor(e);return}this._currentSearchResultIndex>0?--this._currentSearchResultIndex:this._currentSearchResultIndex=this._searchResults.length-1,this._revealSearchResult(this._searchResults[this._currentSearchResultIndex],e,-1)}}revealNextSearchResult(e){if(!!this._searchResults.length){if(this._currentSearchResultIndex===-1||this._cursorDoesNotMatchLastRevealedSearchResult()){this._revealFirstSearchResultAfterCursor(e);return}this._currentSearchResultIndex+1<this._searchResults.length?++this._currentSearchResultIndex:this._currentSearchResultIndex=0,this._revealSearchResult(this._searchResults[this._currentSearchResultIndex],e,1)}}line(e){return this._codeMirror.getLine(e)}getTextInRange(e,t){return this._codeMirror.getRange(e.toCodeMirror(),t.toCodeMirror())}addStyleToTextRange(e,t,i){return t=t.offsetColumn(1),this._codeMirror.getDoc().markText(e.toCodeMirror(),t.toCodeMirror(),{className:i,inclusiveLeft:!0,inclusiveRight:!0})}revealPosition(e,t,i,n){if(console.assert(e===void 0||e instanceof WI.SourceCodePosition,"revealPosition called without a SourceCodePosition"),!(e instanceof WI.SourceCodePosition))return;if(!this._visible||this._initialStringNotSet||this._deferReveal){this._positionToReveal=e,this._textRangeToSelect=t,this._forceUnformatted=i;return}if(delete this._positionToReveal,delete this._textRangeToSelect,delete this._forceUnformatted,this._formatted&&i){this.updateFormattedState(!1).then(()=>{setTimeout(this.revealPosition.bind(this),0,e,t)});return}let s=Number.constrain(e.lineNumber,0,this._codeMirror.lineCount()-1),a=this._codeMirror.getLineHandle(s);if(!t){let f=Number.constrain(e.columnNumber,0,this._codeMirror.getLine(s).length);t=new WI.TextRange(s,f,s,f)}function d(){this._codeMirror.removeLineClass(a,"wrap",WI.TextEditor.HighlightedStyleClassName)}function p(){var f=this._codeMirrorPositionFromTextRange(t);this._isPositionVisible(f.start)||this._scrollIntoViewCentered(f.start),this.selectedTextRange=t,!n&&(WI.debuggerManager.paused&&s===this._executionLineNumber||(this._codeMirror.addLineClass(a,"wrap",WI.TextEditor.HighlightedStyleClassName),setTimeout(d.bind(this),WI.TextEditor.HighlightAnimationDuration)))}this._codeMirror.operation(p.bind(this))}shown(){this._visible=!0,this._codeMirror.refresh(),this._revealPendingPositionIfPossible()}hidden(){this._visible=!1}setBreakpointInfoForLineAndColumn(e,t,i){this._ignoreSetBreakpointInfoCalls||(i?this._addBreakpointToLineAndColumnWithInfo(e,t,i):this._removeBreakpointFromLineAndColumn(e,t))}updateBreakpointLineAndColumn(e,t,i,n){if(console.assert(this._breakpoints[e]),!!this._breakpoints[e]&&(console.assert(this._breakpoints[e][t]),!!this._breakpoints[e][t])){var s=this._breakpoints[e][t];this._removeBreakpointFromLineAndColumn(e,t),this._addBreakpointToLineAndColumnWithInfo(i,n,s)}}addStyleClassToLine(e,t){var i=this._codeMirror.getLineHandle(e);return i?this._codeMirror.addLineClass(i,"wrap",t):null}removeStyleClassFromLine(e,t){var i=this._codeMirror.getLineHandle(e);return console.assert(i),i?this._codeMirror.removeLineClass(i,"wrap",t):null}toggleStyleClassForLine(e,t){var i=this._codeMirror.getLineHandle(e);return console.assert(i),i?this._codeMirror.toggleLineClass(i,"wrap",t):!1}createWidgetForLine(e){var t=this._codeMirror.getLineHandle(e);if(!t)return null;var i=document.createElement("div"),n=this._codeMirror.addLineWidget(t,i,{coverGutter:!1,noHScroll:!0});return new WI.LineWidget(n,i)}get lineCount(){return this._codeMirror.lineCount()}focus(){this._codeMirror.focus()}contentDidChange(e,t){}rectsForRange(e){return this._codeMirror.rectsForRange(e)}get markers(){return this._codeMirror.getAllMarks().map(WI.TextMarker.textMarkerForCodeMirrorTextMarker)}markersAtPosition(e){return this._codeMirror.findMarksAt(e).map(WI.TextMarker.textMarkerForCodeMirrorTextMarker)}createColorMarkers(e){return createCodeMirrorColorTextMarkers(this._codeMirror,e)}createGradientMarkers(e){return createCodeMirrorGradientTextMarkers(this._codeMirror,e)}createCubicBezierMarkers(e){return createCodeMirrorCubicBezierTextMarkers(this._codeMirror,e)}createSpringMarkers(e){return createCodeMirrorSpringTextMarkers(this._codeMirror,e)}editingControllerForMarker(e){switch(e.type){case WI.TextMarker.Type.Color:return new WI.CodeMirrorColorEditingController(this._codeMirror,e);case WI.TextMarker.Type.Gradient:return new WI.CodeMirrorGradientEditingController(this._codeMirror,e);case WI.TextMarker.Type.CubicBezier:return new WI.CodeMirrorBezierEditingController(this._codeMirror,e);case WI.TextMarker.Type.Spring:return new WI.CodeMirrorSpringEditingController(this._codeMirror,e);default:return new WI.CodeMirrorEditingController(this._codeMirror,e)}}visibleRangeOffsets(){var e=null,t=null,i=this._codeMirror.getViewport();return this._formatterSourceMap?(e=this._formatterSourceMap.formattedToOriginalOffset(Math.max(i.from-1,0),0),t=this._formatterSourceMap.formattedToOriginalOffset(i.to-1,0)):(e=this._codeMirror.getDoc().indexFromPos({line:i.from,ch:0}),t=this._codeMirror.getDoc().indexFromPos({line:i.to,ch:0})),{startOffset:e,endOffset:t}}visibleRangePositions(){let e=this._codeMirror.getViewport(),t,i;return this._formatterSourceMap?(t=this._formatterSourceMap.formattedToOriginal(Math.max(e.from-1,0),0).lineNumber,i=this._formatterSourceMap.formattedToOriginal(e.to-1,0).lineNumber):(t=e.from,i=e.to),{startPosition:new WI.SourceCodePosition(t,0),endPosition:new WI.SourceCodePosition(i,0)}}originalPositionToCurrentPosition(e){if(!this._formatterSourceMap)return e;let{lineNumber:t,columnNumber:i}=this._formatterSourceMap.originalToFormatted(e.lineNumber,e.columnNumber);return new WI.SourceCodePosition(t,i)}originalOffsetToCurrentPosition(e){var t=null;if(this._formatterSourceMap){var i=this._formatterSourceMap.originalPositionToFormatted(e);t={line:i.lineNumber,ch:i.columnNumber}}else t=this._codeMirror.getDoc().posFromIndex(e);return t}currentOffsetToCurrentPosition(e){let t=this._codeMirror.getDoc().posFromIndex(e);return new WI.SourceCodePosition(t.line,t.ch)}currentPositionToOriginalOffset(e){let t=null;return this._formatterSourceMap?t=this._formatterSourceMap.formattedToOriginalOffset(e.line,e.ch):t=this._codeMirror.getDoc().indexFromPos(e),t}currentPositionToOriginalPosition(e){if(!this._formatterSourceMap)return e;let t=this._formatterSourceMap.formattedToOriginal(e.lineNumber,e.columnNumber);return new WI.SourceCodePosition(t.lineNumber,t.columnNumber)}currentPositionToCurrentOffset(e){return this._codeMirror.getDoc().indexFromPos(e.toCodeMirror())}setInlineWidget(e,t){return this._codeMirror.setUniqueBookmark(e.toCodeMirror(),{widget:t})}addScrollHandler(e){this._codeMirror.on("scroll",e)}removeScrollHandler(e){this._codeMirror.off("scroll",e)}layout(){this._visible&&this._codeMirror.refresh()}_format(e){return this._formatted===e?Promise.resolve(this._formatted):(console.assert(!e||this.canBeFormatted()),e&&!this.canBeFormatted()?Promise.resolve(this._formatted):this._formattingPromise?this._formattingPromise:(this._ignoreCodeMirrorContentDidChangeEvent++,this._formattingPromise=this.prettyPrint(e).then(()=>{this._ignoreCodeMirrorContentDidChangeEvent--,console.assert(this._ignoreCodeMirrorContentDidChangeEvent>=0),this._formattingPromise=null;let t=this._formatted;return this._formatted=!!this._formatterSourceMap,this._formatted!==t&&this.dispatchEventToListeners(WI.TextEditor.Event.FormattingDidChange),this._formatted}),this._formattingPromise))}prettyPrint(e){return new Promise((t,i)=>{let n={selectionAnchor:this._codeMirror.getCursor("anchor"),selectionHead:this._codeMirror.getCursor("head")};e?this._canUseFormatterWorker()?this._startWorkerPrettyPrint(n,t):this._startCodeMirrorPrettyPrint(n,t):this._undoFormatting(n,t)})}_canUseFormatterWorker(){let e=this._codeMirror.getMode().name;return e==="javascript"||e==="css"}_attemptToDetermineMIMEType(){let e=Date.now();const t=!1,i=!1;WI.FormatterWorkerProxy.singleton().formatJavaScript(this.string,t,WI.indentString(),i,({formattedText:s})=>{!s||(this.mimeType="text/javascript",Date.now()-e<100&&this.updateFormattedState(!0))})}_startWorkerPrettyPrint(e,t){let i=WI.FormatterWorkerProxy.singleton(),n=this._codeMirror.getValue(),s=WI.indentString();const a=!0;let d=({formattedText:f,sourceMapData:_})=>{if(f===null){t();return}this._finishPrettyPrint(e,f,_,t)},p=this._codeMirror.getMode().name;if(p==="javascript"){const _=(this._delegate?this._delegate.textEditorScriptSourceType(this):WI.Script.SourceType.Program)===WI.Script.SourceType.Module;i.formatJavaScript(n,_,s,a,d)}else p==="css"&&i.formatCSS(n,s,a,d)}_startCodeMirrorPrettyPrint(e,t){let i=WI.indentString(),n={line:0,ch:0},s={line:this._codeMirror.lineCount()-1},a=new FormatterContentBuilder(i);new WI.Formatter(this._codeMirror,a).format(n,s);let p=a.formattedContent,f=a.sourceMapData;this._finishPrettyPrint(e,p,f,t)}_finishPrettyPrint(e,t,i,n){this._codeMirror.operation(()=>{this._formatterSourceMap=WI.FormatterSourceMap.fromSourceMapData(i),this._codeMirror.setValue(t),this._updateAfterFormatting(!0,e)}),n()}_undoFormatting(e,t){this._codeMirror.operation(()=>{this._codeMirror.undo(),this._updateAfterFormatting(!1,e)}),t()}_updateAfterFormatting(e,t){let i=t.selectionAnchor,n=t.selectionHead,s,a,d=null;if(e){if(this._positionToReveal){let _=this._formatterSourceMap.originalToFormatted(this._positionToReveal.lineNumber,this._positionToReveal.columnNumber);this._positionToReveal=new WI.SourceCodePosition(_.lineNumber,_.columnNumber)}if(this._textRangeToSelect){let _=this._formatterSourceMap.originalToFormatted(this._textRangeToSelect.startLine,this._textRangeToSelect.startColumn),b=this._formatterSourceMap.originalToFormatted(this._textRangeToSelect.endLine,this._textRangeToSelect.endColumn);this._textRangeToSelect=new WI.TextRange(_.lineNumber,_.columnNumber,b.lineNumber,b.columnNumber)}isNaN(this._executionLineNumber)||(console.assert(!isNaN(this._executionColumnNumber)),d=this._formatterSourceMap.originalToFormatted(this._executionLineNumber,this._executionColumnNumber));let p=this._formatterSourceMap.originalToFormatted(i.line,i.ch),f=this._formatterSourceMap.originalToFormatted(n.line,n.ch);s={line:p.lineNumber,ch:p.columnNumber},a={line:f.lineNumber,ch:f.columnNumber}}else{if(this._positionToReveal){let _=this._formatterSourceMap.formattedToOriginal(this._positionToReveal.lineNumber,this._positionToReveal.columnNumber);this._positionToReveal=new WI.SourceCodePosition(_.lineNumber,_.columnNumber)}if(this._textRangeToSelect){let _=this._formatterSourceMap.formattedToOriginal(this._textRangeToSelect.startLine,this._textRangeToSelect.startColumn),b=this._formatterSourceMap.formattedToOriginal(this._textRangeToSelect.endLine,this._textRangeToSelect.endColumn);this._textRangeToSelect=new WI.TextRange(_.lineNumber,_.columnNumber,b.lineNumber,b.columnNumber)}isNaN(this._executionLineNumber)||(console.assert(!isNaN(this._executionColumnNumber)),d=this._formatterSourceMap.formattedToOriginal(this._executionLineNumber,this._executionColumnNumber));let p=this._formatterSourceMap.formattedToOriginal(i.line,i.ch),f=this._formatterSourceMap.formattedToOriginal(n.line,n.ch);s={line:p.lineNumber,ch:p.columnNumber},a={line:f.lineNumber,ch:f.columnNumber},this._formatterSourceMap=null}if(this._scrollIntoViewCentered(s),this._codeMirror.setSelection(s,a),d&&(this._executionLineHandle=null,this._executionMultilineHandles=[],this.setExecutionLineAndColumn(d.lineNumber,d.columnNumber)),this.currentSearchQuery){let p=this.currentSearchQuery;this.searchCleared(),setTimeout(()=>{this.performSearch(p)},0)}this._delegate&&typeof this._delegate.textEditorUpdatedFormatting=="function"&&this._delegate.textEditorUpdatedFormatting(this)}hasEdits(){return!this._codeMirror.isClean()}_editorFocused(e){this.dispatchEventToListeners(WI.TextEditor.Event.Focused)}_contentChanged(e,t){if(!(this._ignoreCodeMirrorContentDidChangeEvent>0)){for(var i=[],n=[];t;)i.push(new WI.TextRange(t.from.line,t.from.ch,t.to.line,t.to.ch)),n.push(new WI.TextRange(t.from.line,t.from.ch,t.from.line+t.text.length-1,t.text.length===1?t.from.ch+t.text[0].length:t.text.lastValue.length)),t=t.next;this.contentDidChange(i,n),this._formatted&&(this._formatterSourceMap=null,this._formatted=!1,this._delegate&&typeof this._delegate.textEditorUpdatedFormatting=="function"&&this._delegate.textEditorUpdatedFormatting(this),this.dispatchEventToListeners(WI.TextEditor.Event.FormattingDidChange)),this.dispatchEventToListeners(WI.TextEditor.Event.ContentDidChange)}}_textRangeFromCodeMirrorPosition(e,t){return console.assert(e),console.assert(t),new WI.TextRange(e.line,e.ch,t.line,t.ch)}_codeMirrorPositionFromTextRange(e){console.assert(e);var t={line:e.startLine,ch:e.startColumn},i={line:e.endLine,ch:e.endColumn};return{start:t,end:i}}_revealPendingPositionIfPossible(){!this._positionToReveal||!this._visible||this.revealPosition(this._positionToReveal,this._textRangeToSelect,this._forceUnformatted)}_revealSearchResult(e,t,i){let n=e.find();if(!n){this._revalidateSearchResults(i);return}this._isPositionVisible(n.from)||this._scrollIntoViewCentered(n.from),this.selectedTextRange=this._textRangeFromCodeMirrorPosition(n.from,n.to),this._automaticallyRevealFirstSearchResult=!1,t&&this._codeMirror.focus();let s=this._codeMirror.getCursor("start"),a=this._codeMirror.getSelection();this._removeBouncyHighlightElementIfNeeded(),this._bouncyHighlightElement=document.createElement("div"),this._bouncyHighlightElement.className=WI.TextEditor.BouncyHighlightStyleClassName,this._bouncyHighlightElement.textContent=a;function d(){let p=this._codeMirror.cursorCoords(s,"page"),f=this.element.getBoundingClientRect();p.top-=f.top,p.left-=f.left,this._bouncyHighlightElement.style.top=p.top+"px",this._bouncyHighlightElement.style.left=p.left+"px"}d.call(this),this.element.appendChild(this._bouncyHighlightElement),this._bouncyHighlightScrollHandler=()=>{d.call(this)},this.addScrollHandler(this._bouncyHighlightScrollHandler),this._bouncyHighlightElement.addEventListener("animationend",()=>{this._removeBouncyHighlightElementIfNeeded()})}_removeBouncyHighlightElementIfNeeded(){!this._bouncyHighlightElement||(this.removeScrollHandler(this._bouncyHighlightScrollHandler),this._bouncyHighlightScrollHandler=null,this._bouncyHighlightElement.remove(),this._bouncyHighlightElement=null)}_binarySearchInsertionIndexInSearchResults(e,t){for(var i=this._searchResults,n=0,s=i.length-1;n<=s;){var a=n+s>>1,d=t(e,i[a]);if(d===null)return null;if(d>0)n=a+1;else if(d<0)s=a-1;else return a}return n-1}_revealFirstSearchResultBeforeCursor(e){console.assert(this._searchResults.length);var t=this._codeMirror.getCursor("start");if(t.line===0&&t.ch===0){this._currentSearchResultIndex=this._searchResults.length-1,this._revealSearchResult(this._searchResults[this._currentSearchResultIndex],e,-1);return}var i=this._binarySearchInsertionIndexInSearchResults(t,function(n,s){var a=s.find();return a?WI.compareCodeMirrorPositions(n,a.from):null});if(i===null){this._revalidateSearchResults(-1);return}this._currentSearchResultIndex=i,this._revealSearchResult(this._searchResults[this._currentSearchResultIndex],e)}_revealFirstSearchResultAfterCursor(e){console.assert(this._searchResults.length);var t=this._codeMirror.getCursor("start");if(t.line===0&&t.ch===0){this._currentSearchResultIndex=0,this._revealSearchResult(this._searchResults[this._currentSearchResultIndex],e,1);return}var i=this._binarySearchInsertionIndexInSearchResults(t,function(n,s){var a=s.find();return a?WI.compareCodeMirrorPositions(n,a.from):null});if(i===null){this._revalidateSearchResults(1);return}i+1<this._searchResults.length?++i:i=0,this._currentSearchResultIndex=i,this._revealSearchResult(this._searchResults[this._currentSearchResultIndex],e)}_cursorDoesNotMatchLastRevealedSearchResult(){console.assert(this._currentSearchResultIndex!==-1),console.assert(this._searchResults.length);var e=this._searchResults[this._currentSearchResultIndex].find();if(!e)return!0;var t=this._codeMirror.getCursor("start"),i=e.from;return WI.compareCodeMirrorPositions(t,i)!==0}_revalidateSearchResults(e){console.assert(e!==void 0),this._currentSearchResultIndex=-1;for(var t=[],i=0;i<this._searchResults.length;++i)this._searchResults[i].find()&&t.push(this._searchResults[i]);console.assert(t.length!==this._searchResults.length),this._searchResults=t,this.dispatchEventToListeners(WI.TextEditor.Event.NumberOfSearchResultsDidChange),this._searchResults.length&&(e>0?this._revealFirstSearchResultAfterCursor():this._revealFirstSearchResultBeforeCursor())}_clearMultilineExecutionLineHighlights(){if(this._executionMultilineHandles.length){for(let e of this._executionMultilineHandles)this._codeMirror.removeLineClass(e,"wrap",WI.TextEditor.ExecutionLineStyleClassName);this._executionMultilineHandles=[]}}_updateExecutionLine(){this._codeMirror.operation(()=>{this._executionLineHandle&&(this._codeMirror.removeLineClass(this._executionLineHandle,"wrap",WI.TextEditor.ExecutionLineStyleClassName),this._codeMirror.removeLineClass(this._executionLineHandle,"wrap","primary")),this._clearMultilineExecutionLineHighlights(),this._executionLineHandle=isNaN(this._executionLineNumber)?null:this._codeMirror.getLineHandle(this._executionLineNumber),this._executionLineHandle&&(this._codeMirror.addLineClass(this._executionLineHandle,"wrap",WI.TextEditor.ExecutionLineStyleClassName),this._codeMirror.addLineClass(this._executionLineHandle,"wrap","primary"),this._codeMirror.removeLineClass(this._executionLineHandle,"wrap",WI.TextEditor.HighlightedStyleClassName))})}_updateExecutionRangeHighlight(){if(this._executionRangeHighlightMarker&&(this._executionRangeHighlightMarker.clear(),this._executionRangeHighlightMarker=null),isNaN(this._executionLineNumber))return;let e=new WI.SourceCodePosition(this._executionLineNumber,this._executionColumnNumber);this._delegate.textEditorExecutionHighlightRange(e,t=>{let i,n;t?(i=t.startPosition.toCodeMirror(),n=t.endPosition.toCodeMirror()):(i={line:this._executionLineNumber,ch:this._executionColumnNumber},n={line:this._executionLineNumber}),this._executionRangeHighlightMarker&&(this._executionRangeHighlightMarker.clear(),this._executionRangeHighlightMarker=null);let a=this._codeMirror.getRange(i,n).match(/\s+$/);if(a&&(n.ch=Math.max(0,n.ch-a[0].length)),this._clearMultilineExecutionLineHighlights(),i.line!==n.line)for(let d=i.line;d<n.line;++d){let p=this._codeMirror.getLineHandle(d);this._codeMirror.addLineClass(p,"wrap",WI.TextEditor.ExecutionLineStyleClassName),this._executionMultilineHandles.push(p)}this._executionRangeHighlightMarker=this._codeMirror.markText(i,n,{className:"execution-range-highlight"})})}_setBreakpointStylesOnLine(e){var t=this._breakpoints[e];if(console.assert(t),!t)return;var i=!0,n=!0,s=!0,a=Object.keys(t).length>1;for(var d in t){var p=t[d];p.disabled||(i=!1),p.resolved||(n=!1),p.autoContinue||(s=!1)}n=n&&WI.debuggerManager.breakpointsEnabled;function f(){var _=this._codeMirror.getLineHandle(e);!_||(this._codeMirror.addLineClass(_,"wrap",WI.TextEditor.HasBreakpointStyleClassName),n?this._codeMirror.addLineClass(_,"wrap",WI.TextEditor.BreakpointResolvedStyleClassName):this._codeMirror.removeLineClass(_,"wrap",WI.TextEditor.BreakpointResolvedStyleClassName),i?this._codeMirror.addLineClass(_,"wrap",WI.TextEditor.BreakpointDisabledStyleClassName):this._codeMirror.removeLineClass(_,"wrap",WI.TextEditor.BreakpointDisabledStyleClassName),s?this._codeMirror.addLineClass(_,"wrap",WI.TextEditor.BreakpointAutoContinueStyleClassName):this._codeMirror.removeLineClass(_,"wrap",WI.TextEditor.BreakpointAutoContinueStyleClassName),a?this._codeMirror.addLineClass(_,"wrap",WI.TextEditor.MultipleBreakpointsStyleClassName):this._codeMirror.removeLineClass(_,"wrap",WI.TextEditor.MultipleBreakpointsStyleClassName))}this._codeMirror.operation(f.bind(this))}_addBreakpointToLineAndColumnWithInfo(e,t,i){this._breakpoints[e]||(this._breakpoints[e]={}),this._breakpoints[e][t]=i,this._setBreakpointStylesOnLine(e)}_removeBreakpointFromLineAndColumn(e,t){if(console.assert(t in this._breakpoints[e]),delete this._breakpoints[e][t],!isEmptyObject(this._breakpoints[e])){this._setBreakpointStylesOnLine(e);return}delete this._breakpoints[e];function i(){var n=this._codeMirror.getLineHandle(e);!n||(this._codeMirror.removeLineClass(n,"wrap",WI.TextEditor.HasBreakpointStyleClassName),this._codeMirror.removeLineClass(n,"wrap",WI.TextEditor.BreakpointResolvedStyleClassName),this._codeMirror.removeLineClass(n,"wrap",WI.TextEditor.BreakpointDisabledStyleClassName),this._codeMirror.removeLineClass(n,"wrap",WI.TextEditor.BreakpointAutoContinueStyleClassName),this._codeMirror.removeLineClass(n,"wrap",WI.TextEditor.MultipleBreakpointsStyleClassName))}this._codeMirror.operation(i.bind(this))}_allColumnBreakpointInfoForLine(e){return this._breakpoints[e]}_setColumnBreakpointInfoForLine(e,t){console.assert(t),this._breakpoints[e]=t,this._setBreakpointStylesOnLine(e)}_gutterMouseDown(e,t,i,n){if(!(n.button!==0||n.ctrlKey)){if(!this._codeMirror.hasLineClass(t,"wrap",WI.TextEditor.HasBreakpointStyleClassName)){if(console.assert(!(t in this._breakpoints)),this._delegate&&typeof this._delegate.textEditorBreakpointAdded=="function"){var s=this._delegate.textEditorBreakpointAdded(this,t,0);if(s){var a=s.breakpointInfo;a&&this._addBreakpointToLineAndColumnWithInfo(s.lineNumber,s.columnNumber,a)}}return}if(console.assert(t in this._breakpoints),this._codeMirror.hasLineClass(t,"wrap",WI.TextEditor.MultipleBreakpointsStyleClassName)){console.assert(!isEmptyObject(this._breakpoints[t]));return}console.assert(Object.keys(this._breakpoints[t]).length===1);var d=Object.keys(this._breakpoints[t])[0];this._draggingBreakpointInfo=this._breakpoints[t][d],this._lineNumberWithMousedDownBreakpoint=t,this._lineNumberWithDraggedBreakpoint=t,this._columnNumberWithMousedDownBreakpoint=d,this._columnNumberWithDraggedBreakpoint=d,this._documentMouseMovedEventListener=this._documentMouseMoved.bind(this),this._documentMouseUpEventListener=this._documentMouseUp.bind(this),document.addEventListener("mousemove",this._documentMouseMovedEventListener,!0),document.addEventListener("mouseup",this._documentMouseUpEventListener,!0)}}_gutterContextMenu(e,t,i,n){if(this._delegate&&typeof this._delegate.textEditorGutterContextMenu=="function"){var s=[];for(var a in this._breakpoints[t])s.push({lineNumber:t,columnNumber:a});this._delegate.textEditorGutterContextMenu(this,t,0,s,n)}}_documentMouseMoved(e){if(console.assert("_lineNumberWithMousedDownBreakpoint"in this),"_lineNumberWithMousedDownBreakpoint"in this){e.preventDefault();var t,i=this._codeMirror.coordsChar({left:e.pageX,top:e.pageY}),n=this._codeMirror.getGutterElement().getBoundingClientRect();if((e.pageX<n.left||e.pageX>n.right||e.pageY<n.top||e.pageY>n.bottom)&&(i=null),i&&"line"in i&&(t=i.line),t!==this._lineNumberWithDraggedBreakpoint&&(this._mouseDragged=!0,"_lineNumberWithDraggedBreakpoint"in this&&(this._previousColumnBreakpointInfo?this._setColumnBreakpointInfoForLine(this._lineNumberWithDraggedBreakpoint,this._previousColumnBreakpointInfo):this._removeBreakpointFromLineAndColumn(this._lineNumberWithDraggedBreakpoint,this._columnNumberWithDraggedBreakpoint),delete this._previousColumnBreakpointInfo,delete this._lineNumberWithDraggedBreakpoint,delete this._columnNumberWithDraggedBreakpoint),t!==void 0)){var s={},a=t===this._lineNumberWithMousedDownBreakpoint?this._columnNumberWithDraggedBreakpoint:0;s[a]=this._draggingBreakpointInfo,this._previousColumnBreakpointInfo=this._allColumnBreakpointInfoForLine(t),this._setColumnBreakpointInfoForLine(t,s),this._lineNumberWithDraggedBreakpoint=t,this._columnNumberWithDraggedBreakpoint=a}}}_documentMouseUp(e){if(console.assert("_lineNumberWithMousedDownBreakpoint"in this),"_lineNumberWithMousedDownBreakpoint"in this){e.preventDefault(),document.removeEventListener("mousemove",this._documentMouseMovedEventListener,!0),document.removeEventListener("mouseup",this._documentMouseUpEventListener,!0);var t=this._delegate&&typeof this._delegate.textEditorBreakpointClicked=="function",i=this._delegate&&typeof this._delegate.textEditorBreakpointRemoved=="function",n=this._delegate&&typeof this._delegate.textEditorBreakpointMoved=="function";if(this._mouseDragged){if(!("_lineNumberWithDraggedBreakpoint"in this))i&&(this._ignoreSetBreakpointInfoCalls=!0,this._delegate.textEditorBreakpointRemoved(this,this._lineNumberWithMousedDownBreakpoint,this._columnNumberWithMousedDownBreakpoint),delete this._ignoreSetBreakpointInfoCalls);else if(this._lineNumberWithMousedDownBreakpoint!==this._lineNumberWithDraggedBreakpoint){if(this._previousColumnBreakpointInfo&&i){this._ignoreSetBreakpointInfoCalls=!0;for(var s in this._previousColumnBreakpointInfo)this._delegate.textEditorBreakpointRemoved(this,this._lineNumberWithDraggedBreakpoint,s);delete this._ignoreSetBreakpointInfoCalls}n&&(this._ignoreSetBreakpointInfoCalls=!0,this._delegate.textEditorBreakpointMoved(this,this._lineNumberWithMousedDownBreakpoint,this._columnNumberWithMousedDownBreakpoint,this._lineNumberWithDraggedBreakpoint,this._columnNumberWithDraggedBreakpoint),delete this._ignoreSetBreakpointInfoCalls)}}else console.assert(this._lineNumberWithMousedDownBreakpoint in this._breakpoints),console.assert(this._columnNumberWithMousedDownBreakpoint in this._breakpoints[this._lineNumberWithMousedDownBreakpoint]),this._lineNumberWithMousedDownBreakpoint in this._breakpoints&&this._columnNumberWithMousedDownBreakpoint in this._breakpoints[this._lineNumberWithMousedDownBreakpoint]&&t&&this._delegate.textEditorBreakpointClicked(this,this._lineNumberWithMousedDownBreakpoint,this._columnNumberWithMousedDownBreakpoint);delete this._documentMouseMovedEventListener,delete this._documentMouseUpEventListener,delete this._lineNumberWithMousedDownBreakpoint,delete this._lineNumberWithDraggedBreakpoint,delete this._columnNumberWithMousedDownBreakpoint,delete this._columnNumberWithDraggedBreakpoint,delete this._previousColumnBreakpointInfo,delete this._mouseDragged}}_openClickedLinks(e){if(!(!this.readOnly&&!e.commandOrControlKey)){var t=this._codeMirror.coordsChar({left:e.pageX,top:e.pageY}),i=this._codeMirror.getTokenAt(t);if(!(!i||!i.type||!i.string)&&!!/\blink\b/.test(i.type)){var n=i.string,s="";this._delegate&&typeof this._delegate.textEditorBaseURL=="function"&&(s=this._delegate.textEditorBaseURL(this)),WI.openURL(absoluteURL(n,s)),e.preventDefault(),e.stopPropagation()}}}_isPositionVisible(e){var t=this._codeMirror.getScrollInfo(),i=t.top,n=i+t.clientHeight,s=this._codeMirror.charCoords(e,"local");return s.top>=i&&s.bottom<=n}_scrollIntoViewCentered(e){var t=this._codeMirror.getScrollInfo(),i=Math.ceil(this._codeMirror.defaultTextHeight()),n=Math.floor((t.clientHeight-i)/2);this._codeMirror.scrollIntoView(e,n)}};WI.TextEditor.HighlightedStyleClassName="highlighted";WI.TextEditor.SearchResultStyleClassName="search-result";WI.TextEditor.HasBreakpointStyleClassName="has-breakpoint";WI.TextEditor.BreakpointResolvedStyleClassName="breakpoint-resolved";WI.TextEditor.BreakpointAutoContinueStyleClassName="breakpoint-auto-continue";WI.TextEditor.BreakpointDisabledStyleClassName="breakpoint-disabled";WI.TextEditor.MultipleBreakpointsStyleClassName="multiple-breakpoints";WI.TextEditor.ExecutionLineStyleClassName="execution-line";WI.TextEditor.BouncyHighlightStyleClassName="bouncy-highlight";WI.TextEditor.NumberOfFindsPerSearchBatch=10;WI.TextEditor.HighlightAnimationDuration=2e3;WI.TextEditor.Event={Focused:"text-editor-focused",ExecutionLineNumberDidChange:"text-editor-execution-line-number-did-change",NumberOfSearchResultsDidChange:"text-editor-number-of-search-results-did-change",ContentDidChange:"text-editor-content-did-change",FormattingDidChange:"text-editor-formatting-did-change",MIMETypeChanged:"text-editor-mime-type-changed"};WI.TimelineOverviewGraph=class extends WI.View{constructor(e){super(),this.element.classList.add("timeline-overview-graph"),this._zeroTime=0,this._startTime=0,this._endTime=5,this._currentTime=0,this._timelineOverview=e,this._selectedRecord=null,this._selectedRecordBar=null,this._scheduledSelectedRecordLayoutUpdateIdentifier=void 0,this._selected=!1,this._visible=!0}static createForTimeline(e,t){console.assert(e instanceof WI.Timeline,e),console.assert(t instanceof WI.TimelineOverview,t);var i=e.type;if(i===WI.TimelineRecord.Type.Network)return new WI.NetworkTimelineOverviewGraph(e,t);if(i===WI.TimelineRecord.Type.Layout)return new WI.LayoutTimelineOverviewGraph(e,t);if(i===WI.TimelineRecord.Type.Script)return new WI.ScriptTimelineOverviewGraph(e,t);if(i===WI.TimelineRecord.Type.RenderingFrame)return new WI.RenderingFrameTimelineOverviewGraph(e,t);if(i===WI.TimelineRecord.Type.CPU)return new WI.CPUTimelineOverviewGraph(e,t);if(i===WI.TimelineRecord.Type.Memory)return new WI.MemoryTimelineOverviewGraph(e,t);if(i===WI.TimelineRecord.Type.HeapAllocations)return new WI.HeapAllocationsTimelineOverviewGraph(e,t);if(i===WI.TimelineRecord.Type.Media)return new WI.MediaTimelineOverviewGraph(e,t);throw new Error("Can't make a graph for an unknown timeline.")}get zeroTime(){return this._zeroTime}set zeroTime(e){e=e||0,this._zeroTime!==e&&(this._zeroTime=e,this.needsLayout())}get startTime(){return this._startTime}set startTime(e){e=e||0,this._startTime!==e&&(this._startTime=e,this.needsLayout())}get endTime(){return this._endTime}set endTime(e){e=e||0,this._endTime!==e&&(this._endTime=e,this.needsLayout())}get currentTime(){return this._currentTime}set currentTime(e){if(e=e||0,this._currentTime===e)return;let t=this._currentTime;this._currentTime=e,(this._startTime<=t&&t<=this._endTime||this._startTime<=this._currentTime&&this._currentTime<=this._endTime)&&this.needsLayout()}get timelineOverview(){return this._timelineOverview}get secondsPerPixel(){return this._timelineOverview.secondsPerPixel}get visible(){return this._visible}get selectedRecord(){return this._selectedRecord}set selectedRecord(e){this._selectedRecord!==e&&(this._selectedRecord=e,this._needsSelectedRecordLayout())}get selectedRecordBar(){return this._selectedRecordBar}set selectedRecordBar(e){this._selectedRecordBar!==e&&(this._selectedRecordBar&&(this._selectedRecordBar.selected=!1),this._selectedRecordBar=e,this._selectedRecordBar&&(this._selectedRecordBar.selected=!0,console.assert(this._selectedRecordBar.records.includes(this._selectedRecord))))}get height(){return 36}get selected(){return this._selected}set selected(e){this._selected!==e&&(this._selected=e,this.element.classList.toggle("selected",this._selected))}shown(){this._visible||(this._visible=!0,this.element.classList.toggle("hidden",!this._visible),this.updateLayout())}hidden(){!this._visible||(this._visible=!1,this.element.classList.toggle("hidden",!this._visible))}reset(){}recordWasFiltered(e,t){}needsLayout(){!this._visible||super.needsLayout()}didLayoutSubtree(){super.didLayoutSubtree(),this.updateSelectedRecord()}timelineRecordBarClicked(e){this.selectedRecord=e.records[0]}updateSelectedRecord(){}_needsSelectedRecordLayout(){this.layoutPending||this._scheduledSelectedRecordLayoutUpdateIdentifier||(this._scheduledSelectedRecordLayoutUpdateIdentifier=requestAnimationFrame(()=>{this._scheduledSelectedRecordLayoutUpdateIdentifier=void 0,this.updateSelectedRecord(),this.dispatchEventToListeners(WI.TimelineOverviewGraph.Event.RecordSelected,{record:this.selectedRecord,recordBar:this.selectedRecordBar})}))}};WI.TimelineOverviewGraph.Event={RecordSelected:"timeline-overview-graph-record-selected"};WI.TimelineView=class extends WI.ContentView{constructor(e){super(e),console.assert(this.constructor!==WI.TimelineView&&this instanceof WI.TimelineView),this.element.classList.add("timeline-view"),this._zeroTime=0,this._startTime=0,this._endTime=5,this._currentTime=0}get scrollableElements(){return this._timelineDataGrid?[this._timelineDataGrid.scrollContainer]:[]}get showsLiveRecordingData(){return!0}get showsImportedRecordingMessage(){return!1}get showsFilterBar(){return!0}get navigationItems(){return this._scopeBar?[this._scopeBar]:[]}get selectionPathComponents(){return null}get zeroTime(){return this._zeroTime}set zeroTime(e){e=e||0,this._zeroTime!==e&&(this._zeroTime=e,this._timesDidChange())}get startTime(){return this._startTime}set startTime(e){e=e||0,this._startTime!==e&&(this._startTime=e,this._timesDidChange(),this._scheduleFilterDidChange())}get endTime(){return this._endTime}set endTime(e){e=e||0,this._endTime!==e&&(this._endTime=e,this._timesDidChange(),this._scheduleFilterDidChange())}get currentTime(){return this._currentTime}set currentTime(e){if(e=e||0,this._currentTime===e)return;let t=this._currentTime;this._currentTime=e;function i(n){return this._startTime-.05<=n&&n<=this._endTime+.05}(i.call(this,t)||i.call(this,this._currentTime))&&this._timesDidChange()}get filterStartTime(){return this.startTime}get filterEndTime(){return this.endTime}setupDataGrid(e){this._timelineDataGrid&&(this._timelineDataGrid.filterDelegate=null,this._timelineDataGrid.removeEventListener(WI.DataGrid.Event.SelectedNodeChanged,this._timelineDataGridSelectedNodeChanged,this),this._timelineDataGrid.removeEventListener(WI.DataGrid.Event.NodeWasFiltered,this._timelineDataGridNodeWasFiltered,this),this._timelineDataGrid.removeEventListener(WI.DataGrid.Event.FilterDidChange,this.filterDidChange,this)),this._timelineDataGrid=e,this._timelineDataGrid.filterDelegate=this,this._timelineDataGrid.addEventListener(WI.DataGrid.Event.SelectedNodeChanged,this._timelineDataGridSelectedNodeChanged,this),this._timelineDataGrid.addEventListener(WI.DataGrid.Event.NodeWasFiltered,this._timelineDataGridNodeWasFiltered,this),this._timelineDataGrid.addEventListener(WI.DataGrid.Event.FilterDidChange,this.filterDidChange,this)}selectRecord(e){if(!this._timelineDataGrid)return;let t=this._timelineDataGrid.selectedNode;if(!e){t&&t.deselect();return}let i=this._timelineDataGrid.findNode(n=>n.record===e);console.assert(i,"Timeline view has no grid node for record selected in timeline overview.",this,e),!(!i||i.selected)&&(t&&t.hasAncestor(i)||i.revealAndSelect())}reset(){}updateFilter(e){!this._timelineDataGrid||(this._timelineDataGrid.filterText=e?e.text:"")}matchDataGridNodeAgainstCustomFilters(e){return!0}needsLayout(){!this.visible||super.needsLayout()}dataGridMatchNodeAgainstCustomFilters(e){if(console.assert(e),!this.matchDataGridNodeAgainstCustomFilters(e))return!1;let t=this.filterStartTime,i=this.filterEndTime,n=this.currentTime;function s(a,d){return a=a||n,d=d||n,t<=d&&a<=i}if(e instanceof WI.ResourceTimelineDataGridNode){let a=e.resource;return s(a.requestSentTimestamp,a.finishedOrFailedTimestamp)}if(e instanceof WI.SourceCodeTimelineTimelineDataGridNode){let a=e.sourceCodeTimeline;if(!s(a.startTime,a.endTime))return!1;for(let d of a.records)if(s(d.startTime,d.endTime))return!0;return!1}if(e instanceof WI.ProfileNodeDataGridNode){let a=e.profileNode;return!!s(a.startTime,a.endTime)}if(e instanceof WI.TimelineDataGridNode){let a=e.record;return s(a.startTime,a.endTime)}return e instanceof WI.ProfileDataGridNode?e.callingContextTreeNode.hasStackTraceInTimeRange(t,i):(console.error("Unknown DataGridNode, can't filter by time."),!0)}filterDidChange(){}_timelineDataGridSelectedNodeChanged(e){this.dispatchEventToListeners(WI.ContentView.Event.SelectionPathComponentsDidChange)}_timelineDataGridNodeWasFiltered(e){let t=e.data.node;t instanceof WI.TimelineDataGridNode&&this.dispatchEventToListeners(WI.TimelineView.Event.RecordWasFiltered,{record:t.record,filtered:t.hidden})}_timesDidChange(){(!WI.timelineManager.isCapturing()||this.showsLiveRecordingData)&&this.needsLayout()}_scheduleFilterDidChange(){!this._timelineDataGrid||this._updateFilterTimeout||(this._updateFilterTimeout=setTimeout(()=>{this._updateFilterTimeout=void 0,this._timelineDataGrid.filterDidChange()},0))}};WI.TimelineView.Event={RecordWasFiltered:"timeline-view-record-was-filtered",RecordWasSelected:"timeline-view-record-was-selected",ScannerShow:"timeline-view-scanner-show",ScannerHide:"timeline-view-scanner-hide",NeedsEntireSelectedRange:"timeline-view-needs-entire-selected-range"};WI.TreeElement=class extends WI.Object{constructor(e,t,i={}){super(),this._title=e,this.representedObject=t||{},this.representedObject.__treeElementIdentifier?this.identifier=this.representedObject.__treeElementIdentifier:(this.identifier=WI.TreeOutline._knownTreeElementNextIdentifier++,this.representedObject.__treeElementIdentifier=this.identifier),this._hidden=!1,this._selectable=!0,this.expanded=!1,this.selected=!1,this.hasChildren=i.hasChildren,this.children=[],this.treeOutline=null,this.parent=null,this.previousSibling=null,this.nextSibling=null,this._listItemNode=null}appendChild(){return WI.TreeOutline.prototype.appendChild.apply(this,arguments)}insertChild(){return WI.TreeOutline.prototype.insertChild.apply(this,arguments)}removeChild(){return WI.TreeOutline.prototype.removeChild.apply(this,arguments)}removeChildAtIndex(){return WI.TreeOutline.prototype.removeChildAtIndex.apply(this,arguments)}removeChildren(){return WI.TreeOutline.prototype.removeChildren.apply(this,arguments)}selfOrDescendant(){return WI.TreeOutline.prototype.selfOrDescendant.apply(this,arguments)}get arrowToggleWidth(){return 10}get selectable(){return this._hidden?!1:this._selectable}set selectable(e){this._selectable=e}get listItemElement(){return this._listItemNode}get title(){return this._title}set title(e){this._title=e,this._setListItemNodeContent(),this.didChange()}get titleHTML(){return this._titleHTML}set titleHTML(e){this._titleHTML=e,this._setListItemNodeContent(),this.didChange()}get tooltip(){return this._tooltip}set tooltip(e){this._tooltip=e,this._listItemNode&&(this._listItemNode.title=e||"")}get hasChildren(){return this._hasChildren}set hasChildren(e){this._hasChildren!==e&&(this._hasChildren=e,this._listItemNode&&(e?this._listItemNode.classList.add("parent"):(this._listItemNode.classList.remove("parent"),this.collapse()),this.didChange()))}get hidden(){return this._hidden}set hidden(e){this._hidden!==e&&(this._hidden=e,this._listItemNode&&(this._listItemNode.hidden=this._hidden),this._childrenListNode&&(this._childrenListNode.hidden=this._hidden),this.treeOutline&&(this.treeOutline.virtualized&&this.treeOutline.updateVirtualizedElementsDebouncer.delayForFrame(),this.treeOutline.dispatchEventToListeners(WI.TreeOutline.Event.ElementVisibilityDidChange,{element:this})))}get shouldRefreshChildren(){return this._shouldRefreshChildren}set shouldRefreshChildren(e){this._shouldRefreshChildren=e,e&&this.expanded&&this.expand()}get previousSelectableSibling(){let e=this.previousSibling;for(;e&&!e.selectable;)e=e.previousSibling;return e}get nextSelectableSibling(){let e=this.nextSibling;for(;e&&!e.selectable;)e=e.nextSibling;return e}canSelectOnMouseDown(e){return!0}_fireDidChange(){this.treeOutline&&this.treeOutline._treeElementDidChange(this)}didChange(){!this.treeOutline||(this._fireDidChangeDebouncer||(this._fireDidChangeDebouncer=new Debouncer(()=>{this._fireDidChange()})),this._fireDidChangeDebouncer.delayForFrame())}_setListItemNodeContent(){!this._listItemNode||(!this._titleHTML&&!this._title?this._listItemNode.removeChildren():typeof this._titleHTML=="string"?this._listItemNode.innerHTML=this._titleHTML:typeof this._title=="string"?this._listItemNode.textContent=this._title:(this._listItemNode.removeChildren(),this._title.parentNode&&this._title.parentNode.removeChild(this._title),this._listItemNode.appendChild(this._title)))}_attach(){(!this._listItemNode||this.parent._shouldRefreshChildren)&&(this._listItemNode&&this._listItemNode.parentNode&&this._listItemNode.parentNode.removeChild(this._listItemNode),this._listItemNode=this.treeOutline._childrenListNode.ownerDocument.createElement("li"),this._listItemNode.treeElement=this,this._setListItemNodeContent(),this._listItemNode.title=this._tooltip?this._tooltip:"",this._listItemNode.hidden=this.hidden,this.hasChildren&&this._listItemNode.classList.add("parent"),this.expanded&&this._listItemNode.classList.add("expanded"),this.selected&&this._listItemNode.classList.add("selected"),this._listItemNode.addEventListener("click",WI.TreeElement.treeElementToggled),this._listItemNode.addEventListener("dblclick",WI.TreeElement.treeElementDoubleClicked),this.onattach&&this.onattach(this));var e=null;this.nextSibling&&this.nextSibling._listItemNode&&this.nextSibling._listItemNode.parentNode===this.parent._childrenListNode&&(e=this.nextSibling._listItemNode),(!this.treeOutline||!this.treeOutline.virtualized)&&(this.parent._childrenListNode.insertBefore(this._listItemNode,e),this._childrenListNode&&this.parent._childrenListNode.insertBefore(this._childrenListNode,this._listItemNode.nextSibling)),this.selected&&this.select(),this.expanded&&this.expand()}_detach(){this.ondetach&&this.ondetach(this),this._listItemNode&&this._listItemNode.parentNode&&this._listItemNode.parentNode.removeChild(this._listItemNode),this._childrenListNode&&this._childrenListNode.parentNode&&this._childrenListNode.parentNode.removeChild(this._childrenListNode)}static treeElementToggled(e){let t=e.currentTarget;if(!t)return;let i=t.treeElement;if(!i)return;(i.toggleOnClick&&!i.selectable||i.isEventWithinDisclosureTriangle(e))&&(i.expanded?e.altKey?i.collapseRecursively():i.collapse():e.altKey?i.expandRecursively():i.expand(),e.stopPropagation()),i.treeOutline.selectable||i.treeOutline.dispatchEventToListeners(WI.TreeOutline.Event.ElementClicked,{treeElement:i})}static treeElementDoubleClicked(e){var t=e.currentTarget;!t||!t.treeElement||t.treeElement.isEventWithinDisclosureTriangle(e)||t.treeElement.dispatchEventToListeners(WI.TreeElement.Event.DoubleClick)||(t.treeElement.ondblclick?t.treeElement.ondblclick.call(t.treeElement,e):t.treeElement.hasChildren&&!t.treeElement.expanded&&t.treeElement.expand())}collapse(){this._listItemNode&&this._listItemNode.classList.remove("expanded"),this._childrenListNode&&this._childrenListNode.classList.remove("expanded"),this.expanded=!1,this.treeOutline&&(this.treeOutline._treeElementsExpandedState[this.identifier]=!1),this.oncollapse&&this.oncollapse(this),this.treeOutline&&(this.treeOutline.virtualized&&this.treeOutline.updateVirtualizedElementsDebouncer.delayForFrame(),this.treeOutline.dispatchEventToListeners(WI.TreeOutline.Event.ElementDisclosureDidChanged,{element:this}))}collapseRecursively(){for(var e=this;e;)e.expanded&&e.collapse(),e=e.traverseNextTreeElement(!1,this,!0)}expand(){if(!(this.expanded&&!this._shouldRefreshChildren&&this._childrenListNode)&&(this.expanded=!0,this.treeOutline&&(this.treeOutline._treeElementsExpandedState[this.identifier]=!0),!!this.hasChildren)){if(this.treeOutline&&(!this._childrenListNode||this._shouldRefreshChildren)){this._childrenListNode&&this._childrenListNode.parentNode&&this._childrenListNode.parentNode.removeChild(this._childrenListNode),this._childrenListNode=this.treeOutline._childrenListNode.ownerDocument.createElement("ol"),this._childrenListNode.parentTreeElement=this,this._childrenListNode.classList.add("children"),this._childrenListNode.hidden=this.hidden,this.onpopulate(),this.expanded=!0;for(var e=0;e<this.children.length;++e)this.children[e]._attach();this._shouldRefreshChildren=!1}this._listItemNode&&(this._listItemNode.classList.add("expanded"),this._childrenListNode&&this._childrenListNode.parentNode!==this._listItemNode.parentNode&&this.parent._childrenListNode.insertBefore(this._childrenListNode,this._listItemNode.nextSibling)),this._childrenListNode&&this._childrenListNode.classList.add("expanded"),this.onexpand&&this.onexpand(this),this.treeOutline&&(this.treeOutline.virtualized&&this.treeOutline.updateVirtualizedElementsDebouncer.delayForFrame(),this.treeOutline.dispatchEventToListeners(WI.TreeOutline.Event.ElementDisclosureDidChanged,{element:this}))}}expandRecursively(e){var t=this,i={},n=0;for(e===void 0&&(e=3);t;)n<e&&t.expand(),t=t.traverseNextTreeElement(!1,this,n>=e,i),n+=i.depthChange}hasAncestor(e){if(!e)return!1;for(var t=this.parent;t;){if(e===t)return!0;t=t.parent}return!1}reveal(){for(var e=this.parent;e&&!e.root;)e.expanded||e.expand(),e=e.parent;this.treeOutline&&this.treeOutline.virtualized&&this.treeOutline.updateVirtualizedElementsDebouncer.force(this),this.onreveal&&this.onreveal(this),this.treeOutline&&this.treeOutline.dispatchEventToListeners(WI.TreeOutline.Event.ElementRevealed,{element:this})}revealed(e){if(!e&&this.hidden)return!1;for(var t=this.parent;t&&!t.root;){if(!t.expanded||!e&&t.hidden)return!1;t=t.parent}return!0}select(e,t,i){if(!this.treeOutline||!this.selectable||this.selected&&!this.treeOutline.allowsRepeatSelection)return;e||this.treeOutline._childrenListNode.focus();let n=this.treeOutline;!n||(this.selected=!0,n.selectTreeElementInternal(this,i,t))}revealAndSelect(e,t,i){this.reveal(),this.select(e,t,i)}deselect(e){return!this.treeOutline||!this.selected?!1:(this.selected=!1,this.treeOutline.selectTreeElementInternal(null,e),!0)}onpopulate(){}traverseNextTreeElement(e,t,i,n){function s(p){return e&&!p.revealed(!0)}var a=0,d=this;i||d.onpopulate();do if(d.hasChildren&&d.children[0]&&(!e||d.expanded))d=d.children[0],a+=1;else{for(;d&&!d.nextSibling&&d.parent&&!d.parent.root&&d.parent!==t;)d=d.parent,a-=1;d&&(d=d.nextSibling)}while(d&&s(d));return n&&(n.depthChange=a),d}traversePreviousTreeElement(e,t){function i(s){return e&&!s.revealed(!0)}var n=this;do if(n.previousSibling)for(n=n.previousSibling;n&&n.hasChildren&&n.expanded&&!i(n);)t||n.onpopulate(),n=n.children.lastValue;else n=n.parent&&n.parent.root?null:n.parent;while(n&&i(n));return n}isEventWithinDisclosureTriangle(e){if(!document.contains(this._listItemNode))return!1;let t=window.getComputedStyle(this._listItemNode),i=0;return WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?i+=this._listItemNode.totalOffsetRight-t.getPropertyCSSValue("padding-right").getFloatValue(CSSPrimitiveValue.CSS_PX)-this.arrowToggleWidth:i+=this._listItemNode.totalOffsetLeft+t.getPropertyCSSValue("padding-left").getFloatValue(CSSPrimitiveValue.CSS_PX),e.pageX>=i&&e.pageX<=i+this.arrowToggleWidth&&this.hasChildren}populateContextMenu(e,t){(this.children.some(i=>i.hasChildren)||this.hasChildren&&!this.children.length)&&(e.appendSeparator(),e.appendItem(WI.UIString("Expand All"),this.expandRecursively.bind(this)),e.appendItem(WI.UIString("Collapse All"),this.collapseRecursively.bind(this)))}};WI.TreeElement.Event={DoubleClick:"tree-element-double-click"};WI.TreeOutline=class extends WI.Object{constructor(e=!0){super(),this.element=document.createElement("ol"),this.element.classList.add(WI.TreeOutline.ElementStyleClassName),this.element.addEventListener("contextmenu",this._handleContextmenu.bind(this)),this.children=[],this._childrenListNode=this.element,this._childrenListNode.removeChildren(),this._knownTreeElements=[],this._treeElementsExpandedState=[],this.allowsRepeatSelection=!1,this.root=!0,this.hasChildren=!1,this.expanded=!0,this.selected=!1,this.treeOutline=this,this._hidden=!1,this._compact=!1,this._large=!1,this._disclosureButtons=!0,this._customIndent=!1,this._selectable=e,this._cachedNumberOfDescendents=0,this._previousSelectedTreeElement=null;let t=(i,n)=>{function s(f){let _=0;for(;f=f.parent;)_++;return _}function a(f,_){return f.parent.children.indexOf(f)-f.parent.children.indexOf(_)}if(i=this.getCachedTreeElement(i),n=this.getCachedTreeElement(n),!i||!n)return 0;if(i.parent===n.parent)return a(i,n);let d=s(i),p=s(n);for(;d>p;){if(i.parent===n)return 1;i=i.parent,d--}for(;p>d;){if(n.parent===i)return-1;n=n.parent,p--}for(;i.parent!==n.parent;)i=i.parent,n=n.parent;return console.assert(i.parent===n.parent,"Missing common ancestor for TreeElements.",i,n),a(i,n)};this._selectionController=new WI.SelectionController(this,t),this._itemWasSelectedByUser=!1,this._processingSelectionChange=!1,this._suppressNextSelectionDidChangeEvent=!1,this._virtualizedDebouncer=null,this._virtualizedVisibleTreeElements=null,this._virtualizedAttachedTreeElements=null,this._virtualizedScrollContainer=null,this._virtualizedTreeItemHeight=NaN,this._virtualizedTopSpacer=null,this._virtualizedBottomSpacer=null,this._childrenListNode.tabIndex=0,this._childrenListNode.addEventListener("keydown",this._treeKeyDown.bind(this),!0),this._childrenListNode.addEventListener("mousedown",this._handleMouseDown.bind(this)),WI.TreeOutline._generateStyleRulesIfNeeded(),this._selectable||this.element.classList.add("non-selectable")}get allowsEmptySelection(){return this._selectionController.allowsEmptySelection}set allowsEmptySelection(e){this._selectionController.allowsEmptySelection=e}get allowsMultipleSelection(){return this._selectionController.allowsMultipleSelection}set allowsMultipleSelection(e){this._selectionController.allowsMultipleSelection=e}get selectedTreeElement(){return this.getCachedTreeElement(this._selectionController.lastSelectedItem)}set selectedTreeElement(e){e?this._selectionController.selectItem(this.objectForSelection(e)):this._selectionController.deselectAll()}get selectedTreeElements(){if(this.allowsMultipleSelection){let t=[];for(let i of this._selectionController.selectedItems)t.push(this.getCachedTreeElement(i));return t}let e=this.selectedTreeElement;return e?[e]:[]}get processingSelectionChange(){return this._processingSelectionChange}get hidden(){return this._hidden}set hidden(e){this._hidden!==e&&(this._hidden=e,this.element.hidden=this._hidden)}get compact(){return this._compact}set compact(e){this._compact!==e&&(this._compact=e,this._compact&&(this.large=!1),this.element.classList.toggle("compact",this._compact))}get large(){return this._large}set large(e){this._large!==e&&(this._large=e,this._large&&(this.compact=!1),this.element.classList.toggle("large",this._large))}get disclosureButtons(){return this._disclosureButtons}set disclosureButtons(e){this._disclosureButtons!==e&&(this._disclosureButtons=e,this.element.classList.toggle("hide-disclosure-buttons",!this._disclosureButtons))}get customIndent(){return this._customIndent}set customIndent(e){this._customIndent!==e&&(this._customIndent=e,this.element.classList.toggle(WI.TreeOutline.CustomIndentStyleClassName,this._customIndent))}get selectable(){return this._selectable}appendChild(e){if(console.assert(e),!!e){var t=this.children[this.children.length-1];t?(t.nextSibling=e,e.previousSibling=t):(e.previousSibling=null,e.nextSibling=null);var i=!this.children.length;this.children.push(e),this.hasChildren=!0,e.parent=this,e.treeOutline=this.treeOutline,e.treeOutline._rememberTreeElement(e);for(var n=e.children[0];n;)n.treeOutline=this.treeOutline,n.treeOutline._rememberTreeElement(n),n=n.traverseNextTreeElement(!1,e,!0);e.hasChildren&&e.treeOutline._treeElementsExpandedState[e.identifier]!==void 0&&(e.expanded=e.treeOutline._treeElementsExpandedState[e.identifier]),this._childrenListNode&&e._attach(),this.treeOutline&&this.treeOutline.dispatchEventToListeners(WI.TreeOutline.Event.ElementAdded,{element:e}),i&&this.expanded&&this.expand()}}insertChild(e,t){if(console.assert(e),!!e){var i=t>0?this.children[t-1]:null;i?(i.nextSibling=e,e.previousSibling=i):e.previousSibling=null;var n=this.children[t];n?(n.previousSibling=e,e.nextSibling=n):e.nextSibling=null;var s=!this.children.length;this.children.splice(t,0,e),this.hasChildren=!0,e.parent=this,e.treeOutline=this.treeOutline,e.treeOutline._rememberTreeElement(e);for(var a=e.children[0];a;)a.treeOutline=this.treeOutline,a.treeOutline._rememberTreeElement(a),a=a.traverseNextTreeElement(!1,e,!0);e.hasChildren&&e.treeOutline._treeElementsExpandedState[e.identifier]!==void 0&&(e.expanded=e.treeOutline._treeElementsExpandedState[e.identifier]),this._childrenListNode&&e._attach(),this.treeOutline&&this.treeOutline.dispatchEventToListeners(WI.TreeOutline.Event.ElementAdded,{element:e}),s&&this.expanded&&this.expand()}}removeChildAtIndex(e,t,i){if(console.assert(e>=0&&e<this.children.length),e<0||e>=this.children.length)return;let n=this.children[e],s=n.parent;n.deselect(t)&&(n.previousSibling&&!i?n.previousSibling.select(!0,!1):n.nextSibling&&!i?n.nextSibling.select(!0,!1):i||s.select(!0,!1));let a=n.treeOutline;a&&(a._forgetTreeElement(n),a._forgetChildrenRecursive(n)),n.previousSibling&&(n.previousSibling.nextSibling=n.nextSibling),n.nextSibling&&(n.nextSibling.previousSibling=n.previousSibling),this.children.splice(e,1),n._detach(),n.treeOutline=null,n.parent=null,n.nextSibling=null,n.previousSibling=null,a&&a.dispatchEventToListeners(WI.TreeOutline.Event.ElementRemoved,{element:n})}removeChild(e,t,i){if(console.assert(e),!!e){var n=this.children.indexOf(e);console.assert(n!==-1),n!==-1&&(this.removeChildAtIndex(n,t,i),this.children.length||(this._listItemNode&&this._listItemNode.classList.remove("parent"),this.hasChildren=!1))}}removeChildren(e){for(;this.children.length;){let t=this.children[0];t.deselect(e);let i=t.treeOutline;i&&(i._forgetTreeElement(t),i._forgetChildrenRecursive(t)),t._detach(),t.treeOutline=null,t.parent=null,t.nextSibling=null,t.previousSibling=null,this.children.shift(),i&&i.dispatchEventToListeners(WI.TreeOutline.Event.ElementRemoved,{element:t})}}_rememberTreeElement(e){this._knownTreeElements[e.identifier]||(this._knownTreeElements[e.identifier]=[]);var t=this._knownTreeElements[e.identifier];t.includes(e)||(t.push(e),this._cachedNumberOfDescendents++),this.virtualized&&this._virtualizedDebouncer.delayForFrame()}_forgetTreeElement(e){this.selectedTreeElement===e&&(e.deselect(!0),this.selectedTreeElement=null),this._knownTreeElements[e.identifier]&&this._knownTreeElements[e.identifier].remove(e)&&this._cachedNumberOfDescendents--,this.virtualized&&this._virtualizedDebouncer.delayForFrame()}_forgetChildrenRecursive(e){for(var t=e.children[0];t;)this._forgetTreeElement(t),t=t.traverseNextTreeElement(!1,e,!0)}getCachedTreeElement(e){if(!e)return null;if(e.__proxyObjectTreeElement)return e.__proxyObjectTreeElement;if(e.__treeElementIdentifier){var t=this._knownTreeElements[e.__treeElementIdentifier];if(t){for(var i=0;i<t.length;++i)if(t[i].representedObject===e)return t[i]}}return null}selfOrDescendant(e){let t=[this];for(;t.length;){let i=t.shift();if(e(i))return i;t=t.concat(i.children)}return!1}findTreeElement(e,t,i){if(!e)return null;var n=this.getCachedTreeElement(e);if(n)return n;for(var s,a=!1,d=0;d<this.children.length;++d)if(s=this.children[d],s.representedObject===e||t&&t(s.representedObject,e)){a=!0;break}if(!a)return null;for(var p=[],f=e;f&&(p.unshift(f),f!==s.representedObject);)f=i(f);for(var d=0;d<p.length;++d)p[d]!==e&&(s=this.findTreeElement(p[d],t,i),s&&s.onpopulate());return this.getCachedTreeElement(e)}_treeElementDidChange(e){e.treeOutline===this&&this.dispatchEventToListeners(WI.TreeOutline.Event.ElementDidChange,{element:e})}treeElementFromNode(e){var t=e.closest("ol, li");return t?t.parentTreeElement||t.treeElement:null}treeElementFromPoint(e,t){var i=this._childrenListNode.ownerDocument.elementFromPoint(e,t);return i?this.treeElementFromNode(i):null}_treeKeyDown(e){if(e.target!==this._childrenListNode)return;let t=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL,i=t?"Left":"Right",n=t?"Right":"Left";var s=!1,a;if(this.selectedTreeElement)if(e.keyIdentifier===n){if(this.selectedTreeElement.expanded)e.altKey?this.selectedTreeElement.collapseRecursively():this.selectedTreeElement.collapse(),s=!0;else if(this.selectedTreeElement.parent&&!this.selectedTreeElement.parent.root)if(s=!0,this.selectedTreeElement.parent.selectable){for(a=this.selectedTreeElement.parent;a&&!a.selectable;)a=a.parent;s=!!a}else this.selectedTreeElement.parent&&this.selectedTreeElement.parent.collapse()}else if(e.keyIdentifier===i){if(!this.selectedTreeElement.revealed())this.selectedTreeElement.reveal(),s=!0;else if(this.selectedTreeElement.hasChildren)if(s=!0,this.selectedTreeElement.expanded){for(a=this.selectedTreeElement.children[0];a&&!a.selectable;)a=a.nextSibling;s=!!a}else e.altKey?this.selectedTreeElement.expandRecursively():this.selectedTreeElement.expand()}else if(e.keyCode===8||e.keyCode===46){for(let d of this.selectedTreeElements)d.ondelete&&d.ondelete()&&(s=!0);!s&&this.treeOutline.ondelete&&(s=this.treeOutline.ondelete(this.selectedTreeElement))}else isEnterKey(e)?(this.selectedTreeElement.onenter&&(s=this.selectedTreeElement.onenter()),!s&&this.treeOutline.onenter&&(s=this.treeOutline.onenter(this.selectedTreeElement))):e.keyIdentifier==="U+0020"&&(this.selectedTreeElement.onspace&&(s=this.selectedTreeElement.onspace()),!s&&this.treeOutline.onspace&&(s=this.treeOutline.onspace(this.selectedTreeElement)));s||(this._itemWasSelectedByUser=!0,s=this._selectionController.handleKeyDown(e),this._itemWasSelectedByUser=!1,s&&(a=this.selectedTreeElement)),a&&(a.reveal(),a.select(!1,!0)),s&&(e.preventDefault(),e.stopPropagation())}expand(){}collapse(){}revealed(){return!0}reveal(){}select(){}revealAndSelect(e){}selectTreeElements(e){if(!e.length)return;if(e.length===1){this.selectedTreeElement=e[0];return}if(console.assert(this.allowsMultipleSelection,"Cannot select TreeElements with multiple selection disabled."),!this.allowsMultipleSelection)return;let t=e.map(i=>this.objectForSelection(i));this._selectionController.selectItems(new Set(t))}get selectedTreeElementIndex(){if(!(!this.hasChildren||!this.selectedTreeElement)){for(var e=0;e<this.children.length;++e)if(this.children[e]===this.selectedTreeElement)return e;return!1}}get virtualized(){return this._virtualizedScrollContainer&&!isNaN(this._virtualizedTreeItemHeight)}registerScrollVirtualizer(e,t){console.assert(e),console.assert(!isNaN(t)),console.assert(!this.virtualized);let i=s=>{this._updateVirtualizedElements(s)};this._virtualizedDebouncer=new Debouncer(i),this._virtualizedVisibleTreeElements=new Set,this._virtualizedAttachedTreeElements=new Set,this._virtualizedScrollContainer=e,this._virtualizedTreeItemHeight=t,this._virtualizedTopSpacer=document.createElement("div"),this._virtualizedBottomSpacer=document.createElement("div");let n=new Throttler(i,1e3/16);this._virtualizedScrollContainer.addEventListener("scroll",s=>{n.fire()}),this._updateVirtualizedElements()}get updateVirtualizedElementsDebouncer(){return this._virtualizedDebouncer}selectionControllerNumberOfItems(e){return this._cachedNumberOfDescendents}selectionControllerSelectionDidChange(e,t,i){this._processingSelectionChange=!0;for(let s of t){let a=this.getCachedTreeElement(s);!a||(a.listItemElement&&a.listItemElement.classList.remove("selected"),a.deselect())}for(let s of i){let a=this.getCachedTreeElement(s);if(!a)continue;a.listItemElement&&a.listItemElement.classList.add("selected");const d=!0;a.select(d)}let n=this.selectedTreeElement;n!==this._previousSelectedTreeElement&&(this._previousSelectedTreeElement&&this._previousSelectedTreeElement.listItemElement&&this._previousSelectedTreeElement.listItemElement.classList.remove("last-selected"),this._previousSelectedTreeElement=n,this._previousSelectedTreeElement&&this._previousSelectedTreeElement.listItemElement&&this._previousSelectedTreeElement.listItemElement.classList.add("last-selected")),this._dispatchSelectionDidChangeEvent(),this._processingSelectionChange=!1}selectionControllerFirstSelectableItem(e){let t=this.children[0];return t.selectable?t.representedObject:this.selectionControllerNextSelectableItem(e,t.representedObject)}selectionControllerLastSelectableItem(e){let t=this.children.lastValue;for(;t.expanded&&t.children.length;)t=t.children.lastValue;let i=this.objectForSelection(t);return this.canSelectTreeElement(t)?i:this.selectionControllerPreviousSelectableItem(e,i)}selectionControllerPreviousSelectableItem(e,t){let i=this.getCachedTreeElement(t);if(console.assert(i,"Missing TreeElement for representedObject.",t),!i)return null;const n=!0,s=null,a=!0;for(;i=i.traversePreviousTreeElement(n,s,a);)if(this.canSelectTreeElement(i))return this.objectForSelection(i);return null}selectionControllerNextSelectableItem(e,t){let i=this.getCachedTreeElement(t);if(console.assert(i,"Missing TreeElement for representedObject.",t),!i)return null;const n=!0,s=null,a=!0;for(;i=i.traverseNextTreeElement(n,s,a);)if(this.canSelectTreeElement(i))return this.objectForSelection(i);return null}canSelectTreeElement(e){return e.selectable}objectForSelection(e){return e.representedObject}selectTreeElementInternal(e,t=!1,i=!1){if(!this._processingSelectionChange){if(this._itemWasSelectedByUser=i,this._suppressNextSelectionDidChangeEvent=t,this.allowsRepeatSelection&&this.selectedTreeElement===e){this._dispatchSelectionDidChangeEvent();return}this.selectedTreeElement=e}}treeElementFromEvent(e){let t=this.element.parentElement;t.offsetWidth>this.element.offsetWidth&&(t=this.element);let n=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?36:t.offsetWidth-36,s=t.totalOffsetLeft+n,a=e.pageY,d=this.treeElementFromPoint(s,a),p=this.treeElementFromPoint(s,a-2),f=null;return d===p?f=d:f=this.treeElementFromPoint(s,a+2),f}populateContextMenu(e,t,i){i.populateContextMenu(e,t)}static _generateStyleRulesIfNeeded(){if(WI.TreeOutline._styleElement)return;WI.TreeOutline._styleElement=document.createElement("style");let e=32,t=10,i="",n="";for(let s=1;s<=e;++s)n+=s===e?" .children":" > .children",i+=`.${WI.TreeOutline.ElementStyleClassName}:not(.${WI.TreeOutline.CustomIndentStyleClassName})${n} > .item { `,i+=`-webkit-padding-start: calc(var(--tree-outline-item-padding) + ${t*s}px);`,i+=` }
`;WI.TreeOutline._styleElement.textContent=i,document.head.appendChild(WI.TreeOutline._styleElement)}_updateVirtualizedElements(e){console.assert(this.virtualized),this._virtualizedDebouncer.cancel();function t(E,k,R=0){let M=!1;for(let L of E.children)if(!!L.revealed(!1)){if(M=k(L,R),M)break;if(++R,L.expanded){let V=t(L,k,R);if(R=V.count,V.shouldReturn)break}}return{count:R,shouldReturn:M}}function i(E,k){let R=0;for(;E!==k;)if(R+=E.offsetTop,E=E.offsetParent,!E)return 0;return R}let n=i(this._virtualizedTopSpacer.parentNode?this._virtualizedTopSpacer:this.element,this._virtualizedScrollContainer),s=Math.ceil(Math.max(0,this._virtualizedScrollContainer.offsetHeight-n)/this._virtualizedTreeItemHeight),a=Math.max(s*5,50),d=Math.floor((this._virtualizedScrollContainer.scrollTop-n)/this._virtualizedTreeItemHeight)-a,p=d+s+a*2,f=!1;if(e&&e.revealed(!1)){let E=t(this,k=>k===e).count;E<d?(d=E-a,p=E+s+a):E>p&&(d=E-s-a,p=E+a),f=E<d+a||E>p-a}console.assert(d<p);let _=new Set,b=new Set,w=new Set,S=t(this,(E,k)=>(k>=d&&k<=p?(b.add(E),k>=d+a&&k<=p-a&&_.add(E)):E._listItemNode.parentNode&&w.add(E),!1)).count;if(!(!f&&_.intersects(this._virtualizedVisibleTreeElements)&&_.isSubsetOf(this._virtualizedAttachedTreeElements))){this._virtualizedVisibleTreeElements=_,this._virtualizedAttachedTreeElements=b;for(let E of w)E._listItemNode.remove();for(let E of b)E.parent._childrenListNode.appendChild(E._listItemNode),E._childrenListNode&&E.parent._childrenListNode.appendChild(E._childrenListNode);this._virtualizedTopSpacer.style.height=Number.constrain(d,0,S)*this._virtualizedTreeItemHeight+"px",this.element.previousElementSibling!==this._virtualizedTopSpacer&&this.element.parentNode.insertBefore(this._virtualizedTopSpacer,this.element),this._virtualizedBottomSpacer.style.height=Number.constrain(S-p,0,S)*this._virtualizedTreeItemHeight+"px",this.element.nextElementSibling!==this._virtualizedBottomSpacer&&this.element.parentNode.insertBefore(this._virtualizedBottomSpacer,this.element.nextElementSibling),f&&(this._virtualizedScrollContainer.scrollTop=n+(d+a)*this._virtualizedTreeItemHeight)}}_handleContextmenu(e){let t=this.treeElementFromEvent(e);if(!t)return;let i=WI.ContextMenu.createFromEvent(e);this.populateContextMenu(i,e,t)}_handleMouseDown(e){let t=this.treeElementFromEvent(e);if(!(!t||!t.selectable)){if(t.isEventWithinDisclosureTriangle(e)){e.preventDefault();return}if(!!t.canSelectOnMouseDown(e)){if(this.allowsRepeatSelection&&t.selected&&this._selectionController.selectedItems.size===1){this._itemWasSelectedByUser=!0,this._dispatchSelectionDidChangeEvent();return}this._itemWasSelectedByUser=!0,this._selectionController.handleItemMouseDown(this.objectForSelection(t),e),this._itemWasSelectedByUser=!1}}}_dispatchSelectionDidChangeEvent(){let e=this._itemWasSelectedByUser;if(this._itemWasSelectedByUser=!1,this._suppressNextSelectionDidChangeEvent){this._suppressNextSelectionDidChangeEvent=!1;return}this.dispatchEventToListeners(WI.TreeOutline.Event.SelectionDidChange,{selectedByUser:e})}};WI.TreeOutline._styleElement=null;WI.TreeOutline.ElementStyleClassName="tree-outline";WI.TreeOutline.CustomIndentStyleClassName="custom-indent";WI.TreeOutline.Event={ElementAdded:Symbol("element-added"),ElementDidChange:Symbol("element-did-change"),ElementRemoved:Symbol("element-removed"),ElementRevealed:Symbol("element-revealed"),ElementClicked:Symbol("element-clicked"),ElementDisclosureDidChanged:Symbol("element-disclosure-did-change"),ElementVisibilityDidChange:Symbol("element-visbility-did-change"),SelectionDidChange:Symbol("selection-did-change")};WI.TreeOutline._knownTreeElementNextIdentifier=1;WI.TreeOutlineGroup=class extends WI.Collection{objectIsRequiredType(e){return e instanceof WI.TreeOutline}get selectedTreeElement(){for(let e of this)if(e.selectedTreeElement)return e.selectedTreeElement;return null}itemAdded(e){e.selectedTreeElement&&this._removeConflictingTreeSelections(e),e.addEventListener(WI.TreeOutline.Event.SelectionDidChange,this._treeOutlineSelectionDidChange,this)}itemRemoved(e){e.removeEventListener(null,null,this)}_removeConflictingTreeSelections(e){for(let t of this)e!==t&&(t.selectedTreeElement=null)}_treeOutlineSelectionDidChange(e){let t=e.target;!t.selectedTreeElement||this._removeConflictingTreeSelections(t)}};WI.LegacyTabBar=class extends WI.View{constructor(e,t){if(super(e),this.element.classList.add("tab-bar"),this.element.setAttribute("role","tablist"),this.element.addEventListener("mousedown",this._handleMouseDown.bind(this)),this.element.addEventListener("click",this._handleClick.bind(this)),this.element.addEventListener("mouseleave",this._handleMouseLeave.bind(this)),this.element.addEventListener("contextmenu",this._handleContextMenu.bind(this)),this.element.createChild("div","top-border"),this._tabBarItems=[],this._hiddenTabBarItems=[],t)for(let i in t)this.addTabBarItem(i);this.addTabBarItem(WI.settingsTabContentView.tabBarItem,{suppressAnimations:!0}),this._newTabTabBarItem=new WI.PinnedTabBarItem("data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' d='M 7.5 2 V 13 M 2 7.5 H 13'/%3e %3c/svg%3e",WI.UIString("Create a new tab")),this._newTabTabBarItem.element.addEventListener("mouseenter",this._handleNewTabMouseEnter.bind(this)),this._newTabTabBarItem.element.addEventListener("click",this._handleNewTabClick.bind(this)),this.addTabBarItem(this._newTabTabBarItem,{suppressAnimations:!0}),this._tabPickerTabBarItem=new WI.PinnedTabBarItem("data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2018 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 16'%3e %3cpath fill='none' stroke='currentColor' d='M 2 4 L 6 8 L 2 12'/%3e %3cpath fill='none' stroke='currentColor' d='M 7 4 L 11 8 L 7 12'/%3e %3c/svg%3e",WI.UIString("Show hidden tabs")),this._tabPickerTabBarItem.element.classList.add("tab-picker"),this._tabPickerTabBarItem.element.addEventListener("contextmenu",this._handleTabPickerTabContextMenu.bind(this)),this.addTabBarItem(this._tabPickerTabBarItem,{suppressAnimations:!0})}get newTabTabBarItem(){return this._newTabTabBarItem}updateNewTabTabBarItemState(){let e=!WI.isNewTabWithTypeAllowed(WI.NewTabContentView.Type);this._newTabTabBarItem.disabled=e}addTabBarItem(e,t={}){return this.insertTabBarItem(e,this._tabBarItems.length,t)}insertTabBarItem(e,t,i={}){if(console.assert(e instanceof WI.TabBarItem),!(e instanceof WI.TabBarItem)||e.parentTabBar===this)return null;if(this._tabAnimatedClosedSinceMouseEnter)return this._finishExpandingTabsAfterClose().then(()=>{this.insertTabBarItem(e,t,i)}),null;e.parentTabBar&&e.parentTabBar.removeTabBarItem(e),e.parentTabBar=this,t=Number.constrain(t,0,this.normalTabCount),this.element.classList.contains("animating")&&(requestAnimationFrame(p.bind(this)),i.suppressAnimations=!0);var n;i.suppressAnimations||(n=this._recordTabBarItemSizesAndPositions()),this._tabBarItems.splice(t,0,e);var s=this._tabBarItems[t+1];let a=s?s.element:this._tabBarItems.lastValue.element;this.element.contains(a)?this.element.insertBefore(e.element,a):this.element.appendChild(e.element),this.element.classList.toggle("single-tab",!this._hasMoreThanOneNormalTab()),e.element.style.left=null,e.element.style.width=null;function d(){this.element.classList.add("animating"),this.element.classList.add("inserting-tab"),this._applyTabBarItemSizesAndPositions(f),this.element.addEventListener("webkitTransitionEnd",_)}function p(){this.element.classList.remove("static-layout"),this.element.classList.remove("animating"),this.element.classList.remove("inserting-tab"),e.element.classList.remove("being-inserted"),this._clearTabBarItemSizesAndPositions(),this.element.removeEventListener("webkitTransitionEnd",_)}if(i.suppressAnimations)this.needsLayout();else{var f=this._recordTabBarItemSizesAndPositions();this.updateLayout();let b=this._tabBarItemsFromLeftToRight(),w=b[b.indexOf(e)-1]||null,S=w?n.get(w):null;S?n.set(e,{left:S.left+S.width,width:0}):n.set(e,{left:0,width:0}),this.element.classList.add("static-layout"),e.element.classList.add("being-inserted"),this._applyTabBarItemSizesAndPositions(n);var _=p.bind(this);requestAnimationFrame(d.bind(this))}return e instanceof WI.PinnedTabBarItem||this.updateNewTabTabBarItemState(),this.dispatchEventToListeners(WI.TabBar.Event.TabBarItemAdded,{tabBarItem:e}),e}removeTabBarItem(e,t={}){let i=this._findTabBarItem(e);if(!i||i instanceof WI.PinnedTabBarItem)return null;if(i.parentTabBar=null,this._selectedTabBarItem===i){var n=this._tabBarItems.indexOf(i),s=this._tabBarItems[n+1];(!s||s instanceof WI.PinnedTabBarItem)&&(s=this._tabBarItems[n-1]),this.selectedTabBarItem=s}this.element.classList.contains("animating")&&(requestAnimationFrame(w.bind(this)),t.suppressAnimations=!0);var a;t.suppressAnimations||(a=this._recordTabBarItemSizesAndPositions());let d=this._tabBarItems.indexOf(i)===this.normalTabCount-1;this._tabBarItems.remove(i),i.element.remove();var p=this._hasMoreThanOneNormalTab();this.element.classList.toggle("single-tab",!p);const f=!i.isDefaultTab&&!this.normalTabCount;if(f&&(t.suppressAnimations=!0),!p||d||!t.suppressExpansion)return t.suppressAnimations?this.needsLayout():(this._tabAnimatedClosedSinceMouseEnter=!0,this._finishExpandingTabsAfterClose(a)),this.updateNewTabTabBarItemState(),this.dispatchEventToListeners(WI.TabBar.Event.TabBarItemRemoved,{tabBarItem:i}),f&&this._openDefaultTab(),i;var _;function b(){this.element.classList.add("animating"),this.element.classList.add("closing-tab");let E=0;if(WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL){E=this.element.getBoundingClientRect().width;for(let R of this._tabBarItemsFromLeftToRight())E-=R.element.getBoundingClientRect().width}let k=0;for(let R of this._tabBarItemsFromLeftToRight()){let M=a.get(R);R instanceof WI.PinnedTabBarItem?k=M.left+M.width:(R.element.style.left=E+k+"px",k+=M.width,_=R)}this._selectedTabBarItem&&(this._selectedTabBarItem.element.style.width=parseFloat(this._selectedTabBarItem.element.style.width)+1+"px"),_!==this._selectedTabBarItem&&(_.element.style.width=parseFloat(_.element.style.width)+1+"px"),this.element.addEventListener("webkitTransitionEnd",S)}function w(){this._selectedTabBarItem&&this._selectedTabBarItem!==_&&(this._selectedTabBarItem.element.style.width=parseFloat(this._selectedTabBarItem.element.style.width)-1+"px"),this.element.classList.remove("animating"),this.element.classList.remove("closing-tab"),this.updateLayout(),this.element.removeEventListener("webkitTransitionEnd",S)}if(t.suppressAnimations)this.needsLayout();else{this.element.classList.add("static-layout"),this._tabAnimatedClosedSinceMouseEnter=!0,this._applyTabBarItemSizesAndPositions(a);var S=w.bind(this);requestAnimationFrame(b.bind(this))}return this.updateNewTabTabBarItemState(),this.dispatchEventToListeners(WI.TabBar.Event.TabBarItemRemoved,{tabBarItem:i}),f&&this._openDefaultTab(),i}selectPreviousTab(){if(!(this._tabBarItems.length<=1)){var e=this._tabBarItems.indexOf(this._selectedTabBarItem),t=e;do if(t===0?t=this._tabBarItems.length-1:t--,!(this._tabBarItems[t]instanceof WI.PinnedTabBarItem))break;while(t!==e);t!==e&&(this.selectedTabBarItem=this._tabBarItems[t])}}selectNextTab(){if(!(this._tabBarItems.length<=1)){var e=this._tabBarItems.indexOf(this._selectedTabBarItem),t=e;do if(t===this._tabBarItems.length-1?t=0:t++,!(this._tabBarItems[t]instanceof WI.PinnedTabBarItem))break;while(t!==e);t!==e&&(this.selectedTabBarItem=this._tabBarItems[t])}}get selectedTabBarItem(){return this._selectedTabBarItem}set selectedTabBarItem(e){let t=this._findTabBarItem(e);(t===this._newTabTabBarItem||t===this._tabPickerTabBarItem)&&(t=this._tabBarItems[this.normalTabCount-1]),this._selectedTabBarItem!==t&&(this._selectedTabBarItem&&(this._selectedTabBarItem.selected=!1),this._selectedTabBarItem=t||null,this._selectedTabBarItem&&(this._selectedTabBarItem.selected=!0,this._selectedTabBarItem.element.classList.contains("hidden")&&this.needsLayout()),this.dispatchEventToListeners(WI.TabBar.Event.TabBarItemSelected))}get tabBarItems(){return this._tabBarItems}get normalTabCount(){return this._tabBarItems.filter(e=>!(e instanceof WI.PinnedTabBarItem)).length}get saveableTabCount(){return this._tabBarItems.filter(e=>e.representedObject&&e.representedObject.constructor.shouldSaveTab()).length}layout(){if(this.element.classList.contains("static-layout"))return;this.element.classList.add("calculate-width"),this.element.classList.remove("collapsed");function e(a,d){a.element.classList.toggle("hidden",!!d)}for(let a of this._tabBarItems)e(a,a===this._tabPickerTabBarItem);function t(a){return a[WI.TabBar.CachedWidthSymbol]||(a[WI.TabBar.CachedWidthSymbol]=a.element.realOffsetWidth),a[WI.TabBar.CachedWidthSymbol]}let i=()=>this._tabBarItems.reduce((a,d)=>(d[WI.TabBar.CachedWidthSymbol]=void 0,a+t(d)),0);this._hiddenTabBarItems=[];let n=i(),s=this.element.realOffsetWidth;if(n>s){this.element.classList.add("collapsed"),n=i(),n>s&&(e(this._tabPickerTabBarItem,!1),n+=t(this._tabPickerTabBarItem));let a=this._tabBarItemsFromLeftToRight(),d=a.length;for(;n>s&&--d>=0;){let p=a[d];p===this.selectedTabBarItem||p instanceof WI.PinnedTabBarItem||(n-=t(p),e(p,!0),this._hiddenTabBarItems.push(p))}}this.element.classList.remove("calculate-width")}_tabBarItemsFromLeftToRight(){return WI.resolvedLayoutDirection()===WI.LayoutDirection.LTR?this._tabBarItems:this._tabBarItems.slice().reverse()}_findTabBarItem(e){return typeof e=="number"?this._tabBarItems[e]||null:e instanceof WI.TabBarItem&&this._tabBarItems.includes(e)?e:null}_hasMoreThanOneNormalTab(){let e=0;for(let t of this._tabBarItems)if(!(t instanceof WI.PinnedTabBarItem)&&(++e,e>=2))return!0;return!1}_openDefaultTab(){this.dispatchEventToListeners(WI.TabBar.Event.OpenDefaultTab)}_recordTabBarItemSizesAndPositions(){var e=new Map;const t=this.element.getBoundingClientRect();for(var i of this._tabBarItems){var n=i.element.getBoundingClientRect();e.set(i,{left:n.left-t.left,width:n.width})}return e}_applyTabBarItemSizesAndPositions(e,t){for(var[i,n]of e)t&&i===t||(i.element.style.left=n.left+"px",i.element.style.width=n.width+"px")}_clearTabBarItemSizesAndPositions(e){for(var t of this._tabBarItems)e&&t===e||(t.element.style.left=null,t.element.style.width=null)}_finishExpandingTabsAfterClose(e){return new Promise(function(t,i){console.assert(this._tabAnimatedClosedSinceMouseEnter),this._tabAnimatedClosedSinceMouseEnter=!1,e||(e=this._recordTabBarItemSizesAndPositions()),this.element.classList.remove("static-layout"),this._clearTabBarItemSizesAndPositions();var n=this._recordTabBarItemSizesAndPositions();this._applyTabBarItemSizesAndPositions(e),this.element.classList.add("static-layout");function s(){this.element.classList.add("static-layout"),this.element.classList.add("animating"),this.element.classList.add("expanding-tabs"),this._applyTabBarItemSizesAndPositions(n),this.element.addEventListener("webkitTransitionEnd",d)}function a(){this.element.classList.remove("static-layout"),this.element.classList.remove("animating"),this.element.classList.remove("expanding-tabs"),this._clearTabBarItemSizesAndPositions(),this.updateLayout(),this.element.removeEventListener("webkitTransitionEnd",d),t()}var d=a.bind(this);requestAnimationFrame(s.bind(this))}.bind(this))}_handleMouseDown(e){if(e.button!==0||e.ctrlKey)return;let t=e.target.closest("."+WI.TabBarItem.StyleClassName);if(!t)return;let i=t[WI.TabBarItem.ElementReferenceSymbol];if(!i||i.disabled||i===this._newTabTabBarItem)return;if(i===this._tabPickerTabBarItem){if(!this._hiddenTabBarItems.length||this._ignoreTabPickerMouseDown)return;this._ignoreTabPickerMouseDown=!0;let s=WI.ContextMenu.createFromEvent(e);s.addBeforeShowCallback(()=>{this._ignoreTabPickerMouseDown=!1});for(let a of this._hiddenTabBarItems)s.appendItem(a.title,()=>{this.selectedTabBarItem=a});s.show();return}if(!e.target.closest("."+WI.TabBarItem.CloseButtonStyleClassName)&&(this.selectedTabBarItem=i,!(i instanceof WI.PinnedTabBarItem||!this._hasMoreThanOneNormalTab()))){this._firstNormalTabItemIndex=0;for(let s=0;s<this._tabBarItems.length;++s)if(!(this._tabBarItems[s]instanceof WI.PinnedTabBarItem)){this._firstNormalTabItemIndex=s;break}this._mouseIsDown=!0,this._mouseMovedEventListener=this._handleMouseMoved.bind(this),this._mouseUpEventListener=this._handleMouseUp.bind(this),document.addEventListener("mousemove",this._mouseMovedEventListener,!0),document.addEventListener("mouseup",this._mouseUpEventListener,!0),e.preventDefault(),e.stopPropagation()}}_handleClick(e){var t=e.target.closest("."+WI.TabBarItem.StyleClassName);if(!t)return;var i=t[WI.TabBarItem.ElementReferenceSymbol];if(!i||i.disabled)return;const n=e.button===1;var s=e.target.closest("."+WI.TabBarItem.CloseButtonStyleClassName);if(s||n){if(i.isDefaultTab&&this.element.classList.contains("single-tab"))return;if(!e.altKey){this.removeTabBarItem(i,{suppressExpansion:!0});return}for(let a=this._tabBarItems.length-1;a>=0;--a){let d=this._tabBarItems[a];d===i||d instanceof WI.PinnedTabBarItem||this.removeTabBarItem(d)}}}_handleMouseMoved(e){if(console.assert(e.button===0),console.assert(this._mouseIsDown),!this._mouseIsDown||(console.assert(this._selectedTabBarItem),!this._selectedTabBarItem))return;e.preventDefault(),e.stopPropagation(),this.element.classList.contains("static-layout")||(this._applyTabBarItemSizesAndPositions(this._recordTabBarItemSizesAndPositions()),this.element.classList.add("static-layout"),this.element.classList.add("dragging-tab")),this._mouseOffset===void 0&&(this._mouseOffset=e.pageX-this._selectedTabBarItem.element.totalOffsetLeft);var t=e.pageX-this.element.totalOffsetLeft,i=t-this._mouseOffset;this._selectedTabBarItem.element.style.left=i+"px";var n=i+this._selectedTabBarItem.element.realOffsetWidth/2,s=this._tabBarItems.indexOf(this._selectedTabBarItem),a=s;for(let b of this._tabBarItems)if(b!==this._selectedTabBarItem){var d=b.element.getBoundingClientRect();if(!(n<d.left||n>d.right)){a=this._tabBarItems.indexOf(b);break}}if(a=Number.constrain(a,this._firstNormalTabItemIndex,this.normalTabCount-1),s===a)return;this._tabBarItems.splice(s,1),this._tabBarItems.splice(a,0,this._selectedTabBarItem);let p=this._tabBarItems[a+1],f=p?p.element:this._newTabTabBarItem.element;this.element.insertBefore(this._selectedTabBarItem.element,f);let _=0;for(let b of this._tabBarItemsFromLeftToRight())b!==this._selectedTabBarItem&&b!==this._newTabTabBarItem&&parseFloat(b.element.style.left)!==_&&(b.element.style.left=_+"px"),_+=parseFloat(b.element.style.width)}_handleMouseUp(e){if(console.assert(e.button===0),console.assert(this._mouseIsDown),!!this._mouseIsDown){if(this.element.classList.remove("dragging-tab"),!this._tabAnimatedClosedSinceMouseEnter)this.element.classList.remove("static-layout"),this._clearTabBarItemSizesAndPositions();else{let t=0;for(let i of this._tabBarItemsFromLeftToRight())i===this._selectedTabBarItem&&(i.element.style.left=t+"px"),t+=parseFloat(i.element.style.width)}this._mouseIsDown=!1,this._mouseOffset=void 0,document.removeEventListener("mousemove",this._mouseMovedEventListener,!0),document.removeEventListener("mouseup",this._mouseUpEventListener,!0),this._mouseMovedEventListener=null,this._mouseUpEventListener=null,e.preventDefault(),e.stopPropagation(),this.dispatchEventToListeners(WI.TabBar.Event.TabBarItemsReordered)}}_handleMouseLeave(e){if(this._mouseIsDown||!this._tabAnimatedClosedSinceMouseEnter||!this.element.classList.contains("static-layout")||this.element.classList.contains("animating"))return;const t=this.element.getBoundingClientRect(),i=this._newTabTabBarItem.element.getBoundingClientRect();e.pageY>t.top&&e.pageY<t.bottom&&e.pageX>t.left&&e.pageX<(i?i.right:t.right)||this._finishExpandingTabsAfterClose()}_handleContextMenu(e){let t=WI.ContextMenu.createFromEvent(e);for(let i of WI.knownTabClasses()){if(!i.isTabAllowed()||i.tabInfo().isEphemeral)continue;let n=null;for(let s of this._tabBarItems){let a=s.representedObject;if(a instanceof WI.TabContentView&&a.type===i.Type){n=s;break}}t.appendCheckboxItem(i.tabInfo().title,()=>{n?this.removeTabBarItem(n):WI.createNewTabWithType(i.Type,{shouldShowNewTab:!0})},!!n)}}_handleNewTabClick(e){WI.showNewTabTab()}_handleTabPickerTabContextMenu(e){if(!this._hiddenTabBarItems.length)return;let t=WI.ContextMenu.createFromEvent(e);for(let i of this._hiddenTabBarItems)t.appendItem(i.title,()=>{this.selectedTabBarItem=i})}_handleNewTabMouseEnter(e){!this._tabAnimatedClosedSinceMouseEnter||!this.element.classList.contains("static-layout")||this.element.classList.contains("animating")||this._finishExpandingTabsAfterClose()}};WI.ButtonNavigationItem=class extends WI.NavigationItem{constructor(e,t,i,n,s,a,d){super(e,a||"button"),console.assert(e),console.assert(t),this._enabled=!0,this.element.addEventListener("click",this._mouseClicked.bind(this)),d&&this.element.setAttribute("aria-label",d),this._buttonStyle=null,this._disabled=!1,this._image=i||null,this._imageWidth=n||16,this._imageHeight=s||16,this._label=t,this.buttonStyle=this._image?WI.ButtonNavigationItem.Style.Image:WI.ButtonNavigationItem.Style.Text,this.buttonStyle===WI.ButtonNavigationItem.Style.Image&&(this.tooltip=t)}get label(){return this._label}set label(e){e=e||"",this._label!==e&&(this._label=e,this._update(),this.parentNavigationBar&&this.parentNavigationBar.needsLayout())}get image(){return this._image}set image(e){e=e||null,this._image!==e&&(this._image=e,this._update())}get enabled(){return this._enabled}set enabled(e){e=!!e,this._enabled!==e&&(this._enabled=e,this.element.classList.toggle("disabled",!this._enabled))}get buttonStyle(){return this._buttonStyle}set buttonStyle(e){e=e||WI.ButtonNavigationItem.Style.Image,this._buttonStyle!==e&&(this.element.classList.remove(...Object.values(WI.ButtonNavigationItem.Style)),this.element.classList.add(e),this._buttonStyle=e,this._update(),this.parentNavigationBar&&this.parentNavigationBar.needsLayout())}get additionalClassNames(){return["button"]}_mouseClicked(e){!this.enabled||this.dispatchEventToListeners(WI.ButtonNavigationItem.Event.Clicked,{nativeEvent:e})}_update(){if(this.element.removeChildren(),this._buttonStyle===WI.ButtonNavigationItem.Style.Text)this.element.textContent=this._label;else{let e=WI.ImageUtilities.useSVGSymbol(this._image,"glyph");if(e.style.width=this._imageWidth+"px",e.style.height=this._imageHeight+"px",this.element.appendChild(e),this._buttonStyle===WI.ButtonNavigationItem.Style.ImageAndText){let t=this.element.appendChild(document.createElement("span"));t.textContent=this._label}}}};WI.ButtonNavigationItem.Event={Clicked:"button-navigation-item-clicked"};WI.ButtonNavigationItem.Style={Image:"image-only",Text:"text-only",ImageAndText:"image-and-text"};WI.DatabaseUserQueryViewBase=class extends WI.View{constructor(e){super(),this.element.className="database-user-query";let t=document.createElement("span");t.className="database-query-text",t.textContent=e,this.element.appendChild(t),this._resultElement=document.createElement("div"),this._resultElement.className="database-query-result",this.element.appendChild(this._resultElement)}get resultElement(){return this._resultElement}};WI.DatabaseUserQueryErrorView=class extends WI.DatabaseUserQueryViewBase{constructor(e,t){super(e),this.resultElement.classList.add("error"),this.resultElement.textContent=t}};WI.DatabaseUserQuerySuccessView=class extends WI.DatabaseUserQueryViewBase{constructor(e,t,i){super(e),this._dataGrid=WI.DataGrid.createSortableDataGrid(t,i),this._dataGrid?(this._dataGrid.inline=!0,this.resultElement.appendChild(this._dataGrid.element),this._dataGrid.updateLayoutIfNeeded()):(this.resultElement.classList.add("no-results"),this.resultElement.textContent=WI.UIString("Query returned no results."))}get dataGrid(){return this._dataGrid}layout(){this._dataGrid&&this._dataGrid.updateLayout()}};WI.DOMTreeContentView=class extends WI.ContentView{constructor(e){console.assert(e),super(e),this._compositingBordersButtonNavigationItem=new WI.ActivateButtonNavigationItem("layer-borders",WI.UIString("Show compositing borders"),WI.UIString("Hide compositing borders"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 13'%3e %3crect fill='none' stroke='currentColor' x='0.5' y='0.5' width='5' height='5'/%3e %3crect fill='none' stroke='currentColor' x='0.5' y='7.5' width='5' height='5'/%3e %3crect fill='none' stroke='currentColor' x='7.5' y='0.5' width='5' height='5'/%3e %3crect fill='none' stroke='currentColor' x='7.5' y='7.5' width='5' height='5'/%3e %3c/svg%3e",13,13),this._compositingBordersButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._toggleCompositingBorders,this),this._compositingBordersButtonNavigationItem.enabled=!!InspectorBackend.domains.Page,this._compositingBordersButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,WI.settings.showPaintRects.addEventListener(WI.Setting.Event.Changed,this._showPaintRectsSettingChanged,this),this._paintFlashingButtonNavigationItem=new WI.ActivateButtonNavigationItem("paint-flashing",WI.UIString("Enable paint flashing"),WI.UIString("Disable paint flashing"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2013 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='currentColor' d='M 1.367188 13.789062 C 1.367188 13.789062 2.820312 14.105469 3.289062 12.722656 C 3.757812 11.34375 3.960938 10.867188 5.222656 10.976562 C 5.222656 10.976562 5.714844 11.886719 6.933594 12.308594 C 6.933594 12.308594 5.75 16.207031 1.367188 13.789062 Z M 14.339844 2.351562 C 14.054688 2.839844 10.289062 8.804688 9.554688 9.65625 C 8.820312 10.511719 6.917969 11.71875 6.917969 11.71875 C 6.003906 11.242188 5.710938 10.738281 5.710938 10.738281 C 5.710938 10.738281 6.328125 8.992188 7.230469 7.683594 C 8.132812 6.378906 13.050781 1.949219 13.460938 1.636719 C 13.871094 1.320312 14.625 1.867188 14.339844 2.351562 Z'/%3e %3c/svg%3e",16,16),this._paintFlashingButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._togglePaintFlashing,this),this._paintFlashingButtonNavigationItem.enabled=InspectorBackend.domains.Page&&!!InspectorBackend.domains.Page.setShowPaintRects,this._paintFlashingButtonNavigationItem.activated=InspectorBackend.domains.Page&&InspectorBackend.domains.Page.setShowPaintRects&&WI.settings.showPaintRects.value,this._paintFlashingButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,WI.settings.showShadowDOM.addEventListener(WI.Setting.Event.Changed,this._showShadowDOMSettingChanged,this),this._showsShadowDOMButtonNavigationItem=new WI.ActivateButtonNavigationItem("shows-shadow-DOM",WI.UIString("Show shadow DOM nodes"),WI.UIString("Hide shadow DOM nodes"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 13'%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='square' d='M 3.5 0.5 L 0.5 6.5 L 3.5 12.5'/%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='square' opacity='0.5' d='M 9.5 12.5 L 12.5 6.5 L 9.5 0.5'/%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='square' opacity='0.5' d='M 5.5 0.5 L 2.5 6.5 L 5.5 12.5'/%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='square' d='M 7.5 12.5 L 10.5 6.5 L 7.5 0.5'/%3e %3c/svg%3e",13,13),this._showsShadowDOMButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._toggleShowsShadowDOMSetting,this),this._showsShadowDOMButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._showShadowDOMSettingChanged(),this._showPrintStylesButtonNavigationItem=new WI.ActivateButtonNavigationItem("print-styles",WI.UIString("Force print media styles"),WI.UIString("Use default media styles"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2016 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='currentColor' d='M 2 5 C 1.51875 5 1 5.45 1 6 L 1 12 L 3 12 C 3.240625 12 3.5 11.775 3.5 11.5 C 3.5 11.225 3.240625 11 3 11 L 2.5 11 L 2.5 9 L 13.5 9 L 13.5 11 L 13 11 C 12.759375 11 12.5 11.225 12.5 11.5 C 12.5 11.775 12.759375 12 13 12 L 15 12 L 15 6 C 15 5.45 14.48125 5 14 5 L 2 5 Z M 5 4 L 5 2 L 11 2 L 11 4 C 11 4.275 11.28 4.5 11.5 4.5 C 11.72 4.5 12 4.275 12 4 L 12 1 L 4 1 L 4 4 C 4 4.275 4.28 4.5 4.5 4.5 C 4.72 4.5 5 4.275 5 4 Z M 11.5 9.5 C 11.28 9.5 11 9.725 11 10 L 11 14 L 5 14 L 5 10 C 5 9.725 4.72 9.5 4.5 9.5 C 4.28 9.5 4 9.725 4 10 L 4 15 L 12 15 L 12 10 C 12 9.725 11.72 9.5 11.5 9.5 L 11.5 9.5 Z'/%3e %3c/svg%3e",16,16),this._showPrintStylesButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._togglePrintStyles,this),this._showPrintStylesButtonNavigationItem.enabled=!!InspectorBackend.domains.Page,this._showPrintStylesButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._showPrintStylesChanged(),WI.settings.showRulers.addEventListener(WI.Setting.Event.Changed,this._showRulersChanged,this),this._showRulersButtonNavigationItem=new WI.ActivateButtonNavigationItem("show-rulers",WI.UIString("Show rulers"),WI.UIString("Hide rulers"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2018 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpolygon points='1.5 1.5 14.5 1.5 14.5 5.5 5.5 5.5 5.5 14.5 1.5 14.5 1.5 1.5' fill='none' stroke='currentColor'/%3e %3cline x1='8.5' y1='3' x2='8.5' y2='5' stroke='currentColor'/%3e %3cline x1='11.5' y1='3' x2='11.5' y2='5' stroke='currentColor'/%3e %3cline x1='5.5' y1='3' x2='5.5' y2='5' stroke='currentColor'/%3e %3cline x1='3' y1='11.5' x2='5' y2='11.5' stroke='currentColor'/%3e %3cline x1='3' y1='8.5' x2='5' y2='8.5' stroke='currentColor'/%3e %3cline x1='3' y1='5.5' x2='5' y2='5.5' stroke='currentColor'/%3e %3c/svg%3e",16,16),this._showRulersButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._toggleShowRulers,this),this._showRulersButtonNavigationItem.enabled=InspectorBackend.domains.Page&&!!InspectorBackend.domains.Page.setShowRulers,this._showRulersButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._showRulersChanged(),this.element.classList.add("dom-tree"),this.element.addEventListener("click",this._mouseWasClicked.bind(this),!1),this._domTreeOutline=new WI.DOMTreeOutline({omitRootDOMNode:!0,excludeRevealElementContextMenu:!0,showLastSelected:!0}),this._domTreeOutline.allowsEmptySelection=!1,this._domTreeOutline.allowsMultipleSelection=!0,this._domTreeOutline.addEventListener(WI.TreeOutline.Event.ElementAdded,this._domTreeElementAdded,this),this._domTreeOutline.addEventListener(WI.TreeOutline.Event.SelectionDidChange,this._domTreeSelectionDidChange,this),this._domTreeOutline.addEventListener(WI.DOMTreeOutline.Event.SelectedNodeChanged,this._selectedNodeDidChange,this),this._domTreeOutline.wireToDomAgent(),this._domTreeOutline.editable=!0,this.element.appendChild(this._domTreeOutline.element),WI.domManager.addEventListener(WI.DOMManager.Event.AttributeModified,this._domNodeChanged,this),WI.domManager.addEventListener(WI.DOMManager.Event.AttributeRemoved,this._domNodeChanged,this),WI.domManager.addEventListener(WI.DOMManager.Event.CharacterDataModified,this._domNodeChanged,this),WI.cssManager.addEventListener(WI.CSSManager.Event.DefaultAppearanceDidChange,this._defaultAppearanceDidChange,this),this._lastSelectedNodePathSetting=new WI.Setting("last-selected-node-path",null),this._numberOfSearchResults=null,this._breakpointGutterEnabled=!1,this._pendingBreakpointNodeIdentifiers=new Set,this._defaultAppearanceDidChange(),WI.domDebuggerManager.supported&&(WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.BreakpointsEnabledDidChange,this._breakpointsEnabledDidChange,this),WI.domDebuggerManager.addEventListener(WI.DOMDebuggerManager.Event.DOMBreakpointAdded,this._domBreakpointAddedOrRemoved,this),WI.domDebuggerManager.addEventListener(WI.DOMDebuggerManager.Event.DOMBreakpointRemoved,this._domBreakpointAddedOrRemoved,this),WI.DOMBreakpoint.addEventListener(WI.DOMBreakpoint.Event.DisabledStateChanged,this._handleDOMBreakpointDisabledStateChanged,this),WI.DOMBreakpoint.addEventListener(WI.DOMBreakpoint.Event.DOMNodeChanged,this._handleDOMBreakpointDOMNodeChanged,this),this._breakpointsEnabledDidChange())}get navigationItems(){return[this._showRulersButtonNavigationItem,this._showPrintStylesButtonNavigationItem,this._forceAppearanceButtonNavigationItem,this._compositingBordersButtonNavigationItem,this._paintFlashingButtonNavigationItem,this._showsShadowDOMButtonNavigationItem]}get domTreeOutline(){return this._domTreeOutline}get scrollableElements(){return[this.element]}get breakpointGutterEnabled(){return this._breakpointGutterEnabled}set breakpointGutterEnabled(e){this._breakpointGutterEnabled!==e&&(this._breakpointGutterEnabled=e,this.element.classList.toggle("show-gutter",this._breakpointGutterEnabled))}shown(){super.shown(),this._domTreeOutline.setVisible(!0,WI.isConsoleFocused()),this._updateCompositingBordersButtonToMatchPageSettings(),this._domTreeOutline.rootDOMNode&&this._restoreBreakpointsAfterUpdate()}hidden(){super.hidden(),WI.domManager.hideDOMNodeHighlight(),this._domTreeOutline.setVisible(!1)}closed(){super.closed(),WI.settings.showPaintRects.removeEventListener(null,null,this),WI.settings.showShadowDOM.removeEventListener(null,null,this),WI.settings.showRulers.removeEventListener(null,null,this),WI.debuggerManager.removeEventListener(null,null,this),WI.domManager.removeEventListener(null,null,this),WI.domDebuggerManager.removeEventListener(null,null,this),WI.DOMBreakpoint.removeEventListener(null,null,this),this._domTreeOutline.close(),this._pendingBreakpointNodeIdentifiers.clear()}get selectionPathComponents(){for(var e=this._domTreeOutline.selectedTreeElement,t=[];e&&!e.root;){if(e.isCloseTag()){e=e.parent;continue}var i=new WI.DOMTreeElementPathComponent(e,e.representedObject);i.addEventListener(WI.HierarchicalPathComponent.Event.Clicked,this._pathComponentSelected,this),t.unshift(i),e=e.parent}return t}restoreFromCookie(e){!e||!e.nodeToSelect||(this.selectAndRevealDOMNode(e.nodeToSelect),e.nodeToSelect=void 0)}selectAndRevealDOMNode(e,t){this._domTreeOutline.selectDOMNode(e,!t)}handleCopyEvent(e){var t=this._domTreeOutline.selectedDOMNode();!t||(e.clipboardData.clearData(),e.preventDefault(),t.copyNode())}handlePasteEvent(e){let t=this._domTreeOutline.selectedDOMNode();if(!t)return;let i=e.clipboardData.getData("text/plain");!i||t.insertAdjacentHTML("afterend",i)}get supportsSave(){return WI.canArchiveMainFrame()}get saveData(){return{customSaveHandler:()=>{WI.archiveMainFrame()}}}get supportsSearch(){return!0}get numberOfSearchResults(){return this._numberOfSearchResults}get hasPerformedSearch(){return this._numberOfSearchResults!==null}set automaticallyRevealFirstSearchResult(e){this._automaticallyRevealFirstSearchResult=e,this._automaticallyRevealFirstSearchResult&&this._numberOfSearchResults>0&&this._currentSearchResultIndex===-1&&this.revealNextSearchResult()}performSearch(e){if(this._searchQuery===e)return;this._searchIdentifier&&(DOMAgent.discardSearchResults(this._searchIdentifier),this._hideSearchHighlights()),this._searchQuery=e,this._searchIdentifier=null,this._numberOfSearchResults=null,this._currentSearchResultIndex=-1;function t(n,s,a){n||(this._searchIdentifier=s,this._numberOfSearchResults=a,this.dispatchEventToListeners(WI.ContentView.Event.NumberOfSearchResultsDidChange),this._showSearchHighlights(),this._automaticallyRevealFirstSearchResult&&this.revealNextSearchResult())}function i(n){if(this._searchQuery!==e)return;let s={query:this._searchQuery,nodeIds:n,caseSensitive:WI.SearchUtilities.defaultSettings.caseSensitive.value};DOMAgent.performSearch.invoke(s,t.bind(this))}this.getSearchContextNodes(i.bind(this))}getSearchContextNodes(e){e(void 0)}searchCleared(){this._searchIdentifier&&(DOMAgent.discardSearchResults(this._searchIdentifier),this._hideSearchHighlights()),this._searchQuery=null,this._searchIdentifier=null,this._numberOfSearchResults=null,this._currentSearchResultIndex=-1}revealPreviousSearchResult(e){!this._numberOfSearchResults||(this._currentSearchResultIndex>0?--this._currentSearchResultIndex:this._currentSearchResultIndex=this._numberOfSearchResults-1,this._revealSearchResult(this._currentSearchResultIndex,e))}revealNextSearchResult(e){!this._numberOfSearchResults||(this._currentSearchResultIndex+1<this._numberOfSearchResults?++this._currentSearchResultIndex:this._currentSearchResultIndex=0,this._revealSearchResult(this._currentSearchResultIndex,e))}sizeDidChange(){super.sizeDidChange(),this._domTreeOutline.selectDOMNode(this._domTreeOutline.selectedDOMNode())}layout(){super.layout(),this._domTreeOutline.updateSelectionArea()}_revealSearchResult(e,t){console.assert(this._searchIdentifier);var i=this._searchIdentifier;function n(s,a){if(!s&&this._searchIdentifier===i){console.assert(a.length===1);var d=WI.domManager.nodeForId(a[0]);if(console.assert(d),!!d){this._domTreeOutline.selectDOMNode(d,t);var p=this._domTreeOutline.selectedTreeElement;p&&p.emphasizeSearchHighlight()}}}DOMAgent.getSearchResults(this._searchIdentifier,e,e+1,n.bind(this))}_restoreSelectedNodeAfterUpdate(e,t){if(!WI.domManager.restoreSelectedNodeIsAllowed)return;function i(s){var a=s;a||(a=t),a&&(this._dontSetLastSelectedNodePath=!0,this.selectAndRevealDOMNode(a,WI.isConsoleFocused()),this._dontSetLastSelectedNodePath=!1,!s&&this._domTreeOutline.selectedTreeElement&&this._domTreeOutline.selectedTreeElement.expand())}function n(s){!WI.domManager.restoreSelectedNodeIsAllowed||i.call(this,WI.domManager.nodeForId(s))}e&&this._lastSelectedNodePathSetting.value&&this._lastSelectedNodePathSetting.value.path&&this._lastSelectedNodePathSetting.value.url===e.hash?WI.domManager.pushNodeByPathToFrontend(this._lastSelectedNodePathSetting.value.path,n.bind(this)):i.call(this)}_domTreeElementAdded(e){if(!this._pendingBreakpointNodeIdentifiers.size)return;let i=e.data.element.representedObject;console.assert(i instanceof WI.DOMNode),i instanceof WI.DOMNode&&(!this._pendingBreakpointNodeIdentifiers.delete(i.id)||this._updateBreakpointStatus(i.id))}_domTreeSelectionDidChange(e){let t=this._domTreeOutline.selectedTreeElement,i=t?t.representedObject:null,n=e.data.selectedByUser;this._domTreeOutline.suppressRevealAndSelect=!0,this._domTreeOutline.selectDOMNode(i,n),i&&n&&WI.domManager.highlightDOMNode(i.id),this._domTreeOutline.updateSelectionArea(),this._domTreeOutline.suppressRevealAndSelect=!1}_selectedNodeDidChange(e){var t=this._domTreeOutline.selectedDOMNode();t&&!this._dontSetLastSelectedNodePath&&(this._lastSelectedNodePathSetting.value={url:WI.networkManager.mainFrame.url.hash,path:t.path()}),t&&WI.domManager.setInspectedNode(t),this.dispatchEventToListeners(WI.ContentView.Event.SelectionPathComponentsDidChange)}_pathComponentSelected(e){!e.data.pathComponent||(console.assert(e.data.pathComponent instanceof WI.DOMTreeElementPathComponent),console.assert(e.data.pathComponent.domTreeElement instanceof WI.DOMTreeElement),this._domTreeOutline.selectDOMNode(e.data.pathComponent.domTreeElement.representedObject,!0))}_domNodeChanged(e){var t=this._domTreeOutline.selectedDOMNode();t===e.data.node&&this.dispatchEventToListeners(WI.ContentView.Event.SelectionPathComponentsDidChange)}_mouseWasClicked(e){var t=e.target.closest("a");if(!t||!t.href||(e.preventDefault(),e.stopPropagation(),WI.isBeingEdited(t))||(this._followLinkTimeoutIdentifier&&(clearTimeout(this._followLinkTimeoutIdentifier),delete this._followLinkTimeoutIdentifier),e.detail>1))return;function i(){const n={alwaysOpenExternally:e?e.metaKey:!1,lineNumber:t.lineNumber,ignoreNetworkTab:!0,ignoreSearchTab:!0};WI.openURL(t.href,this._frame,n)}this._followLinkTimeoutIdentifier=setTimeout(i.bind(this),333)}_toggleCompositingBorders(e){var t=!this._compositingBordersButtonNavigationItem.activated;this._compositingBordersButtonNavigationItem.activated=t;for(let i of WI.targets)i.PageAgent&&i.PageAgent.setCompositingBordersVisible(t)}_togglePaintFlashing(e){WI.settings.showPaintRects.value=!WI.settings.showPaintRects.value}_updateCompositingBordersButtonToMatchPageSettings(){if(!WI.targetsAvailable()){WI.whenTargetsAvailable().then(()=>{this._updateCompositingBordersButtonToMatchPageSettings()});return}if(!!window.PageAgent){var e=this._compositingBordersButtonNavigationItem;PageAgent.getCompositingBordersVisible(function(t,i){e.activated=t?!1:i,e.enabled=t!=="unsupported"})}}_showPaintRectsSettingChanged(e){let t=WI.settings.showPaintRects.value;this._paintFlashingButtonNavigationItem.activated=t;for(let i of WI.targets)i.PageAgent&&i.PageAgent.setShowPaintRects&&i.PageAgent.setShowPaintRects(t)}_showShadowDOMSettingChanged(e){this._showsShadowDOMButtonNavigationItem.activated=WI.settings.showShadowDOM.value}_toggleShowsShadowDOMSetting(e){WI.settings.showShadowDOM.value=!WI.settings.showShadowDOM.value}_showPrintStylesChanged(){this._showPrintStylesButtonNavigationItem.activated=WI.printStylesEnabled;let e=WI.printStylesEnabled?"print":"";for(let t of WI.targets)t.PageAgent&&t.PageAgent.setEmulatedMedia(e);WI.cssManager.mediaTypeChanged()}_togglePrintStyles(e){WI.printStylesEnabled=!WI.printStylesEnabled,this._showPrintStylesChanged()}_defaultAppearanceDidChange(){if(WI.cssManager.forcedAppearance)return;this._forceAppearanceButtonNavigationItem=null;let e=WI.cssManager.defaultAppearance;switch(e){case WI.CSSManager.Appearance.Light:case null:this._forceAppearanceButtonNavigationItem=new WI.ActivateButtonNavigationItem("appearance",WI.UIString("Force Dark Appearance"),WI.UIString("Use Default Appearance"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2018 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='currentColor' fill-rule='evenodd' d='M 3.99119893 1 L 12.0087973 1 C 13.048904 1 13.4260733 1.10829467 13.8063227 1.31165867 C 14.1865627 1.51501333 14.4849867 1.81343733 14.6883413 2.19367733 C 14.8917053 2.57392667 15 2.951096 15 3.99120267 L 15 12.0088011 C 15 13.0489059 14.8917053 13.4260733 14.6883413 13.8063199 C 14.4849867 14.1865669 14.1865627 14.4849869 13.8063227 14.6883452 C 13.4260733 14.8917035 13.048904 15 12.0087973 15 L 3.99119893 15 C 2.95109413 15 2.57392667 14.8917035 2.19368013 14.6883452 C 1.81343313 14.4849869 1.51501305 14.1865669 1.31165484 13.8063199 C 1.10829653 13.4260733 1 13.0489059 1 12.0088011 L 1 3.99120267 C 1 2.951096 1.10829653 2.57392667 1.31165484 2.19367733 C 1.51501305 1.81343733 1.81343313 1.51501333 2.19368013 1.31165867 C 2.57392667 1.10829467 2.95109413 1 3.99119893 1 Z M 3.5 4 L 12.5 4 C 13.3284271 4 14 4.67157288 14 5.5 L 14 12.5 C 14 13.3284271 13.3284271 14 12.5 14 L 3.5 14 C 2.67157288 14 2 13.3284271 2 12.5 L 2 5.5 C 2 4.67157288 2.67157288 4 3.5 4 Z M 4.1 5 L 11.9 5 C 12.5075132 5 13 5.49248678 13 6.1 L 13 11.9 C 13 12.5075132 12.5075132 13 11.9 13 L 4.1 13 C 3.49248678 13 3 12.5075132 3 11.9 L 3 6.1 C 3 5.49248678 3.49248678 5 4.1 5 Z M 3 2 L 4 2 L 4 3 L 3 3 L 3 2 Z M 5 2 L 6 2 L 6 3 L 5 3 L 5 2 Z M 7 2 L 8 2 L 8 3 L 7 3 L 7 2 Z'/%3e %3c/svg%3e",16,16);break;case WI.CSSManager.Appearance.Dark:this._forceAppearanceButtonNavigationItem=new WI.ActivateButtonNavigationItem("appearance",WI.UIString("Force Light Appearance"),WI.UIString("Use Default Appearance"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2018 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='currentColor' fill-rule='evenodd' d='M 3.99119893 1 L 12.0087973 1 C 13.048904 1 13.4260733 1.10829467 13.8063227 1.31165867 C 14.1865627 1.51501333 14.4849867 1.81343733 14.6883413 2.19367733 C 14.8917053 2.57392667 15 2.951096 15 3.99120267 L 15 12.0088011 C 15 13.0489059 14.8917053 13.4260733 14.6883413 13.8063199 C 14.4849867 14.1865669 14.1865627 14.4849869 13.8063227 14.6883452 C 13.4260733 14.8917035 13.048904 15 12.0087973 15 L 3.99119893 15 C 2.95109413 15 2.57392667 14.8917035 2.19368013 14.6883452 C 1.81343313 14.4849869 1.51501305 14.1865669 1.31165484 13.8063199 C 1.10829653 13.4260733 1 13.0489059 1 12.0088011 L 1 3.99120267 C 1 2.951096 1.10829653 2.57392667 1.31165484 2.19367733 C 1.51501305 1.81343733 1.81343313 1.51501333 2.19368013 1.31165867 C 2.57392667 1.10829467 2.95109413 1 3.99119893 1 Z M 3.5 4 L 12.5 4 C 13.3284271 4 14 4.67157288 14 5.5 L 14 12.5 C 14 13.3284271 13.3284271 14 12.5 14 L 3.5 14 C 2.67157288 14 2 13.3284271 2 12.5 L 2 5.5 C 2 4.67157288 2.67157288 4 3.5 4 Z M 4.1 5 L 11.9 5 C 12.5075132 5 13 5.49248678 13 6.1 L 13 11.9 C 13 12.5075132 12.5075132 13 11.9 13 L 4.1 13 C 3.49248678 13 3 12.5075132 3 11.9 L 3 6.1 C 3 5.49248678 3.49248678 5 4.1 5 Z M 3 2 L 4 2 L 4 3 L 3 3 L 3 2 Z M 5 2 L 6 2 L 6 3 L 5 3 L 5 2 Z M 7 2 L 8 2 L 8 3 L 7 3 L 7 2 Z'/%3e %3c/svg%3e",16,16);break}this._lastKnownDefaultAppearance=e,this._forceAppearanceButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._toggleAppearance,this),this._forceAppearanceButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._forceAppearanceButtonNavigationItem.enabled=WI.cssManager.canForceAppearance(),this._forceAppearanceButtonNavigationItem.activated=!!WI.cssManager.forcedAppearance,this.dispatchEventToListeners(WI.ContentView.Event.NavigationItemsDidChange)}_toggleAppearance(e){console.assert(WI.cssManager.canForceAppearance());let t=null;switch(this._lastKnownDefaultAppearance){case WI.CSSManager.Appearance.Light:t=WI.CSSManager.Appearance.Dark;break;case WI.CSSManager.Appearance.Dark:t=WI.CSSManager.Appearance.Light;break}console.assert(t),WI.cssManager.forcedAppearance=WI.cssManager.forcedAppearance==t?null:t,!WI.cssManager.forcedAppearance&&this._lastKnownDefaultAppearance!==WI.cssManager.defaultAppearance?this._defaultAppearanceDidChange():this._forceAppearanceButtonNavigationItem.activated=!!WI.cssManager.forcedAppearance}_showRulersChanged(){let e=WI.settings.showRulers.value;this._showRulersButtonNavigationItem.activated=e;for(let t of WI.targets)t.PageAgent&&t.PageAgent.setShowRulers&&t.PageAgent.setShowRulers(e)}_toggleShowRulers(e){WI.settings.showRulers.value=!WI.settings.showRulers.value,this._showRulersChanged()}_showSearchHighlights(){console.assert(this._searchIdentifier),this._searchResultNodes=[];var e=this._searchIdentifier;DOMAgent.getSearchResults(this._searchIdentifier,0,this._numberOfSearchResults,function(t,i){if(!t&&this._searchIdentifier===e){console.assert(i.length===this._numberOfSearchResults);for(var n=0;n<i.length;++n){var s=WI.domManager.nodeForId(i[n]);if(console.assert(s),!!s){this._searchResultNodes.push(s);var a=this._domTreeOutline.findTreeElement(s);console.assert(a),a&&a.highlightSearchResults(this._searchQuery)}}}}.bind(this))}_hideSearchHighlights(){if(!!this._searchResultNodes){for(var e of this._searchResultNodes){var t=this._domTreeOutline.findTreeElement(e);t&&t.hideSearchHighlights()}delete this._searchResultNodes}}_domBreakpointAddedOrRemoved(e){let t=e.data.breakpoint;this._updateBreakpointStatus(t.domNodeIdentifier)}_handleDOMBreakpointDisabledStateChanged(e){let t=e.target;this._updateBreakpointStatus(t.domNodeIdentifier)}_handleDOMBreakpointDOMNodeChanged(e){let i=e.target.domNodeIdentifier||e.data.oldNodeIdentifier;this._updateBreakpointStatus(i)}_updateBreakpointStatus(e){let t=WI.domManager.nodeForId(e);if(!t)return;let i=this._domTreeOutline.findTreeElement(t);if(!i){this._pendingBreakpointNodeIdentifiers.add(e);return}let n=WI.domDebuggerManager.domBreakpointsForNode(t);n.length?n.some(s=>s.disabled)?i.breakpointStatus=WI.DOMTreeElement.BreakpointStatus.DisabledBreakpoint:i.breakpointStatus=WI.DOMTreeElement.BreakpointStatus.Breakpoint:i.breakpointStatus=WI.DOMTreeElement.BreakpointStatus.None,this.breakpointGutterEnabled=this._domTreeOutline.children.some(s=>s.hasBreakpoint)}_restoreBreakpointsAfterUpdate(){this._pendingBreakpointNodeIdentifiers.clear(),this.breakpointGutterEnabled=!1;let e=new Set;for(let t of WI.domDebuggerManager.domBreakpoints)e.has(t.domNodeIdentifier)||this._updateBreakpointStatus(t.domNodeIdentifier)}_breakpointsEnabledDidChange(e){this._domTreeOutline.element.classList.toggle("breakpoints-disabled",!WI.debuggerManager.breakpointsEnabled)}};WI.DetailsSidebarPanel=class extends WI.SidebarPanel{constructor(e,t,i){super(e,t),this.element.classList.add("details"),i||(this._navigationItem=new WI.RadioButtonNavigationItem(e,t))}get navigationItem(){return this._navigationItem}inspect(e){return!1}};WI.GeneralTabBarItem=class extends WI.TabBarItem{constructor(e,t,i=!1){if(super(e,t),this._isEphemeral=i,this._isEphemeral){this.element.classList.add("ephemeral");let n=document.createElement("div");n.classList.add(WI.TabBarItem.CloseButtonStyleClassName),n.title=WI.UIString("Click to close this tab"),this.element.insertBefore(n,this.element.firstChild),this.element.addEventListener("contextmenu",this._handleContextMenuEvent.bind(this))}}static fromTabInfo({image:e,title:t,isEphemeral:i}){return new WI.GeneralTabBarItem(e,t,i)}get isEphemeral(){return this._isEphemeral}get title(){return super.title}set title(e){if(e){this._titleElement=document.createElement("span"),this._titleElement.classList.add("title");let t=document.createElement("span");t.classList.add("content"),t.textContent=e,this._titleElement.appendChild(t),this.element.insertBefore(this._titleElement,this.element.lastChild)}else this._titleElement&&this._titleElement.remove(),this._titleElement=null;super.title=e}_handleContextMenuEvent(e){if(!this._parentTabBar)return;let t=WI.ContextMenu.createFromEvent(e);t.appendItem(WI.UIString("Close Tab"),()=>{this._parentTabBar.removeTabBarItem(this)},this.isDefaultTab),t.appendSeparator()}};WI.GeneralTreeElement=class extends WI.TreeElement{constructor(e,t,i,n,s){super("",n,s),this.classNames=e,this._tooltipHandledSeparately=!1,this._mainTitle=t||"",this._subtitle=i||"",this._status=""}get element(){return this._listItemNode}get iconElement(){return this._createElementsIfNeeded(),this._iconElement}get statusElement(){return this._statusElement}get titlesElement(){return this._createElementsIfNeeded(),this._titlesElement}get mainTitleElement(){return this._createElementsIfNeeded(),this._mainTitleElement}get subtitleElement(){return this._createElementsIfNeeded(),this._createSubtitleElementIfNeeded(),this._subtitleElement}get classNames(){return this._classNames}set classNames(e){e=e||[],typeof e=="string"&&(e=[e]),!Array.shallowEqual(this._classNames,e)&&(this._listItemNode&&this._classNames&&this._listItemNode.classList.remove(...this._classNames),this._classNames=e,this._listItemNode&&this._listItemNode.classList.add(...this._classNames))}addClassName(e){this._classNames.includes(e)||(this._classNames.push(e),this._listItemNode&&this._listItemNode.classList.add(e))}removeClassName(e){!this._classNames.includes(e)||(this._classNames.remove(e),this._listItemNode&&this._listItemNode.classList.remove(e))}get mainTitle(){return this._mainTitle}set mainTitle(e){e=e||"",this._mainTitle!==e&&(this._mainTitle=e,this._updateTitleElements(),this.didChange(),this.dispatchEventToListeners(WI.GeneralTreeElement.Event.MainTitleDidChange))}get subtitle(){return this._subtitle}set subtitle(e){e=e||"",this._subtitle!==e&&(this._subtitle=e,this._updateTitleElements(),this.didChange())}get status(){return this._status}set status(e){e=e||"",this._status!==e&&(this._statusElement||(this._statusElement=document.createElement("div"),this._statusElement.className=WI.GeneralTreeElement.StatusElementStyleClassName),this._status=e,this._updateStatusElement())}get filterableData(){return{text:[this.mainTitle,this.subtitle]}}get tooltipHandledSeparately(){return this._tooltipHandledSeparately}set tooltipHandledSeparately(e){this._tooltipHandledSeparately=!!e}createFoldersAsNeededForSubpath(e){if(!e)return this;let t=e.split("/");if(t.length===1)return this;this._subpathFolderTreeElementMap||(this._subpathFolderTreeElementMap=new Map);let i="",n=this;for(let s of t){if(s===t.lastValue)break;i&&(i+="/"),i+=s;let a=this._subpathFolderTreeElementMap.get(i);if(a){n=a;continue}let d=new WI.FolderTreeElement(s);this._subpathFolderTreeElementMap.set(i,d);let p=insertionIndexForObjectInListSortedByFunction(d,n.children,WI.ResourceTreeElement.compareFolderAndResourceTreeElements);n.insertChild(d,p),n=d}return n}isEventWithinDisclosureTriangle(e){return e.target===this._disclosureButton}onattach(){this._createElementsIfNeeded(),this._updateTitleElements(),this._listItemNode.classList.add("item"),this._classNames&&this._listItemNode.classList.add(...this._classNames),this._listItemNode.appendChild(this._disclosureButton),this._listItemNode.appendChild(this._iconElement),this._statusElement&&this._listItemNode.appendChild(this._statusElement),this._listItemNode.appendChild(this._titlesElement)}ondetach(){}onreveal(){this._listItemNode&&this._listItemNode.scrollIntoViewIfNeeded(!1)}callFirstAncestorFunction(e,t){for(var i=this.parent;i;){if(typeof i[e]=="function"){i[e].apply(i,t);break}i=i.parent}}customTitleTooltip(){}_createElementsIfNeeded(){this._createdElements||(this._disclosureButton=document.createElement("button"),this._disclosureButton.className=WI.GeneralTreeElement.DisclosureButtonStyleClassName,this._disclosureButton.tabIndex=-1,this._iconElement=document.createElement("img"),this._iconElement.className=WI.GeneralTreeElement.IconElementStyleClassName,this._titlesElement=document.createElement("div"),this._titlesElement.className=WI.GeneralTreeElement.TitlesElementStyleClassName,this._mainTitleElement=document.createElement("span"),this._mainTitleElement.className=WI.GeneralTreeElement.MainTitleElementStyleClassName,this._titlesElement.appendChild(this._mainTitleElement),this._createdElements=!0)}_createSubtitleElementIfNeeded(){this._subtitleElement||(this._subtitleElement=document.createElement("span"),this._subtitleElement.className=WI.GeneralTreeElement.SubtitleElementStyleClassName,this._titlesElement.appendChild(this._subtitleElement))}_updateTitleElements(){!this._createdElements||(typeof this._mainTitle=="string"?this._mainTitleElement.textContent!==this._mainTitle&&(this._mainTitleElement.textContent=this._mainTitle):this._mainTitle instanceof Node&&(this._mainTitleElement.removeChildren(),this._mainTitleElement.appendChild(this._mainTitle)),typeof this._subtitle=="string"&&this._subtitle?(this._createSubtitleElementIfNeeded(),this._subtitleElement.textContent!==this._subtitle&&(this._subtitleElement.textContent=this._subtitle),this._titlesElement.classList.remove(WI.GeneralTreeElement.NoSubtitleStyleClassName)):this._subtitle instanceof Node?(this._createSubtitleElementIfNeeded(),this._subtitleElement.removeChildren(),this._subtitleElement.appendChild(this._subtitle),this._titlesElement.classList.remove(WI.GeneralTreeElement.NoSubtitleStyleClassName)):(this._subtitleElement&&(this._subtitleElement.textContent=""),this._titlesElement.classList.add(WI.GeneralTreeElement.NoSubtitleStyleClassName)),!this.tooltip&&!this._tooltipHandledSeparately&&this._updateTitleTooltip())}_updateTitleTooltip(){if(console.assert(this._listItemNode),!this._listItemNode)return;let e=this.customTitleTooltip();if(!e){let t=this._mainTitleElement.textContent,i=this._subtitleElement?this._subtitleElement.textContent:"",n=this.treeOutline&&this.treeOutline.large;t&&i?e=t+(n?`
`:" \u2014 ")+i:t?e=t:e=i}this._listItemNode.title=e}_updateStatusElement(){!this._statusElement||(!this._statusElement.parentNode&&this._listItemNode&&this._listItemNode.insertBefore(this._statusElement,this._titlesElement),this._status instanceof Node?(this._statusElement.removeChildren(),this._statusElement.appendChild(this._status)):this._statusElement.textContent=this._status)}};WI.GeneralTreeElement.DisclosureButtonStyleClassName="disclosure-button";WI.GeneralTreeElement.IconElementStyleClassName="icon";WI.GeneralTreeElement.StatusElementStyleClassName="status";WI.GeneralTreeElement.TitlesElementStyleClassName="titles";WI.GeneralTreeElement.MainTitleElementStyleClassName="title";WI.GeneralTreeElement.SubtitleElementStyleClassName="subtitle";WI.GeneralTreeElement.NoSubtitleStyleClassName="no-subtitle";WI.GeneralTreeElement.Event={MainTitleDidChange:"general-tree-element-main-title-did-change"};WI.GroupNavigationItem=class extends WI.NavigationItem{constructor(e){console.assert(!e||Array.isArray(e)),super(),this._needsUpdate=!1,this.navigationItems=e||[]}get navigationItems(){return this._navigationItems}set navigationItems(e){this._navigationItems=e,this._needsUpdate=!0}get width(){return this._updateItems(),super.width}get minimumWidth(){return this._updateItems(),this._navigationItems.reduce((e,t)=>e+t.minimumWidth,0)}updateLayout(e){super.updateLayout(e);for(let t of this._navigationItems)t.updateLayout(e)}didAttach(e){super.didAttach(e);for(let t of this._navigationItems)t.didAttach(e)}didDetach(){for(let e of this._navigationItems)e.didDetach();super.didDetach()}_updateItems(){if(!!this._needsUpdate){this._needsUpdate=!1,this.element.removeChildren();for(let e of this._navigationItems)console.assert(e instanceof WI.NavigationItem),this.element.appendChild(e.element)}}};WI.NavigationSidebarPanel=class extends WI.SidebarPanel{constructor(e,t,i,n){super(e,t),this.element.classList.add("navigation"),this._updateContentOverflowShadowVisibilityDebouncer=new Debouncer(()=>{this._updateContentOverflowShadowVisibility()}),this._boundUpdateContentOverflowShadowVisibilitySoon=s=>{this._updateContentOverflowShadowVisibilityDebouncer.delayForTime(0)},this.contentView.element.addEventListener("scroll",this._boundUpdateContentOverflowShadowVisibilitySoon),this._contentTreeOutlineGroup=new WI.TreeOutlineGroup,this._contentTreeOutline=this.createContentTreeOutline(),this._filterBar=new WI.FilterBar,this._filterBar.addEventListener(WI.FilterBar.Event.FilterDidChange,this._filterDidChange,this),this.element.appendChild(this._filterBar.element),this._bottomOverflowShadowElement=document.createElement("div"),this._bottomOverflowShadowElement.className=WI.NavigationSidebarPanel.OverflowShadowElementStyleClassName,this.element.appendChild(this._bottomOverflowShadowElement),n&&(this._topOverflowShadowElement=this.element.appendChild(document.createElement("div")),this._topOverflowShadowElement.classList.add(WI.NavigationSidebarPanel.OverflowShadowElementStyleClassName,"top")),window.addEventListener("resize",this._boundUpdateContentOverflowShadowVisibilitySoon),this._filtersSetting=new WI.Setting(e+"-navigation-sidebar-filters",{}),this._filterBar.filters=this._filtersSetting.value,this._emptyContentPlaceholderElements=new Map,this._emptyFilterResults=new Set,this._shouldAutoPruneStaleTopLevelResourceTreeElements=i||!1,this._shouldAutoPruneStaleTopLevelResourceTreeElements&&(WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._checkForStaleResources,this),WI.Frame.addEventListener(WI.Frame.Event.ChildFrameWasRemoved,this._checkForStaleResources,this),WI.Frame.addEventListener(WI.Frame.Event.ResourceWasRemoved,this._checkForStaleResources,this)),this._pendingViewStateCookie=null,this._restoringState=!1}get filterBar(){return this._filterBar}get hasActiveFilters(){return this._filterBar.hasActiveFilters()}closed(){window.removeEventListener("resize",this._boundUpdateContentOverflowShadowVisibilitySoon),WI.Frame.removeEventListener(null,null,this)}get contentBrowser(){return this._contentBrowser}set contentBrowser(e){this._contentBrowser=e||null}get contentTreeOutline(){return this._contentTreeOutline}get contentTreeOutlines(){return Array.from(this._contentTreeOutlineGroup)}get currentRepresentedObject(){return this._contentBrowser&&this._contentBrowser.currentRepresentedObjects[0]||null}get restoringState(){return this._restoringState}cancelRestoringState(){this._pendingViewStateCookie=null,this._finalAttemptToRestoreViewStateTimeout&&(clearTimeout(this._finalAttemptToRestoreViewStateTimeout),this._finalAttemptToRestoreViewStateTimeout=void 0)}createContentTreeOutline({ignoreCookieRestoration:e,suppressFiltering:t}={}){let i=new WI.TreeOutline;return i.allowsRepeatSelection=!0,i.element.classList.add(WI.NavigationSidebarPanel.ContentTreeOutlineElementStyleClassName),this._contentTreeOutlineGroup.add(i),this.contentView.element.appendChild(i.element),t||(i.addEventListener(WI.TreeOutline.Event.ElementAdded,this._treeElementAddedOrChanged,this),i.addEventListener(WI.TreeOutline.Event.ElementDidChange,this._treeElementAddedOrChanged,this),i.addEventListener(WI.TreeOutline.Event.ElementDisclosureDidChanged,this._treeElementDisclosureDidChange,this)),i[WI.NavigationSidebarPanel.IgnoreCookieRestoration]=e,i[WI.NavigationSidebarPanel.SuppressFilteringSymbol]=t,i}suppressFilteringOnTreeElements(e){console.assert(Array.isArray(e),"TreeElements should be an array.");for(let t of e)t[WI.NavigationSidebarPanel.SuppressFilteringSymbol]=!0;this.updateFilter()}treeElementForRepresentedObject(e){let t=null;for(let i of this.contentTreeOutlines)if(t=i.getCachedTreeElement(e),t)break;return t}showDefaultContentView(){}showDefaultContentViewForTreeElement(e){if(console.assert(e),console.assert(e.representedObject),!e||!e.representedObject)return!1;if(!this.selected){let i=this.contentBrowser.contentViewForRepresentedObject(e.representedObject);if(i&&i.parentContainer&&i.parentContainer!==this.contentBrowser.contentViewContainer)return!1;let n=WI.tabBrowser.selectedTabContentView;if(n&&n.contentBrowser!==this.contentBrowser)return!1}return this.contentBrowser.showContentViewForRepresentedObject(e.representedObject)?(e.revealAndSelect(!0,!1,!0),!0):!1}canShowRepresentedObject(e){let t=WI.tabBrowser.selectedTabContentView;return console.assert(t instanceof WI.TabContentView,"Missing TabContentView for NavigationSidebarPanel."),t&&t.canShowRepresentedObject(e)}saveStateToCookie(e){if(console.assert(e),!this._contentBrowser)return;let t=this.currentRepresentedObject;if(!!t){if(e[WI.TypeIdentifierCookieKey]=t.constructor.TypeIdentifier,t.saveIdentityToCookie){t.saveIdentityToCookie(e);return}console.error("NavigationSidebarPanel representedObject is missing a saveIdentityToCookie implementation.",t)}}restoreStateFromCookie(e,t){if(this._pendingViewStateCookie=e,this._restoringState=!0,this._checkOutlinesForPendingViewStateCookie(),this._finalAttemptToRestoreViewStateTimeout&&clearTimeout(this._finalAttemptToRestoreViewStateTimeout),t===0)return;function i(){this._finalAttemptToRestoreViewStateTimeout=void 0,this._checkOutlinesForPendingViewStateCookie(!0),this._pendingViewStateCookie=null,this._restoringState=!1}this._finalAttemptToRestoreViewStateTimeout=setTimeout(i.bind(this),t)}showEmptyContentPlaceholder(e,t){console.assert(e),t=t||this._contentTreeOutline;let i=this._emptyContentPlaceholderElements.get(t);return i&&i.remove(),i=e instanceof Node?e:WI.createMessageTextView(e),this._emptyContentPlaceholderElements.set(t,i),t.element.parentNode.appendChild(i),this._updateContentOverflowShadowVisibilityDebouncer.force(),i}hideEmptyContentPlaceholder(e){e=e||this._contentTreeOutline;let t=this._emptyContentPlaceholderElements.get(e);!t||!t.parentNode||(t.remove(),this._emptyContentPlaceholderElements.delete(e),this._updateContentOverflowShadowVisibilityDebouncer.force())}updateEmptyContentPlaceholder(e,t){t=t||this._contentTreeOutline,t.children.length?this._emptyFilterResults.has(t)||this.hideEmptyContentPlaceholder(t):this.showEmptyContentPlaceholder(e,t)}updateFilter(){let e;for(let n of this.contentTreeOutlines)if(!(n.hidden||n[WI.NavigationSidebarPanel.SuppressFilteringSymbol])&&(e=n.selectedTreeElement,e))break;let t=this._filterBar.filters;this._textFilterRegex=simpleGlobStringToRegExp(t.text,"i"),this._filtersSetting.value=t,this._filterFunctions=t.functions;let i=!this._filterBar.hasActiveFilters()&&!this.shouldFilterPopulate();for(let n of this.contentTreeOutlines){if(n.hidden||n[WI.NavigationSidebarPanel.SuppressFilteringSymbol])continue;let s=n.children[0];for(;s&&!s.root;){if(!s[WI.NavigationSidebarPanel.SuppressFilteringSymbol]){const a=s.hidden;this.applyFiltersToTreeElement(s),a!==s.hidden&&this._treeElementWasFiltered(s)}s=s.traverseNextTreeElement(!1,null,i)}}this._checkForEmptyFilterResults(),this._updateContentOverflowShadowVisibilityDebouncer.force()}resetFilter(){this._filterBar.clear()}shouldFilterPopulate(){return this.hasCustomFilters()}hasCustomFilters(){return!1}matchTreeElementAgainstCustomFilters(e){return!0}matchTreeElementAgainstFilterFunctions(e){if(!this._filterFunctions||!this._filterFunctions.length)return!0;for(var t of this._filterFunctions)if(t(e))return!0;return!1}applyFiltersToTreeElement(e){if(!this._filterBar.hasActiveFilters()&&!this.hasCustomFilters()){e.hidden=!1,e.expanded&&e[WI.NavigationSidebarPanel.WasExpandedDuringFilteringSymbol]&&(e[WI.NavigationSidebarPanel.WasExpandedDuringFilteringSymbol]=!1,e.collapse());return}var t=e.filterableData||{},i={expandTreeElement:!1},n=this._textFilterRegex;function s(p){if(!p||!n)return!0;console.assert(p instanceof Array,"filterableData.text should be an array of text inputs");for(var f of p)if(!!f&&n.test(f))return i.expandTreeElement=!0,!0;return!1}function a(){e.hidden=!1;for(var p=e.parent;p&&!p.root;)p.hidden=!1,i.expandTreeElement&&!p.expanded&&(p.__wasExpandedDuringFiltering=!0,p.expand()),p=p.parent}if(e[WI.NavigationSidebarPanel.SuppressFilteringSymbol]||s(t.text)&&this.matchTreeElementAgainstFilterFunctions(e,i)&&this.matchTreeElementAgainstCustomFilters(e,i)){a(),!i.expandTreeElement&&e.expanded&&e[WI.NavigationSidebarPanel.WasExpandedDuringFilteringSymbol]&&(e[WI.NavigationSidebarPanel.WasExpandedDuringFilteringSymbol]=!1,e.collapse());return}e.hidden=!0}shown(){super.shown(),this._updateContentOverflowShadowVisibilityDebouncer.force()}pruneStaleResourceTreeElements(){this._checkForStaleResourcesTimeoutIdentifier&&(clearTimeout(this._checkForStaleResourcesTimeoutIdentifier),this._checkForStaleResourcesTimeoutIdentifier=void 0);for(let n of this.contentTreeOutlines)for(var e=n.children.length-1;e>=0;--e){var t=n.children[e];if(t instanceof WI.ResourceTreeElement){var i=t.resource;(!i.parentFrame||i.parentFrame.isDetached())&&n.removeChildAtIndex(e,!0,!0)}}}_updateContentOverflowShadowVisibility(){if(!this.visible)return;let e=this.contentView.element.scrollHeight,t=this.contentView.element.offsetHeight;if(e<t){this._topOverflowShadowElement&&(this._topOverflowShadowElement.style.opacity=0),this._bottomOverflowShadowElement.style.opacity=0;return}let i=1,n=this.contentView.element.scrollTop,s=Math.min(n,i),a=Math.max(0,t+n-(e-i));this._topOverflowShadowElement&&(this._topOverflowShadowElement.style.opacity=(s/i).toFixed(1)),this._bottomOverflowShadowElement.style.opacity=(1-a/i).toFixed(1)}_checkForEmptyFilterResults(){function e(t){if(!t.children.length)return;let i=!1,n=!1,s=t.children[0];for(;s;){if(!s[WI.NavigationSidebarPanel.SuppressFilteringSymbol]&&(i=!0,!s.hidden)){n=!0;break}s=s.nextSibling}if(n||!i){this.hideEmptyContentPlaceholder(t),this._emptyFilterResults.delete(t);return}let a=WI.createMessageTextView(WI.UIString("No Filter Results")),d=a.appendChild(document.createElement("button"));d.textContent=WI.UIString("Clear Filters"),d.addEventListener("click",()=>{this.resetFilter()}),this.showEmptyContentPlaceholder(a,t),this._emptyFilterResults.add(t)}for(let t of this.contentTreeOutlines)t[WI.NavigationSidebarPanel.SuppressFilteringSymbol]||e.call(this,t)}_filterDidChange(){this.updateFilter()}_treeElementAddedOrChanged(e){var t=!this._filterBar.hasActiveFilters()&&!this.shouldFilterPopulate();let i=e.data.element,n=i;for(;n&&!n.root;){if(!n[WI.NavigationSidebarPanel.SuppressFilteringSymbol]){const s=n.hidden;this.applyFiltersToTreeElement(n),s!==n.hidden&&this._treeElementWasFiltered(n)}n=n.traverseNextTreeElement(!1,i,t)}this._checkForEmptyFilterResults(),this.visible&&this._updateContentOverflowShadowVisibilityDebouncer.delayForTime(0),this.selected&&!i.treeOutline[WI.NavigationSidebarPanel.IgnoreCookieRestoration]&&this._checkElementsForPendingViewStateCookie([i])}_treeElementDisclosureDidChange(e){this._updateContentOverflowShadowVisibilityDebouncer.delayForTime(0)}_checkForStaleResourcesIfNeeded(){!this._checkForStaleResourcesTimeoutIdentifier||!this._shouldAutoPruneStaleTopLevelResourceTreeElements||this.pruneStaleResourceTreeElements()}_checkForStaleResources(e){console.assert(this._shouldAutoPruneStaleTopLevelResourceTreeElements),!this._checkForStaleResourcesTimeoutIdentifier&&(this._checkForStaleResourcesTimeoutIdentifier=setTimeout(this.pruneStaleResourceTreeElements.bind(this)))}_isTreeElementWithoutRepresentedObject(e){return e instanceof WI.FolderTreeElement||e instanceof WI.DatabaseHostTreeElement||e instanceof WI.IndexedDatabaseHostTreeElement||e instanceof WI.ApplicationCacheManifestTreeElement||e instanceof WI.ThreadTreeElement||e instanceof WI.IdleTreeElement||e instanceof WI.DOMBreakpointTreeElement||e instanceof WI.EventBreakpointTreeElement||e instanceof WI.URLBreakpointTreeElement||e instanceof WI.CSSStyleSheetTreeElement||typeof e.representedObject=="string"||e.representedObject instanceof String}_checkOutlinesForPendingViewStateCookie(e){if(!!this._pendingViewStateCookie){this._checkForStaleResourcesIfNeeded();var t=[];this.contentTreeOutlines.forEach(function(i){if(!i[WI.NavigationSidebarPanel.IgnoreCookieRestoration])for(var n=i.hasChildren?i.children[0]:null;n;)t.push(n),n=n.traverseNextTreeElement(!1,null,!1)}),this._checkElementsForPendingViewStateCookie(t,e)}}_checkElementsForPendingViewStateCookie(e,t){if(!this._pendingViewStateCookie)return;var i=this._pendingViewStateCookie;function n(a){if(this._isTreeElementWithoutRepresentedObject(a))return!1;var d=a.representedObject;if(!d)return!1;var p=i[WI.TypeIdentifierCookieKey];if(p!==d.constructor.TypeIdentifier)return!1;if(t)return!0;var f={};d.saveIdentityToCookie&&d.saveIdentityToCookie(f);var _=Object.keys(f);return _.length&&_.every(b=>f[b]===i[b])}var s=null;if(e.some(a=>n.call(this,a)?(s=a,!0):!1),s){if(!this.showDefaultContentViewForTreeElement(s))return;this._pendingViewStateCookie=null,setTimeout(()=>{this._restoringState=!1},0),this._finalAttemptToRestoreViewStateTimeout&&(clearTimeout(this._finalAttemptToRestoreViewStateTimeout),this._finalAttemptToRestoreViewStateTimeout=void 0)}}_treeElementWasFiltered(e){if(e.selected||e.hidden)return;let t=this.currentRepresentedObject;if(!t||e.representedObject!==t)return;const i=!0,n=!1,s=!0;e.revealAndSelect(i,n,s)}};WI.NavigationSidebarPanel.IgnoreCookieRestoration=Symbol("ignore-cookie-restoration");WI.NavigationSidebarPanel.SuppressFilteringSymbol=Symbol("suppress-filtering");WI.NavigationSidebarPanel.WasExpandedDuringFilteringSymbol=Symbol("was-expanded-during-filtering");WI.NavigationSidebarPanel.OverflowShadowElementStyleClassName="overflow-shadow";WI.NavigationSidebarPanel.ContentTreeOutlineElementStyleClassName="navigation-sidebar-panel-content-tree-outline";WI.PinnedTabBarItem=class extends WI.TabBarItem{constructor(e,t){super(e,t),this.element.classList.add("pinned"),this.element.addEventListener("contextmenu",this._handleContextMenuEvent.bind(this))}static fromTabInfo({image:e,title:t}){return new WI.PinnedTabBarItem(e,t)}titleDidChange(){this.element.title=this.title}_handleContextMenuEvent(e){e.preventDefault();let t=WI.ContextMenu.createFromEvent(e);this.dispatchEventToListeners(WI.PinnedTabBarItem.Event.ContextMenu,{contextMenu:t})}};WI.PinnedTabBarItem.Event={ContextMenu:"pinned-tab-bar-item-context-menu"};WI.ResourceContentView=class extends WI.ContentView{constructor(e,t){if(console.assert(e instanceof WI.Resource||e instanceof WI.CSSStyleSheet,e),console.assert(typeof t=="string"),super(e),this._resource=e,this.element.classList.add(t,"resource"),this._spinnerTimeout=setTimeout(()=>{let s=new WI.IndeterminateProgressSpinner;this.element.appendChild(s.element),this._spinnerTimeout=void 0},100),this.element.addEventListener("click",this._mouseWasClicked.bind(this),!1),e.requestContent().then(this._contentAvailable.bind(this)).catch(this.showGenericErrorMessage.bind(this)),!this.managesOwnIssues){WI.consoleManager.addEventListener(WI.ConsoleManager.Event.IssueAdded,this._issueWasAdded,this);for(var i=WI.consoleManager.issuesForSourceCode(e),n=0;n<i.length;++n)this.addIssue(i[n])}}get resource(){return this._resource}get supportsSave(){return this._resource.finished}get saveData(){return{url:this._resource.url,content:this._resource.content}}contentAvailable(e,t){throw WI.NotImplementedError.subclassMustOverride()}showGenericNoContentMessage(){this.showMessage(WI.UIString("Resource has no content")),this.dispatchEventToListeners(WI.ResourceContentView.Event.ContentError)}showGenericErrorMessage(){this._contentError(WI.UIString("An error occurred trying to load the resource."))}showMessage(e){this.element.removeChildren(),this.element.appendChild(WI.createMessageTextView(e))}addIssue(e){this.element.removeChildren(),this.element.appendChild(WI.createMessageTextView(e.text,e.level===WI.IssueMessage.Level.Error))}closed(){super.closed(),this.managesOwnIssues||WI.consoleManager.removeEventListener(null,null,this)}removeLoadingIndicator(){this._spinnerTimeout&&(clearTimeout(this._spinnerTimeout),this._spinnerTimeout=void 0),this.element.removeChildren()}_contentAvailable(e){if(e.error){this._contentError(e.error);return}console.assert(!this._hasContent()),console.assert(e.sourceCode===this._resource),this.contentAvailable(e.sourceCode.content,e.base64Encoded)}_contentError(e){this._hasContent()||(this.removeLoadingIndicator(),this.element.appendChild(WI.createMessageTextView(e,!0)),this.dispatchEventToListeners(WI.ResourceContentView.Event.ContentError))}_hasContent(){return this.element.hasChildNodes()&&!this.element.querySelector(".indeterminate-progress-spinner")}_issueWasAdded(e){console.assert(!this.managesOwnIssues);var t=e.data.issue;!WI.ConsoleManager.issueMatchSourceCode(t,this.resource)||this.addIssue(t)}_mouseWasClicked(e){WI.handlePossibleLinkClick(e,this.resource.parentFrame)}};WI.ResourceContentView.Event={ContentError:"resource-content-view-content-error"};WI.TabContentView=class extends WI.ContentView{constructor(e,t,i,n,s){console.assert(typeof e=="string"),console.assert(typeof t=="string"||t.every(d=>typeof d=="string")),console.assert(i instanceof WI.TabBarItem),console.assert(!n||typeof n=="function"),console.assert(!s||s.every(d=>typeof d=="function")),super(null),this.element.classList.add("tab"),typeof t=="string"&&(t=[t]),this.element.classList.add(...t),this._identifier=e,this._tabBarItem=i,this._navigationSidebarPanelConstructor=n||null,this._detailsSidebarPanelConstructors=s||[];const a=300;this._navigationSidebarCollapsedSetting=new WI.Setting(e+"-navigation-sidebar-collapsed",!1),this._navigationSidebarWidthSetting=new WI.Setting(e+"-navigation-sidebar-width",a),this._detailsSidebarCollapsedSetting=new WI.Setting(e+"-details-sidebar-collapsed",!0),this._detailsSidebarSelectedPanelSetting=new WI.Setting(e+"-details-sidebar-selected-panel",null),this._detailsSidebarWidthSetting=new WI.Setting(e+"-details-sidebar-width",a),this._cookieSetting=new WI.Setting(e+"-tab-cookie",{})}static isTabAllowed(){return!0}static shouldSaveTab(){return!0}get type(){return null}get identifier(){return this._identifier}get tabBarItem(){return this._tabBarItem}get managesNavigationSidebarPanel(){return!1}get managesDetailsSidebarPanels(){return!1}showDetailsSidebarPanels(){}showRepresentedObject(e,t){}canShowRepresentedObject(e){return!1}shown(){super.shown(),this._shouldRestoreStateWhenShown&&this.restoreStateFromCookie(WI.StateRestorationType.Delayed)}restoreStateFromCookie(e){if(!this.visible){this._shouldRestoreStateWhenShown=!0;return}this._shouldRestoreStateWhenShown=!1;var t=0;e===WI.StateRestorationType.Load?t=1e3:e===WI.StateRestorationType.Navigation&&(t=2e3);let i=this._cookieSetting.value||{};this.navigationSidebarPanel&&this.navigationSidebarPanel.restoreStateFromCookie(i,t),this.restoreFromCookie(i)}saveStateToCookie(e){this._shouldRestoreStateWhenShown||(e=e||{},this.navigationSidebarPanel&&this.navigationSidebarPanel.saveStateToCookie(e),this.saveToCookie(e),this._cookieSetting.value=e)}get navigationSidebarPanel(){return this._navigationSidebarPanelConstructor?(this._navigationSidebarPanel||(this._navigationSidebarPanel=new this._navigationSidebarPanelConstructor),this._navigationSidebarPanel):null}get navigationSidebarCollapsedSetting(){return this._navigationSidebarCollapsedSetting}get navigationSidebarWidthSetting(){return this._navigationSidebarWidthSetting}get detailsSidebarPanels(){return this._detailsSidebarPanels||(this._detailsSidebarPanels=this._detailsSidebarPanelConstructors.map(e=>new e)),this._detailsSidebarPanels}get detailsSidebarCollapsedSetting(){return this._detailsSidebarCollapsedSetting}get detailsSidebarSelectedPanelSetting(){return this._detailsSidebarSelectedPanelSetting}get detailsSidebarWidthSetting(){return this._detailsSidebarWidthSetting}};WI.TimelineDataGrid=class extends WI.DataGrid{constructor(e){super(e),this.element.classList.add("timeline"),this._sortDelegate=null,this._scopeBarColumns=[];for(var[t,i]of this.columns){var n=i.scopeBar;!n||(this._scopeBarColumns.push(t),n.columnIdentifier=t,n.addEventListener(WI.ScopeBar.Event.SelectionChanged,this._scopeBarSelectedItemsDidChange,this))}if(this._scopeBarColumns.length>1){console.error("Creating a TimelineDataGrid with more than one filterable column is not yet supported.");return}this.addEventListener(WI.DataGrid.Event.SelectedNodeChanged,this._dataGridSelectedNodeChanged,this),this.addEventListener(WI.DataGrid.Event.SortChanged,this._sort,this),this.columnChooserEnabled=!0}static createColumnScopeBar(e,t){e=e+"-timeline-data-grid-";var i=[];for(var[n,s]of t){var a=e+n,d=new WI.ScopeBarItem(a,s);d.value=n,i.push(d)}var p=new WI.ScopeBarItem(e+"type-all",WI.UIString("All"));return i.unshift(p),new WI.ScopeBar(e+"scope-bar",i,p,!0)}get sortDelegate(){return this._sortDelegate}set sortDelegate(e){e=e||null,this._sortDelegate!==e&&(this._sortDelegate=e,this.sortOrder!==WI.DataGrid.SortOrder.Indeterminate&&this.dispatchEventToListeners(WI.DataGrid.Event.SortChanged))}reset(){this.removeChildren(),this._hidePopover()}shown(){}hidden(){this._hidePopover()}callFramePopoverAnchorElement(){return null}shouldShowCallFramePopover(){return!1}addRowInSortOrder(e,t){if(t=t||this,this.sortColumnIdentifier){let i=insertionIndexForObjectInListSortedByFunction(e,t.children,this._sortComparator.bind(this));t.insertChild(e,i)}else t.appendChild(e)}shouldIgnoreSelectionEvent(){return this._ignoreSelectionEvent||!1}dataGridNodeNeedsRefresh(e){this._dirtyDataGridNodes||(this._dirtyDataGridNodes=new Set),this._dirtyDataGridNodes.add(e),!this._scheduledDataGridNodeRefreshIdentifier&&(this._scheduledDataGridNodeRefreshIdentifier=requestAnimationFrame(this._refreshDirtyDataGridNodes.bind(this)))}hasCustomFilters(){return!0}matchNodeAgainstCustomFilters(e){if(!super.matchNodeAgainstCustomFilters(e))return!1;for(let t of this._scopeBarColumns){let i=this.columns.get(t).scopeBar;if(!i||i.defaultItem.selected)continue;let n=e.data[t];if(!i.selectedItems.some(s=>s.value===n))return!1}return!0}_refreshDirtyDataGridNodes(){if(this._scheduledDataGridNodeRefreshIdentifier&&(cancelAnimationFrame(this._scheduledDataGridNodeRefreshIdentifier),this._scheduledDataGridNodeRefreshIdentifier=void 0),!this._dirtyDataGridNodes)return;let e=this.selectedNode,t=this._sortComparator.bind(this);for(let i of this._dirtyDataGridNodes){if(i.refresh(),!this.sortColumnIdentifier)continue;i===e&&(this._ignoreSelectionEvent=!0),console.assert(!i.parent||i.parent===this),i.parent===this&&this.removeChild(i);let n=insertionIndexForObjectInListSortedByFunction(i,this.children,t);this.insertChild(i,n),i===e&&(e.revealAndSelect(),this._ignoreSelectionEvent=!1)}this._dirtyDataGridNodes=null}_sort(){if(!this.children.length||!this.sortColumnIdentifier)return;let t=this.selectedNode;this._ignoreSelectionEvent=!0;let i=[this],n=this.children[0];for(;n;)n.children.length&&i.push(n),n=n.traverseNextNode(!1,null,!0);for(let s of i){let a=s.children.slice();s.removeChildren(),a.sort(this._sortComparator.bind(this));for(let d of a)s.appendChild(d)}t&&t.revealAndSelect(),this._ignoreSelectionEvent=!1}_sortComparator(e,t){var i=this.sortColumnIdentifier;if(!i)return 0;var n=this.sortOrder===WI.DataGrid.SortOrder.Ascending?1:-1;if(this._sortDelegate&&typeof this._sortDelegate.dataGridSortComparator=="function"){let d=this._sortDelegate.dataGridSortComparator(i,n,e,t);if(typeof d=="number")return d}var s=e.data[i],a=t.data[i];return typeof s=="number"&&typeof a=="number"?isNaN(s)&&isNaN(a)?0:isNaN(s)?-n:isNaN(a)?n:(s-a)*n:typeof s=="string"&&typeof a=="string"?s.extendedLocaleCompare(a)*n:((s instanceof WI.CallFrame||a instanceof WI.CallFrame)&&(s=s&&s.functionName?s.functionName:s&&s.sourceCodeLocation?s.sourceCodeLocation.sourceCode:"",a=a&&a.functionName?a.functionName:a&&a.sourceCodeLocation?a.sourceCodeLocation.sourceCode:""),(s instanceof WI.SourceCode||a instanceof WI.SourceCode)&&(s=s&&s.displayName||"",a=a&&a.displayName||""),(s instanceof WI.SourceCodeLocation||a instanceof WI.SourceCodeLocation)&&(s=s&&s.displayLocationString()||"",a=a&&a.displayLocationString()||""),(s<a?-1:s>a?1:0)*n)}_scopeBarSelectedItemsDidChange(e){this.filterDidChange()}_dataGridSelectedNodeChanged(e){if(!this.selectedNode){this._hidePopover();return}var t=this.selectedNode.record;if(!t||!t.callFrames||!t.callFrames.length){this._hidePopover();return}this.shouldShowCallFramePopover()&&this._showPopoverForSelectedNodeSoon()}_showPopoverForSelectedNodeSoon(){this._showPopoverTimeout||(this._showPopoverTimeout=setTimeout(()=>{this._popover||(this._popover=new WI.Popover,this._popover.windowResizeHandler=()=>{this._updatePopoverForSelectedNode(!1)}),this._updatePopoverForSelectedNode(!0),this._showPopoverTimeout=void 0},WI.TimelineDataGrid.DelayedPopoverShowTimeout))}_hidePopover(){this._showPopoverTimeout&&(clearTimeout(this._showPopoverTimeout),this._showPopoverTimeout=void 0),this._popover&&this._popover.dismiss(),this._hidePopoverContentClearTimeout&&clearTimeout(this._hidePopoverContentClearTimeout),this._hidePopoverContentClearTimeout=setTimeout(()=>{this._popoverCallStackTreeOutline&&this._popoverCallStackTreeOutline.removeChildren()},WI.TimelineDataGrid.DelayedPopoverHideContentClearTimeout)}_updatePopoverForSelectedNode(e){if(!this._popover||!this.selectedNode)return;let t=this.callFramePopoverAnchorElement();if(console.assert(t,"TimelineDataGrid subclass should always return a valid element from callFramePopoverAnchorElement."),!t)return;let i=WI.Rect.rectFromClientRect(t.getBoundingClientRect());if(!i.size.width&&!i.size.height)return;this._hidePopoverContentClearTimeout&&(clearTimeout(this._hidePopoverContentClearTimeout),this._hidePopoverContentClearTimeout=void 0);let n=i.pad(2),s=[WI.RectEdge.MAX_Y,WI.RectEdge.MIN_Y,WI.RectEdge.MAX_X];e?this._popover.presentNewContentWithFrame(this._createPopoverContent(),n,s):this._popover.present(n,s)}_createPopoverContent(){this._popoverCallStackTreeOutline?this._popoverCallStackTreeOutline.removeChildren():(this._popoverCallStackTreeOutline=new WI.TreeOutline,this._popoverCallStackTreeOutline.disclosureButtons=!1,this._popoverCallStackTreeOutline.element.classList.add("timeline-data-grid"),this._popoverCallStackTreeOutline.addEventListener(WI.TreeOutline.Event.SelectionDidChange,this._popoverCallStackTreeSelectionDidChange,this));for(var e=this.selectedNode.record.callFrames,t=0;t<e.length;++t){var i=new WI.CallFrameTreeElement(e[t]);this._popoverCallStackTreeOutline.appendChild(i)}let n=document.createElement("div");return n.appendChild(this._popoverCallStackTreeOutline.element),n}_popoverCallStackTreeSelectionDidChange(e){let t=this._popoverCallStackTreeOutline.selectedTreeElement;if(!!t){this._popover.dismiss(),console.assert(t instanceof WI.CallFrameTreeElement,"TreeElements in TimelineDataGrid popover should always be CallFrameTreeElements");var i=t.callFrame;!i.sourceCodeLocation||WI.showSourceCodeLocation(i.sourceCodeLocation,{ignoreNetworkTab:!0,ignoreSearchTab:!0})}}};WI.TimelineDataGrid.HasNonDefaultFilterStyleClassName="has-non-default-filter";WI.TimelineDataGrid.DelayedPopoverShowTimeout=250;WI.TimelineDataGrid.DelayedPopoverHideContentClearTimeout=500;WI.TimelineDataGridNode=class extends WI.DataGridNode{constructor(e,t={}){super({},t.hasChildren),this.copyable=!1,this._records=e,this._includesGraph=t.includesGraph||!1,this._graphDataSource=t.graphDataSource||null,this._cachedData=null,this._graphDataSource&&(this._graphContainerElement=document.createElement("div"),this._timelineRecordBars=[])}get records(){return this._records}get record(){return this.records&&this.records.length?this.records[0]:null}get graphDataSource(){return this._graphDataSource}get data(){return this._graphDataSource?{graph:this.record?this.record.startTime:0}:{}}collapse(){super.collapse(),!(!this._graphDataSource||!this.revealed)&&this.refreshGraph()}expand(){if(super.expand(),!(!this._graphDataSource||!this.revealed)){this.refreshGraph();for(var e=this.children[0];e;)e instanceof WI.TimelineDataGridNode&&e.refreshGraph(),e=e.traverseNextNode(!0,this)}}createCellContent(e,t){if(e==="graph"&&this._graphDataSource)return this.needsGraphRefresh(),this._graphContainerElement;var i=this.data[e];if(!i)return emDash;const n={useGoToArrowButton:!0,ignoreNetworkTab:!0,ignoreSearchTab:!0};if(i instanceof WI.SourceCodeLocation){i.sourceCode instanceof WI.Resource?(t.classList.add(WI.ResourceTreeElement.ResourceIconStyleClassName),t.classList.add(i.sourceCode.type)):i.sourceCode instanceof WI.Script?i.sourceCode.url?(t.classList.add(WI.ResourceTreeElement.ResourceIconStyleClassName),t.classList.add(WI.Resource.Type.Script)):t.classList.add(WI.ScriptTreeElement.AnonymousScriptIconStyleClassName):console.error("Unknown SourceCode subclass."),i.populateLiveDisplayLocationTooltip(t);var s=document.createDocumentFragment();s.appendChild(WI.createSourceCodeLocationLink(i,n));var a=document.createElement("span");return i.populateLiveDisplayLocationString(a,"textContent"),s.appendChild(a),s}if(i instanceof WI.CallFrame){var d=i,p=!1,f=d.functionName;f||(f=WI.UIString("(anonymous function)"),p=!0),t.classList.add(WI.CallFrameView.FunctionIconStyleClassName);var s=document.createDocumentFragment();if(d.sourceCodeLocation&&d.sourceCodeLocation.sourceCode){if(d.sourceCodeLocation.populateLiveDisplayLocationTooltip(t),s.appendChild(WI.createSourceCodeLocationLink(d.sourceCodeLocation,n)),p){d.sourceCodeLocation.sourceCode instanceof WI.Resource?(t.classList.add(WI.ResourceTreeElement.ResourceIconStyleClassName),t.classList.add(d.sourceCodeLocation.sourceCode.type)):d.sourceCodeLocation.sourceCode instanceof WI.Script?d.sourceCodeLocation.sourceCode.url?(t.classList.add(WI.ResourceTreeElement.ResourceIconStyleClassName),t.classList.add(WI.Resource.Type.Script)):t.classList.add(WI.ScriptTreeElement.AnonymousScriptIconStyleClassName):console.error("Unknown SourceCode subclass.");var a=document.createElement("span");d.sourceCodeLocation.populateLiveDisplayLocationString(a,"textContent"),s.appendChild(a)}else{t.classList.add(WI.CallFrameView.FunctionIconStyleClassName),s.append(f);var _=document.createElement("span");_.classList.add("subtitle"),d.sourceCodeLocation.populateLiveDisplayLocationString(_,"textContent"),s.appendChild(_)}return s}var b=document.createElement("div");return b.classList.add("icon"),s.append(b,f),s}return super.createCellContent(e,t)}refresh(){this._cachedData=null,this._graphDataSource&&this._includesGraph&&this.needsGraphRefresh(),super.refresh()}refreshGraph(){if(!this._graphDataSource||(this._scheduledGraphRefreshIdentifier&&(cancelAnimationFrame(this._scheduledGraphRefreshIdentifier),this._scheduledGraphRefreshIdentifier=void 0),console.assert(this.revealed),!this.revealed))return;let e=this._graphDataSource.secondsPerPixel;if(isNaN(e))return;console.assert(e>0);var t=0;function i(f,_){var b=this._timelineRecordBars[t];b?(b.renderMode=_,b.records=f):b=this._timelineRecordBars[t]=new WI.TimelineRecordBar(this,f,_),b.refresh(this._graphDataSource),b.element.parentNode||(this._graphContainerElement.appendChild(b.element),this.didAddRecordBar(b)),++t}function n(f,_){for(var b of f){var w=_.get(b.type);w||(w=[],_.set(b.type,w)),w.push(b)}}var s=i.bind(this);if(this.expanded)WI.TimelineRecordBar.createCombinedBars(this.records,e,this._graphDataSource,s);else{var a=new Map;n(this.records,a);for(var d=this.children[0];d;)d instanceof WI.TimelineDataGridNode&&n(d.records,a),d=d.traverseNextNode(!1,this);for(var p of a.values())WI.TimelineRecordBar.createCombinedBars(p,e,this._graphDataSource,s)}for(;t<this._timelineRecordBars.length;++t)this._timelineRecordBars[t].element.remove(),this.didRemoveRecordBar(this._timelineRecordBars[t]),this._timelineRecordBars[t].records=null}needsGraphRefresh(){if(!this.revealed){for(var e=this;e&&!e.root;){if(e.revealed&&e instanceof WI.TimelineDataGridNode){e.needsGraphRefresh();return}e=e.parent}return}!this._graphDataSource||this._scheduledGraphRefreshIdentifier||(this._scheduledGraphRefreshIdentifier=requestAnimationFrame(this.refreshGraph.bind(this)))}displayName(){return WI.TimelineTabContentView.displayNameForRecord(this.record,!0)}iconClassNames(){return[WI.TimelineTabContentView.iconClassNameForRecord(this.record)]}createGoToArrowButton(e,t){function i(a){this.hidden||!this.revealed||(a.stopPropagation(),t(this,e.__columnIdentifier))}let n=WI.createGoToArrowButton();n.addEventListener("click",i.bind(this)),e.firstChild.appendChild(n)}isRecordVisible(e){return!(!this._graphDataSource||isNaN(e.startTime)||e.endTime<this.graphDataSource.startTime||e.startTime>this.graphDataSource.currentTime||e.startTime>this.graphDataSource.endTime)}filterableDataForColumn(e){let t=this.data[e];return t instanceof WI.SourceCodeLocation?t.displayLocationString():t instanceof WI.CallFrame?[t.functionName,t.sourceCodeLocation.displayLocationString()]:super.filterableDataForColumn(e)}didAddRecordBar(e){}didRemoveRecordBar(e){}didResizeColumn(e){e==="graph"&&this.needsGraphRefresh()}};WI.ContentBrowserTabContentView=class extends WI.TabContentView{constructor(e,t,i,n,s,a,d){typeof t=="string"&&(t=[t]),t.push("content-browser");var p=new WI.ContentBrowser(null,null,a,!1,d);if(super(e,t,i,n,s),this._contentBrowser=p,this._contentBrowser.delegate=this,this._ignoreNavigationSidebarPanelCollapsedEvent=!1,this._ignoreDetailsSidebarPanelCollapsedEvent=!1,this._ignoreDetailsSidebarPanelSelectedEvent=!1,this._lastSelectedDetailsSidebarPanelSetting=new WI.Setting(e+"-last-selected-details-sidebar-panel",null),this._contentBrowser.addEventListener(WI.ContentBrowser.Event.CurrentRepresentedObjectsDidChange,this._contentBrowserCurrentRepresentedObjectsDidChange,this),this._contentBrowser.addEventListener(WI.ContentBrowser.Event.CurrentContentViewDidChange,this._contentBrowserCurrentContentViewDidChange,this),this._contentBrowser.updateHierarchicalPathForCurrentContentView(),n){let f=WI.UIString("Show the navigation sidebar (%s)").format(WI.navigationSidebarKeyboardShortcut.displayName),_=WI.UIString("Hide the navigation sidebar (%s)").format(WI.navigationSidebarKeyboardShortcut.displayName),b=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect stroke='currentColor' fill='none' x='2.5' y='1.5' width='11' height='13'/%3e %3crect fill='currentColor' x='10' y='3' width='2' height='10'/%3e %3c/svg%3e":"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect stroke='currentColor' fill='none' x='2.5' y='1.5' width='11' height='13'/%3e %3crect fill='currentColor' x='4' y='3' width='2' height='10'/%3e %3c/svg%3e";this._showNavigationSidebarItem=new WI.ActivateButtonNavigationItem("toggle-navigation-sidebar",f,_,b,16,16),this._showNavigationSidebarItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,WI.toggleNavigationSidebar,WI),this._showNavigationSidebarItem.activated=!WI.navigationSidebar.collapsed,this._showNavigationSidebarItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.High,this._contentBrowser.navigationBar.insertNavigationItem(this._showNavigationSidebarItem,0),this._contentBrowser.navigationBar.insertNavigationItem(new WI.DividerNavigationItem,1),WI.navigationSidebar.addEventListener(WI.Sidebar.Event.CollapsedStateDidChange,this._navigationSidebarCollapsedStateDidChange,this)}if(s&&s.length){let f=WI.UIString("Show the details sidebar (%s)").format(WI.detailsSidebarKeyboardShortcut.displayName),_=WI.UIString("Hide the details sidebar (%s)").format(WI.detailsSidebarKeyboardShortcut.displayName),b=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect stroke='currentColor' fill='none' x='2.5' y='1.5' width='11' height='13'/%3e %3crect fill='currentColor' x='4' y='3' width='2' height='10'/%3e %3c/svg%3e":"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect stroke='currentColor' fill='none' x='2.5' y='1.5' width='11' height='13'/%3e %3crect fill='currentColor' x='10' y='3' width='2' height='10'/%3e %3c/svg%3e";this._showDetailsSidebarItem=new WI.ActivateButtonNavigationItem("toggle-details-sidebar",f,_,b,16,16),this._showDetailsSidebarItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,WI.toggleDetailsSidebar,WI),this._showDetailsSidebarItem.activated=!WI.detailsSidebar.collapsed,this._showDetailsSidebarItem.enabled=!1,this._showDetailsSidebarItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.High,this._contentBrowser.navigationBar.addNavigationItem(new WI.DividerNavigationItem),this._contentBrowser.navigationBar.addNavigationItem(this._showDetailsSidebarItem),WI.detailsSidebar.addEventListener(WI.Sidebar.Event.CollapsedStateDidChange,this._detailsSidebarCollapsedStateDidChange,this),WI.detailsSidebar.addEventListener(WI.Sidebar.Event.SidebarPanelSelected,this._detailsSidebarPanelSelected,this)}this.addSubview(this._contentBrowser)}get contentBrowser(){return this._contentBrowser}shown(){this.navigationSidebarPanel&&(this.navigationSidebarPanel.contentBrowser||(this.navigationSidebarPanel.contentBrowser=this._contentBrowser)),super.shown(),this._contentBrowser.shown(),this.navigationSidebarPanel&&(this._contentBrowser.currentContentView||this.navigationSidebarPanel.showDefaultContentView())}hidden(){super.hidden(),this._contentBrowser.hidden()}closed(){super.closed(),WI.navigationSidebar.removeEventListener(null,null,this),WI.detailsSidebar.removeEventListener(null,null,this),this.navigationSidebarPanel&&typeof this.navigationSidebarPanel.closed=="function"&&this.navigationSidebarPanel.closed(),this._contentBrowser.contentViewContainer.closeAllContentViews()}get managesDetailsSidebarPanels(){return!0}showNavigationSidebarPanel(){if(!this.visible||!this.navigationSidebarPanel)return;this._ignoreNavigationSidebarPanelCollapsedEvent=!0,this._contentBrowser.currentRepresentedObjects.some(i=>this.navigationSidebarPanel.canShowRepresentedObject(i))?(this.navigationSidebarPanel.parentSidebar||WI.navigationSidebar.addSidebarPanel(this.navigationSidebarPanel),WI.navigationSidebar.selectedSidebarPanel=this.navigationSidebarPanel,WI.navigationSidebar.collapsed=this.navigationSidebarCollapsedSetting.value):(WI.navigationSidebar.collapsed=!0,this.navigationSidebarPanel.parentSidebar&&WI.navigationSidebar.removeSidebarPanel(this.navigationSidebarPanel)),this._ignoreNavigationSidebarPanelCollapsedEvent=!1,this._showNavigationSidebarItem.enabled=!!this.navigationSidebarPanel.parentSidebar}showDetailsSidebarPanels(){if(!this.visible)return;var e=this._contentBrowser.currentRepresentedObjects,t=WI.detailsSidebar.sidebarPanels,i=!t.length;this._ignoreDetailsSidebarPanelSelectedEvent=!0,this._ignoreDetailsSidebarPanelCollapsedEvent=!0;let n=0;for(var s=0;s<this.detailsSidebarPanels.length;++s){var a=this.detailsSidebarPanels[s];if(a.inspect(e)){if(t.includes(a))continue;let d=s-n;WI.detailsSidebar.insertSidebarPanel(a,d),this._lastSelectedDetailsSidebarPanelSetting.value===a.identifier&&(WI.detailsSidebar.selectedSidebarPanel=a)}else WI.detailsSidebar.removeSidebarPanel(a),n++}!WI.detailsSidebar.selectedSidebarPanel&&t.length&&(WI.detailsSidebar.selectedSidebarPanel=t[0]),WI.detailsSidebar.sidebarPanels.length?i&&(WI.detailsSidebar.collapsed=this.detailsSidebarCollapsedSetting.value):WI.detailsSidebar.collapsed=!0,this._ignoreDetailsSidebarPanelCollapsedEvent=!1,this._ignoreDetailsSidebarPanelSelectedEvent=!1,this.detailsSidebarPanels.length&&(this._showDetailsSidebarItem.enabled=WI.detailsSidebar.sidebarPanels.length)}showRepresentedObject(e,t){this.navigationSidebarPanel&&this.navigationSidebarPanel.cancelRestoringState(),this.contentBrowser.showContentViewForRepresentedObject(e,t)}contentBrowserTreeElementForRepresentedObject(e,t){return this.treeElementForRepresentedObject(t)}treeElementForRepresentedObject(e){return this.navigationSidebarPanel?this.navigationSidebarPanel.treeElementForRepresentedObject(e):null}_navigationSidebarCollapsedStateDidChange(e){!this.visible||(this._showNavigationSidebarItem.activated=!WI.navigationSidebar.collapsed,!this._ignoreNavigationSidebarPanelCollapsedEvent&&(this.navigationSidebarCollapsedSetting.value=WI.navigationSidebar.collapsed))}_detailsSidebarCollapsedStateDidChange(e){!this.visible||(this._showDetailsSidebarItem.activated=!WI.detailsSidebar.collapsed,this._showDetailsSidebarItem.enabled=WI.detailsSidebar.sidebarPanels.length,!this._ignoreDetailsSidebarPanelCollapsedEvent&&(this.detailsSidebarCollapsedSetting.value=WI.detailsSidebar.collapsed))}_detailsSidebarPanelSelected(e){!this.visible||(this._showDetailsSidebarItem.activated=!WI.detailsSidebar.collapsed,this._showDetailsSidebarItem.enabled=WI.detailsSidebar.sidebarPanels.length,!(!WI.detailsSidebar.selectedSidebarPanel||this._ignoreDetailsSidebarPanelSelectedEvent)&&(this._lastSelectedDetailsSidebarPanelSetting.value=WI.detailsSidebar.selectedSidebarPanel.identifier))}_contentBrowserCurrentContentViewDidChange(e){let t=this._contentBrowser.currentContentView;!t||this._revealAndSelectRepresentedObject(t.representedObject)}_revealAndSelectRepresentedObject(e){if(this.navigationSidebarPanel){for(let i of this.navigationSidebarPanel.contentTreeOutlines)if(i.processingSelectionChange)return}let t=this.treeElementForRepresentedObject(e);t?t.revealAndSelect(!0,!1,!0):this.navigationSidebarPanel&&this.navigationSidebarPanel.contentTreeOutline.selectedTreeElement&&this.navigationSidebarPanel.contentTreeOutline.selectedTreeElement.deselect(!0)}_contentBrowserCurrentRepresentedObjectsDidChange(){this.managesNavigationSidebarPanel&&this.showNavigationSidebarPanel(),this.showDetailsSidebarPanels()}};WI.DOMDetailsSidebarPanel=class extends WI.DetailsSidebarPanel{constructor(e,t,i){super(e,t,i),this.element.addEventListener("click",this._mouseWasClicked.bind(this),!0),this._domNode=null}inspect(e){e instanceof Array||(e=[e]);for(var t=null,i=0;i<e.length;++i)if(e[i]instanceof WI.DOMNode){t=e[i];break}return t&&!this.supportsDOMNode(t)&&(t=null),this.domNode=t,!!this._domNode}get domNode(){return this._domNode}set domNode(e){e!==this._domNode&&(this._domNode&&this.removeEventListeners(),this._domNode=e,this._domNode&&this.addEventListeners(),this.needsLayout())}supportsDOMNode(e){return!0}addEventListeners(){}removeEventListeners(){}_mouseWasClicked(e){if(this._domNode&&this._domNode.ownerDocument){var t=WI.networkManager.resourceForURL(this._domNode.ownerDocument.documentURL);if(t)var i=t.parentFrame}const n={ignoreNetworkTab:!0,ignoreSearchTab:!0};WI.handlePossibleLinkClick(e,i,n)}};WI.FolderTreeElement=class extends WI.GeneralTreeElement{constructor(e,t){const i=[WI.FolderTreeElement.FolderIconStyleClassName],n=null;super(i,e,n,t,{hasChildren:!0})}};WI.FolderTreeElement.FolderIconStyleClassName="folder-icon";WI.FolderizedTreeElement=class extends WI.GeneralTreeElement{constructor(e,t,i,n){super(e,t,i,n),this.shouldRefreshChildren=!0,this._folderExpandedSettingMap=new Map,this._folderSettingsKey="",this._folderTypeMap=new Map,this._folderizeSettingsMap=new Map,this._groupedIntoFolders=!1,this._clearNewChildQueue()}get groupedIntoFolders(){return this._groupedIntoFolders}set folderSettingsKey(e){this._folderSettingsKey=e}registerFolderizeSettings(e,t,i,n){console.assert(e),console.assert(t||t===null),console.assert(i),console.assert(typeof n=="function");let s={type:e,displayName:t,topLevel:t===null,representedObject:i,treeElementConstructor:n};this._folderizeSettingsMap.set(e,s)}removeChildren(){super.removeChildren(),this._clearNewChildQueue(),this._folderExpandedSettingMap.clear(),this._folderTypeMap.clear(),this._groupedIntoFolders=!1}addChildForRepresentedObject(e){var t=this._settingsForRepresentedObject(e);if(console.assert(t),!t){console.error("No settings for represented object",e);return}if(!this.treeOutline){this.shouldRefreshChildren=!0;return}var i=this.treeOutline.getCachedTreeElement(e);i||(i=new t.treeElementConstructor(e)),this._addTreeElement(i)}addRepresentedObjectToNewChildQueue(e){this._newChildQueue.push(e),this._newChildQueueTimeoutIdentifier||(this._newChildQueueTimeoutIdentifier=setTimeout(this._populateFromNewChildQueue.bind(this),WI.FolderizedTreeElement.NewChildQueueUpdateInterval))}removeChildForRepresentedObject(e){if(this._removeRepresentedObjectFromNewChildQueue(e),this.updateParentStatus(),!this.treeOutline){this.shouldRefreshChildren=!0;return}var t=this.treeOutline.getCachedTreeElement(e);!t||!t.parent||this._removeTreeElement(t)}compareChildTreeElements(e,t){return this._compareTreeElementsByMainTitle(e,t)}updateParentStatus(){let e=!1;for(let t of this._folderizeSettingsMap.values())if(t.representedObject.size){e=!0;break}this.hasChildren=e,this.hasChildren||this.removeChildren()}prepareToPopulate(){return!this._groupedIntoFolders&&this._shouldGroupIntoFolders()?(this._groupedIntoFolders=!0,!0):!1}_clearNewChildQueue(){this._newChildQueue=[],this._newChildQueueTimeoutIdentifier&&(clearTimeout(this._newChildQueueTimeoutIdentifier),this._newChildQueueTimeoutIdentifier=null)}_populateFromNewChildQueue(){if(!this.children.length){this.updateParentStatus(),this.shouldRefreshChildren=!0;return}if(this.prepareToPopulate()){this._clearNewChildQueue(),this.shouldRefreshChildren=!0;return}for(var e=0;e<this._newChildQueue.length;++e)this.addChildForRepresentedObject(this._newChildQueue[e]);this._clearNewChildQueue()}_removeRepresentedObjectFromNewChildQueue(e){this._newChildQueue.remove(e)}_addTreeElement(e){if(console.assert(e),!!e){var t=e.selected;this._removeTreeElement(e,!0,!0);var i=this._parentTreeElementForRepresentedObject(e.representedObject);i!==this&&!i.parent&&this._insertFolderTreeElement(i),this._insertChildTreeElement(i,e),t&&e.revealAndSelect(!0,!1,!0)}}_compareTreeElementsByMainTitle(e,t){let i=e instanceof WI.FolderTreeElement,n=t instanceof WI.FolderTreeElement;return i&&!n?-1:n&&!i?1:e.mainTitle.extendedLocaleCompare(t.mainTitle)}_insertFolderTreeElement(e){console.assert(this._groupedIntoFolders),console.assert(!e.parent),this.insertChild(e,insertionIndexForObjectInListSortedByFunction(e,this.children,this._compareTreeElementsByMainTitle))}_insertChildTreeElement(e,t){console.assert(!t.parent),e.insertChild(t,insertionIndexForObjectInListSortedByFunction(t,e.children,this.compareChildTreeElements.bind(this)))}_removeTreeElement(e,t,i){var n=e.parent;!n||(n.removeChild(e,t,i),n!==this&&(console.assert(n instanceof WI.FolderTreeElement),n instanceof WI.FolderTreeElement&&(n.children.length||n.parent.removeChild(n))))}_parentTreeElementForRepresentedObject(e){if(!this._groupedIntoFolders)return this;console.assert(this._folderSettingsKey!=="");function t(s){let a=new WI.FolderTreeElement(s.displayName,s.representedObject),d=new WI.Setting(s.type+"-folder-expanded-"+this._folderSettingsKey,!1);return this._folderExpandedSettingMap.set(a,d),d.value&&a.expand(),a.onexpand=this._folderTreeElementExpandedStateChange.bind(this),a.oncollapse=this._folderTreeElementExpandedStateChange.bind(this),a}var i=this._settingsForRepresentedObject(e);if(!i)return console.error("Unknown representedObject",e),this;if(i.topLevel)return this;var n=this._folderTypeMap.get(i.type);return n||(n=t.call(this,i),this._folderTypeMap.set(i.type,n),n)}_folderTreeElementExpandedStateChange(e){let t=this._folderExpandedSettingMap.get(e);console.assert(t,"No expanded setting for folderTreeElement",e),t&&(t.value=e.expanded)}_settingsForRepresentedObject(e){for(let t of this._folderizeSettingsMap.values())if(t.representedObject.objectIsRequiredType(e))return t;return null}_shouldGroupIntoFolders(){if(this._groupedIntoFolders)return!0;var e=0,t=0,i=!1;function n(a){return a?i?!0:a>=WI.FolderizedTreeElement.LargeChildCountThreshold?e||t?!0:(i=!0,!1):a>=WI.FolderizedTreeElement.MediumChildCountThreshold?++t>=WI.FolderizedTreeElement.NumberOfMediumCategoriesThreshold:(++e,!1):!1}for(var s of this._folderizeSettingsMap.values())if(n(s.representedObject.size))return!0;return!1}};WI.FolderizedTreeElement.MediumChildCountThreshold=5;WI.FolderizedTreeElement.LargeChildCountThreshold=15;WI.FolderizedTreeElement.NumberOfMediumCategoriesThreshold=2;WI.FolderizedTreeElement.NewChildQueueUpdateInterval=500;WI.NetworkDetailView=class extends WI.View{constructor(e,t){super(),this._representedObject=e,this._delegate=t||null,this.element.classList.add("network-detail"),this._contentBrowser=null,this._detailNavigationItemMap=new Map,this._contentViewCookie=null}get representedObject(){return this._representedObject}shown(){!this._contentBrowser||(this._showPreferredContentView(),this._contentViewCookie&&(this._contentBrowser.showContentView(this._contentBrowser.currentContentView,this._contentViewCookie),this._contentViewCookie=null),this._contentBrowser.shown())}hidden(){this._contentBrowser.hidden()}dispose(){this._delegate=null,this._contentBrowser.contentViewContainer.closeAllContentViews()}willShowWithCookie(e){this._contentViewCookie=e}initialLayout(){let e=new WI.ButtonNavigationItem("close",WI.UIString("Close detail view"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='square' d='M 2.5 2.5 L 13.5 13.5 M 2.5 13.5 L 13.5 2.5'/%3e %3c/svg%3e",16,16);e.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._handleCloseButton.bind(this)),e.visibilityPriority=WI.NavigationItem.VisibilityPriority.High;let t=new WI.GroupNavigationItem,i=new WI.FlexibleSpaceNavigationItem(t,WI.FlexibleSpaceNavigationItem.Align.End);i.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low;const n=null,s=!0,a=!1;this._contentBrowser=new WI.ContentBrowser(n,this,s,a,i,t);let d=0;this._contentBrowser.navigationBar.insertNavigationItem(e,d++),this._contentBrowser.navigationBar.insertNavigationItem(new WI.FlexibleSpaceNavigationItem,d++);for(let p of this._detailNavigationItemMap.values())this._contentBrowser.navigationBar.insertNavigationItem(p,d++);this._contentBrowser.navigationBar.addEventListener(WI.NavigationBar.Event.NavigationItemSelected,this._navigationItemSelected,this),this.addSubview(this._contentBrowser),this._showPreferredContentView()}createDetailNavigationItem(e,t){this._detailNavigationItemMap.set(e,new WI.RadioButtonNavigationItem(e,t))}detailNavigationItemForIdentifier(e){return this._detailNavigationItemMap.get(e)}showContentViewForIdentifier(e){}_showPreferredContentView(){let e=Array.from(this._detailNavigationItemMap.values()),t=null,i=WI.settings.selectedNetworkDetailContentViewIdentifier.value;for(let n of this._contentBrowser.navigationBar.navigationItems)if(n instanceof WI.RadioButtonNavigationItem&&!!e.includes(n)&&(t||(t=n),n.identifier===i)){this._contentBrowser.navigationBar.selectedNavigationItem=n;return}console.assert(t,"Should have found at least one navigation item above"),this._contentBrowser.navigationBar.selectedNavigationItem=t}_navigationItemSelected(e){let t=e.target.selectedNavigationItem;t instanceof WI.RadioButtonNavigationItem&&(this.showContentViewForIdentifier(t.identifier),console.assert(t.identifier),WI.settings.selectedNetworkDetailContentViewIdentifier.value=t.identifier)}_handleCloseButton(e){this._delegate&&this._delegate.networkDetailViewClose&&this._delegate.networkDetailViewClose(this)}};WI.NetworkTabContentView=class extends WI.TabContentView{constructor(e){let t=WI.GeneralTabBarItem.fromTabInfo(WI.NetworkTabContentView.tabInfo());super(e||"network","network",t),this._networkTableContentView=new WI.NetworkTableContentView;const i=!0,n=!0;this._contentBrowser=new WI.ContentBrowser(null,this,i,n),this._contentBrowser.showContentView(this._networkTableContentView);let s=this._networkTableContentView.filterNavigationItems;for(let a=0;a<s.length;++a)this._contentBrowser.navigationBar.insertNavigationItem(s[a],a);this.addSubview(this._contentBrowser)}static tabInfo(){return{image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3ccircle fill='none' stroke='currentColor' cx='8' cy='8' r='7.5'/%3e %3cpath fill='none' stroke='currentColor' d='M 5.5 1.0 L 5.5 10.5'/%3e %3cpath fill='none' stroke='currentColor' d='M 3.0 9.0 L 5.5 11.0 L 8.0 9.0'/%3e %3cpath fill='none' stroke='currentColor' d='M 10.5 15.0 L 10.5 5.5'/%3e %3cpath fill='none' stroke='currentColor' d='M 13.0 7.0 L 10.5 5.0 L 8.0 7.0'/%3e %3c/svg%3e",title:WI.UIString("Network")}}static isTabAllowed(){return!!window.NetworkAgent}shown(){super.shown(),this._contentBrowser.shown()}hidden(){this._contentBrowser.hidden(),super.hidden()}closed(){this._contentBrowser.contentViewContainer.closeAllContentViews(),super.closed()}async handleFileDrop(e){await WI.FileUtilities.readJSON(e,t=>this._networkTableContentView.processHAR(t))}get contentBrowser(){return this._contentBrowser}get type(){return WI.NetworkTabContentView.Type}canShowRepresentedObject(e){return e instanceof WI.Resource}showRepresentedObject(e,t){console.assert(this._contentBrowser.currentContentView===this._networkTableContentView),this._networkTableContentView.showRepresentedObject(e,t)}get supportsSplitContentBrowser(){return!0}};WI.NetworkTabContentView.Type="network";WI.NewTabContentView=class extends WI.TabContentView{constructor(e){let t=WI.GeneralTabBarItem.fromTabInfo(WI.NewTabContentView.tabInfo());t.isDefaultTab=!0,super(e||"new-tab","new-tab",t),this._tabElementsByTabClass=new Map;let i=Array.from(WI.knownTabClasses());this._shownTabClasses=i.filter(n=>n.isTabAllowed()&&!n.tabInfo().isEphemeral),this._shownTabClasses.sort((n,s)=>n.tabInfo().title.extendedLocaleCompare(s.tabInfo().title))}static tabInfo(){return{image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect fill='none' stroke='currentColor' x='0.5' y='0.5' width='15' height='15' rx='2'/%3e %3cpath fill='none' stroke='currentColor' d='M 8 3 L 8 13 M 3 8 L 13 8'/%3e %3c/svg%3e",title:WI.UIString("New Tab"),isEphemeral:!0}}static shouldSaveTab(){return!1}get type(){return WI.NewTabContentView.Type}shown(){WI.tabBar.addEventListener(WI.TabBar.Event.TabBarItemAdded,this._updateTabItems,this),WI.tabBar.addEventListener(WI.TabBar.Event.TabBarItemRemoved,this._updateTabItems,this),this._updateTabItems()}hidden(){WI.tabBar.removeEventListener(null,null,this)}get supportsSplitContentBrowser(){return!1}layout(){this._tabElementsByTabClass.clear(),this.element.removeChildren();for(let e of this._shownTabClasses){let t=document.createElement("div");t.classList.add("tab-item"),t.addEventListener("click",this._createNewTabWithType.bind(this,e.Type)),t[WI.NewTabContentView.TypeSymbol]=e.Type;let i=t.appendChild(document.createElement("div"));i.classList.add("box");let n=e.tabInfo(),s=i.appendChild(document.createElement("img"));s.src=n.image;let a=t.appendChild(document.createElement("label"));a.textContent=n.title,this.element.appendChild(t),this._tabElementsByTabClass.set(e,t)}this._updateTabItems()}_createNewTabWithType(e,t){if(!WI.isNewTabWithTypeAllowed(e))return;const i=this._allowableTabTypes().length>1,n={referencedView:this,shouldReplaceTab:!i||!WI.modifierKeys.metaKey,shouldShowNewTab:!WI.modifierKeys.metaKey};WI.createNewTabWithType(e,n)}_allowableTabTypes(){return this._shownTabClasses.map(t=>t.Type).filter(t=>WI.isNewTabWithTypeAllowed(t))}_updateTabItems(){for(let[e,t]of this._tabElementsByTabClass.entries()){let i=WI.isNewTabWithTypeAllowed(e.Type);t.classList.toggle(WI.NewTabContentView.DisabledStyleClassName,!i)}}};WI.NewTabContentView.Type="new-tab";WI.NewTabContentView.TypeSymbol=Symbol("type");WI.NewTabContentView.TabItemStyleClassName="tab-item";WI.NewTabContentView.DisabledStyleClassName="disabled";WI.ObjectTreeBaseTreeElement=class extends WI.GeneralTreeElement{constructor(e,t,i){console.assert(e),console.assert(t instanceof WI.PropertyPath),console.assert(!i||i instanceof WI.PropertyDescriptor);const n=null,s=null,a=null;super(n,s,a,e),this._property=i,this._propertyPath=t,this.toggleOnClick=!0,this.selectable=!1,this.tooltipHandledSeparately=!0}get property(){return this._property}get propertyPath(){return this._propertyPath}resolvedValue(){return console.assert(this._property),this._getterValue?this._getterValue:this._property.hasValue()?this._property.value:null}resolvedValuePropertyPath(){return console.assert(this._property),this._getterValue?this._propertyPath.appendPropertyDescriptor(this._getterValue,this._property,WI.PropertyPath.Type.Value):this._property.hasValue()?this._propertyPath.appendPropertyDescriptor(this._property.value,this._property,WI.PropertyPath.Type.Value):null}thisPropertyPath(){return console.assert(this._property),this._propertyPath.appendPropertyDescriptor(null,this._property,this.propertyPathType())}hadError(){return console.assert(this._property),this._property.wasThrown||this._getterHadError}propertyPathType(){return console.assert(this._property),this._getterValue||this._property.hasValue()?WI.PropertyPath.Type.Value:this._property.hasGetter()?WI.PropertyPath.Type.Getter:this._property.hasSetter()?WI.PropertyPath.Type.Setter:WI.PropertyPath.Type.Value}propertyPathString(e){return e.isFullPathImpossible()?WI.UIString("Unable to determine path to property from root"):e.displayPath(this.propertyPathType())}createGetterElement(e){var t=document.createElement("img");return t.className="getter",e?(t.title=WI.UIString("Invoke getter"),t.addEventListener("click",i=>{i.stopPropagation();var n=this._propertyPath.lastNonPrototypeObject,s=this._property.get;n.invokeGetter(s,(a,d,p)=>{this._getterHadError=!!(a||p),this._getterValue=d,this.invokedGetter&&typeof this.invokedGetter=="function"&&this.invokedGetter()})}),t):(t.classList.add("disabled"),t.title=WI.UIString("Getter"),t)}createSetterElement(e){var t=document.createElement("img");return t.className="setter",t.title=WI.UIString("Setter"),e||t.classList.add("disabled"),t}populateContextMenu(e,t){if(t.__addedObjectPreviewContextMenuItems||t.__addedObjectTreeContextMenuItems)return;t.__addedObjectTreeContextMenuItems=!0,typeof this.treeOutline.objectTreeElementAddContextMenuItems=="function"&&(this.treeOutline.objectTreeElementAddContextMenuItems(this,e),e.isEmpty()||e.appendSeparator());let i=this.resolvedValue();if(!i)return;this._property&&this._property.symbol&&e.appendItem(WI.UIString("Log Symbol"),this._logSymbolProperty.bind(this)),e.appendItem(WI.UIString("Log Value"),this._logValue.bind(this));let n=this.resolvedValuePropertyPath();n&&!n.isFullPathImpossible()&&e.appendItem(WI.UIString("Copy Path to Property"),()=>{InspectorFrontendHost.copyText(n.displayPath(WI.PropertyPath.Type.Value))}),e.appendSeparator(),this._appendMenusItemsForObject(e,i),super.populateContextMenu(e,t)}_logSymbolProperty(){var e=this._property.symbol;if(!!e){var t=WI.UIString("Selected Symbol");WI.consoleLogViewController.appendImmediateExecutionWithResult(t,e,!0)}}_logValue(e){var t=e||this.resolvedValue();if(!!t){var i=this.resolvedValuePropertyPath(),n=i.isFullPathImpossible(),s=n?WI.UIString("Selected Value"):i.displayPath(this.propertyPathType());n||WI.quickConsole.prompt.pushHistoryItem(s),WI.consoleLogViewController.appendImmediateExecutionWithResult(s,t,n)}}_appendMenusItemsForObject(e,t){if(t.type==="function"){isFunctionStringNativeCode(t.description)||e.appendItem(WI.UIString("Jump to Definition"),function(){t.target.DebuggerAgent.getFunctionDetails(t.objectId,function(i,n){if(i)return;let s=n.location,a=WI.debuggerManager.scriptForIdentifier(s.scriptId,t.target);if(!a)return;let d=a.createSourceCodeLocation(s.lineNumber,s.columnNumber||0);const p={ignoreNetworkTab:!0,ignoreSearchTab:!0};WI.showSourceCodeLocation(d,p)})});return}}};WI.SourceCodeTreeElement=class extends WI.FolderizedTreeElement{constructor(e,t,i,n,s){console.assert(e instanceof WI.SourceCode),super(t,i,n,s||e),this._updateSourceCode(e)}updateSourceMapResources(){!this.treeOutline||!this.treeOutline.includeSourceMapResourceChildren||(this.hasChildren=!!this._sourceCode.sourceMaps.length,this.shouldRefreshChildren=this.hasChildren,this.hasChildren||this.removeChildren())}onattach(){super.onattach(),this.updateSourceMapResources()}onpopulate(){if(!this.treeOutline||!this.treeOutline.includeSourceMapResourceChildren||!this.hasChildren||!this.shouldRefreshChildren)return;this.shouldRefreshChildren=!1,this.removeChildren();function e(b,w){console.assert(b.children.length===1);for(var S=[],E=w;E!==b;E=E.parent)S.push(E.mainTitle);S.push(b.mainTitle);var k=S.reverse().join("/"),R=new WI.FolderTreeElement(k),M=b.parent.children.indexOf(b);b.parent.insertChild(R,M),b.parent.removeChild(b);var L=w.children;w.removeChildren();for(var V=0;V<L.length;++V)R.appendChild(L[V])}function t(b,w){if(!(b instanceof WI.FolderTreeElement)){w&&w!==b.parent&&e(w,b.parent);return}w&&b.children.length!==1&&(e(w,b),w=null),!w&&b.children.length===1&&(w=b);for(var S=0;S<b.children.length;++S)t(b.children[S],w)}for(var i=this._sourceCode.sourceMaps,n=0;n<i.length;++n)for(var s=i[n],a=0;a<s.resources.length;++a){var d=s.resources[a],p=d.sourceMapDisplaySubpath,f=this.createFoldersAsNeededForSubpath(p),_=new WI.SourceMapResourceTreeElement(d);f.insertChild(_,insertionIndexForObjectInListSortedByFunction(_,f.children,WI.ResourceTreeElement.compareFolderAndResourceTreeElements))}for(var n=0;n<this.children.length;++n)t(this.children[n],null)}descendantResourceTreeElementTypeDidChange(e,t){console.assert(this.hasChildren);let i=e.parent,n=i.expanded,s=e.selected;i.removeChild(e,!0,!0),i.insertChild(e,insertionIndexForObjectInListSortedByFunction(e,i.children,WI.ResourceTreeElement.compareFolderAndResourceTreeElements)),n&&i.expand(),s&&e.revealAndSelect(!0,!1,!0)}_updateSourceCode(e){console.assert(e instanceof WI.SourceCode),this._sourceCode!==e&&(this._sourceCode&&this._sourceCode.removeEventListener(WI.SourceCode.Event.SourceMapAdded,this.updateSourceMapResources,this),this._sourceCode=e,this._sourceCode.addEventListener(WI.SourceCode.Event.SourceMapAdded,this.updateSourceMapResources,this),this.updateSourceMapResources())}};WI.StorageTreeElement=class extends WI.GeneralTreeElement{constructor(e,t,i){super(e,t,null,i),this.flattened=!1,this.tooltipHandledSeparately=!0}get flattened(){return this._flattened}set flattened(e){if(this._flattened!==e){if(this._flattened=e,!this._flattened){this.mainTitle=this.name,this.subtitle=this.secondaryName,this._updateChildrenTitles();return}this.mainTitle=this.categoryName,this.subtitle=this.name,this._updateChildrenTitles()}}_updateChildrenTitles(){for(var e=0;e<this.children.length;++e)typeof this.children[e].updateTitles=="function"&&this.children[e].updateTitles()}};WI.TimelineDataGridNodePathComponent=class extends WI.HierarchicalPathComponent{constructor(e,t){super(e.displayName(),e.iconClassNames(),t||e.record),this._timelineDataGridNode=e}get timelineDataGridNode(){return this._timelineDataGridNode}get previousSibling(){let e=this._timelineDataGridNode.previousSibling;for(;e&&e.hidden;)e=e.previousSibling;return e?new WI.TimelineDataGridNodePathComponent(e):null}get nextSibling(){let e=this._timelineDataGridNode.nextSibling;for(;e&&e.hidden;)e=e.nextSibling;return e?new WI.TimelineDataGridNodePathComponent(e):null}};WI.TimelineOverview=class extends WI.View{constructor(e){if(super(),console.assert(e instanceof WI.TimelineRecording),this._timelinesViewModeSettings=this._createViewModeSettings(WI.TimelineOverview.ViewMode.Timelines,WI.TimelineOverview.MinimumDurationPerPixel,WI.TimelineOverview.MaximumDurationPerPixel,.01,0,15),this._instrumentTypes=WI.TimelineManager.availableTimelineTypes(),WI.FPSInstrument.supported()){let i=1/WI.TimelineRecordFrame.MaximumWidthPixels,n=1/WI.TimelineRecordFrame.MinimumWidthPixels;this._renderingFramesViewModeSettings=this._createViewModeSettings(WI.TimelineOverview.ViewMode.RenderingFrames,i,n,i,0,100)}this._recording=e,this._recording.addEventListener(WI.TimelineRecording.Event.InstrumentAdded,this._instrumentAdded,this),this._recording.addEventListener(WI.TimelineRecording.Event.InstrumentRemoved,this._instrumentRemoved,this),this._recording.addEventListener(WI.TimelineRecording.Event.MarkerAdded,this._markerAdded,this),this._recording.addEventListener(WI.TimelineRecording.Event.Reset,this._recordingReset,this),this.element.classList.add("timeline-overview"),this._updateWheelAndGestureHandlers(),this._graphsContainerView=new WI.View,this._graphsContainerView.element.classList.add("graphs-container"),this._graphsContainerView.element.addEventListener("click",this._handleGraphsContainerClick.bind(this)),this.addSubview(this._graphsContainerView),this._selectedTimelineRecord=null,this._overviewGraphsByTypeMap=new Map,this._editInstrumentsButton=new WI.ActivateButtonNavigationItem("toggle-edit-instruments",WI.UIString("Edit configuration"),WI.UIString("Save configuration")),this._editInstrumentsButton.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._toggleEditingInstruments,this),this._editingInstruments=!1,this._updateEditInstrumentsButton();let t=new WI.NavigationBar;t.element.classList.add("timelines"),t.addNavigationItem(new WI.FlexibleSpaceNavigationItem),t.addNavigationItem(this._editInstrumentsButton),this.addSubview(t),this._timelinesTreeOutline=new WI.TreeOutline,this._timelinesTreeOutline.element.classList.add("timelines"),this._timelinesTreeOutline.disclosureButtons=!1,this._timelinesTreeOutline.large=!0,this._timelinesTreeOutline.addEventListener(WI.TreeOutline.Event.SelectionDidChange,this._timelinesTreeSelectionDidChange,this),this.element.appendChild(this._timelinesTreeOutline.element),this._treeElementsByTypeMap=new Map,this._timelineRuler=new WI.TimelineRuler,this._timelineRuler.allowsClippedLabels=!0,this._timelineRuler.allowsTimeRangeSelection=!0,this._timelineRuler.element.addEventListener("mousedown",this._timelineRulerMouseDown.bind(this)),this._timelineRuler.element.addEventListener("click",this._timelineRulerMouseClicked.bind(this)),this._timelineRuler.addEventListener(WI.TimelineRuler.Event.TimeRangeSelectionChanged,this._timeRangeSelectionChanged,this),this.addSubview(this._timelineRuler),this._currentTimeMarker=new WI.TimelineMarker(0,WI.TimelineMarker.Type.CurrentTime),this._timelineRuler.addMarker(this._currentTimeMarker),this._scrollContainerElement=document.createElement("div"),this._scrollContainerElement.classList.add("scroll-container"),this._scrollContainerElement.addEventListener("scroll",this._handleScrollEvent.bind(this)),this.element.appendChild(this._scrollContainerElement),this._scrollWidthSizer=document.createElement("div"),this._scrollWidthSizer.classList.add("scroll-width-sizer"),this._scrollContainerElement.appendChild(this._scrollWidthSizer),this._startTime=0,this._currentTime=0,this._revealCurrentTime=!1,this._endTime=0,this._pixelAlignDuration=!1,this._mouseWheelDelta=0,this._cachedScrollContainerWidth=NaN,this._timelineRulerSelectionChanged=!1,this._viewMode=WI.TimelineOverview.ViewMode.Timelines,this._selectedTimeline=null;for(let i of this._recording.instruments)this._instrumentAdded(i);WI.timelineManager.isCapturingPageReload()||this._resetSelection(),this._viewModeDidChange(),WI.timelineManager.addEventListener(WI.TimelineManager.Event.CapturingStateChanged,this._handleTimelineCapturingStateChanged,this),WI.timelineManager.addEventListener(WI.TimelineManager.Event.RecordingImported,this._recordingImported,this)}exportData(){let e={secondsPerPixel:this.secondsPerPixel,scrollStartTime:this.scrollStartTime,selectionStartTime:this.selectionStartTime,selectionDuration:this.selectionDuration};return this._selectedTimeline&&(e.selectedTimelineType=this._selectedTimeline.type),e}get selectedTimeline(){return this._selectedTimeline}set selectedTimeline(e){if(!this._editingInstruments&&this._selectedTimeline!==e)if(this._selectedTimeline=e,this._selectedTimeline){let t=this._treeElementsByTypeMap.get(this._selectedTimeline.type);console.assert(t,"Missing tree element for timeline",this._selectedTimeline);let i=!0,n=!1;t.select(i,n)}else this._timelinesTreeOutline.selectedTreeElement&&this._timelinesTreeOutline.selectedTreeElement.deselect()}get editingInstruments(){return this._editingInstruments}get viewMode(){return this._viewMode}set viewMode(e){this._editingInstruments||this._viewMode!==e&&(this._viewMode=e,this._viewModeDidChange())}get startTime(){return this._startTime}set startTime(e){if(e=e||0,this._startTime!==e){if(this._viewMode!==WI.TimelineOverview.ViewMode.RenderingFrames){let t=this.selectionStartTime-this._startTime;this.selectionStartTime=t+e}this._startTime=e,this.needsLayout()}}get currentTime(){return this._currentTime}set currentTime(e){e=e||0,this._currentTime!==e&&(this._currentTime=e,this._revealCurrentTime=!0,this.needsLayout())}get secondsPerPixel(){return this._currentSettings.durationPerPixelSetting.value}set secondsPerPixel(e){e=Math.min(this._currentSettings.maximumDurationPerPixel,Math.max(this._currentSettings.minimumDurationPerPixel,e)),this.secondsPerPixel!==e&&(this._pixelAlignDuration&&(e=1/Math.round(1/e),this.secondsPerPixel===e)||(this._currentSettings.durationPerPixelSetting.value=e,this.needsLayout()))}get pixelAlignDuration(){return this._pixelAlignDuration}set pixelAlignDuration(e){this._pixelAlignDuration!==e&&(this._mouseWheelDelta=0,this._pixelAlignDuration=e,this._pixelAlignDuration&&(this.secondsPerPixel=1/Math.round(1/this.secondsPerPixel)))}get endTime(){return this._endTime}set endTime(e){e=e||0,this._endTime!==e&&(this._endTime=e,this.needsLayout())}get scrollStartTime(){return this._currentSettings.scrollStartTime}set scrollStartTime(e){e=e||0,this.scrollStartTime!==e&&(this._currentSettings.scrollStartTime=e,this.needsLayout())}get scrollContainerWidth(){return this._cachedScrollContainerWidth}get visibleDuration(){return isNaN(this._cachedScrollContainerWidth)&&(this._cachedScrollContainerWidth=this._scrollContainerElement.offsetWidth,this._cachedScrollContainerWidth||(this._cachedScrollContainerWidth=NaN)),this._cachedScrollContainerWidth*this.secondsPerPixel}get selectionStartTime(){return this._timelineRuler.selectionStartTime}set selectionStartTime(e){if(e=e||0,this._timelineRuler.selectionStartTime===e)return;let t=this.selectionDuration;this._timelineRuler.selectionStartTime=e,this._timelineRuler.selectionEndTime=e+t}get selectionDuration(){return this._timelineRuler.selectionEndTime-this._timelineRuler.selectionStartTime}set selectionDuration(e){e=Math.max(this._timelineRuler.minimumSelectionDuration,e),this._timelineRuler.selectionEndTime=this._timelineRuler.selectionStartTime+e}get height(){let e=0;for(let t of this._overviewGraphsByTypeMap.values())t.visible&&(e+=t.height);return e}get visible(){return this._visible}shown(){this._visible=!0;for(let[e,t]of this._overviewGraphsByTypeMap)this._canShowTimelineType(e)&&t.shown();this.updateLayout(WI.View.LayoutReason.Resize)}hidden(){this._visible=!1;for(let e of this._overviewGraphsByTypeMap.values())e.hidden();this.hideScanner()}closed(){WI.timelineManager.removeEventListener(null,null,this),super.closed()}reset(){this._selectedTimelineRecord=null;for(let e of this._overviewGraphsByTypeMap.values())e.reset();this._mouseWheelDelta=0,this._resetSelection()}revealMarker(e){this.scrollStartTime=e.time-this.visibleDuration/2}recordWasFiltered(e,t,i){let n=this._overviewGraphsByTypeMap.get(e.type);console.assert(n,"Missing overview graph for timeline type "+e.type),n&&(console.assert(n.visible,"Record filtered in hidden overview graph",t),n.recordWasFiltered(t,i))}selectRecord(e,t){let i=this._overviewGraphsByTypeMap.get(e.type);console.assert(i,"Missing overview graph for timeline type "+e.type),i&&(console.assert(i.visible,"Record selected in hidden overview graph",t),i.selectedRecord=t)}showScanner(e){this._timelineRuler.showScanner(e)}hideScanner(){this._timelineRuler.hideScanner()}updateLayoutIfNeeded(e){if(this.layoutPending){super.updateLayoutIfNeeded(e);return}this._timelineRuler.updateLayoutIfNeeded(e);for(let t of this._overviewGraphsByTypeMap.values())t.visible&&t.updateLayoutIfNeeded(e)}discontinuitiesInTimeRange(e,t){return this._recording.discontinuitiesInTimeRange(e,t)}get timelineRuler(){return this._timelineRuler}layout(){let e=this._startTime,t=this._endTime,i=this._currentTime;if(this._viewMode===WI.TimelineOverview.ViewMode.RenderingFrames){let p=this._recording.timelines.get(WI.TimelineRecord.Type.RenderingFrame);console.assert(p,"Recoring missing rendering frames timeline"),e=0,t=p.records.length,i=t}let n=t-e,s=Math.ceil(n/this.secondsPerPixel);this._updateElementWidth(this._scrollWidthSizer,s),this._currentTimeMarker.time=i,this._revealCurrentTime&&(this.revealMarker(this._currentTimeMarker),this._revealCurrentTime=!1);const a=this.visibleDuration;let d=Math.min(this.scrollStartTime,t-a);if(d=Math.max(e,d),this._timelineRuler.zeroTime=e,this._timelineRuler.startTime=d,this._timelineRuler.secondsPerPixel=this.secondsPerPixel,!this._dontUpdateScrollLeft){this._ignoreNextScrollEvent=!0;let p=Math.ceil((d-e)/this.secondsPerPixel);p&&(this._scrollContainerElement.scrollLeft=p)}for(let p of this._overviewGraphsByTypeMap.values())!p.visible||(p.zeroTime=e,p.startTime=d,p.currentTime=i,p.endTime=d+a)}sizeDidChange(){this._cachedScrollContainerWidth=NaN}_updateElementWidth(e,t){var i=parseInt(e.style.width);i!==t&&(e.style.width=t+"px")}_handleScrollEvent(e){if(this._ignoreNextScrollEvent){this._ignoreNextScrollEvent=!1;return}this._dontUpdateScrollLeft=!0;let t=this._scrollContainerElement.scrollLeft;WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?this.scrollStartTime=this._startTime-t*this.secondsPerPixel:this.scrollStartTime=this._startTime+t*this.secondsPerPixel,this.updateLayoutIfNeeded(),this._dontUpdateScrollLeft=!1,this.element.classList.toggle("has-scrollbar",this._scrollContainerElement.clientHeight<=1)}_handleWheelEvent(e){if(e.__cloned||this._handlingGesture)return;if(Math.abs(e.deltaX)>=Math.abs(e.deltaY)*.5){let d=new e.constructor(e.type,e);d.__cloned=!0,this._scrollContainerElement.dispatchEvent(d);return}let t=e.pageX-this._graphsContainerView.element.totalOffsetLeft,i=this._currentSettings.scrollStartTime+t*this.secondsPerPixel,n=e.webkitDirectionInvertedFromDevice?1:-1,s=e.deltaY*(this.secondsPerPixel/WI.TimelineOverview.ScrollDeltaDenominator)*n;this._pixelAlignDuration&&(s<0&&this._mouseWheelDelta>=0||s>=0&&this._mouseWheelDelta<0)&&(this._mouseWheelDelta=0);let a=this.secondsPerPixel;this._mouseWheelDelta+=s,this.secondsPerPixel+=this._mouseWheelDelta,this.secondsPerPixel===this._currentSettings.minimumDurationPerPixel&&s<0||this.secondsPerPixel===this._currentSettings.maximumDurationPerPixel&&s>=0?this._mouseWheelDelta=0:this._mouseWheelDelta=a+this._mouseWheelDelta-this.secondsPerPixel,this.scrollStartTime=i-t*this.secondsPerPixel,this.element.classList.toggle("has-scrollbar",this._scrollContainerElement.clientHeight<=1),e.preventDefault(),e.stopPropagation()}_handleGestureStart(e){if(this._handlingGesture)return;let t=e.pageX-this._graphsContainerView.element.totalOffsetLeft,i=this._currentSettings.scrollStartTime+t*this.secondsPerPixel;this._handlingGesture=!0,this._gestureStartStartTime=i,this._gestureStartDurationPerPixel=this.secondsPerPixel,this.element.classList.toggle("has-scrollbar",this._scrollContainerElement.clientHeight<=1),e.preventDefault(),e.stopPropagation()}_handleGestureChange(e){let t=Math.max(.2,e.scale),i=e.pageX-this._graphsContainerView.element.totalOffsetLeft,n=this._gestureStartDurationPerPixel/t;this.secondsPerPixel=n,this.scrollStartTime=this._gestureStartStartTime-i*this.secondsPerPixel,e.preventDefault(),e.stopPropagation()}_handleGestureEnd(e){this._handlingGesture=!1,this._gestureStartStartTime=NaN,this._gestureStartDurationPerPixel=NaN}_instrumentAdded(e){let t=e instanceof WI.Instrument?e:e.data.instrument;console.assert(t instanceof WI.Instrument,t);let i=this._recording.timelineForInstrument(t);console.assert(!this._overviewGraphsByTypeMap.has(i.type),i),console.assert(!this._treeElementsByTypeMap.has(i.type),i);let n=new WI.TimelineTreeElement(i),s=insertionIndexForObjectInListSortedByFunction(n,this._timelinesTreeOutline.children,this._compareTimelineTreeElements.bind(this));this._timelinesTreeOutline.insertChild(n,s),this._treeElementsByTypeMap.set(i.type,n);let a=WI.TimelineOverviewGraph.createForTimeline(i,this);a.addEventListener(WI.TimelineOverviewGraph.Event.RecordSelected,this._handleOverviewGraphRecordSelected,this),this._overviewGraphsByTypeMap.set(i.type,a),this._graphsContainerView.insertSubviewBefore(a,this._graphsContainerView.subviews[s]),n.element.style.height=a.height+"px",this._canShowTimelineType(i.type)||(a.hidden(),n.hidden=!0),this.needsLayout()}_instrumentRemoved(e){let t=e.data.instrument;console.assert(t instanceof WI.Instrument,t);let i=this._recording.timelineForInstrument(t),n=this._overviewGraphsByTypeMap.get(i.type);console.assert(n,"Missing overview graph for timeline type",i.type);let s=this._treeElementsByTypeMap.get(i.type),a=!1,d=!0;this._timelinesTreeOutline.removeChild(s,a,d),n.removeEventListener(WI.TimelineOverviewGraph.Event.RecordSelected,this._handleOverviewGraphRecordSelected,this),this._graphsContainerView.removeSubview(n),this._overviewGraphsByTypeMap.delete(i.type),this._treeElementsByTypeMap.delete(i.type)}_markerAdded(e){this._timelineRuler.addMarker(e.data.marker)}_handleGraphsContainerClick(e){e.__timelineRecordClickEventHandled||this._recordSelected(null,null)}_timelineRulerMouseDown(e){this._timelineRulerSelectionChanged=!1}_timelineRulerMouseClicked(e){if(!this._timelineRulerSelectionChanged)for(let t of this._overviewGraphsByTypeMap.values()){if(!t.visible)continue;let i=t.element.getBoundingClientRect();if(!(e.pageX>=i.left&&e.pageX<=i.right&&e.pageY>=i.top&&e.pageY<=i.bottom))continue;let n=new e.constructor(e.type,e);t.element.dispatchEvent(n);return}}_timeRangeSelectionChanged(e){this._timelineRulerSelectionChanged=!0;let t=this._viewMode===WI.TimelineOverview.ViewMode.Timelines?this._startTime:0;this._currentSettings.selectionStartValueSetting.value=this.selectionStartTime-t,this._currentSettings.selectionDurationSetting.value=this.selectionDuration,this.dispatchEventToListeners(WI.TimelineOverview.Event.TimeRangeSelectionChanged)}_handleOverviewGraphRecordSelected(e){let{record:t,recordBar:i}=e.data;!t||this._recordSelected(t,i)}_recordSelected(e,t){if(e!==this._selectedTimelineRecord){if(this._selectedTimelineRecord&&(!e||this._selectedTimelineRecord.type!==e.type)){let i=this._overviewGraphsByTypeMap.get(this._selectedTimelineRecord.type);console.assert(i),i&&(i.selectedRecord=null)}if(this._selectedTimelineRecord=e,this._selectedTimelineRecord){let i=this._selectedTimelineRecord,n=this._selectedTimelineRecord;t&&(i=t.records[0],n=t.records.lastValue);let s=i instanceof WI.RenderingFrameTimelineRecord?i.frameIndex:i.startTime,a=n instanceof WI.RenderingFrameTimelineRecord?n.frameIndex:n.endTime;if(s<this.selectionStartTime||a>this.selectionStartTime+this.selectionDuration||i instanceof WI.CPUTimelineRecord){let d=this.secondsPerPixel*10;this.selectionStartTime=s-d,this.selectionDuration=a-s+d*2}}this.dispatchEventToListeners(WI.TimelineOverview.Event.RecordSelected,{record:this._selectedTimelineRecord})}}_resetSelection(){function e(t){t.durationPerPixelSetting.reset(),t.selectionStartValueSetting.reset(),t.selectionDurationSetting.reset()}e(this._timelinesViewModeSettings),this._renderingFramesViewModeSettings&&e(this._renderingFramesViewModeSettings),this.secondsPerPixel=this._currentSettings.durationPerPixelSetting.value,this.selectionStartTime=this._currentSettings.selectionStartValueSetting.value,this.selectionDuration=this._currentSettings.selectionDurationSetting.value}_recordingReset(e){this._timelineRuler.clearMarkers(),this._timelineRuler.addMarker(this._currentTimeMarker)}_canShowTimelineType(e){let t=WI.TimelineOverview.ViewMode.Timelines;return e===WI.TimelineRecord.Type.RenderingFrame&&(t=WI.TimelineOverview.ViewMode.RenderingFrames),t===this._viewMode}_viewModeDidChange(){let e=0,t=this._viewMode===WI.TimelineOverview.ViewMode.RenderingFrames;t?(this._timelineRuler.minimumSelectionDuration=1,this._timelineRuler.snapInterval=1,this._timelineRuler.formatLabelCallback=i=>i.maxDecimals(0).toLocaleString()):(this._timelineRuler.minimumSelectionDuration=.01,this._timelineRuler.snapInterval=NaN,this._timelineRuler.formatLabelCallback=null,e=this._startTime),this.pixelAlignDuration=t,this.selectionStartTime=this._currentSettings.selectionStartValueSetting.value+e,this.selectionDuration=this._currentSettings.selectionDurationSetting.value;for(let[i,n]of this._overviewGraphsByTypeMap){let s=this._treeElementsByTypeMap.get(i);console.assert(s,"Missing tree element for timeline type",i),s.hidden=!this._canShowTimelineType(i),s.hidden?n.hidden():n.shown()}this.element.classList.toggle("frames",t),this.updateLayout(WI.View.LayoutReason.Resize)}_createViewModeSettings(e,t,i,n,s,a){n=Math.min(i,Math.max(t,n));let d=new WI.Setting(e+"-duration-per-pixel",n),p=new WI.Setting(e+"-selection-start-value",s),f=new WI.Setting(e+"-selection-duration",a);return{scrollStartTime:0,minimumDurationPerPixel:t,maximumDurationPerPixel:i,durationPerPixelSetting:d,selectionStartValueSetting:p,selectionDurationSetting:f}}get _currentSettings(){return this._viewMode===WI.TimelineOverview.ViewMode.Timelines?this._timelinesViewModeSettings:this._renderingFramesViewModeSettings}_timelinesTreeSelectionDidChange(e){let t=null,i=this._timelinesTreeOutline.selectedTreeElement;if(i){t=i.representedObject,console.assert(t instanceof WI.Timeline,t),console.assert(this._recording.timelines.get(t.type)===t,t);for(let[n,s]of this._overviewGraphsByTypeMap)s.selected=n===t.type}this._selectedTimeline=t,this.dispatchEventToListeners(WI.TimelineOverview.Event.TimelineSelected)}_toggleEditingInstruments(e){this._editingInstruments?this._stopEditingInstruments():this._startEditingInstruments()}_editingInstrumentsDidChange(){this.element.classList.toggle(WI.TimelineOverview.EditInstrumentsStyleClassName,this._editingInstruments),this._timelineRuler.enabled=!this._editingInstruments,this._updateWheelAndGestureHandlers(),this._updateEditInstrumentsButton(),this.dispatchEventToListeners(WI.TimelineOverview.Event.EditingInstrumentsDidChange)}_updateEditInstrumentsButton(){let e=this._editingInstruments?WI.UIString("Done"):WI.UIString("Edit");this._editInstrumentsButton.label=e,this._editInstrumentsButton.activated=this._editingInstruments,this._editInstrumentsButton.enabled=!WI.timelineManager.isCapturing()}_updateWheelAndGestureHandlers(){this._editingInstruments?(this.element.removeEventListener("wheel",this._handleWheelEventListener),this.element.removeEventListener("gesturestart",this._handleGestureStartEventListener),this.element.removeEventListener("gesturechange",this._handleGestureChangeEventListener),this.element.removeEventListener("gestureend",this._handleGestureEndEventListener),this._handleWheelEventListener=null,this._handleGestureStartEventListener=null,this._handleGestureChangeEventListener=null,this._handleGestureEndEventListener=null):(this._handleWheelEventListener=this._handleWheelEvent.bind(this),this._handleGestureStartEventListener=this._handleGestureStart.bind(this),this._handleGestureChangeEventListener=this._handleGestureChange.bind(this),this._handleGestureEndEventListener=this._handleGestureEnd.bind(this),this.element.addEventListener("wheel",this._handleWheelEventListener),this.element.addEventListener("gesturestart",this._handleGestureStartEventListener),this.element.addEventListener("gesturechange",this._handleGestureChangeEventListener),this.element.addEventListener("gestureend",this._handleGestureEndEventListener))}_startEditingInstruments(){if(console.assert(this._viewMode===WI.TimelineOverview.ViewMode.Timelines),!this._editingInstruments){this._editingInstruments=!0;for(let e of this._instrumentTypes){let t=this._treeElementsByTypeMap.get(e);if(!t){let i=this._recording.timelines.get(e);console.assert(i,"Missing timeline for type "+e);const n=!0;t=new WI.TimelineTreeElement(i,n);let s=insertionIndexForObjectInListSortedByFunction(t,this._timelinesTreeOutline.children,this._compareTimelineTreeElements.bind(this));this._timelinesTreeOutline.insertChild(t,s);let a=new WI.View;a.element.classList.add("timeline-overview-graph"),t[WI.TimelineOverview.PlaceholderOverviewGraph]=a,this._graphsContainerView.insertSubviewBefore(a,this._graphsContainerView.subviews[s])}t.editing=!0,t.addEventListener(WI.TimelineTreeElement.Event.EnabledDidChange,this._timelineTreeElementEnabledDidChange,this)}this._editingInstrumentsDidChange()}}_stopEditingInstruments(){if(!this._editingInstruments)return;this._editingInstruments=!1;let e=this._recording.instruments;for(let n of this._treeElementsByTypeMap.values()){if(n.status.checked){n.editing=!1,n.removeEventListener(WI.TimelineTreeElement.Event.EnabledDidChange,this._timelineTreeElementEnabledDidChange,this);continue}let s=e.find(a=>a.timelineRecordType===n.representedObject.type);this._recording.removeInstrument(s)}let t=this._timelinesTreeOutline.children.filter(n=>n.placeholder);for(let n of t){this._timelinesTreeOutline.removeChild(n);let s=n[WI.TimelineOverview.PlaceholderOverviewGraph];if(console.assert(s),this._graphsContainerView.removeSubview(s),n.status.checked){let a=WI.Instrument.createForTimelineType(n.representedObject.type);this._recording.addInstrument(a)}}let i=e.map(n=>n.timelineRecordType);WI.timelineManager.enabledTimelineTypes=i,this._editingInstrumentsDidChange()}_handleTimelineCapturingStateChanged(e){switch(WI.timelineManager.capturingState){case WI.TimelineManager.CapturingState.Active:this._editInstrumentsButton.enabled=!1,this._stopEditingInstruments();break;case WI.TimelineManager.CapturingState.Inactive:this._editInstrumentsButton.enabled=!0;break}}_recordingImported(e){let{overviewData:t}=e.data;if(t.secondsPerPixel!==void 0&&(this.secondsPerPixel=t.secondsPerPixel),t.scrollStartTime!==void 0&&(this.scrollStartTime=t.scrollStartTime),t.selectionStartTime!==void 0&&(this.selectionStartTime=t.selectionStartTime),t.selectionDuration!==void 0&&(t.selectionDuration===Number.MAX_VALUE?this._timelineRuler.selectEntireRange():this.selectionDuration=t.selectionDuration),t.selectedTimelineType!==void 0){let i=this._recording.timelineForRecordType(t.selectedTimelineType);i&&(this.selectedTimeline=i)}}_compareTimelineTreeElements(e,t){let i=e.representedObject.type,n=t.representedObject.type;if(i===WI.TimelineRecord.Type.RenderingFrame)return 1;if(n===WI.TimelineRecord.Type.RenderingFrame)return-1;if(e.placeholder!==t.placeholder)return e.placeholder?1:-1;let s=this._instrumentTypes.indexOf(i),a=this._instrumentTypes.indexOf(n);return s-a}_timelineTreeElementEnabledDidChange(e){let t=this._timelinesTreeOutline.children.some(i=>{let n=i.representedObject.type;return this._canShowTimelineType(n)&&i.status.checked});this._editInstrumentsButton.enabled=t}};WI.TimelineOverview.PlaceholderOverviewGraph=Symbol("placeholder-overview-graph");WI.TimelineOverview.ScrollDeltaDenominator=500;WI.TimelineOverview.EditInstrumentsStyleClassName="edit-instruments";WI.TimelineOverview.MinimumDurationPerPixel=1e-4;WI.TimelineOverview.MaximumDurationPerPixel=60;WI.TimelineOverview.ViewMode={Timelines:"timeline-overview-view-mode-timelines",RenderingFrames:"timeline-overview-view-mode-rendering-frames"};WI.TimelineOverview.Event={EditingInstrumentsDidChange:"editing-instruments-did-change",RecordSelected:"timeline-overview-record-selected",TimelineSelected:"timeline-overview-timeline-selected",TimeRangeSelectionChanged:"timeline-overview-time-range-selection-changed"};WI.TimelineRecordTreeElement=class extends WI.GeneralTreeElement{constructor(e,t,i,n,s){console.assert(e),n=n||e.sourceCodeLocation||null;let a=null;if(i&&e.type===WI.TimelineRecord.Type.Script&&e.eventType===WI.ScriptTimelineRecord.EventType.TimerInstalled){let _=Number.secondsToString(e.details.timeout/1e3);a=document.createElement("span"),a.classList.add("alternate-subtitle"),e.details.repeating?a.textContent=WI.UIString("%s interval").format(_):a.textContent=WI.UIString("%s delay").format(_)}let d=null;n&&(d=document.createElement("span"),t!==WI.SourceCodeLocation.NameStyle.None?n.populateLiveDisplayLocationString(d,"textContent",null,t):n.populateLiveDisplayLocationString(d,"textContent",null,WI.SourceCodeLocation.NameStyle.None,WI.UIString("line ")));let p=WI.TimelineTabContentView.iconClassNameForRecord(e),f=WI.TimelineTabContentView.displayNameForRecord(e);super([p],f,d,s||e),this._record=e,this._sourceCodeLocation=n,this._sourceCodeLocation&&(this.tooltipHandledSeparately=!0),a&&this.titlesElement.appendChild(a)}get record(){return this._record}get filterableData(){var e=this._sourceCodeLocation?this._sourceCodeLocation.sourceCode.url:"";return{text:[this.mainTitle,e||"",this._record.details||""]}}get sourceCodeLocation(){return this._sourceCodeLocation}onattach(){if(super.onattach(),console.assert(this.element),!!this.tooltipHandledSeparately){var e=this.mainTitle+`
`;this._sourceCodeLocation.populateLiveDisplayLocationTooltip(this.element,e)}}};WI.TimelineRecordTreeElement.StyleRecordIconStyleClass="style-record";WI.TimelineRecordTreeElement.LayoutRecordIconStyleClass="layout-record";WI.TimelineRecordTreeElement.PaintRecordIconStyleClass="paint-record";WI.TimelineRecordTreeElement.CompositeRecordIconStyleClass="composite-record";WI.TimelineRecordTreeElement.RenderingFrameRecordIconStyleClass="rendering-frame-record";WI.TimelineRecordTreeElement.APIRecordIconStyleClass="api-record";WI.TimelineRecordTreeElement.EvaluatedRecordIconStyleClass="evaluated-record";WI.TimelineRecordTreeElement.EventRecordIconStyleClass="event-record";WI.TimelineRecordTreeElement.TimerRecordIconStyleClass="timer-record";WI.TimelineRecordTreeElement.AnimationRecordIconStyleClass="animation-record";WI.TimelineRecordTreeElement.ProbeRecordIconStyleClass="probe-record";WI.TimelineRecordTreeElement.ConsoleProfileIconStyleClass="console-profile-record";WI.TimelineRecordTreeElement.GarbageCollectionIconStyleClass="garbage-collection-profile-record";WI.TimelineTreeElement=class extends WI.GeneralTreeElement{constructor(e,t){let i=WI.TimelineTabContentView.displayNameForTimelineType(e.type),n=WI.TimelineTabContentView.iconClassNameForTimelineType(e.type),s=WI.TimelineTabContentView.genericClassNameForTimelineType(e.type);super([n,s],i,"",e),this._placeholder=t||!1,this.editing=this._placeholder,this.tooltipHandledSeparately=!0}get placeholder(){return this._placeholder}get editing(){return this._editing}set editing(e){this._editing!==e&&(this._editing=e,this.selectable=!this._editing,this._updateStatusButton())}onattach(){super.onattach(),this.listItemElement.addEventListener("click",this._clickHandler.bind(this))}_showCloseButton(){let e=WI.UIString("Close %s timeline view").format(this.mainTitle),t=new WI.TreeElementStatusButton(WI.ImageUtilities.useSVGSymbol("data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='square' d='M 2.5 2.5 L 13.5 13.5 M 2.5 13.5 L 13.5 2.5'/%3e %3c/svg%3e","close-button",e));t.addEventListener(WI.TreeElementStatusButton.Event.Clicked,()=>{this.deselect()}),this.status=t.element}_showCheckbox(){let e=document.createElement("input");e.type="checkbox",e.checked=!this._placeholder;let t=new WI.TreeElementStatusButton(e);e.addEventListener("change",()=>{this._dispatchEnabledDidChangeEvent()}),this.status=e}_updateStatusButton(){this._editing?this._showCheckbox():this._showCloseButton()}_clickHandler(){!this._editing||(this.status.checked=!this.status.checked,this._dispatchEnabledDidChangeEvent())}_dispatchEnabledDidChangeEvent(){this.dispatchEventToListeners(WI.TimelineTreeElement.Event.EnabledDidChange)}};WI.TimelineTreeElement.Event={EnabledDidChange:"timeline-tree-element-enabled-did-change"};WI.GeneralStyleDetailsSidebarPanel=class extends WI.DOMDetailsSidebarPanel{constructor(e,t,i){super(e,t),this.element.classList.add("css-style"),this._panel=new i(this),this._classListContainerToggledSetting=new WI.Setting("class-list-container-toggled",!1),this._forcedPseudoClassCheckboxes={}}get panel(){return this._panel}supportsDOMNode(e){return e.nodeType()===Node.ELEMENT_NODE}hidden(){super.hidden(),this._panel&&this._panel.hidden()}shown(){super.shown(),this._panel&&(console.assert(this.visible,`Shown panel ${this._identifier} must be visible.`),this._updateNoForcedPseudoClassesScrollOffset(),this._panel.shown(),this._panel.markAsNeedsRefresh(this.domNode))}styleDetailsPanelFocusLastPseudoClassCheckbox(e){this._forcedPseudoClassCheckboxes[WI.CSSManager.ForceablePseudoClasses.lastValue].focus()}styleDetailsPanelFocusFilterBar(e){this._filterBar.inputField.focus()}layout(){let e=this.domNode;!e||(this.contentView.element.scrollTop=this._initialScrollOffset,this._panel.markAsNeedsRefresh(e),this._updatePseudoClassCheckboxes(),this._populateClassToggles())}addEventListeners(){let e=this.domNode.isPseudoElement()?this.domNode.parentNode:this.domNode;!e||(e.addEventListener(WI.DOMNode.Event.EnabledPseudoClassesChanged,this._updatePseudoClassCheckboxes,this),e.addEventListener(WI.DOMNode.Event.AttributeModified,this._handleNodeAttributeModified,this),e.addEventListener(WI.DOMNode.Event.AttributeRemoved,this._handleNodeAttributeRemoved,this))}removeEventListeners(){let e=this.domNode.isPseudoElement()?this.domNode.parentNode:this.domNode;!e||e.removeEventListener(null,null,this)}initialLayout(){if(WI.cssManager.canForcePseudoClasses()){this._forcedPseudoClassContainer=document.createElement("div"),this._forcedPseudoClassContainer.className="pseudo-classes";let i=null;WI.CSSManager.ForceablePseudoClasses.forEach(function(n){let s=n.capitalize(),a=document.createElement("label"),d=document.createElement("input");d.addEventListener("keydown",this._handleForcedPseudoClassCheckboxKeydown.bind(this,n)),d.addEventListener("change",this._forcedPseudoClassCheckboxChanged.bind(this,n)),d.type="checkbox",this._forcedPseudoClassCheckboxes[n]=d,a.appendChild(d),a.append(s),(!i||i.children.length===2)&&(i=document.createElement("div"),i.className="group",this._forcedPseudoClassContainer.appendChild(i)),i.appendChild(a)},this),this.contentView.element.appendChild(this._forcedPseudoClassContainer)}this._showPanel(this._panel);let e=this.element.createChild("div","options-container"),t=e.createChild("img","new-rule");t.title=WI.UIString("Add new rule"),t.addEventListener("click",this._newRuleButtonClicked.bind(this)),t.addEventListener("contextmenu",this._newRuleButtonContextMenu.bind(this)),this._filterBar=new WI.FilterBar,this._filterBar.addEventListener(WI.FilterBar.Event.FilterDidChange,this._filterDidChange,this),this._filterBar.inputField.addEventListener("keydown",this._handleFilterBarInputFieldKeyDown.bind(this)),e.appendChild(this._filterBar.element),this._classToggleButton=e.createChild("button","toggle-class-toggle"),this._classToggleButton.textContent=WI.UIString("Classes"),this._classToggleButton.title=WI.UIString("Toggle Classes"),this._classToggleButton.addEventListener("click",this._classToggleButtonClicked.bind(this)),this._classListContainer=this.element.createChild("div","class-list-container"),this._classListContainer.hidden=!0,this._addClassContainer=this._classListContainer.createChild("div","new-class"),this._addClassContainer.title=WI.UIString("Add a Class"),this._addClassContainer.addEventListener("click",this._addClassContainerClicked.bind(this)),this._addClassInput=this._addClassContainer.createChild("input","class-name-input"),this._addClassInput.spellcheck=!1,this._addClassInput.setAttribute("placeholder",WI.UIString("Add New Class")),this._addClassInput.addEventListener("keypress",this._addClassInputKeyPressed.bind(this)),this._addClassInput.addEventListener("blur",this._addClassInputBlur.bind(this)),WI.cssManager.addEventListener(WI.CSSManager.Event.StyleSheetAdded,this._styleSheetAddedOrRemoved,this),WI.cssManager.addEventListener(WI.CSSManager.Event.StyleSheetRemoved,this._styleSheetAddedOrRemoved,this),this._classListContainerToggledSetting.value&&this._classToggleButtonClicked()}sizeDidChange(){super.sizeDidChange(),this._updateNoForcedPseudoClassesScrollOffset(),this._panel&&this._panel.sizeDidChange()}get _initialScrollOffset(){return WI.cssManager.canForcePseudoClasses()?this.domNode&&this.domNode.enabledPseudoClasses.length?0:WI.GeneralStyleDetailsSidebarPanel.NoForcedPseudoClassesScrollOffset:0}_updateNoForcedPseudoClassesScrollOffset(){this._forcedPseudoClassContainer&&(WI.GeneralStyleDetailsSidebarPanel.NoForcedPseudoClassesScrollOffset=this._forcedPseudoClassContainer.offsetHeight)}_showPanel(){this.contentView.addSubview(this._panel);let e=typeof this._panel.filterDidChange=="function";this.contentView.element.classList.toggle("has-filter-bar",e),this._filterBar&&this.contentView.element.classList.toggle(WI.GeneralStyleDetailsSidebarPanel.FilterInProgressClassName,e&&this._filterBar.hasActiveFilters()),this.contentView.element.classList.toggle("supports-new-rule",typeof this._panel.newRuleButtonClicked=="function"),this._panel.shown()}_handleForcedPseudoClassCheckboxKeydown(e,t){if(t.key!=="Tab")return;let i=WI.CSSManager.ForceablePseudoClasses,n=i.indexOf(e);t.shiftKey?n>0?(this._forcedPseudoClassCheckboxes[i[n-1]].focus(),t.preventDefault()):(this._filterBar.inputField.focus(),t.preventDefault()):n<i.length-1?(this._forcedPseudoClassCheckboxes[i[n+1]].focus(),t.preventDefault()):this._panel.focusFirstSection&&(this._panel.focusFirstSection(),t.preventDefault())}_forcedPseudoClassCheckboxChanged(e,t){if(!this.domNode)return;let i=this.domNode.isPseudoElement()?this.domNode.parentNode:this.domNode;!i||(i.setPseudoClassEnabled(e,t.target.checked),this._forcedPseudoClassCheckboxes[e].focus())}_updatePseudoClassCheckboxes(){if(!this.domNode)return;let e=this.domNode.isPseudoElement()?this.domNode.parentNode:this.domNode;if(!e)return;let t=e.enabledPseudoClasses;for(let i in this._forcedPseudoClassCheckboxes){let n=this._forcedPseudoClassCheckboxes[i];n.checked=t.includes(i)}}_handleNodeAttributeModified(e){e&&e.data&&e.data.name==="class"&&this._populateClassToggles()}_handleNodeAttributeRemoved(e){e&&e.data&&e.data.name==="class"&&this._populateClassToggles()}_newRuleButtonClicked(){this._panel&&typeof this._panel.newRuleButtonClicked=="function"&&this._panel.newRuleButtonClicked()}_newRuleButtonContextMenu(e){this._panel&&typeof this._panel.newRuleButtonContextMenu=="function"&&this._panel.newRuleButtonContextMenu(e)}_classToggleButtonClicked(e){this._classToggleButton.classList.toggle("selected"),this._classListContainer.hidden=!this._classListContainer.hidden,this._classListContainerToggledSetting.value=!this._classListContainer.hidden,this._populateClassToggles()}_addClassContainerClicked(e){this._addClassContainer.classList.add("active"),this._addClassInput.focus()}_addClassInputKeyPressed(e){e.keyCode===WI.KeyboardShortcut.Key.Enter.keyCode&&this._addClassInput.blur()}_addClassInputBlur(e){this.domNode.toggleClass(this._addClassInput.value,!0),this._addClassContainer.classList.remove("active"),this._addClassInput.value=null}_populateClassToggles(){if(!this._classListContainer||this._classListContainer.hidden)return;for(;this._classListContainer.children.length>1;)this._classListContainer.children[1].remove();let e=this.domNode.getAttribute("class")||[],t=this.domNode[WI.GeneralStyleDetailsSidebarPanel.ToggledClassesSymbol];if(t||(t=this.domNode[WI.GeneralStyleDetailsSidebarPanel.ToggledClassesSymbol]=new Map),e&&e.length)for(let i of e.split(/\s+/))t.set(i,!0);for(let[i,n]of t)(n&&!e.includes(i)||!n&&e.includes(i))&&(n=!n,t.set(i,n)),this._createToggleForClassName(i)}_createToggleForClassName(e){if(!e||!e.length)return;let t=this.domNode[WI.GeneralStyleDetailsSidebarPanel.ToggledClassesSymbol];if(!t)return;t.has(e)||t.set(e,!0);let i=t.get(e),n=document.createElement("div");n.classList.add("class-toggle");let s=n.createChild("input");s.type="checkbox",s.checked=i;let a=n.createChild("span");a.textContent=e,a.draggable=!0,a.addEventListener("dragstart",p=>{p.dataTransfer.setData(WI.GeneralStyleDetailsSidebarPanel.ToggledClassesDragType,e),p.dataTransfer.effectAllowed="copy"});let d=p=>{this.domNode.toggleClass(e,s.checked),t.set(e,s.checked)};s.addEventListener("click",d),a.addEventListener("click",p=>{s.checked=!s.checked,d()}),this._classListContainer.appendChild(n)}_filterDidChange(){this.contentView.element.classList.toggle(WI.GeneralStyleDetailsSidebarPanel.FilterInProgressClassName,this._filterBar.hasActiveFilters()),this._panel.filterDidChange(this._filterBar)}_handleFilterBarInputFieldKeyDown(e){e.key==="Tab"&&(e.shiftKey?this._panel.focusLastSection&&(this._panel.focusLastSection(),e.preventDefault()):(this._forcedPseudoClassCheckboxes[WI.CSSManager.ForceablePseudoClasses[0]].focus(),e.preventDefault()))}_styleSheetAddedOrRemoved(){this.needsLayout()}};WI.GeneralStyleDetailsSidebarPanel.NoForcedPseudoClassesScrollOffset=30;WI.GeneralStyleDetailsSidebarPanel.FilterInProgressClassName="filter-in-progress";WI.GeneralStyleDetailsSidebarPanel.FilterMatchingSectionHasLabelClassName="filter-section-has-label";WI.GeneralStyleDetailsSidebarPanel.FilterMatchSectionClassName="filter-matching";WI.GeneralStyleDetailsSidebarPanel.NoFilterMatchInSectionClassName="filter-section-non-matching";WI.GeneralStyleDetailsSidebarPanel.NoFilterMatchInPropertyClassName="filter-property-non-matching";WI.GeneralStyleDetailsSidebarPanel.ToggledClassesSymbol=Symbol("css-style-details-sidebar-panel-toggled-classes-symbol");WI.GeneralStyleDetailsSidebarPanel.ToggledClassesDragType="web-inspector/css-class";WI.RulesStyleDetailsSidebarPanel=class extends WI.GeneralStyleDetailsSidebarPanel{constructor(){super("style-rules",WI.UIString("Styles"),WI.SpreadsheetRulesStyleDetailsPanel)}};WI.ComputedStyleDetailsSidebarPanel=class extends WI.GeneralStyleDetailsSidebarPanel{constructor(){super("style-computed",WI.UIString("Computed"),WI.ComputedStyleDetailsPanel)}computedStyleDetailsPanelShowProperty(e){let t=this.parentSidebar.sidebarPanels.find(i=>i instanceof WI.RulesStyleDetailsSidebarPanel);console.assert(t,"Styles panel is missing."),t&&(this.parentSidebar.selectedSidebarPanel=t,t.panel.scrollToSectionAndHighlightProperty(e))}};WI.StyleDetailsPanel=class extends WI.View{constructor(e,t,i,n){super(),this._delegate=e||null,this.element.classList.add(t),this._navigationInfo={identifier:i,label:n},this._nodeStyles=null,this._visible=!1}get navigationInfo(){return this._navigationInfo}get nodeStyles(){return this._nodeStyles}shown(){this._visible||(this._visible=!0,this._refreshNodeStyles(),this.updateLayoutIfNeeded())}hidden(){this._visible=!1,this.cancelLayout()}markAsNeedsRefresh(e){if(console.assert(e),!!e){if(!this._nodeStyles||this._nodeStyles.node!==e){if(this._nodeStyles&&(this._nodeStyles.removeEventListener(WI.DOMNodeStyles.Event.Refreshed,this.nodeStylesRefreshed,this),this._nodeStyles.removeEventListener(WI.DOMNodeStyles.Event.NeedsRefresh,this._nodeStylesNeedsRefreshed,this)),this._nodeStyles=WI.cssManager.stylesForNode(e),console.assert(this._nodeStyles),!this._nodeStyles)return;this._nodeStyles.addEventListener(WI.DOMNodeStyles.Event.Refreshed,this.nodeStylesRefreshed,this),this._nodeStyles.addEventListener(WI.DOMNodeStyles.Event.NeedsRefresh,this._nodeStylesNeedsRefreshed,this),this._forceSignificantChange=!0}this._visible&&this._refreshNodeStyles()}}refresh(e){this.dispatchEventToListeners(WI.StyleDetailsPanel.Event.Refreshed)}nodeStylesRefreshed(e){this._visible&&this._refreshPreservingScrollPosition(e.data.significantChange)}filterDidChange(e){}get _initialScrollOffset(){return WI.cssManager.canForcePseudoClasses()?this.nodeStyles.node.enabledPseudoClasses.length?0:WI.GeneralStyleDetailsSidebarPanel.NoForcedPseudoClassesScrollOffset:0}_refreshNodeStyles(){!this._nodeStyles||this._nodeStyles.refresh()}_refreshPreservingScrollPosition(e){e=this._forceSignificantChange||e||!1;var t=this._initialScrollOffset;this.element.parentNode&&this._previousRefreshNodeIdentifier===this._nodeStyles.node.id&&(t=this.element.parentNode.scrollTop),this.refresh(e),this._previousRefreshNodeIdentifier=this._nodeStyles.node.id,this.element.parentNode&&(this.element.parentNode.scrollTop=t),this._forceSignificantChange=!1}_nodeStylesNeedsRefreshed(e){this._visible&&this._refreshNodeStyles()}};WI.StyleDetailsPanel.Event={Refreshed:"style-details-panel-refreshed"};WI.AuditTabContentView=class extends WI.ContentBrowserTabContentView{constructor(){super("audit",["audit"],WI.GeneralTabBarItem.fromTabInfo(WI.AuditTabContentView.tabInfo()),WI.AuditNavigationSidebarPanel),this._startStopShortcut=new WI.KeyboardShortcut(null,WI.KeyboardShortcut.Key.Space,this._handleSpace.bind(this)),this._startStopShortcut.implicitlyPreventsDefault=!1,this._startStopShortcut.disabled=!0}static tabInfo(){return{image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2018 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect fill='none' stroke='currentColor' x='0.5' y='0.5' width='15' height='15' rx='2'/%3e %3cpath fill='none' stroke-linecap='round' stroke='currentColor' d='M 3.5 5.5 L 12.5 5.5'/%3e %3cpath fill='none' stroke-linecap='round' stroke='currentColor' d='M 12.5 5.5 L 9.5 2.5'/%3e %3cpath fill='none' stroke-linecap='round' stroke='currentColor' d='M 12.5 5.5 L 9.5 8.5'/%3e %3cpath fill='none' stroke-linecap='round' stroke='currentColor' d='M 3.5 10.5 L 12.5 10.5'/%3e %3cpath fill='none' stroke-linecap='round' stroke='currentColor' d='M 3.5 10.5 L 6.5 7.5'/%3e %3cpath fill='none' stroke-linecap='round' stroke='currentColor' d='M 3.5 10.5 L 6.5 13.5'/%3e %3c/svg%3e",title:WI.UIString("Audit")}}static isTabAllowed(){return WI.sharedApp.debuggableType===WI.DebuggableType.Web}get type(){return WI.AuditTabContentView.Type}get supportsSplitContentBrowser(){return!0}canShowRepresentedObject(e){return e instanceof WI.AuditTestCase||e instanceof WI.AuditTestGroup||e instanceof WI.AuditTestCaseResult||e instanceof WI.AuditTestGroupResult}shown(){super.shown(),this._startStopShortcut.disabled=!1}hidden(){this._startStopShortcut.disabled=!0,super.hidden()}async handleFileDrop(e){await WI.FileUtilities.readJSON(e,t=>WI.auditManager.processJSON(t))}initialLayout(){super.initialLayout(),WI.auditManager.loadStoredTests()}_handleSpace(e){if(!WI.isEventTargetAnEditableField(e)){if(WI.auditManager.runningState===WI.AuditManager.RunningState.Inactive)WI.auditManager.start(this.contentBrowser.currentRepresentedObjects);else if(WI.auditManager.runningState===WI.AuditManager.RunningState.Active)WI.auditManager.stop();else return;e.preventDefault()}}};WI.AuditTabContentView.Type="audit";WI.CanvasTabContentView=class extends WI.ContentBrowserTabContentView{constructor(e){console.assert(!e||e instanceof WI.Canvas);let t=WI.GeneralTabBarItem.fromTabInfo(WI.CanvasTabContentView.tabInfo());const i=WI.CanvasSidebarPanel,n=[WI.RecordingStateDetailsSidebarPanel,WI.RecordingTraceDetailsSidebarPanel,WI.CanvasDetailsSidebarPanel],s=!0;super("canvas",["canvas"],t,i,n,s),this._canvasCollection=new WI.CanvasCollection,this._canvasTreeOutline=new WI.TreeOutline,this._canvasTreeOutline.addEventListener(WI.TreeOutline.Event.SelectionDidChange,this._canvasTreeOutlineSelectionDidChange,this),this._overviewTreeElement=new WI.GeneralTreeElement("canvas-overview",WI.UIString("Overview"),null,this._canvasCollection),this._canvasTreeOutline.appendChild(this._overviewTreeElement),this._savedRecordingsTreeElement=new WI.FolderTreeElement(WI.UIString("Saved Recordings"),WI.RecordingCollection),this._savedRecordingsTreeElement.hidden=!0,this._overviewTreeElement.appendChild(this._savedRecordingsTreeElement),this._recordShortcut=new WI.KeyboardShortcut(null,WI.KeyboardShortcut.Key.Space,this._handleSpace.bind(this)),this._recordShortcut.implicitlyPreventsDefault=!1,this._recordShortcut.disabled=!0,this._recordSingleFrameShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.Shift,WI.KeyboardShortcut.Key.Space,this._handleSpace.bind(this)),this._recordSingleFrameShortcut.implicitlyPreventsDefault=!1,this._recordSingleFrameShortcut.disabled=!0,WI.canvasManager.enable()}static tabInfo(){return{image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect x='1.5' y='2.5' width='13' height='11' fill='none' stroke='currentColor'/%3e %3cpolygon points='11 8 9 11 6 7 3 11 3 12 13 12 13 11 11 8'/%3e %3c/svg%3e",title:WI.UIString("Canvas")}}static isTabAllowed(){return!!window.CanvasAgent}treeElementForRepresentedObject(e){return this._canvasTreeOutline.findTreeElement(e)}get type(){return WI.CanvasTabContentView.Type}get supportsSplitContentBrowser(){return!0}get managesNavigationSidebarPanel(){return!0}canShowRepresentedObject(e){return e instanceof WI.Canvas||e instanceof WI.CanvasCollection||e instanceof WI.Recording||e instanceof WI.ShaderProgram}shown(){super.shown(),this._recordShortcut.disabled=!1,this._recordSingleFrameShortcut.disabled=!1,this.contentBrowser.currentContentView||this.showRepresentedObject(this._canvasCollection)}hidden(){this._recordShortcut.disabled=!0,this._recordSingleFrameShortcut.disabled=!0,super.hidden()}closed(){WI.canvasManager.disable(),super.closed()}restoreStateFromCookie(e){}saveStateToCookie(e){}async handleFileDrop(e){await WI.FileUtilities.readJSON(e,t=>WI.canvasManager.processJSON(t))}attached(){super.attached(),WI.canvasManager.addEventListener(WI.CanvasManager.Event.CanvasAdded,this._handleCanvasAdded,this),WI.canvasManager.addEventListener(WI.CanvasManager.Event.CanvasRemoved,this._handleCanvasRemoved,this),WI.canvasManager.addEventListener(WI.CanvasManager.Event.RecordingSaved,this._handleRecordingSavedOrStopped,this),WI.Canvas.addEventListener(WI.Canvas.Event.RecordingStopped,this._handleRecordingSavedOrStopped,this);let e=WI.canvasManager.canvases;for(let t of this._canvasCollection)e.includes(t)||this._removeCanvas(t);for(let t of e)this._canvasCollection.has(t)||this._addCanvas(t);this._savedRecordingsTreeElement.removeChildren();for(let t of WI.canvasManager.savedRecordings)this._addRecording(t,{suppressShowRecording:!0})}detached(){WI.Canvas.removeEventListener(null,null,this),WI.canvasManager.removeEventListener(null,null,this),super.detached()}_addCanvas(e){this._overviewTreeElement.appendChild(new WI.CanvasTreeElement(e)),this._canvasCollection.add(e);const t={suppressShowRecording:!0};for(let i of e.recordingCollection)this._addRecording(i,t)}_removeCanvas(e){let t=this._canvasTreeOutline.findTreeElement(e);console.assert(t,"Missing tree element for canvas.",e);const i=!0;t.deselect(i),this._overviewTreeElement.removeChild(t),this._canvasCollection.remove(e);let n=this.contentBrowser.currentContentView;n instanceof WI.CanvasContentView?WI.showRepresentedObject(this._canvasCollection):n instanceof WI.RecordingContentView&&e.recordingCollection.has(n.representedObject)&&this.contentBrowser.updateHierarchicalPathForCurrentContentView();let s=this.navigationSidebarPanel;s instanceof WI.CanvasSidebarPanel&&s.visible&&s.updateRepresentedObjects(),this.showDetailsSidebarPanels()}_addRecording(e,t={}){if(!e.source){let n=new WI.GeneralTreeElement(["recording"],e.displayName,null,e);this._savedRecordingsTreeElement.hidden=!1,this._savedRecordingsTreeElement.appendChild(n)}t.suppressShowRecording||this.showRepresentedObject(e)}_handleCanvasAdded(e){this._addCanvas(e.data.canvas)}_handleCanvasRemoved(e){this._removeCanvas(e.data.canvas)}_canvasTreeOutlineSelectionDidChange(e){let t=this._canvasTreeOutline.selectedTreeElement;if(!t)return;let i=t.representedObject;if(!this.canShowRepresentedObject(i)){console.assert(!1,"Unexpected representedObject.",i);return}this.showRepresentedObject(i)}_handleRecordingSavedOrStopped(e){let{recording:t,initiatedByUser:i,imported:n}=e.data;if(!t)return;let s={};(t.source||!n)&&(s.suppressShowRecording=!i||this.contentBrowser.currentRepresentedObjects.some(a=>a instanceof WI.Recording)),this._addRecording(t,s)}_handleSpace(e){if(WI.isEventTargetAnEditableField(e)||!this.navigationSidebarPanel)return;let t=this.navigationSidebarPanel.canvas;if(!!t){if(t.recordingActive)t.stopRecording();else{let i=!!e.shiftKey;t.startRecording(i)}e.preventDefault()}}};WI.CanvasTabContentView.Type="canvas";WI.ConsoleTabContentView=class extends WI.ContentBrowserTabContentView{constructor(e){let t=WI.GeneralTabBarItem.fromTabInfo(WI.ConsoleTabContentView.tabInfo());super(e||"console","console",t,null,null,!0)}static tabInfo(){return{image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect fill='none' stroke='currentColor' x='0.5' y='0.5' width='15' height='15' rx='2'/%3e %3cpath fill='none' stroke='currentColor' d='M 4 4 L 8 8 L 4 12'/%3e %3cpath fill='none' stroke='currentColor' d='M 8 4.5 L 12 4.5'/%3e %3cpath fill='none' stroke='currentColor' d='M 10 8 L 12 8'/%3e %3cpath fill='none' stroke='currentColor' d='M 8 11.5 L 12 11.5'/%3e %3c/svg%3e",title:WI.UIString("Console")}}get type(){return WI.ConsoleTabContentView.Type}shown(){super.shown(),WI.hideSplitConsole(),this.contentBrowser.showContentView(WI.consoleContentView),WI.consoleContentView.dispatchEventToListeners(WI.ContentView.Event.NavigationItemsDidChange),WI.consoleContentView.prompt.focus(),console.assert(this.contentBrowser.currentContentView===WI.consoleContentView)}showRepresentedObject(e,t){console.assert(e instanceof WI.LogObject)}canShowRepresentedObject(e){return e instanceof WI.LogObject}get supportsSplitContentBrowser(){return!1}};WI.ConsoleTabContentView.Type="console";WI.DebuggerTabContentView=class extends WI.ContentBrowserTabContentView{constructor(e){let t=WI.GeneralTabBarItem.fromTabInfo(WI.DebuggerTabContentView.tabInfo()),i=[WI.ScopeChainDetailsSidebarPanel,WI.ResourceDetailsSidebarPanel,WI.ProbeDetailsSidebarPanel];super(e||"debugger","debugger",t,WI.DebuggerSidebarPanel,i)}static tabInfo(){return{image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='none' stroke='currentColor' d='M 8.04545455 15 C 10.8068784 15 13.0454545 11.8659934 13.0454545 8 C 13.0454545 4.13400656 10.8068784 1 8.04545455 1 C 5.28403066 1 3.04545455 4.13400656 3.04545455 8 C 3.04545455 11.8659934 5.28403066 15 8.04545455 15 Z'/%3e %3cpath fill='none' stroke='currentColor' d='M 3.5 4.5 L 12.5 4.5'/%3e %3cpath fill='none' stroke='currentColor' d='M 8 4.5 L 8 15'/%3e %3cpath fill='none' stroke='currentColor' d='M 11.5 12.5 L 13.5 14.5'/%3e %3cpath fill='none' stroke='currentColor' d='M 13 8 L 15 8'/%3e %3cpath fill='none' stroke='currentColor' d='M 3 8 L 1 8'/%3e %3cpath fill='none' stroke='currentColor' d='M 4.5 12.5 L 2.5 14.5'/%3e %3cpath fill='none' stroke='currentColor' d='M 4.5 3.5 L 2.5 1.5'/%3e %3cpath fill='none' stroke='currentColor' d='M 11.5 3.5 L 13.5 1.5'/%3e %3c/svg%3e",title:WI.UIString("Debugger")}}static isTabAllowed(){return!WI.settings.experimentalEnableSourcesTab.value}get type(){return WI.DebuggerTabContentView.Type}get supportsSplitContentBrowser(){return!0}canShowRepresentedObject(e){return e instanceof WI.Script?!0:e instanceof WI.Resource?e.type===WI.Resource.Type.Document||e.type===WI.Resource.Type.Script:!1}showDetailsSidebarPanels(){if(super.showDetailsSidebarPanels(),!this._showScopeChainDetailsSidebarPanel)return;let e=this.detailsSidebarPanels.find(i=>i instanceof WI.ScopeChainDetailsSidebarPanel);if(!e)return;let t=e.parentSidebar;!t||(t.selectedSidebarPanel=e,t.collapsed=!1,this._showScopeChainDetailsSidebarPanel=!1)}showScopeChainDetailsSidebarPanel(){this._showScopeChainDetailsSidebarPanel=!0}revealAndSelectBreakpoint(e){console.assert(e instanceof WI.Breakpoint);var t=this.navigationSidebarPanel.treeElementForRepresentedObject(e);t&&t.revealAndSelect()}};WI.DebuggerTabContentView.Type="debugger";WI.ElementsTabContentView=class extends WI.ContentBrowserTabContentView{constructor(e){let t=WI.GeneralTabBarItem.fromTabInfo(WI.ElementsTabContentView.tabInfo()),i=[WI.RulesStyleDetailsSidebarPanel,WI.ComputedStyleDetailsSidebarPanel,WI.ChangesDetailsSidebarPanel,WI.DOMNodeDetailsSidebarPanel];window.LayerTreeAgent&&i.push(WI.LayerTreeDetailsSidebarPanel),super(e||"elements","elements",t,null,i,!0),WI.networkManager.addEventListener(WI.NetworkManager.Event.MainFrameDidChange,this._mainFrameDidChange,this),WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this)}static tabInfo(){return{image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect fill='none' stroke='currentColor' x='1.5' y='1.5' width='13' height='5'/%3e %3cpath fill='none' stroke='currentColor' d='M 11.5 6.5 L 11.5 10.5'/%3e %3cpath fill='none' stroke='currentColor' d='M 4.5 6.5 L 4.5 10.5'/%3e %3crect fill='none' stroke='currentColor' x='9.5' y='10.5' width='5' height='4'/%3e %3crect fill='none' stroke='currentColor' x='1.5' y='10.5' width='5' height='4'/%3e %3c/svg%3e",title:WI.UIString("Elements")}}static isTabAllowed(){return!!window.DOMAgent}get type(){return WI.ElementsTabContentView.Type}get supportsSplitContentBrowser(){return!0}canShowRepresentedObject(e){return e instanceof WI.DOMTree}showRepresentedObject(e,t){if(this.contentBrowser.currentContentView||this._showDOMTreeContentView(),!t||!t.nodeToSelect)return;let i=this.contentBrowser.currentContentView;console.assert(i instanceof WI.DOMTreeContentView,"Unexpected DOMTreeContentView representedObject.",i),i.selectAndRevealDOMNode(t.nodeToSelect),t.nodeToSelect=void 0}shown(){super.shown(),this.contentBrowser.currentContentView||this._showDOMTreeContentView()}closed(){super.closed(),WI.networkManager.removeEventListener(null,null,this),WI.Frame.removeEventListener(null,null,this)}_showDOMTreeContentView(){this.contentBrowser.contentViewContainer.closeAllContentViews();var e=WI.networkManager.mainFrame;e&&this.contentBrowser.showContentViewForRepresentedObject(e.domTree)}_mainFrameDidChange(e){this._showDOMTreeContentView()}_mainResourceDidChange(e){!e.target.isMainFrame()||this._showDOMTreeContentView()}};WI.ElementsTabContentView.Type="elements";WI.LayersTabContentView=class extends WI.ContentBrowserTabContentView{constructor(){let e=WI.GeneralTabBarItem.fromTabInfo(WI.LayersTabContentView.tabInfo());const t=null,i=[WI.LayerDetailsSidebarPanel],n=!0;super("layers","layers",e,t,i,n),this._layerDetailsSidebarPanel=this.detailsSidebarPanels[0],this._layerDetailsSidebarPanel.addEventListener(WI.LayerDetailsSidebarPanel.Event.SelectedLayerChanged,this._detailsSidebarSelectedLayerChanged,this),this._layers3DContentView=new WI.Layers3DContentView,this._layers3DContentView.addEventListener(WI.Layers3DContentView.Event.SelectedLayerChanged,this._contentViewSelectedLayerChanged,this)}static tabInfo(){return{image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright (C) 2017 Sony Interactive Entertainment Inc. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect fill='none' stroke='currentColor' x='5.5' y='5.5' width='9' height='9'/%3e %3cpath fill='none' stroke='currentColor' d='M 5.5 12.5 L 3.5 12.5 L 3.5 3.5 L 12.5 3.5 L 12.5 5.5'/%3e %3cpath fill='none' stroke='currentColor' d='M 3.5 10.5 L 1.5 10.5 L 1.5 1.5 L 10.5 1.5 L 10.5 3.5'/%3e %3c/svg%3e",title:WI.UIString("Layers")}}static isTabAllowed(){return window.LayerTreeAgent&&WI.settings.experimentalEnableLayersTab.value}get type(){return WI.LayersTabContentView.Type}get supportsSplitContentBrowser(){return!1}selectLayerForNode(e){this._layers3DContentView.selectLayerForNode(e)}shown(){super.shown(),this.contentBrowser.showContentView(this._layers3DContentView)}_detailsSidebarSelectedLayerChanged(e){this._layers3DContentView.selectLayerById(e.data.layerId)}_contentViewSelectedLayerChanged(e){this._layerDetailsSidebarPanel.selectNodeByLayerId(e.data.layerId)}};WI.LayersTabContentView.Type="layers";WI.ResourceTreeElement=class extends WI.SourceCodeTreeElement{constructor(e,t,{allowDirectoryAsName:i,hideOrigin:n}={}){console.assert(e instanceof WI.Resource);const s=null,a=null;super(e,["resource",WI.ResourceTreeElement.ResourceIconStyleClassName,WI.Resource.classNameForResource(e)],s,a,t||e),i&&(this._allowDirectoryAsName=i),n&&(this._hideOrigin=n),this._updateResource(e)}static compareResourceTreeElements(e,t){var i=e.resource.type.extendedLocaleCompare(t.resource.type);return i!==0?i:e.resource.type===WI.Resource.Type.XHR||e.resource.type===WI.Resource.Type.Fetch||e.resource.type===WI.Resource.Type.WebSocket?e.resource.firstTimestamp-t.resource.firstTimestamp||0:(i=e.subtitle.extendedLocaleCompare(t.subtitle),i!==0?i:e.mainTitle.extendedLocaleCompare(t.mainTitle))}static compareFolderAndResourceTreeElements(e,t){var i=e instanceof WI.FolderTreeElement,n=t instanceof WI.FolderTreeElement;return i&&!n?-1:!i&&n?1:i&&n?e.mainTitle.extendedLocaleCompare(t.mainTitle):WI.ResourceTreeElement.compareResourceTreeElements(e,t)}get resource(){return this._resource}get filterableData(){let e=this._resource.urlComponents;return{text:[e.lastPathComponent,e.path,this._resource.url]}}ondblclick(){this._resource.type!==WI.Resource.Type.WebSocket&&InspectorFrontendHost.openInNewTab(this._resource.url)}_updateResource(e){console.assert(e instanceof WI.Resource),console.assert(!this._resource||!(this.representedObject instanceof WI.Resource)),this._resource&&(this._resource.removeEventListener(WI.Resource.Event.URLDidChange,this._urlDidChange,this),this._resource.removeEventListener(WI.Resource.Event.TypeDidChange,this._typeDidChange,this),this._resource.removeEventListener(WI.Resource.Event.LoadingDidFinish,this._updateStatus,this),this._resource.removeEventListener(WI.Resource.Event.LoadingDidFail,this._updateStatus,this)),this._updateSourceCode(e),this._resource=e,e.addEventListener(WI.Resource.Event.URLDidChange,this._urlDidChange,this),e.addEventListener(WI.Resource.Event.TypeDidChange,this._typeDidChange,this),e.addEventListener(WI.Resource.Event.LoadingDidFinish,this._updateStatus,this),e.addEventListener(WI.Resource.Event.LoadingDidFail,this._updateStatus,this),this._updateTitles(),this._updateStatus(),this._updateToolTip()}get mainTitleText(){return WI.displayNameForURL(this._resource.url,this._resource.urlComponents,{allowDirectoryAsName:this._allowDirectoryAsName})}_updateTitles(){var e=this._resource.parentFrame,t=this._resource.target,i=this._resource.isMainResource(),n=t.mainResource?t.mainResource.urlComponents.host:null;i&&e?n=e.parentFrame?e.parentFrame.mainResource.urlComponents.host:null:e&&(n=e.mainResource.urlComponents.host);var s=this._resource.urlComponents,a=this.mainTitle;if(this.mainTitle=this.mainTitleText,!this._hideOrigin){var d=n!==s.host||e&&e.isMainFrame()&&i?WI.displayNameForHost(s.host):null;this.subtitle=this.mainTitle!==d?d:null}a!==this.mainTitle&&this.callFirstAncestorFunction("descendantResourceTreeElementMainTitleDidChange",[this,a])}populateContextMenu(e,t){WI.appendContextMenuItemsForSourceCode(e,this._resource),super.populateContextMenu(e,t)}_updateStatus(){if(this._resource.hadLoadingError()?this.addClassName(WI.ResourceTreeElement.FailedStyleClassName):this.removeClassName(WI.ResourceTreeElement.FailedStyleClassName),this._resource.isLoading()){if(!this.status||!this.status[WI.ResourceTreeElement.SpinnerSymbol]){let e=new WI.IndeterminateProgressSpinner;this.status=e.element,this.status[WI.ResourceTreeElement.SpinnerSymbol]=!0}}else this.status&&this.status[WI.ResourceTreeElement.SpinnerSymbol]&&(this.status="")}_updateToolTip(){this.tooltip=this._resource.displayURL}_urlDidChange(e){this._updateTitles(),this._updateToolTip()}_typeDidChange(e){this.removeClassName(e.data.oldType),this.addClassName(this._resource.type),this.callFirstAncestorFunction("descendantResourceTreeElementTypeDidChange",[this,e.data.oldType])}};WI.ResourceTreeElement.ResourceIconStyleClassName="resource-icon";WI.ResourceTreeElement.FailedStyleClassName="failed";WI.ResourceTreeElement.SpinnerSymbol=Symbol("spinner");WI.ResourcesTabContentView=class extends WI.ContentBrowserTabContentView{constructor(e){let t=WI.GeneralTabBarItem.fromTabInfo(WI.ResourcesTabContentView.tabInfo());const i=[WI.ResourceDetailsSidebarPanel,WI.ProbeDetailsSidebarPanel];super(e||"resources","resources",t,WI.ResourceSidebarPanel,i)}static tabInfo(){return{image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='none' stroke='currentColor' d='M 2.5 1.5 L 2.5 14.5 L 13.5 14.5 L 13.5 5.5 L 9.5 1.5 L 2.5 1.5 Z'/%3e %3cpath fill='currentColor' d='M 9.0 3.0 L 9.0 6.0 L 12.0 6.0 Z'/%3e %3c/svg%3e",title:WI.UIString("Resources")}}static isTabAllowed(){return!WI.settings.experimentalEnableSourcesTab.value}get type(){return WI.ResourcesTabContentView.Type}get supportsSplitContentBrowser(){return!0}canShowRepresentedObject(e){return e instanceof WI.Frame||e instanceof WI.FrameCollection||e instanceof WI.Resource||e instanceof WI.ResourceCollection||e instanceof WI.Script||e instanceof WI.ScriptCollection||e instanceof WI.CSSStyleSheet||e instanceof WI.CSSStyleSheetCollection}};WI.ResourcesTabContentView.Type="resources";WI.SearchTabContentView=class extends WI.ContentBrowserTabContentView{constructor(e){let t;WI.settings.experimentalEnableNewTabBar.value?t=WI.PinnedTabBarItem.fromTabInfo(WI.SearchTabContentView.tabInfo()):t=WI.GeneralTabBarItem.fromTabInfo(WI.SearchTabContentView.tabInfo());let i=[WI.ResourceDetailsSidebarPanel,WI.ProbeDetailsSidebarPanel,WI.DOMNodeDetailsSidebarPanel,WI.ComputedStyleDetailsSidebarPanel,WI.RulesStyleDetailsSidebarPanel];window.LayerTreeAgent&&i.push(WI.LayerTreeDetailsSidebarPanel),super(e||"search","search",t,WI.SearchSidebarPanel,i),t.representedObject=this,this._forcePerformSearch=!1}static tabInfo(){return{image:WI.settings.experimentalEnableNewTabBar.value?"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2018 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3ccircle fill='none' stroke='currentColor' cx='6' cy='6' r='4'/%3e %3cpath fill='none' stroke='currentColor' d='M 9 9 L 13.5 13.5'/%3e %3c/svg%3e":"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect fill='none' stroke='currentColor' x='0.5' y='0.5' width='15' height='15' rx='2'/%3e %3ccircle fill='none' stroke='currentColor' cx='7' cy='7' r='3'/%3e %3cpath fill='none' stroke='currentColor' d='M 9.5 9.5 L 12.5 12.5'/%3e %3c/svg%3e",title:WI.UIString("Search"),isEphemeral:!0}}get type(){return WI.SearchTabContentView.Type}shown(){super.shown(),setTimeout(this.focusSearchField.bind(this))}canShowRepresentedObject(e){return e instanceof WI.DOMTree?!0:!(e instanceof WI.Resource)&&!(e instanceof WI.Script)?!1:!!this.navigationSidebarPanel.contentTreeOutline.getCachedTreeElement(e)}focusSearchField(){this.navigationSidebarPanel.focusSearchField(this._forcePerformSearch),this._forcePerformSearch=!1}performSearch(e){this.navigationSidebarPanel.performSearch(e),this._forcePerformSearch=!1}handleCopyEvent(e){let t=this.navigationSidebarPanel.contentTreeOutline;if(t.element!==document.activeElement)return;let i=t.selectedTreeElement;!i||(e.clipboardData.setData("text/plain",i.synthesizedTextValue),e.stopPropagation(),e.preventDefault())}initialLayout(){super.initialLayout(),this._forcePerformSearch=!0}};WI.SearchTabContentView.Type="search";WI.SettingsTabContentView=class extends WI.TabContentView{constructor(e){let t=WI.PinnedTabBarItem.fromTabInfo(WI.SettingsTabContentView.tabInfo());super(e||"settings","settings",t),t.representedObject=this,this._selectedSettingsView=null,this._settingsViews=[]}static tabInfo(){return{image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' d='M 7.5009 14 C 8.3259 14 9.0009 13.325 9.0019 12.5 L 9.0009 11.725 C 9.1479 11.673 9.2909 11.616 9.4299 11.551 L 10.1759 12.298 C 10.7599 12.881 11.7149 12.88 12.2969 12.297 C 12.5899 12.005 12.7349 11.619 12.7349 11.235 C 12.7349 10.852 12.5899 10.467 12.2979 10.175 L 11.5519 9.429 C 11.6179 9.289 11.6739 9.146 11.7259 9 L 12.5009 8.999 C 13.3259 9 14.0009 8.325 14.0009 7.5 C 14.0009 6.674 13.3259 6 12.5009 5.999 L 11.7259 6 C 11.6739 5.853 11.6179 5.71 11.5519 5.571 L 12.2979 4.825 C 12.5889 4.533 12.7349 4.148 12.7349 3.764 C 12.7349 3.379 12.5899 2.995 12.2989 2.704 C 11.7149 2.119 10.7599 2.119 10.1769 2.702 L 9.4299 3.449 C 9.2899 3.382 9.1479 3.327 9.0009 3.275 L 9.0009 2.499 C 9.0009 1.674 8.3259 0.999 7.5009 0.999 C 6.6759 0.999 6.0009 1.674 6.0009 2.499 L 6.0009 3.275 C 5.8549 3.327 5.7109 3.383 5.5709 3.449 L 4.8249 2.703 C 4.2419 2.12 3.2869 2.12 2.7039 2.703 C 2.4119 2.995 2.2659 3.379 2.2659 3.763 C 2.2659 4.148 2.4119 4.532 2.7029 4.824 L 3.4499 5.571 C 3.3839 5.71 3.3289 5.853 3.2759 6 L 2.5009 5.999 C 1.6759 6 1.0009 6.674 1.0009 7.5 C 1.0009 8.325 1.6759 9 2.5009 9 L 3.2759 9 C 3.3279 9.146 3.3839 9.289 3.4499 9.429 L 2.7039 10.175 C 2.4119 10.467 2.2649 10.852 2.2659 11.236 C 2.2649 11.621 2.4129 12.006 2.7029 12.296 C 3.2869 12.88 4.2419 12.88 4.8249 12.297 L 5.5719 11.551 C 5.7109 11.616 5.8539 11.673 6.0009 11.725 L 5.9999 12.5 C 6.0009 13.325 6.6759 14 7.5009 14 Z'/%3e %3cpath fill='none' stroke='currentColor' d='M 7.5 5.6 C 8.548 5.6 9.4 6.452 9.4 7.5 C 9.4 8.548 8.548 9.4 7.5 9.4 C 6.452 9.4 5.6 8.548 5.6 7.5 C 5.6 6.452 6.452 5.6 7.5 5.6'/%3e %3c/svg%3e",title:WI.UIString("Settings"),isEphemeral:!0}}static shouldSaveTab(){return!1}get type(){return WI.SettingsTabContentView.Type}get supportsSplitContentBrowser(){return!1}get selectedSettingsView(){return this._selectedSettingsView}set selectedSettingsView(e){if(this._selectedSettingsView===e)return;this._selectedSettingsView?this.replaceSubview(this._selectedSettingsView,e):this.addSubview(e),this._selectedSettingsView=e,this._selectedSettingsView.updateLayout();let t=this._navigationBar.findNavigationItem(e.identifier);console.assert(t,"Missing navigation item for settings view.",e),t&&(this._navigationBar.selectedNavigationItem=t)}addSettingsView(e){if(this._settingsViews.includes(e)){console.assert(!1,"SettingsView already exists.",e);return}this._settingsViews.push(e),this._navigationBar.addNavigationItem(new WI.RadioButtonNavigationItem(e.identifier,e.displayName)),this._updateNavigationBarVisibility()}setSettingsViewVisible(e,t){let i=this._navigationBar.findNavigationItem(e.identifier);if(console.assert(i,"Missing NavigationItem for identifier: "+e.identifier),!i||i.hidden===!t)return;if(i.hidden=!t,e.element.classList.toggle("hidden",!t),this._updateNavigationBarVisibility(),!this.selectedSettingsView){t&&(this.selectedSettingsView=e);return}if(this.selectedSettingsView!==e)return;let n=this._settingsViews.indexOf(e);if(console.assert(n!==-1,"SettingsView not found.",e),n===-1)return;let s=n;for(;--s>=0;){let d=this._navigationBar.navigationItems[s];if(console.assert(d),!(!d||d.hidden)){this.selectedSettingsView=this._settingsViews[s];return}}let a=n;for(;++a<this._settingsViews.length;){let d=this._navigationBar.navigationItems[a];if(console.assert(d),!(!d||d.hidden)){this.selectedSettingsView=this._settingsViews[a];return}}}initialLayout(){this._navigationBar=new WI.NavigationBar,this._navigationBar.addEventListener(WI.NavigationBar.Event.NavigationItemSelected,this._navigationItemSelected,this),this.addSubview(this._navigationBar),this._createGeneralSettingsView(),this._createElementsSettingsView(),this._createSourcesSettingsView(),this._createConsoleSettingsView(),this._createExperimentalSettingsView(),WI.notifications.addEventListener(WI.Notification.DebugUIEnabledDidChange,this._updateDebugSettingsViewVisibility,this),this._updateDebugSettingsViewVisibility(),this.selectedSettingsView=this._settingsViews[0]}_createGeneralSettingsView(){let e=new WI.SettingsView("general",WI.UIString("General"));const t=[WI.UIString("Tabs"),WI.UIString("Spaces")];let i=e.addGroupWithCustomSetting(WI.UIString("Prefer indent using:"),WI.SettingEditor.Type.Select,{values:t});i.value=t[WI.settings.indentWithTabs.value?0:1],i.addEventListener(WI.SettingEditor.Event.ValueDidChange,()=>{WI.settings.indentWithTabs.value=i.value===t[0]});function n(_,b){let w=e.addSetting(_,b,WI.UIString("spaces"),{min:1});function S(){w.label=b.value===1?WI.UIString("space"):WI.UIString("spaces")}b.addEventListener(WI.Setting.Event.Changed,E=>{S()}),S()}n(WI.UIString("Tab width:"),WI.settings.tabSize),n(WI.UIString("Indent width:"),WI.settings.indentUnit),e.addSetting(WI.UIString("Line wrapping:"),WI.settings.enableLineWrapping,WI.UIString("Wrap lines to editor width"));let s=e.addGroup(WI.UIString("Show:"));s.addSetting(WI.settings.showWhitespaceCharacters,WI.UIString("Whitespace characters")),s.addSetting(WI.settings.showInvalidCharacters,WI.UIString("Invalid characters")),e.addSeparator();let a=e.addGroup(WI.UIString("Search:","Search: @ Settings","Settings tab label for search related settings"));a.addSetting(WI.settings.searchCaseSensitive,WI.UIString("Case Sensitive","Case Sensitive @ Settings","Settings tab checkbox label for whether searches should be case sensitive.")),a.addSetting(WI.settings.searchRegularExpression,WI.UIString("Regular Expression","Regular Expression @ Settings","Settings tab checkbox label for whether searches should be treated as regular expressions.")),e.addSeparator();const p=[.6,.8,1,1.2,1.4,1.6,1.8,2,2.2,2.4].map(_=>[_,Number.percentageString(_,0)]);let f=e.addGroupWithCustomSetting(WI.UIString("Zoom:"),WI.SettingEditor.Type.Select,{values:p});f.value=WI.getZoomFactor(),f.addEventListener(WI.SettingEditor.Event.ValueDidChange,()=>{WI.setZoomFactor(f.value)}),WI.settings.zoomFactor.addEventListener(WI.Setting.Event.Changed,()=>{f.value=WI.getZoomFactor().maxDecimals(2)}),this.addSettingsView(e)}_createElementsSettingsView(){if(!InspectorBackend.domains.DOM)return;let e=new WI.SettingsView("elements",WI.UIString("Elements"));InspectorBackend.domains.DOM.setInspectModeEnabled&&InspectorBackend.domains.DOM.setInspectModeEnabled.supports("showRulers")&&(e.addSetting(WI.UIString("Element Selection:"),WI.settings.showRulersDuringElementSelection,WI.UIString("Show page rulers and node border lines")),e.addSeparator()),e.addSetting(WI.UIString("CSS Changes:"),WI.settings.cssChangesPerNode,WI.UIString("Show only for selected node")),this.addSettingsView(e)}_createSourcesSettingsView(){let e=new WI.SettingsView("sources",WI.UIString("Sources"));e.addSetting(WI.UIString("Debugger:"),WI.settings.showScopeChainOnPause,WI.UIString("Show Scope Chain on pause")),e.addSeparator(),e.addSetting(WI.UIString("Source Maps:"),WI.settings.sourceMapsEnabled,WI.UIString("Enable source maps")),this.addSettingsView(e)}_createConsoleSettingsView(){let e=new WI.SettingsView("console",WI.UIString("Console"));if(e.addSetting(WI.UIString("Traces:"),WI.settings.consoleAutoExpandTrace,WI.UIString("Auto-expand")),WI.ConsoleManager.supportsLogChannels()){e.addSeparator();const t=[[WI.LoggingChannel.Level.Off,WI.UIString("Off")],[WI.LoggingChannel.Level.Basic,WI.UIString("Basic")],[WI.LoggingChannel.Level.Verbose,WI.UIString("Verbose")]],i={media:WI.UIString("Media Logging:"),mediasource:WI.UIString("MSE Logging:"),webrtc:WI.UIString("WebRTC Logging:")};let n=WI.consoleManager.customLoggingChannels;for(let s of n){let a=e.addGroupWithCustomSetting(i[s.source],WI.SettingEditor.Type.Select,{values:t});a.value=s.level,a.addEventListener(WI.SettingEditor.Event.ValueDidChange,()=>{for(let d of WI.targets)d.ConsoleAgent.setLoggingChannelLevel(s.source,a.value)})}}this.addSettingsView(e)}_createExperimentalSettingsView(){let e=new WI.SettingsView("experimental",WI.UIString("Experimental")),t=new Map;e.addSetting(WI.UIString("Sources:"),WI.settings.experimentalEnableSourcesTab,WI.UIString("Enable Sources Tab")),e.addSeparator(),window.LayerTreeAgent&&(e.addSetting(WI.UIString("Layers:"),WI.settings.experimentalEnableLayersTab,WI.UIString("Enable Layers Tab")),e.addSeparator()),e.addSetting(WI.UIString("User Interface:"),WI.settings.experimentalEnableNewTabBar,WI.UIString("Enable New Tab Bar")),e.addSeparator(),e.addSetting(WI.UIString("Styles:"),WI.settings.experimentalEnableStylesJumpToEffective,WI.UIString("Show Jump to Effective Property Button")),e.addSeparator();let i=document.createElement("button");i.textContent=WI.UIString("Reload Web Inspector"),i.addEventListener("click",a=>{let d=WI._openTabsSetting.value.slice();!t.get(WI.settings.experimentalEnableSourcesTab)&&WI.settings.experimentalEnableSourcesTab.value&&d.push(WI.SourcesTabContentView.Type),!t.get(WI.settings.experimentalEnableLayersTab)&&window.LayerTreeAgent&&WI.settings.experimentalEnableLayersTab.value&&d.push(WI.LayersTabContentView.Type),WI._openTabsSetting.value=d,InspectorFrontendHost.reopen()});let n=e.addCenteredContainer(i,WI.UIString("for changes to take effect"));n.classList.add("hidden");function s(a){t.set(a,a.value),a.addEventListener(WI.Setting.Event.Changed,()=>{n.classList.toggle("hidden",Array.from(t).every(([d,p])=>d.value===p))})}s(WI.settings.experimentalEnableSourcesTab),s(WI.settings.experimentalEnableLayersTab),s(WI.settings.experimentalEnableNewTabBar),s(WI.settings.experimentalEnableStylesJumpToEffective),this.addSettingsView(e)}_createDebugSettingsView(){if(this._debugSettingsView)return;this._debugSettingsView=new WI.SettingsView("debug",WI.unlocalizedString("Debug"));let e=this._debugSettingsView.addGroup(WI.unlocalizedString("Protocol Logging:")),t=e.addSetting(WI.settings.autoLogProtocolMessages,WI.unlocalizedString("Messages"));WI.settings.autoLogProtocolMessages.addEventListener(WI.Setting.Event.Changed,()=>{t.value=InspectorBackend.dumpInspectorProtocolMessages}),e.addSetting(WI.settings.autoLogTimeStats,WI.unlocalizedString("Time Stats")),this._debugSettingsView.addSeparator(),this._debugSettingsView.addSetting(WI.unlocalizedString("Layout Flashing:"),WI.settings.enableLayoutFlashing,WI.unlocalizedString("Draw borders when a view performs a layout")),this._debugSettingsView.addSeparator(),this._debugSettingsView.addSetting(WI.unlocalizedString("Styles:"),WI.settings.enableStyleEditingDebugMode,WI.unlocalizedString("Enable style editing debug mode")),this._debugSettingsView.addSeparator(),this._debugSettingsView.addSetting(WI.unlocalizedString("Heap Snapshot:"),WI.settings.debugShowInternalObjectsInHeapSnapshot,WI.unlocalizedString("Show Internal Objects")),this._debugSettingsView.addSeparator(),this._debugSettingsView.addSetting(WI.unlocalizedString("Debugging:"),WI.settings.pauseForInternalScripts,WI.unlocalizedString("Pause in WebKit-internal scripts")),this._debugSettingsView.addSetting(WI.unlocalizedString("Uncaught Exception Reporter:"),WI.settings.enableUncaughtExceptionReporter,WI.unlocalizedString("Enabled")),this._debugSettingsView.addSeparator();const i=[[WI.LayoutDirection.System,WI.unlocalizedString("System Default")],[WI.LayoutDirection.LTR,WI.unlocalizedString("Left to Right (LTR)")],[WI.LayoutDirection.RTL,WI.unlocalizedString("Right to Left (RTL)")]];let n=this._debugSettingsView.addGroupWithCustomSetting(WI.unlocalizedString("Layout Direction:"),WI.SettingEditor.Type.Select,{values:i});n.value=WI.settings.layoutDirection.value,n.addEventListener(WI.SettingEditor.Event.ValueDidChange,()=>{WI.setLayoutDirection(n.value)});let s=document.createElement("button");s.textContent=WI.unlocalizedString("Reset Web Inspector"),s.addEventListener("click",a=>{WI.reset()}),this._debugSettingsView.addCenteredContainer(s),this.addSettingsView(this._debugSettingsView)}_updateNavigationBarVisibility(){let e=0;for(let t of this._navigationBar.navigationItems)if(!t.hidden&&++e>1){this._navigationBar.element.classList.remove("invisible");return}this._navigationBar.element.classList.add("invisible")}_navigationItemSelected(e){let t=e.target.selectedNavigationItem;if(!t)return;let i=this._settingsViews.find(n=>n.identifier===t.identifier);console.assert(i,"Missing SettingsView for identifier "+t.identifier),i&&(this.selectedSettingsView=i)}_updateDebugSettingsViewVisibility(){WI.isDebugUIEnabled()&&this._createDebugSettingsView(),this._debugSettingsView&&(this.setSettingsViewVisible(this._debugSettingsView,WI.isDebugUIEnabled()),this.needsLayout())}};WI.SettingsTabContentView.Type="settings";WI.SourcesTabContentView=class extends WI.ContentBrowserTabContentView{constructor(){let e=WI.GeneralTabBarItem.fromTabInfo(WI.SourcesTabContentView.tabInfo());const t=[WI.ResourceDetailsSidebarPanel,WI.ScopeChainDetailsSidebarPanel,WI.ProbeDetailsSidebarPanel];super("sources",["sources"],e,WI.SourcesNavigationSidebarPanel,t),this._showScopeChainDetailsSidebarPanel=!1}static tabInfo(){return{image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='none' stroke='currentColor' d='M 2.5 1.5 L 2.5 14.5 L 13.5 14.5 L 13.5 5.5 L 9.5 1.5 L 2.5 1.5 Z'/%3e %3cpath fill='currentColor' d='M 9.0 3.0 L 9.0 6.0 L 12.0 6.0 Z'/%3e %3c/svg%3e",title:WI.UIString("Sources")}}static isTabAllowed(){return!!WI.settings.experimentalEnableSourcesTab.value}get type(){return WI.SourcesTabContentView.Type}get supportsSplitContentBrowser(){return!0}canShowRepresentedObject(e){return e instanceof WI.Frame||e instanceof WI.FrameCollection||e instanceof WI.Resource||e instanceof WI.ResourceCollection||e instanceof WI.Script||e instanceof WI.ScriptCollection||e instanceof WI.CSSStyleSheet||e instanceof WI.CSSStyleSheetCollection||super.canShowRepresentedObject(e)}showDetailsSidebarPanels(){if(super.showDetailsSidebarPanels(),!this._showScopeChainDetailsSidebarPanel)return;let e=this.detailsSidebarPanels.find(i=>i instanceof WI.ScopeChainDetailsSidebarPanel);if(!e)return;let t=e.parentSidebar;!t||(t.selectedSidebarPanel=e,t.collapsed=!1,this._showScopeChainDetailsSidebarPanel=!1)}showScopeChainDetailsSidebarPanel(){this._showScopeChainDetailsSidebarPanel=!0}revealAndSelectBreakpoint(e){console.assert(e instanceof WI.Breakpoint);let t=this.navigationSidebarPanel.treeElementForRepresentedObject(e);t&&t.revealAndSelect()}};WI.SourcesTabContentView.Type="sources";WI.StorageTabContentView=class extends WI.ContentBrowserTabContentView{constructor(e){let t=WI.GeneralTabBarItem.fromTabInfo(WI.StorageTabContentView.tabInfo()),i=[WI.ApplicationCacheDetailsSidebarPanel,WI.IndexedDatabaseDetailsSidebarPanel];super(e||"storage","storage",t,WI.StorageSidebarPanel,i)}static tabInfo(){return{image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='currentColor' d='M 13.4475645 6.5701038 C 14.1131101 6.95915994 14.5 7.44243562 14.5 8 C 14.5 9.52952015 11.5885604 10.5 8 10.5 C 4.41143956 10.5 1.5 9.52952015 1.5 8 C 1.5 7.44243562 1.88688992 6.95915994 2.55243554 6.5701038 C 2.95984566 6.75017534 3.43583057 6.90963763 3.96620982 7.04342621 C 3.94919939 7.04895616 3.93228678 7.05452352 3.91547313 7.06012807 C 2.98303097 7.37094212 2.5 7.7516133 2.5 8 C 2.5 8.2483867 2.98303097 8.62905788 3.91547313 8.93987193 C 4.97873363 9.2942921 6.43777802 9.5 8 9.5 C 9.56222198 9.5 11.0212664 9.2942921 12.0845269 8.93987193 C 13.016969 8.62905788 13.5 8.2483867 13.5 8 C 13.5 7.7516133 13.016969 7.37094212 12.0845269 7.06012807 C 12.0677132 7.05452352 12.0508006 7.04895616 12.0337902 7.04342621 C 12.5641694 6.90963763 13.0401543 6.75017534 13.4475645 6.5701038 Z'/%3e %3cpath fill='currentColor' d='M 13.4475645 10.5701038 C 14.1131101 10.9591599 14.5 11.4424356 14.5 12 C 14.5 13.5295201 11.5885604 14.5 8 14.5 C 4.41143956 14.5 1.5 13.5295201 1.5 12 C 1.5 11.4424356 1.88688992 10.9591599 2.55243554 10.5701038 C 2.95984566 10.7501753 3.43583057 10.9096376 3.96620982 11.0434262 C 3.94919939 11.0489562 3.93228678 11.0545235 3.91547313 11.0601281 C 2.98303097 11.3709421 2.5 11.7516133 2.5 12 C 2.5 12.2483867 2.98303097 12.6290579 3.91547313 12.9398719 C 4.97873363 13.2942921 6.43777802 13.5 8 13.5 C 9.56222198 13.5 11.0212664 13.2942921 12.0845269 12.9398719 C 13.016969 12.6290579 13.5 12.2483867 13.5 12 C 13.5 11.7516133 13.016969 11.3709421 12.0845269 11.0601281 C 12.0677132 11.0545235 12.0508006 11.0489562 12.0337902 11.0434262 C 12.5641694 10.9096376 13.0401543 10.7501753 13.4475645 10.5701038 Z'/%3e %3cpath fill='currentColor' d='M 14.5 4 C 14.5 2.47047985 11.5885604 1.5 8 1.5 C 4.41143956 1.5 1.5 2.47047985 1.5 4 C 1.5 5.52952015 4.41143956 6.5 8 6.5 C 11.5885604 6.5 14.5 5.52952015 14.5 4 Z M 3.91547313 4.93987193 C 2.98303097 4.62905788 2.5 4.2483867 2.5 4 C 2.5 3.7516133 2.98303097 3.37094212 3.91547313 3.06012807 C 4.97873363 2.7057079 6.43777802 2.5 8 2.5 C 9.56222198 2.5 11.0212664 2.7057079 12.0845269 3.06012807 C 13.016969 3.37094212 13.5 3.7516133 13.5 4 C 13.5 4.2483867 13.016969 4.62905788 12.0845269 4.93987193 C 11.0212664 5.2942921 9.56222198 5.5 8 5.5 C 6.43777802 5.5 4.97873363 5.2942921 3.91547313 4.93987193 Z'/%3e %3c/svg%3e",title:WI.UIString("Storage")}}static isTabAllowed(){return!!window.DOMStorageAgent||!!window.DatabaseAgent||!!window.IndexedDBAgent}get type(){return WI.StorageTabContentView.Type}get supportsSplitContentBrowser(){return!0}canShowRepresentedObject(e){return e instanceof WI.DOMStorageObject||e instanceof WI.CookieStorageObject||e instanceof WI.DatabaseTableObject||e instanceof WI.DatabaseObject||e instanceof WI.ApplicationCacheFrame||e instanceof WI.IndexedDatabaseObjectStore||e instanceof WI.IndexedDatabase||e instanceof WI.IndexedDatabaseObjectStoreIndex}};WI.StorageTabContentView.Type="storage";WI.TimelineTabContentView=class extends WI.ContentBrowserTabContentView{constructor(e){let t=WI.GeneralTabBarItem.fromTabInfo(WI.TimelineTabContentView.tabInfo());super(e||"timeline","timeline",t),this._recordingTreeElementMap=new Map,this._recordingsTreeOutline=new WI.TreeOutline,this._recordingsTreeOutline.addEventListener(WI.TreeOutline.Event.SelectionDidChange,this._recordingsTreeSelectionDidChange,this),this._toggleRecordingShortcut=new WI.KeyboardShortcut(null,WI.KeyboardShortcut.Key.Space,this._toggleRecordingOnSpacebar.bind(this)),this._toggleRecordingShortcut.implicitlyPreventsDefault=!1,this._toggleRecordingShortcut.disabled=!0,this._toggleNewRecordingShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.Shift,WI.KeyboardShortcut.Key.Space,this._toggleNewRecordingOnSpacebar.bind(this)),this._toggleNewRecordingShortcut.implicitlyPreventsDefault=!1,this._toggleNewRecordingShortcut.disabled=!0;let i=WI.UIString(`Start recording (%s)
Create new recording (%s)`).format(this._toggleRecordingShortcut.displayName,this._toggleNewRecordingShortcut.displayName),n=WI.UIString("Stop recording (%s)").format(this._toggleRecordingShortcut.displayName);if(this._recordButton=new WI.ToggleButtonNavigationItem("record-start-stop",i,n,"data:image/svg+xml,%3c%3fxml version='1.0'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 13'%3e %3ccircle fill='red' cx='6.5' cy='6.5' r='6'/%3e %3c/svg%3e","data:image/svg+xml,%3c%3fxml version='1.0'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 13'%3e %3crect fill='currentColor' x='1' y='1' width='11' height='11'/%3e %3c/svg%3e",13,13),this._recordButton.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._recordButton.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._recordButtonClicked,this),this._continueButton=new WI.ButtonNavigationItem("record-continue",WI.UIString("Continue without automatically stopping"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3cpath d='M 6.5 2.5 L 6.5 12.5 L 14.5 7.5 L 6.5 2.5 Z'/%3e %3crect x='0.5' y='2.5' width='3' height='10'/%3e %3c/svg%3e",13,13),this._continueButton.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._continueButton.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._continueButtonClicked,this),this._continueButton.hidden=!0,this.contentBrowser.navigationBar.insertNavigationItem(this._recordButton,0),this.contentBrowser.navigationBar.insertNavigationItem(this._continueButton,1),WI.FPSInstrument.supported()){let a=new WI.RadioButtonNavigationItem(WI.TimelineOverview.ViewMode.Timelines,WI.UIString("Events")),d=new WI.RadioButtonNavigationItem(WI.TimelineOverview.ViewMode.RenderingFrames,WI.UIString("Frames")),p=new WI.GroupNavigationItem([a,d]);p.visibilityPriority=WI.NavigationItem.VisibilityPriority.High,this.contentBrowser.navigationBar.insertNavigationItem(p,2),this.contentBrowser.navigationBar.addEventListener(WI.NavigationBar.Event.NavigationItemSelected,this._viewModeSelected,this)}WI.timelineManager.addEventListener(WI.TimelineManager.Event.CapturingStateChanged,this._handleTimelineCapturingStateChanged,this),WI.timelineManager.addEventListener(WI.TimelineManager.Event.RecordingCreated,this._recordingCreated,this),WI.timelineManager.addEventListener(WI.TimelineManager.Event.RecordingLoaded,this._recordingLoaded,this),WI.notifications.addEventListener(WI.Notification.VisibilityStateDidChange,this._inspectorVisibilityChanged,this),WI.notifications.addEventListener(WI.Notification.GlobalModifierKeysDidChange,this._globalModifierKeysDidChange,this),this._displayedRecording=null,this._displayedContentView=null,this._viewMode=null,this._previousSelectedTimelineType=null;const s=!1;this._changeViewMode(WI.TimelineOverview.ViewMode.Timelines,s);for(let a of WI.timelineManager.recordings)this._addRecording(a);this._recordingCountChanged(),this.contentBrowser.updateHierarchicalPathForCurrentContentView()}static tabInfo(){return{image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3ccircle fill='none' stroke='currentColor' cx='8' cy='8' r='7.5'/%3e %3cpath fill='none' stroke='currentColor' d='M 8.5 3 L 8.5 8.5 L 5 8.5'/%3e %3c/svg%3e",title:WI.UIString("Timelines")}}static isTabAllowed(){return!!window.TimelineAgent||!!window.ScriptProfilerAgent}static displayNameForTimelineType(e){switch(e){case WI.TimelineRecord.Type.Network:return WI.UIString("Network Requests");case WI.TimelineRecord.Type.Layout:return WI.UIString("Layout & Rendering");case WI.TimelineRecord.Type.Script:return WI.UIString("JavaScript & Events");case WI.TimelineRecord.Type.RenderingFrame:return WI.UIString("Rendering Frames");case WI.TimelineRecord.Type.CPU:return WI.UIString("CPU");case WI.TimelineRecord.Type.Memory:return WI.UIString("Memory");case WI.TimelineRecord.Type.HeapAllocations:return WI.UIString("JavaScript Allocations");case WI.TimelineRecord.Type.Media:return WI.UIString("Media");default:console.error("Unknown Timeline type:",e)}return null}static iconClassNameForTimelineType(e){switch(e){case WI.TimelineRecord.Type.Network:return"network-icon";case WI.TimelineRecord.Type.Layout:return"layout-icon";case WI.TimelineRecord.Type.CPU:return"cpu-icon";case WI.TimelineRecord.Type.Memory:return"memory-icon";case WI.TimelineRecord.Type.HeapAllocations:return"heap-allocations-icon";case WI.TimelineRecord.Type.Script:return"script-icon";case WI.TimelineRecord.Type.RenderingFrame:return"rendering-frame-icon";case WI.TimelineRecord.Type.Media:return"media-icon";default:console.error("Unknown Timeline type:",e)}return null}static genericClassNameForTimelineType(e){switch(e){case WI.TimelineRecord.Type.Network:return"network";case WI.TimelineRecord.Type.Layout:return"colors";case WI.TimelineRecord.Type.CPU:return"cpu";case WI.TimelineRecord.Type.Memory:return"memory";case WI.TimelineRecord.Type.HeapAllocations:return"heap-allocations";case WI.TimelineRecord.Type.Script:return"script";case WI.TimelineRecord.Type.RenderingFrame:return"rendering-frame";case WI.TimelineRecord.Type.Media:return"media";default:console.error("Unknown Timeline type:",e)}return null}static iconClassNameForRecord(e){switch(e.type){case WI.TimelineRecord.Type.Layout:switch(e.eventType){case WI.LayoutTimelineRecord.EventType.InvalidateStyles:case WI.LayoutTimelineRecord.EventType.RecalculateStyles:return WI.TimelineRecordTreeElement.StyleRecordIconStyleClass;case WI.LayoutTimelineRecord.EventType.InvalidateLayout:case WI.LayoutTimelineRecord.EventType.ForcedLayout:case WI.LayoutTimelineRecord.EventType.Layout:return WI.TimelineRecordTreeElement.LayoutRecordIconStyleClass;case WI.LayoutTimelineRecord.EventType.Paint:return WI.TimelineRecordTreeElement.PaintRecordIconStyleClass;case WI.LayoutTimelineRecord.EventType.Composite:return WI.TimelineRecordTreeElement.CompositeRecordIconStyleClass;default:console.error("Unknown LayoutTimelineRecord eventType: "+e.eventType,e)}break;case WI.TimelineRecord.Type.Script:switch(e.eventType){case WI.ScriptTimelineRecord.EventType.APIScriptEvaluated:return WI.TimelineRecordTreeElement.APIRecordIconStyleClass;case WI.ScriptTimelineRecord.EventType.ScriptEvaluated:return WI.TimelineRecordTreeElement.EvaluatedRecordIconStyleClass;case WI.ScriptTimelineRecord.EventType.MicrotaskDispatched:case WI.ScriptTimelineRecord.EventType.EventDispatched:case WI.ScriptTimelineRecord.EventType.ObserverCallback:return WI.TimelineRecordTreeElement.EventRecordIconStyleClass;case WI.ScriptTimelineRecord.EventType.ProbeSampleRecorded:return WI.TimelineRecordTreeElement.ProbeRecordIconStyleClass;case WI.ScriptTimelineRecord.EventType.ConsoleProfileRecorded:return WI.TimelineRecordTreeElement.ConsoleProfileIconStyleClass;case WI.ScriptTimelineRecord.EventType.GarbageCollected:return WI.TimelineRecordTreeElement.GarbageCollectionIconStyleClass;case WI.ScriptTimelineRecord.EventType.TimerInstalled:return WI.TimelineRecordTreeElement.TimerRecordIconStyleClass;case WI.ScriptTimelineRecord.EventType.TimerFired:case WI.ScriptTimelineRecord.EventType.TimerRemoved:return WI.TimelineRecordTreeElement.TimerRecordIconStyleClass;case WI.ScriptTimelineRecord.EventType.AnimationFrameFired:case WI.ScriptTimelineRecord.EventType.AnimationFrameRequested:case WI.ScriptTimelineRecord.EventType.AnimationFrameCanceled:return WI.TimelineRecordTreeElement.AnimationRecordIconStyleClass;default:console.error("Unknown ScriptTimelineRecord eventType: "+e.eventType,e)}break;case WI.TimelineRecord.Type.RenderingFrame:return WI.TimelineRecordTreeElement.RenderingFrameRecordIconStyleClass;case WI.TimelineRecord.Type.HeapAllocations:return"heap-snapshot-record";case WI.TimelineRecord.Type.Media:switch(e.eventType){case WI.MediaTimelineRecord.EventType.DOMEvent:return"dom-event-record";case WI.MediaTimelineRecord.EventType.PowerEfficientPlaybackStateChanged:return"power-efficient-playback-state-changed-record";default:console.error("Unknown MediaTimelineRecord eventType: "+e.eventType,e)}break;case WI.TimelineRecord.Type.CPU:case WI.TimelineRecord.Type.Memory:default:console.error("Unknown TimelineRecord type: "+e.type,e)}return null}static displayNameForRecord(e,t){switch(e.type){case WI.TimelineRecord.Type.Network:return WI.displayNameForURL(e.resource.url,e.resource.urlComponents);case WI.TimelineRecord.Type.Layout:return WI.LayoutTimelineRecord.displayNameForEventType(e.eventType);case WI.TimelineRecord.Type.Script:return WI.ScriptTimelineRecord.EventType.displayName(e.eventType,e.details,t);case WI.TimelineRecord.Type.RenderingFrame:return WI.UIString("Frame %d").format(e.frameNumber);case WI.TimelineRecord.Type.HeapAllocations:return e.heapSnapshot.imported?WI.UIString("Imported \u2014 %s").format(e.heapSnapshot.title):e.heapSnapshot.title?WI.UIString("Snapshot %d \u2014 %s").format(e.heapSnapshot.identifier,e.heapSnapshot.title):WI.UIString("Snapshot %d").format(e.heapSnapshot.identifier);case WI.TimelineRecord.Type.Media:return e.displayName;case WI.TimelineRecord.Type.CPU:case WI.TimelineRecord.Type.Memory:default:console.error("Unknown TimelineRecord type: "+e.type,e)}return null}get type(){return WI.TimelineTabContentView.Type}shown(){super.shown(),this._toggleRecordingShortcut.disabled=!1,this._toggleNewRecordingShortcut.disabled=!1,WI.visible&&(WI.timelineManager.autoCaptureOnPageLoad=!0)}hidden(){super.hidden(),this._toggleRecordingShortcut.disabled=!0,this._toggleNewRecordingShortcut.disabled=!0,WI.timelineManager.autoCaptureOnPageLoad=!1}closed(){super.closed(),WI.FPSInstrument.supported()&&this.contentBrowser.navigationBar.removeEventListener(null,null,this),WI.timelineManager.removeEventListener(null,null,this),WI.notifications.removeEventListener(null,null,this)}canShowRepresentedObject(e){return e instanceof WI.TimelineRecording}async handleFileDrop(e){await WI.FileUtilities.readJSON(e,t=>WI.timelineManager.processJSON(t))}restoreFromCookie(e){if(console.assert(e),this._restoredShowingTimelineRecordingContentView=e[WI.TimelineTabContentView.ShowingTimelineRecordingContentViewCookieKey],!this._restoredShowingTimelineRecordingContentView){this.contentBrowser.currentContentView||(!this._displayedRecording&&WI.timelineManager.activeRecording&&this._recordingLoaded(),this._showTimelineViewForType(WI.TimelineTabContentView.OverviewTimelineIdentifierCookieValue));return}let t=e[WI.TimelineTabContentView.SelectedTimelineViewIdentifierCookieKey];t===WI.TimelineRecord.Type.RenderingFrame&&!WI.FPSInstrument.supported()&&(t=null),this._showTimelineViewForType(t),super.restoreFromCookie(e)}saveToCookie(e){if(console.assert(e),e[WI.TimelineTabContentView.ShowingTimelineRecordingContentViewCookieKey]=this.contentBrowser.currentContentView instanceof WI.TimelineRecordingContentView,this._viewMode===WI.TimelineOverview.ViewMode.RenderingFrames)e[WI.TimelineTabContentView.SelectedTimelineViewIdentifierCookieKey]=WI.TimelineRecord.Type.RenderingFrame;else{let t=this._getTimelineForCurrentContentView();t?e[WI.TimelineTabContentView.SelectedTimelineViewIdentifierCookieKey]=t.type:e[WI.TimelineTabContentView.SelectedTimelineViewIdentifierCookieKey]=WI.TimelineTabContentView.OverviewTimelineIdentifierCookieValue}super.saveToCookie(e)}treeElementForRepresentedObject(e){return this._recordingTreeElementMap&&e instanceof WI.TimelineRecording?this._recordingTreeElementMap.get(e):null}_showRecordButton(){this._recordButton.hidden=!1,this._continueButton.hidden=!0}_showContinueButton(){this._recordButton.hidden=!0,this._continueButton.hidden=!1}_updateNavigationBarButtons(){!WI.modifierKeys.altKey||!WI.timelineManager.willAutoStop()?this._showRecordButton():this._showContinueButton()}_handleTimelineCapturingStateChanged(e){let t=WI.timelineManager.capturingState===WI.TimelineManager.CapturingState.Active||WI.timelineManager.capturingState===WI.TimelineManager.CapturingState.Inactive;this._toggleRecordingShortcut.disabled=!t,this._toggleNewRecordingShortcut.disabled=!t,this._recordButton.toggled=WI.timelineManager.isCapturing(),this._recordButton.enabled=t,this._updateNavigationBarButtons()}_inspectorVisibilityChanged(e){WI.timelineManager.autoCaptureOnPageLoad=!!this.visible&&!!WI.visible}_globalModifierKeysDidChange(e){this._updateNavigationBarButtons()}_toggleRecordingOnSpacebar(e){WI.timelineManager.activeRecording.readonly||WI.isEventTargetAnEditableField(e)||(this._toggleRecording(),e.preventDefault())}_toggleNewRecordingOnSpacebar(e){WI.isEventTargetAnEditableField(e)||(this._toggleRecording(!0),e.preventDefault())}_toggleRecording(e){let t=WI.timelineManager.isCapturing();this._recordButton.toggled=t,t?WI.timelineManager.stopCapturing():(WI.timelineManager.startCapturing(e),this._recordingLoaded())}_recordButtonClicked(e){let t=window.event?window.event.shiftKey:!1;WI.timelineManager.activeRecording.readonly&&(t=!0),this._recordButton.toggled=!WI.timelineManager.isCapturing(),this._toggleRecording(t)}_continueButtonClicked(e){console.assert(WI.timelineManager.willAutoStop()),WI.timelineManager.relaxAutoStop(),this._updateNavigationBarButtons()}_recordingsTreeSelectionDidChange(e){let t=this._recordingsTreeOutline.selectedTreeElement;!t||(console.assert(t.representedObject instanceof WI.TimelineRecording),this._recordingSelected(t.representedObject))}_recordingCreated(e){this._addRecording(e.data.recording),this._recordingCountChanged()}_addRecording(e){console.assert(e instanceof WI.TimelineRecording,e);let t=new WI.GeneralTreeElement(WI.TimelineTabContentView.StopwatchIconStyleClass,e.displayName,null,e);this._recordingTreeElementMap.set(e,t),this._recordingsTreeOutline.appendChild(t)}_recordingCountChanged(){let e=null;for(let t of this._recordingTreeElementMap.values())e&&(e.nextSibling=t,t.previousSibling=e),e=t}_recordingSelected(e){console.assert(e instanceof WI.TimelineRecording,e),this._displayedRecording=e;let t={};this.saveToCookie(t),this._displayedContentView&&this._displayedContentView.removeEventListener(WI.ContentView.Event.NavigationItemsDidChange,this._displayedContentViewNavigationItemsDidChange,this);let i=!0;if(this._displayedContentView=this.contentBrowser.contentViewForRepresentedObject(this._displayedRecording,i),this._displayedContentView){this._displayedContentView.addEventListener(WI.ContentView.Event.NavigationItemsDidChange,this._displayedContentViewNavigationItemsDidChange,this);let n=this._displayedContentView.currentTimelineView,s=n&&n.representedObject instanceof WI.Timeline?n.representedObject.type:null;this._showTimelineViewForType(s);return}i=!1,this._displayedContentView=this.contentBrowser.contentViewForRepresentedObject(this._displayedRecording,i),this._displayedContentView&&this._displayedContentView.addEventListener(WI.ContentView.Event.NavigationItemsDidChange,this._displayedContentViewNavigationItemsDidChange,this),this.restoreFromCookie(t)}_recordingLoaded(e){this._recordingSelected(WI.timelineManager.activeRecording)}_viewModeSelected(e){let t=e.target.selectedNavigationItem;if(console.assert(t),!t)return;const i=!0;this._changeViewMode(t.identifier,i)}_changeViewMode(e,t){if(this._viewMode===e)return;let i=this.contentBrowser.navigationBar.findNavigationItem(e);if(console.assert(i,"Couldn't find navigation item for this view mode."),!i||(this._viewMode=e,this.contentBrowser.navigationBar.selectedNavigationItem=i,!t))return;let n=this._previousSelectedTimelineType;if(this._viewMode===WI.TimelineOverview.ViewMode.RenderingFrames){let s=this._getTimelineForCurrentContentView();this._previousSelectedTimelineType=s?s.type:null,n=WI.TimelineRecord.Type.RenderingFrame}this._showTimelineViewForType(n)}_showTimelineViewForType(e){console.assert(this._displayedRecording),console.assert(this._displayedContentView);let t=e?this._displayedRecording.timelines.get(e):null;t?this._displayedContentView.showTimelineViewForTimeline(t):this._displayedContentView.showOverviewTimelineView(),this.contentBrowser.currentContentView!==this._displayedContentView&&this.contentBrowser.showContentView(this._displayedContentView)}_displayedContentViewNavigationItemsDidChange(e){let t=this._getTimelineForCurrentContentView(),i=WI.TimelineOverview.ViewMode.Timelines;t&&t.type===WI.TimelineRecord.Type.RenderingFrame&&(i=WI.TimelineOverview.ViewMode.RenderingFrames);const n=!1;this._changeViewMode(i,n)}_getTimelineForCurrentContentView(){let e=this.contentBrowser.currentContentView;if(!(e instanceof WI.TimelineRecordingContentView))return null;let t=e.currentTimelineView;return t&&t.representedObject instanceof WI.Timeline?t.representedObject:null}};WI.TimelineTabContentView.Type="timeline";WI.TimelineTabContentView.ShowingTimelineRecordingContentViewCookieKey="timeline-sidebar-panel-showing-timeline-recording-content-view";WI.TimelineTabContentView.SelectedTimelineViewIdentifierCookieKey="timeline-sidebar-panel-selected-timeline-view-identifier";WI.TimelineTabContentView.OverviewTimelineIdentifierCookieValue="overview";WI.TimelineTabContentView.StopwatchIconStyleClass="stopwatch-icon";WI.DetailsSection=class extends WI.Object{constructor(e,t,i,n,s){super(),console.assert(e),this._element=document.createElement("div"),this._element.classList.add(e,"details-section"),this._headerElement=document.createElement("div"),this._headerElement.addEventListener("click",this._headerElementClicked.bind(this)),this._headerElement.className="header",this._element.appendChild(this._headerElement),n instanceof HTMLElement&&(this._optionsElement=n,this._optionsElement.classList.add("options"),this._optionsElement.addEventListener("mousedown",this._optionsElementMouseDown.bind(this)),this._optionsElement.addEventListener("mouseup",this._optionsElementMouseUp.bind(this)),this._headerElement.appendChild(this._optionsElement)),this._titleElement=document.createElement("span"),this._headerElement.appendChild(this._titleElement),this._contentElement=document.createElement("div"),this._contentElement.className="content",this._element.appendChild(this._contentElement),this._identifier=e,this.title=t,this.groups=i||[new WI.DetailsSectionGroup],this._collapsedSetting=new WI.Setting(e+"-details-section-collapsed",!!s),this.collapsed=this._collapsedSetting.value,this._expandedByUser=!1}get element(){return this._element}get headerElement(){return this._headerElement}get identifier(){return this._identifier}get title(){return this._titleElement.textContent}set title(e){this._titleElement.textContent=e}get titleElement(){return this._titleElement}set titleElement(e){console.assert(e instanceof HTMLElement,"Expected titleElement to be an HTMLElement.",e),this._headerElement.replaceChild(e,this._titleElement),this._titleElement=e}get collapsed(){return this._element.classList.contains(WI.DetailsSection.CollapsedStyleClassName)}set collapsed(e){e?this._element.classList.add(WI.DetailsSection.CollapsedStyleClassName):this._element.classList.remove(WI.DetailsSection.CollapsedStyleClassName),this._collapsedSetting.value=e||!1,this.dispatchEventToListeners(WI.DetailsSection.Event.CollapsedStateChanged,{collapsed:this._collapsedSetting.value})}get groups(){return this._groups}set groups(e){this._contentElement.removeChildren(),this._groups=e||[];for(var t=0;t<this._groups.length;++t)this._contentElement.appendChild(this._groups[t].element)}get expandedByUser(){return this._expandedByUser}_headerElementClicked(e){if(!(this._optionsElement&&this._optionsElement.contains(e.target))){var t=this.collapsed;this.collapsed=!t,this._expandedByUser=t,this._element.scrollIntoViewIfNeeded(!1)}}_optionsElementMouseDown(e){this._headerElement.classList.add(WI.DetailsSection.MouseOverOptionsElementStyleClassName)}_optionsElementMouseUp(e){this._headerElement.classList.remove(WI.DetailsSection.MouseOverOptionsElementStyleClassName)}};WI.DetailsSection.CollapsedStyleClassName="collapsed";WI.DetailsSection.MouseOverOptionsElementStyleClassName="mouse-over-options-element";WI.DetailsSection.Event={CollapsedStateChanged:"details-section-collapsed-state-changed"};WI.DetailsSectionDataGridRow=class extends WI.DetailsSectionRow{constructor(e,t){super(t),this.element.classList.add("data-grid"),this.dataGrid=e}get dataGrid(){return this._dataGrid}set dataGrid(e){this._dataGrid!==e&&(this._dataGrid=e||null,e?(e.inline=!0,e.variableHeightRows=!0,this.hideEmptyMessage(),this.element.appendChild(e.element),e.updateLayoutIfNeeded()):this.showEmptyMessage())}sizeDidChange(){this._dataGrid&&this._dataGrid.sizeDidChange()}};WI.DetailsSectionGroup=class extends WI.Object{constructor(e){super(),this._element=document.createElement("div"),this._element.className="group",this.rows=e||[]}get element(){return this._element}get rows(){return this._rows}set rows(e){this._element.removeChildren(),this._rows=e||[];for(var t=0;t<this._rows.length;++t)this._element.appendChild(this._rows[t].element)}};WI.DetailsSectionSimpleRow=class extends WI.DetailsSectionRow{constructor(e,t){super(),this.element.classList.add("simple"),this._labelElement=document.createElement("div"),this._labelElement.className="label",this.element.appendChild(this._labelElement),this._valueElement=document.createElement("div"),this._valueElement.className="value",this.element.appendChild(this._valueElement);var i=function(n){if(n.stopPropagation(),!(n.detail<3)){var s=window.getSelection();if(!!s){var a=s.getRangeAt(0);if(!(!a||a.startContainer===a.endContainer)){var d=document.createRange();d.selectNodeContents(n.currentTarget),s.removeAllRanges(),s.addRange(d)}}}};this._valueElement.addEventListener("click",i),this.label=e,this.value=t}get label(){return this._label}set label(e){this._label=e||"",this._label instanceof Node?(this._labelElement.removeChildren(),this._labelElement.appendChild(this._label)):this._labelElement.textContent=this._label}get value(){return this._value}set value(e){this._value=e||"",this._value?(this.element.classList.remove(WI.DetailsSectionSimpleRow.EmptyStyleClassName),/[\s\u200b]/.test(this._value)?this.element.classList.remove(WI.DetailsSectionSimpleRow.DataStyleClassName):this.element.classList.add(WI.DetailsSectionSimpleRow.DataStyleClassName)):(this.element.classList.add(WI.DetailsSectionSimpleRow.EmptyStyleClassName),this.element.classList.remove(WI.DetailsSectionSimpleRow.DataStyleClassName)),e instanceof Node?(this._valueElement.removeChildren(),this._valueElement.appendChild(this._value)):this._valueElement.textContent=this._value}get tooltip(){return this._valueElement.title}set tooltip(e){this._valueElement.title=e}};WI.DetailsSectionSimpleRow.DataStyleClassName="data";WI.DetailsSectionSimpleRow.EmptyStyleClassName="empty";WI.DetailsSectionTextRow=class extends WI.DetailsSectionRow{constructor(e){super(),this.element.classList.add("text"),this.element.textContent=e}get text(){return this.element.textContent}set text(e){this.element.textContent=e}};WI.SettingEditor=class extends WI.Object{constructor(e,t,i){super(),this._type=e,this._value=null,this._editorElement=this._createEditorElement(i),console.assert(this._editorElement),this._element=document.createElement("div"),this._element.classList.add("editor"),this._element.append(this._editorElement),this.label=t}static createForSetting(e,t,i){let n;if(typeof e.value=="boolean"?n=WI.SettingEditor.Type.Checkbox:typeof e.value=="number"&&(n=WI.SettingEditor.Type.Numeric),console.assert(n,"Cannot deduce editor type from setting value type.",e),!n)return null;let s=new WI.SettingEditor(n,t,i);return s.value=e.value,s.addEventListener(WI.SettingEditor.Event.ValueDidChange,()=>{e.value=s.value}),e.addEventListener(WI.Setting.Event.Changed,()=>{s.value=e.value}),s}get element(){return this._element}get type(){return this._type}get label(){return this._label}set label(e){if(e!==this._label){if(this._label=e,!this._label){this._labelElement&&this._labelElement.remove(),this._editorElement.removeAttribute("id"),this._labelElement=null;return}this._labelElement||(this._editorElement.id="setting-editor-"+WI.SettingEditor._nextEditorIdentifier++,this._labelElement=this._element.appendChild(document.createElement("label")),this._labelElement.setAttribute("for",this._editorElement.id)),this._labelElement.textContent=this._label}}get value(){return this._value}set value(e){if(this._value===e)return;let t=this._value;this._value=e,this._type===WI.SettingEditor.Type.Checkbox?this._editorElement.checked=!!this._value:this._editorElement.value=this._value,this.dispatchEventToListeners(WI.SettingEditor.Event.ValueDidChange,{oldValue:t})}_createEditorElement(e){let t;switch(this._type){case WI.SettingEditor.Type.Checkbox:t=document.createElement("input"),t.type="checkbox",t.addEventListener("change",n=>{this.value=n.target.checked});break;case WI.SettingEditor.Type.Numeric:t=document.createElement("input"),t.type="number",e.min!==void 0&&(t.min=e.min),e.max!==void 0&&(t.max=e.max),t.addEventListener("change",n=>{let s=this._value,a=parseInt(n.target.value);this.value=isNaN(a)?s:a});break;case WI.SettingEditor.Type.Select:t=document.createElement("select");var i=[];console.assert(Array.isArray(e.values),"Expected values array for select editor.",e),Array.isArray(e.values[0])?i=e.values:i=e.values.map(n=>[n,n]);for(let[n,s]of i){let a=t.appendChild(document.createElement("option"));a.value=n,a.textContent=s}t.addEventListener("change",n=>{this.value=n.target.value});break;default:console.error("Unknown editor type: "+this._type)}return t}};WI.SettingEditor._nextEditorIdentifier=1;WI.SettingEditor.Type={Checkbox:"setting-editor-type-checkbox",Numeric:"setting-editor-type-numeric",Select:"setting-editor-type-select"};WI.SettingEditor.Event={ValueDidChange:"value-did-change"};WI.SettingsGroup=class extends WI.Object{constructor(e){super(),this._element=document.createElement("div"),this._element.classList.add("container");let t=this._element.appendChild(document.createElement("div"));t.classList.add("title"),t.textContent=e,this._editorGroupElement=this._element.appendChild(document.createElement("div")),this._editorGroupElement.classList.add("editor-group")}get element(){return this._element}addSetting(e,t,i){let n=WI.SettingEditor.createForSetting(e,t,i);return console.assert(n,"Could not create default editor for setting. Use addCustomSetting instead.",e),n?(this._editorGroupElement.append(n.element),n):null}addCustomSetting(e,t){let i=new WI.SettingEditor(e,t.label,t);return i?(this._editorGroupElement.append(i.element),i):null}};WI.SettingsView=class extends WI.View{constructor(e,t){super(),this._identifier=e,this._displayName=t,this.element.classList.add("settings-view",e)}get identifier(){return this._identifier}get displayName(){return this._displayName}addSetting(e,t,i,n){return this.addGroup(e).addSetting(t,i,n)}addGroupWithCustomSetting(e,t,i){return this.addGroup(e).addCustomSetting(t,i)}addGroup(e){let t=new WI.SettingsGroup(e);return this.element.append(t.element),t}addSeparator(){if(this.element.lastChild&&this.element.lastChild.classList.contains("separator"))return;this.element.appendChild(document.createElement("div")).classList.add("separator")}addCenteredContainer(...e){let t=document.createElement("div");return t.append(...e),t.classList.add("container","container-centered"),this.element.append(t),t}};WI.SettingsView.EditorType={Checkbox:"settings-view-editor-type-checkbox",Numeric:"settings-view-editor-type-numeric",Select:"settings-view-editor-type-select"};WI.AuditTestContentView=class extends WI.ContentView{constructor(e){console.assert(e instanceof WI.AuditTestBase||e instanceof WI.AuditTestResultBase),super(e),console.assert(this.constructor!==WI.AuditTestContentView&&this instanceof WI.AuditTestContentView),this.element.classList.add("audit-test"),this._exportButtonNavigationItem=new WI.ButtonNavigationItem("audit-export",WI.UIString("Export"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' d='M 7.5 2 v 7.5'/%3e %3cpath fill='none' stroke='currentColor' d='M 4.5 5 l 3 -3 l 3 3'/%3e %3cpolyline fill='none' stroke='currentColor' points='12.5 9 12.5 12.5 2.5 12.5 2.5 9'/%3e %3c/svg%3e",15,15),this._exportButtonNavigationItem.tooltip=WI.UIString("Export result (%s)").format(WI.saveKeyboardShortcut.displayName),this._exportButtonNavigationItem.buttonStyle=WI.ButtonNavigationItem.Style.ImageAndText,this._exportButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._exportButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._handleExportButtonNavigationItemClicked,this),this._updateExportButtonNavigationItemState(),this._headerView=new WI.View(document.createElement("header")),this._contentView=new WI.View(document.createElement("section")),this._placeholderElement=null,this._shownResult=null}get navigationItems(){return[this._exportButtonNavigationItem]}get headerView(){return this._headerView}get contentView(){return this._contentView}get supportsSave(){return!!this.representedObject.result}get saveData(){return{customSaveHandler:()=>{this._exportResult()}}}get result(){return this.representedObject instanceof WI.AuditTestBase?this.representedObject:this.representedObject.result}initialLayout(){super.initialLayout(),this.addSubview(this._headerView),this.addSubview(this._contentView)}layout(){super.layout(),this.hidePlaceholder(),this._updateExportButtonNavigationItemState()}shown(){super.shown(),this.representedObject instanceof WI.AuditTestBase&&(this.representedObject.addEventListener(WI.AuditTestBase.Event.Completed,this._handleTestChanged,this),this.representedObject.addEventListener(WI.AuditTestBase.Event.Progress,this._handleTestChanged,this),this.representedObject.addEventListener(WI.AuditTestBase.Event.ResultChanged,this.handleResultChanged,this),this.representedObject.addEventListener(WI.AuditTestBase.Event.Scheduled,this._handleTestChanged,this),this.representedObject.addEventListener(WI.AuditTestBase.Event.Stopping,this._handleTestChanged,this))}hidden(){this.representedObject instanceof WI.AuditTestBase&&this.representedObject.removeEventListener(null,null,this),super.hidden()}handleResultChanged(e){this.needsLayout()}get placeholderElement(){return this._placeholderElement}set placeholderElement(e){this.hidePlaceholder(),this._placeholderElement=e}showRunningPlaceholder(){console.assert(this.placeholderElement),this._showPlaceholder()}showStoppingPlaceholder(){if(!this.placeholderElement||!this.placeholderElement.__placeholderStopping){this.placeholderElement=WI.createMessageTextView(WI.UIString("Stopping the \u201C%s\u201D audit").format(this.representedObject.name)),this.placeholderElement.__placeholderStopping=!0;let e=new WI.IndeterminateProgressSpinner;this.placeholderElement.appendChild(e.element)}this._showPlaceholder()}showNoResultPlaceholder(){if(!this.placeholderElement||!this.placeholderElement.__placeholderNoResult){this.placeholderElement=WI.createMessageTextView(WI.UIString("No Result")),this.placeholderElement.__placeholderNoResult=!0;let e=new WI.ButtonNavigationItem("run-audit",WI.UIString("Start"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2018 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 12 12'%3e %3cpath fill='currentColor' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' stroke-miterlimit='10' d='M 11 6 L 2 1 v 10 z'/%3e %3c/svg%3e",15,15);e.buttonStyle=WI.ButtonNavigationItem.Style.ImageAndText,e.addEventListener(WI.ButtonNavigationItem.Event.Clicked,()=>{WI.auditManager.start([this.representedObject])});let t=WI.createNavigationItemHelp(WI.UIString("Press %s to start running the audit"),e);this.placeholderElement.appendChild(t)}this._showPlaceholder()}showNoResultDataPlaceholder(){if(!this.placeholderElement||!this.placeholderElement.__placeholderNoResultData){let e=this.representedObject.result;if(!e){this.showNoResultPlaceholder();return}let t=null;if(e.didError)t=WI.UIString("The \u201C%s\u201D audit threw an error");else if(e.didFail)t=WI.UIString("The \u201C%s\u201D audit failed");else if(e.didWarn)t=WI.UIString("The \u201C%s\u201D audit resulted in a warning");else if(e.didPass)t=WI.UIString("The \u201C%s\u201D audit passed");else if(e.unsupported)t=WI.UIString("The \u201C%s\u201D audit is unsupported");else{console.error("Unknown result",e);return}this.placeholderElement=WI.createMessageTextView(t.format(this.representedObject.name),e.didError),this.placeholderElement.__placeholderNoResultData=!0}this._showPlaceholder()}showFilteredPlaceholder(){if(!this.placeholderElement||!this.placeholderElement.__placeholderFiltered){this.placeholderElement=WI.createMessageTextView(WI.UIString("No Filter Results")),this.placeholderElement.__placeholderFiltered=!0;let e=this.placeholderElement.appendChild(document.createElement("button"));e.textContent=WI.UIString("Clear Filters"),e.addEventListener("click",()=>{this.resetFilter(),this.needsLayout()})}this._showPlaceholder()}hidePlaceholder(){this.element.classList.remove("showing-placeholder"),this.placeholderElement&&this.placeholderElement.remove()}applyFilter(e){let t=!1;for(let n of this.contentView.subviews){let s=n.applyFilter(e);n.element.classList.toggle("filtered",!s),s&&(t=!0)}if(this.element.classList.toggle("no-matches",!t),!Array.isArray(e))return!0;let i=this.representedObject.result;return i?!!(e.includes(WI.AuditTestCaseResult.Level.Error)&&i.didError||e.includes(WI.AuditTestCaseResult.Level.Fail)&&i.didFail||e.includes(WI.AuditTestCaseResult.Level.Warn)&&i.didWarn||e.includes(WI.AuditTestCaseResult.Level.Pass)&&i.didPass||e.includes(WI.AuditTestCaseResult.Level.Unsupported)&&i.unsupported):!1}resetFilter(){for(let e of this.contentView.subviews)e.element.classList.remove("filtered");this.element.classList.remove("no-matches")}_exportResult(){WI.auditManager.export(this.representedObject.result)}_updateExportButtonNavigationItemState(){this._exportButtonNavigationItem.enabled=!!this.representedObject.result}_showPlaceholder(){this.element.classList.add("showing-placeholder"),this.contentView.element.appendChild(this.placeholderElement)}_handleExportButtonNavigationItemClicked(e){this._exportResult()}_handleTestChanged(e){this.needsLayout()}};WI.CollectionContentView=class extends WI.ContentView{constructor(e,t,i){console.assert(e instanceof WI.Collection),super(e),this.element.classList.add("collection"),this._contentPlaceholder=i||e.displayName,this._contentPlaceholderElement=null,this._contentViewConstructor=t,this._contentViewMap=new Map,this._handleClickMap=new WeakMap,this._selectedItem=null,this._selectionEnabled=!1}get supplementalRepresentedObjects(){return this._selectedItem?[this._selectedItem]:[]}shown(){super.shown();for(let e of this._contentViewMap.values())e.shown()}hidden(){for(let e of this._contentViewMap.values())e.hidden();super.hidden()}get selectionEnabled(){return this._selectionEnabled}set selectionEnabled(e){this._selectionEnabled!==e&&(this._selectionEnabled=e,this._selectionEnabled||this._selectItem(null))}setSelectedItem(e){if(console.assert(this._selectionEnabled,"Attempted to set selected item when selection is disabled."),!this._selectionEnabled)return;let t=this._contentViewMap.get(e);console.assert(t,"Missing contet view for item.",e),t&&(this._selectItem(e),t.element.scrollIntoViewIfNeeded())}addContentViewForItem(e){if(!this._contentViewConstructor)return;if(this._contentViewMap.has(e)){console.assert(!1,"Already added ContentView for item.",e);return}this.hideContentPlaceholder();let t=new this._contentViewConstructor(e);console.assert(t instanceof WI.ContentView);let i=n=>{n.button!==0||n.ctrlKey||(this._selectionEnabled?this._selectItem(e):WI.showRepresentedObject(e))};this._contentViewMap.set(e,t),this._handleClickMap.set(e,i),t.element.addEventListener("click",i),this.addSubview(t),this.contentViewAdded(t),this.visible&&(t.visible=!0,t.shown())}removeContentViewForItem(e){if(!this._contentViewConstructor)return;let t=this._contentViewMap.get(e);if(console.assert(t),!t)return;this._selectedItem===e&&this._selectItem(null),this.removeSubview(t),this._contentViewMap.delete(e),this.contentViewRemoved(t),this.visible&&(t.visible=!1,t.hidden()),t.removeEventListener(null,null,this);let i=this._handleClickMap.get(e);console.assert(i),i&&(t.element.removeEventListener("click",i),this._handleClickMap.delete(e)),this.subviews.length||this.showContentPlaceholder()}contentViewAdded(e){}contentViewRemoved(e){}showContentPlaceholder(){this._contentPlaceholderElement||(typeof this._contentPlaceholder=="string"?this._contentPlaceholderElement=WI.createMessageTextView(this._contentPlaceholder):this._contentPlaceholder instanceof HTMLElement&&(this._contentPlaceholderElement=this._contentPlaceholder)),this._contentPlaceholderElement.parentNode||this.element.appendChild(this._contentPlaceholderElement)}hideContentPlaceholder(){this._contentPlaceholderElement&&this._contentPlaceholderElement.remove()}initialLayout(){if(!this.representedObject.size||!this._contentViewConstructor){this.showContentPlaceholder();return}}attached(){super.attached(),this.representedObject.addEventListener(WI.Collection.Event.ItemAdded,this._handleItemAdded,this),this.representedObject.addEventListener(WI.Collection.Event.ItemRemoved,this._handleItemRemoved,this);for(let e of this._contentViewMap.keys())this.representedObject.has(e)||(this.removeContentViewForItem(e),this._selectedItem===e&&this._selectItem(null));for(let e of this.representedObject)this._contentViewMap.has(e)||this.addContentViewForItem(e)}detached(){this.representedObject.removeEventListener(null,null,this),super.detached()}_handleItemAdded(e){let t=e.data.item;!t||this.addContentViewForItem(t)}_handleItemRemoved(e){let t=e.data.item;!t||this.removeContentViewForItem(t)}_handleContentError(e){e&&e.target&&this._removeContentViewForItem(e.target.representedObject)}_selectItem(e){if(this._selectedItem!==e){if(this._selectedItem){let t=this._contentViewMap.get(this._selectedItem);console.assert(t,"Missing ContentView for deselected item.",this._selectedItem),t.element.classList.remove("selected")}if(this._selectedItem=e,this._selectedItem){let t=this._contentViewMap.get(this._selectedItem);console.assert(t,"Missing ContentView for selected item.",this._selectedItem),t.element.classList.add("selected")}this.dispatchEventToListeners(WI.ContentView.Event.SupplementalRepresentedObjectsDidChange)}}};WI.ActivateButtonNavigationItem=class extends WI.ButtonNavigationItem{constructor(e,t,i,n,s,a,d){super(e,t,n,s,a,d),this._defaultToolTip=t,this._activatedToolTip=i||t,this._role=d}get defaultToolTip(){return this._defaultToolTip}get activatedToolTip(){return this._activatedToolTip}get activated(){return this.element.classList.contains(WI.ActivateButtonNavigationItem.ActivatedStyleClassName)}set activated(e){this.element.classList.toggle(WI.ActivateButtonNavigationItem.ActivatedStyleClassName,e),e?(this.tooltip=this._activatedToolTip,this._role==="tab"&&this.element.setAttribute("aria-selected","true")):(this.tooltip=this._defaultToolTip,this._role==="tab"&&this.element.removeAttribute("aria-selected"))}get additionalClassNames(){return["activate","button"]}};WI.ActivateButtonNavigationItem.ActivatedStyleClassName="activated";WI.ActivateButtonToolbarItem=class extends WI.ActivateButtonNavigationItem{constructor(e,t,i,n,s){super(e,t,i,n,16,16,s)}};WI.ApplicationCacheDetailsSidebarPanel=class extends WI.DetailsSidebarPanel{constructor(){super("application-cache-details",WI.UIString("Storage")),this.element.classList.add("application-cache"),this._applicationCacheFrame=null}inspect(e){e instanceof Array||(e=[e]);for(var t=null,i=0;i<e.length;++i)if(e[i]instanceof WI.ApplicationCacheFrame){t=e[i];break}return this.applicationCacheFrame=t,!!this.applicationCacheFrame}get applicationCacheFrame(){return this._applicationCacheFrame}set applicationCacheFrame(e){this._applicationCacheFrame!==e&&(this._applicationCacheFrame=e,this.needsLayout())}closed(){WI.applicationCacheManager.removeEventListener(null,null,this),super.closed()}initialLayout(){super.initialLayout(),this._locationManifestURLRow=new WI.DetailsSectionSimpleRow(WI.UIString("Manifest URL")),this._locationFrameURLRow=new WI.DetailsSectionSimpleRow(WI.UIString("Frame URL"));let e=new WI.DetailsSectionGroup([this._locationManifestURLRow,this._locationFrameURLRow]),t=new WI.DetailsSection("application-cache-location",WI.UIString("Location"),[e]);this._onlineRow=new WI.DetailsSectionSimpleRow(WI.UIString("Online")),this._statusRow=new WI.DetailsSectionSimpleRow(WI.UIString("Status"));let i=new WI.DetailsSectionGroup([this._onlineRow,this._statusRow]),n=new WI.DetailsSection("application-cache-status",WI.UIString("Status"),[i]);this.contentView.element.appendChild(t.element),this.contentView.element.appendChild(n.element),WI.applicationCacheManager.addEventListener(WI.ApplicationCacheManager.Event.NetworkStateUpdated,this._networkStateUpdated,this),WI.applicationCacheManager.addEventListener(WI.ApplicationCacheManager.Event.FrameManifestStatusChanged,this._frameManifestStatusChanged,this)}layout(){super.layout(),this.applicationCacheFrame&&(this._locationFrameURLRow.value=this.applicationCacheFrame.frame.url,this._locationManifestURLRow.value=this.applicationCacheFrame.manifest.manifestURL,this._refreshOnlineRow(),this._refreshStatusRow())}_networkStateUpdated(e){!this.applicationCacheFrame||this._refreshOnlineRow()}_frameManifestStatusChanged(e){!this.applicationCacheFrame||(console.assert(e.data.frameManifest instanceof WI.ApplicationCacheFrame),e.data.frameManifest===this.applicationCacheFrame&&this._refreshStatusRow())}_refreshOnlineRow(){this._onlineRow.value=WI.applicationCacheManager.online?WI.UIString("Yes"):WI.UIString("No")}_refreshStatusRow(){this._statusRow.value=WI.ApplicationCacheDetailsSidebarPanel.Status[this.applicationCacheFrame.status]}};WI.ApplicationCacheDetailsSidebarPanel.Status={0:"Uncached",1:"Idle",2:"Checking",3:"Downloading",4:"UpdateReady",5:"Obsolete"};WI.ApplicationCacheFrameContentView=class extends WI.ContentView{constructor(e){console.assert(e instanceof WI.ApplicationCacheFrame),super(e),this.element.classList.add("application-cache-frame"),this._frame=e.frame,this._emptyView=WI.createMessageTextView(WI.UIString("No Application Cache information available"),!1),this._emptyView.classList.add("hidden"),this.element.appendChild(this._emptyView),this._markDirty();var t=e.status;this.updateStatus(t),WI.applicationCacheManager.addEventListener(WI.ApplicationCacheManager.Event.FrameManifestStatusChanged,this._updateStatus,this)}shown(){super.shown(),this._maybeUpdate()}closed(){WI.applicationCacheManager.removeEventListener(null,null,this),super.closed()}saveToCookie(e){e.type=WI.ContentViewCookieType.ApplicationCache,e.frame=this.representedObject.frame.url,e.manifest=this.representedObject.manifest.manifestURL}get scrollableElements(){return this._dataGrid?[this._dataGrid.scrollContainer]:[]}_maybeUpdate(){!this.visible||!this._viewDirty||(this._update(),this._viewDirty=!1)}_markDirty(){this._viewDirty=!0}_updateStatus(e){var t=e.data.frameManifest;t===this.representedObject&&(console.assert(t instanceof WI.ApplicationCacheFrame),this.updateStatus(t.status))}updateStatus(e){var t=this._status;this._status=e,this.visible&&this._status===WI.ApplicationCacheManager.Status.Idle&&(t===WI.ApplicationCacheManager.Status.UpdateReady||!this._resources)&&this._markDirty(),this._maybeUpdate()}_update(){WI.applicationCacheManager.requestApplicationCache(this._frame,this._updateCallback.bind(this))}_updateCallback(e){if(!e||!e.manifestURL){delete this._manifest,delete this._creationTime,delete this._updateTime,delete this._size,delete this._resources,this._emptyView.classList.remove("hidden"),this._dataGrid&&this._dataGrid.element.classList.add("hidden");return}this._manifest=e.manifestURL,this._creationTime=e.creationTime,this._updateTime=e.updateTime,this._size=e.size,this._resources=e.resources,this._dataGrid||this._createDataGrid(),this._populateDataGrid(),this._dataGrid.autoSizeColumns(20,80),this._dataGrid.element.classList.remove("hidden"),this._emptyView.classList.add("hidden")}_createDataGrid(){var e={url:{},type:{},size:{}};e.url.title=WI.UIString("Resource"),e.url.sortable=!0,e.type.title=WI.UIString("Type"),e.type.sortable=!0,e.size.title=WI.UIString("Size"),e.size.aligned="right",e.size.sortable=!0,this._dataGrid=new WI.DataGrid(e),this._dataGrid.addEventListener(WI.DataGrid.Event.SortChanged,this._sortDataGrid,this),this._dataGrid.sortColumnIdentifier="url",this._dataGrid.sortOrder=WI.DataGrid.SortOrder.Ascending,this._dataGrid.createSettings("application-cache-frame-content-view"),this.addSubview(this._dataGrid),this._dataGrid.updateLayout()}_sortDataGrid(){function e(n,s,a){return s.data[n]-a.data[n]}function t(n,s,a){return(s.data[n]+"").extendedLocaleCompare(a.data[n]+"")}var i;switch(this._dataGrid.sortColumnIdentifier){case"type":i=t.bind(this,"type");break;case"size":i=e.bind(this,"sizeNumber");break;case"url":default:i=t.bind(this,"url");break}this._dataGrid.sortNodes(i)}_populateDataGrid(){this._dataGrid.removeChildren();for(var e of this._resources){var t={url:e.url,type:e.type,size:Number.bytesToString(e.size),sizeNumber:e.size},i=new WI.DataGridNode(t);this._dataGrid.appendChild(i)}}_deleteButtonClicked(e){!this._dataGrid||!this._dataGrid.selectedNode||this._deleteCallback(this._dataGrid.selectedNode)}_deleteCallback(e){}};WI.ApplicationCacheFrameTreeElement=class extends WI.GeneralTreeElement{constructor(e){console.assert(e instanceof WI.ApplicationCacheFrame);const t=null,i=null;super("application-cache-frame",t,i,e),this.updateTitles()}updateTitles(){var e=this.representedObject.frame.url,t=parseURL(e);this.mainTitle=WI.displayNameForURL(e,t);for(var i=WI.displayNameForHost(t.host),n=null,s=this.parent;s&&!s.root;){if(s instanceof WI.ApplicationCacheManifestTreeElement){n=s;break}s=s.parent}var a=i===this._mainTitle||n&&n.subtitle===i;this.subtitle=a?null:i}};WI.ApplicationCacheManifestTreeElement=class extends WI.StorageTreeElement{constructor(e){console.assert(e instanceof WI.ApplicationCacheManifest),super("application-cache-manifest","",e),this.hasChildren=!0,this.expanded=!0}get name(){return this._name||this._generateTitles(),this._name}get secondaryName(){return this._secondaryName||this._generateTitles(),this._secondaryName}get categoryName(){return WI.UIString("Application Cache")}_generateTitles(){var e=parseURL(this.representedObject.manifestURL);this._name=WI.displayNameForURL(this.representedObject.manifestURL,e);var t=WI.displayNameForHost(e.host);this._secondaryName=this._name!==t?t:null}};WI.AreaChart=class extends WI.View{constructor(){super(),this.element.classList.add("area-chart"),this._chartElement=this.element.appendChild(createSVGElement("svg")),this._chartElement.setAttribute("preserveAspectRatio","none"),this._pathElement=this._chartElement.appendChild(createSVGElement("path")),this._circleElements=[],this._points=[],this._markers=[],this._size=null}get size(){return this._size}set size(e){this._size&&this._size.equals(e)||(this._size=e,this._chartElement.setAttribute("viewBox",`0 0 ${e.width} ${e.height}`),this.needsLayout())}addPoint(e,t){this._points.push({x:e,y:t})}clearPoints(){this._points=[]}addPointMarker(e,t){this._markers.push({x:e,y:t})}clearPointMarkers(){this._markers=[]}clear(){this.clearPoints(),this.clearPointMarkers()}layout(){if(super.layout(),this.layoutReason===WI.View.LayoutReason.Resize||!this._size)return;let e=[];e.push(`M 0 ${this._size.height}`);for(let n of this._points)e.push(`L ${n.x} ${n.y}`);let t=this._points.length?this._points.lastValue.x:0;e.push(`L ${t} ${this._size.height}`),e.push("Z");let i=e.join(" ");if(this._pathElement.setAttribute("d",i),this._circleElements.length){for(let n of this._circleElements)n.remove();this._circleElements=[]}if(this._markers.length)for(let{x:n,y:s}of this._markers){let a=this._chartElement.appendChild(createSVGElement("circle"));this._circleElements.push(a),a.setAttribute("cx",n),a.setAttribute("cy",s)}}};WI.AuditNavigationSidebarPanel=class extends WI.NavigationSidebarPanel{constructor(){super("audit",WI.UIString("Audits"))}showDefaultContentView(){let e=new WI.ContentView;if(WI.auditManager.editing){let n=WI.createMessageTextView(WI.UIString("Editing audits"));n.classList.add("finish-editing-audits-placeholder"),e.element.appendChild(n);let s=new WI.ButtonNavigationItem("finish-editing-audits",WI.UIString("Done"));s.addEventListener(WI.ButtonNavigationItem.Event.Clicked,d=>{WI.auditManager.editing=!1});let a=WI.createNavigationItemHelp(WI.UIString("Press %s to stop editing"),s);n.appendChild(a)}else{let n=WI.createMessageTextView(WI.UIString("No audit selected"));e.element.appendChild(n);let s=new WI.ButtonNavigationItem("import-audit",WI.UIString("Import"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' d='M 7.5 8.5 V 1'/%3e %3cpath fill='none' stroke='currentColor' d='M 10.5 5.5 l -3%2c 3 l -3 -3'/%3e %3cpolyline fill='none' stroke='currentColor' points='12.5 9 12.5 12.5 2.5 12.5 2.5 9'/%3e %3c/svg%3e",15,15);s.buttonStyle=WI.ButtonNavigationItem.Style.ImageAndText,s.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._handleImportButtonNavigationItemClicked,this);let a=WI.createNavigationItemHelp(WI.UIString("Press %s to import a test or result file"),s);n.appendChild(a)}let t=e.element.appendChild(document.createElement("div"));t.classList.add("audit-version");let i=WI.AuditTestBase.Version;InspectorBackend.domains.Audit&&(i=Math.min(i,InspectorBackend.domains.Audit.VERSION)),t.textContent=WI.UIString("Audit version: %s").format(i),this.contentBrowser.showContentView(e)}initialLayout(){super.initialLayout(),this.contentTreeOutline.allowsRepeatSelection=!1;let e=new WI.NavigationBar;this._startStopButtonNavigationItem=new WI.ToggleButtonNavigationItem("audit-start-stop",WI.UIString("Start"),WI.UIString("Stop"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2018 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 12 12'%3e %3cpath fill='currentColor' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' stroke-miterlimit='10' d='M 11 6 L 2 1 v 10 z'/%3e %3c/svg%3e","data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2018 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 12 12'%3e %3cpath fill='currentColor' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' stroke-miterlimit='10' d='M 2 2 h 8 v 8 H 2 z'/%3e %3c/svg%3e",13,13),this._startStopButtonNavigationItem.buttonStyle=WI.ButtonNavigationItem.Style.ImageAndText,this._updateStartStopButtonNavigationItemState(),this._startStopButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._handleStartStopButtonNavigationItemClicked,this),e.addNavigationItem(this._startStopButtonNavigationItem),e.addNavigationItem(new WI.DividerNavigationItem);let t=new WI.ButtonNavigationItem("audit-import",WI.UIString("Import"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' d='M 7.5 8.5 V 1'/%3e %3cpath fill='none' stroke='currentColor' d='M 10.5 5.5 l -3%2c 3 l -3 -3'/%3e %3cpolyline fill='none' stroke='currentColor' points='12.5 9 12.5 12.5 2.5 12.5 2.5 9'/%3e %3c/svg%3e",15,15);t.buttonStyle=WI.ButtonNavigationItem.Style.ImageAndText,t.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,t.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._handleImportButtonNavigationItemClicked,this),e.addNavigationItem(t),this.addSubview(e);let i=new WI.NavigationBar;this._editButtonNavigationItem=new WI.ActivateButtonNavigationItem("edit-audits",WI.UIString("Edit"),WI.UIString("Done")),this._editButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._handleEditButtonNavigationItemClicked,this),i.addNavigationItem(this._editButtonNavigationItem),this.contentView.addSubview(i);for(let n of WI.auditManager.tests)this._addTest(n);WI.auditManager.results.forEach((n,s)=>{this._addResult(n,s)}),WI.auditManager.addEventListener(WI.AuditManager.Event.EditingChanged,this._handleAuditManagerEditingChanged,this),WI.auditManager.addEventListener(WI.AuditManager.Event.TestAdded,this._handleAuditTestAdded,this),WI.auditManager.addEventListener(WI.AuditManager.Event.TestCompleted,this._handleAuditTestCompleted,this),WI.auditManager.addEventListener(WI.AuditManager.Event.TestRemoved,this._handleAuditTestRemoved,this),WI.auditManager.addEventListener(WI.AuditManager.Event.TestScheduled,this._handleAuditTestScheduled,this),this.contentTreeOutline.addEventListener(WI.TreeOutline.Event.SelectionDidChange,this._treeSelectionDidChange,this)}closed(){super.closed(),WI.auditManager.removeEventListener(null,null,this)}updateFilter(){super.updateFilter(),this.hasActiveFilters||this._updateNoAuditsPlaceholder()}hasCustomFilters(){return!0}matchTreeElementAgainstCustomFilters(e,t){if(WI.auditManager.editing){if(e.representedObject instanceof WI.AuditTestResultBase||e.hasAncestor(this._resultsFolderTreeElement)||e===this._resultsFolderTreeElement)return!1}else if(e.representedObject instanceof WI.AuditTestBase&&e.representedObject.disabled)return!1;return super.matchTreeElementAgainstCustomFilters(e,t)}_addTest(e){let t=new WI.AuditTreeElement(e);this._resultsFolderTreeElement?(this.contentTreeOutline.insertChild(t,this.contentTreeOutline.children.indexOf(this._resultsFolderTreeElement)),this._resultsFolderTreeElement.hidden=!this._resultsFolderTreeElement.children.length):this.contentTreeOutline.appendChild(t),this._updateStartStopButtonNavigationItemState(),this._updateEditButtonNavigationItemState(),this._updateNoAuditsPlaceholder()}_addResult(e,t){this.element.classList.add("has-results"),this._resultsFolderTreeElement||(this._resultsFolderTreeElement=new WI.FolderTreeElement(WI.UIString("Results")),this.contentTreeOutline.appendChild(this._resultsFolderTreeElement)),this._resultsFolderTreeElement.expand();let i=new WI.FolderTreeElement(WI.UIString("Run %d").format(t+1));e instanceof WI.AuditTestResultBase&&(i.subtitle=WI.UIString("Imported"),e=[e]),this._resultsFolderTreeElement.appendChild(i),console.assert(this._resultsFolderTreeElement.children.length===WI.auditManager.results.length);for(let n of e)i.appendChild(new WI.AuditTreeElement(n));this._updateStartStopButtonNavigationItemState(),this._updateEditButtonNavigationItemState()}_updateStartStopButtonNavigationItemState(){this._startStopButtonNavigationItem.toggled=WI.auditManager.runningState===WI.AuditManager.RunningState.Active||WI.auditManager.runningState===WI.AuditManager.RunningState.Stopping,this._startStopButtonNavigationItem.enabled=WI.auditManager.tests.some(e=>!e.disabled)&&(WI.auditManager.runningState===WI.AuditManager.RunningState.Inactive||WI.auditManager.runningState===WI.AuditManager.RunningState.Active)}_updateEditButtonNavigationItemState(){this._editButtonNavigationItem.label=WI.auditManager.editing?this._editButtonNavigationItem.activatedToolTip:this._editButtonNavigationItem.defaultToolTip,this._editButtonNavigationItem.activated=WI.auditManager.editing,this._editButtonNavigationItem.enabled=WI.auditManager.tests.length&&(WI.auditManager.editing||WI.auditManager.runningState===WI.AuditManager.RunningState.Inactive)}_updateNoAuditsPlaceholder(){if(WI.auditManager.editing||WI.auditManager.tests.some(t=>!t.disabled)){this.hasActiveFilters||this.hideEmptyContentPlaceholder();return}let e=this.showEmptyContentPlaceholder(WI.UIString("No Enabled Audits"));e.classList.add("no-enabled-audits"),WI.auditManager.results.length&&this.contentView.element.insertBefore(e,this.contentView.element.firstChild)}_handleAuditManagerEditingChanged(e){WI.auditManager.editing?(console.assert(!this._selectedTreeElementBeforeEditing),this._selectedTreeElementBeforeEditing=this.contentTreeOutline.selectedTreeElement,this._selectedTreeElementBeforeEditing&&this._selectedTreeElementBeforeEditing.deselect()):this._selectedTreeElementBeforeEditing&&((!(this._selectedTreeElementBeforeEditing.representedObject instanceof WI.AuditTestBase)||!this._selectedTreeElementBeforeEditing.representedObject.disabled)&&this._selectedTreeElementBeforeEditing.select(),this._selectedTreeElementBeforeEditing=null),this.contentTreeOutline.selectedTreeElement||this.showDefaultContentView(),this._updateStartStopButtonNavigationItemState(),this._updateEditButtonNavigationItemState(),this.updateFilter()}_handleAuditTestAdded(e){this._addTest(e.data.test)}_handleAuditTestCompleted(e){let{result:t,index:i}=e.data;this._addResult(t,i)}_handleAuditTestRemoved(e){let{test:t}=e.data,i=this.treeElementForRepresentedObject(t);this.contentTreeOutline.removeChild(i),this._updateStartStopButtonNavigationItemState(),this._updateEditButtonNavigationItemState(),this._updateNoAuditsPlaceholder()}_handleAuditTestScheduled(e){this._updateStartStopButtonNavigationItemState(),this._updateEditButtonNavigationItemState()}_treeSelectionDidChange(e){if(!this.selected)return;let t=this.contentTreeOutline.selectedTreeElement;if(!t||t instanceof WI.FolderTreeElement){this.showDefaultContentView();return}if(WI.auditManager.editing)return;let i=t.representedObject;if(i instanceof WI.AuditTestCase||i instanceof WI.AuditTestGroup||i instanceof WI.AuditTestCaseResult||i instanceof WI.AuditTestGroupResult){WI.showRepresentedObject(i);return}console.error("Unknown tree element",t)}_handleStartStopButtonNavigationItemClicked(e){WI.auditManager.runningState===WI.AuditManager.RunningState.Inactive?WI.auditManager.start():WI.auditManager.runningState===WI.AuditManager.RunningState.Active&&WI.auditManager.stop(),this._updateStartStopButtonNavigationItemState()}_handleImportButtonNavigationItemClicked(e){WI.FileUtilities.importJSON(t=>WI.auditManager.processJSON(t))}_handleEditButtonNavigationItemClicked(e){WI.auditManager.editing=!WI.auditManager.editing}};WI.AuditTestCaseContentView=class extends WI.AuditTestContentView{constructor(e){console.assert(e instanceof WI.AuditTestCase||e instanceof WI.AuditTestCaseResult),super(e),this.element.classList.add("audit-test-case"),this._resultDataGeneralContainer=null,this._resultDataDOMNodesContainer=null,this._resultDataErrorsContainer=null}initialLayout(){super.initialLayout();let e=this.headerView.element.appendChild(document.createElement("div"));e.classList.add("information");let t=e.appendChild(document.createElement("h1"));if(this._resultImageElement=t.appendChild(document.createElement("img")),t.appendChild(document.createTextNode(this.representedObject.name)),this.representedObject.description){let i=e.appendChild(document.createElement("p"));i.textContent=this.representedObject.description}this._metadataElement=this.headerView.element.appendChild(document.createElement("div")),this._metadataElement.classList.add("metadata")}layout(){if(this.layoutReason!==WI.View.LayoutReason.Dirty)return;super.layout(),this._resultImageElement.src="data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2018 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3ccircle fill='rgb(202%2c 202%2c 202)' stroke='rgb(153%2c 153%2c 153)' stroke-width='0.5' stroke-miterlimit='10' cx='8' cy='8' r='6.5'/%3e %3cpath fill='white' stroke='rgb(153%2c 153%2c 153)' stroke-width='0.33' stroke-linecap='round' stroke-linejoin='round' stroke-miterlimit='10' d='M 9.25 11.563 a 1.25 1.25 0 1 1 -2.5 0 1.25 1.25 0 0 1 2.5 0 z m -0.973 -8.25 c 1.653 0 2.973 0.832 2.973 2.486 0 1.159 -0.642 1.622 -1.23 1.992 -0.708 0.444 -1 0.632 -1 1.271 v 0.25 H 6.951 l -0.018 -0.131 c -0.136 -1.015 0.137 -1.722 0.946 -2.205 0.559 -0.332 0.933 -0.563 0.933 -1.052 0 -0.47 -0.339 -0.695 -0.69 -0.695 -0.422 0 -0.683 0.338 -0.695 0.783 h -2.17 c -0.12 -1.854 1.35 -2.7 3.02 -2.7 z'/%3e %3c/svg%3e",this._metadataElement.removeChildren(),this.contentView.element.removeChildren();let e=this.representedObject.result;if(!e){this.representedObject.runningState===WI.AuditManager.RunningState.Inactive?this.showNoResultPlaceholder():this.representedObject.runningState===WI.AuditManager.RunningState.Active?this.showRunningPlaceholder():this.representedObject.runningState===WI.AuditManager.RunningState.Stopping&&this.showStoppingPlaceholder();return}e.didError?this._resultImageElement.src="data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2018 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='rgb(216%2c 82%2c 92)' stroke='rgb(219%2c 25%2c 34)' stroke-width='0.5' stroke-miterlimit='10' d='M 10.7 1.5 H 5.3 L 1.5 5.3 v 5.4 l 3.8 3.8 h 5.4 l 3.8 -3.8 V 5.3 z'/%3e %3cpath fill='white' d='M 8 9.165 c -0.588 0 -1.165 -0.665 -1.165 -1.341 V 4.176 c 0 -0.802 0.468 -1.341 1.165 -1.341 s 1.165 0.539 1.165 1.341 v 3.648 c 0 0.677 -0.577 1.341 -1.165 1.341 z'/%3e %3cpath fill='rgb(219%2c 25%2c 34)' d='M 8 3 c 0.6 0 1 0.47 1 1.177 v 3.647 C 9 8.412 8.5 9 8 9 s -1 -0.588 -1 -1.176 V 4.177 C 7 3.47 7.4 3 8 3 m 0 -0.33 c -0.783 0 -1.33.62 -1.33 1.506 v 3.648 c 0 0.774 0.646 1.506 1.33 1.506 s 1.33 -0.732 1.33 -1.506 V 4.177 C 9.33 3.29 8.783 2.67 8 2.67 z'/%3e %3ccircle fill='white' cx='8' cy='11.5' r='1.415'/%3e %3cpath fill='rgb(219%2c 25%2c 34)' d='M 8 10.25 a 1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0 -2.5 m 0 -0.33 c -0.871 0 -1.58 0.709 -1.58 1.58 s 0.709 1.58 1.58 1.58 1.58 -0.709 1.58 -1.58 S 8.871 9.92 8 9.92 z'/%3e %3c/svg%3e":e.didFail?this._resultImageElement.src="data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2018 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='rgb(216%2c 82%2c 92)' stroke='rgb(219%2c 25%2c 34)' stroke-width='0.5' stroke-miterlimit='10' d='M 7.3 14.7 l -6 -6 c -0.4 -0.4 -0.4 -1.1 0 -1.5 l 6 -6 c 0.4 -0.4 1.1 -0.4 1.5 0 l 6 6 c 0.4 0.4 0.4 1.1 0 1.5 l -6 6 c -0.5 0.4 -1.1 0.4 -1.5 0 z'/%3e %3cpath fill='white' d='M 10.191 11.206 a 0.162 0.162 0 0 1 -0.116 -0.049 L 8 9.082 l -2.075 2.075 a 0.164 0.164 0 0 1 -0.234 0 l -0.848 -0.848 a 0.164 0.164 0 0 1 0 -0.233 L 6.918 8 4.843 5.925 a 0.165 0.165 0 0 1 0 -0.234 l 0.848 -0.848 a 0.165 0.165 0 0 1 0.234 0 L 8 6.918 l 2.075 -2.075 a 0.163 0.163 0 0 1 0.233 0 l 0.848 0.848 a 0.165 0.165 0 0 1 0 0.234 L 9.082 8 l 2.075 2.076 a 0.165 0.165 0 0 1 0 0.233l -0.85 0.848 a 0.161 0.161 0 0 1 -0.116 0.05 z'/%3e %3cpath fill='rgb(219%2c 25%2c 34)' d='M 10.192 4.96 l 0.848 0.848 L 8.848 8 l 2.192 2.192 -0.848 0.849 L 8 8.848 5.808 11.04 l -0.849 -0.848 L 7.151 8 4.96 5.808 l 0.849 -0.849 L 8 7.152 l 2.192 -2.192 m 0 -0.33 a 0.329 0.329 0 0 0 -0.233 0.096 l -1.96 1.959 -1.958 -1.959 a 0.329 0.329 0 0 0 -0.467 0 l -0.848 0.849 a 0.33 0.33 0 0 0 0 0.466 L 6.685 8 4.726 9.959 a 0.33 0.33 0 0 0 0 0.466 l 0.849 0.849 a 0.33 0.33 0 0 0 0.466 0 L 8 9.315 l 1.959 1.959 a 0.33 0.33 0 0 0 0.466 0 l 0.849 -0.849 a 0.33 0.33 0 0 0 0 -0.466 L 9.315 8 l 1.959 -1.959 a 0.33 0.33 0 0 0 0 -0.466 l -0.849 -0.849 a 0.33 0.33 0 0 0 -0.233 -0.096 z'/%3e %3c/svg%3e":e.didWarn?this._resultImageElement.src="data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2018 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='rgb(243%2c 222%2c 156)' stroke='rgb(201%2c 181%2c 118)' stroke-width='0.5' stroke-miterlimit='10' d='M 7.3 14.7 l -6 -6 c -0.4 -0.4 -0.4 -1.1 0 -1.5 l 6 -6 c 0.4 -0.4 1.1 -0.4 1.5 0 l 6 6 c 0.4 0.4 0.4 1.1 0 1.5 l -6 6 c -0.5 0.4 -1.1 0.4 -1.5 0 z'/%3e %3ccircle fill='white' cx='8' cy='11.5' r='1.415'/%3e %3cpath fill='rgb(201%2c 181%2c 118)' d='M 8 10.25 a 1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0 -2.5 m 0 -0.33 c -0.871 0 -1.58 0.709 -1.58 1.58 s 0.709 1.58 1.58 1.58 1.58 -0.709 1.58 -1.58 S 8.871 9.92 8 9.92 z'/%3e %3cpath fill='white' d='M 8 9.165 A 1.166 1.166 0 0 1 6.835 8 V 4 a 1.166 1.166 0 0 1 2.33 0 v 4 c 0 0.643 -0.522 1.165 -1.165 1.165 z'/%3e %3cpath fill='rgb(201%2c 181%2c 118)' d='M 8 3 c 0.55 0 1 0.45 1 1 v 4 c 0 0.55 -0.45 1 -1 1 s -1 -0.45 -1 -1 V 4 c 0 -0.55 0.45 -1 1 -1 m 0 -0.33 c -0.733 0 -1.33 0.597 -1.33 1.33 v 4 c 0 0.733 0.597 1.33 1.33 1.33 S 9.33 8.733 9.33 8 V 4 c 0 -0.733 -0.597 -1.33 -1.33 -1.33 z'/%3e %3c/svg%3e":e.didPass?this._resultImageElement.src="data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2018 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='rgb(181%2c 201%2c 116)' stroke='rgb(148%2c 172%2c 85)' stroke-width='0.5' stroke-miterlimit='10' d='M 7.3 14.7 l -6 -6 c -0.4 -0.4 -0.4 -1.1 0 -1.5 l 6 -6 c 0.4 -0.4 1.1 -0.4 1.5 0 l 6 6 c 0.4 0.4 0.4 1.1 0 1.5 l -6 6 c -0.5 0.4 -1.1 0.4 -1.5 0 z'/%3e %3cpath fill='white' d='M 6.9 11.465 a 0.164 0.164 0 0 1 -0.127 -0.06 l -2.4 -2.9 a 0.165 0.165 0 0 1 -0.002 -0.208 l 0.8 -1 a 0.165 0.165 0 0 1 0.127 -0.062 H 5.3 c 0.049 0 0.095 0.021 0.126 0.058 l 1.472 1.749 3.175 -3.847 a 0.165 0.165 0 0 1 0.127 -0.06 h 0.001 c 0.05 0 0.097 0.023 0.128 0.062 l 0.8 1 a 0.165 0.165 0 0 1 -0.001 0.207 l -4.1 5 a 0.164 0.164 0 0 1 -0.128 0.06 z'/%3e %3cpath fill='rgb(148%2c 172%2c 85)' d='M 10.2 5.3 l 0.8 1 -4.1 5 -2.4 -2.9 0.8 -1 1.6 1.9 3.3 -4 m 0 -0.33 a 0.33 0.33 0 0 0 -0.255 0.12 L 6.897 8.785 5.552 7.187 A 0.33 0.33 0 0 0 5.3 7.07 h -0.004 a 0.33 0.33 0 0 0 -0.254 0.124 l -0.8 1 a 0.33 0.33 0 0 0 0.004 0.416 l 2.4 2.9 a 0.33 0.33 0 0 0 0.51 -0.001 l 4.1 -5 a 0.33 0.33 0 0 0 0.002 -0.415 l -0.8 -1 a 0.33 0.33 0 0 0 -0.256 -0.124 H 10.2 z'/%3e %3c/svg%3e":e.unsupported&&(this._resultImageElement.src="data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2018 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='rgb(202%2c 202%2c 202)' stroke='rgb(153%2c 153%2c 153)' stroke-width='0.5' stroke-miterlimit='10' d='M 7.3 14.7 l -6 -6 c -0.4 -0.4 -0.4 -1.1 0 -1.5 l 6 -6 c 0.4 -0.4 1.1 -0.4 1.5 0 l 6 6 c 0.4 0.4 0.4 1.1 0 1.5 l -6 6 c -0.5 0.4 -1.1 0.4 -1.5 0 z'/%3e %3cpath fill='white' d='M 4.5 9.2 c -0.4 0 -0.7 -0.3 -0.7 -0.7 v -1 c 0 -0.4 0.3 -0.7 0.7 -0.7 h 7 c 0.4 0 0.7 0.3 0.7 0.7 v 1 c 0 0.4 -0.3 0.7 -0.7 0.7 h -7 z'/%3e %3cpath fill='rgb(153%2c 153%2c 153)' d='M 11.5 7 c 0.3 0 0.5 0.2 0.5 0.5 v 1 c 0 0.3 -0.2 0.5 -0.5 0.5 h -7 c -0.3 0 -0.5 -0.2 -0.5 -0.5 v -1 c 0 -0.3 0.2 -0.5 0.5 -0.5 h 7 m 0 -0.3 h -7 c -0.5 0 -0.8 0.3 -0.8 0.8 v 1 c 0 0.5 0.3 0.8 0.8 0.8 h 7 c 0.5 0 0.8 -0.4 0.8 -0.8 v -1 c 0 -0.5 -0.3 -0.8 -0.8 -0.8 z'/%3e %3c/svg%3e");let t=e.metadata;if(t){let n=this._metadataElement.appendChild(document.createElement("div"));if(n.classList.add("source"),t.startTimestamp){let s=n.appendChild(document.createElement("time"));if(s.datetime=t.startTimestamp.toISOString(),s.textContent=t.startTimestamp.toLocaleString(),t.endTimestamp){let a=Number.secondsToString((t.endTimestamp-t.startTimestamp)/1e3),d=this._metadataElement.appendChild(document.createElement("span"));if(d.classList.add("duration"),d.textContent=a,t.asyncTimestamp){let p=Number.secondsToString((t.asyncTimestamp-t.startTimestamp)/1e3),f=Number.secondsToString((t.endTimestamp-t.asyncTimestamp)/1e3);d.classList.add("async"),d.title=WI.UIString(`%s eval
%s async`).format(p,f)}}}if(t.url&&(t.url!==WI.networkManager.mainFrame.url||this.representedObject instanceof WI.AuditTestResultBase)){let s=new URL(t.url),a=s.origin;s.pathname.startsWith("/")&&(a+="/");let d=WI.linkifyURLAsNode(s.href,a+s.href.substring(a.length).truncateStart(20));d.title=s.href,n.appendChild(d)}}let i=e.data;if(!this._resultDataGeneralContainer){let n=Object.filter(i,s=>s!=="domNodes"&&s!=="errors");if(!isEmptyObject(n)){this._resultDataGeneralContainer=document.createElement("div");let s="("+JSON.stringify(n)+")";const a={objectGroup:WI.AuditTestBase.ObjectGroup,doNotPauseOnExceptionsAndMuteConsole:!0};WI.runtimeManager.evaluateInInspectedWindow(s,a,(d,p)=>{if(console.assert(!p),!d||!this.representedObject.result||this.representedObject.result.data!==i)return;const f=null,_=!0;let b=WI.FormattedValue.createObjectTreeOrFormattedValueForRemoteObject(d,f,_),w=b.__objectTree;w&&(w.showOnlyJSON(),w.expand()),this._resultDataGeneralContainer.appendChild(b),this.hidePlaceholder()})}}if(this._resultDataGeneralContainer&&this.contentView.element.appendChild(this._resultDataGeneralContainer),!this._resultDataDOMNodesContainer&&i.domNodes&&i.domNodes.length){this._resultDataDOMNodesContainer=document.createElement("div"),this._resultDataDOMNodesContainer.classList.add("dom-nodes");let n=this._resultDataDOMNodesContainer.appendChild(document.createElement("h1"));n.textContent=WI.UIString("DOM Nodes:");let s=this._resultDataDOMNodesContainer.appendChild(document.createElement("table"));i.domNodes.forEach((a,d)=>{a=e.resolvedDOMNodes[d]||a;let p=s.appendChild(document.createElement("tr")),f=p.appendChild(document.createElement("td"));f.textContent=d+1;let _=p.appendChild(document.createElement("td"));if(a instanceof WI.DOMNode){let b=new WI.DOMTreeOutline({selectable:!1});b.setVisible(!0),b.rootDOMNode=a;let w=b.children[0];if(w.showGoToArrow=!0,w.hasChildren||b.element.classList.add("single-node"),i.domAttributes)for(let S of i.domAttributes)w.highlightAttribute(S),w.updateTitle();_.appendChild(b.element)}else if(typeof a=="string"){let b=WI.CodeMirrorEditor.create(_.appendChild(document.createElement("code")),{mode:"css",readOnly:!0,lineWrapping:!0,styleSelectedText:!0});if(b.setValue(a),i.domAttributes)for(let w of i.domAttributes){let S=null;for(w==="id"?S=/(\#[^\#|\.|\[|\s|$]+)/g:w==="class"?S=/(\.[^\#|\.|\[|\s|$]+)/g:S=new RegExp(`\\[\\s*(${w})\\s*=`,"g");;){let E=S.exec(a);if(!E)break;let k=E.index+E[0].indexOf(E[1]);b.markText({line:0,ch:k},{line:0,ch:k+E[1].length},{className:"mark"})}}}})}if(this._resultDataDOMNodesContainer&&this.contentView.element.appendChild(this._resultDataDOMNodesContainer),!this._resultDataErrorsContainer&&i.errors&&i.errors.length){this._resultDataErrorsContainer=document.createElement("div"),this._resultDataErrorsContainer.classList.add("errors");let n=this._resultDataErrorsContainer.appendChild(document.createElement("h1"));n.textContent=WI.UIString("Errors:");let s=this._resultDataErrorsContainer.appendChild(document.createElement("table"));i.errors.forEach((a,d)=>{let p=s.appendChild(document.createElement("tr")),f=p.appendChild(document.createElement("td"));f.textContent=d+1;let b=p.appendChild(document.createElement("td")).appendChild(document.createElement("div"));b.classList.add("error"),b.textContent=a})}this._resultDataErrorsContainer&&this.contentView.element.appendChild(this._resultDataErrorsContainer),this.contentView.element.children.length||this.showNoResultDataPlaceholder()}handleResultChanged(e){super.handleResultChanged(e),this._resultDataGeneralContainer=null,this._resultDataDOMNodesContainer=null,this._resultDataErrorsContainer=null}showRunningPlaceholder(){if(!this.placeholderElement||!this.placeholderElement.__placeholderRunning){this.placeholderElement=WI.createMessageTextView(WI.UIString("Running the \u201C%s\u201D audit").format(this.representedObject.name)),this.placeholderElement.__placeholderRunning=!0;let e=new WI.IndeterminateProgressSpinner;this.placeholderElement.appendChild(e.element)}super.showRunningPlaceholder()}};WI.AuditTestGroupContentView=class extends WI.AuditTestContentView{constructor(e){console.assert(e instanceof WI.AuditTestGroup||e instanceof WI.AuditTestGroupResult),super(e),this.element.classList.add("audit-test-group"),this.element.classList.toggle("contains-test-case",this._subobjects().some(t=>t instanceof WI.AuditTestCase||t instanceof WI.AuditTestCaseResult)),this.element.classList.toggle("contains-test-group",this._subobjects().some(t=>t instanceof WI.AuditTestGroup||t instanceof WI.AuditTestGroupResult)),this._levelScopeBar=null}initialLayout(){super.initialLayout();let e=this.headerView.element.appendChild(document.createElement("div"));e.classList.add("information");let t=e.appendChild(document.createElement("h1"));if(t.textContent=this.representedObject.name,this.representedObject.description){let n=e.appendChild(document.createElement("p"));n.textContent=this.representedObject.description}this._levelNavigationBar=new WI.NavigationBar(document.createElement("nav")),this._levelNavigationBar.element.dataset.prefix=WI.UIString("Showing:"),this.headerView.addSubview(this._levelNavigationBar),this._percentageContainer=this.headerView.element.appendChild(document.createElement("div")),this._percentageContainer.classList.add("percentage-pass"),this._percentageContainer.hidden=!0,this._percentageTextElement=document.createElement("span");const i=WI.UIString("%s%%","Percentage (of audits)","The number of tests that passed expressed as a percentage, followed by a literal %.");String.format(i,[this._percentageTextElement],String.standardFormatters,this._percentageContainer,(n,s)=>(n.append(s),n))}layout(){if(this.layoutReason!==WI.View.LayoutReason.Dirty)return;super.layout();let e=this.representedObject.result;if(!e){this._levelScopeBar&&(this._levelNavigationBar.removeNavigationItem(this._levelScopeBar),this._levelScopeBar=null),this._percentageContainer.hidden=!0,this._percentageTextElement.textContent="",this.representedObject.runningState===WI.AuditManager.RunningState.Inactive?this.showNoResultPlaceholder():this.representedObject.runningState===WI.AuditManager.RunningState.Active?this.showRunningPlaceholder():this.representedObject.runningState===WI.AuditManager.RunningState.Stopping&&this.showStoppingPlaceholder();return}let t=e.levelCounts,i=Object.values(t).reduce((n,s)=>n+s);if(this._percentageTextElement.textContent=Math.floor(100*t[WI.AuditTestCaseResult.Level.Pass]/i),this._percentageContainer.hidden=!1,!this._levelScopeBar){let n=[],s=(a,d,p)=>{let f=t[a];if(isNaN(f)||f<=0)return;let _=p&&f!==1?p:d,b=new WI.ScopeBarItem(a,_.format(f),{className:a,exclusive:!1,independent:!0});b.selected=!0,b.element.insertBefore(document.createElement("img"),b.element.firstChild),n.push(b)};s(WI.AuditTestCaseResult.Level.Pass,WI.UIString("%d Passed","%d Passed (singular)",""),WI.UIString("%d Passed","%d Passed (plural)","")),s(WI.AuditTestCaseResult.Level.Warn,WI.UIString("%d Warning"),WI.UIString("%d Warnings")),s(WI.AuditTestCaseResult.Level.Fail,WI.UIString("%d Failed","%d Failed (singular)",""),WI.UIString("%d Failed","%d Failed (plural)","")),s(WI.AuditTestCaseResult.Level.Error,WI.UIString("%d Error"),WI.UIString("%d Errors")),s(WI.AuditTestCaseResult.Level.Unsupported,WI.UIString("%d Unsupported","%d Unsupported (singular)",""),WI.UIString("%d Unsupported","%d Unsupported (plural)","")),this._levelScopeBar=new WI.ScopeBar(null,n),this._levelScopeBar.addEventListener(WI.ScopeBar.Event.SelectionChanged,this._handleLevelScopeBarSelectionChanged,this),this._levelNavigationBar.addNavigationItem(this._levelScopeBar)}this.applyFilter()?this.hidePlaceholder():this.showFilteredPlaceholder()}shown(){super.shown(),this.representedObject instanceof WI.AuditTestGroup&&(this.representedObject.addEventListener(WI.AuditTestBase.Event.Progress,this._handleTestGroupProgress,this),this.representedObject.addEventListener(WI.AuditTestBase.Event.Scheduled,this._handleTestGroupScheduled,this));for(let e of this._subobjects()){if(e instanceof WI.AuditTestBase&&e.disabled)continue;let t=WI.ContentView.contentViewForRepresentedObject(e);this.contentView.addSubview(t),t.shown()}}hidden(){for(let e of this.contentView.subviews)e.hidden();this.contentView.removeAllSubviews(),super.hidden()}applyFilter(e){return this._levelScopeBar&&!e&&(e=this._levelScopeBar.selectedItems.map(t=>t.id)),this._updateLevelScopeBar(e),super.applyFilter(e)}resetFilter(){this._updateLevelScopeBar(Object.values(WI.AuditTestCaseResult.Level)),super.resetFilter()}showRunningPlaceholder(){(!this.placeholderElement||!this.placeholderElement.__placeholderRunning)&&(this.placeholderElement=WI.createMessageTextView(WI.UIString("Running the \u201C%s\u201D audit").format(this.representedObject.name)),this.placeholderElement.__placeholderRunning=!0,this.placeholderElement.__progress=document.createElement("progress"),this.placeholderElement.__progress.value=0,this.placeholderElement.appendChild(this.placeholderElement.__progress)),super.showRunningPlaceholder()}_subobjects(){return this.representedObject instanceof WI.AuditTestGroup?this.representedObject.tests:this.representedObject instanceof WI.AuditTestGroupResult?this.representedObject.results:(console.error("Unknown representedObject",this.representedObject),[])}_updateLevelScopeBar(e){if(!!this._levelScopeBar){for(let t of this._levelScopeBar.items)t.selected=e.includes(t.id);for(let t of this.contentView.subviews)t instanceof WI.AuditTestGroupContentView&&t._updateLevelScopeBar(e)}}_handleTestGroupProgress(e){let{index:t,count:i}=e.data;this.placeholderElement&&this.placeholderElement.__progress&&(this.placeholderElement.__progress.value=(t+1)/i)}_handleTestGroupScheduled(e){this.placeholderElement&&this.placeholderElement.__progress&&(this.placeholderElement.__progress.value=0)}_handleLevelScopeBarSelectionChanged(e){this.needsLayout()}};WI.AuditTreeElement=class extends WI.GeneralTreeElement{constructor(e){let t=e instanceof WI.AuditTestCase,i=e instanceof WI.AuditTestGroup,n=e instanceof WI.AuditTestCaseResult,s=e instanceof WI.AuditTestGroupResult;console.assert(t||i||n||s);let a=["audit"];t?a.push("test-case"):i?a.push("test-group"):n?a.push("test-case-result"):s&&a.push("test-group-result");let d={hasChildren:i||s};const p=null;super(a,e.name,p,e,d),i&&(this._expandedSetting=new WI.Setting(`audit-tree-element-${this.representedObject.name}-expanded`,!1))}onattach(){super.onattach(),this.representedObject instanceof WI.AuditTestBase&&(this.representedObject.addEventListener(WI.AuditTestBase.Event.DisabledChanged,this._handleTestDisabledChanged,this),this.representedObject.addEventListener(WI.AuditTestBase.Event.ResultChanged,this._handleTestResultChanged,this),this.representedObject instanceof WI.AuditTestCase?this.representedObject.addEventListener(WI.AuditTestBase.Event.Scheduled,this._handleTestCaseScheduled,this):this.representedObject instanceof WI.AuditTestGroup&&this.representedObject.addEventListener(WI.AuditTestBase.Event.Scheduled,this._handleTestGroupScheduled,this),WI.auditManager.addEventListener(WI.AuditManager.Event.EditingChanged,this._handleManagerEditingChanged,this),WI.auditManager.addEventListener(WI.AuditManager.Event.TestScheduled,this._handleAuditManagerTestScheduled,this),WI.auditManager.addEventListener(WI.AuditManager.Event.TestCompleted,this._handleAuditManagerTestCompleted,this)),this.representedObject.supported&&this._expandedSetting&&this._expandedSetting.value&&this.expand(),this._updateStatus()}ondetach(){WI.auditManager.removeEventListener(null,null,this),this.representedObject.removeEventListener(null,null,this),super.ondetach()}onpopulate(){if(super.onpopulate(),!(this.children.length&&!this.shouldRefreshChildren)){if(this.shouldRefreshChildren=!1,this.removeChildren(),this.representedObject instanceof WI.AuditTestGroup)for(let e of this.representedObject.tests)this.appendChild(new WI.AuditTreeElement(e));else if(this.representedObject instanceof WI.AuditTestGroupResult)for(let e of this.representedObject.results)this.appendChild(new WI.AuditTreeElement(e))}}onexpand(){console.assert(this.expanded),this._expandedSetting&&(this._expandedSetting.value=this.expanded)}oncollapse(){console.assert(!this.expanded),this._expandedSetting&&(this._expandedSetting.value=this.expanded)}ondelete(){return!(this.representedObject instanceof WI.AuditTestBase)||!(this.parent instanceof WI.TreeOutline)||!WI.auditManager.editing?!1:(WI.auditManager.removeTest(this.representedObject),!0)}populateContextMenu(e,t){WI.auditManager.runningState===WI.AuditManager.RunningState.Inactive&&e.appendItem(WI.UIString("Start"),i=>{this._start()}),e.appendSeparator(),this.representedObject instanceof WI.AuditTestBase&&e.appendItem(WI.UIString("Export Test"),i=>{WI.auditManager.export(this.representedObject)}),this.representedObject.result&&e.appendItem(WI.UIString("Export Result"),i=>{WI.auditManager.export(this.representedObject.result)}),e.appendSeparator(),super.populateContextMenu(e,t)}_start(){WI.auditManager.runningState===WI.AuditManager.RunningState.Inactive&&WI.auditManager.start([this.representedObject])}_updateStatus(){if(this.representedObject instanceof WI.AuditTestBase&&!this.representedObject.supported){this.status=document.createElement("img"),this.status.title=WI.UIString("This audit is not supported"),this.addClassName("unsupported");return}if(WI.auditManager.editing){this.status=document.createElement("input"),this.status.type="checkbox",this._updateTestGroupDisabled(),this.status.addEventListener("change",()=>{this.representedObject.disabled=!this.representedObject.disabled}),this.addClassName("editing-audits");return}let e="",t=this.representedObject.result;t&&(t.didError?e=WI.AuditTestCaseResult.Level.Error:t.didFail?e=WI.AuditTestCaseResult.Level.Fail:t.didWarn?e=WI.AuditTestCaseResult.Level.Warn:t.didPass?e=WI.AuditTestCaseResult.Level.Pass:t.unsupported&&(e=WI.AuditTestCaseResult.Level.Unsupported)),this.status=document.createElement("img"),this.representedObject instanceof WI.AuditTestBase&&(this.status.title=WI.UIString("Start"),this.status.addEventListener("click",this._handleStatusClick.bind(this)),e||(e="show-on-hover")),this.status.classList.add(e),this.removeClassName("editing-audits")}_showRunningSpinner(){if(this.representedObject.runningState===WI.AuditManager.RunningState.Inactive){this._updateStatus();return}if(!this.status||!this.status.__spinner){let e=new WI.IndeterminateProgressSpinner;this.status=e.element,this.status.__spinner=!0}}_showRunningProgress(e){if(!this.representedObject.runningState===WI.AuditManager.RunningState.Inactive){this._updateStatus();return}(!this.status||!this.status.__progress)&&(this.status=document.createElement("progress"),this.status.__progress=!0),this.status.value=e||0}_updateTestGroupDisabled(){if(this.status.checked=!this.representedObject.disabled,this.representedObject instanceof WI.AuditTestGroup){let e=this.representedObject.tests.find(t=>t.supported);this.status.indeterminate=this.representedObject.tests.some(t=>t.supported&&t.disabled!==e.disabled)}}_handleTestCaseCompleted(e){this.representedObject.removeEventListener(WI.AuditTestBase.Event.Completed,this._handleTestCaseCompleted,this),this._updateStatus()}_handleTestDisabledChanged(e){this.status instanceof HTMLInputElement&&this.status.type==="checkbox"&&this._updateTestGroupDisabled()}_handleTestResultChanged(e){this._updateStatus()}_handleTestCaseScheduled(e){this.representedObject.addEventListener(WI.AuditTestBase.Event.Completed,this._handleTestCaseCompleted,this),this._showRunningSpinner()}_handleTestGroupCompleted(e){this.representedObject.removeEventListener(WI.AuditTestBase.Event.Completed,this._handleTestGroupCompleted,this),this.representedObject.removeEventListener(WI.AuditTestBase.Event.Progress,this._handleTestGroupProgress,this),this._updateStatus()}_handleTestGroupProgress(e){let{index:t,count:i}=e.data;this._showRunningProgress((t+1)/i)}_handleTestGroupScheduled(e){this.representedObject.addEventListener(WI.AuditTestBase.Event.Completed,this._handleTestGroupCompleted,this),this.representedObject.addEventListener(WI.AuditTestBase.Event.Progress,this._handleTestGroupProgress,this),this._showRunningProgress()}_handleManagerEditingChanged(e){this._updateStatus()}_handleAuditManagerTestScheduled(e){this.addClassName("manager-active")}_handleAuditManagerTestCompleted(e){this.removeClassName("manager-active")}_handleStatusClick(e){this._start()}};WI.BezierEditor=class extends WI.Object{constructor(){super(),this._element=document.createElement("div"),this._element.classList.add("bezier-editor");var e=184,t=200;this._padding=25,this._controlHandleRadius=7,this._bezierWidth=e-this._controlHandleRadius*2,this._bezierHeight=t-this._controlHandleRadius*2-this._padding*2,this._bezierPreviewContainer=this._element.createChild("div","bezier-preview"),this._bezierPreviewContainer.title=WI.UIString("Restart animation"),this._bezierPreviewContainer.addEventListener("mousedown",this._resetPreviewAnimation.bind(this)),this._bezierPreview=this._bezierPreviewContainer.createChild("div"),this._bezierPreviewTiming=this._element.createChild("div","bezier-preview-timing"),this._bezierContainer=this._element.appendChild(createSVGElement("svg")),this._bezierContainer.setAttribute("width",e),this._bezierContainer.setAttribute("height",t),this._bezierContainer.classList.add("bezier-container");let i=this._bezierContainer.appendChild(createSVGElement("g"));i.setAttribute("transform","translate(0, "+this._padding+")");let n=i.appendChild(createSVGElement("line"));n.classList.add("linear-curve"),n.setAttribute("x1",this._controlHandleRadius),n.setAttribute("y1",this._bezierHeight+this._controlHandleRadius),n.setAttribute("x2",this._bezierWidth+this._controlHandleRadius),n.setAttribute("y2",this._controlHandleRadius),this._bezierCurve=i.appendChild(createSVGElement("path")),this._bezierCurve.classList.add("bezier-curve");function s(d,p){d+=this._controlHandleRadius,p+=this._controlHandleRadius;let f=i.appendChild(createSVGElement("line"));f.classList.add("control-line"),f.setAttribute("x1",d),f.setAttribute("y1",p),f.setAttribute("x2",d),f.setAttribute("y2",p);let _=i.appendChild(createSVGElement("circle"));return _.classList.add("control-handle"),{point:null,line:f,handle:_}}this._inControl=s.call(this,0,this._bezierHeight),this._outControl=s.call(this,this._bezierWidth,0),this._numberInputContainer=this._element.createChild("div","number-input-container");function a(d,{min:p,max:f}={}){let _="_bezier"+d+"Input";this[_]=this._numberInputContainer.createChild("input"),this[_].type="number",this[_].step=.01,isNaN(p)||(this[_].min=p),isNaN(f)||(this[_].max=f),this[_].addEventListener("input",this._handleNumberInputInput.bind(this)),this[_].addEventListener("keydown",this._handleNumberInputKeydown.bind(this))}a.call(this,"InX",{min:0,max:1}),a.call(this,"InY"),a.call(this,"OutX",{min:0,max:1}),a.call(this,"OutY"),this._selectedControl=null,this._mouseDownPosition=null,this._bezierContainer.addEventListener("mousedown",this),WI.addWindowKeydownListener(this)}get element(){return this._element}set bezier(e){if(!!e){var t=e instanceof WI.CubicBezier;console.assert(t),t&&(this._bezier=e,this._updateBezierPreview())}}get bezier(){return this._bezier}removeListeners(){WI.removeWindowKeydownListener(this)}handleEvent(e){switch(e.type){case"mousedown":this._handleMousedown(e);break;case"mousemove":this._handleMousemove(e);break;case"mouseup":this._handleMouseup(e);break}}handleKeydownEvent(e){if(!this._selectedControl||!this._element.parentNode)return!1;let t=0,i=0;switch(e.keyCode){case WI.KeyboardShortcut.Key.Up.keyCode:i=-1;break;case WI.KeyboardShortcut.Key.Right.keyCode:t=1;break;case WI.KeyboardShortcut.Key.Down.keyCode:i=1;break;case WI.KeyboardShortcut.Key.Left.keyCode:t=-1;break;default:return!1}return e.shiftKey&&(t*=10,i*=10),i*=this._bezierWidth/100,t*=this._bezierHeight/100,this._selectedControl.point.x=Number.constrain(this._selectedControl.point.x+t,0,this._bezierWidth),this._selectedControl.point.y+=i,this._updateControl(this._selectedControl),this._updateValue(),!0}_handleMousedown(e){e.button===0&&(window.addEventListener("mousemove",this,!0),window.addEventListener("mouseup",this,!0),this._bezierPreviewContainer.classList.remove("animate"),this._bezierPreviewTiming.classList.remove("animate"),this._updateControlPointsForMouseEvent(e,!0))}_handleMousemove(e){this._updateControlPointsForMouseEvent(e)}_handleMouseup(e){this._selectedControl.handle.classList.remove("selected"),this._mouseDownPosition=null,this._triggerPreviewAnimation(),window.removeEventListener("mousemove",this,!0),window.removeEventListener("mouseup",this,!0)}_updateControlPointsForMouseEvent(e,t){var i=WI.Point.fromEventInElement(e,this._bezierContainer);i.x=Number.constrain(i.x-this._controlHandleRadius,0,this._bezierWidth),i.y-=this._controlHandleRadius+this._padding,t&&(this._mouseDownPosition=i,this._inControl.point.distance(i)<this._outControl.point.distance(i)?this._selectedControl=this._inControl:this._selectedControl=this._outControl),e.shiftKey&&this._mouseDownPosition&&(Math.abs(this._mouseDownPosition.x-i.x)>Math.abs(this._mouseDownPosition.y-i.y)?i.y=this._mouseDownPosition.y:i.x=this._mouseDownPosition.x),this._selectedControl.point=i,this._selectedControl.handle.classList.add("selected"),this._updateValue()}_updateValue(){function e(a){return Math.round(a*100)/100}var t=e(this._inControl.point.x/this._bezierWidth),i=e(1-this._inControl.point.y/this._bezierHeight),n=e(this._outControl.point.x/this._bezierWidth),s=e(1-this._outControl.point.y/this._bezierHeight);this._bezier=new WI.CubicBezier(t,i,n,s),this._updateBezier(),this.dispatchEventToListeners(WI.BezierEditor.Event.BezierChanged,{bezier:this._bezier})}_updateBezier(){var e=this._controlHandleRadius,t=this._inControl.point.x+e,i=this._inControl.point.y+e,n=this._outControl.point.x+e,s=this._outControl.point.y+e,a=`M ${e} ${this._bezierHeight+e} C ${t} ${i} ${n} ${s} ${this._bezierWidth+e} ${e}`;this._bezierCurve.setAttribute("d",a),this._updateControl(this._inControl),this._updateControl(this._outControl),this._bezierInXInput.value=this._bezier.inPoint.x,this._bezierInYInput.value=this._bezier.inPoint.y,this._bezierOutXInput.value=this._bezier.outPoint.x,this._bezierOutYInput.value=this._bezier.outPoint.y}_updateControl(e){e.handle.setAttribute("cx",e.point.x+this._controlHandleRadius),e.handle.setAttribute("cy",e.point.y+this._controlHandleRadius),e.line.setAttribute("x2",e.point.x+this._controlHandleRadius),e.line.setAttribute("y2",e.point.y+this._controlHandleRadius)}_updateBezierPreview(){this._inControl.point=new WI.Point(this._bezier.inPoint.x*this._bezierWidth,(1-this._bezier.inPoint.y)*this._bezierHeight),this._outControl.point=new WI.Point(this._bezier.outPoint.x*this._bezierWidth,(1-this._bezier.outPoint.y)*this._bezierHeight),this._updateBezier(),this._triggerPreviewAnimation()}_triggerPreviewAnimation(){this._bezierPreview.style.animationTimingFunction=this._bezier.toString(),this._bezierPreviewContainer.classList.add("animate"),this._bezierPreviewTiming.classList.add("animate")}_resetPreviewAnimation(){var e=this._bezierPreview.parentNode;e.removeChild(this._bezierPreview),e.appendChild(this._bezierPreview),this._element.removeChild(this._bezierPreviewTiming),this._element.appendChild(this._bezierPreviewTiming)}_handleNumberInputInput(e){this._changeBezierForInput(e.target,e.target.value)}_handleNumberInputKeydown(e){let t=0;e.keyIdentifier==="Up"?t=.01:e.keyIdentifier==="Down"&&(t=-.01),t&&(e.shiftKey&&(t*=10),e.preventDefault(),this._changeBezierForInput(e.target,parseFloat(e.target.value)+t))}_changeBezierForInput(e,t){switch(t=Math.round(t*100)/100,e){case this._bezierInXInput:this._bezier.inPoint.x=Number.constrain(t,0,1);break;case this._bezierInYInput:this._bezier.inPoint.y=t;break;case this._bezierOutXInput:this._bezier.outPoint.x=Number.constrain(t,0,1);break;case this._bezierOutYInput:this._bezier.outPoint.y=t;break;default:return}this._updateBezierPreview(),this.dispatchEventToListeners(WI.BezierEditor.Event.BezierChanged,{bezier:this._bezier})}};WI.BezierEditor.Event={BezierChanged:"bezier-editor-bezier-changed"};WI.BoxModelDetailsSectionRow=class extends WI.DetailsSectionRow{constructor(){super(WI.UIString("No Box Model Information")),this.element.classList.add("box-model"),this._nodeStyles=null}get nodeStyles(){return this._nodeStyles}set nodeStyles(e){this._nodeStyles&&this._nodeStyles.computedStyle&&this._nodeStyles.computedStyle.removeEventListener(WI.CSSStyleDeclaration.Event.PropertiesChanged,this._refresh,this),this._nodeStyles=e,this._nodeStyles&&this._nodeStyles.computedStyle&&this._nodeStyles.computedStyle.addEventListener(WI.CSSStyleDeclaration.Event.PropertiesChanged,this._refresh,this),this._refresh()}_refresh(){if(this._ignoreNextRefresh){this._ignoreNextRefresh=!1;return}this._updateMetrics()}_getPropertyValueAsPx(e,t){return Number(e.propertyForName(t).value.replace(/px$/,"")||0)}_getBox(e,t){var i=this._getComponentSuffix(t),n=this._getPropertyValueAsPx(e,t+"-left"+i),s=this._getPropertyValueAsPx(e,t+"-top"+i),a=this._getPropertyValueAsPx(e,t+"-right"+i),d=this._getPropertyValueAsPx(e,t+"-bottom"+i);return{left:n,top:s,right:a,bottom:d}}_getComponentSuffix(e){return e==="border"?"-width":""}_highlightDOMNode(e,t,i){i.stopPropagation();var n=e?this.nodeStyles.node.id:0;if(n){if(this._highlightMode===t)return;this._highlightMode=t,WI.domManager.highlightDOMNode(n,t)}else this._highlightMode=null,WI.domManager.hideDOMNodeHighlight();for(var s=0;this._boxElements&&s<this._boxElements.length;++s){var a=this._boxElements[s];n&&(t==="all"||a._name===t)?a.classList.add("active"):a.classList.remove("active")}this.element.classList.toggle("hovered",e)}_updateMetrics(){var e=document.createElement("div"),t=this._nodeStyles.computedStyle;function i(w,S,E,k){let R=parseFloat(S),M=!isNaN(R)&&R%1!==0;isNaN(R)&&(S=figureDash);let L=document.createElement(w);return L.textContent=M?"~"+Math.round(R*100)/100:S,M&&(L.title=S),L.addEventListener("dblclick",this._startEditing.bind(this,L,E,k,t),!1),L}function n(w,S){let E=this._getComponentSuffix(w),k=(w!=="position"?w+"-":"")+S+E,R=t.propertyForName(k);if(!R)return null;let M=R.value;M===""||w!=="position"&&M==="0px"||w==="position"&&M==="auto"?M="":M=M.replace(/px$/,"");let L=i.call(this,"div",M,w,k);return L.className=S,L}function s(w){console.assert(w==="width"||w==="height");let S=t.propertyForName(w);if(!S)return null;let E=S.value.replace(/px$/,"");if(t.propertyForName("box-sizing").value==="border-box"){let k=this._getBox(t,"border"),R=this._getBox(t,"padding"),[M,L]=w==="width"?["left","right"]:["top","bottom"];E=E-k[M]-k[L]-R[M]-R[L]}return i.call(this,"span",E,w,w)}var a={"table-cell":!0,"table-column":!0,"table-column-group":!0,"table-footer-group":!0,"table-header-group":!0,"table-row":!0,"table-row-group":!0},d={"table-column":!0,"table-column-group":!0,"table-footer-group":!0,"table-header-group":!0,"table-row":!0,"table-row-group":!0},p={static:!0};if(this._boxElements=[],t.enabledProperties.length===0){this.showEmptyMessage();return}let f=t.propertyForName("display"),_=t.propertyForName("position");if(!f||!_){this.showEmptyMessage();return}var b=null;for(let w of["content","padding","border","margin","position"]){if(w==="margin"&&a[f.value]||w==="padding"&&d[f.value]||w==="position"&&p[_.value])continue;let S=document.createElement("div");if(S.className=w,S._name=w,S.addEventListener("mouseover",this._highlightDOMNode.bind(this,!0,w==="position"?"all":w),!1),this._boxElements.push(S),w==="content"){let E=s.call(this,"width"),k=s.call(this,"height");if(!E||!k){this.showEmptyMessage();return}S.append(E," \xD7 ",k)}else{let E=n.call(this,w,"top"),k=n.call(this,w,"left"),R=n.call(this,w,"right"),M=n.call(this,w,"bottom");if(!E||!k||!R||!M){this.showEmptyMessage();return}let L=document.createElement("div");L.className="label",L.textContent=w,S.appendChild(L),S.appendChild(E),S.appendChild(document.createElement("br")),S.appendChild(k),b&&S.appendChild(b),S.appendChild(R),S.appendChild(document.createElement("br")),S.appendChild(M)}b=S}e.appendChild(b),e.addEventListener("mouseover",this._highlightDOMNode.bind(this,!1,""),!1),this.hideEmptyMessage(),this.element.appendChild(e)}_startEditing(e,t,i,n){if(!WI.isBeingEdited(e)){e.title&&(e.textContent=e.title);var s={box:t,styleProperty:i},a=this._handleKeyDown.bind(this,s,i);s.keyDownHandler=a,e.addEventListener("keydown",a,!1),this._isEditingMetrics=!0;var d=new WI.EditingConfig(this._editingCommitted.bind(this),this._editingCancelled.bind(this),s);WI.startEditing(e,d),window.getSelection().setBaseAndExtent(e,0,e,1)}}_alteredFloatNumber(e,t){var i=t.keyIdentifier==="Up"||t.keyIdentifier==="Down",n=1;t.shiftKey&&!i?n=100:t.shiftKey||!i?n=10:t.altKey&&(n=.1),(t.keyIdentifier==="Down"||t.keyIdentifier==="PageDown")&&(n*=-1);var s=Number((e+n).toFixed(6));return String(s).match(WI.EditingSupport.NumberRegex)?s:null}_handleKeyDown(e,t,i){if(!!/^(?:Page)?(?:Up|Down)$/.test(i.keyIdentifier)){var n=i.currentTarget,s=window.getSelection();if(!!s.rangeCount){var a=s.getRangeAt(0);if(console.assert(a,"We should have a range if we are handling a key down event"),!!n.contains(a.commonAncestorContainer)){var d=n.textContent,p=a.startContainer.rangeOfWord(a.startOffset,WI.EditingSupport.StyleValueDelimiters,n),f=p.toString(),_=WI.EditingSupport.NumberRegex.exec(f),b;if(_&&_.length){var w=_[1],S=_[3],E=this._alteredFloatNumber(parseFloat(_[2]),i);if(E===null)return;t!=="margin"&&E<0&&(E=0),b=w+E+S}if(!!b){var k=document.createTextNode(b);p.deleteContents(),p.insertNode(k);var R=document.createRange();R.setStart(k,0),R.setEnd(k,b.length),s.removeAllRanges(),s.addRange(R),i.handled=!0,i.preventDefault(),this._ignoreNextRefresh=!0,this._applyUserInput(n,b,d,e,!1)}}}}}_editingEnded(e,t){e.removeEventListener("keydown",t.keyDownHandler,!1),this._isEditingMetrics=!1}_editingCancelled(e,t){this._editingEnded(e,t),this._refresh()}_applyUserInput(e,t,i,n,s){if(s&&t===i){this._editingCancelled(e,n);return}n.box!=="position"&&(!t||t===figureDash)?t="0px":n.box==="position"&&(!t||t===figureDash)&&(t="auto"),t=t.toLowerCase(),/^-?(?:\d+(?:\.\d+)?|\.\d+)$/.test(t)&&(t+="px");var a=n.styleProperty,d=this._nodeStyles.computedStyle;if(d.propertyForName("box-sizing").value==="border-box"&&(a==="width"||a==="height")){if(!t.match(/px$/)){console.error("For elements with box-sizing: border-box, only absolute content area dimensions can be applied");return}var p=this._getBox(d,"border"),f=this._getBox(d,"padding"),_=Number(t.replace(/px$/,""));if(isNaN(_))return;a==="width"?_+=p.left+p.right+f.left+f.right:_+=p.top+p.bottom+f.top+f.bottom,t=_+"px"}WI.RemoteObject.resolveNode(this._nodeStyles.node).then(b=>{function w(E,k){this.style.setProperty(E,k,"important")}let S=()=>{this._nodeStyles.refresh()};b.callFunction(w,[a,t],!1,S),b.release()})}_editingCommitted(e,t,i,n){this._editingEnded(e,n),this._applyUserInput(e,t,i,n,!0)}};WI.BreakpointActionView=class extends WI.Object{constructor(e,t,i){super(),console.assert(e),console.assert(t),this._action=e,this._delegate=t,this._element=document.createElement("div"),this._element.className="breakpoint-action-block";var n=this._element.appendChild(document.createElement("div"));n.className="breakpoint-action-block-header";var s=n.appendChild(document.createElement("select"));s.addEventListener("change",this._pickerChanged.bind(this));for(var a in WI.BreakpointAction.Type){var d=WI.BreakpointAction.Type[a],p=document.createElement("option");p.textContent=WI.BreakpointActionView.displayStringForType(d),p.selected=this._action.type===d,p.value=d,s.add(p)}let f=n.appendChild(document.createElement("div"));f.classList.add("breakpoint-action-button-container");let _=f.appendChild(document.createElement("button"));_.className="breakpoint-action-append-button",_.addEventListener("click",this._appendActionButtonClicked.bind(this)),_.title=WI.UIString("Add new breakpoint action after this action");let b=f.appendChild(document.createElement("button"));b.className="breakpoint-action-remove-button",b.addEventListener("click",this._removeAction.bind(this)),b.title=WI.UIString("Remove this breakpoint action"),this._bodyElement=this._element.appendChild(document.createElement("div")),this._bodyElement.className="breakpoint-action-block-body",this._updateBody(i)}static displayStringForType(e){switch(e){case WI.BreakpointAction.Type.Log:return WI.UIString("Log Message");case WI.BreakpointAction.Type.Evaluate:return WI.UIString("Evaluate JavaScript");case WI.BreakpointAction.Type.Sound:return WI.UIString("Play Sound");case WI.BreakpointAction.Type.Probe:return WI.UIString("Probe Expression");default:return console.assert(!1),""}}get action(){return this._action}get element(){return this._element}_pickerChanged(e){var t=e.target.value;this._action=this._action.breakpoint.recreateAction(t,this._action),this._updateBody(),this._delegate.breakpointActionViewResized(this)}_appendActionButtonClicked(e){var t=this._action.breakpoint.createAction(this._action.type,this._action);this._delegate.breakpointActionViewAppendActionView(this,t)}_removeAction(){this._action.breakpoint.removeAction(this._action),this._delegate.breakpointActionViewRemoveActionView(this)}_updateBody(e){switch(this._bodyElement.removeChildren(),this._action.type){case WI.BreakpointAction.Type.Log:this._bodyElement.hidden=!1;var t=this._bodyElement.appendChild(document.createElement("input"));t.placeholder=WI.UIString("Message"),t.addEventListener("change",this._logInputChanged.bind(this)),t.value=this._action.data||"",t.spellcheck=!1,e||setTimeout(function(){t.focus()},0);var i=this._bodyElement.appendChild(document.createElement("div"));i.classList.add("description"),i.setAttribute("dir","ltr"),i.textContent=WI.UIString("${expr} = expression");break;case WI.BreakpointAction.Type.Evaluate:case WI.BreakpointAction.Type.Probe:this._bodyElement.hidden=!1;var n=this._bodyElement.appendChild(document.createElement("div"));n.classList.add("breakpoint-action-eval-editor"),n.classList.add(WI.SyntaxHighlightedStyleClassName),this._codeMirror=WI.CodeMirrorEditor.create(n,{lineWrapping:!0,mode:"text/javascript",matchBrackets:!0,value:this._action.data||""}),this._codeMirror.on("viewportChange",this._codeMirrorViewportChanged.bind(this)),this._codeMirror.on("blur",this._codeMirrorBlurred.bind(this)),this._codeMirrorViewport={from:null,to:null};var s=new WI.CodeMirrorCompletionController(this._codeMirror);s.addExtendedCompletionProvider("javascript",WI.javaScriptRuntimeCompletionProvider),setTimeout(()=>{this._codeMirror.refresh(),e||this._codeMirror.focus()},0);break;case WI.BreakpointAction.Type.Sound:this._bodyElement.hidden=!0;break;default:console.assert(!1),this._bodyElement.hidden=!0;break}}_logInputChanged(e){this._action.data=e.target.value}_codeMirrorBlurred(e){this._action.data=(this._codeMirror.getValue()||"").trim()}_codeMirrorViewportChanged(e,t,i){this._codeMirrorViewport.from===t&&this._codeMirrorViewport.to===i||(this._codeMirrorViewport.from=t,this._codeMirrorViewport.to=i,this._delegate.breakpointActionViewResized(this))}};WI.BreakpointTreeElement=class extends WI.GeneralTreeElement{constructor(e,{className:t,title:i}={}){console.assert(e instanceof WI.Breakpoint),t||(t=WI.BreakpointTreeElement.GenericLineIconStyleClassName);const n=null;super(["breakpoint",t],i,n,e),this._breakpoint=e,this._probeSet=null,this._listenerSet=new WI.EventListenerSet(this,"BreakpointTreeElement listeners"),i||this._listenerSet.register(e,WI.Breakpoint.Event.LocationDidChange,this._breakpointLocationDidChange),this._listenerSet.register(e,WI.Breakpoint.Event.DisabledStateDidChange,this._updateStatus),this._listenerSet.register(e,WI.Breakpoint.Event.AutoContinueDidChange,this._updateStatus),this._listenerSet.register(e,WI.Breakpoint.Event.ResolvedStateDidChange,this._updateStatus),this._listenerSet.register(WI.debuggerManager,WI.DebuggerManager.Event.BreakpointsEnabledDidChange,this._updateStatus),this._listenerSet.register(WI.debuggerManager,WI.DebuggerManager.Event.ProbeSetAdded,this._probeSetAdded),this._listenerSet.register(WI.debuggerManager,WI.DebuggerManager.Event.ProbeSetRemoved,this._probeSetRemoved),this.status=WI.ImageUtilities.useSVGSymbol("data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2019 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 23 12'%3e %3cpolygon points='0.5 0.5 17.355 0.5 21.904 6 17.355 11.5 0.5 11.5 0.5 0.5'/%3e %3c/svg%3e"),this.status.className=WI.BreakpointTreeElement.StatusImageElementStyleClassName,this._listenerSet.register(this.status,"mousedown",this._statusImageElementMouseDown),this._listenerSet.register(this.status,"click",this._statusImageElementClicked),i||this._updateTitles(),this._updateStatus(),this._iconAnimationLayerElement=document.createElement("span"),this.iconElement.appendChild(this._iconAnimationLayerElement),this.tooltipHandledSeparately=!0}get breakpoint(){return this._breakpoint}get filterableData(){return{text:[this.breakpoint.contentIdentifier]}}ondelete(){return WI.debuggerManager.isBreakpointRemovable(this._breakpoint)?(this.__deletedViaDeleteKeyboardShortcut=!0,WI.debuggerManager.removeBreakpoint(this._breakpoint),!0):(this._breakpoint.disabled?InspectorFrontendHost.beep():this._breakpoint.disabled=!0,!0)}onenter(){return this._breakpoint.cycleToNextMode(),!0}onspace(){return this._breakpoint.cycleToNextMode(),!0}onattach(){super.onattach(),this._listenerSet.install();for(var e of WI.debuggerManager.probeSets)e.breakpoint===this._breakpoint&&this._addProbeSet(e)}ondetach(){super.ondetach(),this._listenerSet.uninstall(),this._probeSet&&this._removeProbeSet(this._probeSet)}populateContextMenu(e,t){WI.breakpointPopoverController.appendContextMenuItems(e,this._breakpoint,this.status),super.populateContextMenu(e,t)}_updateTitles(){var e=this._breakpoint.sourceCodeLocation,t=e.displayLineNumber,i=e.displayColumnNumber;i>0?this.mainTitle=WI.UIString("Line %d:%d").format(t+1,i+1):this.mainTitle=WI.UIString("Line %d").format(t+1),e.hasMappedLocation()&&(this.subtitle=e.formattedLocationString(),e.hasFormattedLocation()?this.subtitleElement.classList.add(WI.BreakpointTreeElement.FormattedLocationStyleClassName):this.subtitleElement.classList.remove(WI.BreakpointTreeElement.FormattedLocationStyleClassName),this.tooltip=this.mainTitle+" \u2014 "+WI.UIString("originally %s").format(e.originalLocationString()))}_updateStatus(){!this.status||(this.status.classList.toggle(WI.BreakpointTreeElement.StatusImageDisabledStyleClassName,this._breakpoint.disabled),this.status.classList.toggle(WI.BreakpointTreeElement.StatusImageAutoContinueStyleClassName,this._breakpoint.autoContinue),this.status.classList.toggle(WI.BreakpointTreeElement.StatusImageResolvedStyleClassName,this._breakpoint.resolved&&WI.debuggerManager.breakpointsEnabled))}_addProbeSet(e){console.assert(e instanceof WI.ProbeSet),console.assert(e.breakpoint===this._breakpoint),console.assert(e!==this._probeSet),this._probeSet=e,e.addEventListener(WI.ProbeSet.Event.SamplesCleared,this._samplesCleared,this),e.dataTable.addEventListener(WI.ProbeSetDataTable.Event.FrameInserted,this._dataUpdated,this)}_removeProbeSet(e){console.assert(e instanceof WI.ProbeSet),console.assert(e===this._probeSet),e.removeEventListener(WI.ProbeSet.Event.SamplesCleared,this._samplesCleared,this),e.dataTable.removeEventListener(WI.ProbeSetDataTable.Event.FrameInserted,this._dataUpdated,this),this._probeSet=null}_probeSetAdded(e){var t=e.data.probeSet;t.breakpoint===this._breakpoint&&this._addProbeSet(t)}_probeSetRemoved(e){var t=e.data.probeSet;t.breakpoint===this._breakpoint&&this._removeProbeSet(t)}_samplesCleared(e){console.assert(this._probeSet);var t=e.data.oldTable;t.removeEventListener(WI.ProbeSetDataTable.Event.FrameInserted,this._dataUpdated,this),this._probeSet.dataTable.addEventListener(WI.ProbeSetDataTable.Event.FrameInserted,this._dataUpdated,this)}_dataUpdated(){if(this.element.classList.contains(WI.BreakpointTreeElement.ProbeDataUpdatedStyleClassName)){clearTimeout(this._removeIconAnimationTimeoutIdentifier),this.element.classList.remove(WI.BreakpointTreeElement.ProbeDataUpdatedStyleClassName),window.requestAnimationFrame(this._dataUpdated.bind(this));return}this.element.classList.add(WI.BreakpointTreeElement.ProbeDataUpdatedStyleClassName),this._removeIconAnimationTimeoutIdentifier=setTimeout(()=>{this.element.classList.remove(WI.BreakpointTreeElement.ProbeDataUpdatedStyleClassName)},WI.BreakpointTreeElement.ProbeDataUpdatedAnimationDuration)}_breakpointLocationDidChange(e){console.assert(e.target===this._breakpoint),e.data.oldDisplaySourceCode!==this._breakpoint.displaySourceCode&&this._updateTitles()}_statusImageElementMouseDown(e){e.stopPropagation()}_statusImageElementClicked(e){this._breakpoint.cycleToNextMode()}};WI.BreakpointTreeElement.GenericLineIconStyleClassName="breakpoint-generic-line-icon";WI.BreakpointTreeElement.StatusImageElementStyleClassName="status-image";WI.BreakpointTreeElement.StatusImageResolvedStyleClassName="resolved";WI.BreakpointTreeElement.StatusImageAutoContinueStyleClassName="auto-continue";WI.BreakpointTreeElement.StatusImageDisabledStyleClassName="disabled";WI.BreakpointTreeElement.FormattedLocationStyleClassName="formatted-location";WI.BreakpointTreeElement.ProbeDataUpdatedStyleClassName="data-updated";WI.BreakpointTreeElement.ProbeDataUpdatedAnimationDuration=400;WI.ButtonToolbarItem=class extends WI.ButtonNavigationItem{constructor(e,t,i,n){super(e,t,i,16,16,n)}};WI.CPUTimelineOverviewGraph=class extends WI.TimelineOverviewGraph{constructor(e,t){console.assert(e instanceof WI.Timeline),console.assert(e.type===WI.TimelineRecord.Type.CPU,e),super(t),this.element.classList.add("cpu"),this._cpuTimeline=e,this._cpuTimeline.addEventListener(WI.Timeline.Event.RecordAdded,this._cpuTimelineRecordAdded,this);let i=new WI.Size(0,this.height);this._chart=new WI.StackedColumnChart(i),this._chart.initializeSections(["main-thread-usage","worker-thread-usage","total-usage"]),this.addSubview(this._chart),this.element.appendChild(this._chart.element),this._chart.element.addEventListener("click",this._handleChartClick.bind(this)),this._legendElement=this.element.appendChild(document.createElement("div")),this._legendElement.classList.add("legend"),this._lastSelectedRecordInLayout=null,this.reset();for(let n of this._cpuTimeline.records)this._processRecord(n)}get height(){return 60}reset(){super.reset(),this._maxUsage=0,this._cachedMaxUsage=void 0,this._lastSelectedRecordInLayout=null,this._updateLegend(),this._chart.clear(),this._chart.needsLayout()}layout(){if(!this.visible)return;this._updateLegend(),this._chart.clear();let e=this.timelineOverview.scrollContainerWidth;if(isNaN(e))return;this._lastSelectedRecordInLayout=this.selectedRecord,(this._chart.size.width!==e||this._chart.size.height!==this.height)&&(this._chart.size=new WI.Size(e,this.height));let t=this.startTime,i=Math.min(this.endTime,this.currentTime),n=this.timelineOverview.secondsPerPixel,s=Math.max(20,this._maxUsage*1.05);function a(b){return(b-t)/n}let d=this.height;function p(b){return b/s*d}let f=this._cpuTimeline.recordsInTimeRange(t,i,{includeRecordBeforeStart:!0});if(!f.length)return;const _=4;for(let b of f){let w=b===this.selectedRecord?"selected":void 0,S=(b.endTime-b.startTime)/n,E=a(b.startTime),k=Math.max(_,p(b.mainThreadUsage)),R=Math.max(_,p(b.mainThreadUsage+b.workerThreadUsage)),M=Math.max(_,p(b.usage));this._chart.addColumnSet(E,d,S,[k,R,M],w)}}updateSelectedRecord(){super.updateSelectedRecord(),this._lastSelectedRecordInLayout!==this.selectedRecord&&this.needsLayout()}_updateLegend(){this._cachedMaxUsage!==this._maxUsage&&(this._cachedMaxUsage=this._maxUsage,this._maxUsage?(this._legendElement.hidden=!1,this._legendElement.textContent=WI.UIString("Maximum CPU Usage: %s").format(Number.percentageString(this._maxUsage/100))):(this._legendElement.hidden=!0,this._legendElement.textContent=""))}_graphPositionForMouseEvent(e){let i=document.elementsFromPoint(e.pageX,e.pageY).find(d=>d.localName==="rect");if(!i)return NaN;let n=i.closest(".stacked-column-chart");if(!n)return NaN;let s=n.getBoundingClientRect(),a=e.pageX-s.left;return WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?s.width-a:a}_handleChartClick(e){let t=this._graphPositionForMouseEvent(e);if(isNaN(t))return;let i=this.timelineOverview.secondsPerPixel,n=t*i,a=this.startTime+n,d=this._cpuTimeline.closestRecordTo(a);!d||(e.__timelineRecordClickEventHandled=!0,this.selectedRecord=d,this.needsLayout())}_cpuTimelineRecordAdded(e){let t=e.data.record;this._processRecord(t),this.needsLayout()}_processRecord(e){this._maxUsage=Math.max(this._maxUsage,e.usage)}};WI.CPUTimelineView=class jt extends WI.TimelineView{constructor(e,t){console.assert(e.type===WI.TimelineRecord.Type.CPU,e),super(e,t),this._recording=t.recording,this.element.classList.add("cpu"),this._sectionLimit=jt.defaultSectionLimit,this._statisticsData=null,this._secondsPerPixelInLayout=void 0,this._visibleRecordsInLayout=[],this._discontinuitiesInLayout=[],this._stickingOverlay=!1,this._overlayRecord=null,this._overlayTime=NaN,e.addEventListener(WI.Timeline.Event.RecordAdded,this._cpuTimelineRecordAdded,this)}static displayNameForSampleType(e){switch(e){case jt.SampleType.JavaScript:return WI.UIString("JavaScript");case jt.SampleType.Layout:return WI.repeatedUIString.timelineRecordLayout();case jt.SampleType.Paint:return WI.repeatedUIString.timelineRecordPaint();case jt.SampleType.Style:return WI.UIString("Styles")}console.error("Unknown sample type",e)}static get cpuUsageViewHeight(){return 135}static get threadCPUUsageViewHeight(){return 65}static get indicatorViewHeight(){return 15}static get lowEnergyThreshold(){return 3}static get mediumEnergyThreshold(){return 30}static get highEnergyThreshold(){return 100}static get lowEnergyGraphBoundary(){return 10}static get mediumEnergyGraphBoundary(){return 70}static get highEnergyGraphBoundary(){return 100}static get defaultSectionLimit(){return 5}shown(){super.shown(),this._timelineRuler&&this._timelineRuler.updateLayout(WI.View.LayoutReason.Resize)}closed(){console.assert(this.representedObject instanceof WI.Timeline),this.representedObject.removeEventListener(null,null,this)}reset(){super.reset(),this._resetSourcesFilters(),this.clear()}clear(){if(!this.didInitialLayout)return;this._breakdownChart.clear(),this._breakdownChart.needsLayout(),this._clearBreakdownLegend(),this._energyChart.clear(),this._energyChart.needsLayout(),this._clearEnergyImpactText(),this._clearStatistics(),this._clearSources();function e(t){t.clear();let i=t.chart.element.querySelector(".markers");i&&i.remove()}e(this._cpuUsageView),e(this._mainThreadUsageView),e(this._webkitThreadUsageView),e(this._unknownThreadUsageView),this._removeWorkerThreadViews(),this._sectionLimit=jt.defaultSectionLimit,this._statisticsData=null,this._secondsPerPixelInLayout=void 0,this._visibleRecordsInLayout=[],this._discontinuitiesInLayout=[],this._stickingOverlay=!1,this._hideGraphOverlay()}get showsFilterBar(){return!1}get scrollableElements(){return[this.element]}initialLayout(){this.element.style.setProperty("--cpu-usage-combined-view-height",jt.cpuUsageViewHeight+"px"),this.element.style.setProperty("--cpu-usage-view-height",jt.threadCPUUsageViewHeight+"px"),this.element.style.setProperty("--cpu-usage-indicator-view-height",jt.indicatorViewHeight+"px");let e=this.element.appendChild(document.createElement("div"));e.classList.add("content");let t=e.appendChild(document.createElement("div"));t.classList.add("overview");function i(V,H,O){let z=V.appendChild(document.createElement("div"));z.classList.add("chart");let K=z.appendChild(document.createElement("div"));K.classList.add("subtitle"),K.textContent=H,O&&(K.title=O);let q=z.appendChild(document.createElement("div"));return q.classList.add("container"),q}function n(V,H){let O=V.appendChild(document.createElement("div"));O.classList.add("row"),O.appendChild(document.createElement("div")).classList.add("swatch",H);let K=O.appendChild(document.createElement("div")),q=K.appendChild(document.createElement("div"));q.classList.add("label"),q.textContent=WI.CPUTimelineView.displayNameForSampleType(H);let Y=K.appendChild(document.createElement("div"));return Y.classList.add("size"),Y}let s=i(t,WI.UIString("Main Thread"),WI.UIString("Breakdown of time spent on the main thread"));this._breakdownChart=new WI.CircleChart({size:120,innerRadiusRatio:.5}),this._breakdownChart.segments=Object.values(WI.CPUTimelineView.SampleType),this.addSubview(this._breakdownChart),s.appendChild(this._breakdownChart.element),this._breakdownLegendElement=s.appendChild(document.createElement("div")),this._breakdownLegendElement.classList.add("legend"),this._breakdownLegendScriptElement=n(this._breakdownLegendElement,jt.SampleType.JavaScript),this._breakdownLegendLayoutElement=n(this._breakdownLegendElement,jt.SampleType.Layout),this._breakdownLegendPaintElement=n(this._breakdownLegendElement,jt.SampleType.Paint),this._breakdownLegendStyleElement=n(this._breakdownLegendElement,jt.SampleType.Style),t.appendChild(document.createElement("div")).classList.add("divider");let d=i(t,WI.UIString("Energy Impact"),WI.UIString("Estimated energy impact."));d.classList.add("energy");let _=d.parentElement.firstChild.appendChild(document.createElement("span"));_.classList.add("info",WI.Popover.IgnoreAutoDismissClassName),_.textContent="?",this._energyInfoPopover=null,this._energyInfoPopoverContentElement=null,_.addEventListener("click",V=>{if(this._energyInfoPopover||(this._energyInfoPopover=new WI.Popover),!this._energyInfoPopoverContentElement){this._energyInfoPopoverContentElement=document.createElement("div"),this._energyInfoPopoverContentElement.className="energy-info-popover-content";const K=0;let q=Number.percentageString(jt.lowEnergyThreshold/100,K),Y=this._energyInfoPopoverContentElement.appendChild(document.createElement("p"));Y.textContent=WI.UIString("Periods of high CPU utilization will rapidly drain battery. Strive to keep idle pages under %s average CPU utilization.").format(q);let se=this._energyInfoPopoverContentElement.appendChild(document.createElement("p"));se.textContent=WI.UIString("There is an incurred energy penalty each time the page enters script. This commonly happens with timers, event handlers, and observers.");let ce=this._energyInfoPopoverContentElement.appendChild(document.createElement("p"));ce.textContent=WI.UIString("To improve CPU utilization reduce or batch workloads when the page is not visible or during times when the page is not being interacted with.")}let O=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?[WI.RectEdge.MAX_Y,WI.RectEdge.MIN_X]:[WI.RectEdge.MAX_Y,WI.RectEdge.MAX_X],z=()=>WI.Rect.rectFromClientRect(_.getBoundingClientRect()).pad(3);this._energyInfoPopover.presentNewContentWithFrame(this._energyInfoPopoverContentElement,z(),O),this._energyInfoPopover.windowResizeHandler=()=>{this._energyInfoPopover.present(z(),O)}}),this._energyChart=new WI.GaugeChart({height:110,strokeWidth:20,segments:[{className:"low",limit:jt.lowEnergyGraphBoundary},{className:"medium",limit:jt.mediumEnergyGraphBoundary},{className:"high",limit:jt.highEnergyGraphBoundary}]}),this.addSubview(this._energyChart),d.appendChild(this._energyChart.element);let b=d.appendChild(document.createElement("div"));this._energyImpactLabelElement=b.appendChild(document.createElement("div")),this._energyImpactLabelElement.className="energy-impact",this._energyImpactNumberElement=b.appendChild(document.createElement("div")),this._energyImpactNumberElement.className="energy-impact-number",this._energyImpactDurationElement=b.appendChild(document.createElement("div")),this._energyImpactDurationElement.className="energy-impact-number";let w=e.appendChild(document.createElement("div"));w.classList.add("details"),this._timelineRuler=new WI.TimelineRuler,this._timelineRuler.zeroTime=this.zeroTime,this._timelineRuler.startTime=this.startTime,this._timelineRuler.endTime=this.endTime,this.addSubview(this._timelineRuler),w.appendChild(this._timelineRuler.element),this._timelineRuler.updateLayout(WI.View.LayoutReason.Resize);let S=w.appendChild(document.createElement("div"));S.classList.add("subtitle"),S.textContent=WI.UIString("CPU Usage"),this._cpuUsageView=new WI.CPUUsageCombinedView(WI.UIString("Total")),this.addSubview(this._cpuUsageView),w.appendChild(this._cpuUsageView.element),this._cpuUsageView.rangeChart.element.addEventListener("click",this._handleIndicatorClick.bind(this)),this._threadsDetailsElement=w.appendChild(document.createElement("details")),this._threadsDetailsElement.open=WI.settings.cpuTimelineThreadDetailsExpanded.value,this._threadsDetailsElement.addEventListener("toggle",V=>{WI.settings.cpuTimelineThreadDetailsExpanded.value=this._threadsDetailsElement.open,this._threadsDetailsElement.open&&this.updateLayout(WI.CPUTimelineView.LayoutReason.Internal)});let E=this._threadsDetailsElement.appendChild(document.createElement("summary"));E.classList.add("subtitle","threads","expandable"),E.textContent=WI.UIString("Threads"),this._mainThreadUsageView=new WI.CPUUsageView(WI.UIString("Main Thread")),this._mainThreadUsageView.element.classList.add("main-thread"),this.addSubview(this._mainThreadUsageView),this._threadsDetailsElement.appendChild(this._mainThreadUsageView.element),this._webkitThreadUsageView=new WI.CPUUsageView(WI.UIString("WebKit Threads")),this.addSubview(this._webkitThreadUsageView),this._threadsDetailsElement.appendChild(this._webkitThreadUsageView.element),this._unknownThreadUsageView=new WI.CPUUsageView(WI.UIString("Other Threads")),this.addSubview(this._unknownThreadUsageView),this._threadsDetailsElement.appendChild(this._unknownThreadUsageView.element),this._workerViews=[],this._sourcesFilter={timer:new Set,event:new Set,observer:new Set};let k=e.appendChild(document.createElement("div"));k.classList.add("overview");let R=i(k,WI.UIString("Statistics"));R.classList.add("stats"),this._statisticsTable=R.appendChild(document.createElement("table")),this._statisticsRows=[];{let{headerCell:V,numberCell:H}=this._createTableRow(this._statisticsTable);V.textContent=WI.UIString("Network Requests:"),this._networkRequestsNumberElement=H}{let{headerCell:V,numberCell:H}=this._createTableRow(this._statisticsTable);V.textContent=WI.UIString("Script Entries:"),this._scriptEntriesNumberElement=H}this._clearStatistics(),k.appendChild(document.createElement("div")).classList.add("divider");let L=i(k,WI.UIString("Sources"));L.classList.add("stats"),this._sourcesTable=L.appendChild(document.createElement("table")),this._sourcesRows=[];{let{row:V,headerCell:H,numberCell:O,labelCell:z}=this._createTableRow(this._sourcesTable);H.textContent=WI.UIString("Filter:"),this._sourcesFilterRow=V,this._sourcesFilterRow.hidden=!0,this._sourcesFilterNumberElement=O,this._sourcesFilterLabelElement=z;let K=O.appendChild(document.createElement("span"));K.className="filter-clear",K.textContent=multiplicationSign,K.addEventListener("click",q=>{this._resetSourcesFilters(),this._layoutStatisticsAndSources()})}{let{row:V,headerCell:H,numberCell:O,labelCell:z}=this._createTableRow(this._sourcesTable);H.textContent=WI.UIString("Timers:"),this._timerInstallationsRow=V,this._timerInstallationsNumberElement=O,this._timerInstallationsLabelElement=z}{let{row:V,headerCell:H,numberCell:O,labelCell:z}=this._createTableRow(this._sourcesTable);H.textContent=WI.UIString("Event Handlers:"),this._eventHandlersRow=V,this._eventHandlersNumberElement=O,this._eventHandlersLabelElement=z}{let{row:V,headerCell:H,numberCell:O,labelCell:z}=this._createTableRow(this._sourcesTable);H.textContent=WI.UIString("Observer Handlers:"),this._observerHandlersRow=V,this._observerHandlersNumberElement=O,this._observerHandlersLabelElement=z}this._clearSources(),this.element.addEventListener("click",this._handleGraphClick.bind(this)),this.element.addEventListener("mousemove",this._handleGraphMouseMove.bind(this)),this._overlayMarker=new WI.TimelineMarker(-1,WI.TimelineMarker.Type.TimeStamp),this._timelineRuler.addMarker(this._overlayMarker)}layout(){if(this.layoutReason===WI.View.LayoutReason.Resize)return;this.layoutReason!==WI.CPUTimelineView.LayoutReason.Internal&&(this._sectionLimit=jt.defaultSectionLimit),this._timelineRuler.zeroTime=this.zeroTime,this._timelineRuler.startTime=this.startTime,this._timelineRuler.endTime=this.endTime;let e=this._timelineRuler.secondsPerPixel;if(!e)return;let t=this.startTime,i=this.endTime,n=Math.min(this.endTime,this.currentTime),s=n-t,a=this._recording.discontinuitiesInTimeRange(t,n),d=a.slice(),p=this.representedObject.recordsInTimeRange(t,n,{includeRecordBeforeStart:!a.length||a[0].startTime>t,includeRecordAfterEnd:!0});if(!p.length||p.length===1&&p[0].endTime<t){this.clear();return}this._secondsPerPixelInLayout=e,this._visibleRecordsInLayout=p,this._discontinuitiesInLayout=a.slice(),this._statisticsData=this._computeStatisticsData(t,n),this._layoutBreakdownChart(),this._layoutStatisticsAndSources();let f=[],_=new Map,b=new Set,w=-1/0,S=-1/0,E=-1/0,k=-1/0,R=-1/0,M=1/0,L=1/0,V=1/0,H=1/0,O=0,z=0,K=0,q=0;for(let Be of p){let qe=Be.startTime,{usage:Ue,mainThreadUsage:Ge,workerThreadUsage:it,webkitThreadUsage:lt,unknownThreadUsage:bt}=Be;if(a.length&&a[0].endTime<=qe){let ni=a.shift(),ri=ni;for(;a.length&&a[0].endTime<=qe;)ri=a.shift();if(f.length){let He=f.lastValue;f.push({time:ni.startTime,mainThreadUsage:He.mainThreadUsage,workerThreadUsage:He.workerThreadUsage,webkitThreadUsage:He.webkitThreadUsage,unknownThreadUsage:He.unknownThreadUsage,usage:He.usage})}f.push({time:ni.startTime,mainThreadUsage:0,workerThreadUsage:0,webkitThreadUsage:0,unknownThreadUsage:0,usage:0}),f.push({time:ri.endTime,mainThreadUsage:0,workerThreadUsage:0,webkitThreadUsage:0,unknownThreadUsage:0,usage:0}),f.push({time:ri.endTime,mainThreadUsage:Ge,workerThreadUsage:it,webkitThreadUsage:lt,unknownThreadUsage:bt,usage:Ue})}f.push({time:qe,mainThreadUsage:Ge,workerThreadUsage:it,webkitThreadUsage:lt,unknownThreadUsage:bt,usage:Ue}),w=Math.max(w,Ue),S=Math.max(S,Ge),E=Math.max(E,lt),k=Math.max(k,bt),M=Math.min(M,Ue),L=Math.min(L,Ge),V=Math.min(V,lt),H=Math.min(H,bt),O+=Ue,z+=Ge,K+=lt,q+=bt;let Yt=b;if(b=new Set,Be.workersData&&Be.workersData.length)for(let{targetId:ni,usage:ri}of Be.workersData){b.add(ni);let He=_.get(ni);if(!He){for(He={discontinuities:d.slice(),recordsCount:0,dataPoints:[],min:1/0,max:-1/0,average:0};He.discontinuities.length&&He.discontinuities[0].endTime<=t;)He.discontinuities.shift();He.dataPoints.push({time:t,usage:0}),He.dataPoints.push({time:qe,usage:0}),_.set(ni,He)}if(He.discontinuities.length&&He.discontinuities[0].endTime<qe){let ei=He.discontinuities.shift(),ui=ei;for(;He.discontinuities.length&&He.discontinuities[0].endTime<qe;)ui=He.discontinuities.shift();if(He.dataPoints.length){let vi=He.dataPoints.lastValue;He.dataPoints.push({time:ei.startTime,usage:vi.usage})}He.dataPoints.push({time:ei.startTime,usage:0}),He.dataPoints.push({time:ui.endTime,usage:0}),He.dataPoints.push({time:ui.endTime,usage:ri})}He.dataPoints.push({time:qe,usage:ri}),He.recordsCount+=1,He.max=Math.max(He.max,ri),He.min=Math.min(He.min,ri),He.average+=ri}if(Yt.size){let ni=Yt.difference(b);for(let ri of ni){let He=_.get(ri);He.dataPoints.lastValue.usage!==0&&He.dataPoints.push({time:qe,usage:0})}}}O/=p.length,z/=p.length,K/=p.length,q/=p.length;for(let[Be,qe]of _)qe.average=qe.average/qe.recordsCount,qe.max>R&&(R=qe.max);a.length&&(n=a[0].startTime);function Y(Be){return Be>100?Math.ceil(Be):(Math.floor(Be/25)+1)*25}function se(Be,qe){return Be.filter(Ue=>Ue<=qe)}function ce(Be){if(Be<1)return[.5];if(Be<7)return se([1,3,5],Be);if(Be<12.5)return se([5,10],Be);if(Be<20)return se([5,10,15],Be);if(Be<30)return se([10,20,30],Be);if(Be<50)return se([15,30,45],Be);if(Be<100)return se([25,50,75],Be);if(Be<200)return se([50,100,150],Be);if(Be>=200){let qe=Math.floor(Be/100);if(qe%2===0){let bt=qe*100;return[bt/2,bt]}let Ge=qe*100,it=100,lt=(Ge+it)/2;return[it,lt,Ge]}}function le(Be,qe,Ue,Ge,{dataPoints:it,min:lt,max:bt,average:Yt}){lt===1/0&&(lt=0),bt===-1/0&&(bt=0),Ge===-1/0&&(Ge=0);let ni=qe===null,ri=Ge*1.05;function He(bi){return(bi-t)/e}let ei=new WI.Size(He(i),Ue);function ui(bi){return ei.height-bi/ri*ei.height}Be.updateChart(it,ei,n,lt,bt,Yt,He,ui,qe);let vi=Be.chart.element.querySelector(".markers");vi||(vi=Be.chart.element.appendChild(document.createElement("div")),vi.className="markers"),vi.removeChildren();let Xe;if(ni)Xe=ce(bt);else{let st=1/(Ue/Ge);if(Ge<5){let De=Math.ceil(17*st/2)*2;Xe=[Math.max(De,Math.floor(bt))]}else{let De=Math.ceil(17*st/5)*5;Xe=[Math.max(De,Math.floor(bt))]}}for(let bi of Xe){let st=ui(bi),De=vi.appendChild(document.createElement("div"));De.style.marginTop=st.toFixed(2)+"px";let Me=De.appendChild(document.createElement("span"));Me.classList.add("label");const Je=0;Me.innerText=Number.percentageString(bi/100,Je)}}if(this._layoutMax=w,this._threadLayoutMax=Y(Math.max(S,E,k,R)),le(this._cpuUsageView,null,jt.cpuUsageViewHeight,this._layoutMax,{dataPoints:f,min:M,max:w,average:O}),this._threadsDetailsElement.open){le(this._mainThreadUsageView,"mainThreadUsage",jt.threadCPUUsageViewHeight,this._threadLayoutMax,{dataPoints:f,min:L,max:S,average:z}),le(this._webkitThreadUsageView,"webkitThreadUsage",jt.threadCPUUsageViewHeight,this._threadLayoutMax,{dataPoints:f,min:V,max:E,average:K}),le(this._unknownThreadUsageView,"unknownThreadUsage",jt.threadCPUUsageViewHeight,this._threadLayoutMax,{dataPoints:f,min:H,max:k,average:q}),this._removeWorkerThreadViews();for(let[Be,qe]of _){let Ue=WI.targetManager.targetForIdentifier(Be),Ge=Ue?Ue.displayName:WI.UIString("Worker Thread"),it=new WI.CPUUsageView(Ge);it.element.classList.add("worker-thread"),it.__workerId=Be,this.addSubview(it),this._threadsDetailsElement.insertBefore(it.element,this._webkitThreadUsageView.element),this._workerViews.push(it),le(it,"usage",jt.threadCPUUsageViewHeight,this._threadLayoutMax,{dataPoints:qe.dataPoints,min:qe.min,max:qe.max,average:qe.average})}}function te(Be){return Be/1e3/e}let ve=(i-t)/e,Pe=new WI.Size(ve,jt.indicatorViewHeight);this._cpuUsageView.updateMainThreadIndicator(this._statisticsData.samples,Pe,n,te),this._layoutEnergyChart(O,s),this._updateGraphOverlay()}_layoutBreakdownChart(){let{samples:e,samplesScript:t,samplesLayout:i,samplesPaint:n,samplesStyle:s,samplesIdle:a}=this._statisticsData,d=e.length-a;if(!d){this._breakdownChart.clear(),this._breakdownChart.needsLayout(),this._clearBreakdownLegend();return}let p=t/d,f=i/d,_=n/d,b=s/d;this._breakdownLegendScriptElement.textContent=`${Number.percentageString(p)} (${t})`,this._breakdownLegendLayoutElement.textContent=`${Number.percentageString(f)} (${i})`,this._breakdownLegendPaintElement.textContent=`${Number.percentageString(_)} (${n})`,this._breakdownLegendStyleElement.textContent=`${Number.percentageString(b)} (${s})`,this._breakdownChart.values=[p*100,f*100,_*100,b*100],this._breakdownChart.needsLayout();let w=this._breakdownChart.centerElement,S=w.firstChild;S||(S=w.appendChild(document.createElement("div")),S.classList.add("samples"),S.title=WI.UIString("Time spent on the main thread"));let E=WI.UIString("%.0fms").format(d);S.textContent=E}_layoutStatisticsAndSources(){this._layoutStatisticsSection(),this._layoutSourcesSection()}_layoutStatisticsSection(){let e=this._statisticsData;this._clearStatistics(),this._networkRequestsNumberElement.textContent=e.networkRequests,this._scriptEntriesNumberElement.textContent=e.scriptEntries;let t=(a,d)=>{let p=document.createElement("span");return p.className="filter",p.textContent=d,p.addEventListener("mouseup",f=>{p.classList.contains("active")?this._removeSourcesFilter(a,d):this._addSourcesFilter(a,d),this._layoutStatisticsAndSources()}),p.classList.toggle("active",this._sourcesFilter[a].has(d)),p},i=()=>{this._sectionLimit=1/0,this._layoutStatisticsAndSources()};function n(){let a=document.createElement("span");return a.className="show-more",a.role="button",a.textContent=ellipsis,a.addEventListener("click",d=>{i()}),a}function s(a){let d=Array.from(a);return d.sort((p,f)=>f[1]-p[1]),new Map(d)}if(e.timerTypes.size){let a=0,d=s(e.timerTypes);for(let[p,f]of d){let _=a===0?WI.UIString("Timers:"):"",b=t("timer",p);if(this._insertTableRow(this._statisticsTable,this._statisticsRows,{headerValue:_,numberValue:f,labelValue:b}),++a===this._sectionLimit&&d.size>this._sectionLimit){this._insertTableRow(this._statisticsTable,this._statisticsRows,{labelValue:n()});break}}}if(e.eventTypes.size){let a=0,d=s(e.eventTypes);for(let[p,f]of d){let _=a===0?WI.UIString("Events:"):"",b=t("event",p);if(this._insertTableRow(this._statisticsTable,this._statisticsRows,{headerValue:_,numberValue:f,labelValue:b}),++a===this._sectionLimit&&d.size>this._sectionLimit){this._insertTableRow(this._statisticsTable,this._statisticsRows,{labelValue:n()});break}}}if(e.observerTypes.size){let a=0,d=s(e.observerTypes);for(let[p,f]of d){let _=a===0?WI.UIString("Observers:"):"",b=t("observer",p);if(this._insertTableRow(this._statisticsTable,this._statisticsRows,{headerValue:_,numberValue:f,labelValue:b}),++a===this._sectionLimit&&d.size>this._sectionLimit){this._insertTableRow(this._statisticsTable,this._statisticsRows,{labelValue:n()});break}}}}_layoutSourcesSection(){let e=this._statisticsData;this._clearSources();const t="unknown";function i(L){return L?L.sourceCode.url+":"+L.lineNumber+":"+L.columnNumber:t}function n(L,V,H){if(L===t){let z=document.createElement("span");return z.className="unknown",z.textContent=WI.UIString("Unknown Location"),z}const O={nameStyle:WI.SourceCodeLocation.NameStyle.Short,columnStyle:WI.SourceCodeLocation.ColumnStyle.Shown,dontFloat:!0,ignoreNetworkTab:!0,ignoreSearchTab:!0};return WI.createSourceCodeLocationLink(V,O)}let s=this._sourcesFilter.timer,a=this._sourcesFilter.event,d=this._sourcesFilter.observer,p=s.size||a.size||d.size,f=this._sectionLimit;isFinite(f)&&p&&(f=jt.defaultSectionLimit*2);let _=()=>{this._sectionLimit=1/0,this._layoutStatisticsAndSources()};function b(){let L=document.createElement("span");return L.className="show-more",L.role="button",L.textContent=ellipsis,L.addEventListener("click",V=>{_()}),L}let w=new Map,S=new Map,E=new Map,k=new Set;if(!p||s.size){for(let L of e.timerInstallationRecords){if(s.size&&(L.eventType===WI.ScriptTimelineRecord.EventType.AnimationFrameRequested&&!s.has("requestAnimationFrame")||L.eventType===WI.ScriptTimelineRecord.EventType.TimerInstalled&&!s.has("setTimeout")))continue;let V=L.initiatorCallFrame,H=V?V.sourceCodeLocation:L.sourceCodeLocation,O=V?V.functionName:"",z=i(H),K=w.getOrInitialize(z,{sourceCodeLocation:H,functionName:O,count:0,repeating:!1});if(L.details){let q=L.details.timerId,Y=e.repeatingTimers.get(q),se=Y?Y.count:1;K.count+=se,L.details.repeating&&(K.repeating=!0),k.add(q)}else K.count+=1}if(!p||s.has("setTimeout"))for(let[L,V]of e.repeatingTimers){if(k.has(L))continue;let H=V.record.sourceCodeLocation,O=i(H),z=w.getOrInitialize(O,{sourceCodeLocation:H,count:0,repeating:!1});z.count+=V.count,z.repeating=!0}}if(!p||a.size)for(let L of e.eventHandlerRecords){if(a.size&&!a.has(L.details))continue;let V=L.sourceCodeLocation,H=i(V),O=S.getOrInitialize(H,{sourceCodeLocation:V,count:0});O.count+=1}if(!p||d.size)for(let L of e.observerCallbackRecords){if(d.size&&!d.has(L.details))continue;let V=L.sourceCodeLocation,H=i(L.sourceCodeLocation),O=E.getOrInitialize(H,{sourceCodeLocation:V,count:0});O.count+=1}const R="";function M(L){let V=Array.from(L);return V.sort((H,O)=>O[1].count-H[1].count),new Map(V)}if(w.size){let L=0,V=M(w);for(let[H,O]of V){let z=O.repeating?WI.UIString("~%s","Approximate Number","Approximate count of events").format(O.count):O.count,K=O.callFrame?O.callFrame.sourceCodeLocation:O.sourceCodeLocation,q=n(H,K),Y=this._eventHandlersRow,se;if(L===0?(se=this._timerInstallationsRow,this._timerInstallationsNumberElement.textContent=z,this._timerInstallationsLabelElement.append(q)):se=this._insertTableRow(this._sourcesTable,this._sourcesRows,{headerValue:R,numberValue:z,labelValue:q,followingRow:Y}),O.functionName&&se.querySelector(".label").append(` ${enDash} ${O.functionName}`),++L===f&&V.size>f){this._insertTableRow(this._sourcesTable,this._sourcesRows,{labelValue:b(),followingRow:Y});break}}}if(S.size){let L=0,V=M(S);for(let[H,O]of V){let z=O.count,K=n(H,O.sourceCodeLocation),q=this._observerHandlersRow;if(L===0?(this._eventHandlersNumberElement.textContent=z,this._eventHandlersLabelElement.append(K)):this._insertTableRow(this._sourcesTable,this._sourcesRows,{headerValue:R,numberValue:z,labelValue:K,followingRow:q}),++L===f&&V.size>f){this._insertTableRow(this._sourcesTable,this._sourcesRows,{labelValue:b(),followingRow:q});break}}}if(E.size){let L=0,V=M(E);for(let[H,O]of V){let z=O.count,K=n(H,O.sourceCodeLocation);if(L===0?(this._observerHandlersNumberElement.textContent=z,this._observerHandlersLabelElement.append(K)):this._insertTableRow(this._sourcesTable,this._sourcesRows,{headerValue:R,numberValue:z,labelValue:K}),++L===f&&V.size>f){this._insertTableRow(this._sourcesTable,this._sourcesRows,{labelValue:b()});break}}}}_layoutEnergyChart(e,t){function i(n,s,a,d,p,f){console.assert(n>=s&&n<=a,"value was not in range.",n);let _=(n-s)/(a-s);return Math.pow(_,f)*(p-d)+d}if(this._clearEnergyImpactText(),e===0?(this._energyImpactLabelElement.textContent=WI.UIString("Low"),this._energyImpactLabelElement.classList.add("low"),this._energyChart.value=0):e<=jt.lowEnergyThreshold?(this._energyImpactLabelElement.textContent=WI.UIString("Low"),this._energyImpactLabelElement.classList.add("low"),this._energyChart.value=i(e,0,jt.lowEnergyThreshold,0,jt.lowEnergyGraphBoundary,.85)):e<=jt.mediumEnergyThreshold?(this._energyImpactLabelElement.textContent=WI.UIString("Medium"),this._energyImpactLabelElement.classList.add("medium"),this._energyChart.value=i(e,jt.lowEnergyThreshold,jt.mediumEnergyThreshold,jt.lowEnergyGraphBoundary,jt.mediumEnergyGraphBoundary,.6)):e<jt.highEnergyThreshold?(this._energyImpactLabelElement.textContent=WI.UIString("High"),this._energyImpactLabelElement.classList.add("high"),this._energyChart.value=i(e,jt.mediumEnergyThreshold,jt.highEnergyThreshold,jt.mediumEnergyGraphBoundary,jt.highEnergyGraphBoundary,.9)):(this._energyImpactLabelElement.textContent=WI.UIString("Very High"),this._energyImpactLabelElement.classList.add("high"),this._energyChart.value=100),this._energyChart.needsLayout(),this._energyImpactNumberElement.textContent=WI.UIString("Average CPU: %s").format(Number.percentageString(e/100)),t<5)this._energyImpactDurationElement.textContent=WI.UIString("Duration: Short");else{let n=Math.floor(t);this._energyImpactDurationElement.textContent=WI.UIString("Duration: %ss","The duration of the Timeline recording in seconds (s).").format(n)}}_computeStatisticsData(e,t){function i(ve,Pe){let Be=ve.get(Pe);Be?ve.set(Pe,Be+1):ve.set(Pe,1)}let n=[],s=[],a=[],d=0,p=new Map,f=new Map,_=new Map,b=new Map,w=new Set,S=this._recording.timelineForRecordType(WI.TimelineRecord.Type.Script),E=S?S.recordsInTimeRange(e,t,{includeRecordBeforeStart:!0}):[];E=E.filter(ve=>{switch(ve.eventType){case WI.ScriptTimelineRecord.EventType.ScriptEvaluated:case WI.ScriptTimelineRecord.EventType.APIScriptEvaluated:return d++,!0;case WI.ScriptTimelineRecord.EventType.ObserverCallback:return i(_,ve.details),a.push(ve),d++,!0;case WI.ScriptTimelineRecord.EventType.EventDispatched:return i(f,ve.details),s.push(ve),d++,!0;case WI.ScriptTimelineRecord.EventType.MicrotaskDispatched:return!0;case WI.ScriptTimelineRecord.EventType.TimerFired:if(i(p,"setTimeout"),w.has(ve.details)){let Pe=b.get(ve.details);Pe?Pe.count+=1:b.set(ve.details,{record:ve,count:1})}else w.add(ve.details);return d++,!0;case WI.ScriptTimelineRecord.EventType.AnimationFrameFired:return i(p,"requestAnimationFrame"),d++,!0;case WI.ScriptTimelineRecord.EventType.AnimationFrameRequested:case WI.ScriptTimelineRecord.EventType.TimerInstalled:return n.push(ve),!1;case WI.ScriptTimelineRecord.EventType.AnimationFrameCanceled:case WI.ScriptTimelineRecord.EventType.TimerRemoved:case WI.ScriptTimelineRecord.EventType.ProbeSampleRecorded:case WI.ScriptTimelineRecord.EventType.ConsoleProfileRecorded:case WI.ScriptTimelineRecord.EventType.GarbageCollected:return!1;default:return console.error("Unhandled ScriptTimelineRecord.EventType",ve.eventType),!1}});let k=this._recording.timelineForRecordType(WI.TimelineRecord.Type.Layout),R=k?k.recordsInTimeRange(e,t,{includeRecordBeforeStart:!0}):[];R=R.filter(ve=>{switch(ve.eventType){case WI.LayoutTimelineRecord.EventType.RecalculateStyles:case WI.LayoutTimelineRecord.EventType.ForcedLayout:case WI.LayoutTimelineRecord.EventType.Layout:case WI.LayoutTimelineRecord.EventType.Paint:case WI.LayoutTimelineRecord.EventType.Composite:return!0;case WI.LayoutTimelineRecord.EventType.InvalidateStyles:case WI.LayoutTimelineRecord.EventType.InvalidateLayout:return!1;default:return console.error("Unhandled LayoutTimelineRecord.EventType",ve.eventType),!1}});let M=this._recording.timelineForRecordType(WI.TimelineRecord.Type.Network),V=(M?M.recordsInTimeRange(e,t):[]).length,H=Math.round(e*1e3),O=Math.round(t*1e3),z=O-H,K=new Array(z);function q(ve,Pe){for(let Be of ve){let qe=Math.round(Be.startTime*1e3),Ue=Math.round(Be.endTime*1e3);if(qe>O||Ue<H)continue;let Ge=qe-H;qe=Math.max(qe,H),Ue=Math.min(Ue,O);let it=Pe(Be);for(let lt=qe;lt<=Ue;++lt)K[lt-H]=it}}q(E,ve=>jt.SampleType.JavaScript),q(R,ve=>{switch(ve.eventType){case WI.LayoutTimelineRecord.EventType.RecalculateStyles:return jt.SampleType.Style;case WI.LayoutTimelineRecord.EventType.ForcedLayout:case WI.LayoutTimelineRecord.EventType.Layout:return jt.SampleType.Layout;case WI.LayoutTimelineRecord.EventType.Paint:case WI.LayoutTimelineRecord.EventType.Composite:return jt.SampleType.Paint}});let Y=0,se=0,ce=0,le=0,te=0;for(let ve=0;ve<K.length;++ve)switch(K[ve]){case void 0:Y++;break;case jt.SampleType.JavaScript:se++;break;case jt.SampleType.Layout:ce++;break;case jt.SampleType.Paint:le++;break;case jt.SampleType.Style:te++;break}return{samples:K,samplesIdle:Y,samplesScript:se,samplesLayout:ce,samplesPaint:le,samplesStyle:te,scriptEntries:d,networkRequests:V,timerTypes:p,eventTypes:f,observerTypes:_,timerInstallationRecords:n,eventHandlerRecords:s,observerCallbackRecords:a,repeatingTimers:b}}_removeWorkerThreadViews(){if(!!this._workerViews.length){for(let e of this._workerViews)this.removeSubview(e);this._workerViews=[]}}_resetSourcesFilters(){!this._sourcesFilter||(this._sourcesFilterRow.hidden=!0,this._sourcesFilterLabelElement.removeChildren(),this._timerInstallationsRow.hidden=!1,this._eventHandlersRow.hidden=!1,this._observerHandlersRow.hidden=!1,this._sourcesFilter.timer.clear(),this._sourcesFilter.event.clear(),this._sourcesFilter.observer.clear())}_addSourcesFilter(e,t){this._sourcesFilter[e].add(t),this._updateSourcesFilters()}_removeSourcesFilter(e,t){this._sourcesFilter[e].delete(t),this._updateSourcesFilters()}_updateSourcesFilters(){let e=this._sourcesFilter.timer,t=this._sourcesFilter.event,i=this._sourcesFilter.observer;if(!e.size&&!t.size&&!i.size){this._resetSourcesFilters();return}let n=(s,a)=>{let d=document.createElement("span");return d.className="filter active",d.textContent=a,d.addEventListener("mouseup",p=>{this._removeSourcesFilter(s,a),this._layoutStatisticsAndSources()}),d};this._sourcesFilterRow.hidden=!1,this._sourcesFilterLabelElement.removeChildren();for(let s of e)this._sourcesFilterLabelElement.appendChild(n("timer",s));for(let s of t)this._sourcesFilterLabelElement.appendChild(n("event",s));for(let s of i)this._sourcesFilterLabelElement.appendChild(n("observer",s));this._timerInstallationsRow.hidden=!e.size,this._eventHandlersRow.hidden=!t.size,this._observerHandlersRow.hidden=!i.size}_createTableRow(e){let t=e.appendChild(document.createElement("tr")),i=t.appendChild(document.createElement("th")),n=t.appendChild(document.createElement("td"));n.className="number";let s=t.appendChild(document.createElement("td"));return s.className="label",{row:t,headerCell:i,numberCell:n,labelCell:s}}_insertTableRow(e,t,{headerValue:i,numberValue:n,labelValue:s,followingRow:a}){let{row:d,headerCell:p,numberCell:f,labelCell:_}=this._createTableRow(e);return t.push(d),a&&e.insertBefore(d,a),i&&(p.textContent=i),n&&(f.textContent=n),s&&_.append(s),d}_clearStatistics(){this._networkRequestsNumberElement.textContent=emDash,this._scriptEntriesNumberElement.textContent=emDash;for(let e of this._statisticsRows)e.remove();this._statisticsRows=[]}_clearSources(){this._timerInstallationsNumberElement.textContent=emDash,this._timerInstallationsLabelElement.textContent="",this._eventHandlersNumberElement.textContent=emDash,this._eventHandlersLabelElement.textContent="",this._observerHandlersNumberElement.textContent=emDash,this._observerHandlersLabelElement.textContent="";for(let e of this._sourcesRows)e.remove();this._sourcesRows=[]}_clearEnergyImpactText(){this._energyImpactLabelElement.classList.remove("low","medium","high"),this._energyImpactLabelElement.textContent=emDash,this._energyImpactNumberElement.textContent="",this._energyImpactDurationElement.textContent=""}_clearBreakdownLegend(){this._breakdownLegendScriptElement.textContent=emDash,this._breakdownLegendLayoutElement.textContent=emDash,this._breakdownLegendPaintElement.textContent=emDash,this._breakdownLegendStyleElement.textContent=emDash,this._breakdownChart.centerElement.removeChildren()}_cpuTimelineRecordAdded(e){let t=e.data.record;console.assert(t instanceof WI.CPUTimelineRecord),t.startTime>=this.startTime&&t.endTime<=this.endTime&&this.needsLayout()}_graphPositionForMouseEvent(e){let t=e.target.closest(".area-chart, .stacked-area-chart, .range-chart");if(!t)return NaN;let i=t.getBoundingClientRect(),n=e.pageX-i.left;return WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?i.width-n:n}_handleIndicatorClick(e){let t=this._graphPositionForMouseEvent(e);if(isNaN(t))return;let i=this._timelineRuler.secondsPerPixel,n=t*i,a=this.startTime+n,d=a+i;if(e.target.localName==="rect"){if(this._attemptSelectIndicatatorTimelineRecord(a,d))return;console.assert(!1,"If the user clicked on a rect there should have been a record in this pixel range")}for(let p=1,f=0;p<=4;++p)if(f+=i,this._attemptSelectIndicatatorTimelineRecord(a-f,a)||this._attemptSelectIndicatatorTimelineRecord(d,d+f))return}_attemptSelectIndicatatorTimelineRecord(e,t){let i=this._recording.timelineForRecordType(WI.TimelineRecord.Type.Layout),n=i?i.recordsInTimeRange(e,t,{includeRecordBeforeStart:!0}):[];if(n=n.filter(d=>{switch(d.eventType){case WI.LayoutTimelineRecord.EventType.RecalculateStyles:case WI.LayoutTimelineRecord.EventType.ForcedLayout:case WI.LayoutTimelineRecord.EventType.Layout:case WI.LayoutTimelineRecord.EventType.Paint:case WI.LayoutTimelineRecord.EventType.Composite:return!0;case WI.LayoutTimelineRecord.EventType.InvalidateStyles:case WI.LayoutTimelineRecord.EventType.InvalidateLayout:return!1;default:return console.error("Unhandled LayoutTimelineRecord.EventType",d.eventType),!1}}),n.length)return this._selectTimelineRecord(n[0]),!0;let s=this._recording.timelineForRecordType(WI.TimelineRecord.Type.Script),a=s?s.recordsInTimeRange(e,t,{includeRecordBeforeStart:!0}):[];return a=a.filter(d=>{switch(d.eventType){case WI.ScriptTimelineRecord.EventType.ScriptEvaluated:case WI.ScriptTimelineRecord.EventType.APIScriptEvaluated:case WI.ScriptTimelineRecord.EventType.ObserverCallback:case WI.ScriptTimelineRecord.EventType.EventDispatched:case WI.ScriptTimelineRecord.EventType.MicrotaskDispatched:case WI.ScriptTimelineRecord.EventType.TimerFired:case WI.ScriptTimelineRecord.EventType.AnimationFrameFired:return!0;case WI.ScriptTimelineRecord.EventType.AnimationFrameRequested:case WI.ScriptTimelineRecord.EventType.AnimationFrameCanceled:case WI.ScriptTimelineRecord.EventType.TimerInstalled:case WI.ScriptTimelineRecord.EventType.TimerRemoved:case WI.ScriptTimelineRecord.EventType.ProbeSampleRecorded:case WI.ScriptTimelineRecord.EventType.ConsoleProfileRecorded:case WI.ScriptTimelineRecord.EventType.GarbageCollected:return!1;default:return console.error("Unhandled ScriptTimelineRecord.EventType",d.eventType),!1}}),a.length?(this._selectTimelineRecord(a[0]),!0):!1}_selectTimelineRecord(e){this.dispatchEventToListeners(WI.TimelineView.Event.RecordWasSelected,{record:e})}_handleGraphClick(e){let t=this._graphPositionForMouseEvent(e);isNaN(t)||(this._stickingOverlay=!this._stickingOverlay,this._stickingOverlay||this._handleGraphMouseMove(e))}_handleGraphMouseMove(e){let t=this._graphPositionForMouseEvent(e);if(isNaN(t)){this._hideGraphOverlay(),this.dispatchEventToListeners(WI.TimelineView.Event.ScannerHide);return}let i=this._timelineRuler.secondsPerPixel,n=this.startTime+t*i;this._stickingOverlay||this._showGraphOverlayNearTo(n),this.dispatchEventToListeners(WI.TimelineView.Event.ScannerShow,{time:n})}_showGraphOverlayNearTo(e){let t=null,i=1/0;for(let f of this._visibleRecordsInLayout){let _=Math.abs(e-f.timestamp);_<i&&(t=f,i=_)}if(!t){this._hideGraphOverlay();return}let n=t.timestamp;for(let{startTime:f,endTime:_}of this._discontinuitiesInLayout){let b=Math.abs(e-f);b<i&&(i=b,n=f),b=Math.abs(e-_),b<i&&(i=b,n=_)}let s=Math.min(this.endTime,this.currentTime),a=Math.abs(e-s);a<i&&(i=a,n=s);let d=this.startTime,p=Number.constrain(n,d,s);this._showGraphOverlay(t,p)}_updateGraphOverlay(){!this._overlayRecord||this._showGraphOverlay(this._overlayRecord,this._overlayTime,!0)}_showGraphOverlay(e,t,i){if(!i&&e===this._overlayRecord&&t===this._overlayTime)return;this._overlayRecord=e,this._overlayTime=t;let n=this._secondsPerPixelInLayout,s=this.startTime;this._overlayMarker.time=t+n/2;function a(E){return(E-s)/n}let d=a(t),{mainThreadUsage:p,workerThreadUsage:f,webkitThreadUsage:_,unknownThreadUsage:b,workersData:w}=e;function S(E,k,R,M){if(!M)return;let L=R*1.05;function V(H){return k-H/L*k}E.chart.addPointMarker(d,V(M)),E.chart.needsLayout()}if(this._clearOverlayMarkers(),this._cpuUsageView.updateLegend(e),S(this._cpuUsageView,jt.cpuUsageViewHeight,this._layoutMax,p),S(this._cpuUsageView,jt.cpuUsageViewHeight,this._layoutMax,p+f),S(this._cpuUsageView,jt.cpuUsageViewHeight,this._layoutMax,p+f+_+b),this._threadsDetailsElement.open){this._mainThreadUsageView.updateLegend(p),S(this._mainThreadUsageView,jt.threadCPUUsageViewHeight,this._threadLayoutMax,p),this._webkitThreadUsageView.updateLegend(_),S(this._webkitThreadUsageView,jt.threadCPUUsageViewHeight,this._threadLayoutMax,_),this._unknownThreadUsageView.updateLegend(b),S(this._unknownThreadUsageView,jt.threadCPUUsageViewHeight,this._threadLayoutMax,b);for(let E of this._workerViews)E.updateLegend(NaN);if(w)for(let{targetId:E,usage:k}of w){let R=this._workerViews.find(M=>M.__workerId===E);R&&(R.updateLegend(k),S(R,jt.threadCPUUsageViewHeight,this._threadLayoutMax,k))}}}_clearOverlayMarkers(){function e(t){t.clearLegend(),t.chart.clearPointMarkers(),t.chart.needsLayout()}e(this._cpuUsageView),e(this._mainThreadUsageView),e(this._webkitThreadUsageView),e(this._unknownThreadUsageView);for(let t of this._workerViews)e(t)}_hideGraphOverlay(){this._stickingOverlay||(this._overlayRecord=null,this._overlayTime=NaN,this._overlayMarker.time=-1,this._clearOverlayMarkers())}};WI.CPUTimelineView.LayoutReason={Internal:Symbol("cpu-timeline-view-internal-layout")};WI.CPUTimelineView.SampleType={JavaScript:"sample-type-javascript",Layout:"sample-type-layout",Paint:"sample-type-paint",Style:"sample-type-style"};WI.CPUUsageCombinedView=class extends WI.View{constructor(e){super(),this.element.classList.add("cpu-usage-combined-view"),this._detailsElement=this.element.appendChild(document.createElement("div")),this._detailsElement.classList.add("details");let t=this._detailsElement.appendChild(document.createElement("span"));t.classList.add("name"),t.textContent=e,this._detailsElement.appendChild(document.createElement("br")),this._detailsAverageElement=this._detailsElement.appendChild(document.createElement("span")),this._detailsElement.appendChild(document.createElement("br")),this._detailsMaxElement=this._detailsElement.appendChild(document.createElement("span")),this._detailsElement.appendChild(document.createElement("br")),this._detailsElement.appendChild(document.createElement("br")),this._updateDetails(NaN,NaN),this._graphElement=this.element.appendChild(document.createElement("div")),this._graphElement.classList.add("graph"),this._chart=new WI.StackedAreaChart,this._chart.initializeSections(["main-thread-usage","worker-thread-usage","total-usage"]),this.addSubview(this._chart),this._graphElement.appendChild(this._chart.element),this._rangeChart=new WI.RangeChart,this.addSubview(this._rangeChart),this._graphElement.appendChild(this._rangeChart.element);function i(n,s){let a=n.appendChild(document.createElement("div"));a.classList.add("row"),a.appendChild(document.createElement("div")).classList.add("swatch",s);let p=a.appendChild(document.createElement("div"));return p.classList.add("label"),p}this._legendElement=this._detailsElement.appendChild(document.createElement("div")),this._legendElement.classList.add("legend-container"),this._legendMainThreadElement=i(this._legendElement,"main-thread"),this._legendWorkerThreadsElement=i(this._legendElement,"worker-threads"),this._legendOtherThreadsElement=i(this._legendElement,"other-threads"),this._legendTotalThreadsElement=i(this._legendElement,"total"),this.clearLegend()}get graphElement(){return this._graphElement}get chart(){return this._chart}get rangeChart(){return this._rangeChart}clear(){this._cachedAverageSize=void 0,this._cachedMaxSize=void 0,this._updateDetails(NaN,NaN),this.clearLegend(),this._chart.clear(),this._chart.needsLayout(),this._rangeChart.clear(),this._rangeChart.needsLayout()}updateChart(e,t,i,n,s,a,d,p){if(console.assert(t instanceof WI.Size),console.assert(n>=0),console.assert(s>=0),console.assert(n<=s),console.assert(n<=a&&a<=s),this._updateDetails(s,a),this._chart.clearPoints(),this._chart.size=t,this._chart.needsLayout(),!e.length||!s)return;let f=0,_=p(e[0].mainThreadUsage),b=p(e[0].mainThreadUsage+e[0].workerThreadUsage),w=p(e[0].usage);this._chart.addPointSet(f,[_,b,w]);for(let L of e){let V=d(L.time),H=p(L.mainThreadUsage),O=p(L.mainThreadUsage+L.workerThreadUsage),z=p(L.usage);this._chart.addPointSet(V,[H,O,z])}let S=e.lastValue,E=Math.floor(d(i)),k=p(S.mainThreadUsage),R=p(S.mainThreadUsage+S.workerThreadUsage),M=p(S.usage);this._chart.addPointSet(E,[k,R,M])}updateMainThreadIndicator(e,t,i,n){if(console.assert(t instanceof WI.Size),this._rangeChart.clear(),this._rangeChart.size=t,this._rangeChart.needsLayout(),!e.length)return;let s=[],a=null,d;for(let p=0;p<e.length;++p){let f=e[p];if(!f){a&&(s.push(a),a=null,d=void 0);continue}if(f===d){a.endIndex=p;continue}d&&(s.push(a),a=null,d=void 0),console.assert(!a),console.assert(!d),a={type:f,startIndex:p,endIndex:p},d=f}for(let{type:p,startIndex:f,endIndex:_}of s){let b=n(f),S=n(_+1)-b;this._rangeChart.addRange(b,S,p)}}clearLegend(){this._legendMainThreadElement.textContent=WI.UIString("Main Thread"),this._legendWorkerThreadsElement.textContent=WI.UIString("Worker Threads"),this._legendOtherThreadsElement.textContent=WI.UIString("Other Threads"),this._legendTotalThreadsElement.textContent=""}updateLegend(e){if(!e){this.clearLegend();return}let{usage:t,mainThreadUsage:i,workerThreadUsage:n,webkitThreadUsage:s,unknownThreadUsage:a}=e;this._legendMainThreadElement.textContent=WI.UIString("Main: %s").format(Number.percentageString(i/100)),this._legendWorkerThreadsElement.textContent=WI.UIString("Worker: %s").format(Number.percentageString(n/100)),this._legendOtherThreadsElement.textContent=WI.UIString("Other: %s").format(Number.percentageString((s+a)/100)),this._legendTotalThreadsElement.textContent=WI.UIString("Total: %s").format(Number.percentageString(t/100))}_updateDetails(e,t){this._cachedMaxSize===e&&this._cachedAverageSize===t||(this._cachedAverageSize=t,this._cachedMaxSize=e,this._detailsAverageElement.textContent=WI.UIString("Average: %s").format(Number.isFinite(e)?Number.percentageString(t/100):emDash),this._detailsMaxElement.textContent=WI.UIString("Highest: %s").format(Number.isFinite(e)?Number.percentageString(e/100):emDash))}};WI.CPUUsageCombinedView._cachedMainThreadIndicatorFillColor=null;WI.CPUUsageCombinedView._cachedMainThreadIndicatorStrokeColor=null;WI.CPUUsageView=class extends WI.View{constructor(e){if(super(),this.element.classList.add("cpu-usage-view"),this._detailsElement=this.element.appendChild(document.createElement("div")),this._detailsElement.classList.add("details"),e){let t=this._detailsElement.appendChild(document.createElement("span"));t.classList.add("name"),t.textContent=e,e.length>=20&&(t.title=e),this._detailsElement.appendChild(document.createElement("br"))}this._detailsAverageElement=this._detailsElement.appendChild(document.createElement("span")),this._detailsElement.appendChild(document.createElement("br")),this._detailsUsageElement=this._detailsElement.appendChild(document.createElement("span")),this.clearLegend(),this._updateDetails(NaN),this._graphElement=this.element.appendChild(document.createElement("div")),this._graphElement.classList.add("graph"),this._chart=new WI.AreaChart,this.addSubview(this._chart),this._graphElement.appendChild(this._chart.element)}get graphElement(){return this._graphElement}get chart(){return this._chart}clear(){this._cachedAverageSize=void 0,this._updateDetails(NaN),this.clearLegend(),this._chart.clear(),this._chart.needsLayout()}updateChart(e,t,i,n,s,a,d,p,f){if(console.assert(t instanceof WI.Size),console.assert(n>=0),console.assert(s>=0),console.assert(n<=s),console.assert(n<=a&&a<=s),console.assert(f,"CPUUsageView needs a property of the dataPoints to graph"),this._updateDetails(a),this._chart.clearPoints(),this._chart.size=t,this._chart.needsLayout(),!e.length||!s)return;let _=0,b=p(e[0][f]);this._chart.addPoint(_,b);for(let k of e){let R=d(k.time),M=p(k[f]);this._chart.addPoint(R,M)}let w=e.lastValue,S=Math.floor(d(i)),E=p(w[f]);this._chart.addPoint(S,E)}clearLegend(){this._detailsUsageElement.hidden=!0,this._detailsUsageElement.textContent=emDash}updateLegend(e){let t=Number.isFinite(e)?Number.percentageString(e/100):emDash;this._detailsUsageElement.hidden=!1,this._detailsUsageElement.textContent=WI.UIString("Usage: %s").format(t)}_updateDetails(e){this._cachedAverageSize!==e&&(this._cachedAverageSize=e,this._detailsAverageElement.hidden=!Number.isFinite(e),this._detailsAverageElement.textContent=WI.UIString("Average: %s").format(Number.isFinite(e)?Number.percentageString(e/100):emDash))}};WI.CSSStyleSheetTreeElement=class extends WI.SourceCodeTreeElement{constructor(e){console.assert(e instanceof WI.CSSStyleSheet),console.assert(e.isInspectorStyleSheet()),super(e,["stylesheet","stylesheet-icon"],WI.UIString("Inspector Style Sheet"))}};WI.CallFrameTreeElement=class extends WI.GeneralTreeElement{constructor(e,t){console.assert(e instanceof WI.CallFrame);let i=WI.CallFrameView.iconClassNameForCallFrame(e),n=e.functionName||WI.UIString("(anonymous function)");const s=null;if(super(["call-frame",i],n,s,e),this._callFrame=e,this._isActiveCallFrame=!1,t&&(this.addClassName("async-boundary"),this.selectable=!1),this._callFrame.nativeCode||!this._callFrame.sourceCodeLocation){this.subtitle="",this.selectable=!1;return}this._callFrame.sourceCodeLocation.displaySourceCode.url&&(this.subtitle=document.createElement("span"),this._callFrame.sourceCodeLocation.populateLiveDisplayLocationString(this.subtitle,"textContent"),this.tooltipHandledSeparately=!0)}get callFrame(){return this._callFrame}get isActiveCallFrame(){return this._isActiveCallFrame}set isActiveCallFrame(e){this._isActiveCallFrame!==e&&(this._isActiveCallFrame=e,this._updateStatus())}onattach(){if(super.onattach(),console.assert(this.element),this.tooltipHandledSeparately){let e="";this._callFrame.isTailDeleted&&(e=" "+WI.UIString("(Tail Call)"));let t=this.mainTitle+e+`
`;this._callFrame.sourceCodeLocation.populateLiveDisplayLocationTooltip(this.element,t)}this._updateStatus()}_updateStatus(){if(!!this.element){if(!this._isActiveCallFrame){this.status=null;return}this._statusImageElement||(this._statusImageElement=WI.ImageUtilities.useSVGSymbol("data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2016 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath d='M 4 15.5 L 0.5 15.5 L 0.5 0.5 L 4 0.5 L 7 7.5 Z'/%3e %3c/svg%3e","status-image")),this.status=this._statusImageElement}}};WI.CallFrameView=class extends WI.Object{constructor(e,t){console.assert(e instanceof WI.CallFrame);var i=document.createElement("div");i.classList.add("call-frame",WI.CallFrameView.iconClassNameForCallFrame(e));var n=document.createElement("span");n.classList.add("subtitle");var s=e.sourceCodeLocation;if(s){WI.linkifyElement(i,s,{ignoreNetworkTab:!0,ignoreSearchTab:!0});var a=document.createElement("a");if(a.classList.add("source-link"),a.href=s.sourceCode.url,t){var d=document.createElement("span");d.classList.add("separator"),d.textContent=` ${emDash} `,n.append(d)}n.append(a),s.populateLiveDisplayLocationTooltip(a),s.populateLiveDisplayLocationString(a,"textContent")}var p=document.createElement("span");if(p.classList.add("title"),t){var f=document.createElement("img");f.classList.add("icon"),p.append(f,e.functionName||WI.UIString("(anonymous function)"))}return i.append(p,n),i}static iconClassNameForCallFrame(e){return e.isTailDeleted?WI.CallFrameView.TailDeletedIcon:e.programCode?WI.CallFrameView.ProgramIconStyleClassName:e.functionName&&e.functionName.startsWith("on")&&e.functionName.length>=5?WI.CallFrameView.EventListenerIconStyleClassName:e.nativeCode?WI.CallFrameView.NativeIconStyleClassName:WI.CallFrameView.FunctionIconStyleClassName}};WI.CallFrameView.ProgramIconStyleClassName="program-icon";WI.CallFrameView.FunctionIconStyleClassName="function-icon";WI.CallFrameView.EventListenerIconStyleClassName="event-listener-icon";WI.CallFrameView.NativeIconStyleClassName="native-icon";WI.CallFrameView.TailDeletedIcon="tail-deleted";WI.CanvasContentView=class extends WI.ContentView{constructor(e){console.assert(e instanceof WI.Canvas),super(e),this.element.classList.add("canvas"),this._progressView=null,this._previewContainerElement=null,this._previewImageElement=null,this._errorElement=null,this._memoryCostElement=null,this._pendingContent=null,this._pixelSize=null,this._pixelSizeElement=null,this._canvasNode=null,this._refreshButtonNavigationItem=new WI.ButtonNavigationItem("refresh",WI.UIString("Refresh"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='1 1 13 13'%3e %3cpath fill='currentColor' d='M 12.007 8.01 L 12.007 8.488 L 12 8.488 C 12 10.974 9.985 12.988 7.5 12.988 C 5.015 12.988 3 10.974 3 8.488 C 3 6.17 4.759 4.284 7.012 4.037 L 7.012 6.549 L 11.519 3.775 L 7.012 1 L 7.012 3.013 C 4.203 3.26 2 5.615 2 8.488 C 2 11.526 4.462 13.988 7.5 13.988 C 10.509 13.988 12.95 11.571 12.996 8.572 L 13 8.572 L 13 8.01 L 12.007 8.01 Z'/%3e %3c/svg%3e",13,13),this._refreshButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._refreshButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this.refreshPreview,this),this._showGridButtonNavigationItem=new WI.ActivateButtonNavigationItem("show-grid",WI.UIString("Show Grid"),WI.UIString("Hide Grid"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 13'%3e %3crect fill='none' stroke='currentColor' stroke-width='1' x='0.5' y='0.5' width='12' height='12'/%3e %3crect fill='currentColor' opacity='0.5' x='1' y='1' width='5.5' height='5.5'/%3e %3crect fill='currentColor' opacity='0.5' x='6.5' y='6.5' width='5.5' height='5.5'/%3e %3c/svg%3e",13,13),this._showGridButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._showGridButtonClicked,this),this._showGridButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._showGridButtonNavigationItem.activated=!!WI.settings.showImageGrid.value}get navigationItems(){return[this._refreshButtonNavigationItem,this._showGridButtonNavigationItem]}refreshPreview(){this._pendingContent=null,this.representedObject.requestContent().then(e=>{if(this._pendingContent=e,!this._pendingContent){this._showError();return}this.needsLayout()})}initialLayout(){super.initialLayout();let e=!this._refreshButtonNavigationItem.parentNavigationBar;if(e){let t=this.element.appendChild(document.createElement("header"));t.addEventListener("click",p=>{p.stopPropagation()});let i=t.appendChild(document.createElement("div"));i.className="titles";let n=i.appendChild(document.createElement("span"));n.className="title",n.textContent=this.representedObject.displayName;let s=i.appendChild(document.createElement("span"));s.className="subtitle",s.textContent=WI.Canvas.displayNameForContextType(this.representedObject.contextType);let a=new WI.NavigationBar;if(this.representedObject.contextType===WI.Canvas.ContextType.Canvas2D||this.representedObject.contextType===WI.Canvas.ContextType.BitmapRenderer||this.representedObject.contextType===WI.Canvas.ContextType.WebGL||this.representedObject.contextType===WI.Canvas.ContextType.WebGL2){const p=WI.UIString(`Start recording canvas actions.
Shift-click to record a single frame.`),f=WI.UIString("Stop recording canvas actions");this._recordButtonNavigationItem=new WI.ToggleButtonNavigationItem("record-start-stop",p,f,"data:image/svg+xml,%3c%3fxml version='1.0'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 13'%3e %3ccircle fill='red' cx='6.5' cy='6.5' r='6'/%3e %3c/svg%3e","data:image/svg+xml,%3c%3fxml version='1.0'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 13'%3e %3crect fill='currentColor' x='1' y='1' width='11' height='11'/%3e %3c/svg%3e",13,13),this._recordButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.High,this._recordButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._toggleRecording,this),a.addNavigationItem(this._recordButtonNavigationItem)}let d=new WI.ButtonNavigationItem("canvas-element",WI.UIString("Canvas Element"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2018 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='currentColor' d='M 15.5 8 a 0.5 0.5 0 0 1 -0.24 0.43 L 11 10.99 V 9.82 L 14.03 8 11 6.18 V 5.01 l 4.26 2.56 A 0.5 0.5 0 0 1 15.5 8 Z'/%3e %3cpolygon fill='currentColor' points='10.77 3 6.32 13 5.23 13 9.68 3 10.77 3'/%3e %3cpath fill='currentColor' d='M 5 6.18 1.97 8 5 9.82 v 1.17 L 0.74 8.43 a 0.505 0.505 0 0 1 0 -0.86 L 5 5.01 Z'/%3e %3c/svg%3e",16,16);d.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,d.element.addEventListener("mousedown",this._handleCanvasElementButtonMouseDown.bind(this)),a.addNavigationItem(d),a.addNavigationItem(this._refreshButtonNavigationItem),t.append(a.element)}if(this._previewContainerElement=this.element.appendChild(document.createElement("div")),this._previewContainerElement.className="preview",e){let t=this.element.appendChild(document.createElement("footer"));t.addEventListener("click",s=>{s.stopPropagation()}),this._viewRelatedItemsContainer=t.appendChild(document.createElement("div")),this._viewRelatedItemsContainer.classList.add("view-related-items"),this._viewShaderButton=document.createElement("img"),this._viewShaderButton.classList.add("view-shader"),this._viewShaderButton.title=WI.UIString("View Shader"),this._viewShaderButton.addEventListener("mousedown",this._handleViewShaderButtonMouseDown.bind(this)),this._viewRecordingButton=document.createElement("img"),this._viewRecordingButton.classList.add("view-recording"),this._viewRecordingButton.title=WI.UIString("View Recording"),this._viewRecordingButton.addEventListener("mousedown",this._handleViewRecordingButtonMouseDown.bind(this)),this._updateViewRelatedItems();let i=t.appendChild(document.createElement("div"));i.className="flexible-space";let n=t.appendChild(document.createElement("div"));this._pixelSizeElement=n.appendChild(document.createElement("span")),this._pixelSizeElement.className="pixel-size",this._memoryCostElement=n.appendChild(document.createElement("span")),this._memoryCostElement.className="memory-cost"}this._errorElement&&this._showError(),e&&this._refreshPixelSize()}layout(){super.layout(),this._pendingContent&&(this._errorElement&&(this._errorElement.remove(),this._errorElement=null),this._previewImageElement||(this._previewImageElement=document.createElement("img"),this._previewImageElement.addEventListener("error",this._showError.bind(this))),this._previewImageElement.src=this._pendingContent,this._pendingContent=null,this._previewImageElement.parentNode||this._previewContainerElement.appendChild(this._previewImageElement)),this._updateRecordNavigationItem(),this._updateProgressView(),this._updateViewRelatedItems(),this._updateMemoryCost(),this._updateImageGrid()}shown(){super.shown(),this.refreshPreview()}attached(){super.attached(),this.representedObject.addEventListener(WI.Canvas.Event.MemoryChanged,this._updateMemoryCost,this),this.representedObject.addEventListener(WI.Canvas.Event.RecordingStarted,this.needsLayout,this),this.representedObject.addEventListener(WI.Canvas.Event.RecordingProgress,this.needsLayout,this),this.representedObject.addEventListener(WI.Canvas.Event.RecordingStopped,this.needsLayout,this),this.representedObject.shaderProgramCollection.addEventListener(WI.Collection.Event.ItemAdded,this.needsLayout,this),this.representedObject.shaderProgramCollection.addEventListener(WI.Collection.Event.ItemRemoved,this.needsLayout,this),this.representedObject.requestNode().then(e=>{console.assert(!this._canvasNode||this._canvasNode===e),this._canvasNode!==e&&(this._canvasNode=e,this._canvasNode.addEventListener(WI.DOMNode.Event.AttributeModified,this._refreshPixelSize,this),this._canvasNode.addEventListener(WI.DOMNode.Event.AttributeRemoved,this._refreshPixelSize,this))}),WI.settings.showImageGrid.addEventListener(WI.Setting.Event.Changed,this._updateImageGrid,this)}detached(){this.representedObject.removeEventListener(null,null,this),this.representedObject.shaderProgramCollection.removeEventListener(null,null,this),this._canvasNode&&(this._canvasNode.removeEventListener(null,null,this),this._canvasNode=null),WI.settings.showImageGrid.removeEventListener(null,null,this),super.detached()}_showError(){this._previewImageElement&&this._previewImageElement.remove(),this._errorElement||(this._errorElement=WI.createMessageTextView(WI.UIString("No Preview Available"),!0)),this._previewContainerElement&&this._previewContainerElement.appendChild(this._errorElement)}_toggleRecording(e){if(this.representedObject.recordingActive)this.representedObject.stopRecording();else{let t=e.data.nativeEvent.shiftKey;this.representedObject.startRecording(t)}}_refreshPixelSize(){let e=t=>{Object.shallowEqual(this._pixelSize,t)||(this._pixelSize=t,this._pixelSizeElement&&(this._pixelSize?this._pixelSizeElement.textContent=`${this._pixelSize.width} ${multiplicationSign} ${this._pixelSize.height}`:this._pixelSizeElement.textContent=emDash),this.refreshPreview())};this.representedObject.requestSize().then(t=>{e(t)}).catch(t=>{e(null)})}_handleCanvasElementButtonMouseDown(e){if(this._ignoreCanvasElementButtonMouseDown)return;this._ignoreCanvasElementButtonMouseDown=!0;let t=WI.ContextMenu.createFromEvent(e);t.addBeforeShowCallback(()=>{this._ignoreCanvasElementButtonMouseDown=!1}),this._canvasNode&&WI.appendContextMenuItemsForDOMNode(t,this._canvasNode),t.appendSeparator(),t.appendItem(WI.UIString("Log Canvas Context"),()=>{WI.RemoteObject.resolveCanvasContext(this.representedObject,WI.RuntimeManager.ConsoleObjectGroup,i=>{if(!i)return;const n=WI.UIString("Selected Canvas Context"),s=!0;WI.consoleLogViewController.appendImmediateExecutionWithResult(n,i,s)})}),t.show()}_showGridButtonClicked(){WI.settings.showImageGrid.value=!this._showGridButtonNavigationItem.activated}_updateImageGrid(){let e=WI.settings.showImageGrid.value;this._showGridButtonNavigationItem.activated=e,this._previewImageElement&&this._previewImageElement.classList.toggle("show-grid",e)}_updateMemoryCost(){if(!this._memoryCostElement)return;let e=this.representedObject.memoryCost;if(isNaN(e))this._memoryCostElement.textContent=emDash;else{let i=Number.bytesToString(e,!1);this._memoryCostElement.textContent=`(${i})`}}_updateRecordNavigationItem(){if(!this._recordButtonNavigationItem)return;let e=this.representedObject.recordingActive;this._recordButtonNavigationItem.toggled=e,this._refreshButtonNavigationItem.enabled=!e,this.element.classList.toggle("recording-active",e)}_updateProgressView(){if(!this._previewContainerElement)return;if(!this.representedObject.recordingActive){this._progressView&&this._progressView.parentView&&(this.removeSubview(this._progressView),this._progressView=null);return}this._progressView||(this._progressView=new WI.ProgressView,this.element.insertBefore(this._progressView.element,this._previewContainerElement),this.addSubview(this._progressView));let e=null;this.representedObject.recordingFrameCount?e=(this.representedObject.recordingFrameCount===1?WI.UIString("%d Frame"):WI.UIString("%d Frames")).format(this.representedObject.recordingFrameCount):e=WI.UIString("Waiting for frames\u2026"),this._progressView.title=e,this._progressView.subtitle=this.representedObject.recordingBufferUsed?Number.bytesToString(this.representedObject.recordingBufferUsed):""}_updateViewRelatedItems(){!this._viewRelatedItemsContainer||(this._viewRelatedItemsContainer.removeChildren(),this.representedObject.shaderProgramCollection.size&&this._viewRelatedItemsContainer.appendChild(this._viewShaderButton),this.representedObject.recordingCollection.size&&this._viewRelatedItemsContainer.appendChild(this._viewRecordingButton))}_handleViewShaderButtonMouseDown(e){if(this._ignoreViewShaderButtonMouseDown)return;let t=this.representedObject.shaderProgramCollection;if(console.assert(t.size),!t.size)return;if(t.size===1){WI.showRepresentedObject(Array.from(t)[0]);return}this._ignoreViewShaderButtonMouseDown=!0;let i=WI.ContextMenu.createFromEvent(e);i.addBeforeShowCallback(()=>{this._ignoreViewShaderButtonMouseDown=!1});for(let n of t)i.appendItem(n.displayName,()=>{WI.showRepresentedObject(n)});i.show()}_handleViewRecordingButtonMouseDown(e){if(this._ignoreViewRecordingButtonMouseDown)return;let t=this.representedObject.recordingCollection;if(console.assert(t.size),!t.size)return;if(t.size===1){WI.showRepresentedObject(Array.from(t)[0]);return}this._ignoreViewRecordingButtonMouseDown=!0;let i=WI.ContextMenu.createFromEvent(e);i.addBeforeShowCallback(()=>{this._ignoreViewRecordingButtonMouseDown=!1});for(let n of t)i.appendItem(n.displayName,()=>{WI.showRepresentedObject(n)});i.show()}};WI.CanvasDetailsSidebarPanel=class extends WI.DetailsSidebarPanel{constructor(){super("canvas",WI.UIString("Canvas")),this.element.classList.add("canvas"),this._canvas=null,this._node=null,this._sections=[],this._emptyContentPlaceholder=null}inspect(e){return e instanceof Array||(e=[e]),e=e.map(t=>t instanceof WI.Recording?t.source:t instanceof WI.ShaderProgram?t.canvas:t),this.canvas=e.find(t=>t instanceof WI.Canvas),!!this.canvas}get canvas(){return this._canvas}set canvas(e){e!==this._canvas&&(this._node&&(this._node.removeEventListener(WI.DOMNode.Event.AttributeModified,this._refreshSourceSection,this),this._node.removeEventListener(WI.DOMNode.Event.AttributeRemoved,this._refreshSourceSection,this),this._node=null),this._canvas&&(this._canvas.removeEventListener(WI.Canvas.Event.MemoryChanged,this._canvasMemoryChanged,this),this._canvas.removeEventListener(WI.Canvas.Event.ExtensionEnabled,this._refreshExtensionsSection,this),this._canvas.removeEventListener(WI.Canvas.Event.CSSCanvasClientNodesChanged,this._refreshCSSCanvasSection,this)),this._canvas=e||null,this._canvas&&(this._canvas.addEventListener(WI.Canvas.Event.MemoryChanged,this._canvasMemoryChanged,this),this._canvas.addEventListener(WI.Canvas.Event.ExtensionEnabled,this._refreshExtensionsSection,this),this._canvas.addEventListener(WI.Canvas.Event.CSSCanvasClientNodesChanged,this._refreshCSSCanvasSection,this)),this.needsLayout())}initialLayout(){super.initialLayout(),this._nameRow=new WI.DetailsSectionSimpleRow(WI.UIString("Name")),this._typeRow=new WI.DetailsSectionSimpleRow(WI.UIString("Type")),this._memoryRow=new WI.DetailsSectionSimpleRow(WI.UIString("Memory")),this._memoryRow.tooltip=WI.UIString("Memory usage of this canvas");let e=new WI.DetailsSection("canvas-details",WI.UIString("Identity"));e.groups=[new WI.DetailsSectionGroup([this._nameRow,this._typeRow,this._memoryRow])],this._sections.push(e),this._nodeRow=new WI.DetailsSectionSimpleRow(WI.UIString("Node")),this._cssCanvasRow=new WI.DetailsSectionSimpleRow(WI.UIString("CSS Canvas")),this._widthRow=new WI.DetailsSectionSimpleRow(WI.UIString("Width")),this._heightRow=new WI.DetailsSectionSimpleRow(WI.UIString("Height")),this._datachedRow=new WI.DetailsSectionSimpleRow(WI.UIString("Detached"));let t=new WI.DetailsSection("canvas-source",WI.UIString("Source"));t.groups=[new WI.DetailsSectionGroup([this._nodeRow,this._cssCanvasRow,this._widthRow,this._heightRow,this._datachedRow])],this._sections.push(t),this._attributesDataGridRow=new WI.DetailsSectionDataGridRow(null,WI.UIString("No Attributes")),this._attributesSection=new WI.DetailsSection("canvas-attributes",WI.UIString("Attributes")),this._attributesSection.groups=[new WI.DetailsSectionGroup([this._attributesDataGridRow])],this._attributesSection.element.hidden=!0,this._sections.push(this._attributesSection),this._extensionsSection=new WI.DetailsSection("canvas-extensions",WI.UIString("Extensions")),this._extensionsSection.element.hidden=!0,this._sections.push(this._extensionsSection),this._cssCanvasClientsRow=new WI.DetailsSectionSimpleRow(WI.UIString("Nodes")),this._cssCanvasSection=new WI.DetailsSection("canvas-css",WI.UIString("CSS")),this._cssCanvasSection.groups=[new WI.DetailsSectionGroup([this._cssCanvasClientsRow])],this._cssCanvasSection.element.hidden=!0,this._sections.push(this._cssCanvasSection);const i=!1;let n=new WI.TreeOutline(i);n.disclosureButtons=!1,this._backtraceTreeController=new WI.CallFrameTreeController(n);let s=new WI.DetailsSectionRow;s.element.appendChild(n.element),this._backtraceSection=new WI.DetailsSection("canvas-backtrace",WI.UIString("Backtrace")),this._backtraceSection.groups=[new WI.DetailsSectionGroup([s])],this._backtraceSection.element.hidden=!0,this._sections.push(this._backtraceSection),this._emptyContentPlaceholder=WI.createMessageTextView(WI.UIString("No Canvas Selected"))}layout(){if(super.layout(),this.contentView.element.removeChildren(),!this._canvas){this.contentView.element.appendChild(this._emptyContentPlaceholder);return}this.contentView.element.append(...this._sections.map(e=>e.element)),this._refreshIdentitySection(),this._refreshSourceSection(),this._refreshAttributesSection(),this._refreshExtensionsSection(),this._refreshCSSCanvasSection(),this._refreshBacktraceSection()}sizeDidChange(){super.sizeDidChange(),this._attributesDataGridRow.sizeDidChange()}_refreshIdentitySection(){this._nameRow.value=this._canvas.displayName,this._typeRow.value=WI.Canvas.displayNameForContextType(this._canvas.contextType),this._formatMemoryRow()}_refreshSourceSection(){!this.didInitialLayout||(this._nodeRow.value=this._canvas.cssCanvasName?null:emDash,this._cssCanvasRow.value=this._canvas.cssCanvasName||null,this._widthRow.value=emDash,this._heightRow.value=emDash,this._datachedRow.value=null,this._canvas.requestNode().then(e=>{e!==this._node&&(this._node&&(this._node.removeEventListener(WI.DOMNode.Event.AttributeModified,this._refreshSourceSection,this),this._node.removeEventListener(WI.DOMNode.Event.AttributeRemoved,this._refreshSourceSection,this),this._node=null),this._node=e,this._node.addEventListener(WI.DOMNode.Event.AttributeModified,this._refreshSourceSection,this),this._node.addEventListener(WI.DOMNode.Event.AttributeRemoved,this._refreshSourceSection,this)),this._canvas.cssCanvasName||(this._nodeRow.value=WI.linkifyNodeReference(this._node));let t=(s,a)=>{let d=Number(this._node.getAttribute(a));return!Number.isInteger(d)||d<0?!1:(s.value=d,!0)},i=t(this._widthRow,"width"),n=t(this._heightRow,"height");(!i||!n)&&WI.RemoteObject.resolveNode(e).then(s=>{function a(d,p){s.getProperty(p,(f,_,b)=>{!f&&_.type==="number"&&(d.value=`${_.value}px`)})}a(this._widthRow,"width"),a(this._heightRow,"height"),s.release()}),!this._canvas.cssCanvasName&&!this._node.parentNode&&(this._datachedRow.value=WI.UIString("Yes"))}))}_refreshAttributesSection(){let e=!isEmptyObject(this._canvas.contextAttributes);if(this._attributesSection.element.hidden=!e,!e)return;let t=this._attributesDataGridRow.dataGrid;t||(t=this._attributesDataGridRow.dataGrid=new WI.DataGrid({name:{title:WI.UIString("Name")},value:{title:WI.UIString("Value"),width:"30%"}})),t.removeChildren();for(let i in this._canvas.contextAttributes){let n={name:i,value:this._canvas.contextAttributes[i]},s=new WI.DataGridNode(n);t.appendChild(s)}t.updateLayoutIfNeeded()}_refreshExtensionsSection(){let e=this._canvas.extensions.size>0;if(this._extensionsSection.element.hidden=!e,!e)return;let t=document.createElement("ul");for(let i of this._canvas.extensions){let n=t.appendChild(document.createElement("li"));n.textContent=i}this._extensionsSection.groups=[{element:t}]}_refreshCSSCanvasSection(){if(!!this.didInitialLayout){if(!this._canvas.cssCanvasName){this._cssCanvasSection.element.hidden=!0;return}this._cssCanvasClientsRow.value=emDash,this._cssCanvasSection.element.hidden=!1,this._canvas.requestCSSCanvasClientNodes(e=>{if(!e.length)return;let t=document.createDocumentFragment();for(let i of e)t.appendChild(WI.linkifyNodeReference(i));this._cssCanvasClientsRow.value=t})}}_refreshBacktraceSection(){let e=this._canvas.backtrace;this._backtraceTreeController.callFrames=e,this._backtraceSection.element.hidden=!e.length}_formatMemoryRow(){if(!!this.didInitialLayout){if(!this._canvas.memoryCost||isNaN(this._canvas.memoryCost)){this._memoryRow.value=emDash;return}this._memoryRow.value=Number.bytesToString(this._canvas.memoryCost)}}_canvasMemoryChanged(e){this._formatMemoryRow()}};WI.CanvasOverviewContentView=class Bu extends WI.CollectionContentView{constructor(e){console.assert(e instanceof WI.CanvasCollection);let t=WI.createMessageTextView(WI.UIString("No Canvas Contexts")),i=t.appendChild(document.createElement("div"));i.className="description",i.textContent=WI.UIString("Waiting for canvas contexts created by script or CSS.");let n=new WI.ButtonNavigationItem("import-recording",WI.UIString("Import"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' d='M 7.5 8.5 V 1'/%3e %3cpath fill='none' stroke='currentColor' d='M 10.5 5.5 l -3%2c 3 l -3 -3'/%3e %3cpolyline fill='none' stroke='currentColor' points='12.5 9 12.5 12.5 2.5 12.5 2.5 9'/%3e %3c/svg%3e",15,15);n.buttonStyle=WI.ButtonNavigationItem.Style.ImageAndText;let s=WI.createNavigationItemHelp(WI.UIString("Press %s to load a recording from file."),n);if(t.appendChild(s),super(e,WI.CanvasContentView,t),this.element.classList.add("canvas-overview"),WI.CanvasManager.supportsRecordingAutoCapture()){this._recordingAutoCaptureFrameCountInputElement=document.createElement("input"),this._recordingAutoCaptureFrameCountInputElement.type="number",this._recordingAutoCaptureFrameCountInputElement.min=0,this._recordingAutoCaptureFrameCountInputElement.style.setProperty("--recording-auto-capture-input-margin",Bu.recordingAutoCaptureInputMargin+"px"),this._recordingAutoCaptureFrameCountInputElement.addEventListener("input",this._handleRecordingAutoCaptureInput.bind(this)),this._recordingAutoCaptureFrameCountInputElementValue=WI.settings.canvasRecordingAutoCaptureFrameCount.value;const a=null;this._recordingAutoCaptureNavigationItem=new WI.CheckboxNavigationItem("canvas-recording-auto-capture",a,!!WI.settings.canvasRecordingAutoCaptureEnabled.value),this._recordingAutoCaptureNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._recordingAutoCaptureNavigationItem.addEventListener(WI.CheckboxNavigationItem.Event.CheckedDidChange,this._handleRecordingAutoCaptureCheckedDidChange,this);let d=this._updateRecordingAutoCaptureInputElementSize();this._setRecordingAutoCaptureFrameCount(d),this._updateRecordingAutoCaptureCheckboxLabel(d)}this._importButtonNavigationItem=new WI.ButtonNavigationItem("import-recording",WI.UIString("Import"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' d='M 7.5 8.5 V 1'/%3e %3cpath fill='none' stroke='currentColor' d='M 10.5 5.5 l -3%2c 3 l -3 -3'/%3e %3cpolyline fill='none' stroke='currentColor' points='12.5 9 12.5 12.5 2.5 12.5 2.5 9'/%3e %3c/svg%3e",15,15),this._importButtonNavigationItem.tooltip=WI.UIString("Import"),this._importButtonNavigationItem.buttonStyle=WI.ButtonNavigationItem.Style.ImageAndText,this._refreshButtonNavigationItem=new WI.ButtonNavigationItem("refresh-all",WI.UIString("Refresh all"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='1 1 13 13'%3e %3cpath fill='currentColor' d='M 12.007 8.01 L 12.007 8.488 L 12 8.488 C 12 10.974 9.985 12.988 7.5 12.988 C 5.015 12.988 3 10.974 3 8.488 C 3 6.17 4.759 4.284 7.012 4.037 L 7.012 6.549 L 11.519 3.775 L 7.012 1 L 7.012 3.013 C 4.203 3.26 2 5.615 2 8.488 C 2 11.526 4.462 13.988 7.5 13.988 C 10.509 13.988 12.95 11.571 12.996 8.572 L 13 8.572 L 13 8.01 L 12.007 8.01 Z'/%3e %3c/svg%3e",13,13),this._refreshButtonNavigationItem.enabled=!1,this._refreshButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._refreshPreviews,this),this._showGridButtonNavigationItem=new WI.ActivateButtonNavigationItem("show-grid",WI.UIString("Show transparency grid"),WI.UIString("Hide Grid"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 13'%3e %3crect fill='none' stroke='currentColor' stroke-width='1' x='0.5' y='0.5' width='12' height='12'/%3e %3crect fill='currentColor' opacity='0.5' x='1' y='1' width='5.5' height='5.5'/%3e %3crect fill='currentColor' opacity='0.5' x='6.5' y='6.5' width='5.5' height='5.5'/%3e %3c/svg%3e",13,13),this._showGridButtonNavigationItem.activated=!!WI.settings.showImageGrid.value,this._showGridButtonNavigationItem.enabled=!1,this._showGridButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._showGridButtonClicked,this),n.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._handleImportButtonNavigationItemClicked,this),this._importButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._handleImportButtonNavigationItemClicked,this),this._savedRecordingsContentView=null,this._savedRecordingsTreeOutline=null}static get recordingAutoCaptureInputMargin(){return 4}get navigationItems(){let e=[this._importButtonNavigationItem,new WI.DividerNavigationItem,this._refreshButtonNavigationItem,this._showGridButtonNavigationItem];return WI.CanvasManager.supportsRecordingAutoCapture()&&e.unshift(this._recordingAutoCaptureNavigationItem,new WI.DividerNavigationItem),e}hidden(){WI.domManager.hideDOMNodeHighlight(),super.hidden()}contentViewAdded(e){e.element.addEventListener("mouseenter",this._contentViewMouseEnter),e.element.addEventListener("mouseleave",this._contentViewMouseLeave),this._savedRecordingsContentView&&(this.removeSubview(this._savedRecordingsContentView),this.addSubview(this._savedRecordingsContentView)),this._updateNavigationItems()}contentViewRemoved(e){e.element.removeEventListener("mouseenter",this._contentViewMouseEnter),e.element.removeEventListener("mouseleave",this._contentViewMouseLeave),this._updateNavigationItems()}attached(){super.attached(),WI.settings.showImageGrid.addEventListener(WI.Setting.Event.Changed,this._updateShowImageGrid,this),WI.settings.canvasRecordingAutoCaptureEnabled.addEventListener(WI.Setting.Event.Changed,this._handleCanvasRecordingAutoCaptureEnabledChanged,this),WI.settings.canvasRecordingAutoCaptureFrameCount.addEventListener(WI.Setting.Event.Changed,this._handleCanvasRecordingAutoCaptureFrameCountChanged,this),WI.canvasManager.addEventListener(WI.CanvasManager.Event.RecordingSaved,this._handleRecordingSaved,this),this._savedRecordingsTreeOutline&&this._savedRecordingsTreeOutline.removeChildren();for(let e of WI.canvasManager.savedRecordings)this._addSavedRecording(e)}detached(){WI.canvasManager.removeEventListener(null,null,this),WI.settings.canvasRecordingAutoCaptureFrameCount.removeEventListener(null,null,this),WI.settings.canvasRecordingAutoCaptureEnabled.removeEventListener(null,null,this),WI.settings.showImageGrid.removeEventListener(null,null,this),super.detached()}get _itemMargin(){return parseInt(window.getComputedStyle(this.element).getPropertyValue("--item-margin"))}_refreshPreviews(){for(let e of this.subviews)e.refreshPreview()}_updateNavigationItems(){let e=!!this.representedObject.size;this._refreshButtonNavigationItem.enabled=e,this._showGridButtonNavigationItem.enabled=e}_showGridButtonClicked(e){WI.settings.showImageGrid.value=!this._showGridButtonNavigationItem.activated}_updateShowImageGrid(){this._showGridButtonNavigationItem.activated=!!WI.settings.showImageGrid.value}_contentViewMouseEnter(e){let t=WI.View.fromElement(e.target);if(!(t instanceof WI.CanvasContentView))return;let i=t.representedObject;if(i.cssCanvasName){i.requestCSSCanvasClientNodes(n=>{WI.domManager.highlightDOMNodeList(n.map(s=>s.id))});return}i.requestNode().then(n=>{!n||!n.ownerDocument||WI.domManager.highlightDOMNode(n.id)})}_contentViewMouseLeave(e){WI.domManager.hideDOMNodeHighlight()}_setRecordingAutoCaptureFrameCount(e){console.assert(!isNaN(e)&&e>=0),this._recordingAutoCaptureNavigationItem.checked&&(e=Math.max(1,e));let t=e>0&&!!this._recordingAutoCaptureNavigationItem.checked;WI.canvasManager.setRecordingAutoCaptureFrameCount(t,e)}_updateRecordingAutoCaptureCheckboxLabel(e){let t=document.activeElement===this._recordingAutoCaptureFrameCountInputElement,i=this._recordingAutoCaptureFrameCountInputElement.selectionStart,n=this._recordingAutoCaptureFrameCountInputElement.selectionEnd,s=this._recordingAutoCaptureFrameCountInputElement.direction,a=e===1?WI.UIString("Record first %s frame"):WI.UIString("Record first %s frames"),d=document.createDocumentFragment();String.format(a,[this._recordingAutoCaptureFrameCountInputElement],String.standardFormatters,d,(p,f)=>(p.append(f),p)),this._recordingAutoCaptureNavigationItem.label=d,t&&(this._recordingAutoCaptureFrameCountInputElement.selectionStart=i,this._recordingAutoCaptureFrameCountInputElement.selectionEnd=n,this._recordingAutoCaptureFrameCountInputElement.direction=s)}get _recordingAutoCaptureFrameCountInputElementValue(){return parseInt(this._recordingAutoCaptureFrameCountInputElement.value)}set _recordingAutoCaptureFrameCountInputElementValue(e){(this._recordingAutoCaptureFrameCountInputElement.value||e)&&(this._recordingAutoCaptureFrameCountInputElement.value=e),this._recordingAutoCaptureFrameCountInputElement.placeholder=e}_updateRecordingAutoCaptureInputElementSize(){let e=this._recordingAutoCaptureFrameCountInputElementValue;return(isNaN(e)||e<0)&&(e=0,this._recordingAutoCaptureFrameCountInputElementValue=e),WI.ImageUtilities.scratchCanvasContext2D(t=>{if(!this._recordingAutoCaptureFrameCountInputElement.__cachedFont){let n=window.getComputedStyle(this._recordingAutoCaptureFrameCountInputElement);this._recordingAutoCaptureFrameCountInputElement.__cachedFont=n.font}t.font=this._recordingAutoCaptureFrameCountInputElement.__cachedFont;let i=t.measureText(this._recordingAutoCaptureFrameCountInputElement.value||this._recordingAutoCaptureFrameCountInputElement.placeholder);this._recordingAutoCaptureFrameCountInputElement.style.setProperty("width",i.width+2*Bu.recordingAutoCaptureInputMargin+"px")}),e}_addSavedRecording(e){if(console.assert(!e.source),!this._savedRecordingsContentView){this._savedRecordingsContentView=new WI.ContentView,this._savedRecordingsContentView.element.classList.add("canvas","saved-recordings"),this.addSubview(this._savedRecordingsContentView);let n=this._savedRecordingsContentView.element.appendChild(document.createElement("header"));n.textContent=WI.UIString("Saved Recordings"),this.hideContentPlaceholder()}this._savedRecordingsTreeOutline||(this._savedRecordingsTreeOutline=new WI.TreeOutline(!1),this._savedRecordingsTreeOutline.addEventListener(WI.TreeOutline.Event.ElementClicked,this._handleSavedRecordingClicked,this),this._savedRecordingsContentView.element.appendChild(this._savedRecordingsTreeOutline.element));const t=null;let i=new WI.GeneralTreeElement(["recording"],e.displayName,t,e);i.selectable=!1,this._savedRecordingsTreeOutline.appendChild(i)}_handleRecordingAutoCaptureInput(e){let t=this._updateRecordingAutoCaptureInputElementSize();this._recordingAutoCaptureNavigationItem.checked=!!t,this._setRecordingAutoCaptureFrameCount(t)}_handleRecordingAutoCaptureCheckedDidChange(e){this._setRecordingAutoCaptureFrameCount(this._recordingAutoCaptureFrameCountInputElementValue||0)}_handleCanvasRecordingAutoCaptureEnabledChanged(e){this._recordingAutoCaptureNavigationItem.checked=WI.settings.canvasRecordingAutoCaptureEnabled.value}_handleCanvasRecordingAutoCaptureFrameCountChanged(e){this._recordingAutoCaptureFrameCountInputElementValue!==WI.settings.canvasRecordingAutoCaptureFrameCount.value&&(this._recordingAutoCaptureFrameCountInputElementValue=WI.settings.canvasRecordingAutoCaptureFrameCount.value),this._updateRecordingAutoCaptureCheckboxLabel(WI.settings.canvasRecordingAutoCaptureFrameCount.value)}_handleImportButtonNavigationItemClicked(e){WI.FileUtilities.importJSON(t=>WI.canvasManager.processJSON(t))}_handleRecordingSaved(e){this._addSavedRecording(e.data.recording)}_handleSavedRecordingClicked(e){WI.showRepresentedObject(e.data.treeElement.representedObject)}};WI.CanvasSidebarPanel=class extends WI.NavigationSidebarPanel{constructor(){super("canvas",WI.UIString("Canvas")),this._canvas=null,this._recording=null,this._navigationBar=new WI.NavigationBar,this._scopeBar=null,this._placeholderScopeBarItem=null;const e=WI.UIString(`Start recording canvas actions.
Shift-click to record a single frame.`),t=WI.UIString("Stop recording canvas actions");this._recordButtonNavigationItem=new WI.ToggleButtonNavigationItem("record-start-stop",e,t,"data:image/svg+xml,%3c%3fxml version='1.0'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 13'%3e %3ccircle fill='red' cx='6.5' cy='6.5' r='6'/%3e %3c/svg%3e","data:image/svg+xml,%3c%3fxml version='1.0'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 13'%3e %3crect fill='currentColor' x='1' y='1' width='11' height='11'/%3e %3c/svg%3e",13,13),this._recordButtonNavigationItem.enabled=!1,this._recordButtonNavigationItem.buttonStyle=WI.ButtonNavigationItem.Style.ImageAndText,this._recordButtonNavigationItem.label=WI.UIString("Start"),this._recordButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._toggleRecording,this),this._navigationBar.addNavigationItem(this._recordButtonNavigationItem),this._navigationBar.addNavigationItem(new WI.DividerNavigationItem);let i=new WI.ButtonNavigationItem("import-recording",WI.UIString("Import"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' d='M 7.5 8.5 V 1'/%3e %3cpath fill='none' stroke='currentColor' d='M 10.5 5.5 l -3%2c 3 l -3 -3'/%3e %3cpolyline fill='none' stroke='currentColor' points='12.5 9 12.5 12.5 2.5 12.5 2.5 9'/%3e %3c/svg%3e",15,15);i.buttonStyle=WI.ButtonNavigationItem.Style.ImageAndText,i.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,i.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._handleImportButtonNavigationItemClicked,this),this._navigationBar.addNavigationItem(i),this.addSubview(this._navigationBar),this._canvasTreeOutline=this.createContentTreeOutline({suppressFiltering:!0}),this._canvasTreeOutline.element.classList.add("canvas"),this._recordingNavigationBar=new WI.NavigationBar,this._recordingNavigationBar.element.classList.add("hidden"),this.contentView.addSubview(this._recordingNavigationBar),this._recordingContentContainer=this.contentView.element.appendChild(document.createElement("div")),this._recordingContentContainer.className="recording-content",this._recordingTreeOutline=this.contentTreeOutline,this._recordingContentContainer.appendChild(this._recordingTreeOutline.element),this._recordingTreeOutline.customIndent=!0,this._recordingTreeOutline.registerScrollVirtualizer(this._recordingContentContainer,20),this._canvasTreeOutline.addEventListener(WI.TreeOutline.Event.SelectionDidChange,this._treeSelectionDidChange,this),this._recordingTreeOutline.addEventListener(WI.TreeOutline.Event.SelectionDidChange,this._treeSelectionDidChange,this),this._recordingProcessingOptionsContainer=null,this._selectedRecordingActionIndex=NaN}get canvas(){return this._canvas}set canvas(e){this._canvas!==e&&(this._canvas&&(this._canvas.removeEventListener(null,null,this),this._canvas.recordingCollection.removeEventListener(null,null,this)),this._canvas=e,this._canvas&&(this._canvas.addEventListener(WI.Canvas.Event.RecordingStarted,this._updateRecordNavigationItem,this),this._canvas.addEventListener(WI.Canvas.Event.RecordingStopped,this._updateRecordNavigationItem,this),this._canvas.recordingCollection.addEventListener(WI.Collection.Event.ItemAdded,this._recordingAdded,this),this._canvas.recordingCollection.addEventListener(WI.Collection.Event.ItemRemoved,this._recordingRemoved,this)),this._canvasChanged(),this._updateRecordNavigationItem(),this._updateRecordingScopeBar())}set recording(e){e!==this._recording&&(this._recording&&this._recording.removeEventListener(null,null,this),e&&(this.canvas=e.source),this._recording=e,this._recording&&!this._recording.ready&&(this._recording.addEventListener(WI.Recording.Event.ProcessedAction,this._handleRecordingProcessedAction,this),this._recording.addEventListener(WI.Recording.Event.StartProcessingFrame,this._handleRecordingStartProcessingFrame,this)),this._updateRecordNavigationItem(),this._updateRecordingScopeBar(),this._recordingChanged())}set action(e){if(!this._recording||e===this._recording.actions[this._selectedRecordingActionIndex])return;let t=this._recordingTreeOutline.selectedTreeElement;if(!e){t&&t.deselect();return}if(t&&t instanceof WI.FolderTreeElement){let a=t.children.lastValue;if(e===a.representedObject)return}let i=this._recordingTreeOutline.findTreeElement(e);if(console.assert(i,"Missing tree element for recording action.",e),!i)return;this._recording[WI.CanvasSidebarPanel.SelectedActionSymbol]=e;const n=!1,s=!1;i.revealAndSelect(n,s),this._selectedRecordingActionIndex=this._recording.actions.indexOf(e)}updateRepresentedObjects(){let e=this.contentBrowser.currentRepresentedObjects,t=e.find(s=>s instanceof WI.Canvas);if(t){this.canvas=t;return}let i=e.find(s=>s instanceof WI.ShaderProgram);if(i){this.canvas=i.canvas;let s=this._canvasTreeOutline.findTreeElement(i);const a=!1,d=!1;s.revealAndSelect(a,d);return}let n=e.find(s=>s instanceof WI.Recording);if(n){this.canvas=n.source,this.recording=n;let s=e.find(a=>a instanceof WI.RecordingAction);s!==n[WI.CanvasSidebarPanel.SelectedActionSymbol]&&(this.action=s);return}this.canvas=null,this.recording=null}shown(){if(super.shown(),this.contentBrowser.addEventListener(WI.ContentBrowser.Event.CurrentRepresentedObjectsDidChange,this.updateRepresentedObjects,this),this.updateRepresentedObjects(),this._recording){this._recordingTreeOutline.updateVirtualizedElementsDebouncer.force();let e=this._recording[WI.CanvasSidebarPanel.SelectedActionSymbol],t=this._recordingTreeOutline.findTreeElement(e);t&&t.revealAndSelect(!1,!1)}}hidden(){this.contentBrowser.removeEventListener(null,null,this),super.hidden()}canShowRepresentedObject(e){return e instanceof WI.CanvasCollection?!1:super.canShowRepresentedObject(e)}get scrollElement(){return this._recordingContentContainer}hasCustomFilters(){return!0}matchTreeElementAgainstCustomFilters(e){return e instanceof WI.FolderTreeElement||e instanceof WI.RecordingActionTreeElement&&e.representedObject instanceof WI.RecordingInitialStateAction?!0:super.matchTreeElementAgainstCustomFilters(e)}initialLayout(){super.initialLayout();let e=s=>s.representedObject instanceof WI.RecordingAction?s.representedObject.isVisual||s.representedObject instanceof WI.RecordingInitialStateAction:!1;const t=!1,i=WI.UIString("Only show visual actions"),n=WI.UIString("Show all actions");this.filterBar.addFilterBarButton("recording-show-visual-only",e,t,i,n,"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2013 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='currentColor' d='M 1.367188 13.789062 C 1.367188 13.789062 2.820312 14.105469 3.289062 12.722656 C 3.757812 11.34375 3.960938 10.867188 5.222656 10.976562 C 5.222656 10.976562 5.714844 11.886719 6.933594 12.308594 C 6.933594 12.308594 5.75 16.207031 1.367188 13.789062 Z M 14.339844 2.351562 C 14.054688 2.839844 10.289062 8.804688 9.554688 9.65625 C 8.820312 10.511719 6.917969 11.71875 6.917969 11.71875 C 6.003906 11.242188 5.710938 10.738281 5.710938 10.738281 C 5.710938 10.738281 6.328125 8.992188 7.230469 7.683594 C 8.132812 6.378906 13.050781 1.949219 13.460938 1.636719 C 13.871094 1.320312 14.625 1.867188 14.339844 2.351562 Z'/%3e %3c/svg%3e",15,15)}_recordingAdded(e){this.recording=e.data.item}_recordingRemoved(e){this._updateRecordingScopeBar(),e.data.item===this.recording&&(this.recording=this._canvas?Array.from(this._canvas.recordingCollection).lastValue:null)}_scopeBarSelectionChanged(){let e=this._scopeBar.selectedItems[0];this.recording=e.__recording||null}_toggleRecording(e){if(!!this._canvas)if(this._canvas.recordingActive)this._canvas.stopRecording();else{let t=e.data.nativeEvent.shiftKey;this._canvas.startRecording(t)}}_handleImportButtonNavigationItemClicked(e){WI.FileUtilities.importJSON(t=>WI.canvasManager.processJSON(t))}_treeSelectionDidChange(e){let t=e.target.selectedTreeElement;if(!t)return;if(t instanceof WI.CanvasTreeElement||t instanceof WI.ShaderProgramTreeElement){this._placeholderScopeBarItem&&(this._placeholderScopeBarItem.selected=!0),this.showDefaultContentViewForTreeElement(t);return}if(t instanceof WI.FolderTreeElement&&(t=t.children.lastValue),!(t instanceof WI.RecordingActionTreeElement))return;console.assert(this._recording,"Missing recording for action tree element.",t),this._recording[WI.CanvasSidebarPanel.SelectedActionSymbol]=t.representedObject;const i=!0;let n=this.contentBrowser.contentViewForRepresentedObject(this._recording,i);!n||(this.contentBrowser.showContentView(n),this._selectedRecordingActionIndex=t.index,n.updateActionIndex(this._selectedRecordingActionIndex))}_canvasChanged(){if(this._canvasTreeOutline.removeChildren(),!this._canvas){this._recordingNavigationBar.element.classList.add("hidden");return}const e=!1;let t=new WI.CanvasTreeElement(this._canvas,e);t.expanded=!0,this._canvasTreeOutline.appendChild(t);const i=!1,n=!1;t.revealAndSelect(i,n),(WI.Canvas.ContextType.Canvas2D||this._canvas.contextType===WI.Canvas.ContextType.WebGL||this._canvas.contextType===WI.Canvas.ContextType.WebGL2)&&(this._recordButtonNavigationItem.enabled=!0),this.recording=null}_recordingChanged(){if(this._recordingTreeOutline.removeChildren(),this._selectedRecordingActionIndex=NaN,this._recordingProcessingOptionsContainer&&(this._recordingProcessingOptionsContainer.remove(),this._recordingProcessingOptionsContainer=null),!this._recording)return;if(!this._recording.ready&&(this._recording.processing||this._recording.startProcessing(),!this._recordingProcessingOptionsContainer)){this._recordingProcessingOptionsContainer=this._recordingContentContainer.appendChild(document.createElement("div")),this._recordingProcessingOptionsContainer.classList.add("recording-processing-options");let i=()=>{let s=new WI.IndeterminateProgressSpinner;this._recordingProcessingOptionsContainer.appendChild(s.element);let a=this._recordingProcessingOptionsContainer.appendChild(document.createElement("button"));a.textContent=WI.UIString("Pause Processing"),a.addEventListener("click",d=>{this._recording.stopProcessing(),s.element.remove(),a.remove(),n()})},n=()=>{let s=this._recordingProcessingOptionsContainer.appendChild(document.createElement("button"));s.textContent=WI.UIString("Resume Processing"),s.addEventListener("click",a=>{this._recording.startProcessing(),s.remove(),i()})};this._recording.processing?i():n()}if(this.contentBrowser.showContentViewForRepresentedObject(this._recording),this._scopeBar){let i=this._scopeBar.item(this._recording.displayName);console.assert(i,"Missing scopeBarItem for recording.",this._recording),i.selected=!0}let e=this._recording.actions[0];e.ready&&!this._recordingTreeOutline.getCachedTreeElement(e)&&(this._recordingTreeOutline.appendChild(new WI.RecordingActionTreeElement(e,0,this._recording.type)),this._recording[WI.CanvasSidebarPanel.SelectedActionSymbol]||(this.action=e));let t=0;this._recording.frames.forEach((i,n)=>{if(!i.actions[0].ready)return;let s=this._recordingTreeOutline.getCachedTreeElement(i);s||(s=this._createRecordingFrameTreeElement(i,n,this._recordingTreeOutline));for(let a of i.actions){if(++t,!a.ready||this._recordingTreeOutline.getCachedTreeElement(a))break;this._createRecordingActionTreeElement(a,t,s)}})}_updateRecordNavigationItem(){if(!this._canvas||!(this._canvas.contextType===WI.Canvas.ContextType.Canvas2D||this._canvas.contextType===WI.Canvas.ContextType.WebGL||this._canvas.contextType===WI.Canvas.ContextType.WebGL2)){this._recordButtonNavigationItem.enabled=!1;return}this._recordButtonNavigationItem.toggled=this._canvas.recordingActive,this._recordButtonNavigationItem.label=this._recordButtonNavigationItem.toggled?WI.UIString("Stop"):WI.UIString("Start")}_updateRecordingScopeBar(){this._scopeBar&&(this._placeholderScopeBarItem=null,this._recordingNavigationBar.removeNavigationItem(this._scopeBar),this._scopeBar=null),this._recordingNavigationBar.element.classList.toggle("hidden",!this._canvas);let e=this._recording||this._canvas&&this._canvas.recordingCollection.size;if(this.element.classList.toggle("has-recordings",e),!e)return;let t=[],i=null,n=s=>{let a=new WI.ScopeBarItem(s.displayName,s.displayName);s===this._recording?i=a:a.selected=!1,a.__recording=s,t.push(a)};if(this._canvas&&this._canvas.recordingCollection)for(let s of this._canvas.recordingCollection)n(s);this._recording&&(!this._canvas||!this._canvas.recordingCollection.has(this._recording))&&n(this._recording),i||(i=t[0],this._placeholderScopeBarItem=new WI.ScopeBarItem("canvas-recording-scope-bar-item-placeholder",WI.UIString("Recordings"),{exclusive:!0,hidden:!0}),this._placeholderScopeBarItem.selected=!0,t.unshift(this._placeholderScopeBarItem)),this._scopeBar=new WI.ScopeBar("canvas-recording-scope-bar",t,i,!0),this._scopeBar.addEventListener(WI.ScopeBar.Event.SelectionChanged,this._scopeBarSelectionChanged,this),this._recordingNavigationBar.insertNavigationItem(this._scopeBar,0)}_createRecordingFrameTreeElement(e,t,i){let n=new WI.FolderTreeElement(WI.UIString("Frame %d").format((t+1).toLocaleString()),e);return isNaN(e.duration)||(n.status=Number.secondsToString(e.duration/1e3,!0)),i.appendChild(n),n}_createRecordingActionTreeElement(e,t,i){let n=new WI.RecordingActionTreeElement(e,t,this._recording.type);return i.appendChild(n),i instanceof WI.FolderTreeElement&&i.representedObject instanceof WI.RecordingFrame&&(e!==i.representedObject.actions.lastValue?(i.addClassName("processing"),i.subtitle instanceof HTMLProgressElement||(i.subtitle=document.createElement("progress")),i.statusElement&&i.subtitle.style.setProperty("width",`calc(100% - ${i.statusElement.offsetWidth+4}px`),i.subtitle.value=i.representedObject.actions.indexOf(e)/i.representedObject.actions.length):(i.removeClassName("processing"),i.representedObject.incomplete?i.subtitle=WI.UIString("Incomplete"):i.subtitle="")),e===this._recording[WI.CanvasSidebarPanel.SelectedActionSymbol]&&(this.action=e),n}_handleRecordingProcessedAction(e){let{action:t,index:i}=e.data;this._recordingTreeOutline.element.dataset.indent=Number.countDigits(i);let n=!i;console.assert(n||this._recordingTreeOutline.children.lastValue instanceof WI.FolderTreeElement,"There should be a WI.FolderTreeElement for the frame for this action."),this._createRecordingActionTreeElement(t,i,n?this._recordingTreeOutline:this._recordingTreeOutline.children.lastValue),this._recording[WI.CanvasSidebarPanel.SelectedActionSymbol]||(console.assert(t===this._recording.actions[0]),this.action=this._recording.actions[0]),this._recording.ready&&(this._recording.removeEventListener(null,null,this),this._recordingProcessingOptionsContainer&&(this._recordingProcessingOptionsContainer.remove(),this._recordingProcessingOptionsContainer=null))}_handleRecordingStartProcessingFrame(e){let{frame:t,index:i}=e.data;this._createRecordingFrameTreeElement(t,i,this._recordingTreeOutline)}};WI.CanvasSidebarPanel.SelectedActionSymbol=Symbol("selected-action");WI.CanvasTreeElement=class extends WI.FolderizedTreeElement{constructor(e,t=!0){console.assert(e instanceof WI.Canvas);let i=WI.Canvas.displayNameForContextType(e.contextType);if(super(["canvas",e.contextType],e.displayName,i,e),this.registerFolderizeSettings("shader-programs",WI.UIString("Shader Programs"),this.representedObject.shaderProgramCollection,WI.ShaderProgramTreeElement),this.representedObject.addEventListener(WI.Canvas.Event.RecordingStarted,this._updateStatus,this),this.representedObject.addEventListener(WI.Canvas.Event.RecordingStopped,this._updateStatus,this),this.representedObject.shaderProgramCollection.addEventListener(WI.Collection.Event.ItemAdded,this._handleItemAdded,this),this.representedObject.shaderProgramCollection.addEventListener(WI.Collection.Event.ItemRemoved,this._handleItemRemoved,this),this._showRecordings=t,this._showRecordings){let s=function(a){return new WI.GeneralTreeElement(["recording"],a.displayName,null,a)};var n=s;this.registerFolderizeSettings("recordings",WI.UIString("Recordings"),this.representedObject.recordingCollection,s),this.representedObject.recordingCollection.addEventListener(WI.Collection.Event.ItemAdded,this._handleItemAdded,this),this.representedObject.recordingCollection.addEventListener(WI.Collection.Event.ItemRemoved,this._handleItemRemoved,this)}}onattach(){super.onattach(),this.element.addEventListener("mouseover",this._handleMouseOver.bind(this)),this.element.addEventListener("mouseout",this._handleMouseOut.bind(this)),this.onpopulate()}onpopulate(){if(super.onpopulate(),!(this.children.length&&!this.shouldRefreshChildren)){this.shouldRefreshChildren=!1,this.removeChildren();for(let e of this.representedObject.shaderProgramCollection)this.addChildForRepresentedObject(e);if(this._showRecordings)for(let e of this.representedObject.recordingCollection)this.addChildForRepresentedObject(e)}}populateContextMenu(e,t){super.populateContextMenu(e,t),e.appendItem(WI.UIString("Log Canvas Context"),()=>{WI.RemoteObject.resolveCanvasContext(this.representedObject,WI.RuntimeManager.ConsoleObjectGroup,i=>{if(!i)return;const n=WI.UIString("Selected Canvas Context"),s=!0;WI.consoleLogViewController.appendImmediateExecutionWithResult(n,i,s)})}),e.appendSeparator()}_handleItemAdded(e){this.addChildForRepresentedObject(e.data.item)}_handleItemRemoved(e){this.removeChildForRepresentedObject(e.data.item)}_handleMouseOver(e){this.representedObject.cssCanvasName?this.representedObject.requestCSSCanvasClientNodes(t=>{WI.domManager.highlightDOMNodeList(t.map(i=>i.id),"all")}):this.representedObject.requestNode(t=>{!t||!t.ownerDocument||WI.domManager.highlightDOMNode(t.id,"all")})}_handleMouseOut(e){WI.domManager.hideDOMNodeHighlight()}_updateStatus(){if(this.representedObject.recordingActive){if(!this.status||!this.status.__showingSpinner){let e=new WI.IndeterminateProgressSpinner;this.status=e.element,this.status.__showingSpinner=!0}}else this.status&&this.status.__showingSpinner&&(this.status="")}};WI.ChangesDetailsSidebarPanel=class extends WI.DOMDetailsSidebarPanel{constructor(){super("changes-details",WI.UIString("Changes")),this.element.classList.add("changes-panel")}inspect(e){let t=super.inspect(e);return WI.settings.cssChangesPerNode.value?t:!0}supportsDOMNode(e){return WI.settings.cssChangesPerNode.value?e.nodeType()===Node.ELEMENT_NODE:!0}shown(){this.didInitialLayout&&(this.needsLayout(),WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this)),super.shown()}detached(){super.detached(),WI.Frame.removeEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this)}layout(){super.layout(),this.element.removeChildren();let e=WI.cssManager.modifiedStyles;if(WI.settings.cssChangesPerNode.value)if(this.domNode){let i=WI.cssManager.stylesForNode(this.domNode);e=e.filter(n=>n.node===this.domNode?!0:n.ownerRule?i.matchedRules.some(s=>n.ownerRule.isEqualTo(s)):!1)}else e=[];if(this.element.classList.toggle("empty",!e.length),!e.length){this.element.textContent=WI.UIString("No CSS Changes");return}let t=new Map;for(let i of e){let n=t.get(i.ownerStyleSheet);n||(n=[],t.set(i.ownerStyleSheet,n)),n.push(i)}for(let[i,n]of t){let s=this.element.appendChild(document.createElement("section"));s.classList.add("resource-section");let a=s.appendChild(document.createElement("div"));a.classList.add("header"),a.append(i.isInlineStyleAttributeStyleSheet()?n[0].selectorText:this._createLocationLink(i));for(let d of n)s.append(this._createRuleElement(d))}}_createRuleElement(e){let t=document.createElement("div");t.classList.add("css-rule");let i=t.appendChild(document.createElement("div"));i.className="selector-line";let n=i.appendChild(document.createElement("span"));n.className="selector",e.type===WI.CSSStyleDeclaration.Type.Inline?(n.textContent=WI.UIString("Style Attribute"),n.classList.add("style-attribute")):n.textContent=e.ownerRule.selectorText,i.append(` {
`);function s(p,f){let _="";f===1?_="added":f===-1?_="removed":_="unchanged";let b=t.appendChild(document.createElement("div"));b.classList.add("css-property-line",_);const w=null;let S=new WI.SpreadsheetStyleProperty(w,p,{readOnly:!0});b.append(WI.indentString(),S.element,`
`)}function a(p,f){return p.equals(f)}Array.diffArrays(e.initialState.visibleProperties,e.visibleProperties,s,a);let d=document.createElement("span");return d.className="close-brace",d.textContent="}",t.append(d,`
`),t}_createLocationLink(e){const t={nameStyle:WI.SourceCodeLocation.NameStyle.Short,columnStyle:WI.SourceCodeLocation.ColumnStyle.Hidden,dontFloat:!0,ignoreNetworkTab:!0,ignoreSearchTab:!0},i=0,n=0;let s=e.createSourceCodeLocation(i,n);return WI.createSourceCodeLocationLink(s,t)}_mainResourceDidChange(e){!e.target.isMainFrame()||this.needsLayout()}};WI.ChartDetailsSectionRow=class extends WI.DetailsSectionRow{constructor(e,t,i){super(WI.UIString("No Chart Available")),i=i||0,console.assert(t>0,t),console.assert(i>=0&&i<1,i),this.element.classList.add("chart"),this._titleElement=document.createElement("div"),this._titleElement.className="title",this.element.appendChild(this._titleElement);let n=document.createElement("div");n.className="chart-content",this.element.appendChild(n),this._chartElement=createSVGElement("svg"),n.appendChild(this._chartElement),this._legendElement=document.createElement("div"),this._legendElement.className="legend",n.appendChild(this._legendElement),this._delegate=e,this._items=new Map,this._title="",this._chartSize=t,this._radius=this._chartSize/2-1,this._innerRadius=i?Math.floor(this._radius*i):0,this._total=0,this._svgFiltersElement=document.createElement("svg"),this._svgFiltersElement.classList.add("defs-only"),this.element.append(this._svgFiltersElement),this._checkboxStyleElement=document.createElement("style"),this._checkboxStyleElement.id="checkbox-styles",document.getElementsByTagName("head")[0].append(this._checkboxStyleElement);function s(a,d,p){const _=Math.PI*1.9999;let b=a+Math.cos(0)*d,w=a+Math.sin(0)*d,S=a+Math.cos(_)*d,E=a+Math.sin(_)*d,k=a+Math.cos(_)*p,R=a+Math.sin(_)*p,M=a+Math.cos(0)*p,L=a+Math.sin(0)*p;return["M",b,w,"A",d,d,0,1,1,S,E,"Z","M",k,R,"A",p,p,0,1,0,M,L,"Z"].join(" ")}this._emptyChartPath=createSVGElement("path"),this._emptyChartPath.setAttribute("d",s(this._chartSize/2,this._radius,this._innerRadius)),this._emptyChartPath.classList.add("empty-chart"),this._chartElement.appendChild(this._emptyChartPath)}get chartSize(){return this._chartSize}set title(e){this._title!==e&&(this._title=e,this._titleElement.textContent=e)}get total(){return this._total}addItem(e,t,i,n,s,a){console.assert(!this._items.has(e),"Already added item with id: "+e),!this._items.has(e)&&(console.assert(i>=0,"Value cannot be negative."),!(i<0)&&(this._items.set(e,{label:t,value:i,color:n,checkbox:s,checked:a}),this._total+=i,this._needsLayout()))}setItemValue(e,t){let i=this._items.get(e);console.assert(i,"Cannot set value for invalid item id: "+e),i&&(console.assert(t>=0,"Value cannot be negative."),!(t<0)&&i.value!==t&&(this._total+=t-i.value,i.value=t,this._needsLayout()))}clearItems(){for(let e of this._items.values()){let t=e[WI.ChartDetailsSectionRow.ChartSegmentPathSymbol];t&&t.remove()}this._total=0,this._items.clear(),this._needsLayout()}_addCheckboxColorFilter(e,t,i,n){for(let b=0;b<this._svgFiltersElement.childNodes.length;++b)if(this._svgFiltersElement.childNodes[b].id===e)return;t/=255,n/=255,i/=255;let s=createSVGElement("filter");s.id=e,s.setAttribute("color-interpolation-filters","sRGB");let a=[1-t,0,0,0,t,1-i,0,0,0,i,1-n,0,0,0,n,0,0,0,1,0],d=createSVGElement("feColorMatrix");d.setAttribute("type","matrix"),d.setAttribute("values",a.join(" "));function p(b,w){let S=createSVGElement(b);return S.setAttribute("type","gamma"),S.setAttribute("exponent",w),S}let f=createSVGElement("feComponentTransfer");f.append(p("feFuncR",1.4),p("feFuncG",1.4),p("feFuncB",1.4)),s.append(d,f),this._svgFiltersElement.append(s),this._checkboxStyleElement.sheet.insertRule(".details-section > .content > .group > .row.chart > .chart-content > .legend > .legend-item > label > input[type=checkbox]."+e+" { filter: grayscale(1) url(#"+e+") }",0)}_updateLegend(){if(!this._items.size){this._legendElement.removeChildren();return}function e(t){return this._delegate&&typeof this._delegate.formatChartValue=="function"?this._delegate.formatChartValue(t.value):t.value}for(let[t,i]of this._items){if(i[WI.ChartDetailsSectionRow.LegendItemValueElementSymbol]){let p=i[WI.ChartDetailsSectionRow.LegendItemValueElementSymbol];p.textContent=e.call(this,i);continue}let n=document.createElement("label"),s;if(i.checkbox){let p=t.toLowerCase(),f=i.color.substring(4,i.color.length-1).replace(/ /g,"").split(",");f[0]===f[1]&&f[1]===f[2]&&(f[0]=f[1]=f[2]=Math.min(160,f[0])),s=document.createElement("input"),s.type="checkbox",s.classList.add(p),s.checked=i.checked,s[WI.ChartDetailsSectionRow.DataItemIdSymbol]=t,s.addEventListener("change",this._legendItemCheckboxValueChanged.bind(this)),this._addCheckboxColorFilter(p,f[0],f[1],f[2])}else s=document.createElement("div"),s.classList.add("color-key"),s.style.backgroundColor=i.color;n.append(s,i.label);let a=document.createElement("div");a.classList.add("value"),a.textContent=e.call(this,i),i[WI.ChartDetailsSectionRow.LegendItemValueElementSymbol]=a;let d=document.createElement("div");d.classList.add("legend-item"),d.append(n,a),this._legendElement.append(d)}}_legendItemCheckboxValueChanged(e){let t=e.target,i=t[WI.ChartDetailsSectionRow.DataItemIdSymbol];this.dispatchEventToListeners(WI.ChartDetailsSectionRow.Event.LegendItemChecked,{id:i,checked:t.checked})}_needsLayout(){this._scheduledLayoutUpdateIdentifier||(this._scheduledLayoutUpdateIdentifier=requestAnimationFrame(this._updateLayout.bind(this)))}_updateLayout(){this._scheduledLayoutUpdateIdentifier&&(cancelAnimationFrame(this._scheduledLayoutUpdateIdentifier),this._scheduledLayoutUpdateIdentifier=void 0),this._updateLegend(),this._chartElement.setAttribute("width",this._chartSize),this._chartElement.setAttribute("height",this._chartSize),this._chartElement.setAttribute("viewbox","0 0 "+this._chartSize+" "+this._chartSize);function e(d,p,f,_,b){const w=(f-p)%(Math.PI*2)>Math.PI?1:0;let S=d+Math.cos(p)*_,E=d+Math.sin(p)*_,k=d+Math.cos(f)*_,R=d+Math.sin(f)*_,M=d+Math.cos(f)*b,L=d+Math.sin(f)*b,V=d+Math.cos(p)*b,H=d+Math.sin(p)*b;return["M",S,E,"A",_,_,0,w,1,k,R,"L",M,L,"A",b,b,0,w,0,V,H,"Z"].join(" ")}const t=this._total*.015;let i=[];for(let d of this._items.values())d.displayValue=d.value?Math.max(t,d.value):0,d.displayValue&&i.push(d);if(i.length>1){i.sort(function(f,_){return f.value-_.value});let d=i.length,p=0;for(let f of i){if(f.value<t){p+=t-f.value,d--;continue}if(!p||!d)break;const _=p/d;f.displayValue-_>=t&&(f.displayValue-=_,p-=_),d--}}const n=this._chartSize/2;let s=-Math.PI/2,a=0;for(let[d,p]of this._items){let f=p[WI.ChartDetailsSectionRow.ChartSegmentPathSymbol];if(f||(f=createSVGElement("path"),f.classList.add("chart-segment"),f.setAttribute("fill",p.color),this._chartElement.appendChild(f),p[WI.ChartDetailsSectionRow.ChartSegmentPathSymbol]=f),!p.value){f.classList.add("hidden");continue}const _=p.displayValue/this._total*Math.PI*2;a=s+_,f.setAttribute("d",e(n,s,a,this._radius,this._innerRadius)),f.classList.remove("hidden"),s=a}}};WI.ChartDetailsSectionRow.DataItemIdSymbol=Symbol("chart-details-section-row-data-item-id");WI.ChartDetailsSectionRow.ChartSegmentPathSymbol=Symbol("chart-details-section-row-chart-segment-path");WI.ChartDetailsSectionRow.LegendItemValueElementSymbol=Symbol("chart-details-section-row-legend-item-value-element");WI.ChartDetailsSectionRow.Event={LegendItemChecked:"chart-details-section-row-legend-item-checked"};WI.CheckboxNavigationItem=class extends WI.NavigationItem{constructor(e,t,i){super(e,"checkbox"),this._checkboxElement=this.element.appendChild(document.createElement("input")),this._checkboxElement.checked=i,this._checkboxElement.id="checkbox-navigation-item-"+e,this._checkboxElement.type="checkbox",this._checkboxElement.addEventListener("change",this._checkboxChanged.bind(this)),this._checkboxLabel=this.element.appendChild(document.createElement("label")),this._checkboxLabel.className="toggle",this._checkboxLabel.setAttribute("for",this._checkboxElement.id),this._checkboxLabel.addEventListener("click",this._handleLabelClick.bind(this)),this.label=t}get checked(){return this._checkboxElement.checked}set checked(e){this._checkboxElement.checked=e}set label(e){this._checkboxLabel.removeChildren(),this._checkboxLabel.append(e)}get additionalClassNames(){return["checkbox","button"]}_checkboxChanged(e){this.dispatchEventToListeners(WI.CheckboxNavigationItem.Event.CheckedDidChange)}_handleLabelClick(e){WI.isEventTargetAnEditableField(e)&&e.stop()}};WI.CheckboxNavigationItem.Event={CheckedDidChange:"checkbox-navigation-item-checked-did-change"};WI.CircleChart=class extends WI.View{constructor({size:e,innerRadiusRatio:t}){super(),this._data=[],this._size=e,this._radius=e/2-1,this._innerRadius=t?Math.floor(this._radius*t):0,this.element.classList.add("circle-chart"),this._chartElement=this.element.appendChild(createSVGElement("svg")),this._chartElement.setAttribute("width",e),this._chartElement.setAttribute("height",e),this._chartElement.setAttribute("viewBox",`0 0 ${e} ${e}`),this._pathElements=[],this._values=[],this._total=0;let i=this._chartElement.appendChild(createSVGElement("path"));i.setAttribute("d",this._createCompleteCirclePathData(this._size/2,this._radius,this._innerRadius)),i.classList.add("background")}get size(){return this._size}get centerElement(){return this._centerElement||(this._centerElement=this.element.appendChild(document.createElement("div")),this._centerElement.classList.add("center"),this._centerElement.style.width=this._centerElement.style.height=this._radius+"px",this._centerElement.style.top=this._centerElement.style.left=this._radius-this._innerRadius+"px"),this._centerElement}get segments(){return this._segments}set segments(e){for(let t of this._pathElements)t.remove();this._pathElements=[];for(let t of e){let i=this._chartElement.appendChild(createSVGElement("path"));i.classList.add("segment",t),this._pathElements.push(i)}}get values(){return this._values}set values(e){console.assert(!e.length||e.length===this._pathElements.length,"Should have the same number of values as segments"),this._values=e,this._total=0;for(let t of e)this._total+=t}clear(){this.values=new Array(this._values.length).fill(0)}layout(){if(super.layout(),this.layoutReason===WI.View.LayoutReason.Resize||!this._values.length)return;const e=this._size/2;let t=-Math.PI/2,i=0;for(let n=0;n<this._values.length;++n){let s=this._values[n],a=this._pathElements[n];if(s===0)a.removeAttribute("d");else if(s===this._total)a.setAttribute("d",this._createCompleteCirclePathData(e,this._radius,this._innerRadius));else{let d=s/this._total*Math.PI*2;i=t+d,a.setAttribute("d",this._createSegmentPathData(e,t,i,this._radius,this._innerRadius)),t=i}}}_createCompleteCirclePathData(e,t,i){const s=Math.PI*1.9999;let a=e+Math.cos(0)*t,d=e+Math.sin(0)*t,p=e+Math.cos(s)*t,f=e+Math.sin(s)*t,_=e+Math.cos(s)*i,b=e+Math.sin(s)*i,w=e+Math.cos(0)*i,S=e+Math.sin(0)*i;return["M",a,d,"A",t,t,0,1,1,p,f,"Z","M",_,b,"A",i,i,0,1,0,w,S,"Z"].join(" ")}_createSegmentPathData(e,t,i,n,s){const a=(i-t)%(Math.PI*2)>Math.PI?1:0;let d=e+Math.cos(t)*n,p=e+Math.sin(t)*n,f=e+Math.cos(i)*n,_=e+Math.sin(i)*n,b=e+Math.cos(i)*s,w=e+Math.sin(i)*s,S=e+Math.cos(t)*s,E=e+Math.sin(t)*s;return["M",d,p,"A",n,n,0,a,1,f,_,"L",b,w,"A",s,s,0,a,0,S,E,"Z"].join(" ")}};WI.ClusterContentView=class extends WI.ContentView{constructor(e){super(e),this.element.classList.add("cluster"),this._contentViewContainer=new WI.ContentViewContainer,this._contentViewContainer.addEventListener(WI.ContentViewContainer.Event.CurrentContentViewDidChange,this._currentContentViewDidChange,this),this.addSubview(this._contentViewContainer),WI.ContentView.addEventListener(WI.ContentView.Event.SelectionPathComponentsDidChange,this._contentViewSelectionPathComponentDidChange,this),WI.ContentView.addEventListener(WI.ContentView.Event.SupplementalRepresentedObjectsDidChange,this._contentViewSupplementalRepresentedObjectsDidChange,this),WI.ContentView.addEventListener(WI.ContentView.Event.NumberOfSearchResultsDidChange,this._contentViewNumberOfSearchResultsDidChange,this)}get navigationItems(){var e=this._contentViewContainer.currentContentView;return e?e.navigationItems:[]}get contentViewContainer(){return this._contentViewContainer}get supportsSplitContentBrowser(){return this._contentViewContainer.currentContentView?this._contentViewContainer.currentContentView.supportsSplitContentBrowser:super.supportsSplitContentBrowser}get shouldSaveStateWhenHidden(){return!0}shown(){super.shown(),this._contentViewContainer.shown()}hidden(){super.hidden(),this._contentViewContainer.hidden()}closed(){super.closed(),this._contentViewContainer.closeAllContentViews(),WI.ContentView.removeEventListener(null,null,this)}canGoBack(){return this._contentViewContainer.canGoBack()}canGoForward(){return this._contentViewContainer.canGoForward()}goBack(){this._contentViewContainer.goBack()}goForward(){this._contentViewContainer.goForward()}get scrollableElements(){return this._contentViewContainer.currentContentView?this._contentViewContainer.currentContentView.scrollableElements:[]}get selectionPathComponents(){return this._contentViewContainer.currentContentView?this._contentViewContainer.currentContentView.selectionPathComponents:[]}get supplementalRepresentedObjects(){return this._contentViewContainer.currentContentView?this._contentViewContainer.currentContentView.supplementalRepresentedObjects:[]}get handleCopyEvent(){var e=this._contentViewContainer.currentContentView;return e&&typeof e.handleCopyEvent=="function"?e.handleCopyEvent.bind(e):null}get supportsSave(){var e=this._contentViewContainer.currentContentView;return e&&e.supportsSave}get saveData(){var e=this._contentViewContainer.currentContentView;return e&&e.saveData||null}get supportsSearch(){return!0}get numberOfSearchResults(){var e=this._contentViewContainer.currentContentView;return!e||!e.supportsSearch?null:e.numberOfSearchResults}get hasPerformedSearch(){var e=this._contentViewContainer.currentContentView;return!e||!e.supportsSearch?!1:e.hasPerformedSearch}set automaticallyRevealFirstSearchResult(e){var t=this._contentViewContainer.currentContentView;!t||!t.supportsSearch||(t.automaticallyRevealFirstSearchResult=e)}performSearch(e){this._searchQuery=e;var t=this._contentViewContainer.currentContentView;!t||!t.supportsSearch||t.performSearch(e)}searchCleared(){this._searchQuery=null;var e=this._contentViewContainer.currentContentView;!e||!e.supportsSearch||e.searchCleared()}searchQueryWithSelection(){var e=this._contentViewContainer.currentContentView;return!e||!e.supportsSearch?null:e.searchQueryWithSelection()}revealPreviousSearchResult(e){var t=this._contentViewContainer.currentContentView;!t||!t.supportsSearch||t.revealPreviousSearchResult(e)}revealNextSearchResult(e){var t=this._contentViewContainer.currentContentView;!t||!t.supportsSearch||t.revealNextSearchResult(e)}_currentContentViewDidChange(e){var t=this._contentViewContainer.currentContentView;t&&t.supportsSearch&&(this._searchQuery?t.performSearch(this._searchQuery):t.searchCleared()),this.dispatchEventToListeners(WI.ContentView.Event.SelectionPathComponentsDidChange),this.dispatchEventToListeners(WI.ContentView.Event.NumberOfSearchResultsDidChange),this.dispatchEventToListeners(WI.ContentView.Event.NavigationItemsDidChange)}_contentViewSelectionPathComponentDidChange(e){e.target===this._contentViewContainer.currentContentView&&this.dispatchEventToListeners(WI.ContentView.Event.SelectionPathComponentsDidChange)}_contentViewSupplementalRepresentedObjectsDidChange(e){e.target===this._contentViewContainer.currentContentView&&this.dispatchEventToListeners(WI.ContentView.Event.SupplementalRepresentedObjectsDidChange)}_contentViewNumberOfSearchResultsDidChange(e){e.target===this._contentViewContainer.currentContentView&&this.dispatchEventToListeners(WI.ContentView.Event.NumberOfSearchResultsDidChange)}};(function(){function c(M,L){return console.assert(L._linkQuoteCharacter!==void 0),L._linkQuoteCharacter?M.eatWhile(new RegExp("[^"+L._linkQuoteCharacter+"]")):M.eatWhile(/[^\s\u00a0=<>\"\']/),M.eol()||(L._linkTokenize=e),"link"}function e(M,L){console.assert(L._linkQuoteCharacter!==void 0),console.assert(L._linkBaseStyle),L._linkQuoteCharacter&&M.eat(L._linkQuoteCharacter);var V=L._linkBaseStyle;return delete L._linkTokenize,delete L._linkQuoteCharacter,delete L._linkBaseStyle,delete L._srcSetTokenizeState,V}function t(M,L){return console.assert(L._linkQuoteCharacter!==void 0),L._srcSetTokenizeState==="link"?L._linkQuoteCharacter?M.eatWhile(new RegExp("[^\\s,"+L._linkQuoteCharacter+"]")):M.eatWhile(/[^\s,\u00a0=<>\"\']/):(M.eatSpace(),L._linkQuoteCharacter?M.eatWhile(new RegExp("[^,"+L._linkQuoteCharacter+"]")):M.eatWhile(/[^\s\u00a0=<>\"\']/),M.eatWhile(/[\s,]/)),(M.eol()||!L._linkQuoteCharacter||M.peek()===L._linkQuoteCharacter)&&(L._linkTokenize=e),L._srcSetTokenizeState==="link"?(L._srcSetTokenizeState="descriptor","link"):(L._srcSetTokenizeState="link",L._linkBaseStyle)}function i(M,L){if(L._linkTokenize){var H=L._linkTokenize(M,L);return H&&H+" m-"+this.name}var V=M.pos,H=this._token(M,L);if(H==="attribute"){var O=M.current().toLowerCase();O==="src"||/\bhref\b/.test(O)?L._expectLink=!0:O==="srcset"?L._expectSrcSet=!0:(delete L._expectLink,delete L._expectSrcSet)}else if(L._expectLink&&H==="string"){var z=M.current();if(z!=='""'&&z!=="''"){delete L._expectLink,L._linkTokenize=c,L._linkBaseStyle=H;var K=z[0];L._linkQuoteCharacter=K==="'"||K==='"'?K:null,M.pos=V,L._linkQuoteCharacter&&M.eat(L._linkQuoteCharacter)}}else if(L._expectSrcSet&&H==="string"){var z=M.current();if(z!=='""'&&z!=="''"){delete L._expectSrcSet,L._srcSetTokenizeState="link",L._linkTokenize=t,L._linkBaseStyle=H;var K=z[0];L._linkQuoteCharacter=K==="'"||K==='"'?K:null,M.pos=V,L._linkQuoteCharacter&&M.eat(L._linkQuoteCharacter)}}else H&&(delete L._expectLink,delete L._expectSrcSet);return H&&H+" m-"+this.name}function n(M,L){if(console.assert(L._urlQuoteCharacter),L._unquotedURLString&&M.eatSpace())return null;for(var V=null,H=!1,O=!1,z=M.pos,K=L._urlQuoteCharacter;(V=M.next())!=null;){if(V===K&&!H){O=!0;break}H=!H&&V==="\\",/[\s\u00a0]/.test(V)||(z=M.pos)}return L._unquotedURLString&&(M.pos=z),O&&(L._unquotedURLString||M.backUp(1),this._urlTokenize=s),"link"}function s(M,L){console.assert(L._urlQuoteCharacter),console.assert(L._urlBaseStyle),L._unquotedURLString||M.eat(L._urlQuoteCharacter);var V=L._urlBaseStyle;return delete L._urlTokenize,delete L._urlQuoteCharacter,delete L._urlBaseStyle,V}function a(M,L){var V=/#(?:[0-9a-fA-F]{8}|[0-9a-fA-F]{6}|[0-9a-fA-F]{3,4})\b/g;if(L._urlTokenize){var O=L._urlTokenize(M,L);return O&&O+" m-"+(this.alternateName||this.name)}var H=M.pos,O=this._token(M,L);if(O){if(O==="atom")M.current()==="url"?L._expectLink=!0:V.test(M.current())&&(O=O+" hex-color");else if(L._expectLink&&(delete L._expectLink,O==="string")){L._urlTokenize=n,L._urlBaseStyle=O;var z=M.current()[0];L._urlQuoteCharacter=z==="'"||z==='"'?z:")",L._unquotedURLString=L._urlQuoteCharacter===")",M.pos=H,L._unquotedURLString||M.eat(L._urlQuoteCharacter)}}return O&&O+" m-"+(this.alternateName||this.name)}function d(M,L){var V=this._token(M,L);return V&&V+" m-"+(this.alternateName||this.name)}function p(M,L){L.preventDefault();function V(){if(!!M.getWrapperElement().classList.contains("CodeMirror-focused")){var H=M.getScrollerElement().getElementsByClassName("CodeMirror-cursor")[0];H&&H.scrollIntoViewIfNeeded(!1)}}setTimeout(V,0)}CodeMirror.extendMode("css",{token:a}),CodeMirror.extendMode("xml",{token:i}),CodeMirror.extendMode("javascript",{token:d}),CodeMirror.defineInitHook(function(M){M.on("scrollCursorIntoView",p)});let f=null,_=new Set;CodeMirror.defineOption("showWhitespaceCharacters",!1,function(M,L,V){if(!L||V&&V!==CodeMirror.Init){M.removeOverlay("whitespace");return}M.addOverlay({name:"whitespace",token(H){if(H.peek()===" "){let O=0;for(;H.peek()===" ";)++O,H.next();if(!_.has(O)){_.add(O),f||(f=document.head.appendChild(document.createElement("style")));const z="\\00B7";let K=f.textContent;K+=`.show-whitespace-characters .CodeMirror .cm-whitespace-${O}::before {`,K+=`content: "${z.repeat(O)}";`,K+="}",f.textContent=K}return`whitespace whitespace-${O}`}for(;!H.eol()&&H.peek()!==" ";)H.next();return null}})}),CodeMirror.defineExtension("hasLineClass",function(M,L,V){var H=L==="text"?"textClass":L==="background"?"bgClass":"wrapClass",O=this.lineInfo(M);if(!O||!O[H])return!1;if(O[H]===V)return!0;var z=O[H].indexOf(V);if(z===-1)return!1;var K=" "+O[H]+" ";return K.indexOf(" "+V+" ",z)!==-1}),CodeMirror.defineExtension("setUniqueBookmark",function(M,L){for(var V=this.findMarksAt(M),H=0;H<V.length;++H)if(V[H].__uniqueBookmark){V[H].clear();break}var O=this.setBookmark(M,L);return O.__uniqueBookmark=!0,O}),CodeMirror.defineExtension("toggleLineClass",function(M,L,V){return this.hasLineClass(M,L,V)?(this.removeLineClass(M,L,V),!1):(this.addLineClass(M,L,V),!0)}),CodeMirror.defineExtension("alterNumberInRange",function(M,L,V,H){if(L.line!==V.line)return!1;if(H)var O=this.getCursor("start"),z=this.getCursor("end");for(var K=this.getLine(L.line),q=!1,Y=NaN,se=NaN,ce=L.ch;ce>=0;--ce){var le=K.charAt(ce);if(le==="."){if(q)break;q=!0}else if(le!=="-"&&le!=="+"&&isNaN(parseInt(le))){if(ce===L.ch){se=ce;continue}break}Y=ce}if(isNaN(se))for(var ce=L.ch+1;ce<K.length;++ce){var le=K.charAt(ce);if(le==="."){if(q){se=ce;break}q=!0}else if(isNaN(parseInt(le))){se=ce;break}se=ce+1}if(isNaN(Y)||isNaN(se))return!1;var te=parseFloat(K.substring(Y,se)),ve=Number((te+M).toFixed(6)),Pe=ve.toString(),Be={line:L.line,ch:Y},qe={line:L.line,ch:se};if(this.replaceRange(Pe,Be,qe),H){var Ue=qe.ch-Be.ch,Ge=Pe.length;let it=Ge-Ue;O===z?O.ch+=it:(O.ch>Be.ch&&(O.ch+=it),z.ch>Be.ch&&(z.ch+=it)),this.setSelection(O,z)}return!0});function b(M,L){function V(K){var q=L.getTokenAt(K);return q&&q.type&&/\bnumber\b/.test(q.type)?q:null}var H=L.getCursor("head"),O=V(H);if(O||(H.ch+=1,O=V(H)),!O)return CodeMirror.Pass;var z=L.alterNumberInRange(M,{ch:O.start,line:H.line},{ch:O.end,line:H.line},!0);if(!z)return CodeMirror.Pass}CodeMirror.defineExtension("rectsForRange",function(M){for(var L=[],V=M.start.line;V<=M.end.line;++V){var H=this.getLine(V),O=V===M.start.line?M.start.ch:H.length-H.trimLeft().length,z=V===M.end.line?M.end.ch:H.length,K=this.cursorCoords({ch:O,line:V}),q=this.cursorCoords({ch:z,line:V});if(K.bottom!==q.bottom){for(var Y=-Number.MAX_VALUE,se=O;se<=z;++se){var ce=this.cursorCoords({ch:se,line:V});if(ce.bottom>Y){if(se>O){var le=Math.ceil(this.cursorCoords({ch:se-1,line:V}).right);L.push(new WI.Rect(te,ve,le-te,Y-ve))}var te=Math.floor(ce.left),ve=Math.floor(ce.top);Y=Math.ceil(ce.bottom)}}le=Math.ceil(ce.right),L.push(new WI.Rect(te,ve,le-te,Y-ve))}else{var te=Math.floor(K.left),ve=Math.floor(K.top),le=Math.ceil(q.right),Y=Math.ceil(q.bottom);L.push(new WI.Rect(te,ve,le-te,Y-ve))}}return L});let w=WI.Platform.name==="mac";CodeMirror.keyMap.default={"Alt-Up":b.bind(null,1),"Ctrl-Alt-Up":b.bind(null,.1),"Shift-Alt-Up":b.bind(null,10),"Alt-PageUp":b.bind(null,10),"Shift-Alt-PageUp":b.bind(null,100),"Alt-Down":b.bind(null,-1),"Ctrl-Alt-Down":b.bind(null,-.1),"Shift-Alt-Down":b.bind(null,-10),"Alt-PageDown":b.bind(null,-10),"Shift-Alt-PageDown":b.bind(null,-100),"Cmd-/":"toggleComment","Cmd-D":"selectNextOccurrence","Shift-Tab":"indentLess",fallthrough:w?"macDefault":"pcDefault"};var S=["text/xml","text/xsl"];S.forEach(function(M){CodeMirror.defineMIME(M,"xml")});var E=["application/xhtml+xml","image/svg+xml"];E.forEach(function(M){CodeMirror.defineMIME(M,"htmlmixed")});var k=["text/ecmascript","application/javascript","application/ecmascript","application/x-javascript","text/x-javascript","text/javascript1.1","text/javascript1.2","text/javascript1.3","text/jscript","text/livescript"];k.forEach(function(M){CodeMirror.defineMIME(M,"javascript")});var R=["application/x-json","text/x-json","application/vnd.api+json"];R.forEach(function(M){CodeMirror.defineMIME(M,{name:"javascript",json:!0})})})();WI.compareCodeMirrorPositions=function(c,e){var t=c.line-e.line;if(t!==0)return t;var i="ch"in c?c.ch:Number.MAX_VALUE,n="ch"in e?e.ch:Number.MAX_VALUE;return i-n};WI.walkTokens=function(c,e,t,i){let n=CodeMirror.copyState(e,c.getTokenAt(t).state);n.localState&&(n=n.localState);let s=c.lineCount(),a=!1;for(let d=t.line;!a&&d<s;++d){let p=c.getLine(d),f=new CodeMirror.StringStream(p);for(d===t.line&&(f.start=f.pos=t.ch);!f.eol();){let _=e.token(f,n);if(!i(_,f.current())){a=!0;break}f.start=f.pos}}a||i(null)};WI.tokenizeCSSValue=function(c){const e="*{X:";let t=e+c+"}",i=[],n=CodeMirror.getMode({indentUnit:0},"text/css"),s=CodeMirror.startState(n),a=new CodeMirror.StringStream(t);function d(p,f,_){_<e.length||p==="}"&&!f||i.push({value:p,type:f})}for(;!a.eol();){let p=n.token(a,s),f=a.current();d(f,p,a.start),a.start=a.pos}return i};WI.CodeMirrorEditor=class{static create(e,t){e.setAttribute("dir","ltr"),e.classList.toggle("read-only",t.readOnly);let i=new CodeMirror(e,{indentWithTabs:WI.settings.indentWithTabs.value,indentUnit:WI.settings.indentUnit.value,tabSize:WI.settings.tabSize.value,lineWrapping:WI.settings.enableLineWrapping.value,showWhitespaceCharacters:WI.settings.showWhitespaceCharacters.value,...t});function n(s,a){t[a]===void 0&&s.addEventListener(WI.Setting.Event.Changed,d=>{i.setOption(a,s.value)})}return n(WI.settings.indentWithTabs,"indentWithTabs"),n(WI.settings.indentUnit,"indentUnit"),n(WI.settings.tabSize,"tabSize"),n(WI.settings.enableLineWrapping,"lineWrapping"),n(WI.settings.showWhitespaceCharacters,"showWhitespaceCharacters"),WI.Platform.name==="mac"&&i.addKeyMap({Home:()=>{i.scrollIntoView({line:0,ch:0})},End:()=>{i.scrollIntoView({line:i.lineCount()-1,ch:null})}}),new WI.CodeMirrorTextKillController(i),i}};CodeMirror.extendMode("javascript",{shouldHaveSpaceBeforeToken:function(c,e,t,i,n,s){return t?s?!0:/\boperator\b/.test(t)?!c&&(n==="+"||n==="-"||n==="~")&&e!==")"&&e!=="]"||n==="!"?!1:"+-/*%&&||!===+=-=>=<=?".indexOf(n)>=0:/\bkeyword\b/.test(t)?n==="else"||n==="catch"||n==="finally"?e==="}":n==="while"&&e==="}"?i._jsPrettyPrint.lastContentBeforeBlock==="do":!1:!1:n==="("?c&&/\bkeyword\b/.test(c)&&e!=="function"&&e!=="typeof"&&e!=="instanceof":n===":"?i.lexical.type==="stat"||i.lexical.type===")"||i.lexical.type==="]":!1},shouldHaveSpaceAfterLastToken:function(c,e,t,i,n,s){return c&&/\bkeyword\b/.test(c)?e==="else"||e==="catch"?!0:e==="return"?n!==";":e==="throw"||e==="try"||e==="finally"||e==="do":c&&/\bcomment\b/.test(c)?!0:e===")"?n==="{":e===";"?i.lexical.type===")":e==="!"||(e==="+"||e==="-"||e==="~")&&!i._jsPrettyPrint.unaryOperatorHadLeadingExpr?!1:",+-/*%&&||:!===+=-=>=<=?".indexOf(e)>=0},newlinesAfterToken:function(c,e,t,i,n,s){return t?s?1:0:n===","?i.lexical.type==="}"?1:0:n===";"?i.lexical.type!==")"?1:0:n===":"&&i.lexical.type==="}"&&i.lexical.prev&&i.lexical.prev.type==="form"||n.length===1&&"{}".indexOf(n)>=0?1:0},removeLastWhitespace:function(c,e,t,i,n,s){return!1},removeLastNewline:function(c,e,t,i,n,s,a){return t?s?!a&&e===";":/\bkeyword\b/.test(t)?n==="else"||n==="catch"||n==="finally"?e==="}":n==="while"&&e==="}"?i._jsPrettyPrint.lastContentBeforeBlock==="do":!1:!1:n==="}"?e==="{":n===";"?"};".indexOf(e)>=0:n===":"?e==="}"&&(i.lexical.type==="stat"||i.lexical.type===")"||i.lexical.type==="]"):",().".indexOf(n)>=0?e==="}":!1},indentAfterToken:function(c,e,t,i,n,s){return n==="{"?!0:n==="case"||n==="default"?i.lexical.type==="}"&&i.lexical.prev&&i.lexical.prev.type==="form":!1},newlineBeforeToken:function(c,e,t,i,n,s){return i._jsPrettyPrint.shouldIndent?!0:n==="}"&&e!=="{"},indentBeforeToken:function(c,e,t,i,n,s){return!!i._jsPrettyPrint.shouldIndent},dedentsBeforeToken:function(c,e,t,i,n,s){var a=0;return i._jsPrettyPrint.shouldDedent&&(a+=i._jsPrettyPrint.dedentSize),(!t&&n==="}"||t&&/\bkeyword\b/.test(t)&&(n==="case"||n==="default"))&&(a+=1),a},modifyStateForTokenPre:function(c,e,t,i,n,s){if(i._jsPrettyPrint||(i._jsPrettyPrint={indentCount:0,shouldIndent:!1,shouldDedent:!1,dedentSize:0,lastIfIndentCount:0,openBraceStartMarkers:[],openBraceTrackingCount:-1,unaryOperatorHadLeadingExpr:!1,lastContentBeforeBlock:void 0}),!s&&i.lexical.prev&&i.lexical.prev.type==="form"&&!i.lexical.prev._jsPrettyPrintMarker&&(e===")"||e==="else"||e==="do")&&i.lexical.type!==")")if(n==="{"){var a={indentCount:i._jsPrettyPrint.indentCount,openBraceTrackingCount:i._jsPrettyPrint.openBraceTrackingCount,lastContentBeforeBlock:e};i._jsPrettyPrint.openBraceStartMarkers.push(a),i._jsPrettyPrint.openBraceTrackingCount=1}else i.lexical.type!=="}"&&(e==="else"&&n==="if"||(i._jsPrettyPrint.indentCount++,i._jsPrettyPrint.shouldIndent=!0),i.lexical.prev._jsPrettyPrintMarker=!0,i._jsPrettyPrint.enteringIf&&(i._jsPrettyPrint.lastIfIndentCount=i._jsPrettyPrint.indentCount-1));else if(console.assert(!i._jsPrettyPrint.shouldDedent),console.assert(!i._jsPrettyPrint.dedentSize),s||(n==="{"?i._jsPrettyPrint.openBraceTrackingCount++:n==="}"&&i._jsPrettyPrint.openBraceTrackingCount--),n!==";")if(n==="else")e!=="}"&&(i._jsPrettyPrint.shouldDedent=!0,i._jsPrettyPrint.dedentSize=i._jsPrettyPrint.indentCount-i._jsPrettyPrint.lastIfIndentCount,i._jsPrettyPrint.lastIfIndentCount=0);else if(n==="}"&&!i._jsPrettyPrint.openBraceTrackingCount&&i._jsPrettyPrint.openBraceStartMarkers.length){var a=i._jsPrettyPrint.openBraceStartMarkers.pop();i._jsPrettyPrint.shouldDedent=!0,i._jsPrettyPrint.dedentSize=i._jsPrettyPrint.indentCount-a.indentCount,i._jsPrettyPrint.openBraceTrackingCount=a.openBraceTrackingCount,i._jsPrettyPrint.lastContentBeforeBlock=a.lastContentBeforeBlock}else{for(var d=!0,p=i.lexical.prev;p;){if(p._jsPrettyPrintMarker){d=!1;break}p=p.prev}d&&(i._jsPrettyPrint.shouldDedent=!0,i._jsPrettyPrint.dedentSize=i._jsPrettyPrint.indentCount)}t&&i.lexical.type==="form"&&i.lexical.prev&&i.lexical.prev!=="form"&&/\bkeyword\b/.test(t)&&(i._jsPrettyPrint.enteringIf=n==="if")},modifyStateForTokenPost:function(c,e,t,i,n,s){i._jsPrettyPrint.shouldIndent&&(i._jsPrettyPrint.shouldIndent=!1),i._jsPrettyPrint.shouldDedent&&(i._jsPrettyPrint.indentCount-=i._jsPrettyPrint.dedentSize,i._jsPrettyPrint.dedentSize=0,i._jsPrettyPrint.shouldDedent=!1),(n==="+"||n==="-"||n==="~")&&(e===")"||e==="]"||/\b(?:variable|number)\b/.test(c))?i._jsPrettyPrint.unaryOperatorHadLeadingExpr=!0:i._jsPrettyPrint.unaryOperatorHadLeadingExpr=!1}});CodeMirror.extendMode("css",{shouldHaveSpaceBeforeToken:function(c,e,t,i,n,s){return t?s?!0:/\bkeyword\b/.test(t)?n.charAt(0)==="!":!1:n==="{"?!0:">+~-*/".indexOf(n)>=0},shouldHaveSpaceAfterLastToken:function(c,e,t,i,n,s){return c?/\bcomment\b/.test(c)?!0:/\bkeyword\b/.test(c)?i.state==="media"||i.state==="atBlock_parens"&&n!==")":!1:e===","?!0:e===":"?i.state==="prop":e===")"&&n!==")"&&n!==","?!!(/\bnumber\b/.test(t)||i.state==="prop"||i.state==="media"||i.state==="atBlock_parens"):">+~-*/".indexOf(e)>=0},newlinesAfterToken:function(c,e,t,i,n,s){return t?s?1:0:n===";"?1:n===","?(i.state==="top"||i.state==="media")&&i._cssPrettyPrint.lineLength>60?(i._cssPrettyPrint.lineLength=0,1):0:n==="{"?1:n==="}"?2:0},removeLastWhitespace:function(c,e,t,i,n,s){return!1},removeLastNewline:function(c,e,t,i,n,s,a){return s?!a&&e===";":n==="}"&&(e==="{"||e==="}")},indentAfterToken:function(c,e,t,i,n,s){return n==="{"},newlineBeforeToken:function(c,e,t,i,n,s){return n==="}"&&e!=="{"&&e!=="}"},indentBeforeToken:function(c,e,t,i,n,s){return!1},dedentsBeforeToken:function(c,e,t,i,n,s){return n==="}"?1:0},modifyStateForTokenPost:function(c,e,t,i,n,s){i._cssPrettyPrint||(i._cssPrettyPrint={lineLength:0}),!s&&(i.state==="top"||i.state==="media"||i.state==="pseudo")?i._cssPrettyPrint.lineLength+=n.length:i._cssPrettyPrint.lineLength=0}});CodeMirror.defineMode("regex",function(){function c(i,n){let s=n.currentContext();if(s.negatedCharacterSet===void 0&&(s.negatedCharacterSet=i.eat("^"),s.negatedCharacterSet))return"regex-character-set-negate";for(;i.peek();){if(i.eat("\\"))return e(i);if(i.eat("]"))return n.tokenize=t,n.popContext();i.next()}return"error"}function e(i){return i.match(/[bBdDwWsStrnvf0]/)?"regex-special":i.eat("x")?i.match(/[0-9a-fA-F]{2}/)?"regex-escape":"error":i.eat("u")?i.match(/[0-9a-fA-F]{4}/)?"regex-escape-2":"error":i.eat("c")?i.match(/[A-Z]/)?"regex-escape-3":"error":i.match(/[1-9]/)?"regex-backreference":i.next()?"regex-literal":"error"}function t(i,n){let s=i.next();if(s==="\\")return e(i);if(s==="("){let d;return i.match(/\?[=!]/)?d="regex-lookahead":(i.match(/\?:/),d="regex-group"),n.pushContext(i,d,")")}let a=n.currentContext();if(a&&a.type===s)return n.popContext();if(/[*+?]/.test(s))return"regex-quantifier";if(s==="{"){if(i.match(/\d+}/))return"regex-quantifier";let d=i.match(/(\d+),(\d+)?}/);if(!d)return"error";let p=parseInt(d[1]),f=parseInt(d[2]);return p>f?"error":"regex-quantifier"}return s==="["?(n.tokenize=c,n.pushContext(i,"regex-character-set")):/[.^$|]/.test(s)?"regex-special":null}return{startState:function(){let i=[];return{currentContext:function(){return i.length?i[i.length-1]:null},pushContext:function(n,s,a){let d={data:s,type:a};return i.push(d),s},popContext:function(){return console.assert(i.length,"Tried to pop empty context stack."),i.pop().data},tokenize:t}},token:function(i,n){return n.tokenize(i,n)}}});CodeMirror.defineMIME("text/x-regex","regex");function createCodeMirrorTextMarkers({codeMirror:c,range:e,type:t,pattern:i,matchFunction:n,allowedTokens:s,callback:a}){for(var d=[],p=e instanceof WI.TextRange?e.startLine:0,f=e instanceof WI.TextRange?e.endLine+1:c.lineCount(),_=p;_<f;++_)for(var b=c.getLine(_),w=i.exec(b);w;){if(typeof n=="function"&&!n(b,w)){w=i.exec(b);continue}for(var S={line:_,ch:w.index},E={line:_,ch:w.index+w[0].length},k=!1,R=c.findMarksAt(E),M=0;M<R.length;++M)if(WI.TextMarker.textMarkerForCodeMirrorTextMarker(R[M]).type===WI.TextMarker.Type[t]){k=!0;break}if(k){w=i.exec(b);continue}var L=c.getTokenTypeAt(S);if(L&&!L.includes("keyword")&&(!s||!s.test(L))){w=i.exec(b);continue}let H=w[1],O=WI[t]?WI[t].fromString(H):null;if(WI[t]&&!O){w=i.exec(b);continue}var V=c.markText(S,E);V=new WI.TextMarker(V,WI.TextMarker.Type[t]),d.push(V),typeof a=="function"&&a(V,O,H),w=i.exec(b)}return d}function createCodeMirrorColorTextMarkers(c,e,t={}){const i=/((?:rgb|hsl)a?\([^)]+\)|#[0-9a-fA-F]{8}|#[0-9a-fA-F]{6}|#[0-9a-fA-F]{3,4}|\b\w+\b(?![-.]))/g;function n(s,a){if(!s||!s.length)return!1;let d=0,p=a.index,f=null;for(;(f=s[p])&&(f==="("&&++d,f===")"&&--d,!(d>0||(--p,p<0))););return/(repeating-)?(linear|radial)-gradient$/.test(s.substring(0,p))?!1:!(a.index>0&&/[-.\"\']/.test(s[a.index-1]))}return createCodeMirrorTextMarkers({codeMirror:c,range:e,type:"Color",pattern:i,matchFunction:n,...t})}function createCodeMirrorGradientTextMarkers(c,e,t={}){for(var i=[],n=e instanceof WI.TextRange?e.startLine:0,s=e instanceof WI.TextRange?e.endLine+1:c.lineCount(),a=/(repeating-)?(linear|radial)-gradient\s*\(\s*/g,d=n;d<s;++d)for(var p=c.getLine(d),f=a.exec(p);f;){for(var _=d,b=f.index,w=f.index+f[0].length,S=0,E=null;E=p[w];){if(E==="("&&S++,E===")"&&S--,S===-1){w++;break}if(w++,w>=p.length&&(d++,w=0,p=c.getLine(d),!p))break}if(S!==-1){f=a.exec(p);continue}var k={line:_,ch:b},R={line:d,ch:w},M=c.getRange(k,R),L=WI.Gradient.fromString(M);if(!L){f=a.exec(p);continue}var V=new WI.TextMarker(c.markText(k,R),WI.TextMarker.Type.Gradient);i.push(V),typeof callback=="function"&&t.callback(V,L,M),f=a.exec(p)}return i}function createCodeMirrorCubicBezierTextMarkers(c,e,t={}){return createCodeMirrorTextMarkers({codeMirror:c,range:e,type:"CubicBezier",pattern:/(cubic-bezier\([^)]+\)|\b\w+\b(?:-\b\w+\b){0,2})/g,...t})}function createCodeMirrorSpringTextMarkers(c,e,t={}){return createCodeMirrorTextMarkers({codeMirror:c,range:e,type:"Spring",pattern:/(spring\([^)]+\))/g,...t})}WI.ColorPicker=class extends WI.Object{constructor(){super(),this._colorWheel=new WI.ColorWheel(this,200),this._brightnessSlider=new WI.Slider,this._brightnessSlider.delegate=this,this._brightnessSlider.element.classList.add("brightness"),this._opacitySlider=new WI.Slider,this._opacitySlider.delegate=this,this._opacitySlider.element.classList.add("opacity");let e=document.createElement("div");e.classList.add("color-inputs");let t=(i,{min:n,max:s,step:a,units:d}={})=>{let p=e.createChild("div");p.append(i);let f=p.createChild("input");return f.type="number",f.min=n||0,f.max=s||100,f.step=a||1,f.addEventListener("input",this._handleColorInputInput.bind(this)),d&&d.length&&p.append(d),{containerElement:p,numberInputElement:f}};this._colorInputs=new Map([["R",t("R",{max:255})],["G",t("G",{max:255})],["B",t("B",{max:255})],["H",t("H",{max:360})],["S",t("S",{units:"%"})],["L",t("L",{units:"%"})],["A",t("A",{max:1,step:.01})]]),this._element=document.createElement("div"),this._element.classList.add("color-picker"),this._element.appendChild(this._colorWheel.element),this._element.appendChild(this._brightnessSlider.element),this._element.appendChild(this._opacitySlider.element),this._element.appendChild(e),this._opacity=0,this._opacityPattern="url(Images/Checkers.svg)",this._color=WI.Color.fromString("white"),this._dontUpdateColor=!1,this._enableColorComponentInputs=!0}get element(){return this._element}set brightness(e){e!==this._brightness&&(this._colorWheel.brightness=e,this._updateColor(),this._updateSliders(this._colorWheel.rawColor,this._colorWheel.tintedColor))}set opacity(e){e!==this._opacity&&(this._opacity=e,this._updateColor())}get colorWheel(){return this._colorWheel}get color(){return this._color}set color(e){console.assert(e instanceof WI.Color),this._dontUpdateColor=!0;let t=!this._color||this._color.format!==e.format;this._color=e,this._colorWheel.tintedColor=this._color,this._brightnessSlider.value=this._colorWheel.brightness/100,this._opacitySlider.value=this._color.alpha,this._updateSliders(this._colorWheel.rawColor,this._color),this._showColorComponentInputs(),t&&this._handleFormatChange(),this._dontUpdateColor=!1}set enableColorComponentInputs(e){this._enableColorComponentInputs=e,this._showColorComponentInputs()}colorWheelColorDidChange(e){this._updateColor(),this._updateSliders(this._colorWheel.rawColor,this._colorWheel.tintedColor)}sliderValueDidChange(e,t){e===this._opacitySlider?this.opacity=t:e===this._brightnessSlider&&(this.brightness=t*100)}_updateColor(){if(this._dontUpdateColor)return;let e=Math.round(this._opacity*100)/100,t=this._color.format,i=null;t===WI.Color.Format.HSL||t===WI.Color.Format.HSLA?(i=this._colorWheel.tintedColor.hsl.concat(e),e!==1&&(t=WI.Color.Format.HSLA)):(i=this._colorWheel.tintedColor.rgb.concat(e),e!==1&&t===WI.Color.Format.RGB&&(t=WI.Color.Format.RGBA));let n=this._color.format===t;this._color=new WI.Color(t,i),this._showColorComponentInputs(),this.dispatchEventToListeners(WI.ColorPicker.Event.ColorChanged,{color:this._color}),n&&this._handleFormatChange()}_updateSliders(e,t){var i=this._colorWheel.tintedColor.rgb,n=new WI.Color(WI.Color.Format.RGBA,i.concat(1)).toString(),s=new WI.Color(WI.Color.Format.RGBA,i.concat(0)).toString();this._brightnessSlider.element.style.setProperty("background-image",`linear-gradient(90deg, black, ${e}, white)`),this._opacitySlider.element.style.setProperty("background-image","linear-gradient(90deg, "+s+", "+n+"), "+this._opacityPattern)}_handleFormatChange(){this._element.classList.toggle("hide-inputs",this._color.format!==WI.Color.Format.Keyword&&this._color.format!==WI.Color.Format.RGB&&this._color.format!==WI.Color.Format.RGBA&&this._color.format!==WI.Color.Format.HEX&&this._color.format!==WI.Color.Format.ShortHEX&&this._color.format!==WI.Color.Format.HEXAlpha&&this._color.format!==WI.Color.Format.ShortHEXAlpha&&this._color.format!==WI.Color.Format.HSL&&this._color.format!==WI.Color.Format.HSLA),this.dispatchEventToListeners(WI.ColorPicker.Event.FormatChanged)}_showColorComponentInputs(){for(let{containerElement:p}of this._colorInputs.values())p.hidden=!0;if(!this._enableColorComponentInputs)return;function e(p,f){let{containerElement:_,numberInputElement:b}=this._colorInputs.get(p);b.value=f,_.hidden=!1}switch(this._color.format){case WI.Color.Format.RGB:case WI.Color.Format.RGBA:case WI.Color.Format.HEX:case WI.Color.Format.ShortHEX:case WI.Color.Format.HEXAlpha:case WI.Color.Format.ShortHEXAlpha:case WI.Color.Format.Keyword:var[t,i,n]=this._color.rgb;e.call(this,"R",Math.round(t)),e.call(this,"G",Math.round(i)),e.call(this,"B",Math.round(n));break;case WI.Color.Format.HSL:case WI.Color.Format.HSLA:var[s,a,d]=this._color.hsl;e.call(this,"H",s.maxDecimals(2)),e.call(this,"S",a.maxDecimals(2)),e.call(this,"L",d.maxDecimals(2));break;default:return}(this._color.format===WI.Color.Format.Keyword&&this._color.alpha!==1||this._color.format===WI.Color.Format.RGBA||this._color.format===WI.Color.Format.HSLA||this._color.format===WI.Color.Format.HEXAlpha||this._color.format===WI.Color.Format.ShortHEXAlpha)&&e.call(this,"A",this._color.alpha)}_handleColorInputInput(e){if(!this._enableColorComponentInputs){WI.reportInternalError("Input event fired for disabled color component input");return}let t=this._colorInputs.get("R").numberInputElement.value,i=this._colorInputs.get("G").numberInputElement.value,n=this._colorInputs.get("B").numberInputElement.value,s=this._colorInputs.get("H").numberInputElement.value,a=this._colorInputs.get("S").numberInputElement.value,d=this._colorInputs.get("L").numberInputElement.value,p=this._colorInputs.get("A").numberInputElement.value,f="",_=this._color.format;switch(_){case WI.Color.Format.RGB:case WI.Color.Format.HEX:case WI.Color.Format.ShortHEX:case WI.Color.Format.Keyword:f=`rgb(${t}, ${i}, ${n})`;break;case WI.Color.Format.RGBA:case WI.Color.Format.HEXAlpha:case WI.Color.Format.ShortHEXAlpha:f=`rgba(${t}, ${i}, ${n}, ${p})`;break;case WI.Color.Format.HSL:f=`hsl(${s}, ${a}%, ${d}%)`;break;case WI.Color.Format.HSLA:f=`hsla(${s}, ${a}%, ${d}%, ${p})`;break;default:WI.reportInternalError(`Input event fired for invalid color format "${this._color.format}"`);return}let b=WI.Color.fromString(f);b.toString()!==this._color.toString()&&(this.color=b,this._color.format=_,this.dispatchEventToListeners(WI.ColorPicker.Event.ColorChanged,{color:this._color}))}};WI.ColorPicker.Event={ColorChanged:"css-color-picker-color-changed",FormatChanged:"css-color-picker-format-changed"};WI.ColorWheel=class extends WI.Object{constructor(e,t){console.assert(!isNaN(t)),super(),this._delegate=e,this._brightness=50,this._element=document.createElement("div"),this._element.className="color-wheel",this._canvasElement=this._element.appendChild(document.createElement("canvas")),this._canvasElement.addEventListener("mousedown",this),this._canvasContext=this._canvasElement.getContext("2d"),this._crosshairElement=this._element.appendChild(document.createElement("div")),this._crosshairElement.className="crosshair",this.dimension=t}get element(){return this._element}set dimension(e){if(e===this._dimension)return;this._dimension=e,this._element.style.width=this.element.style.height=`${this._dimension}px`,this._canvasElement.width=this._canvasElement.height=this._dimension*window.devicePixelRatio;let t=this._dimension/2;this._setCrosshairPosition(new WI.Point(t,t)),this._updateCanvas()}get brightness(){return this._brightness}set brightness(e){e!==this._brightness&&(this._brightness=e,this._updateCanvas())}get tintedColor(){return this._crosshairPosition?new WI.Color(WI.Color.Format.HSL,[this._hue,this._saturation,this._brightness]):new WI.Color(WI.Color.Format.HSLA,[0,0,0,0])}set tintedColor(e){let t=e.hsl,i=Math.cos(t[0]*Math.PI/180),n=Math.sin(t[0]*Math.PI/180),s=this._dimension/2,a=s+n*t[1],d=s-i*t[1];this._setCrosshairPosition(new WI.Point(a,d)),this.brightness=t[2]}get rawColor(){return this._crosshairPosition?new WI.Color(WI.Color.Format.HSL,[this._hue,this._saturation,50]):new WI.Color(WI.Color.Format.HSLA,[0,0,0,0])}handleEvent(e){switch(e.type){case"mousedown":this._handleMousedown(e);break;case"mousemove":this._handleMousemove(e);break;case"mouseup":this._handleMouseup(e);break}}get _hue(){let e=this._dimension/2,t=Math.atan2(this._crosshairPosition.x-e,e-this._crosshairPosition.y)*180/Math.PI;return t<0&&(t+=360),t}get _saturation(){let e=this._dimension/2,t=(this._crosshairPosition.x-e)/e,i=(this._crosshairPosition.y-e)/e;return Math.sqrt(Math.pow(t,2)+Math.pow(i,2))*100}_handleMousedown(e){window.addEventListener("mousemove",this,!0),window.addEventListener("mouseup",this,!0),this._updateColorForMouseEvent(e)}_handleMousemove(e){this._updateColorForMouseEvent(e)}_handleMouseup(e){window.removeEventListener("mousemove",this,!0),window.removeEventListener("mouseup",this,!0)}_updateColorForMouseEvent(e){var t=window.webkitConvertPointFromPageToNode(this._canvasElement,new WebKitPoint(e.pageX,e.pageY));this._setCrosshairPosition(t),this._delegate&&typeof this._delegate.colorWheelColorDidChange=="function"&&this._delegate.colorWheelColorDidChange(this)}_setCrosshairPosition(e){let t=this._dimension/2,i=new WI.Point(t,t);if(i.distance(e)>t){let n=Math.atan2(e.y-i.y,e.x-i.x);e=new WI.Point(i.x+t*Math.cos(n),i.y+t*Math.sin(n))}this._crosshairPosition=e,this._crosshairElement.style.setProperty("transform","translate("+Math.round(e.x)+"px, "+Math.round(e.y)+"px)")}_updateCanvas(){let e=this._dimension*window.devicePixelRatio,t=e/2,i=this._canvasContext.createImageData(e,e);for(let n=0;n<e;++n)for(let s=0;s<e;++s){let a=(s-t)/t,d=(n-t)/t,p=Math.sqrt(Math.pow(a,2)+Math.pow(d,2))*100;if(p>100)continue;let f=Math.atan2(s-t,t-n)*180/Math.PI;f<0&&(f+=360);let _=WI.Color.hsl2rgb(f,p,this._brightness),b=(n*e+s)*4;i.data[b]=_[0],i.data[b+1]=_[1],i.data[b+2]=_[2],i.data[b+3]=255}this._canvasContext.putImageData(i,0,0)}};WI.ColumnChart=class extends WI.View{constructor(e){super(),this.element.classList.add("column-chart"),this._svgElement=this.element.appendChild(createSVGElement("svg")),this._svgElement.setAttribute("preserveAspectRatio","none"),this._columns=[],this.size=e}get size(){return this._size}set size(e){this._size=e,this._svgElement.setAttribute("viewBox",`0 0 ${e.width} ${e.height}`)}addColumn(e,t,i,n){this._columns.push({x:e,y:t,width:i,height:n})}clear(){this._columns=[]}layout(){if(super.layout(),this.layoutReason!==WI.View.LayoutReason.Resize){this._svgElement.removeChildren();for(let{x:e,y:t,width:i,height:n}of this._columns){let s=this._svgElement.appendChild(createSVGElement("rect"));s.setAttribute("width",i),s.setAttribute("height",n),s.setAttribute("x",e),s.setAttribute("y",t)}}}};WI.CompletionSuggestionsView=class extends WI.Object{constructor(e,{preventBlur:t}={}){super(),this._delegate=e||null,this._preventBlur=t||!1,this._selectedIndex=NaN,this._moveIntervalIdentifier=null,this._element=document.createElement("div"),this._element.setAttribute("dir","ltr"),this._element.classList.add("completion-suggestions",WI.Popover.IgnoreAutoDismissClassName),this._containerElement=document.createElement("div"),this._containerElement.classList.add("completion-suggestions-container"),this._containerElement.addEventListener("mousedown",this._mouseDown.bind(this)),this._containerElement.addEventListener("mouseup",this._mouseUp.bind(this)),this._containerElement.addEventListener("click",this._itemClicked.bind(this)),this._element.appendChild(this._containerElement)}get delegate(){return this._delegate}get visible(){return!!this._element.parentNode}get selectedIndex(){return this._selectedIndex}set selectedIndex(e){var t=this._selectedItemElement;t&&t.classList.remove("selected"),this._selectedIndex=e,t=this._selectedItemElement,t&&(t.classList.add("selected"),t.scrollIntoViewIfNeeded(!1))}selectNext(){var e=this._containerElement.children.length;isNaN(this._selectedIndex)||this._selectedIndex===e-1?this.selectedIndex=0:++this.selectedIndex;var t=this._selectedItemElement;t&&this._delegate&&typeof this._delegate.completionSuggestionsSelectedCompletion=="function"&&this._delegate.completionSuggestionsSelectedCompletion(this,t.textContent)}selectPrevious(){isNaN(this._selectedIndex)||this._selectedIndex===0?this.selectedIndex=this._containerElement.children.length-1:--this.selectedIndex;var e=this._selectedItemElement;e&&this._delegate&&typeof this._delegate.completionSuggestionsSelectedCompletion=="function"&&this._delegate.completionSuggestionsSelectedCompletion(this,e.textContent)}isHandlingClickEvent(){return this._mouseIsDown}show(e){let t=this._containerElement.scrollTop;this._containerElement.style.position="absolute",document.body.appendChild(this._containerElement);var i=this._containerElement.offsetWidth,n=this._containerElement.offsetHeight;this._containerElement.removeAttribute("style"),this._element.appendChild(this._containerElement);var s=10,a=22,d=160,p=e.origin.x,f=e.origin.y+e.size.height,_=window.innerWidth-e.origin.x-s,b=Math.min(i,_-a)+a,w=i+a;b<w&&(_=window.innerWidth-s,b=Math.min(i,_-a)+a,p=document.body.offsetWidth-b);var S=e.origin.y,E=window.innerHeight-e.origin.y-e.size.height,k=Math.min(d,Math.max(E,S)-s),R=Math.min(n,k);E-R<0&&(f=S-R),this._element.style.left=p+"px",this._element.style.top=f+"px",this._element.style.width=b+"px",this._element.style.height=R+"px",document.body.appendChild(this._element),t&&(this._containerElement.scrollTop=t)}hide(){this._element.remove(),this._stopMoveTimer()}hideWhenElementMoves(e){this._stopMoveTimer();let t=e.getBoundingClientRect();this._moveIntervalIdentifier=setInterval(()=>{let i=e.getBoundingClientRect();(i.x!==t.x||i.y!==t.y)&&this.hide()},200)}update(e,t){this._containerElement.removeChildren(),typeof t=="number"&&(this._selectedIndex=t);for(var i=0;i<e.length;++i){var n=document.createElement("div");n.classList.add("item"),n.classList.toggle("selected",i===this._selectedIndex),n.textContent=e[i],this._containerElement.appendChild(n),this._delegate&&typeof this._delegate.completionSuggestionsViewCustomizeCompletionElement=="function"&&this._delegate.completionSuggestionsViewCustomizeCompletionElement(this,n,e[i])}}get _selectedItemElement(){if(isNaN(this._selectedIndex))return null;var e=this._containerElement.children[this._selectedIndex]||null;return console.assert(e),e}_mouseDown(e){e.button===0&&(this._preventBlur&&e.preventDefault(),this._mouseIsDown=!0)}_mouseUp(e){e.button===0&&(this._mouseIsDown=!1)}_itemClicked(e){if(e.button!==0)return;let t=e.target.closest(".item");console.assert(t),!!t&&this._delegate&&typeof this._delegate.completionSuggestionsClickedCompletion=="function"&&this._delegate.completionSuggestionsClickedCompletion(this,t.textContent)}_stopMoveTimer(){!this._moveIntervalIdentifier||(clearInterval(this._moveIntervalIdentifier),this._moveIntervalIdentifier=null)}};WI.ComputedStyleDetailsPanel=class extends WI.StyleDetailsPanel{constructor(e){super(e,WI.ComputedStyleDetailsPanel.StyleClassName,"computed",WI.UIString("Styles \u2014 Computed")),this._computedStyleShowAllSetting=new WI.Setting("computed-style-show-all",!1),this._filterText=null}refresh(e){if(!e){super.refresh();return}this._computedStyleSection.styleTraces=this._computePropertyTraces(this.nodeStyles.uniqueOrderedStyles),this._computedStyleSection.style=this.nodeStyles.computedStyle,this._variablesTextEditor.style=this.nodeStyles.computedStyle,this._variablesSection.element.classList.toggle("hidden",!this._variablesTextEditor.propertiesToRender.length),this._boxModelDiagramRow.nodeStyles=this.nodeStyles,this._filterText&&this.applyFilter(this._filterText),super.refresh()}applyFilter(e){this._filterText=e,this.didInitialLayout&&(this._computedStyleSection.applyFilter(e),this._variablesTextEditor.applyFilter(e))}spreadsheetCSSStyleDeclarationEditorShowProperty(e,t){this._delegate.computedStyleDetailsPanelShowProperty&&this._delegate.computedStyleDetailsPanelShowProperty(t)}initialLayout(){let e=document.createElement("label");e.textContent=WI.UIString("Show All"),this._computedStyleShowAllCheckbox=document.createElement("input"),this._computedStyleShowAllCheckbox.type="checkbox",this._computedStyleShowAllCheckbox.checked=this._computedStyleShowAllSetting.value,this._computedStyleShowAllCheckbox.addEventListener("change",this._computedStyleShowAllCheckboxValueChanged.bind(this)),e.appendChild(this._computedStyleShowAllCheckbox),this._computedStyleSection=new WI.ComputedStyleSection(this),this._computedStyleSection.propertyVisibilityMode=WI.ComputedStyleSection.PropertyVisibilityMode.HideVariables,this._computedStyleSection.addEventListener(WI.ComputedStyleSection.Event.FilterApplied,this._handleEditorFilterApplied,this),this._computedStyleSection.showsImplicitProperties=this._computedStyleShowAllSetting.value,this._computedStyleSection.alwaysShowPropertyNames=["display","width","height"],this._computedStyleSection.hideFilterNonMatchingProperties=!0;let t=new WI.DetailsSectionRow,i=new WI.DetailsSectionGroup([t]);this._propertiesSection=new WI.DetailsSection("computed-style-properties",WI.UIString("Properties"),[i],e),this._propertiesSection.addEventListener(WI.DetailsSection.Event.CollapsedStateChanged,this._handlePropertiesSectionCollapsedStateChanged,this),this.addSubview(this._computedStyleSection),t.element.appendChild(this._computedStyleSection.element),this._variablesTextEditor=new WI.SpreadsheetCSSStyleDeclarationEditor(this),this._variablesTextEditor.propertyVisibilityMode=WI.SpreadsheetCSSStyleDeclarationEditor.PropertyVisibilityMode.HideNonVariables,this._variablesTextEditor.hideFilterNonMatchingProperties=!0,this._variablesTextEditor.sortPropertiesByName=!0,this._variablesTextEditor.addEventListener(WI.SpreadsheetCSSStyleDeclarationEditor.Event.FilterApplied,this._handleEditorFilterApplied,this);let n=new WI.DetailsSectionRow,s=new WI.DetailsSectionGroup([n]);this._variablesSection=new WI.DetailsSection("computed-style-properties",WI.UIString("Variables"),[s]),this._variablesSection.addEventListener(WI.DetailsSection.Event.CollapsedStateChanged,this._handleVariablesSectionCollapsedStateChanged,this),this.addSubview(this._variablesTextEditor),n.element.appendChild(this._variablesTextEditor.element),this.element.appendChild(this._propertiesSection.element),this.element.appendChild(this._variablesSection.element),this._boxModelDiagramRow=new WI.BoxModelDetailsSectionRow;let a=new WI.DetailsSectionGroup([this._boxModelDiagramRow]),d=new WI.DetailsSection("computed-style-box-model",WI.UIString("Box Model"),[a]);this.element.appendChild(d.element)}filterDidChange(e){super.filterDidChange(e),this.applyFilter(e.filters.text)}_computePropertyTraces(e){let t=new Map;for(let i of e)for(let n of i.properties){let s=t.get(n.name);s||(s=[],t.set(n.name,s)),s.push(n)}return t}_computedStyleShowAllCheckboxValueChanged(e){let t=this._computedStyleShowAllCheckbox.checked;this._computedStyleShowAllSetting.value=t,this._computedStyleSection.showsImplicitProperties=t}_handlePropertiesSectionCollapsedStateChanged(e){e&&e.data&&!e.data.collapsed&&this._computedStyleSection.needsLayout()}_handleVariablesSectionCollapsedStateChanged(e){e&&e.data&&!e.data.collapsed&&this._variablesTextEditor.needsLayout()}_handleEditorFilterApplied(e){let t=null;e.target===this._computedStyleSection?t=this._propertiesSection:e.target===this._variablesTextEditor&&(t=this._variablesSection),t&&t.element.classList.toggle("hidden",!e.data.matches)}};WI.ComputedStyleDetailsPanel.StyleClassName="computed";WI.ComputedStyleSection=class extends WI.View{constructor(e){super(),this.element.classList.add(WI.ComputedStyleSection.StyleClassName),this.element.dir="ltr",this._delegate=e,this._style=null,this._styleTraces=[],this._propertyViews=[],this._showsImplicitProperties=!1,this._alwaysShowPropertyNames=new Set,this._propertyVisibilityMode=WI.ComputedStyleSection.PropertyVisibilityMode.ShowAll,this._hideFilterNonMatchingProperties=!1,this._filterText=null}get style(){return this._style}set style(e){this._style!==e&&(this._style&&this._style.removeEventListener(WI.CSSStyleDeclaration.Event.PropertiesChanged,this._handlePropertiesChanged,this),this._style=e||null,this._style&&this._style.addEventListener(WI.CSSStyleDeclaration.Event.PropertiesChanged,this._handlePropertiesChanged,this),this.needsLayout())}get styleTraces(){return this._styleTraces}set styleTraces(e){Array.shallowEqual(this._styleTraces,e)||(this._styleTraces=e||null,this.needsLayout())}set showsImplicitProperties(e){e!==this._showsImplicitProperties&&(this._showsImplicitProperties=e,this.needsLayout())}set alwaysShowPropertyNames(e){this._alwaysShowPropertyNames=new Set(e),this.needsLayout()}set propertyVisibilityMode(e){this._propertyVisibilityMode!==e&&(this._propertyVisibilityMode=e,this.needsLayout())}set hideFilterNonMatchingProperties(e){e!==this._hideFilterNonMatchingProperties&&(this._hideFilterNonMatchingProperties=e,this.needsLayout())}get propertiesToRender(){let e=[];return this._style?(this._style._styleSheetTextRange?e=this._style.visibleProperties:e=this._style.properties,e.sort((t,i)=>t.name.extendedLocaleCompare(i.name)),e.filter(t=>!t.variable&&this._propertyVisibilityMode===WI.ComputedStyleSection.PropertyVisibilityMode.HideNonVariables||t.variable&&this._propertyVisibilityMode===WI.ComputedStyleSection.PropertyVisibilityMode.HideVariables?!1:!t.implicit||this._showsImplicitProperties||this._alwaysShowPropertyNames.has(t.canonicalName))):e}layout(){super.layout(),this.element.removeChildren(),this._propertyViews=[];let e=this.propertiesToRender;for(let t=0;t<e.length;t++){let i=e[t],n=new WI.SpreadsheetStyleProperty(this,i);if(this._filterText&&!n.applyFilter(this._filterText))continue;n.index=t,this._propertyViews.push(n);let s=this._styleTraces?this._styleTraces.get(i.name):null,a=null;s&&s.length>0&&(a=this._createTrace(s));let d=new WI.ExpandableView(i.name,n.element,a);d.element.classList.add("computed-property-item"),this.element.append(d.element)}}detached(){super.detached();for(let e of this._propertyViews)e.detached()}hidden(){for(let e of this._propertyViews)e.hidden()}applyFilter(e){this._filterText=e,this.didInitialLayout&&this.needsLayout()}spreadsheetStylePropertyShowProperty(e,t){this._delegate.spreadsheetCSSStyleDeclarationEditorShowProperty&&this._delegate.spreadsheetCSSStyleDeclarationEditorShowProperty(this,t)}_createTrace(e){let t=document.createElement("ul");t.className="property-traces";for(let i of e){let n=document.createElement("li");n.className="property-trace-item";let s=document.createElement("div");s.className="property-trace-item-left";let a=document.createElement("div");a.className="property-trace-item-right",n.append(s,a);let d=new WI.SpreadsheetStyleProperty(this,i,{readOnly:!0}),p="",f=i.ownerStyle;if(f){let b=f.ownerRule;b&&(p=b.selectorText)}let _=document.createElement("span");if(_.textContent=p.truncateMiddle(24),_.className="selector",s.append(d.element,_),i.ownerStyle){let b=new WI.StyleOriginView;b.update(i.ownerStyle),a.append(b.element)}t.append(n)}return t}_handlePropertiesChanged(e){this.needsLayout()}};WI.ComputedStyleSection.Event={FilterApplied:"computed-style-section-filter-applied"};WI.ComputedStyleSection.StyleClassName="computed-style-section";WI.ComputedStyleSection.PropertyVisibilityMode={ShowAll:Symbol("variable-visibility-show-all"),HideVariables:Symbol("variable-visibility-hide-variables"),HideNonVariables:Symbol("variable-visibility-hide-non-variables")};WI.ConsoleDrawer=class extends WI.ContentBrowser{constructor(e){super(e,null,!0,!1),this.element.classList.add("console-drawer"),this._drawerHeightSetting=new WI.Setting("console-drawer-height",150),this.navigationBar.element.addEventListener("mousedown",this._consoleResizerMouseDown.bind(this)),this._toggleDrawerButton=new WI.ToggleButtonNavigationItem("toggle-drawer",WI.UIString("Hide Console"),WI.UIString("Show Console"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect stroke='currentColor' fill='none' x='1.5' y='2.5' width='13' height='11'/%3e %3cpath fill='none' stroke='currentColor' d='M 4.5 6.5 L 8 10 L 11.5 6.5 Z'/%3e %3c/svg%3e","data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect stroke='currentColor' fill='none' x='1.5' y='2.5' width='13' height='11'/%3e %3cpath fill='none' stroke='currentColor' d='M 4.5 10 L 8 6.5 L 11.5 10 Z'/%3e %3c/svg%3e"),this._toggleDrawerButton.visibilityPriority=WI.NavigationItem.VisibilityPriority.High,this._toggleDrawerButton.addEventListener(WI.ButtonNavigationItem.Event.Clicked,()=>{WI.toggleSplitConsole()}),this.navigationBar.insertNavigationItem(this._toggleDrawerButton,0),this.collapsed=!0,WI.TabBrowser.addEventListener(WI.TabBrowser.Event.SelectedTabContentViewDidChange,this._selectedTabContentViewDidChange,this)}toggleButtonShortcutTooltip(e){this._toggleDrawerButton.defaultToolTip=WI.UIString("Hide Console (%s)").format(e.displayName)}get collapsed(){return this._collapsed}set collapsed(e){e!==this._collapsed&&(this._collapsed=e||!1,this._toggleDrawerButton.toggled=this._collapsed,this.element.classList.toggle("hidden",this._collapsed),this._collapsed?this.hidden():this.shown(),this.dispatchEventToListeners(WI.ConsoleDrawer.Event.CollapsedStateChanged))}get height(){return this.element.offsetHeight}shown(){super.shown(),this._restoreDrawerHeight()}sizeDidChange(){if(super.sizeDidChange(),this._collapsed)return;let e=this.height;this._restoreDrawerHeight(),e!==this.height&&this.dispatchEventToListeners(WI.ConsoleDrawer.Event.Resized)}_consoleResizerMouseDown(e){if(e.button!==0||e.ctrlKey||e.target!==this.navigationBar.element&&!e.target.classList.contains("flexible-space"))return;let t=e.target,n=window.innerHeight-(this.element.totalOffsetTop+this.height)-(e.pageY-t.totalOffsetTop);function s(d){let p=window.innerHeight-d.pageY-n;this._drawerHeightSetting.value=p,this._updateDrawerHeight(p),this.collapsed=!1}function a(d){d.button===0&&WI.elementDragEnd(d)}WI.elementDragStart(t,s.bind(this),a.bind(this),e,"row-resize")}_restoreDrawerHeight(){this._updateDrawerHeight(this._drawerHeightSetting.value)}_updateDrawerHeight(e){const i=this.element.parentNode.offsetHeight-100;let n=Number.constrain(e,64,i)+"px";this.element.style.height!==n&&(this.element.style.height=n,this.dispatchEventToListeners(WI.ConsoleDrawer.Event.Resized))}_selectedTabContentViewDidChange(){WI.doesCurrentTabSupportSplitContentBrowser()||this.element.classList.add("hidden")}};WI.ConsoleDrawer.Event={CollapsedStateChanged:"console-drawer-collapsed-state-changed",Resized:"console-drawer-resized"};WI.ConsoleGroup=class extends WI.Object{constructor(e){super(),this._parentGroup=e}get parentGroup(){return this._parentGroup}render(e){var t=document.createElement("div");t.className="console-group",t.group=this,this.element=t;var i=e.element;i.classList.add(WI.LogContentView.ItemWrapperStyleClassName),i.addEventListener("click",this._titleClicked.bind(this)),i.addEventListener("mousedown",this._titleMouseDown.bind(this)),t&&e.message.type===WI.ConsoleMessage.MessageType.StartGroupCollapsed&&t.classList.add("collapsed"),t.appendChild(i);var n=document.createElement("div");return this._messagesElement=n,n.className="console-group-messages",t.appendChild(n),t}addMessageView(e){var t=e.element;t.classList.add(WI.LogContentView.ItemWrapperStyleClassName),this.append(t)}append(e){this._messagesElement.appendChild(e)}_titleMouseDown(e){e.preventDefault()}_titleClicked(e){var t=e.target.closest(".console-group-title");if(t){var i=t.closest(".console-group");i&&(i.classList.contains("collapsed")?i.classList.remove("collapsed"):i.classList.add("collapsed")),t.scrollIntoViewIfNeeded(!0)}}};WI.ConsolePrompt=class extends WI.View{constructor(e,t){super(),t=parseMIMEType(t).type,this.element.classList.add("console-prompt",WI.SyntaxHighlightedStyleClassName),this.element.appendChild(WI.ImageUtilities.useSVGSymbol("data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2013 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 10 10'%3e %3cpath d='M 7.910156 5.402344 C 7.859375 5.535156 7.78125 5.65625 7.675781 5.765625 L 4.730469 8.710938 C 4.324219 9.117188 3.664062 9.117188 3.257812 8.710938 C 2.851562 8.304688 2.851562 7.644531 3.257812 7.238281 L 5.484375 5.011719 L 3.265625 2.792969 C 2.859375 2.386719 2.859375 1.726562 3.265625 1.320312 C 3.671875 0.914062 4.332031 0.914062 4.738281 1.320312 L 7.683594 4.265625 C 7.992188 4.574219 8.066406 5.023438 7.910156 5.402344 Z'/%3e %3c/svg%3e","glyph")),this._delegate=e||null,this._codeMirror=WI.CodeMirrorEditor.create(this.element,{lineWrapping:!0,mode:{name:t,globalVars:!0},matchBrackets:!0});var i={Up:this._handlePreviousKey.bind(this),Down:this._handleNextKey.bind(this),"Ctrl-P":this._handlePreviousKey.bind(this),"Ctrl-N":this._handleNextKey.bind(this),Enter:this._handleEnterKey.bind(this),"Cmd-Enter":this._handleCommandEnterKey.bind(this),Tab:this._handleTabKey.bind(this),Esc:this._handleEscapeKey.bind(this)};this._codeMirror.addKeyMap(i),this._completionController=new WI.CodeMirrorCompletionController(this._codeMirror,this),this._completionController.addExtendedCompletionProvider("javascript",WI.javaScriptRuntimeCompletionProvider),this._history=[{}],this._historyIndex=0}get delegate(){return this._delegate}set delegate(e){this._delegate=e||null}set escapeKeyHandlerWhenEmpty(e){this._escapeKeyHandlerWhenEmpty=e}get text(){return this._codeMirror.getValue()}set text(e){this._codeMirror.setValue(e||""),this._codeMirror.clearHistory(),this._codeMirror.markClean()}get history(){return this._history[this._historyIndex]=this._historyEntryForCurrentText(),this._history}set history(e){this._history=e instanceof Array?e.slice(0,WI.ConsolePrompt.MaximumHistorySize):[{}],this._historyIndex=0,this._restoreHistoryEntry(0)}get focused(){return this._codeMirror.getWrapperElement().classList.contains("CodeMirror-focused")}focus(){this._codeMirror.focus()}updateCompletions(e,t){this._completionController.updateCompletions(e,t)}pushHistoryItem(e){this._commitHistoryEntry({text:e})}completionControllerCompletionsNeeded(e,t,i,n,s,a){this.delegate&&typeof this.delegate.consolePromptCompletionsNeeded=="function"?this.delegate.consolePromptCompletionsNeeded(this,i,n,t,s,a):this._completionController.updateCompletions(i)}completionControllerShouldAllowEscapeCompletion(e){return!!this.text}sizeDidChange(){super.sizeDidChange(),this.text&&this._codeMirror.refresh()}_handleTabKey(e){var t=e.getCursor(),i=e.getLine(t.line);if(!i.trim().length)return CodeMirror.Pass;var n=i.search(/[^\s]/);if(t.ch<=n)return CodeMirror.Pass;this._completionController.completeAtCurrentPositionIfNeeded().then(function(s){s===WI.CodeMirrorCompletionController.UpdatePromise.NoCompletionsFound&&InspectorFrontendHost.beep()})}_handleEscapeKey(e){if(this.text||!this._escapeKeyHandlerWhenEmpty)return CodeMirror.Pass;this._escapeKeyHandlerWhenEmpty()}_handlePreviousKey(e){if(this._codeMirror.somethingSelected()||this._codeMirror.getCursor().line)return CodeMirror.Pass;var t=this._history[this._historyIndex+1];if(!t)return CodeMirror.Pass;this._rememberCurrentTextInHistory(),++this._historyIndex,this._restoreHistoryEntry(this._historyIndex)}_handleNextKey(e){if(this._codeMirror.somethingSelected()||this._codeMirror.getCursor().line!==this._codeMirror.lastLine())return CodeMirror.Pass;var t=this._history[this._historyIndex-1];if(!t)return CodeMirror.Pass;this._rememberCurrentTextInHistory(),--this._historyIndex,this._restoreHistoryEntry(this._historyIndex)}_handleEnterKey(e,t,i){var n=this.text;if(!n.trim())return;var s=this._codeMirror.getCursor(),a=this._codeMirror.lastLine(),d=this._codeMirror.getLine(a).length,p=f(s,{line:a,ch:d});function f(b,w){return console.assert(b),console.assert(w),b.line===w.line&&b.ch===w.ch}function _(b){if(!b){f(s,this._codeMirror.getCursor())&&CodeMirror.commands.newlineAndIndent(this._codeMirror);return}this._commitHistoryEntry(this._historyEntryForCurrentText()),i||(this._codeMirror.setValue(""),this._codeMirror.clearHistory()),this.delegate&&typeof this.delegate.consolePromptHistoryDidChange=="function"&&this.delegate.consolePromptHistoryDidChange(this),this.delegate&&typeof this.delegate.consolePromptTextCommitted=="function"&&this.delegate.consolePromptTextCommitted(this,n)}if(!t&&this.delegate&&typeof this.delegate.consolePromptShouldCommitText=="function"){this.delegate.consolePromptShouldCommitText(this,n,p,_.bind(this));return}_.call(this,!0)}_commitHistoryEntry(e){this._history[1]&&(!this._history[1].text||this._history[1].text===e.text)?(this._history[1]=e,this._history[0]={}):(this._history[0]=e,this._history.unshift({}),this._history.length>WI.ConsolePrompt.MaximumHistorySize&&(this._history=this._history.slice(0,WI.ConsolePrompt.MaximumHistorySize))),this._historyIndex=0}_handleCommandEnterKey(e){this._handleEnterKey(e,!0,!0)}_restoreHistoryEntry(e){var t=this._history[e];this._codeMirror.setValue(t.text||""),t.undoHistory?this._codeMirror.setHistory(t.undoHistory):this._codeMirror.clearHistory(),this._codeMirror.setCursor(t.cursor||{line:0})}_historyEntryForCurrentText(){return{text:this.text,undoHistory:this._codeMirror.getHistory(),cursor:this._codeMirror.getCursor()}}_rememberCurrentTextInHistory(){this._history[this._historyIndex]=this._historyEntryForCurrentText(),this.delegate&&typeof this.delegate.consolePromptHistoryDidChange=="function"&&this.delegate.consolePromptHistoryDidChange(this)}};WI.ConsolePrompt.MaximumHistorySize=30;WI.ConsoleSession=class extends WI.Object{constructor(e){super(),this._hasMessages=!1;let t=document.createElement("div");t.className="console-session";let i=document.createElement("div");i.classList.add("console-session-header");let n="";switch(e.newSessionReason){case WI.ConsoleSession.NewSessionReason.PageReloaded:n=WI.UIString("Page reloaded at %s");break;case WI.ConsoleSession.NewSessionReason.PageNavigated:n=WI.UIString("Page navigated at %s");break;case WI.ConsoleSession.NewSessionReason.ConsoleCleared:n=WI.UIString("Console cleared at %s");break;default:n=WI.UIString("Console opened at %s");break}let s=e.timestamp||Date.now();i.textContent=n.format(new Date(s).toLocaleTimeString()),t.append(i),this.element=t,this._messagesElement=t}addMessageView(e){var t=e.element;t.classList.add(WI.LogContentView.ItemWrapperStyleClassName),this.append(t)}append(e){this._hasMessages=!0,this._messagesElement.append(e)}hasMessages(){return this._hasMessages}};WI.ConsoleSession.NewSessionReason={PageReloaded:Symbol("Page reloaded"),PageNavigated:Symbol("Page navigated"),ConsoleCleared:Symbol("Console cleared")};WI.ContentViewContainer=class extends WI.View{constructor(){super(),this.element.classList.add("content-view-container"),this._backForwardList=[],this._currentIndex=-1}get currentIndex(){return this._currentIndex}get backForwardList(){return this._backForwardList}get currentContentView(){return this._currentIndex<0||this._currentIndex>this._backForwardList.length-1?null:this._backForwardList[this._currentIndex].contentView}get currentBackForwardEntry(){return this._currentIndex<0||this._currentIndex>this._backForwardList.length-1?null:this._backForwardList[this._currentIndex]}contentViewForRepresentedObject(e,t,i){return WI.ContentView.contentViewForRepresentedObject(e,t,i)}showContentViewForRepresentedObject(e,t){var i=this.contentViewForRepresentedObject(e,!1,t);return i?(this.showContentView(i),i):null}showContentView(e,t){if(console.assert(e instanceof WI.ContentView),!(e instanceof WI.ContentView))return null;if(e===this.currentContentView&&!t)return e;e.parentContainer!==this&&this._takeOwnershipOfContentView(e);let i=this.currentBackForwardEntry,n=null;for(let d=this._backForwardList.length-1;d>=0;--d)if(this._backForwardList[d].contentView===e){n=this._backForwardList[d].makeCopy(t);break}if(n||(n=new WI.BackForwardEntry(e,t)),n.isEqual(i))return i.prepareToShow(!1),i.contentView;let s=this._currentIndex+1,a=this._backForwardList.splice(s,this._backForwardList.length-s,n);console.assert(s===this._backForwardList.length-1),console.assert(this._backForwardList[s]===n);for(let d=0;d<a.length;++d)!this._backForwardList.some(f=>f.contentView===a[d].contentView)&&this._disassociateFromContentView(a[d].contentView,a[d].tombstone);return e._parentContainer=this,this.showBackForwardEntryForIndex(s),e}showBackForwardEntryForIndex(e){if(console.assert(e>=0&&e<=this._backForwardList.length-1),!(e<0||e>this._backForwardList.length-1)&&this._currentIndex!==e){var t=this.currentBackForwardEntry;this._currentIndex=e;var i=this.currentBackForwardEntry;console.assert(i);var n=!t||!i.contentView.visible;n?(t&&this._hideEntry(t),this._showEntry(i,!0)):this._showEntry(i,!1),this.dispatchEventToListeners(WI.ContentViewContainer.Event.CurrentContentViewDidChange)}}replaceContentView(e,t){if(console.assert(e instanceof WI.ContentView),e instanceof WI.ContentView&&(console.assert(t instanceof WI.ContentView),t instanceof WI.ContentView&&(console.assert(e.parentContainer===this),e.parentContainer===this&&(console.assert(!t.parentContainer||t.parentContainer===this),!(t.parentContainer&&t.parentContainer!==this))))){var i=this.currentContentView===e;i&&this._hideEntry(this.currentBackForwardEntry),this._disassociateFromContentView(e,!1),t._parentContainer=this;for(var n=0;n<this._backForwardList.length;++n)if(this._backForwardList[n].contentView===e){console.assert(!this._backForwardList[n].tombstone);let s=this._backForwardList[n].cookie;this._backForwardList[n]=new WI.BackForwardEntry(t,s)}this._removeIdenticalAdjacentBackForwardEntries(),i&&(this._showEntry(this.currentBackForwardEntry,!0),this.dispatchEventToListeners(WI.ContentViewContainer.Event.CurrentContentViewDidChange))}}closeContentView(e){if(!this._backForwardList.length){console.assert(this._currentIndex===-1);return}for(var t=!0,i=this._backForwardList.length-1;i>=0;--i)if(this._backForwardList[i].contentView!==e){t=!1;break}if(t){this.closeAllContentViews();return}for(var n=this.currentContentView,s=!1,i=this._backForwardList.length-1;i>=0;--i){var a=this._backForwardList[i];a.contentView===e&&(a.contentView===n&&this._hideEntry(a),this._currentIndex>=i&&--this._currentIndex,this._disassociateFromContentView(a.contentView,a.tombstone),this._backForwardList.splice(i,1),s=!0)}s&&this._removeIdenticalAdjacentBackForwardEntries();var d=this.currentBackForwardEntry;console.assert(d||!d&&this._currentIndex===-1),(d&&d.contentView!==n||s)&&(this._showEntry(d,!0),this.dispatchEventToListeners(WI.ContentViewContainer.Event.CurrentContentViewDidChange))}closeAllContentViews(){if(!this._backForwardList.length){console.assert(this._currentIndex===-1);return}for(var e=this.currentContentView,t=0;t<this._backForwardList.length;++t){var i=this._backForwardList[t];i.contentView===e&&this._hideEntry(i),this._disassociateFromContentView(i.contentView,i.tombstone)}this._backForwardList=[],this._currentIndex=-1,this.dispatchEventToListeners(WI.ContentViewContainer.Event.CurrentContentViewDidChange)}canGoBack(){return this._currentIndex>0}canGoForward(){return this._currentIndex<this._backForwardList.length-1}goBack(){!this.canGoBack()||this.showBackForwardEntryForIndex(this._currentIndex-1)}goForward(){!this.canGoForward()||this.showBackForwardEntryForIndex(this._currentIndex+1)}shown(){var e=this.currentBackForwardEntry;!e||this._showEntry(e,!0)}hidden(){var e=this.currentBackForwardEntry;!e||this._hideEntry(e)}_takeOwnershipOfContentView(e){console.assert(e.parentContainer!==this,"We already have ownership of the ContentView"),e.parentContainer!==this&&(e.parentContainer&&e.parentContainer._placeTombstonesForContentView(e),e._parentContainer=this,this._clearTombstonesForContentView(e),e.dispatchEventToListeners(WI.ContentView.Event.NavigationItemsDidChange))}_placeTombstonesForContentView(e){console.assert(e.parentContainer===this);let t=this._tombstoneContentViewContainersForContentView(e);console.assert(!t.includes(this));let i=this.currentContentView;for(let n of this._backForwardList)n.contentView===e&&(n.contentView===i&&(this._hideEntry(n),i=null),console.assert(!n.tombstone),n.tombstone=!0,t.push(this))}_clearTombstonesForContentView(e){console.assert(e.parentContainer===this),this._tombstoneContentViewContainersForContentView(e).removeAll(this);for(let i of this._backForwardList)i.contentView===e&&(console.assert(i.tombstone),i.tombstone=!1)}_disassociateFromContentView(e,t){if(t){this._tombstoneContentViewContainersForContentView(e).remove(this);return}if(console.assert(!e.visible),!e._parentContainer)return;e._parentContainer=null;let i=this._tombstoneContentViewContainersForContentView(e);if(i&&i.length){i[0]._takeOwnershipOfContentView(e);return}e.closed(),e.representedObject&&WI.ContentView.closedContentViewForRepresentedObject(e.representedObject)}_showEntry(e,t){console.assert(e instanceof WI.BackForwardEntry),e.tombstone&&(this._takeOwnershipOfContentView(e.contentView),console.assert(!e.tombstone)),this.subviews.includes(e.contentView)||this.addSubview(e.contentView),e.prepareToShow(t)}_hideEntry(e){console.assert(e instanceof WI.BackForwardEntry),!e.tombstone&&(e.prepareToHide(),this.subviews.includes(e.contentView)&&this.removeSubview(e.contentView))}_tombstoneContentViewContainersForContentView(e){let t=e[WI.ContentViewContainer.TombstoneContentViewContainersSymbol];return t||(t=e[WI.ContentViewContainer.TombstoneContentViewContainersSymbol]=[]),t}_removeIdenticalAdjacentBackForwardEntries(){if(this._backForwardList.length<2)return;let e;for(let t=this._backForwardList.length-1;t>=0;--t){let i=this._backForwardList[t];if(!i.isEqual(e)){e=i;continue}this._currentIndex>=t&&--this._currentIndex,this._backForwardList.splice(t,1)}}};WI.ContentViewContainer.Event={CurrentContentViewDidChange:"content-view-container-current-content-view-did-change"};WI.ContentViewContainer.TombstoneContentViewContainersSymbol=Symbol("content-view-container-tombstone-content-view-containers");WI.ContextMenuItem=class extends WI.Object{constructor(e,t,i,n,s){super(),this._type=t,this._label=i,this._disabled=n,this._checked=s,this._contextMenu=e||this,(t==="item"||t==="checkbox")&&(this._id=e.nextId())}id(){return this._id}type(){return this._type}isEnabled(){return!this._disabled}setEnabled(e){this._disabled=!e}_buildDescriptor(){switch(this._type){case"item":return{type:"item",id:this._id,label:this._label,enabled:!this._disabled};case"separator":return{type:"separator"};case"checkbox":return{type:"checkbox",id:this._id,label:this._label,checked:!!this._checked,enabled:!this._disabled}}}};WI.ContextSubMenuItem=class extends WI.ContextMenuItem{constructor(e,t,i){super(e,"subMenu",t,i),this._items=[]}appendItem(e,t,i){let n=new WI.ContextMenuItem(this._contextMenu,"item",e,i);return this.pushItem(n),this._contextMenu._setHandler(n.id(),t),n}appendSubMenuItem(e,t){let i=new WI.ContextSubMenuItem(this._contextMenu,e,t);return this.pushItem(i),i}appendCheckboxItem(e,t,i,n){let s=new WI.ContextMenuItem(this._contextMenu,"checkbox",e,n,i);return this.pushItem(s),this._contextMenu._setHandler(s.id(),t),s}appendSeparator(){this._items.length&&(this._pendingSeparator=!0)}pushItem(e){this._pendingSeparator&&(this._items.push(new WI.ContextMenuItem(this._contextMenu,"separator")),this._pendingSeparator=null),this._items.push(e)}isEmpty(){return!this._items.length}_buildDescriptor(){if(this.isEmpty())return null;let e=this._items.map(t=>t._buildDescriptor()).filter(t=>!!t);return{type:"subMenu",label:this._label,enabled:!this._disabled,subItems:e}}};WI.ContextMenu=class extends WI.ContextSubMenuItem{constructor(e){super(null,""),this._event=e,this._handlers={},this._id=0,this._beforeShowCallbacks=[]}static createFromEvent(e,t=!1){return!e[WI.ContextMenu.ProposedMenuSymbol]&&!t&&(e[WI.ContextMenu.ProposedMenuSymbol]=new WI.ContextMenu(e)),e[WI.ContextMenu.ProposedMenuSymbol]||null}static contextMenuItemSelected(e){WI.ContextMenu._lastContextMenu&&WI.ContextMenu._lastContextMenu._itemSelected(e)}static contextMenuCleared(){}nextId(){return this._id++}show(){console.assert(this._event instanceof MouseEvent);let e=this._buildDescriptor();e.length&&(WI.ContextMenu._lastContextMenu=this,this._event.type!=="contextmenu"&&typeof InspectorFrontendHost.dispatchEventAsContextMenuEvent=="function"?(console.assert(event.type!=="mousedown"||this._beforeShowCallbacks.length>0,"Calling show() in a mousedown handler should have a before show callback to enable quick selection."),this._menuObject=e,this._event.target.addEventListener("contextmenu",this,!0),InspectorFrontendHost.dispatchEventAsContextMenuEvent(this._event)):this._showSoftContextMenu(this._event,e)),this._event&&this._event.stopImmediatePropagation()}addBeforeShowCallback(e){this._beforeShowCallbacks.push(e)}handleEvent(e){console.assert(e.type==="contextmenu");for(let t of this._beforeShowCallbacks)t(this);this._event.target.removeEventListener("contextmenu",this,!0),this._showSoftContextMenu(e,this._menuObject),this._menuObject=null,e.stopImmediatePropagation()}_setHandler(e,t){t&&(this._handlers[e]=t)}_buildDescriptor(){return this._items.map(e=>e._buildDescriptor()).filter(e=>!!e)}_itemSelected(e){this._handlers[e]&&this._handlers[e].call(this)}_showSoftContextMenu(e,t){new WI.SoftContextMenu(t).show(e)}};WI.ContextMenu.ProposedMenuSymbol=Symbol("context-menu-proposed-menu");WI.appendContextMenuItemsForSourceCode=function(c,e){if(console.assert(c instanceof WI.ContextMenu),!(c instanceof WI.ContextMenu))return;let t=e,i=null;if(e instanceof WI.SourceCodeLocation&&(t=e.sourceCode,i=e),console.assert(t instanceof WI.SourceCode),t instanceof WI.SourceCode&&(c.appendSeparator(),WI.appendContextMenuItemsForURL(c,t.url,{sourceCode:t,location:i}),t instanceof WI.Resource&&t.urlComponents.scheme!=="data"&&(c.appendItem(WI.UIString("Copy as cURL"),()=>{InspectorFrontendHost.copyText(t.generateCURLCommand())}),c.appendSeparator(),c.appendItem(WI.UIString("Copy HTTP Request"),()=>{InspectorFrontendHost.copyText(t.stringifyHTTPRequest())}),t.hasResponse()&&c.appendItem(WI.UIString("Copy HTTP Response"),()=>{InspectorFrontendHost.copyText(t.stringifyHTTPResponse())}),c.appendSeparator()),c.appendItem(WI.UIString("Save File"),()=>{t.requestContent().then(()=>{WI.FileUtilities.save({url:t.url||"",content:t.content},!0)})}),c.appendSeparator(),i&&(t instanceof WI.Script||t instanceof WI.Resource&&t.type===WI.Resource.Type.Script))){let n=WI.debuggerManager.breakpointForSourceCodeLocation(i);n?c.appendItem(WI.UIString("Delete Breakpoint"),()=>{WI.debuggerManager.removeBreakpoint(n)}):c.appendItem(WI.UIString("Add Breakpoint"),()=>{WI.debuggerManager.addBreakpoint(new WI.Breakpoint(i))}),c.appendSeparator()}};WI.appendContextMenuItemsForURL=function(c,e,t={}){if(!e)return;function i(n){n.location?WI.showSourceCodeLocation(n.location,n):n.sourceCode?WI.showSourceCode(n.sourceCode,n):WI.openURL(e,n.frame,n)}!e.startsWith("javascript:")&&!e.startsWith("data:")&&c.appendItem(WI.UIString("Open in New Tab"),()=>{WI.openURL(e,null,{alwaysOpenExternally:!0})}),WI.networkManager.resourceForURL(e)&&(WI.settings.experimentalEnableSourcesTab.value?WI.isShowingSourcesTab()||c.appendItem(WI.UIString("Reveal in Sources Tab"),()=>{i({preferredTabType:WI.SourcesTabContentView.Type})}):WI.isShowingResourcesTab()||c.appendItem(WI.UIString("Reveal in Resources Tab"),()=>{i({preferredTabType:WI.ResourcesTabContentView.Type})}),WI.isShowingNetworkTab()||c.appendItem(WI.UIString("Reveal in Network Tab"),()=>{i({preferredTabType:WI.NetworkTabContentView.Type})})),c.appendSeparator(),c.appendItem(WI.UIString("Copy Link"),()=>{InspectorFrontendHost.copyText(e)})};WI.appendContextMenuItemsForDOMNode=function(c,e,t={}){if(console.assert(c instanceof WI.ContextMenu),!(c instanceof WI.ContextMenu)||(console.assert(e instanceof WI.DOMNode),!(e instanceof WI.DOMNode)))return;let i=t.copySubMenu||c.appendSubMenuItem(WI.UIString("Copy")),n=e.nodeType()===Node.ELEMENT_NODE,s=e.attached;if(n&&s&&i.appendItem(WI.UIString("Selector Path"),()=>{let a=WI.cssPath(e);InspectorFrontendHost.copyText(a)}),!e.isPseudoElement()&&s&&i.appendItem(WI.UIString("XPath"),()=>{let a=WI.xpath(e);InspectorFrontendHost.copyText(a)}),c.appendSeparator(),e.isCustomElement()&&(c.appendItem(WI.UIString("Jump to Definition"),()=>{function a(d,p){if(d)return;let f=p.location,_=WI.debuggerManager.scriptForIdentifier(f.scriptId,WI.mainTarget);if(!_)return;let b=_.createSourceCodeLocation(f.lineNumber,f.columnNumber||0);WI.showSourceCodeLocation(b,{ignoreNetworkTab:!0,ignoreSearchTab:!0})}WI.RemoteObject.resolveNode(e).then(d=>{d.getProperty("constructor",(p,f,_)=>{p||(f.type==="function"&&d.target.DebuggerAgent.getFunctionDetails(f.objectId,a),f.release())}),d.release()})}),c.appendSeparator()),WI.cssManager.canForcePseudoClasses()&&e.attached){c.appendSeparator();let a=c.appendSubMenuItem(WI.UIString("Forced Pseudo-Classes","A context menu item to force (override) a DOM node's pseudo-classes")),d=e.enabledPseudoClasses;WI.CSSManager.ForceablePseudoClasses.forEach(p=>{let f=d.includes(p);a.appendCheckboxItem(p.capitalize(),()=>{e.setPseudoClassEnabled(p,!f)},f)})}if(WI.domDebuggerManager.supported&&n&&!e.isPseudoElement()&&s&&(c.appendSeparator(),WI.appendContextMenuItemsForDOMNodeBreakpoints(c,e,t)),c.appendSeparator(),!t.excludeLogElement&&!e.isInUserAgentShadowTree()&&!e.isPseudoElement()){let a=n?WI.UIString("Log Element","Log (print) DOM element to Console"):WI.UIString("Log Node","Log (print) DOM node to Console");c.appendItem(a,()=>{WI.RemoteObject.resolveNode(e,WI.RuntimeManager.ConsoleObjectGroup).then(d=>{let p=n?WI.UIString("Selected Element","Selected DOM element"):WI.UIString("Selected Node","Selected DOM node");const f=!0;WI.consoleLogViewController.appendImmediateExecutionWithResult(p,d,f)})})}!t.excludeRevealElement&&window.DOMAgent&&s&&c.appendItem(WI.repeatedUIString.revealInDOMTree(),()=>{WI.domManager.inspectElement(e.id)}),WI.settings.experimentalEnableLayersTab.value&&window.LayerTreeAgent&&s&&c.appendItem(WI.UIString("Reveal in Layers Tab","Open Layers tab and select the layer corresponding to this node"),()=>{WI.showLayersTab({nodeToSelect:e})}),window.PageAgent&&s&&c.appendItem(WI.UIString("Capture Screenshot","Capture screenshot of the selected DOM node"),()=>{PageAgent.snapshotNode(e.id,(a,d)=>{if(a){const p=WI.mainTarget,f=WI.ConsoleMessage.MessageSource.Other,_=WI.ConsoleMessage.MessageLevel.Error;let b=new WI.ConsoleMessage(p,f,_,a);b.shouldRevealConsole=!0,WI.consoleLogViewController.appendConsoleMessage(b);return}WI.FileUtilities.save({url:WI.FileUtilities.inspectorURLForFilename(WI.FileUtilities.screenshotString()+".png"),content:parseDataURL(d).data,base64Encoded:!0})})}),n&&s&&c.appendItem(WI.UIString("Scroll into View","Scroll selected DOM node into view on the inspected web page"),()=>{e.scrollIntoView()}),c.appendSeparator()};WI.appendContextMenuItemsForDOMNodeBreakpoints=function(c,e,t={}){if(c.__domBreakpointItemsAdded)return;c.__domBreakpointItemsAdded=!0;let i=WI.domDebuggerManager.domBreakpointsForNode(e);c.appendSeparator();let n=c.appendSubMenuItem(WI.UIString("Break on"));for(let a of Object.values(WI.DOMBreakpoint.Type)){let d=WI.DOMBreakpointTreeElement.displayNameForType(a),p=i.find(f=>f.type===a);n.appendCheckboxItem(d,function(){p?WI.domDebuggerManager.removeDOMBreakpoint(p):WI.domDebuggerManager.addDOMBreakpoint(new WI.DOMBreakpoint(e,a))},!!p)}if(c.appendSeparator(),i.length){let a=i.some(d=>d.disabled);c.appendItem(a?WI.UIString("Enable Breakpoint"):WI.UIString("Disable Breakpoint"),()=>{for(let d of i)d.disabled=!a}),c.appendItem(WI.UIString("Delete Breakpoint"),()=>{for(let d of i)WI.domDebuggerManager.removeDOMBreakpoint(d)}),c.appendSeparator()}let s=WI.domDebuggerManager.domBreakpointsInSubtree(e);if(s.length){t.revealDescendantBreakpointsMenuItemHandler&&c.appendItem(WI.UIString("Reveal Descendant Breakpoints"),t.revealDescendantBreakpointsMenuItemHandler);let a=s.some(d=>d.disabled);c.appendItem(a?WI.UIString("Enable Descendant Breakpoints"):WI.UIString("Disable Descendant Breakpoints"),()=>{for(let d of s)d.disabled=!a}),c.appendItem(WI.UIString("Delete Descendant Breakpoints"),()=>{for(let d of s)WI.domDebuggerManager.removeDOMBreakpoint(d)}),c.appendSeparator()}};WI.ControlToolbarItem=class extends WI.ButtonNavigationItem{constructor(e,t,i,n,s){super(e,t,i,n,s,!1)}get additionalClassNames(){return["control"]}};WI.CookieStorageContentView=class extends WI.ContentView{constructor(e){super(e),this.element.classList.add("cookie-storage"),this._cookies=[],this._sortComparator=null,this._table=null,this._refreshButtonNavigationItem=new WI.ButtonNavigationItem("cookie-storage-refresh",WI.UIString("Refresh"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='1 1 13 13'%3e %3cpath fill='currentColor' d='M 12.007 8.01 L 12.007 8.488 L 12 8.488 C 12 10.974 9.985 12.988 7.5 12.988 C 5.015 12.988 3 10.974 3 8.488 C 3 6.17 4.759 4.284 7.012 4.037 L 7.012 6.549 L 11.519 3.775 L 7.012 1 L 7.012 3.013 C 4.203 3.26 2 5.615 2 8.488 C 2 11.526 4.462 13.988 7.5 13.988 C 10.509 13.988 12.95 11.571 12.996 8.572 L 13 8.572 L 13 8.01 L 12.007 8.01 Z'/%3e %3c/svg%3e",13,13),this._refreshButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._refreshButtonClicked,this)}get navigationItems(){return[this._refreshButtonNavigationItem]}saveToCookie(e){e.type=WI.ContentViewCookieType.CookieStorage,e.host=this.representedObject.host}get scrollableElements(){return this._table?[this._table.scrollContainer]:[]}handleCopyEvent(e){if(!this._table||!this._table.selectedRows.length)return;let t=this._cookiesAtIndexes(this._table.selectedRows);!t.length||(e.clipboardData.setData("text/plain",this._formatCookiesAsText(t)),e.stopPropagation(),e.preventDefault())}tableIndexForRepresentedObject(e,t){let i=this._cookies.indexOf(t);return console.assert(i>=0),i}tableRepresentedObjectForIndex(e,t){return console.assert(t>=0&&t<this._cookies.length),this._cookies[t]}tableNumberOfRows(e){return this._cookies.length}tableSortChanged(e){this._generateSortComparator(),this._sortComparator&&(this._updateSort(),this._table.reloadData())}tableCellContextMenuClicked(e,t,i,n,s){let a=WI.ContextMenu.createFromEvent(s);a.appendSeparator(),a.appendItem(WI.UIString("Copy"),()=>{let d;e.isRowSelected(n)?d=e.selectedRows:d=[n];let p=this._cookiesAtIndexes(d);InspectorFrontendHost.copyText(this._formatCookiesAsText(p))}),a.appendItem(WI.UIString("Delete"),()=>{e.isRowSelected(n)?e.removeSelectedRows():e.removeRow(n)}),a.appendSeparator()}tableDidRemoveRows(e,t){if(!!t.length)for(let i=t.length-1;i>=0;--i){let n=t[i],s=this._cookies[n];console.assert(s,"Missing cookie for row "+n),s&&(this._cookies.splice(n,1),PageAgent.deleteCookie(s.name,s.url))}}tablePopulateCell(e,t,i,n){let s=this._cookies[n];return t.textContent=this._formatCookiePropertyForColumn(s,i),t}initialLayout(){super.initialLayout(),this._table=new WI.Table("cookies-table",this,this,20),this._table.allowsMultipleSelection=!0,this._nameColumn=new WI.TableColumn("name",WI.UIString("Name"),{minWidth:70,maxWidth:300,initialWidth:200,resizeType:WI.TableColumn.ResizeType.Locked}),this._valueColumn=new WI.TableColumn("value",WI.UIString("Value"),{minWidth:100,maxWidth:600,initialWidth:200,hideable:!1}),this._domainColumn=new WI.TableColumn("domain",WI.UIString("Domain"),{minWidth:100,maxWidth:200,initialWidth:120}),this._pathColumn=new WI.TableColumn("path",WI.UIString("Path"),{minWidth:50,maxWidth:300,initialWidth:100}),this._expiresColumn=new WI.TableColumn("expires",WI.UIString("Expires"),{minWidth:100,maxWidth:200,initialWidth:150}),this._sizeColumn=new WI.TableColumn("size",WI.UIString("Size"),{minWidth:50,maxWidth:80,initialWidth:65,align:"right"}),this._secureColumn=new WI.TableColumn("secure",WI.unlocalizedString("Secure"),{minWidth:70,maxWidth:70,align:"center"}),this._httpOnlyColumn=new WI.TableColumn("httpOnly",WI.unlocalizedString("HttpOnly"),{minWidth:80,maxWidth:80,align:"center"}),this._sameSiteColumn=new WI.TableColumn("sameSite",WI.unlocalizedString("SameSite"),{minWidth:40,maxWidth:80,initialWidth:70,align:"center"}),this._table.addColumn(this._nameColumn),this._table.addColumn(this._valueColumn),this._table.addColumn(this._domainColumn),this._table.addColumn(this._pathColumn),this._table.addColumn(this._expiresColumn),this._table.addColumn(this._sizeColumn),this._table.addColumn(this._secureColumn),this._table.addColumn(this._httpOnlyColumn),this._table.addColumn(this._sameSiteColumn),this._table.sortColumnIdentifier||(this._table.sortOrder=WI.Table.SortOrder.Ascending,this._table.sortColumnIdentifier="name"),this.addSubview(this._table),this._table.element.addEventListener("keydown",this._handleTableKeyDown.bind(this)),this._reloadCookies()}_filterCookies(e){let t=a=>{let d=a.urlComponents;return d&&d.host&&d.host===this.representedObject.host},i=[];for(let a of WI.networkManager.frames)i.push(a.mainResource,...a.resourceCollection);let n=i.filter(t);return e.filter(a=>n.some(d=>WI.CookieStorageObject.cookieMatchesResourceURL(a,d.url)))}_generateSortComparator(){let e=this._table.sortColumnIdentifier;if(!e){this._sortComparator=null;return}let t=null;switch(e){case"name":case"value":case"domain":case"path":case"sameSite":t=(n,s)=>(n[e]||"").extendedLocaleCompare(s[e]||"");break;case"size":case"httpOnly":case"secure":t=(n,s)=>n[e]-s[e];break;case"expires":t=(n,s)=>n.expires?s.expires?n.expires-s.expires:-1:1;break;default:console.assert("Unexpected sort column",e);return}let i=this._table.sortOrder===WI.Table.SortOrder.Ascending?1:-1;this._sortComparator=(n,s)=>i*t(n,s)}_refreshButtonClicked(e){this._reloadCookies()}_reloadCookies(){PageAgent.getCookies().then(e=>{this._cookies=this._filterCookies(e.cookies.map(WI.Cookie.fromPayload)),this._updateSort(),this._table.reloadData()}).catch(e=>{console.error("Could not fetch cookies: ",e)})}_updateSort(){!this._sortComparator||this._cookies.sort(this._sortComparator)}_handleTableKeyDown(e){(e.keyCode===WI.KeyboardShortcut.Key.Backspace.keyCode||e.keyCode===WI.KeyboardShortcut.Key.Delete.keyCode)&&this._table.removeSelectedRows()}_cookiesAtIndexes(e){return this._cookies.length?e.map(t=>this._cookies[t]):[]}_formatCookiesAsText(e){let t=this._table.columns.filter(n=>!n.hidden);return t.length?e.map(n=>t.map(d=>this._formatCookiePropertyForColumn(n,d,!1)).join("	")).join(`
`):""}_formatCookiePropertyForColumn(e,t,i=!0){const n="\u2713",s=i?emDash:"",a=i?zeroWidthSpace:"";switch(t.identifier){case"name":return e.name;case"value":return e.value;case"domain":return e.domain||s;case"path":return e.path||s;case"expires":return e.expires?new Date(e.expires).toLocaleString():WI.UIString("Session");case"size":return Number.bytesToString(e.size);case"secure":return e.secure?n:a;case"httpOnly":return e.httpOnly?n:a;case"sameSite":return e.sameSite===WI.Cookie.SameSiteType.None?s:WI.Cookie.displayNameForSameSiteType(e.sameSite)}return console.assert("Unexpected table column "+t.identifier),""}};WI.CookieType={Request:0,Response:1};WI.CookieStorageTreeElement=class extends WI.StorageTreeElement{constructor(e){console.assert(e instanceof WI.CookieStorageObject),super("cookie-icon",WI.displayNameForHost(e.host),e)}get name(){return this.representedObject.host}get categoryName(){return WI.UIString("Cookies")}};WI.DOMBreakpointTreeElement=class extends WI.GeneralTreeElement{constructor(e,{className:t,title:i}={}){console.assert(e instanceof WI.DOMBreakpoint);let n=["breakpoint","dom",`breakpoint-for-${e.type}`];t&&n.push(t),i||(i=WI.DOMBreakpointTreeElement.displayNameForType(e.type));const s=null;super(n,i,s,e),this.status=WI.ImageUtilities.useSVGSymbol("data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2019 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 23 12'%3e %3cpolygon points='0.5 0.5 17.355 0.5 21.904 6 17.355 11.5 0.5 11.5 0.5 0.5'/%3e %3c/svg%3e"),this.status.className=WI.BreakpointTreeElement.StatusImageElementStyleClassName,this.tooltipHandledSeparately=!0}static displayNameForType(e){switch(e){case WI.DOMBreakpoint.Type.SubtreeModified:return WI.UIString("Subtree Modified","A submenu item of 'Break On' that breaks (pauses) before child DOM node is modified");case WI.DOMBreakpoint.Type.AttributeModified:return WI.UIString("Attribute Modified","A submenu item of 'Break On' that breaks (pauses) before DOM attribute is modified");case WI.DOMBreakpoint.Type.NodeRemoved:return WI.UIString("Node Removed","A submenu item of 'Break On' that breaks (pauses) before DOM node is removed");default:return console.error("Unexpected DOM breakpoint type: "+e),null}}onattach(){super.onattach(),this.representedObject.addEventListener(WI.DOMBreakpoint.Event.DisabledStateChanged,this._updateStatus,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.BreakpointsEnabledDidChange,this._updateStatus,this),this._boundStatusImageElementClicked=this._statusImageElementClicked.bind(this),this._boundStatusImageElementFocused=this._statusImageElementFocused.bind(this),this._boundStatusImageElementMouseDown=this._statusImageElementMouseDown.bind(this),this.status.addEventListener("click",this._boundStatusImageElementClicked),this.status.addEventListener("focus",this._boundStatusImageElementFocused),this.status.addEventListener("mousedown",this._boundStatusImageElementMouseDown),this._updateStatus()}ondetach(){super.ondetach(),this.representedObject.removeEventListener(null,null,this),WI.debuggerManager.removeEventListener(null,null,this),this.status.removeEventListener("click",this._boundStatusImageElementClicked),this.status.removeEventListener("focus",this._boundStatusImageElementFocused),this.status.removeEventListener("mousedown",this._boundStatusImageElementMouseDown),this._boundStatusImageElementClicked=null,this._boundStatusImageElementFocused=null,this._boundStatusImageElementMouseDown=null}ondelete(){return this.__deletedViaDeleteKeyboardShortcut=!0,WI.domDebuggerManager.removeDOMBreakpoint(this.representedObject),!0}onenter(){return this._toggleBreakpoint(),!0}onspace(){return this._toggleBreakpoint(),!0}populateContextMenu(e,t){let i=this.representedObject,n=i.disabled?WI.UIString("Enable Breakpoint"):WI.UIString("Disable Breakpoint");e.appendItem(n,this._toggleBreakpoint.bind(this)),e.appendItem(WI.UIString("Delete Breakpoint"),function(){WI.domDebuggerManager.removeDOMBreakpoint(i)})}_statusImageElementClicked(e){this._toggleBreakpoint()}_statusImageElementFocused(e){e.stopPropagation()}_statusImageElementMouseDown(e){e.stopPropagation()}_toggleBreakpoint(){this.representedObject.disabled=!this.representedObject.disabled}_updateStatus(){!this.status||(this.status.classList.toggle(WI.BreakpointTreeElement.StatusImageDisabledStyleClassName,this.representedObject.disabled),this.status.classList.toggle(WI.BreakpointTreeElement.StatusImageResolvedStyleClassName,WI.debuggerManager.breakpointsEnabled))}};WI.DOMEventsBreakdownView=class extends WI.View{constructor(e,{includeGraph:t}={}){console.assert(e instanceof WI.DOMNode||Array.isArray(e)),super(),e instanceof WI.DOMNode?(this._domNode=e,this._domNode.addEventListener(WI.DOMNode.Event.DidFireEvent,this._handleDOMNodeDidFireEvent,this),this._domNode.canEnterPowerEfficientPlaybackState()&&this._domNode.addEventListener(WI.DOMNode.Event.PowerEfficientPlaybackStateChanged,this._handleDOMNodePowerEfficientPlaybackStateChanged,this),this._domEvents=null):(this._domNode=null,this._domEvents=e),this._includeGraph=t||!1,this._tableBodyElement=null,this.element.classList.add("dom-events-breakdown")}initialLayout(){super.initialLayout();let e=this.element.appendChild(document.createElement("table")),i=e.appendChild(document.createElement("thead")).appendChild(document.createElement("tr")),n=i.appendChild(document.createElement("th"));n.textContent=WI.UIString("Event"),this._includeGraph&&i.appendChild(document.createElement("th"));let s=i.appendChild(document.createElement("th"));s.classList.add("time"),s.textContent=WI.UIString("Time");let a=i.appendChild(document.createElement("th"));a.classList.add("originator"),a.textContent=WI.UIString("Originator"),this._tableBodyElement=e.appendChild(document.createElement("tbody"))}layout(){if(this.layoutReason!==WI.View.LayoutReason.Dirty)return;this._tableBodyElement.removeChildren(),console.assert(this._domEvents||this._domNode&&this._domNode.domEvents);let e=this._domEvents||this._domNode.domEvents,t=e[0].timestamp,i=e.lastValue.timestamp,n=i-t,s=WI.resolvedLayoutDirection()===WI.LayoutDirection.LTR?"left":"right";function a(_){return _/n*100}let d=[],p=WI.DOMNode.getFullscreenDOMEvents(e);for(let _ of p){let{enabled:b}=_.data;(b||!d.length)&&d.push({startTimestamp:b?_.timestamp:t}),d.lastValue.endTimestamp=b&&_===p.lastValue?i:_.timestamp,_.originator&&(d.lastValue.originator=_.originator)}let f=this._domNode?this._domNode.powerEfficientPlaybackRanges:[];for(let _ of e){let b=this._tableBodyElement.appendChild(document.createElement("tr")),w=b.appendChild(document.createElement("td"));if(w.classList.add("name"),w.textContent=_.eventName,this._includeGraph){let R=b.appendChild(document.createElement("td"));R.classList.add("graph");let M=d.find(H=>_.timestamp>=H.startTimestamp&&_.timestamp<=H.endTimestamp);if(M){let H=R.appendChild(document.createElement("div"));H.classList.add("area","fullscreen"),H.style.setProperty(s,a(M.startTimestamp-t)+"%"),H.style.setProperty("width",a(M.endTimestamp-M.startTimestamp)+"%"),M.originator?H.title=WI.UIString("Full-Screen from \u201C%s\u201D").format(M.originator.displayName):H.title=WI.UIString("Full-Screen")}let L=f.find(H=>_.timestamp>=H.startTimestamp&&_.timestamp<=H.endTimestamp);if(L){let H=R.appendChild(document.createElement("div"));H.classList.add("area","power-efficient-playback"),H.title=WI.UIString("Power Efficient Playback"),H.style.setProperty(s,a(L.startTimestamp-t)+"%"),H.style.setProperty("width",a(L.endTimestamp-L.startTimestamp)+"%")}let V=R.appendChild(document.createElement("img"));V.style.setProperty(s,`calc(${a(_.timestamp-t)}% - (var(--img-size) / 2))`),WI.DOMNode.isPlayEvent(_.eventName)?V.src="data:image/svg+xml,%3csvg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' x='0' y='0' viewBox='0 0 14 14' xml:space='preserve'%3e %3ccircle fill='rgb(191%2c 222%2c 255)' cx='7' cy='7' r='6.75'/%3e %3cpath fill='white' d='M 7 0.5 c 3.584 0 6.5 2.916 6.5 6.5 s -2.916 6.5 -6.5 6.5 S 0.5 10.584 0.5 7 3.416 0.5 7 0.5 M 7 0 a 7 7 0 1 0 0 14 A 7 7 0 0 0 7 0 z'/%3e %3cpath fill='rgb(0%2c 122%2c 255)' d='M 10.704 6.827 L 5.3 3.676 A 0.2 0.2 0 0 0 5 3.848 v 6.304 a 0.2 0.2 0 0 0 0.3 0.173 l 5.404 -3.152 a 0.2 0.2 0 0 0 0 -0.346 z'/%3e %3c/svg%3e":WI.DOMNode.isPauseEvent(_.eventName)?V.src="data:image/svg+xml,%3csvg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' x='0' y='0' viewBox='0 0 14 14' xml:space='preserve'%3e %3ccircle fill='rgb(191%2c 222%2c 255)' cx='7' cy='7' r='6.75'/%3e %3cpath fill='white' d='M 7 0.5 c 3.584 0 6.5 2.916 6.5 6.5 s -2.916 6.5 -6.5 6.5 S 0.5 10.584 0.5 7 3.416 0.5 7 0.5 M 7 0 a 7 7 0 1 0 0 14 A 7 7 0 0 0 7 0 z'/%3e %3cpath fill='rgb(0%2c 122%2c 255)' d='M 5.8 10 H 4.2 a 0.2 0.2 0 0 1 -0.2 -0.2 V 4.2 c 0 -0.11 0.09 -0.2 0.2 -0.2 h 1.6 c 0.11 0 0.2 0.09 0.2 0.2 v 5.6 a 0.2 0.2 0 0 1 -0.2 0.2 z M 9.8 10 H 8.2 a 0.2 0.2 0 0 1 -0.2 -0.2 V 4.2 c 0 -0.11 0.09 -0.2 0.2 -0.2 h 1.6 c 0.11 0 0.2 0.09 0.2 0.2 v 5.6 a 0.2 0.2 0 0 1 -0.2 0.2 z'/%3e %3c/svg%3e":WI.DOMNode.isStopEvent(_.eventName)?V.src="data:image/svg+xml,%3csvg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' x='0' y='0' viewBox='0 0 14 14' xml:space='preserve'%3e %3ccircle fill='rgb(191%2c 222%2c 255)' cx='7' cy='7' r='6.75'/%3e %3cpath fill='white' d='M 7 0.5 c 3.584 0 6.5 2.916 6.5 6.5 s -2.916 6.5 -6.5 6.5 S 0.5 10.584 0.5 7 3.416 0.5 7 0.5 M 7 0 a 7 7 0 1 0 0 14 A 7 7 0 0 0 7 0 z'/%3e %3cpath fill='rgb(0%2c 122%2c 255)' d='M 9.8 10 H 4.2 a 0.2 0.2 0 0 1 -0.2 -0.2 V 4.2 c 0 -0.11 0.09 -0.2 0.2 -0.2 h 5.6 c 0.11 0 0.2 0.09 0.2 0.2 v 5.6 a 0.2 0.2 0 0 1 -0.2 0.2 z'/%3e %3c/svg%3e":V.src="data:image/svg+xml,%3csvg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' x='0' y='0' viewBox='0 0 14 14' xml:space='preserve'%3e %3ccircle fill='rgb(191%2c 222%2c 255)' cx='7' cy='7' r='6.75'/%3e %3cpath fill='white' d='M 7 0.5 c 3.584 0 6.5 2.916 6.5 6.5 s -2.916 6.5 -6.5 6.5 S 0.5 10.584 0.5 7 3.416 0.5 7 0.5 M 7 0 a 7 7 0 1 0 0 14 A 7 7 0 0 0 7 0 z'/%3e %3cpath fill='rgb(0%2c 122%2c 255)' d='M 7 8.5 a 1.5 1.5 0 0 1 0 -3 1.5 1.5 0 0 1 0 3 z M 3 8.5 a 1.5 1.5 0 0 1 0 -3 1.5 1.5 0 0 1 0 3 z M 11 8.5 a 1.5 1.5 0 0 1 0 -3 1.5 1.5 0 0 1 0 3 z'/%3e %3c/svg%3e"}let S=b.appendChild(document.createElement("td"));S.classList.add("time");const E=!0;S.textContent=Number.secondsToString(_.timestamp,E);let k=b.appendChild(document.createElement("td"));k.classList.add("originator"),_.originator&&(k.appendChild(WI.linkifyNodeReference(_.originator)),b.classList.add("inherited"),this.element.classList.add("has-inherited"))}}_handleDOMNodeDidFireEvent(e){this.needsLayout()}_handleDOMNodePowerEfficientPlaybackStateChanged(e){this.needsLayout()}};WI.DOMNodeDetailsSidebarPanel=class extends WI.DOMDetailsSidebarPanel{constructor(){super("dom-node-details",WI.UIString("Node")),this._eventListenerGroupingMethodSetting=new WI.Setting("dom-node-event-listener-grouping-method",WI.DOMNodeDetailsSidebarPanel.EventListenerGroupingMethod.Event),this.element.classList.add("dom-node"),this._nodeRemoteObject=null}closed(){WI.domManager.removeEventListener(null,null,this),super.closed()}initialLayout(){super.initialLayout(),WI.domManager.addEventListener(WI.DOMManager.Event.AttributeModified,this._attributesChanged,this),WI.domManager.addEventListener(WI.DOMManager.Event.AttributeRemoved,this._attributesChanged,this),WI.domManager.addEventListener(WI.DOMManager.Event.CharacterDataModified,this._characterDataModified,this),WI.domManager.addEventListener(WI.DOMManager.Event.CustomElementStateChanged,this._customElementStateChanged,this),this._identityNodeTypeRow=new WI.DetailsSectionSimpleRow(WI.UIString("Type")),this._identityNodeNameRow=new WI.DetailsSectionSimpleRow(WI.UIString("Name")),this._identityNodeValueRow=new WI.DetailsSectionSimpleRow(WI.UIString("Value")),this._identityNodeContentSecurityPolicyHashRow=new WI.DetailsSectionSimpleRow(WI.UIString("CSP Hash"));var e=new WI.DetailsSectionGroup([this._identityNodeTypeRow,this._identityNodeNameRow,this._identityNodeValueRow,this._identityNodeContentSecurityPolicyHashRow]),t=new WI.DetailsSection("dom-node-identity",WI.UIString("Identity"),[e]);this._attributesDataGridRow=new WI.DetailsSectionDataGridRow(null,WI.UIString("No Attributes"));var i=new WI.DetailsSectionGroup([this._attributesDataGridRow]),n=new WI.DetailsSection("dom-node-attributes",WI.UIString("Attributes"),[i]);this._propertiesRow=new WI.DetailsSectionRow;var s=new WI.DetailsSectionGroup([this._propertiesRow]),a=new WI.DetailsSection("dom-node-properties",WI.UIString("Properties"),[s]);let d=WI.ImageUtilities.useSVGSymbol("data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 13'%3e %3cg transform='translate(0.5%2c 0.5)' stroke='rgb(127%2c 127%2c 127)' stroke-width='1' fill='none'%3e %3ccircle cx='6' cy='6' r='6'/%3e %3cpath d='M3 4 L 9 4' stroke-linecap='square'/%3e %3cpath d='M4 6 L 8 6' stroke-linecap='square'/%3e %3cpath d='M5 8 L 7 8' stroke-linecap='square'/%3e %3c/g%3e %3c/svg%3e","filter",WI.UIString("Grouping Method")),p=d.appendChild(document.createElement("select"));p.addEventListener("change",w=>{this._eventListenerGroupingMethodSetting.value=p.value,this._refreshEventListeners()});function f(w,S){let E=p.appendChild(document.createElement("option"));E.value=S,E.textContent=w}f(WI.UIString("Group by Event"),WI.DOMNodeDetailsSidebarPanel.EventListenerGroupingMethod.Event),f(WI.UIString("Group by Target"),WI.DOMNodeDetailsSidebarPanel.EventListenerGroupingMethod.Target),p.value=this._eventListenerGroupingMethodSetting.value,this._eventListenersSectionGroup=new WI.DetailsSectionGroup;let _=new WI.DetailsSection("dom-node-event-listeners",WI.UIString("Event Listeners"),[this._eventListenersSectionGroup],d);if(this.contentView.element.appendChild(t.element),this.contentView.element.appendChild(n.element),this.contentView.element.appendChild(a.element),this.contentView.element.appendChild(_.element),WI.sharedApp.hasExtraDomains&&(InspectorBackend.domains.DOM.getDataBindingsForNode&&(this._dataBindingsSection=new WI.DetailsSection("dom-node-data-bindings",WI.UIString("Data Bindings"),[]),this.contentView.element.appendChild(this._dataBindingsSection.element)),InspectorBackend.domains.DOM.getAssociatedDataForNode)){this._associatedDataGrid=new WI.DetailsSectionRow(WI.UIString("No Associated Data"));let w=new WI.DetailsSectionGroup([this._associatedDataGrid]),S=new WI.DetailsSection("dom-node-associated-data",WI.UIString("Associated Data"),[w]);this.contentView.element.appendChild(S.element)}if(this._accessibilitySupported()){this._accessibilityEmptyRow=new WI.DetailsSectionRow(WI.UIString("No Accessibility Information")),this._accessibilityNodeActiveDescendantRow=new WI.DetailsSectionSimpleRow(WI.UIString("Shared Focus")),this._accessibilityNodeBusyRow=new WI.DetailsSectionSimpleRow(WI.UIString("Busy")),this._accessibilityNodeCheckedRow=new WI.DetailsSectionSimpleRow(WI.UIString("Checked")),this._accessibilityNodeChildrenRow=new WI.DetailsSectionSimpleRow(WI.UIString("Children")),this._accessibilityNodeControlsRow=new WI.DetailsSectionSimpleRow(WI.UIString("Controls")),this._accessibilityNodeCurrentRow=new WI.DetailsSectionSimpleRow(WI.UIString("Current")),this._accessibilityNodeDisabledRow=new WI.DetailsSectionSimpleRow(WI.UIString("Disabled")),this._accessibilityNodeExpandedRow=new WI.DetailsSectionSimpleRow(WI.UIString("Expanded")),this._accessibilityNodeFlowsRow=new WI.DetailsSectionSimpleRow(WI.UIString("Flows")),this._accessibilityNodeFocusedRow=new WI.DetailsSectionSimpleRow(WI.UIString("Focused")),this._accessibilityNodeHeadingLevelRow=new WI.DetailsSectionSimpleRow(WI.UIString("Heading Level")),this._accessibilityNodehierarchyLevelRow=new WI.DetailsSectionSimpleRow(WI.UIString("Hierarchy Level")),this._accessibilityNodeIgnoredRow=new WI.DetailsSectionSimpleRow(WI.UIString("Ignored")),this._accessibilityNodeInvalidRow=new WI.DetailsSectionSimpleRow(WI.UIString("Invalid")),this._accessibilityNodeLiveRegionStatusRow=new WI.DetailsSectionSimpleRow(WI.UIString("Live")),this._accessibilityNodeMouseEventRow=new WI.DetailsSectionSimpleRow(""),this._accessibilityNodeLabelRow=new WI.DetailsSectionSimpleRow(WI.UIString("Label")),this._accessibilityNodeOwnsRow=new WI.DetailsSectionSimpleRow(WI.UIString("Owns")),this._accessibilityNodeParentRow=new WI.DetailsSectionSimpleRow(WI.UIString("Parent")),this._accessibilityNodePressedRow=new WI.DetailsSectionSimpleRow(WI.UIString("Pressed")),this._accessibilityNodeReadonlyRow=new WI.DetailsSectionSimpleRow(WI.UIString("Readonly")),this._accessibilityNodeRequiredRow=new WI.DetailsSectionSimpleRow(WI.UIString("Required")),this._accessibilityNodeRoleRow=new WI.DetailsSectionSimpleRow(WI.UIString("Role")),this._accessibilityNodeSelectedRow=new WI.DetailsSectionSimpleRow(WI.UIString("Selected")),this._accessibilityNodeSelectedChildrenRow=new WI.DetailsSectionSimpleRow(WI.UIString("Selected Items")),this._accessibilityGroup=new WI.DetailsSectionGroup([this._accessibilityEmptyRow]);var b=new WI.DetailsSection("dom-node-accessibility",WI.UIString("Accessibility"),[this._accessibilityGroup]);this.contentView.element.appendChild(b.element)}}layout(){super.layout(),this.domNode&&(this._refreshIdentity(),this._refreshAttributes(),this._refreshProperties(),this._refreshEventListeners(),this._refreshDataBindings(),this._refreshAssociatedData(),this._refreshAccessibility())}sizeDidChange(){super.sizeDidChange(),this._attributesDataGridRow.sizeDidChange()}attached(){super.attached(),WI.DOMNode.addEventListener(WI.DOMNode.Event.EventListenersChanged,this._eventListenersChanged,this)}detached(){WI.DOMNode.removeEventListener(WI.DOMNode.Event.EventListenersChanged,this._eventListenersChanged,this),super.detached()}_accessibilitySupported(){return window.DOMAgent&&DOMAgent.getAccessibilityPropertiesForNode}_refreshIdentity(){const e=this.domNode;this._identityNodeTypeRow.value=this._nodeTypeDisplayName(),this._identityNodeNameRow.value=e.nodeNameInCorrectCase(),this._identityNodeValueRow.value=e.nodeValue(),this._identityNodeContentSecurityPolicyHashRow.value=e.contentSecurityPolicyHash()}_refreshAttributes(){let e=this.domNode;if(!e||!e.hasAttributes()){this._attributesDataGridRow.dataGrid=null;return}let t=this._attributesDataGridRow.dataGrid;if(!t){const n={name:{title:WI.UIString("Name"),width:"30%"},value:{title:WI.UIString("Value")}};t=this._attributesDataGridRow.dataGrid=new WI.DataGrid(n)}t.removeChildren();let i=e.attributes();i.sort((n,s)=>n.name.extendedLocaleCompare(s.name));for(let n of i){let s=new WI.EditableDataGridNode(n);s.addEventListener(WI.EditableDataGridNode.Event.ValueChanged,this._attributeNodeValueChanged,this),t.appendChild(s)}t.updateLayoutIfNeeded()}_refreshProperties(){this._nodeRemoteObject&&(this._nodeRemoteObject.release(),this._nodeRemoteObject=null);let e=this.domNode;const t="dom-node-details-sidebar-properties-object-group";RuntimeAgent.releaseObjectGroup(t),WI.RemoteObject.resolveNode(e,t).then(s=>{if(this.domNode!==e)return;this._nodeRemoteObject=s;function a(){for(var f=this,_=[],b=1;f;)_[b++]=f,f=f.__proto__;return _}const d=void 0,p=!1;s.callFunction(a,d,p,i.bind(this))});function i(s,a,d){s||d||!a||this.domNode===e&&a.deprecatedGetOwnProperties(n.bind(this))}function n(s){if(!s||this.domNode!==e)return;let a=this._propertiesRow.element;a.removeChildren();let d=new WI.PropertyPath(this._nodeRemoteObject,"node"),p=!0;for(let f=0;f<s.length;++f){if(!parseInt(s[f].name,10))continue;let _=s[f].value,b=_.description,w=b;/Prototype$/.test(w)?(b=b.replace(/Prototype$/,""),w=b+WI.UIString(" (Prototype)")):w==="Object"&&(w=w+WI.UIString(" (Prototype)"));let S=p?WI.ObjectTreeView.Mode.Properties:WI.ObjectTreeView.Mode.PureAPI,E=new WI.ObjectTreeView(_,S,d);E.showOnlyProperties(),E.setPrototypeNameOverride(b);let k=new WI.DetailsSection(_.description.hash+"-prototype-properties",w,null,null,!0);k.groups[0].rows=[new WI.ObjectPropertiesDetailSectionRow(E,k)],a.appendChild(k.element),p=!1}}}_refreshEventListeners(){var e=this.domNode;if(!e)return;const t=Symbol("window");function i(d,p,f={}){let _=p.map(E=>new WI.EventListenerSectionGroup(E,f));const b=null,w=!0;let S=new WI.DetailsSection(`${d}-event-listener-section`,d,_,b,w);return S.element.classList.add("event-listener-section"),S}function n(d){let p=new Map;for(let b of d){console.assert(b.nodeId||b.onWindow),b.nodeId&&(b.node=WI.domManager.nodeForId(b.nodeId));let w=p.get(b.type);w||p.set(b.type,w=[]),w.push(b)}let f=[],_=Array.from(p.keys());_.sort();for(let b of _)f.push(i(b,p.get(b),{hideType:!0}));return f}function s(d){let p=new Map;for(let w of d){console.assert(w.nodeId||w.onWindow),w.nodeId&&(w.node=WI.domManager.nodeForId(w.nodeId));let S=w.onWindow?t:w.node,E=p.get(S);E||p.set(S,E=[]),E.push(w)}let f=[];function _(w){let S=p.get(w);if(!S)return;S.sort((R,M)=>R.type.toLowerCase().extendedLocaleCompare(M.type.toLowerCase()));let E=w===t?WI.unlocalizedString("window"):w.displayName,k=i(E,S,{hideTarget:!0});w instanceof WI.DOMNode&&WI.bindInteractionsForNodeToElement(w,k.titleElement,{ignoreClick:!0}),f.push(k)}let b=e;do _(b);while(b=b.parentNode);return _(t),f}function a(d,p){if(!d&&this.domNode===e){if(!p.length){var f=new WI.DetailsSectionRow(WI.UIString("No Event Listeners"));f.showEmptyMessage(),this._eventListenersSectionGroup.rows=[f];return}switch(this._eventListenerGroupingMethodSetting.value){case WI.DOMNodeDetailsSidebarPanel.EventListenerGroupingMethod.Event:this._eventListenersSectionGroup.rows=n.call(this,p);break;case WI.DOMNodeDetailsSidebarPanel.EventListenerGroupingMethod.Target:this._eventListenersSectionGroup.rows=s.call(this,p);break}}}e.getEventListeners(a.bind(this))}_refreshDataBindings(){if(!this._dataBindingsSection)return;let e=this.domNode;!e||DOMAgent.getDataBindingsForNode(this.domNode.id).then(({dataBindings:t})=>{if(this.domNode!==e)return;if(!t.length){let n=new WI.DetailsSectionRow(WI.UIString("No Data Bindings"));n.showEmptyMessage(),this._dataBindingsSection.groups=[new WI.DetailsSectionGroup([n])];return}let i=[];for(let{binding:n,type:s,value:a}of t)i.push(new WI.DetailsSectionGroup([new WI.DetailsSectionSimpleRow(WI.UIString("Binding"),n),new WI.DetailsSectionSimpleRow(WI.UIString("Type"),s),new WI.DetailsSectionSimpleRow(WI.UIString("Value"),a)]));this._dataBindingsSection.groups=i})}_refreshAssociatedData(){if(!this._associatedDataGrid)return;const e="dom-node-details-sidebar-associated-data-object-group";RuntimeAgent.releaseObjectGroup(e);let t=this.domNode;!t||DOMAgent.getAssociatedDataForNode(t.id).then(({associatedData:i})=>{if(this.domNode!==t)return;if(!i){this._associatedDataGrid.showEmptyMessage();return}let n=i;const s={objectGroup:e,doNotPauseOnExceptionsAndMuteConsole:!0};WI.runtimeManager.evaluateInInspectedWindow(n,s,(a,d)=>{if(console.assert(!d),!a){this._associatedDataGrid.showEmptyMessage();return}this._associatedDataGrid.hideEmptyMessage();const p=null,f=!0;let _=WI.FormattedValue.createObjectTreeOrFormattedValueForRemoteObject(a,p,f),b=_.__objectTree;b&&(b.showOnlyJSON(),b.expand()),this._associatedDataGrid.element.appendChild(_)})})}_refreshAccessibility(){if(!this._accessibilitySupported())return;var e=this.domNode;if(!e)return;var t={};function i(p){return t[p]?WI.UIString("Yes"):""}function n(p){return t[p]!==void 0?t[p]?WI.UIString("Yes"):WI.UIString("No"):""}function s(p){var f=null;if(p!==void 0&&typeof p=="number"){var _=WI.domManager.nodeForId(p);_&&(f=WI.linkifyAccessibilityNodeReference(_))}return f}function a(p){if(!p)return null;const f=5;let _=!1,b=0,w=document.createElement("div");w.classList.add("list-container");let S=w.createChild("ul","node-link-list"),E=[];for(let k of p){let R=WI.domManager.nodeForId(k);if(!R)continue;let M=WI.linkifyAccessibilityNodeReference(R);_=!0;let L=S.createChild("li");L.appendChild(M),b>=f&&(L.hidden=!0,E.push(L)),b++}if(w.appendChild(S),b>f){let k=w.createChild("button","expand-list-button");k.textContent=WI.UIString("%d More\u2026").format(b-f),k.addEventListener("click",()=>{E.forEach(R=>{R.hidden=!1}),k.remove()})}return _?w:null}function d(p){if(this.domNode===e)if(t=p,p&&p.exists){var f=s(p.activeDescendantNodeId),_=n("busy"),b="";p.checked!==void 0&&(p.checked===DOMAgent.AccessibilityPropertiesChecked.True?b=WI.UIString("Yes"):p.checked===DOMAgent.AccessibilityPropertiesChecked.Mixed?b=WI.UIString("Mixed"):b=WI.UIString("No"));var w=a(p.childNodeIds),S=a(p.controlledNodeIds),E="";switch(p.current){case DOMAgent.AccessibilityPropertiesCurrent.True:E=WI.UIString("True");break;case DOMAgent.AccessibilityPropertiesCurrent.Page:E=WI.UIString("Page");break;case DOMAgent.AccessibilityPropertiesCurrent.Location:E=WI.UIString("Location");break;case DOMAgent.AccessibilityPropertiesCurrent.Step:E=WI.UIString("Step");break;case DOMAgent.AccessibilityPropertiesCurrent.Date:E=WI.UIString("Date");break;case DOMAgent.AccessibilityPropertiesCurrent.Time:E=WI.UIString("Time");break;default:E=""}var k=i("disabled"),R=n("expanded"),M=a(p.flowedNodeIds),L=n("focused"),V="";p.ignored&&(V=WI.UIString("Yes"),p.hidden?V=WI.UIString("%s (hidden)").format(V):p.ignoredByDefault&&(V=WI.UIString("%s (default)").format(V)));var H="";p.invalid===DOMAgent.AccessibilityPropertiesInvalid.True?H=WI.UIString("Yes"):p.invalid===DOMAgent.AccessibilityPropertiesInvalid.Grammar?H=WI.UIString("Grammar"):p.invalid===DOMAgent.AccessibilityPropertiesInvalid.Spelling&&(H=WI.UIString("Spelling"));var O=p.label,z="",K=null,q=p.liveRegionStatus;switch(q){case DOMAgent.AccessibilityPropertiesLiveRegionStatus.Assertive:z=WI.UIString("Assertive");break;case DOMAgent.AccessibilityPropertiesLiveRegionStatus.Polite:z=WI.UIString("Polite");break;default:z=""}if(z){var Y=p.liveRegionRelevant;if(Y&&Y.length&&(Y.length===3&&Y[0]===DOMAgent.LiveRegionRelevant.Additions&&Y[1]===DOMAgent.LiveRegionRelevant.Removals&&Y[2]===DOMAgent.LiveRegionRelevant.Text?Y=[WI.UIString("All Changes")]:Y=Y.map(function(Xe){switch(Xe){case DOMAgent.LiveRegionRelevant.Additions:return WI.UIString("Additions");case DOMAgent.LiveRegionRelevant.Removals:return WI.UIString("Removals");case DOMAgent.LiveRegionRelevant.Text:return WI.UIString("Text");default:return'"'+Xe+'"'}}),z+=" ("+Y.join(", ")+")"),p.liveRegionAtomic){K=document.createElement("div"),K.className="value-with-clarification",K.setAttribute("role","text"),K.append(z);var se=document.createElement("div");se.className="clarification",se.append(WI.UIString("Region announced in its entirety.")),K.appendChild(se)}}var ce=p.mouseEventNodeId,le="",te=null;ce&&(ce===p.nodeId?le=WI.UIString("Yes"):te=s(ce));var ve=a(p.ownedNodeIds),Pe=s(p.parentNodeId),Be=n("pressed"),qe=i("readonly"),Ue=n("required"),Ge=p.role;let ni=p.isPopupButton,ri=null,He=null,ei=WI.UIString("popup"),ui=WI.UIString("toggle"),vi=WI.UIString("popup, toggle");if(Ge===""||Ge==="unknown")Ge=WI.UIString("No matching ARIA role");else if(Ge){if(Ge==="button"&&(Be&&(He=ui),ni&&(He=He?vi:ei)),e.getAttribute("role")?(He||e.getAttribute("role")!==Ge)&&(ri=WI.UIString("computed")):ri=WI.UIString("default"),He&&ri)Ge=WI.UIString("%s (%s, %s)").format(Ge,He,ri);else if(ri||He){let Xe=ri||He;Ge=WI.UIString("%s (%s)").format(Ge,Xe)}}var it=i("selected"),lt=a(p.selectedChildNodeIds),bt=p.headingLevel,Yt=p.hierarchyLevel;this._accessibilityNodeActiveDescendantRow.value=f||"",this._accessibilityNodeBusyRow.value=_,this._accessibilityNodeCheckedRow.value=b,this._accessibilityNodeChildrenRow.value=w||"",this._accessibilityNodeControlsRow.value=S||"",this._accessibilityNodeCurrentRow.value=E,this._accessibilityNodeDisabledRow.value=k,this._accessibilityNodeExpandedRow.value=R,this._accessibilityNodeFlowsRow.value=M||"",this._accessibilityNodeFocusedRow.value=L,this._accessibilityNodeHeadingLevelRow.value=bt||"",this._accessibilityNodehierarchyLevelRow.value=Yt||"",this._accessibilityNodeIgnoredRow.value=V,this._accessibilityNodeInvalidRow.value=H,this._accessibilityNodeLabelRow.value=O,this._accessibilityNodeLiveRegionStatusRow.value=K||z,this._accessibilityNodeMouseEventRow.label=te?WI.UIString("Click Listener"):WI.UIString("Clickable"),this._accessibilityNodeMouseEventRow.value=te||le,this._accessibilityNodeOwnsRow.value=ve||"",this._accessibilityNodeParentRow.value=Pe||"",this._accessibilityNodePressedRow.value=Be,this._accessibilityNodeReadonlyRow.value=qe,this._accessibilityNodeRequiredRow.value=Ue,this._accessibilityNodeRoleRow.value=Ge,this._accessibilityNodeSelectedRow.value=it,this._accessibilityNodeSelectedChildrenRow.label=WI.UIString("Selected Items"),this._accessibilityNodeSelectedChildrenRow.value=lt||"",lt&&p.selectedChildNodeIds.length===1&&(this._accessibilityNodeSelectedChildrenRow.label=WI.UIString("Selected Item")),this._accessibilityGroup.rows=[this._accessibilityNodeIgnoredRow,this._accessibilityNodeRoleRow,this._accessibilityNodeLabelRow,this._accessibilityNodeParentRow,this._accessibilityNodeActiveDescendantRow,this._accessibilityNodeSelectedChildrenRow,this._accessibilityNodeChildrenRow,this._accessibilityNodeOwnsRow,this._accessibilityNodeControlsRow,this._accessibilityNodeFlowsRow,this._accessibilityNodeMouseEventRow,this._accessibilityNodeFocusedRow,this._accessibilityNodeHeadingLevelRow,this._accessibilityNodehierarchyLevelRow,this._accessibilityNodeBusyRow,this._accessibilityNodeLiveRegionStatusRow,this._accessibilityNodeCurrentRow,this._accessibilityNodeDisabledRow,this._accessibilityNodeInvalidRow,this._accessibilityNodeRequiredRow,this._accessibilityNodeCheckedRow,this._accessibilityNodeExpandedRow,this._accessibilityNodePressedRow,this._accessibilityNodeReadonlyRow,this._accessibilityNodeSelectedRow],this._accessibilityEmptyRow.hideEmptyMessage()}else this._accessibilityGroup.rows=[this._accessibilityEmptyRow],this._accessibilityEmptyRow.showEmptyMessage()}e.accessibilityProperties(d.bind(this))}_eventListenersChanged(e){(e.target===this.domNode||e.target.isAncestor(this.domNode))&&this._refreshEventListeners()}_attributesChanged(e){e.data.node===this.domNode&&(this._refreshAttributes(),this._refreshAccessibility(),this._refreshDataBindings())}_attributeNodeValueChanged(e){let t=e.data,i=e.target.data;t.columnIdentifier==="name"?this.domNode.removeAttribute(i[t.columnIdentifier],n=>{this.domNode.setAttribute(t.value,`${t.value}="${i.value}"`)}):t.columnIdentifier==="value"&&this.domNode.setAttributeValue(i.name,t.value)}_characterDataModified(e){e.data.node===this.domNode&&(this._identityNodeValueRow.value=this.domNode.nodeValue())}_customElementStateChanged(e){e.data.node===this.domNode&&this._refreshIdentity()}_nodeTypeDisplayName(){switch(this.domNode.nodeType()){case Node.ELEMENT_NODE:{const e=WI.UIString("Element"),t=this._customElementState();return t===null?e:`${e} (${t})`}case Node.TEXT_NODE:return WI.UIString("Text Node");case Node.COMMENT_NODE:return WI.UIString("Comment");case Node.DOCUMENT_NODE:return WI.UIString("Document");case Node.DOCUMENT_TYPE_NODE:return WI.UIString("Document Type");case Node.DOCUMENT_FRAGMENT_NODE:return WI.UIString("Document Fragment");case Node.CDATA_SECTION_NODE:return WI.UIString("Character Data");case Node.PROCESSING_INSTRUCTION_NODE:return WI.UIString("Processing Instruction");default:return console.error("Unknown DOM node type: ",this.domNode.nodeType()),this.domNode.nodeType()}}_customElementState(){const e=this.domNode.customElementState();switch(e){case WI.DOMNode.CustomElementState.Builtin:return null;case WI.DOMNode.CustomElementState.Custom:return WI.UIString("Custom");case WI.DOMNode.CustomElementState.Waiting:return WI.UIString("Undefined custom element");case WI.DOMNode.CustomElementState.Failed:return WI.UIString("Failed to upgrade")}return console.error("Unknown DOM custom element state: ",e),null}};WI.DOMNodeDetailsSidebarPanel.EventListenerGroupingMethod={Event:"event",Target:"target"};WI.DOMNodeEventsContentView=class extends WI.ContentView{constructor(e){console.assert(e instanceof WI.DOMNode);const t=null;super(t),this._domNode=e,this.element.classList.add("dom-node-details","dom-events"),this._breakdownView=null}initialLayout(){super.initialLayout(),this._breakdownView=new WI.DOMEventsBreakdownView(this._domNode,{includeGraph:!0}),this.addSubview(this._breakdownView)}};WI.DOMNodeTreeElement=class extends WI.GeneralTreeElement{constructor(e){console.assert(e instanceof WI.DOMNode);const t=null;super("dom-node",e.displayName,t,e,{hasChildren:!0}),this.status=WI.linkifyNodeReferenceElement(e,WI.createGoToArrowButton()),this.tooltipHandledSeparately=!0}ondelete(){return this.__deletedViaDeleteKeyboardShortcut=!0,WI.domDebuggerManager.removeDOMBreakpointsForNode(this.representedObject),WI.domManager.removeEventListenerBreakpointsForNode(this.representedObject),!0}populateContextMenu(e,t){e.appendSeparator(),WI.appendContextMenuItemsForDOMNodeBreakpoints(e,this.representedObject),e.appendSeparator(),e.appendItem(WI.repeatedUIString.revealInDOMTree(),()=>{WI.domManager.inspectElement(this.representedObject.id)})}};WI.DOMStorageContentView=class extends WI.ContentView{constructor(e){super(e),this.element.classList.add("dom-storage"),e.addEventListener(WI.DOMStorageObject.Event.ItemsCleared,this.itemsCleared,this),e.addEventListener(WI.DOMStorageObject.Event.ItemAdded,this.itemAdded,this),e.addEventListener(WI.DOMStorageObject.Event.ItemRemoved,this.itemRemoved,this),e.addEventListener(WI.DOMStorageObject.Event.ItemUpdated,this.itemUpdated,this);let t={};t.key={title:WI.UIString("Key"),sortable:!0},t.value={title:WI.UIString("Value"),sortable:!0},this._dataGrid=new WI.DataGrid(t,{editCallback:this._editingCallback.bind(this),copyCallback:this._dataGridCopy.bind(this),deleteCallback:this._deleteCallback.bind(this)}),this._dataGrid.sortOrder=WI.DataGrid.SortOrder.Ascending,this._dataGrid.sortColumnIdentifier="key",this._dataGrid.createSettings("dom-storage-content-view"),this._dataGrid.addEventListener(WI.DataGrid.Event.SortChanged,this._sortDataGrid,this),this.addSubview(this._dataGrid),this._populate()}saveToCookie(e){e.type=WI.ContentViewCookieType.DOMStorage,e.isLocalStorage=this.representedObject.isLocalStorage(),e.host=this.representedObject.host}get scrollableElements(){return[this._dataGrid.scrollContainer]}itemsCleared(e){this._dataGrid.removeChildren(),this._dataGrid.addPlaceholderNode()}itemRemoved(e){for(let t of this._dataGrid.children)if(t.data.key===e.data.key)return this._dataGrid.removeChild(t);return null}itemAdded(e){let{key:t,value:i}=e.data,n=i;i=this._truncateValue(i);for(let s of this._dataGrid.children)if(s.data.key===t)return;this._dataGrid.appendChild(new WI.DataGridNode({key:t,value:i,originalValue:n},!1)),this._sortDataGrid()}itemUpdated(e){let{key:t,value:i}=e.data,n=i;i=this._truncateValue(i);let s=!1;for(let a of this._dataGrid.children)if(a.data.key===t){if(s){this._dataGrid.removeChild(a);continue}s=!0,a.data.value=i,a.data.originalValue=n,a.refresh()}this._sortDataGrid()}_truncateValue(e){return e.truncate(200)}_populate(){this.representedObject.getEntries(function(e,t){if(!e){for(let[i,n]of t){if(!i||!n)continue;let s=n;n=this._truncateValue(n);let a=new WI.DataGridNode({key:i,value:n,originalValue:s},!1);this._dataGrid.appendChild(a)}this._sortDataGrid(),this._dataGrid.addPlaceholderNode(),this._dataGrid.updateLayout()}}.bind(this))}_sortDataGrid(){let e=this._dataGrid.sortColumnIdentifier||"key";function t(i,n){return i.data[e].extendedLocaleCompare(n.data[e])}this._dataGrid.sortNodesImmediately(t)}_deleteCallback(e){!e||e.isPlaceholderNode||(this._dataGrid.removeChild(e),this.representedObject.removeItem(e.data.key))}_editingCallback(e,t,i,n,s){var a=e.data.key.trim().removeWordBreakCharacters(),d=e.data.value.trim().removeWordBreakCharacters(),p=i.trim().removeWordBreakCharacters(),f=n.trim().removeWordBreakCharacters(),_=e.__hasUncommittedEdits,b=p!==f,w=t==="key",S=!w,E=this.representedObject;if(!b&&!_)return;b&&!e.__hasUncommittedEdits&&(e.__hasUncommittedEdits=!0,e.__originalKey=w?p:a,e.__originalValue=S?p:d);function k(){e.element.classList.remove(WI.DOMStorageContentView.MissingKeyStyleClassName),e.element.classList.remove(WI.DOMStorageContentView.MissingValueStyleClassName),e.element.classList.remove(WI.DOMStorageContentView.DuplicateKeyStyleClassName),e.__hasUncommittedEdits=void 0,e.__originalKey=void 0,e.__originalValue=void 0}w?a.length?e.element.classList.remove(WI.DOMStorageContentView.MissingKeyStyleClassName):e.element.classList.add(WI.DOMStorageContentView.MissingKeyStyleClassName):S&&(d.length?e.element.classList.remove(WI.DOMStorageContentView.MissingValueStyleClassName):e.element.classList.add(WI.DOMStorageContentView.MissingValueStyleClassName));var R=a!==e.__originalKey;R&&(E.entries.has(a)?e.element.classList.add(WI.DOMStorageContentView.DuplicateKeyStyleClassName):e.element.classList.remove(WI.DOMStorageContentView.DuplicateKeyStyleClassName));var M=this._dataGrid.orderedColumns.indexOf(t),L=s==="forward"&&M===this._dataGrid.orderedColumns.length-1,V=s==="backward"&&M===0,H=L||V||!s;if(!!H){if(!a.length&&!d.length&&!e.isPlaceholderNode){this._dataGrid.removeChild(e),E.removeItem(e.__originalKey);return}var O=e.element.classList.contains(WI.DOMStorageContentView.DuplicateKeyStyleClassName);!a.length||!d.length||O||(R&&!e.isPlaceholderNode&&E.removeItem(e.__originalKey),e.isPlaceholderNode&&this._dataGrid.addPlaceholderNode(),k(),E.setItem(a,d))}}_dataGridCopy(e,t,i){return t==="value"&&e.data.originalValue?e.data.originalValue:i}};WI.DOMStorageContentView.DuplicateKeyStyleClassName="duplicate-key";WI.DOMStorageContentView.MissingKeyStyleClassName="missing-key";WI.DOMStorageContentView.MissingValueStyleClassName="missing-value";WI.DOMStorageTreeElement=class extends WI.StorageTreeElement{constructor(e){if(console.assert(e instanceof WI.DOMStorageObject),e.isLocalStorage())var t=WI.DOMStorageTreeElement.LocalStorageIconStyleClassName;else var t=WI.DOMStorageTreeElement.SessionStorageIconStyleClassName;super(t,WI.displayNameForHost(e.host),e)}get name(){return WI.displayNameForHost(this.representedObject.host)}get categoryName(){return this.representedObject.isLocalStorage()?WI.UIString("Local Storage"):WI.UIString("Session Storage")}};WI.DOMStorageTreeElement.LocalStorageIconStyleClassName="local-storage-icon";WI.DOMStorageTreeElement.SessionStorageIconStyleClassName="session-storage-icon";WI.DOMTreeElement=class Fu extends WI.TreeElement{constructor(e,t){super("",e),this._elementCloseTag=t,this.hasChildren=!t&&this._hasVisibleChildren(),this.representedObject.nodeType()===Node.ELEMENT_NODE&&!t&&(this._canAddAttributes=!0),this._searchQuery=null,this._expandedChildrenLimit=WI.DOMTreeElement.InitialChildrenLimit,this._breakpointStatus=WI.DOMTreeElement.BreakpointStatus.None,this._animatingHighlight=!1,this._shouldHighlightAfterReveal=!1,this._boundHighlightAnimationEnd=this._highlightAnimationEnd.bind(this),this._subtreeBreakpointTreeElements=null,this._showGoToArrow=!1,this._highlightedAttributes=new Set,this._recentlyModifiedAttributes=new Map,this._closeTagTreeElement=null,e.addEventListener(WI.DOMNode.Event.EnabledPseudoClassesChanged,this._updatePseudoClassIndicator,this),this._ignoreSingleTextChild=!1,this._forceUpdateTitle=!1}static shadowRootTypeDisplayName(e){switch(e){case WI.DOMNode.ShadowRootType.UserAgent:return WI.UIString("User Agent");case WI.DOMNode.ShadowRootType.Open:return WI.UIString("Open");case WI.DOMNode.ShadowRootType.Closed:return WI.UIString("Closed")}}get hasBreakpoint(){return this._breakpointStatus!==WI.DOMTreeElement.BreakpointStatus.None||this._subtreeBreakpointTreeElements&&this._subtreeBreakpointTreeElements.size}get breakpointStatus(){return this._breakpointStatus}set breakpointStatus(e){if(this._breakpointStatus===e)return;let t;if(this._breakpointStatus===WI.DOMTreeElement.BreakpointStatus.None?t=1:e===WI.DOMTreeElement.BreakpointStatus.None&&(t=-1),this._breakpointStatus=e,this._updateBreakpointStatus(),!t)return;let i=this.parent;for(;i&&!i.root;)i._subtreeBreakpointChanged(this),i=i.parent}bindRevealDescendantBreakpointsMenuItemHandler(){if(!this._subtreeBreakpointTreeElements||!this._subtreeBreakpointTreeElements.size)return null;let e=Array.from(this._subtreeBreakpointTreeElements);return()=>{for(let t of e)t.reveal()}}get closeTagTreeElement(){return this._closeTagTreeElement}revealAndHighlight(){this._animatingHighlight||(this._shouldHighlightAfterReveal=!0,this.reveal())}isCloseTag(){return this._elementCloseTag}highlightSearchResults(e){this._searchQuery!==e&&(this._updateSearchHighlight(!1),this._highlightResult=void 0),this._searchQuery=e,this._searchHighlightsVisible=!0,this.updateTitle(!0)}hideSearchHighlights(){this._searchHighlightsVisible=!1,this._updateSearchHighlight(!1)}emphasizeSearchHighlight(){var e=this.title.querySelector("."+WI.DOMTreeElement.SearchHighlightStyleClassName);if(console.assert(e),!e)return;this._bouncyHighlightElement&&this._bouncyHighlightElement.remove(),this._bouncyHighlightElement=document.createElement("div"),this._bouncyHighlightElement.className=WI.DOMTreeElement.BouncyHighlightStyleClassName,this._bouncyHighlightElement.textContent=e.textContent;var t=e.getBoundingClientRect(),i=this.treeOutline.element.getBoundingClientRect();this._bouncyHighlightElement.style.top=t.top-i.top+"px",this._bouncyHighlightElement.style.left=t.left-i.left+"px",this.title.appendChild(this._bouncyHighlightElement);function n(){!this._bouncyHighlightElement||(this._bouncyHighlightElement.remove(),this._bouncyHighlightElement=null)}this._bouncyHighlightElement.addEventListener("animationend",n.bind(this))}_updateSearchHighlight(e){if(!this._highlightResult)return;function t(d){switch(d.type){case"added":d.parent.insertBefore(d.node,d.nextSibling);break;case"changed":d.node.textContent=d.newText;break}}function i(d){switch(d.type){case"added":d.node.remove();break;case"changed":d.node.textContent=d.oldText;break}}for(var n=e?t:i,s=0,a=this._highlightResult.length;s<a;++s)n(this._highlightResult[s])}get hovered(){return this._hovered}set hovered(e){this._hovered!==e&&(this._hovered=e,this.listItemElement&&(this.listItemElement.classList.toggle("hovered",this._hovered),this.updateSelectionArea()))}get editable(){let e=this.representedObject;return e.isShadowRoot()||e.isInUserAgentShadowTree()||e.isPseudoElement()?!1:this.treeOutline.editable}get expandedChildrenLimit(){return this._expandedChildrenLimit}set expandedChildrenLimit(e){this._expandedChildrenLimit!==e&&(this._expandedChildrenLimit=e,this.treeOutline&&!this._updateChildrenInProgress&&this._updateChildren(!0))}get expandedChildCount(){var e=this.children.length;return e&&this.children[e-1]._elementCloseTag&&e--,e&&this.children[e-1].expandAllButton&&e--,e}set showGoToArrow(e){this._showGoToArrow!==e&&(this._showGoToArrow=e,this.updateTitle())}attributeDidChange(e){this._recentlyModifiedAttributes.has(e)||this._recentlyModifiedAttributes.set(e,{value:null,timestamp:NaN,element:null,listener:null})}highlightAttribute(e){this._highlightedAttributes.add(e)}showChildNode(e){if(console.assert(!this._elementCloseTag),this._elementCloseTag)return null;var t=this._visibleChildren().indexOf(e);return t===-1?null:(t>=this.expandedChildrenLimit&&(this._expandedChildrenLimit=t+1,this._updateChildren(!0)),this.children[t])}toggleElementVisibility(e){let t=this.representedObject;if(t.isPseudoElement()&&(t=t.parentNode,console.assert(t),!t)||t.nodeType()!==Node.ELEMENT_NODE)return;function i(n,s){let a=document.getElementById(n);a||(a=document.createElement("style"),a.id=n,a.textContent=`.${n} { visibility: hidden !important; }`,document.head.appendChild(a)),this.classList.toggle(n,s)}WI.RemoteObject.resolveNode(t).then(n=>{n.callFunction(i,[WI.DOMTreeElement.HideElementStyleSheetIdOrClassName,e],!1),n.release()})}_createTooltipForNode(){var e=this.representedObject;if(!e.nodeName()||e.nodeName().toLowerCase()!=="img")return;function t(i,n,s){if(!(i||s||!n||n.type!=="string"))try{var a=JSON.parse(n.description),d=a[0],p=a[1],f=a[2],_=a[3];p===_&&d===f?this.tooltip=WI.UIString("%d \xD7 %d pixels").format(d,p):this.tooltip=WI.UIString("%d \xD7 %d pixels (Natural: %d \xD7 %d pixels)").format(d,p,f,_)}catch(b){console.error(b)}}WI.RemoteObject.resolveNode(e).then(i=>{function n(){return"["+this.offsetWidth+","+this.offsetHeight+","+this.naturalWidth+","+this.naturalHeight+"]"}i.callFunction(n,void 0,!1,t.bind(this)),i.release()})}updateSelectionArea(){let e=this.listItemElement;if(!e)return;let t=this.treeOutline&&(this.treeOutline.dragOverTreeElement===this||this.selected||this._animatingHighlight);if(!this.hovered&&!t){this._selectionElement&&(this._selectionElement.remove(),this._selectionElement=null);return}this._selectionElement||(this._selectionElement=document.createElement("div"),this._selectionElement.className="selection-area",e.insertBefore(this._selectionElement,e.firstChild)),this._selectionElement.style.height=e.offsetHeight+"px"}onattach(){this.hovered&&this.listItemElement.classList.add("hovered"),this.updateTitle(),this.editable&&(this.listItemElement.draggable=!0,this.listItemElement.addEventListener("dragstart",this))}onpopulate(){this.children.length||!this._hasVisibleChildren()||this._elementCloseTag||this.updateChildren()}expandRecursively(){this.representedObject.getSubtree(-1,super.expandRecursively.bind(this,Number.MAX_VALUE))}updateChildren(e){this._elementCloseTag||this.representedObject.getChildNodes(this._updateChildren.bind(this,e))}insertChildElement(e,t,i){var n=new WI.DOMTreeElement(e,i);return n.selectable=this.treeOutline.selectable,this.insertChild(n,t),n}moveChild(e,t){if(this.children[t]!==e){var i=this.treeOutline.selectedTreeElement;this.removeChild(e),this.insertChild(e,t),i!==this.treeOutline.selectedTreeElement&&i.select()}}_updateChildren(e){if(!(this._updateChildrenInProgress||!this.treeOutline._visible)){this._closeTagTreeElement=null,this._updateChildrenInProgress=!0;var t=this.representedObject,i=this.treeOutline.selectedDOMNode(),n=0,s=this._hasVisibleChildren();if(e||!s){var a=this.treeOutline.element.parentNode;n=a.scrollTop;var d=this.treeOutline.selectedTreeElement;if(d&&d.hasAncestor(this)&&this.select(),this.removeChildren(),!s){this.hasChildren=!1,this.updateTitle(),this._updateChildrenInProgress=!1;return}}this.hasChildren||(this.hasChildren=!0,this.updateTitle());for(var p=new Map,f=this.children.length-1;f>=0;--f){var _=this.children[f],b=_.representedObject,w=b.parentNode;if(w===t){p.set(b,_);continue}this.removeChildAtIndex(f)}for(var S=null,E=this._visibleChildren(),f=0;f<E.length&&f<this.expandedChildrenLimit;++f){var k=E[f],R=p.get(k);if(R){this.moveChild(R,f);continue}var M=this.insertChildElement(k,f);k===i&&(S=M),this.expandedChildCount>this.expandedChildrenLimit&&this.expandedChildrenLimit++}this.adjustCollapsedRange();var L=this.children.lastValue;t.nodeType()===Node.ELEMENT_NODE&&(!L||!L._elementCloseTag)&&(this._closeTagTreeElement=this.insertChildElement(this.representedObject,this.children.length,!0)),e&&S&&(S.select(),a&&n<=a.scrollHeight&&(a.scrollTop=n)),this._updateChildrenInProgress=!1}}adjustCollapsedRange(){if(this.expandAllButtonElement&&this.expandAllButtonElement.__treeElement.parent&&this.removeChild(this.expandAllButtonElement.__treeElement),!!this._hasVisibleChildren()){for(var e=this._visibleChildren(),t=e.length,i=this.expandedChildCount,n=Math.min(this.expandedChildrenLimit,t);i<n;++i)this.insertChildElement(e[i],i);var s=this.expandedChildCount;if(t>this.expandedChildCount){var a=s;if(this.expandAllButtonElement)this.expandAllButtonElement.__treeElement.parent||this.insertChild(this.expandAllButtonElement.__treeElement,a);else{var d=document.createElement("button");d.className="show-all-nodes",d.value="";var p=new WI.TreeElement(d,null,!1);p.selectable=!1,p.expandAllButton=!0,this.insertChild(p,a),this.expandAllButtonElement=d,this.expandAllButtonElement.__treeElement=p,this.expandAllButtonElement.addEventListener("click",this.handleLoadAllChildren.bind(this),!1)}this.expandAllButtonElement.textContent=WI.UIString("Show All Nodes (%d More)").format(t-s)}else this.expandAllButtonElement&&(this.expandAllButtonElement=null)}}handleLoadAllChildren(){var e=this._visibleChildren();this.expandedChildrenLimit=Math.max(e.length,this.expandedChildrenLimit+WI.DOMTreeElement.InitialChildrenLimit)}onexpand(){if(!this._elementCloseTag&&!!this.listItemElement){this.updateTitle();for(let e of this.children)e.updateSelectionArea()}}oncollapse(){this._elementCloseTag||this.updateTitle()}onreveal(){let e=this.listItemElement;if(!e)return;let t=e.getElementsByClassName("html-tag-name");t.length?t[0].scrollIntoViewIfNeeded(!1):e.scrollIntoViewIfNeeded(!1),this._shouldHighlightAfterReveal&&(this._shouldHighlightAfterReveal=!1,this._animatingHighlight=!0,this.updateSelectionArea(),e.addEventListener("animationend",this._boundHighlightAnimationEnd),e.classList.add(WI.DOMTreeElement.HighlightStyleClassName))}onenter(){return!this.editable||this.treeOutline.editing?!1:(this._startEditing(),!0)}canSelectOnMouseDown(e){return this._editing?!1:e.detail>=2?(e.preventDefault(),!1):!0}ondblclick(e){if(!this.editable)return!1;this._editing||this._elementCloseTag||this._startEditingTarget(e.target)||this.hasChildren&&!this.expanded&&this.expand()}_insertInLastAttributePosition(e,t){if(e.getElementsByClassName("html-attribute").length>0)e.insertBefore(t,e.lastChild);else{var i=e.textContent.match(/^<(.*?)>$/)[1];e.textContent="",e.append("<"+i,t,">")}this.updateSelectionArea()}_startEditingTarget(e){if(this.treeOutline.selectedDOMNode()!==this.representedObject||this.representedObject.isShadowRoot()||this.representedObject.isInUserAgentShadowTree()||this.representedObject.isPseudoElement()||this.representedObject.nodeType()!==Node.ELEMENT_NODE&&this.representedObject.nodeType()!==Node.TEXT_NODE)return!1;var t=e.closest(".html-text-node");if(t)return this._startEditingTextNode(t);var i=e.closest(".html-attribute");if(i)return this._startEditingAttribute(i,e);var n=e.closest(".html-tag-name");return n?this._startEditingTagName(n):!1}populateDOMNodeContextMenu(e,t,i){let n=i.target.closest(".html-attribute"),s=i.target.closest(".html-text-node"),a=null;if(n){let _=n.getElementsByClassName("html-attribute-name")[0];_&&(a=_.textContent.trim())}i.target&&i.target.tagName==="A"&&WI.appendContextMenuItemsForURL(e,i.target.href,{frame:this.representedObject.frame}),e.appendSeparator();let d=this.representedObject.nodeType()===Node.ELEMENT_NODE&&this.editable,p=!this.representedObject.isInUserAgentShadowTree()&&d,f=this._htmlEditElement&&WI.isBeingEdited(this._htmlEditElement);if(d&&(Fu.ForbiddenClosingTagElements.has(this.representedObject.nodeNameInCorrectCase())||t.add.appendItem(WI.UIString("Child","A submenu item of 'Add' to append DOM nodes to the selected DOM node"),()=>{this._addHTML()},f),t.add.appendItem(WI.UIString("Previous Sibling","A submenu item of 'Add' to add DOM nodes before the selected DOM node"),()=>{this._addPreviousSibling()},f),t.add.appendItem(WI.UIString("Next Sibling","A submenu item of 'Add' to add DOM nodes after the selected DOM node"),()=>{this._addNextSibling()},f)),p&&t.add.appendItem(WI.UIString("Attribute"),()=>{this._addNewAttribute()}),this.editable&&t.edit.appendItem(WI.UIString("HTML"),()=>{this._editAsHTML()},f),p&&(a&&t.edit.appendItem(WI.UIString("Attribute"),()=>{this._startEditingAttribute(n,i.target)},WI.isBeingEdited(n)),!Fu.EditTagBlacklist.has(this.representedObject.nodeNameInCorrectCase()))){let _=i.target.closest(".html-tag-name");t.edit.appendItem(WI.UIString("Tag","A submenu item of 'Edit' to change DOM element's tag name"),()=>{this._startEditingTagName(_)},WI.isBeingEdited(_))}s&&this.editable&&t.edit.appendItem(WI.UIString("Text"),()=>{this._startEditingTextNode(s)},WI.isBeingEdited(s)),this.representedObject.isPseudoElement()||t.copy.appendItem(WI.UIString("HTML"),()=>{this._copyHTML()}),a&&p&&t.copy.appendItem(WI.UIString("Attribute"),()=>{let _=a,b=this.representedObject.getAttribute(a);b&&(_+='="'+b.replace(/"/g,'\\"')+'"'),InspectorFrontendHost.copyText(_)}),s&&s.textContent.length&&t.copy.appendItem(WI.UIString("Text"),()=>{InspectorFrontendHost.copyText(s.textContent)}),this.editable&&(!this.selected||this.treeOutline.selectedTreeElements.length===1)&&t.delete.appendItem(WI.UIString("Node"),()=>{this.remove()}),a&&p&&t.delete.appendItem(WI.UIString("Attribute"),()=>{this.representedObject.removeAttribute(a)});for(let _ of Object.values(t))e.pushItem(_);if(this.selected&&this.treeOutline&&this.treeOutline.selectedTreeElements.length>1){let _=!this.treeOutline.selectedTreeElements.every(w=>w.isNodeHidden),b=_?WI.UIString("Hide Elements"):WI.UIString("Show Elements");e.appendItem(b,()=>{this.treeOutline.toggleSelectedElementsVisibility(_)})}else e.appendItem(WI.UIString("Toggle Visibility"),()=>{this.toggleElementVisibility()})}_startEditing(){if(this.treeOutline.selectedDOMNode()!==this.representedObject||!this.editable)return!1;var e=this.listItemElement;if(this._canAddAttributes){var t=e.getElementsByClassName("html-attribute")[0];return t?this._startEditingAttribute(t,t.getElementsByClassName("html-attribute-value")[0]):this._addNewAttribute()}if(this.representedObject.nodeType()===Node.TEXT_NODE){var i=e.getElementsByClassName("html-text-node")[0];return i?this._startEditingTextNode(i):!1}}_addNewAttribute(){var e=document.createElement("span");this._buildAttributeDOM(e," ","");var t=e.firstChild;t.style.marginLeft="2px",t.style.marginRight="2px";var i=this.listItemElement.getElementsByClassName("html-tag")[0];return this._insertInLastAttributePosition(i,t),this._startEditingAttribute(t,t)}_triggerEditAttribute(e){for(var t=this.listItemElement.getElementsByClassName("html-attribute-name"),i=0,n=t.length;i<n;++i)if(t[i].textContent===e){for(var s=t[i].nextSibling;s;s=s.nextSibling)if(s.nodeType===Node.ELEMENT_NODE&&s.classList.contains("html-attribute-value"))return this._startEditingAttribute(s.parentNode,s)}}_startEditingAttribute(e,t){if(WI.isBeingEdited(e))return!0;var i=e.getElementsByClassName("html-attribute-name")[0];if(!i)return!1;var n=i.textContent;function s(d){if(d.nodeType===Node.TEXT_NODE){d.nodeValue=d.nodeValue.replace(/\u200B/g,"");return}if(d.nodeType===Node.ELEMENT_NODE)for(var p=d.firstChild;p;p=p.nextSibling)s(p)}s(e);var a=new WI.EditingConfig(this._attributeEditingCommitted.bind(this),this._editingCancelled.bind(this),n);return a.setNumberCommitHandler(this._attributeNumberEditingCommitted.bind(this)),this._editing=WI.startEditing(e,a),window.getSelection().setBaseAndExtent(t,0,t,1),!0}_startEditingTextNode(e){if(WI.isBeingEdited(e))return!0;var t=new WI.EditingConfig(this._textNodeEditingCommitted.bind(this),this._editingCancelled.bind(this));return t.spellcheck=!0,this._editing=WI.startEditing(e,t),window.getSelection().setBaseAndExtent(e,0,e,1),!0}_startEditingTagName(e){if(!e&&(e=this.listItemElement.getElementsByClassName("html-tag-name")[0],!e))return!1;var t=e.textContent;if(WI.DOMTreeElement.EditTagBlacklist.has(t.toLowerCase()))return!1;if(WI.isBeingEdited(e))return!0;let i=this._distinctClosingTagElement(),n=i?i.textContent:"";function s(f){i&&(i.textContent="</"+e.textContent+">")}function a(f,_){e.removeEventListener("keyup",s,!1),this._tagNameEditingCommitted.apply(this,arguments)}function d(){i&&(i.textContent=n),e.removeEventListener("keyup",s,!1),this._editingCancelled.apply(this,arguments)}e.addEventListener("keyup",s,!1);var p=new WI.EditingConfig(a.bind(this),d.bind(this),t);return this._editing=WI.startEditing(e,p),window.getSelection().setBaseAndExtent(e,0,e,1),!0}_startEditingAsHTML(e,t={}){if(this._htmlEditElement&&WI.isBeingEdited(this._htmlEditElement))return;if(t.hideExistingElements){let d=this.listItemElement.firstChild;for(;d;)d.style.display="none",d=d.nextSibling;this._childrenListNode&&(this._childrenListNode.style.display="none")}let i=t.position==="afterbegin"||t.position==="beforeend";if(i&&this._childrenListNode){this._htmlEditElement=document.createElement("li");let d=t.position==="afterbegin"?this._childrenListNode.firstElementChild:this._childrenListNode.lastElementChild;this._childrenListNode.insertBefore(this._htmlEditElement,d)}else t.position&&!i?(this._htmlEditElement=document.createElement("li"),(t.position==="afterend"&&this._childrenListNode?this._childrenListNode:this.listItemElement).insertAdjacentElement(t.position,this._htmlEditElement)):(this._htmlEditElement=document.createElement("div"),this.listItemElement.appendChild(this._htmlEditElement));t.initialValue&&(this._htmlEditElement.textContent=t.initialValue),this.updateSelectionArea();function n(){e(this._htmlEditElement.textContent),s.call(this)}function s(){if(this._editing=!1,this._htmlEditElement.remove(),this._htmlEditElement=null,t.hideExistingElements){this._childrenListNode&&this._childrenListNode.style.removeProperty("display");let d=this.listItemElement.firstChild;for(;d;)d.style.removeProperty("display"),d=d.nextSibling}this.updateSelectionArea()}var a=new WI.EditingConfig(n.bind(this),s.bind(this));if(a.setMultiline(!0),this._editing=WI.startEditing(this._htmlEditElement,a),t.initialValue&&!isNaN(t.startPosition)){let d=document.createRange();d.setStart(this._htmlEditElement.firstChild,t.startPosition),d.collapse(!0);let p=window.getSelection();p.removeAllRanges(),p.addRange(d)}}_attributeEditingCommitted(e,t,i,n,s){if(this._editing=!1,t.trim()||e.remove(),!s&&t===i)return;const a=/\xA0/g;t=t.replace(a," ");var d=this.treeOutline;function p(f){if(f&&this._editingCancelled(e,n),!!s){d._updateModifiedNodes();for(var _=this.representedObject.attributes(),b=0;b<_.length;++b)if(_[b].name===n){s==="backward"?b===0?this._startEditingTagName():this._triggerEditAttribute(_[b-1].name):b===_.length-1?this._addNewAttribute():this._triggerEditAttribute(_[b+1].name);return}s==="backward"?t===" "?_.length&&this._triggerEditAttribute(_.lastValue.name):_.length>1&&this._triggerEditAttribute(_[_.length-2].name):s==="forward"&&(/^\s*$/.test(t)?this._startEditingTagName():this._addNewAttribute())}}this.representedObject.setAttribute(n,t,p.bind(this))}_attributeNumberEditingCommitted(e,t,i,n,s){t!==i&&this.representedObject.setAttribute(n,t)}_tagNameEditingCommitted(e,t,i,n,s){this._editing=!1;var a=this;function d(){var w=a._distinctClosingTagElement();w&&(w.textContent="</"+n+">"),a._editingCancelled(e,n),p.call(a)}function p(){if(s!=="forward"){this._addNewAttribute();return}var w=this.representedObject.attributes();w.length>0?this._triggerEditAttribute(w[0].name):this._addNewAttribute()}if(t=t.trim(),t===i){d();return}var f=this.treeOutline,_=this.expanded;function b(w,S){if(w||!S){d();return}var E=WI.domManager.nodeForId(S);f._updateModifiedNodes(),f.selectDOMNode(E,!0);var k=f.findTreeElement(E);_&&k.expand(),p.call(k)}this.representedObject.setNodeName(t,b)}_textNodeEditingCommitted(e,t){this._editing=!1;var i;this.representedObject.nodeType()===Node.ELEMENT_NODE?i=this.representedObject.firstChild:this.representedObject.nodeType()===Node.TEXT_NODE&&(i=this.representedObject),i.setNodeValue(t,this.updateTitle.bind(this))}_editingCancelled(e,t){this._editing=!1,this.updateTitle()}_distinctClosingTagElement(){if(this.expanded){var e=this._childrenListNode.querySelectorAll(".close");return e[e.length-1]}var t=this.listItemElement.getElementsByClassName("html-tag");return t.length===1?null:t[t.length-1]}updateTitle(e){this._editing&&!this._forceUpdateTitle||(e?this._highlightResult&&this._updateSearchHighlight(!1):(this.title=document.createElement("span"),this.title.appendChild(this._nodeTitleInfo().titleDOM),this._highlightResult=void 0),this._selectionElement=null,this.updateSelectionArea(),this._highlightSearchResults(),this._updatePseudoClassIndicator(),this._updateBreakpointStatus())}_buildAttributeDOM(e,t,i,n){let s=i.length>0,a=e.createChild("span","html-attribute"),d=a.createChild("span","html-attribute-name");d.textContent=t;let p=null;if(s&&a.append('=\u200B"'),t==="src"||/\bhref\b/.test(t)){let f=n.frame?n.frame.url:null,_=absoluteURL(i,f);i=i.insertWordBreakCharacters(),_?(i.startsWith("data:")&&(i=i.truncateMiddle(60)),p=document.createElement("a"),p.href=_,p.textContent=i,a.appendChild(p)):(p=a.createChild("span","html-attribute-value"),p.textContent=i)}else if(t==="srcset"){let f=n.frame?n.frame.url:null;p=a.createChild("span","html-attribute-value");let _=i.split(/\s*,\s*/);for(let b=0;b<_.length;++b){let w=_[b].trim(),S=w.search(/\s/);if(S===-1){let E=w,k=absoluteURL(w,f),R=p.appendChild(document.createElement("a"));R.href=k,R.textContent=E.insertWordBreakCharacters()}else{let E=w.substring(0,S),k=w.substring(S).insertWordBreakCharacters(),R=absoluteURL(E,f),M=p.appendChild(document.createElement("a"));M.href=R,M.textContent=E.insertWordBreakCharacters();let L=p.appendChild(document.createElement("span"));L.textContent=k}if(b<_.length-1){let E=p.appendChild(document.createElement("span"));E.textContent=", "}}}else i=i.insertWordBreakCharacters(),p=a.createChild("span","html-attribute-value"),p.textContent=i;s&&a.append('"'),this._createModifiedAnimation(t,i,s?p:d),this._highlightedAttributes.has(t)&&a.classList.add("highlight")}_buildTagDOM({parentElement:e,tagName:t,isClosingTag:i,isDistinctTreeElement:n,willRenderCloseTagInline:s}){var a=this.representedObject,d=["html-tag"];i&&n&&d.push("close");var p=e.createChild("span",d.join(" "));p.append("<");var f=p.createChild("span",i?"":"html-tag-name");if(f.textContent=(i?"/":"")+t,!i&&a.hasAttributes())for(var _=a.attributes(),b=0;b<_.length;++b){var w=_[b];p.append(" "),this._buildAttributeDOM(p,w.name,w.value,a)}if(p.append(">"),e.append("\u200B"),this._showGoToArrow&&a.nodeType()===Node.ELEMENT_NODE&&s===i){let S=e.appendChild(WI.createGoToArrowButton());S.title=WI.UIString("Reveal in Elements Tab"),S.addEventListener("click",E=>{WI.domManager.inspectElement(this.representedObject.id)})}}_nodeTitleInfo(){var e=this.representedObject,t={titleDOM:document.createDocumentFragment(),hasChildren:this.hasChildren};function i(){return e.nodeValue().replace(/^[\n\r]*/,"").replace(/\s*$/,"")}switch(e.nodeType()){case Node.DOCUMENT_FRAGMENT_NODE:var n=t.titleDOM.createChild("span","html-fragment");e.shadowRootType()?(n.textContent=WI.UIString("Shadow Content (%s)").format(WI.DOMTreeElement.shadowRootTypeDisplayName(e.shadowRootType())),this.listItemElement.classList.add("shadow")):e.parentNode&&e.parentNode.templateContent()===e?(n.textContent=WI.UIString("Template Content"),this.listItemElement.classList.add("template")):(n.textContent=WI.UIString("Document Fragment"),this.listItemElement.classList.add("fragment"));break;case Node.ATTRIBUTE_NODE:var s=e.value||"\u200B";this._buildAttributeDOM(t.titleDOM,e.name,s);break;case Node.ELEMENT_NODE:if(e.isPseudoElement()){var a=t.titleDOM.createChild("span","html-pseudo-element");a.textContent="::"+e.pseudoType(),t.titleDOM.appendChild(document.createTextNode("\u200B")),t.hasChildren=!1;break}var d=e.nodeNameInCorrectCase();if(this._elementCloseTag){this._buildTagDOM({parentElement:t.titleDOM,tagName:d,isClosingTag:!0,isDistinctTreeElement:!0,willRenderCloseTagInline:!1}),t.hasChildren=!1;break}var p=this._singleTextChild(e),f=p&&p.nodeValue().length<WI.DOMTreeElement.MaximumInlineTextChildLength,_=!this.expanded&&!f&&(this.treeOutline.isXMLMimeType||!WI.DOMTreeElement.ForbiddenClosingTagElements.has(d));if(this._buildTagDOM({parentElement:t.titleDOM,tagName:d,isClosingTag:!1,isDistinctTreeElement:!1,willRenderCloseTagInline:f||_}),_){if(this.hasChildren){var b=t.titleDOM.createChild("span","html-text-node");b.textContent=ellipsis,t.titleDOM.append("\u200B")}this._buildTagDOM({parentElement:t.titleDOM,tagName:d,isClosingTag:!0,isDistinctTreeElement:!1,willRenderCloseTagInline:!0})}if(f){var b=t.titleDOM.createChild("span","html-text-node"),w=e.nodeName().toLowerCase();w==="script"?b.appendChild(WI.syntaxHighlightStringAsDocumentFragment(p.nodeValue().trim(),"text/javascript")):w==="style"?b.appendChild(WI.syntaxHighlightStringAsDocumentFragment(p.nodeValue().trim(),"text/css")):b.textContent=p.nodeValue(),t.titleDOM.append("\u200B"),this._buildTagDOM({parentElement:t.titleDOM,tagName:d,isClosingTag:!0,isDistinctTreeElement:!1,willRenderCloseTagInline:!0}),t.hasChildren=!1}break;case Node.TEXT_NODE:if(e.parentNode&&e.parentNode.nodeName().toLowerCase()==="script"){var S=t.titleDOM.createChild("span","html-text-node large");S.appendChild(WI.syntaxHighlightStringAsDocumentFragment(i(),"text/javascript"))}else if(e.parentNode&&e.parentNode.nodeName().toLowerCase()==="style"){var S=t.titleDOM.createChild("span","html-text-node large");S.appendChild(WI.syntaxHighlightStringAsDocumentFragment(i(),"text/css"))}else{t.titleDOM.append('"');var b=t.titleDOM.createChild("span","html-text-node");b.textContent=e.nodeValue(),t.titleDOM.append('"')}break;case Node.COMMENT_NODE:var E=t.titleDOM.createChild("span","html-comment");E.append("<!--"+e.nodeValue()+"-->");break;case Node.DOCUMENT_TYPE_NODE:var k=t.titleDOM.createChild("span","html-doctype");k.append("<!DOCTYPE "+e.nodeName()),e.publicId?(k.append(' PUBLIC "'+e.publicId+'"'),e.systemId&&k.append(' "'+e.systemId+'"')):e.systemId&&k.append(' SYSTEM "'+e.systemId+'"'),k.append(">");break;case Node.CDATA_SECTION_NODE:var R=t.titleDOM.createChild("span","html-text-node");R.append("<![CDATA["+e.nodeValue()+"]]>");break;case Node.PROCESSING_INSTRUCTION_NODE:var M=t.titleDOM.createChild("span","html-processing-instruction"),L=e.nodeValue(),V=L.length?" "+L:"",H="<?"+e.nodeNameInCorrectCase()+V+"?>";M.append(H);break;default:t.titleDOM.append(e.nodeNameInCorrectCase().collapseWhitespace())}return t}_singleTextChild(e){if(!e||this._ignoreSingleTextChild)return null;var t=e.firstChild;if(!t||t.nodeType()!==Node.TEXT_NODE||e.hasShadowRoots()||e.templateContent()||e.hasPseudoElements())return null;var i=t.nextSibling;return i?null:t}_showInlineText(e){if(e.nodeType()===Node.ELEMENT_NODE){var t=this._singleTextChild(e);if(t&&t.nodeValue().length<WI.DOMTreeElement.MaximumInlineTextChildLength)return!0}return!1}_hasVisibleChildren(){var e=this.representedObject;return this._showInlineText(e)?!1:!!(e.hasChildNodes()||e.templateContent()||e.hasPseudoElements())}_visibleChildren(){var e=this.representedObject,t=[],i=e.templateContent();i&&t.push(i);var n=e.beforePseudoElement();n&&t.push(n),e.childNodeCount&&e.children&&(t=t.concat(e.children));var s=e.afterPseudoElement();return s&&t.push(s),t}remove(){var e=this.parent;if(!e)return;var t=this;function i(n,s){n||!t.parent||(e.removeChild(t),e.adjustCollapsedRange())}this.representedObject.removeNode(i)}_insertAdjacentHTML(e,t={}){let i=this.hasChildren,n=s=>{if(this._ignoreSingleTextChild=!1,!s.length){i||(this._forceUpdateTitle=!0,this.hasChildren=!1,this._forceUpdateTitle=!1);return}this.representedObject.insertAdjacentHTML(e,s)};(e==="afterbegin"||e==="beforeend")&&(this._ignoreSingleTextChild=!0,this.hasChildren=!0,this.expand()),this._startEditingAsHTML(n,{...t,position:e})}_addHTML(e){let t={};switch(this.representedObject.nodeNameInCorrectCase()){case"ul":case"ol":t.initialValue="<li></li>",t.startPosition=4;break;case"table":case"thead":case"tbody":case"tfoot":t.initialValue="<tr></tr>",t.startPosition=4;break;case"tr":t.initializing="<td></td>",t.startPosition=4;break}this._insertAdjacentHTML("beforeend",t)}_addPreviousSibling(e){let t={},i=this.representedObject.nodeNameInCorrectCase();(i==="li"||i==="tr"||i==="th"||i==="td")&&(t.initialValue=`<${i}></${i}>`,t.startPosition=i.length+2),this._insertAdjacentHTML("beforebegin",t)}_addNextSibling(e){let t={},i=this.representedObject.nodeNameInCorrectCase();(i==="li"||i==="tr"||i==="th"||i==="td")&&(t.initialValue=`<${i}></${i}>`,t.startPosition=i.length+2),this._insertAdjacentHTML("afterend",t)}_editAsHTML(){var e=this.treeOutline,t=this.representedObject,i=t.parentNode,n=t.index,s=this.expanded;function a(p,f){if(!p){e._updateModifiedNodes();var _=i?i.children[n]||i:null;if(!!_&&(e.selectDOMNode(_,!0),s)){var b=e.findTreeElement(_);b&&b.expand()}}}function d(p){t.setOuterHTML(p,a)}t.getOuterHTML((p,f)=>{p||this._startEditingAsHTML(d,{initialValue:f,hideExistingElements:!0})})}_copyHTML(){this.representedObject.copyNode()}_highlightSearchResults(){if(!this.title||!this._searchQuery||!this._searchHighlightsVisible)return;if(this._highlightResult){this._updateSearchHighlight(!0);return}var e=this.title.textContent;let t=WI.SearchUtilities.regExpForString(this._searchQuery,WI.SearchUtilities.defaultSettings);for(var i=t.exec(e),n=[];i;)n.push({offset:i.index,length:i[0].length}),i=t.exec(e);n.length||n.push({offset:0,length:e.length}),this._highlightResult=[],WI.highlightRangesWithStyleClass(this.title,n,WI.DOMTreeElement.SearchHighlightStyleClassName,this._highlightResult)}_createModifiedAnimation(e,t,i){let n=this._recentlyModifiedAttributes.get(e);!n||(n.element&&(n.listener&&n.element.removeEventListener("animationend",n.listener),n.element.classList.remove("node-state-changed"),n.element.style.removeProperty("animation-delay")),n.listener=s=>{i.classList.remove("node-state-changed"),i.style.removeProperty("animation-delay"),this._recentlyModifiedAttributes.delete(e)},i.classList.remove("node-state-changed"),i.style.removeProperty("animation-delay"),n.value===t?i.style.setProperty("animation-delay","-"+(performance.now()-n.timestamp)+"ms"):n.timestamp=performance.now(),n.value=t,n.element=i,i.addEventListener("animationend",n.listener,{once:!0}),i.classList.add("node-state-changed"))}get isNodeHidden(){let e=this.representedObject.getAttribute("class");return e&&e.includes(WI.DOMTreeElement.HideElementStyleSheetIdOrClassName)}_updatePseudoClassIndicator(){!this.listItemElement||this._elementCloseTag||(this.representedObject.enabledPseudoClasses.length?(this._pseudoClassIndicatorElement||(this._pseudoClassIndicatorElement=document.createElement("div"),this._pseudoClassIndicatorElement.classList.add("pseudo-class-indicator")),this.listItemElement.insertBefore(this._pseudoClassIndicatorElement,this.listItemElement.firstChild)):this._pseudoClassIndicatorElement&&(this._pseudoClassIndicatorElement.remove(),this._pseudoClassIndicatorElement=null))}handleEvent(e){e.type==="dragstart"&&this._editing&&e.preventDefault()}_subtreeBreakpointChanged(e){e.hasBreakpoint?(this._subtreeBreakpointTreeElements||(this._subtreeBreakpointTreeElements=new Set),this._subtreeBreakpointTreeElements.add(e)):(this._subtreeBreakpointTreeElements.delete(e),this._subtreeBreakpointTreeElements.size||(this._subtreeBreakpointTreeElements=null)),this._updateBreakpointStatus()}_updateBreakpointStatus(){if(!this.listItemElement)return;let t=this._breakpointStatus!==WI.DOMTreeElement.BreakpointStatus.None,i=this._subtreeBreakpointTreeElements&&this._subtreeBreakpointTreeElements.size;if(!t&&!i){this._statusImageElement&&this._statusImageElement.remove();return}this._statusImageElement||(this._statusImageElement=WI.ImageUtilities.useSVGSymbol("data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 13'%3e %3cpath d='M 8.5 11 L 1.5 11 L 1.5 2 L 8.5 2 L 13.5 6.5 Z'/%3e %3c/svg%3e","status-image"),this._statusImageElement.classList.add("breakpoint"),this._statusImageElement.addEventListener("click",this._statusImageClicked.bind(this)),this._statusImageElement.addEventListener("contextmenu",this._statusImageContextmenu.bind(this)),this._statusImageElement.addEventListener("mousedown",s=>{s.stopPropagation()})),this._statusImageElement.classList.toggle("subtree",!t&&i),this.listItemElement.insertBefore(this._statusImageElement,this.listItemElement.firstChild);let n=this._breakpointStatus===WI.DOMTreeElement.BreakpointStatus.DisabledBreakpoint;this._statusImageElement.classList.toggle("disabled",n)}_statusImageClicked(e){if(this._breakpointStatus===WI.DOMTreeElement.BreakpointStatus.None||e.button!==0||e.ctrlKey)return;let t=WI.domDebuggerManager.domBreakpointsForNode(this.representedObject);if(!t||!t.length)return;let i=t.some(n=>n.disabled);t.forEach(n=>n.disabled=!i)}_statusImageContextmenu(e){if(!this.hasBreakpoint)return;let t=WI.ContextMenu.createFromEvent(e);WI.appendContextMenuItemsForDOMNodeBreakpoints(t,this.representedObject,{revealDescendantBreakpointsMenuItemHandler:this.bindRevealDescendantBreakpointsMenuItemHandler()})}_highlightAnimationEnd(){let e=this.listItemElement;!e||(e.removeEventListener("animationend",this._boundHighlightAnimationEnd),e.classList.remove(WI.DOMTreeElement.HighlightStyleClassName),this._animatingHighlight=!1)}};WI.DOMTreeElement.InitialChildrenLimit=500;WI.DOMTreeElement.MaximumInlineTextChildLength=80;WI.DOMTreeElement.ForbiddenClosingTagElements=new Set(["area","base","basefont","br","canvas","col","command","embed","frame","hr","img","input","keygen","link","meta","param","source","wbr","track","menuitem"]);WI.DOMTreeElement.EditTagBlacklist=new Set(["html","head","body"]);WI.DOMTreeElement.BreakpointStatus={None:Symbol("none"),Breakpoint:Symbol("breakpoint"),DisabledBreakpoint:Symbol("disabled-breakpoint")};WI.DOMTreeElement.HighlightStyleClassName="highlight";WI.DOMTreeElement.SearchHighlightStyleClassName="search-highlight";WI.DOMTreeElement.BouncyHighlightStyleClassName="bouncy-highlight";WI.DOMTreeElement.HideElementStyleSheetIdOrClassName="__WebInspectorHideElement__";WI.DOMTreeElementPathComponent=class extends WI.HierarchicalPathComponent{constructor(e,t){var i=e.representedObject,n=null,s=null;switch(i.nodeType()){case Node.ELEMENT_NODE:i.isPseudoElement()?(s=WI.DOMTreeElementPathComponent.DOMPseudoElementIconStyleClassName,n="::"+i.pseudoType()):(s=WI.DOMTreeElementPathComponent.DOMElementIconStyleClassName,n=i.displayName);break;case Node.TEXT_NODE:s=WI.DOMTreeElementPathComponent.DOMTextNodeIconStyleClassName,n='"'+i.nodeValue().truncateEnd(32)+'"';break;case Node.COMMENT_NODE:s=WI.DOMTreeElementPathComponent.DOMCommentIconStyleClassName,n="<!--"+i.nodeValue().truncateEnd(32)+"-->";break;case Node.DOCUMENT_TYPE_NODE:s=WI.DOMTreeElementPathComponent.DOMDocumentTypeIconStyleClassName,n="<!DOCTYPE>";break;case Node.DOCUMENT_NODE:s=WI.DOMTreeElementPathComponent.DOMDocumentIconStyleClassName,n=i.nodeNameInCorrectCase();break;case Node.CDATA_SECTION_NODE:s=WI.DOMTreeElementPathComponent.DOMCharacterDataIconStyleClassName,n="<![CDATA["+i.truncateEnd(32)+"]]>";break;case Node.DOCUMENT_FRAGMENT_NODE:s=WI.DOMTreeElementPathComponent.DOMDocumentTypeIconStyleClassName,i.shadowRootType()?n=WI.UIString("Shadow Content"):n=i.displayName;break;case Node.PROCESSING_INSTRUCTION_NODE:s=WI.DOMTreeElementPathComponent.DOMDocumentTypeIconStyleClassName,n=i.nodeNameInCorrectCase();break;default:console.error("Unknown DOM node type: ",i.nodeType()),s=WI.DOMTreeElementPathComponent.DOMNodeIconStyleClassName,n=i.nodeNameInCorrectCase()}super(n,s,t||e.representedObject),this._domTreeElement=e}get domTreeElement(){return this._domTreeElement}get previousSibling(){return this._domTreeElement.previousSibling?new WI.DOMTreeElementPathComponent(this._domTreeElement.previousSibling):null}get nextSibling(){return!this._domTreeElement.nextSibling||this._domTreeElement.nextSibling.isCloseTag()?null:new WI.DOMTreeElementPathComponent(this._domTreeElement.nextSibling)}mouseOver(){var e=this._domTreeElement.representedObject.id;WI.domManager.highlightDOMNode(e)}mouseOut(){WI.domManager.hideDOMNodeHighlight()}};WI.DOMTreeElementPathComponent.DOMElementIconStyleClassName="dom-element-icon";WI.DOMTreeElementPathComponent.DOMPseudoElementIconStyleClassName="dom-pseudo-element-icon";WI.DOMTreeElementPathComponent.DOMTextNodeIconStyleClassName="dom-text-node-icon";WI.DOMTreeElementPathComponent.DOMCommentIconStyleClassName="dom-comment-icon";WI.DOMTreeElementPathComponent.DOMDocumentTypeIconStyleClassName="dom-document-type-icon";WI.DOMTreeElementPathComponent.DOMDocumentIconStyleClassName="dom-document-icon";WI.DOMTreeElementPathComponent.DOMCharacterDataIconStyleClassName="dom-character-data-icon";WI.DOMTreeElementPathComponent.DOMNodeIconStyleClassName="dom-node-icon";WI.DOMTreeOutline=class gp extends WI.TreeOutline{constructor({selectable:e,omitRootDOMNode:t,excludeRevealElementContextMenu:i,showLastSelected:n}={}){super(e),this.element.addEventListener("mousedown",this._onmousedown.bind(this),!1),this.element.addEventListener("mousemove",this._onmousemove.bind(this),!1),this.element.addEventListener("mouseout",this._onmouseout.bind(this),!1),this.element.addEventListener("dragstart",this._ondragstart.bind(this),!1),this.element.addEventListener("dragover",this._ondragover.bind(this),!1),this.element.addEventListener("dragleave",this._ondragleave.bind(this),!1),this.element.addEventListener("drop",this._ondrop.bind(this),!1),this.element.addEventListener("dragend",this._ondragend.bind(this),!1),this.element.classList.add("dom",WI.SyntaxHighlightedStyleClassName),n&&this.element.classList.add("show-last-selected"),this._includeRootDOMNode=!t,this._excludeRevealElementContextMenu=i,this._rootDOMNode=null,this._selectedDOMNode=null,this._treeElementsToRemove=null,this._editable=!1,this._editing=!1,this._visible=!1,this._hideElementsKeyboardShortcut=new WI.KeyboardShortcut(null,"H",this._hideElements.bind(this),this.element),this._hideElementsKeyboardShortcut.implicitlyPreventsDefault=!1,WI.settings.showShadowDOM.addEventListener(WI.Setting.Event.Changed,this._showShadowDOMSettingChanged,this)}wireToDomAgent(){this._elementsTreeUpdater=new WI.DOMTreeUpdater(this)}close(){WI.settings.showShadowDOM.removeEventListener(null,null,this),this._elementsTreeUpdater&&(this._elementsTreeUpdater.close(),this._elementsTreeUpdater=null)}setVisible(e,t){this._visible=e,this._visible&&(this._updateModifiedNodes(),this._selectedDOMNode&&this._revealAndSelectNode(this._selectedDOMNode,t),this.update())}get rootDOMNode(){return this._rootDOMNode}set rootDOMNode(e){this._rootDOMNode!==e&&(this._rootDOMNode=e,this._isXMLMimeType=e&&e.isXMLNode(),this.update())}get isXMLMimeType(){return this._isXMLMimeType}selectedDOMNode(){return this._selectedDOMNode}selectDOMNode(e,t){if(this._selectedDOMNode===e){this._revealAndSelectNode(e,!t);return}this._selectedDOMNode=e,this._revealAndSelectNode(e,!t),(!e||this._selectedDOMNode===e)&&this._selectedNodeChanged()}get editable(){return this._editable}set editable(e){this._editable=e}get editing(){return this._editing}update(){if(!this.rootDOMNode)return;let e=this.selectedTreeElements;this.removeChildren();var t;if(this._includeRootDOMNode)t=new WI.DOMTreeElement(this.rootDOMNode),t.selectable=this.selectable,this.appendChild(t);else for(var i=this.rootDOMNode.firstChild;i;)t=new WI.DOMTreeElement(i),t.selectable=this.selectable,this.appendChild(t),i=i.nextSibling,t.hasChildren&&!t.expanded&&t.expand();!e.length||(e=e.map(n=>{let s=this.findTreeElement(n.representedObject);return s&&n.isCloseTag()&&(console.assert(s.closeTagTreeElement,"Missing close tag TreeElement.",s),s.closeTagTreeElement&&(s=s.closeTagTreeElement)),s}),e=e.filter(n=>!!n),e.length&&(this.selectTreeElements(e),this.selectedTreeElement&&this.selectedTreeElement.reveal()))}updateSelectionArea(){let e=this.selectedTreeElements;for(let t of e)t.updateSelectionArea()}toggleSelectedElementsVisibility(e){for(let t of this.selectedTreeElements)t.toggleElementVisibility(e)}_selectedNodeChanged(){this.dispatchEventToListeners(WI.DOMTreeOutline.Event.SelectedNodeChanged)}findTreeElement(e){let t=(s,a)=>s.isAncestor(a),i=s=>s.parentNode,n=super.findTreeElement(e,t,i);return!n&&e.nodeType()===Node.TEXT_NODE&&(n=super.findTreeElement(e.parentNode,t,i)),n}createTreeElementFor(e){var t=this.findTreeElement(e);return t||(!e.parentNode||(t=this.createTreeElementFor(e.parentNode),!t)?null:t.showChildNode(e))}set suppressRevealAndSelect(e){this._suppressRevealAndSelect!==e&&(this._suppressRevealAndSelect=e)}populateContextMenu(e,t,i){let n={add:new WI.ContextSubMenuItem(e,WI.UIString("Add")),edit:new WI.ContextSubMenuItem(e,WI.UIString("Edit")),copy:new WI.ContextSubMenuItem(e,WI.UIString("Copy")),delete:new WI.ContextSubMenuItem(e,WI.UIString("Delete"))};i.selected&&this.selectedTreeElements.length>1&&n.delete.appendItem(WI.UIString("Nodes"),()=>{this.ondelete()},!this._editable),i.populateDOMNodeContextMenu&&i.populateDOMNodeContextMenu(e,n,t,n);let s={excludeRevealElement:this._excludeRevealElementContextMenu,copySubMenu:n.copy};i.bindRevealDescendantBreakpointsMenuItemHandler&&(s.revealDescendantBreakpointsMenuItemHandler=i.bindRevealDescendantBreakpointsMenuItemHandler()),WI.appendContextMenuItemsForDOMNode(e,i.representedObject,s),super.populateContextMenu(e,t,i)}adjustCollapsedRange(){}ondelete(){if(!this._editable)return!1;this._treeElementsToRemove=this.selectedTreeElements;for(let n of this._treeElementsToRemove)n.reveal();this._selectionController.removeSelectedItems();let e=new Map;function t(n){let s=e.get(n);if(isNaN(s)){s=0;let a=n;for(;a=a.parent;)s++;e.set(n,s)}return s}this._treeElementsToRemove.sort((n,s)=>t(s)-t(n));let i=new Set;for(let n of this._treeElementsToRemove)i.has(n.representedObject)||(i.add(n.representedObject),n.remove());return this._treeElementsToRemove=null,this.selectedTreeElement&&!this.selectedTreeElement.isCloseTag()&&(console.assert(this.selectedTreeElements.length===1),this.selectedTreeElement.reveal()),!0}selectionControllerPreviousSelectableItem(e,t){let i=this.getCachedTreeElement(t);return console.assert(i,"Missing TreeElement for representedObject.",t),!i||this._treeElementsToRemove&&!i.previousSelectableSibling&&i.nextSelectableSibling?null:super.selectionControllerPreviousSelectableItem(e,t)}canSelectTreeElement(e){if(!super.canSelectTreeElement(e))return!1;let t=!1;if(this._treeElementsToRemove)for(;e&&!t;)t=this._treeElementsToRemove.includes(e),e=e.parent;return!t}objectForSelection(e){return e instanceof WI.DOMTreeElement&&e.isCloseTag()?(e.__closeTagProxyObject||(e.__closeTagProxyObject={__proxyObjectTreeElement:e}),e.__closeTagProxyObject):super.objectForSelection(e)}_revealAndSelectNode(e,t){if(!(!e||this._suppressRevealAndSelect)){if(!WI.settings.showShadowDOM.value){for(;e&&e.isInShadowTree();)e=e.parentNode;if(!e)return}var i=this.createTreeElementFor(e);!i||i.revealAndSelect(t)}}_onmousedown(e){let t=this.treeElementFromEvent(e);if(!t||t.isEventWithinDisclosureTriangle(e)){e.preventDefault();return}}_onmousemove(e){let t=this.treeElementFromEvent(e);t&&this._previousHoveredElement===t||(this._previousHoveredElement&&(this._previousHoveredElement.hovered=!1,this._previousHoveredElement=null),t&&(t.hovered=!0,this._previousHoveredElement=t,t.representedObject&&!t.tooltip&&t._createTooltipForNode&&t._createTooltipForNode()),WI.domManager.highlightDOMNode(t?t.representedObject.id:0))}_onmouseout(e){var t=document.elementFromPoint(e.pageX,e.pageY);t&&this.element.contains(t)||(this._previousHoveredElement&&(this._previousHoveredElement.hovered=!1,this._previousHoveredElement=null),WI.domManager.hideDOMNodeHighlight())}_ondragstart(e){let t=this.treeElementFromEvent(e);return!t||(e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setData(gp.DOMNodeIdDragType,t.representedObject.id),!this._isValidDragSourceOrTarget(t))||t.representedObject.nodeName()==="BODY"||t.representedObject.nodeName()==="HEAD"?!1:(e.dataTransfer.setData("text/plain",t.listItemElement.textContent),this._nodeBeingDragged=t.representedObject,WI.domManager.hideDOMNodeHighlight(),!0)}_ondragover(e){if(e.dataTransfer.types.includes(WI.GeneralStyleDetailsSidebarPanel.ToggledClassesDragType))return e.preventDefault(),e.dataTransfer.dropEffect="copy",!1;if(!this._nodeBeingDragged)return!1;let t=this.treeElementFromEvent(e);if(!this._isValidDragSourceOrTarget(t))return!1;let i=t.representedObject;for(;i;){if(i===this._nodeBeingDragged)return!1;i=i.parentNode}return this.dragOverTreeElement=t,t.listItemElement.classList.add("elements-drag-over"),t.updateSelectionArea(),e.preventDefault(),e.dataTransfer.dropEffect="move",!1}_ondragleave(e){return this._clearDragOverTreeElementMarker(),e.preventDefault(),!1}_isValidDragSourceOrTarget(e){if(!e)return!1;var t=e.representedObject;return!(!(t instanceof WI.DOMNode)||!t.parentNode||t.parentNode.nodeType()!==Node.ELEMENT_NODE)}_ondrop(e){e.preventDefault();function t(n,s){if(!n){this._updateModifiedNodes();var a=WI.domManager.nodeForId(s);a&&this.selectDOMNode(a,!0)}}let i=this.treeElementFromEvent(e);if(this._nodeBeingDragged&&i){let n=null,s=null;if(i._elementCloseTag)n=i.representedObject;else{let a=i.representedObject;n=a.parentNode,s=a}this._nodeBeingDragged.moveTo(n,s,t.bind(this))}else{let n=e.dataTransfer.getData(WI.GeneralStyleDetailsSidebarPanel.ToggledClassesDragType);n&&i&&i.representedObject.toggleClass(n,!0)}delete this._nodeBeingDragged}_ondragend(e){e.preventDefault(),this._clearDragOverTreeElementMarker(),delete this._nodeBeingDragged}_clearDragOverTreeElementMarker(){if(this.dragOverTreeElement){let e=this.dragOverTreeElement;this.dragOverTreeElement=null,e.listItemElement.classList.remove("elements-drag-over"),e.updateSelectionArea()}}_updateModifiedNodes(){this._elementsTreeUpdater&&this._elementsTreeUpdater._updateModifiedNodes()}_showShadowDOMSettingChanged(e){for(var t=this.selectedTreeElement?this.selectedTreeElement.representedObject:null;t&&t.isInShadowTree();)t=t.parentNode;this.children.forEach(function(i){i.updateChildren(!0)}),t&&this.selectDOMNode(t)}_hideElements(e,t){if(!this.selectedTreeElement||WI.isEditingAnyField())return;e.preventDefault();let i=!this.selectedTreeElements.every(n=>n.isNodeHidden);this.toggleSelectedElementsVisibility(i)}};WI.DOMTreeOutline.Event={SelectedNodeChanged:"dom-tree-outline-selected-node-changed"};WI.DOMTreeOutline.DOMNodeIdDragType="web-inspector/dom-node-id";WI.DOMTreeUpdater=function(c){WI.domManager.addEventListener(WI.DOMManager.Event.NodeInserted,this._nodeInserted,this),WI.domManager.addEventListener(WI.DOMManager.Event.NodeRemoved,this._nodeRemoved,this),WI.domManager.addEventListener(WI.DOMManager.Event.AttributeModified,this._attributesUpdated,this),WI.domManager.addEventListener(WI.DOMManager.Event.AttributeRemoved,this._attributesUpdated,this),WI.domManager.addEventListener(WI.DOMManager.Event.CharacterDataModified,this._characterDataModified,this),WI.domManager.addEventListener(WI.DOMManager.Event.DocumentUpdated,this._documentUpdated,this),WI.domManager.addEventListener(WI.DOMManager.Event.ChildNodeCountUpdated,this._childNodeCountUpdated,this),this._treeOutline=c,this._recentlyInsertedNodes=new Map,this._recentlyDeletedNodes=new Map,this._recentlyModifiedNodes=new Set,this._recentlyModifiedAttributes=new Map,this._textContentAttributeSymbol=Symbol("text-content-attribute"),this._updateModifiedNodesDebouncer=new Debouncer(()=>{this._updateModifiedNodes()})};WI.DOMTreeUpdater.prototype={close:function(){WI.domManager.removeEventListener(null,null,this)},_documentUpdated:function(c){this._reset()},_attributesUpdated:function(c){let{node:e,name:t}=c.data;this._nodeAttributeModified(e,t)},_characterDataModified:function(c){let{node:e}=c.data;this._nodeAttributeModified(e,this._textContentAttributeSymbol)},_nodeAttributeModified:function(c,e){this._recentlyModifiedAttributes.has(e)||this._recentlyModifiedAttributes.set(e,new Set),this._recentlyModifiedAttributes.get(e).add(c),this._recentlyModifiedNodes.add(c),this._treeOutline._visible&&this._updateModifiedNodesDebouncer.delayForFrame()},_nodeInserted:function(c){this._recentlyInsertedNodes.set(c.data.node,{parent:c.data.parent}),this._treeOutline._visible&&this._updateModifiedNodesDebouncer.delayForFrame()},_nodeRemoved:function(c){this._recentlyDeletedNodes.set(c.data.node,{parent:c.data.parent}),this._treeOutline._visible&&this._updateModifiedNodesDebouncer.delayForFrame()},_childNodeCountUpdated:function(c){var e=this._treeOutline.findTreeElement(c.data);e&&(e.hasChildren=c.data.hasChildNodes())},_updateModifiedNodes:function(){let c=new Set,e=(t,i,n)=>{let s=t.parent,a=this._treeOutline.findTreeElement(s);a&&c.add(a)};this._recentlyInsertedNodes.forEach(e),this._recentlyDeletedNodes.forEach(e);for(let t of c)t.treeOutline&&(t.updateTitle(),t.updateChildren());for(let t of this._recentlyModifiedNodes.values()){let i=this._treeOutline.findTreeElement(t);if(!i)return;for(let[n,s]of this._recentlyModifiedAttributes.entries())n!==this._textContentAttributeSymbol&&s.has(t)&&i.attributeDidChange(n);i.updateTitle()}this._recentlyInsertedNodes.clear(),this._recentlyDeletedNodes.clear(),this._recentlyModifiedNodes.clear(),this._recentlyModifiedAttributes.clear()},_reset:function(){WI.domManager.hideDOMNodeHighlight(),this._recentlyInsertedNodes.clear(),this._recentlyDeletedNodes.clear(),this._recentlyModifiedNodes.clear(),this._recentlyModifiedAttributes.clear()}};WI.DashboardContainerView=class extends WI.Object{constructor(){super(),this._toolbarItem=new WI.NavigationItem("dashboard-container","group",WI.UIString("Activity Viewer")),this._advanceForwardArrowElement=this._toolbarItem.element.appendChild(document.createElement("div")),this._advanceForwardArrowElement.className="advance-arrow advance-forward",this._advanceBackwardArrowElement=this._toolbarItem.element.appendChild(document.createElement("div")),this._advanceBackwardArrowElement.className="advance-arrow advance-backward",this._advanceForwardArrowElement.addEventListener("click",this._advanceForwardArrowClicked.bind(this)),this._advanceBackwardArrowElement.addEventListener("click",this._advanceBackwardArrowClicked.bind(this)),this._dashboardStack=[],this._currentIndex=-1,this._updateAdvanceArrowVisibility()}get toolbarItem(){return this._toolbarItem}get currentDashboardView(){return this._currentIndex===-1?null:this._dashboardStack[this._currentIndex]}showDashboardViewForRepresentedObject(e){var t=this._dashboardViewForRepresentedObject(e);if(!t)return null;if(this.currentDashboardView===t)return t;var i=this._dashboardStack.indexOf(t);return this._showDashboardAtIndex(i),t}hideDashboardViewForRepresentedObject(e){var t=!0,i=this._dashboardViewForRepresentedObject(e,t);this.currentDashboardView===i&&(console.assert(this._currentIndex>0),this._showDashboardAtIndex(this._currentIndex-1))}closeDashboardViewForRepresentedObject(e){var t=!0,i=this._dashboardViewForRepresentedObject(e,t);!i||this._closeDashboardView(i)}_advanceForwardArrowClicked(){this._showDashboardAtIndex(this._currentIndex+1)}_advanceBackwardArrowClicked(){this._showDashboardAtIndex(this._currentIndex-1)}_dismissAdvanceArrows(){this._advanceForwardArrowElement.classList.add(WI.DashboardContainerView.InactiveStyleClassName),this._advanceBackwardArrowElement.classList.add(WI.DashboardContainerView.InactiveStyleClassName)}_updateAdvanceArrowVisibility(){var e=this._currentIndex<this._dashboardStack.length-1,t=this._currentIndex>0;this._advanceForwardArrowElement.classList.toggle(WI.DashboardContainerView.InactiveStyleClassName,!e),this._advanceBackwardArrowElement.classList.toggle(WI.DashboardContainerView.InactiveStyleClassName,!t)}_dashboardViewForRepresentedObject(e,t){console.assert(e);for(var i of this._dashboardStack)if(i.representedObject===e)return i;return t||(i=WI.DashboardView.create(e),console.assert(i,"Unknown representedObject",e),!i)?null:(this._dashboardStack.push(i),this._toolbarItem.element.appendChild(i.element),i)}_showDashboardAtIndex(e){if(console.assert(e>=0&&e<=this._dashboardStack.length-1),this._currentIndex!==e){var t=null;this._currentIndex<e?t=WI.DashboardContainerView.AdvanceDirection.Forward:t=WI.DashboardContainerView.AdvanceDirection.Backward;var i=WI.DashboardContainerView.AdvanceDirection.None,n=this._currentIndex===-1;n||this._hideDashboardView(this.currentDashboardView,t),this._currentIndex=e,this._showDashboardView(this.currentDashboardView,n?i:t)}}_showDashboardView(e,t){console.assert(e instanceof WI.DashboardView),e.shown(),this._dismissAdvanceArrows();var i=null;t===WI.DashboardContainerView.AdvanceDirection.Forward&&(i=WI.DashboardContainerView.ForwardIncomingDashboardStyleClassName),t===WI.DashboardContainerView.AdvanceDirection.Backward&&(i=WI.DashboardContainerView.BackwardIncomingDashboardStyleClassName);var n=this;e.element.classList.add(WI.DashboardContainerView.VisibleDashboardStyleClassName);function s(a){a.target===e.element&&(e.element.removeEventListener("animationend",s),e.element.classList.remove(i),n._updateAdvanceArrowVisibility())}return i&&(e.element.classList.add(i),e.element.addEventListener("animationend",s)),e}_hideDashboardView(e,t,i){console.assert(e instanceof WI.DashboardView),console.assert(this.currentDashboardView===e),e.hidden(),this._dismissAdvanceArrows();var n=null;t===WI.DashboardContainerView.AdvanceDirection.Forward&&(n=WI.DashboardContainerView.ForwardOutgoingDashboardStyleClassName),t===WI.DashboardContainerView.AdvanceDirection.Backward&&(n=WI.DashboardContainerView.BackwardOutgoingDashboardStyleClassName);var s=this;function a(d){d.target===e.element&&(e.element.removeEventListener("animationend",a),e.element.classList.remove(n),e.element.classList.remove(WI.DashboardContainerView.VisibleDashboardStyleClassName),s._updateAdvanceArrowVisibility(),typeof i=="function"&&i())}n?(e.element.classList.add(n),e.element.addEventListener("animationend",a)):e.element.classList.remove(WI.DashboardContainerView.VisibleDashboardStyleClassName)}_closeDashboardView(e){console.assert(e instanceof WI.DashboardView);function t(){e.closed(),e.element.parentNode.removeChild(e.element)}var i=this._dashboardStack.indexOf(e);if(this.currentDashboardView===e){var n=WI.DashboardContainerView.AdvanceDirection.Backward;this._hideDashboardView(this.currentDashboardView,n,t),this._dashboardStack.splice(i,1),--this._currentIndex,this._showDashboardView(this.currentDashboardView,n);return}this._dashboardStack.splice(i,1),this._currentIndex>i&&--this._currentIndex,t.call(this),this._updateAdvanceArrowVisibility()}};WI.DashboardContainerView.VisibleDashboardStyleClassName="visible";WI.DashboardContainerView.InactiveStyleClassName="inactive";WI.DashboardContainerView.AdvanceDirection={Forward:Symbol("dashboard-container-view-advance-direction-forward"),Backward:Symbol("dashboard-container-view-advance-direction-backward"),None:Symbol("dashboard-container-view-advance-direction-none")};WI.DashboardContainerView.ForwardIncomingDashboardStyleClassName="slide-in-down";WI.DashboardContainerView.BackwardIncomingDashboardStyleClassName="slide-in-up";WI.DashboardContainerView.ForwardOutgoingDashboardStyleClassName="slide-out-down";WI.DashboardContainerView.BackwardOutgoingDashboardStyleClassName="slide-out-up";WI.DashboardView=class extends WI.Object{constructor(e,t){console.assert(t),super(),this._representedObject=e,this._element=document.createElement("div"),this._element.classList.add("dashboard"),this._element.classList.add(t)}static create(e){if(console.assert(e),e instanceof WI.DefaultDashboard)return new WI.DefaultDashboardView(e);if(e instanceof WI.DebuggerDashboard)return new WI.DebuggerDashboardView(e);throw"Can't make a DashboardView for an unknown representedObject."}get element(){return this._element}get representedObject(){return this._representedObject}shown(){}hidden(){}closed(){}};WI.DatabaseContentView=class extends WI.ContentView{constructor(e){super(e),this.database=e,this.element.classList.add("storage-view","query","monospace"),this._prompt=new WI.ConsolePrompt(this,"text/x-sql"),this.addSubview(this._prompt),this.element.addEventListener("click",this._messagesClicked.bind(this),!0)}saveToCookie(e){e.type=WI.ContentViewCookieType.Database,e.host=this.representedObject.host,e.name=this.representedObject.name}consolePromptCompletionsNeeded(e,t,i,n,s){let a=[];n=n.toLowerCase();function d(f){for(let _ of f)_.toLowerCase().startsWith(n)&&a.push(_)}function p(f){d(f),d(["SELECT","FROM","WHERE","LIMIT","DELETE FROM","CREATE","DROP","TABLE","INDEX","UPDATE","INSERT INTO","VALUES"]),this._prompt.updateCompletions(a," ")}this.database.getTableNames(p.bind(this))}consolePromptTextCommitted(e,t){this.database.executeSQL(t,this._queryFinished.bind(this,t),this._queryError.bind(this,t))}_messagesClicked(){this._prompt.focus()}_queryFinished(e,t,i){let n=e.trim(),s=new WI.DatabaseUserQuerySuccessView(n,t,i);this.insertSubviewBefore(s,this._prompt),s.dataGrid&&s.dataGrid.autoSizeColumns(5),this._prompt.element.scrollIntoView(!1),(n.match(/^create /i)||n.match(/^drop table /i))&&this.dispatchEventToListeners(WI.DatabaseContentView.Event.SchemaUpdated,this.database)}_queryError(e,t){let i;t.message?i=t.message:t.code===2?i=WI.UIString("Database no longer has expected version."):i=WI.UIString("An unexpected error %s occurred.").format(t.code);let n=new WI.DatabaseUserQueryErrorView(e,i);this.insertSubviewBefore(n,this._prompt),this._prompt.element.scrollIntoView(!1)}};WI.DatabaseContentView.Event={SchemaUpdated:"SchemaUpdated"};WI.DatabaseHostTreeElement=class extends WI.StorageTreeElement{constructor(e){super(WI.FolderTreeElement.FolderIconStyleClassName,WI.displayNameForHost(e),null),this._host=e,this.hasChildren=!0,this.expanded=!0}get name(){return WI.displayNameForHost(this._host)}get categoryName(){return WI.UIString("Databases")}};WI.DatabaseTableContentView=class extends WI.ContentView{constructor(e){super(e),this.element.classList.add("database-table"),this._refreshButtonNavigationItem=new WI.ButtonNavigationItem("database-table-refresh",WI.UIString("Refresh"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='1 1 13 13'%3e %3cpath fill='currentColor' d='M 12.007 8.01 L 12.007 8.488 L 12 8.488 C 12 10.974 9.985 12.988 7.5 12.988 C 5.015 12.988 3 10.974 3 8.488 C 3 6.17 4.759 4.284 7.012 4.037 L 7.012 6.549 L 11.519 3.775 L 7.012 1 L 7.012 3.013 C 4.203 3.26 2 5.615 2 8.488 C 2 11.526 4.462 13.988 7.5 13.988 C 10.509 13.988 12.95 11.571 12.996 8.572 L 13 8.572 L 13 8.01 L 12.007 8.01 Z'/%3e %3c/svg%3e",13,13),this._refreshButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._refreshButtonClicked,this),this._messageTextViewElement=null,this.update()}get navigationItems(){return[this._refreshButtonNavigationItem]}update(){this.representedObject.database.executeSQL('SELECT * FROM "'+this._escapeTableName(this.representedObject.name)+'"',this._queryFinished.bind(this),this._queryError.bind(this))}saveToCookie(e){e.type=WI.ContentViewCookieType.DatabaseTable,e.host=this.representedObject.host,e.name=this.representedObject.name,e.database=this.representedObject.database.name}get scrollableElements(){return this._dataGrid?[this._dataGrid.scrollContainer]:[]}_escapeTableName(e){return e.replace(/"/g,'""')}_queryFinished(e,t){if(this._dataGrid&&(this.removeSubview(this._dataGrid),this._dataGrid=null),this._messageTextViewElement&&this._messageTextViewElement.remove(),e.length){this._dataGrid=WI.DataGrid.createSortableDataGrid(e,t),this.addSubview(this._dataGrid),this._dataGrid.updateLayout();return}this._messageTextViewElement=WI.createMessageTextView(WI.UIString(`The \u201C%s\u201D
table is empty.`).format(this.representedObject.name),!1),this.element.appendChild(this._messageTextViewElement)}_queryError(e){this._dataGrid&&(this.removeSubview(this._dataGrid),this._dataGrid=null),this._messageTextViewElement&&this._messageTextViewElement.remove(),this._messageTextViewElement=WI.createMessageTextView(WI.UIString("An error occurred trying to read the \u201C%s\u201D table.").format(this.representedObject.name),!0),this.element.appendChild(this._messageTextViewElement)}_refreshButtonClicked(){this.update()}};WI.DatabaseTableTreeElement=class extends WI.GeneralTreeElement{constructor(e){console.assert(e instanceof WI.DatabaseTableObject);const t=null;super("database-table-icon",e.name,t,e)}};WI.DatabaseTreeElement=class extends WI.GeneralTreeElement{constructor(e){console.assert(e instanceof WI.DatabaseObject);const t=null;super("database-icon",e.name,t,e,{hasChildren:!0}),this.hasChildren=!1,this.onpopulate()}oncollapse(){this.shouldRefreshChildren=!0}onpopulate(){if(this.children.length&&!this.shouldRefreshChildren)return;this.shouldRefreshChildren=!1,this.removeChildren();function e(t){for(var i=0;i<t.length;++i){var n=new WI.DatabaseTableObject(t[i],this.representedObject);this.appendChild(new WI.DatabaseTableTreeElement(n))}this.hasChildren=t.length}this.representedObject.getTableNames(e.bind(this))}};WI.DebuggerDashboardView=class extends WI.DashboardView{constructor(e){super(e,"debugger"),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.ActiveCallFrameDidChange,this._rebuildLocation,this),this._navigationBar=new WI.NavigationBar,this.element.appendChild(this._navigationBar.element);var t=WI.UIString("Continue script execution (%s or %s)").format(WI.pauseOrResumeKeyboardShortcut.displayName,WI.pauseOrResumeAlternateKeyboardShortcut.displayName);this._debuggerResumeButtonItem=new WI.ActivateButtonNavigationItem("debugger-dashboard-pause",t,t,"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3cpath d='M 6.5 2.5 L 6.5 12.5 L 14.5 7.5 L 6.5 2.5 Z'/%3e %3crect x='0.5' y='2.5' width='3' height='10'/%3e %3c/svg%3e",15,15),this._debuggerResumeButtonItem.activated=!0,this._debuggerResumeButtonItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._resumeButtonClicked,this),this._navigationBar.addNavigationItem(this._debuggerResumeButtonItem);var i=this._messageElement=document.createElement("div");i.classList.add("message"),i.title=i.textContent=WI.UIString("Debugger Paused"),this.element.appendChild(i);var n=document.createElement("div");n.classList.add("divider"),this.element.appendChild(n);var s=this._locationElement=document.createElement("div");s.classList.add("location"),this.element.appendChild(s),this._rebuildLocation()}closed(){WI.debuggerManager.removeEventListener(null,null,this),super.closed()}_rebuildLocation(){if(!WI.debuggerManager.activeCallFrame)return;this._locationElement.removeChildren();var e=WI.debuggerManager.activeCallFrame,t=e.functionName||WI.UIString("(anonymous function)"),i=WI.DebuggerDashboardView.FunctionIconStyleClassName;e.functionName&&e.functionName.startsWith("on")&&e.functionName.length>=5&&(i=WI.DebuggerDashboardView.EventListenerIconStyleClassName);var n=document.createElement("div");n.classList.add(i),this._locationElement.appendChild(n);var s=document.createElement("img");s.className="icon",n.appendChild(s);var a=document.createElement("div");a.append(t),a.classList.add("function-name"),this._locationElement.appendChild(a);const d={dontFloat:!0,ignoreNetworkTab:!0,ignoreSearchTab:!0};let p=WI.createSourceCodeLocationLink(WI.debuggerManager.activeCallFrame.sourceCodeLocation,d);this._locationElement.appendChild(p)}_resumeButtonClicked(){WI.debuggerManager.resume()}};WI.DebuggerDashboardView.FunctionIconStyleClassName=WI.CallFrameView.FunctionIconStyleClassName;WI.DebuggerDashboardView.EventListenerIconStyleClassName=WI.CallFrameView.EventListenerIconStyleClassName;WI.DebuggerSidebarPanel=class Ea extends WI.NavigationSidebarPanel{constructor(){super("debugger",WI.UIString("Debugger"),!0),WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this),WI.Frame.addEventListener(WI.Frame.Event.ResourceWasAdded,this._resourceAdded,this),WI.Target.addEventListener(WI.Target.Event.ResourceAdded,this._resourceAdded,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.BreakpointAdded,this._breakpointAdded,this),WI.domDebuggerManager.addEventListener(WI.DOMDebuggerManager.Event.DOMBreakpointAdded,this._breakpointAdded,this),WI.domDebuggerManager.addEventListener(WI.DOMDebuggerManager.Event.EventBreakpointAdded,this._breakpointAdded,this),WI.domDebuggerManager.addEventListener(WI.DOMDebuggerManager.Event.URLBreakpointAdded,this._breakpointAdded,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.BreakpointRemoved,this._breakpointRemoved,this),WI.domDebuggerManager.addEventListener(WI.DOMDebuggerManager.Event.DOMBreakpointRemoved,this._breakpointRemoved,this),WI.domDebuggerManager.addEventListener(WI.DOMDebuggerManager.Event.EventBreakpointRemoved,this._breakpointRemoved,this),WI.domDebuggerManager.addEventListener(WI.DOMDebuggerManager.Event.URLBreakpointRemoved,this._breakpointRemoved,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.BreakpointsEnabledDidChange,this._breakpointsEnabledDidChange,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.ScriptAdded,this._scriptAdded,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.ScriptRemoved,this._scriptRemoved,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.ScriptsCleared,this._scriptsCleared,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.Paused,this._debuggerDidPause,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.Resumed,this._debuggerDidResume,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.CallFramesDidChange,this._debuggerCallFramesDidChange,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.ActiveCallFrameDidChange,this._debuggerActiveCallFrameDidChange,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.WaitingToPause,this._debuggerWaitingToPause,this),WI.DOMBreakpoint.addEventListener(WI.DOMBreakpoint.Event.DOMNodeChanged,this._handleDOMBreakpointDOMNodeChanged,this),WI.timelineManager.addEventListener(WI.TimelineManager.Event.CapturingStateChanged,this._handleTimelineCapturingStateChanged,this),WI.auditManager.addEventListener(WI.AuditManager.Event.TestScheduled,this._handleAuditManagerTestScheduled,this),WI.auditManager.addEventListener(WI.AuditManager.Event.TestCompleted,this._handleAuditManagerTestCompleted,this),WI.targetManager.addEventListener(WI.TargetManager.Event.TargetAdded,this._targetAdded,this),WI.targetManager.addEventListener(WI.TargetManager.Event.TargetRemoved,this._targetRemoved,this),this._timelineRecordingWarningElement=document.createElement("div"),this._timelineRecordingWarningElement.classList.add("warning-banner"),this._timelineRecordingWarningElement.append(WI.UIString("Debugger disabled during Timeline recording"),document.createElement("br"));let e=this._timelineRecordingWarningElement.appendChild(document.createElement("a"));e.textContent=WI.UIString("Stop recording"),e.addEventListener("click",()=>{WI.timelineManager.stopCapturing()}),this._auditTestWarningElement=document.createElement("div"),this._auditTestWarningElement.classList.add("warning-banner"),this._auditTestWarningElement.append(WI.UIString("Debugger disabled during Audit"),document.createElement("br"));let t=this._auditTestWarningElement.appendChild(document.createElement("a"));t.textContent=WI.UIString("Stop Audit"),t.addEventListener("click",()=>{WI.auditManager.stop()}),this._breakpointsDisabledWarningElement=document.createElement("div"),this._breakpointsDisabledWarningElement.classList.add("warning-banner"),this._breakpointsDisabledWarningElement.append(WI.UIString("Breakpoints disabled"),document.createElement("br"));let i=this._breakpointsDisabledWarningElement.appendChild(document.createElement("a"));i.textContent=WI.UIString("Enable breakpoints"),i.addEventListener("click",()=>{WI.debuggerToggleBreakpoints()}),this._navigationBar=new WI.NavigationBar,this.addSubview(this._navigationBar);var n={src:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3cpath d='M 0.5 3.5 L 0.5 11.5 L 10.5 11.5 L 14.5 7.5 L 10.5 3.5 L 0.5 3.5 Z'/%3e %3c/svg%3e",width:15,height:15},s={src:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3crect fill='none' stroke='currentColor' x='2.5' y='1.5' width='3' height='12'/%3e %3crect fill='none' stroke='currentColor' x='9.5' y='1.5' width='3' height='12'/%3e %3c/svg%3e",width:15,height:15},a={src:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3cpath d='M 6.5 2.5 L 6.5 12.5 L 14.5 7.5 L 6.5 2.5 Z'/%3e %3crect x='0.5' y='2.5' width='3' height='10'/%3e %3c/svg%3e",width:15,height:15},d={src:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3crect fill='none' stroke='currentColor' x='3.5' y='10.5' width='8' height='2'/%3e %3cpath fill='currentColor' d='M 13 5.5 L 14 4.5 L 14 9 L 9.5 9 L 10.5 8 L 12.2953461 8 L 7.50812492 3.19898186 L 1.70710678 9 L 0.292893219 9 L 7.5 1.79289322 L 13 7.29289322 L 13 5.5 Z'/%3e %3c/svg%3e",width:15,height:15},p={src:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3crect fill='none' stroke='currentColor' x='3.5' y='10.5' width='8' height='2'/%3e %3cpath fill='none' stroke='currentColor' d='M 7.5 8.5 L 7.5 1'/%3e %3cpath fill='none' stroke='currentColor' d='M 10.5 5.5 L 7.5 8.5 L 4.5 5.5'/%3e %3c/svg%3e",width:15,height:15},f={src:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3crect fill='none' stroke='currentColor' x='3.5' y='10.5' width='8' height='2'/%3e %3cpath fill='none' stroke='currentColor' d='M 7.5 9 L 7.5 2'/%3e %3cpath fill='none' stroke='currentColor' d='M 10.5 4.5 L 7.5 1.5 L 4.5 4.5'/%3e %3c/svg%3e",width:15,height:15},_=WI.UIString("Enable all breakpoints (%s)").format(WI.toggleBreakpointsKeyboardShortcut.displayName),b=WI.UIString("Disable all breakpoints (%s)").format(WI.toggleBreakpointsKeyboardShortcut.displayName);this._debuggerBreakpointsButtonItem=new WI.ActivateButtonNavigationItem("debugger-breakpoints",_,b,n.src,n.width,n.height),this._debuggerBreakpointsButtonItem.activated=WI.debuggerManager.breakpointsEnabled,this._debuggerBreakpointsButtonItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,WI.debuggerToggleBreakpoints,this),this._navigationBar.addNavigationItem(this._debuggerBreakpointsButtonItem),_=WI.UIString("Pause script execution (%s or %s)").format(WI.pauseOrResumeKeyboardShortcut.displayName,WI.pauseOrResumeAlternateKeyboardShortcut.displayName),b=WI.UIString("Continue script execution (%s or %s)").format(WI.pauseOrResumeKeyboardShortcut.displayName,WI.pauseOrResumeAlternateKeyboardShortcut.displayName),this._debuggerPauseResumeButtonItem=new WI.ToggleButtonNavigationItem("debugger-pause-resume",_,b,s.src,a.src,s.width,s.height),this._debuggerPauseResumeButtonItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,WI.debuggerPauseResumeToggle,this),this._navigationBar.addNavigationItem(this._debuggerPauseResumeButtonItem),this._debuggerStepOverButtonItem=new WI.ButtonNavigationItem("debugger-step-over",WI.UIString("Step over (%s or %s)").format(WI.stepOverKeyboardShortcut.displayName,WI.stepOverAlternateKeyboardShortcut.displayName),d.src,d.width,d.height),this._debuggerStepOverButtonItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,WI.debuggerStepOver,this),this._debuggerStepOverButtonItem.enabled=!1,this._navigationBar.addNavigationItem(this._debuggerStepOverButtonItem),this._debuggerStepIntoButtonItem=new WI.ButtonNavigationItem("debugger-step-into",WI.UIString("Step into (%s or %s)").format(WI.stepIntoKeyboardShortcut.displayName,WI.stepIntoAlternateKeyboardShortcut.displayName),p.src,p.width,p.height),this._debuggerStepIntoButtonItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,WI.debuggerStepInto,this),this._debuggerStepIntoButtonItem.enabled=!1,this._navigationBar.addNavigationItem(this._debuggerStepIntoButtonItem),this._debuggerStepOutButtonItem=new WI.ButtonNavigationItem("debugger-step-out",WI.UIString("Step out (%s or %s)").format(WI.stepOutKeyboardShortcut.displayName,WI.stepOutAlternateKeyboardShortcut.displayName),f.src,f.width,f.height),this._debuggerStepOutButtonItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,WI.debuggerStepOut,this),this._debuggerStepOutButtonItem.enabled=!1,this._navigationBar.addNavigationItem(this._debuggerStepOutButtonItem);function w(V){if(V.treeOutline!==this._scriptsContentTreeOutline||V instanceof WI.IssueTreeElement)return!0;if(V.hasChildren){for(let H of V.children)if(H instanceof WI.IssueTreeElement)return!0}return!1}this.filterBar.addFilterBarButton("debugger-show-resources-with-issues-only",w.bind(this),!1,WI.UIString("Only show resources with issues"),WI.UIString("Show all resources"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='none' stroke='currentColor' d='M 11 2.5 L 14.5 6 L 14.5 11 L 11 14.5 L 6 14.5 L 2.5 11 L 2.5 6 L 6 2.5 L 11 2.5 Z '/%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='square' d='M 8.5 5.5 L 8.5 9.5'/%3e %3crect fill='currentColor' x='8' y='11' width='1' height='1'/%3e %3c/svg%3e",15,15),this._breakpointsContentTreeOutline=this.contentTreeOutline;let S=new WI.DetailsSectionRow;S.element.appendChild(this._breakpointsContentTreeOutline.element);let E=document.createElement("div"),k=new WI.NavigationBar;E.appendChild(k.element),this._createBreakpointButton=new WI.ButtonNavigationItem("create-breakpoint",WI.UIString("Create Breakpoint"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 13'%3e %3cpath fill='none' stroke='currentColor' d='M 6.5 1 V 12 M 1 6.5 H 12'/%3e %3c/svg%3e",13,13),this._createBreakpointButton.element.addEventListener("mousedown",this._handleCreateBreakpointMouseDown.bind(this)),k.addNavigationItem(this._createBreakpointButton);let R=new WI.DetailsSectionGroup([S]);this._breakpointsSection=new WI.DetailsSection("breakpoints",WI.UIString("Breakpoints"),[R],E),this.contentView.element.appendChild(this._breakpointsSection.element),this._breakpointsContentTreeOutline.addEventListener(WI.TreeOutline.Event.ElementAdded,this._handleBreakpointElementAddedOrRemoved,this),this._breakpointsContentTreeOutline.addEventListener(WI.TreeOutline.Event.ElementRemoved,this._handleBreakpointElementAddedOrRemoved,this),this._breakpointsContentTreeOutline.addEventListener(WI.TreeOutline.Event.SelectionDidChange,this._treeSelectionDidChange,this),this._breakpointsContentTreeOutline.ondelete=this._breakpointTreeOutlineDeleteTreeElement.bind(this),this._breakpointsContentTreeOutline.populateContextMenu=function(V,H,O){this._breakpointTreeOutlineContextMenuTreeElement(V,H,O),WI.TreeOutline.prototype.populateContextMenu(V,H,O)}.bind(this),this._scriptsContentTreeOutline=this.createContentTreeOutline(),this._scriptsContentTreeOutline.addEventListener(WI.TreeOutline.Event.SelectionDidChange,this._treeSelectionDidChange,this),this._scriptsContentTreeOutline.includeSourceMapResourceChildren=!0;let M=new WI.DetailsSectionRow;M.element.appendChild(this._scriptsContentTreeOutline.element);let L=new WI.DetailsSectionGroup([M]);this._scriptsSection=new WI.DetailsSection("scripts",WI.UIString("Sources"),[L]),this.contentView.element.appendChild(this._scriptsSection.element),this._callStackTreeOutline=this.createContentTreeOutline({suppressFiltering:!0}),this._callStackTreeOutline.addEventListener(WI.TreeOutline.Event.SelectionDidChange,this._treeSelectionDidChange,this),this._callStackRow=new WI.DetailsSectionRow,this._callStackRow.element.appendChild(this._callStackTreeOutline.element),this._callStackGroup=new WI.DetailsSectionGroup([this._callStackRow]),this._callStackSection=new WI.DetailsSection("call-stack",WI.UIString("Call Stack"),[this._callStackGroup]),this._mainTargetTreeElement=null,this._activeCallFrameTreeElement=null,this._pauseReasonTreeOutline=null,this._pauseReasonLinkContainerElement=document.createElement("span"),this._pauseReasonTextRow=new WI.DetailsSectionTextRow,this._pauseReasonGroup=new WI.DetailsSectionGroup([this._pauseReasonTextRow]),this._pauseReasonSection=new WI.DetailsSection("paused-reason",WI.UIString("Pause Reason"),[this._pauseReasonGroup],this._pauseReasonLinkContainerElement),WI.Breakpoint.addEventListener(WI.Breakpoint.Event.DisplayLocationDidChange,this._handleDebuggerObjectDisplayLocationDidChange,this),WI.IssueMessage.addEventListener(WI.IssueMessage.Event.DisplayLocationDidChange,this._handleDebuggerObjectDisplayLocationDidChange,this),WI.consoleManager.addEventListener(WI.ConsoleManager.Event.IssueAdded,this._handleIssueAdded,this),WI.consoleManager.addEventListener(WI.ConsoleManager.Event.Cleared,this._handleIssuesCleared,this),WI.debuggerManager.addBreakpoint(WI.debuggerManager.allExceptionsBreakpoint),WI.debuggerManager.addBreakpoint(WI.debuggerManager.uncaughtExceptionsBreakpoint),InspectorBackend.domains.Debugger.setPauseOnAssertions&&WI.settings.showAssertionFailuresBreakpoint.value&&WI.debuggerManager.addBreakpoint(WI.debuggerManager.assertionFailuresBreakpoint);for(let V of WI.targets)this._addTarget(V);this._updateCallStackTreeOutline(),WI.networkManager.mainFrame&&this._addResourcesRecursivelyForFrame(WI.networkManager.mainFrame);for(let V of WI.debuggerManager.knownNonResourceScripts)this._addScript(V);if(WI.domDebuggerManager.supported){WI.settings.showAllRequestsBreakpoint.value&&WI.domDebuggerManager.addURLBreakpoint(WI.domDebuggerManager.allRequestsBreakpoint);for(let V of WI.domDebuggerManager.eventBreakpoints)this._addBreakpoint(V);for(let V of WI.domDebuggerManager.domBreakpoints)this._addBreakpoint(V);for(let V of WI.domManager.eventListenerBreakpoints)this._addBreakpoint(V);for(let V of WI.domDebuggerManager.urlBreakpoints)this._addBreakpoint(V)}WI.debuggerManager.paused&&this._debuggerDidPause(null),WI.debuggerManager.breakpointsDisabledTemporarily&&(this._handleTimelineCapturingStateChanged(),(WI.auditManager.runningState===WI.AuditManager.RunningState.Active||WI.auditManager.runningState===WI.AuditManager.RunningState.Stopping)&&this._handleAuditManagerTestScheduled()),this._updateBreakpointsDisabledBanner()}get minimumWidth(){return this._navigationBar.minimumWidth}closed(){super.closed(),WI.Frame.removeEventListener(null,null,this),WI.Target.removeEventListener(null,null,this),WI.debuggerManager.removeEventListener(null,null,this),WI.domDebuggerManager.removeEventListener(null,null,this),WI.DOMBreakpoint.removeEventListener(null,null,this),WI.timelineManager.removeEventListener(null,null,this),WI.targetManager.removeEventListener(null,null,this),WI.Breakpoint.removeEventListener(null,null,this),WI.IssueMessage.removeEventListener(null,null,this)}showDefaultContentView(){if(WI.networkManager.mainFrame){let t=this._scriptsContentTreeOutline.findTreeElement(WI.networkManager.mainFrame.mainResource);if(t&&this.showDefaultContentViewForTreeElement(t))return}let e=this._scriptsContentTreeOutline.children[0];for(;e&&!e.root;){if((e instanceof WI.ResourceTreeElement||e instanceof WI.ScriptTreeElement)&&this.showDefaultContentViewForTreeElement(e))return;e=e.traverseNextTreeElement(!1,null,!0)}}treeElementForRepresentedObject(e){e instanceof WI.Frame&&(e=e.mainResource);let t=this._breakpointsContentTreeOutline.findTreeElement(e);return t||(t=this._scriptsContentTreeOutline.findTreeElement(e)),t||(e instanceof WI.Script?e.url?(console.error("Didn't find a ScriptTreeElement for a Script with a URL."),null):this._addScript(e):(console.error("Didn't find a TreeElement for representedObject",e),null))}createContentTreeOutline(e={}){let t=super.createContentTreeOutline(e);return t.addEventListener(WI.TreeOutline.Event.ElementRevealed,i=>{let n=i.data.element,a=[this._pauseReasonSection,this._callStackSection,this._breakpointsSection,this._scriptsSection].find(p=>p.element.contains(n.listItemElement));if(!a)return;let d=a.headerElement.totalOffsetBottom-n.listItemElement.totalOffsetTop;d>0&&this.scrollElement.scrollBy(0,-d)}),t}saveStateToCookie(e){console.assert(e);var t=this._breakpointsContentTreeOutline.selectedTreeElement;if(!t){super.saveStateToCookie(e);return}var i=t.representedObject;if(i===WI.debuggerManager.allExceptionsBreakpoint){e[WI.DebuggerSidebarPanel.SelectedAllExceptionsCookieKey]=!0;return}if(i===WI.debuggerManager.uncaughtExceptionsBreakpoint){e[WI.DebuggerSidebarPanel.SelectedUncaughtExceptionsCookieKey]=!0;return}if(i===WI.debuggerManager.assertionFailuresBreakpoint){e[WI.DebuggerSidebarPanel.SelectedAssertionFailuresCookieKey]=!0;return}if(i===WI.domDebuggerManager.allRequestsBreakpoint){e[WI.DebuggerSidebarPanel.SelectedAllRequestsCookieKey]=!0;return}super.saveStateToCookie(e)}restoreStateFromCookie(e,t){console.assert(e);function i(n,s){let a=n.findTreeElement(s);!a||a.revealAndSelect()}e[WI.DebuggerSidebarPanel.SelectedAllExceptionsCookieKey]?i(this._breakpointsContentTreeOutline,WI.debuggerManager.allExceptionsBreakpoint):e[WI.DebuggerSidebarPanel.SelectedUncaughtExceptionsCookieKey]?i(this._breakpointsContentTreeOutline,WI.debuggerManager.uncaughtExceptionsBreakpoint):e[WI.DebuggerSidebarPanel.SelectedAssertionFailuresCookieKey]?i(this._breakpointsContentTreeOutline,WI.debuggerManager.assertionFailuresBreakpoint):e[WI.DebuggerSidebarPanel.SelectedAllRequestsCookieKey]?i(this._breakpointsContentTreeOutline,WI.domDebuggerManager.allRequestsBreakpoint):super.restoreStateFromCookie(e,t)}willDismissPopover(e){let t=e.breakpoint;!t||(t instanceof WI.EventBreakpoint?WI.domDebuggerManager.addEventBreakpoint(t):t instanceof WI.URLBreakpoint&&WI.domDebuggerManager.addURLBreakpoint(t))}_debuggerWaitingToPause(e){this._debuggerPauseResumeButtonItem.enabled=!1}_debuggerDidPause(e){this.contentView.element.insertBefore(this._callStackSection.element,this.contentView.element.firstChild),this._updatePauseReason()&&this.contentView.element.insertBefore(this._pauseReasonSection.element,this.contentView.element.firstChild),this._debuggerPauseResumeButtonItem.enabled=!0,this._debuggerPauseResumeButtonItem.toggled=!0,this._debuggerStepOverButtonItem.enabled=!0,this._debuggerStepIntoButtonItem.enabled=!0,this._debuggerStepOutButtonItem.enabled=!0,this.element.classList.add(WI.DebuggerSidebarPanel.DebuggerPausedStyleClassName)}_debuggerDidResume(e){this._callStackSection.element.remove(),this._pauseReasonSection.element.remove(),this._debuggerPauseResumeButtonItem.enabled=!0,this._debuggerPauseResumeButtonItem.toggled=!1,this._debuggerStepOverButtonItem.enabled=!1,this._debuggerStepIntoButtonItem.enabled=!1,this._debuggerStepOutButtonItem.enabled=!1,this.element.classList.remove(WI.DebuggerSidebarPanel.DebuggerPausedStyleClassName)}_breakpointsEnabledDidChange(e){this._debuggerBreakpointsButtonItem.activated=WI.debuggerManager.breakpointsEnabled,this._updateBreakpointsDisabledBanner()}_addBreakpoint(e){let t=WI.BreakpointTreeElement,i={},n=this._breakpointsContentTreeOutline,s=d=>{if(console.assert(d,"Missing DOMNode for identifier",e.domNodeIdentifier),!d)return null;let p=this._breakpointsContentTreeOutline.findTreeElement(d);return p||(p=new WI.DOMNodeTreeElement(d),this._addTreeElement(p,n)),p};if(e===WI.debuggerManager.allExceptionsBreakpoint)i.className=WI.DebuggerSidebarPanel.ExceptionIconStyleClassName,i.title=WI.repeatedUIString.allExceptions();else if(e===WI.debuggerManager.uncaughtExceptionsBreakpoint)i.className=WI.DebuggerSidebarPanel.ExceptionIconStyleClassName,i.title=WI.repeatedUIString.uncaughtExceptions();else if(e===WI.debuggerManager.assertionFailuresBreakpoint)i.className=WI.DebuggerSidebarPanel.AssertionIconStyleClassName,i.title=WI.repeatedUIString.assertionFailures();else if(e instanceof WI.DOMBreakpoint){if(!e.domNodeIdentifier)return null;t=WI.DOMBreakpointTreeElement;let d=WI.domManager.nodeForId(e.domNodeIdentifier);n=s(d)}else if(e instanceof WI.EventBreakpoint){if(t=WI.EventBreakpointTreeElement,e.eventListener){let d=null;e.eventListener.onWindow?(Ea.__windowEventTargetRepresentedObject||(Ea.__windowEventTargetRepresentedObject={__window:!0}),d=this._breakpointsContentTreeOutline.findTreeElement(Ea.__windowEventTargetRepresentedObject),d||(d=new WI.GeneralTreeElement(["event-target-window"],WI.unlocalizedString("window"),null,Ea.__windowEventTargetRepresentedObject),this._addTreeElement(d,n))):e.eventListener.node&&(d=s(e.eventListener.node)),d&&(n=d)}}else if(e instanceof WI.URLBreakpoint)t=WI.URLBreakpointTreeElement,e===WI.domDebuggerManager.allRequestsBreakpoint&&(i.title=WI.repeatedUIString.allRequests());else{let d=e.sourceCodeLocation&&e.sourceCodeLocation.displaySourceCode;if(!d||this._breakpointsContentTreeOutline.findTreeElement(e))return null;n=this._addTreeElementForSourceCodeToTreeOutline(d,this._breakpointsContentTreeOutline),e.disabled&&(e.resolved=!0)}let a=new t(e,i);return this._addTreeElement(a,n),n.children.length===1&&n.expand(),a}_removeBreakpoint(e){if(this._pauseReasonTreeOutline){let i=this._pauseReasonTreeOutline.getCachedTreeElement(e);i&&(i.status=null)}let t=this._breakpointsContentTreeOutline.getCachedTreeElement(e);!t||this._removeDebuggerTreeElement(t)}_addBreakpointsForSourceCode(e){for(let t of WI.debuggerManager.breakpointsForSourceCode(e))this._addBreakpoint(t,e)}_addIssuesForSourceCode(e){var t=WI.consoleManager.issuesForSourceCode(e);for(var i of t)this._addIssue(i)}_addTreeElementForSourceCodeToTreeOutline(e,t){let i=t.getCachedTreeElement(e);return i||(e instanceof WI.SourceMapResource?i=new WI.SourceMapResourceTreeElement(e):e instanceof WI.Resource?i=new WI.ResourceTreeElement(e):e instanceof WI.Script&&(i=new WI.ScriptTreeElement(e))),i?(i.parent||(i.hasChildren=!1,i.expand(),this._addTreeElement(i,t)),i):(console.error("Unknown sourceCode instance",e),null)}_addResourcesRecursivelyForFrame(e){this._addResource(e.mainResource);for(let t of e.resourceCollection)this._addResource(t);for(let t of e.childFrameCollection)this._addResourcesRecursivelyForFrame(t)}_resourceAdded(e){this._addResource(e.data.resource)}_addResource(e){if(![WI.Resource.Type.Document,WI.Resource.Type.Script].includes(e.type))return;let t=this._addTreeElementForSourceCodeToTreeOutline(e,this._scriptsContentTreeOutline);this._addBreakpointsForSourceCode(e),this._addIssuesForSourceCode(e),this.parentSidebar&&!this.contentBrowser.currentContentView&&this.showDefaultContentViewForTreeElement(t)}_mainResourceDidChange(e){if(e.target.isMainFrame()){this.pruneStaleResourceTreeElements(),this.contentBrowser.contentViewContainer.closeAllContentViews();for(let i of WI.domDebuggerManager.domBreakpoints)this._removeBreakpoint(i)}if(!e.data.oldMainResource){var t=e.target.mainResource;this._addTreeElementForSourceCodeToTreeOutline(t,this._scriptsContentTreeOutline),this._addBreakpointsForSourceCode(t),this._addIssuesForSourceCode(t)}}_handleTimelineCapturingStateChanged(e){switch(this._updateTemporarilyDisabledBreakpointsButtons(),WI.timelineManager.capturingState){case WI.TimelineManager.CapturingState.Starting:this.contentView.element.insertBefore(this._timelineRecordingWarningElement,this.contentView.element.firstChild);break;case WI.TimelineManager.CapturingState.Inactive:this._timelineRecordingWarningElement.remove();break}this._updateBreakpointsDisabledBanner()}_handleAuditManagerTestScheduled(e){this._updateTemporarilyDisabledBreakpointsButtons(),this.contentView.element.insertBefore(this._auditTestWarningElement,this.contentView.element.firstChild),this._updateBreakpointsDisabledBanner()}_handleAuditManagerTestCompleted(e){this._updateTemporarilyDisabledBreakpointsButtons(),this._auditTestWarningElement.remove(),this._updateBreakpointsDisabledBanner()}_updateTemporarilyDisabledBreakpointsButtons(){let e=WI.debuggerManager.breakpointsDisabledTemporarily;this._debuggerBreakpointsButtonItem.enabled=!e,this._debuggerPauseResumeButtonItem.enabled=!e}_updateBreakpointsDisabledBanner(){let e=WI.debuggerManager.breakpointsEnabled,t=!!this._timelineRecordingWarningElement.parentElement,i=!!this._auditTestWarningElement.parentElement;!e&&!t&&!i?this.contentView.element.insertBefore(this._breakpointsDisabledWarningElement,this.contentView.element.firstChild):this._breakpointsDisabledWarningElement.remove()}_scriptAdded(e){this._addScript(e.data.script)}_addScript(e){if(!e.url&&!e.sourceURL||e.dynamicallyAddedScriptElement&&!e.sourceURL||e.resource)return null;let t=this._addTreeElementForSourceCodeToTreeOutline(e,this._scriptsContentTreeOutline);return this._addBreakpointsForSourceCode(e),this._addIssuesForSourceCode(e),this.parentSidebar&&!this.contentBrowser.currentContentView&&this.showDefaultContentViewForTreeElement(t),t}_scriptRemoved(e){function t(n,s){let a=s.getCachedTreeElement(n);a&&a.parent.removeChild(a)}let i=e.data.script;t(i,this._breakpointsContentTreeOutline),t(i,this._scriptsContentTreeOutline)}_scriptsCleared(e){for(var t=this._breakpointsContentTreeOutline.children.length-1;t>=0;--t){var i=this._breakpointsContentTreeOutline.children[t];i instanceof WI.ScriptTreeElement&&this._breakpointsContentTreeOutline.removeChildAtIndex(t,!0,!0)}this._scriptsContentTreeOutline.removeChildren(),this._addResourcesRecursivelyForFrame(WI.networkManager.mainFrame)}_breakpointAdded(e){var t=e.data.breakpoint;this._addBreakpoint(t)}_breakpointRemoved(e){var t=e.data.breakpoint;this._removeBreakpoint(t)}_findThreadTreeElementForTarget(e){for(let t of this._callStackTreeOutline.children)if(t.target===e)return t;return null}_targetAdded(e){this._addTarget(e.data.target)}_addTarget(e){let t=new WI.ThreadTreeElement(e);this._callStackTreeOutline.appendChild(t),e===WI.mainTarget&&(this._mainTargetTreeElement=t),this._updateCallStackTreeOutline()}_targetRemoved(e){let t=e.data.target,i=this._findThreadTreeElementForTarget(t);this._callStackTreeOutline.removeChild(i),this._updateCallStackTreeOutline()}_updateCallStackTreeOutline(){let e=WI.targets.length<=1;this._callStackTreeOutline.element.classList.toggle("single-thread",e),this._mainTargetTreeElement&&(this._mainTargetTreeElement.selectable=!e)}_handleDebuggerObjectDisplayLocationDidChange(e){var t=e.target;if(e.data.oldDisplaySourceCode===t.sourceCodeLocation.displaySourceCode)return;let i=!1,n=this._breakpointsContentTreeOutline.getCachedTreeElement(t);n&&(i=n.selected);let s=null;t instanceof WI.Breakpoint?s=this._addBreakpoint(t):t instanceof WI.IssueMessage&&(s=this._addIssue(t)),s&&(n&&this._removeDebuggerTreeElement(n),i&&s.revealAndSelect(!0,!1,!0))}_removeDebuggerTreeElement(e){e.__deletedViaDeleteKeyboardShortcut||e.deselect();let t=e.parent;t.removeChild(e),!(t.children.length||t===this._breakpointsContentTreeOutline)&&t.treeOutline.removeChild(t)}_debuggerCallFramesDidChange(e){let t=e.data.target;this._findThreadTreeElementForTarget(t).refresh();let n=this._callStackTreeOutline.findTreeElement(WI.debuggerManager.activeCallFrame);n&&n.reveal()}_debuggerActiveCallFrameDidChange(){this._activeCallFrameTreeElement&&(this._activeCallFrameTreeElement.isActiveCallFrame=!1,this._activeCallFrameTreeElement=null),WI.debuggerManager.activeCallFrame&&(this._activeCallFrameTreeElement=this._callStackTreeOutline.findTreeElement(WI.debuggerManager.activeCallFrame),this._activeCallFrameTreeElement&&(this._activeCallFrameTreeElement.isActiveCallFrame=!0))}_breakpointsBeneathTreeElement(e){if(console.assert(e instanceof WI.ResourceTreeElement||e instanceof WI.ScriptTreeElement),!(e instanceof WI.ResourceTreeElement)&&!(e instanceof WI.ScriptTreeElement))return[];for(var t=[],i=e.children,n=0;n<i.length;++n){console.assert(i[n]instanceof WI.BreakpointTreeElement),console.assert(i[n].breakpoint);var s=i[n].breakpoint;s&&t.push(s)}return t}_removeAllBreakpoints(e){for(var t=0;t<e.length;++t){var i=e[t];WI.debuggerManager.isBreakpointRemovable(i)&&WI.debuggerManager.removeBreakpoint(i)}}_toggleAllBreakpoints(e,t){for(var i=0;i<e.length;++i)e[i].disabled=t}_breakpointTreeOutlineDeleteTreeElement(e){if(console.assert(e.selected),e.representedObject===Ea.__windowEventTargetRepresentedObject){let s=WI.domManager.eventListenerBreakpoints.filter(a=>a.eventListener.onWindow);for(let a of s)WI.domManager.removeBreakpointForEventListener(a.eventListener);return!0}if(console.assert(e instanceof WI.ResourceTreeElement||e instanceof WI.ScriptTreeElement),!(e instanceof WI.ResourceTreeElement)&&!(e instanceof WI.ScriptTreeElement))return!1;var t=e.previousSibling===this._assertionsBreakpointTreeElement||e.previousSibling===this._allUncaughtExceptionsBreakpointTreeElement,i=e.nextSibling,n=this._breakpointsBeneathTreeElement(e);return this._removeAllBreakpoints(n),t&&i&&i.select(!0,!0),!0}_breakpointTreeOutlineContextMenuTreeElement(e,t,i){if(!(i instanceof WI.ResourceTreeElement)&&!(i instanceof WI.ScriptTreeElement))return;let n=this._breakpointsBeneathTreeElement(i),s=n.some(p=>!p.disabled),a=()=>{this._removeAllBreakpoints(n)},d=()=>{this._toggleAllBreakpoints(n,s)};s?e.appendItem(WI.UIString("Disable Breakpoints"),d):e.appendItem(WI.UIString("Enable Breakpoints"),d),e.appendItem(WI.UIString("Delete Breakpoints"),a)}_treeSelectionDidChange(e){if(!this.selected)return;let t=e.target.selectedTreeElement;if(!t||t instanceof WI.DOMNodeTreeElement||t instanceof WI.DOMBreakpointTreeElement||t instanceof WI.EventBreakpointTreeElement||t instanceof WI.URLBreakpointTreeElement||t.representedObject===Ea.__windowEventTargetRepresentedObject)return;const i={ignoreNetworkTab:!0,ignoreSearchTab:!0};if(t instanceof WI.ResourceTreeElement||t instanceof WI.ScriptTreeElement){WI.showSourceCode(t.representedObject,i);return}if(t instanceof WI.CallFrameTreeElement){let s=t.callFrame;s.id&&(WI.debuggerManager.activeCallFrame=s),s.sourceCodeLocation&&WI.showSourceCodeLocation(s.sourceCodeLocation,i);return}if(t instanceof WI.IssueTreeElement){WI.showSourceCodeLocation(t.issueMessage.sourceCodeLocation,i);return}if(!(t instanceof WI.BreakpointTreeElement))return;let n=t.breakpoint;if(t.treeOutline===this._pauseReasonTreeOutline){WI.showSourceCodeLocation(n.sourceCodeLocation,i);return}!t.parent.representedObject||(console.assert(t.parent.representedObject instanceof WI.SourceCode),t.parent.representedObject instanceof WI.SourceCode&&WI.showSourceCodeLocation(n.sourceCodeLocation,i))}_addTreeElement(e,t){t||(t=this._breakpointsContentTreeOutline);let i=(n,s)=>{const a=[f=>f.representedObject===WI.debuggerManager.allExceptionsBreakpoint,f=>f.representedObject===WI.debuggerManager.uncaughtExceptionsBreakpoint,f=>f.representedObject===WI.debuggerManager.assertionFailuresBreakpoint,f=>f instanceof WI.BreakpointTreeElement||f instanceof WI.ResourceTreeElement||f instanceof WI.ScriptTreeElement,f=>f instanceof WI.EventBreakpointTreeElement,f=>f instanceof WI.DOMNodeTreeElement,f=>f.representedObject===Ea.__windowEventTargetRepresentedObject,f=>f instanceof WI.DOMBreakpointTreeElement,f=>f.representedObject===WI.domDebuggerManager.allRequestsBreakpoint,f=>f instanceof WI.URLBreakpointTreeElement];let d=a.findIndex(f=>f(n)),p=a.findIndex(f=>f(s));if(d>=0&&p>=0){if(d<p)return-1;if(p<d)return 1}return n instanceof WI.BreakpointTreeElement&&s instanceof WI.BreakpointTreeElement?this._compareBreakpointTreeElements(n,s):n.mainTitle.extendedLocaleCompare(s.mainTitle)||n.subtitle.extendedLocaleCompare(s.subtitle)};t.insertChild(e,insertionIndexForObjectInListSortedByFunction(e,t.children,i))}_compareBreakpointTreeElements(e,t){if(!e.representedObject||!t.representedObject)return 0;let i=e.representedObject.sourceCodeLocation,n=t.representedObject.sourceCodeLocation;if(!i||!n)return 0;var s=i.displayLineNumber-n.displayLineNumber;return s!==0?s:i.displayColumnNumber-n.displayColumnNumber}_updatePauseReason(){return this._pauseReasonTreeOutline=null,this._updatePauseReasonGotoArrow(),this._updatePauseReasonSection()}_updatePauseReasonSection(){let e=WI.debuggerManager.activeCallFrame.target,t=WI.debuggerManager.dataForTarget(e),{pauseReason:i,pauseData:n}=t;switch(i){case WI.DebuggerManager.PauseReason.AnimationFrame:if(console.assert(n,"Expected data with an animation frame, but found none."),!n)return!1;var p=WI.domDebuggerManager.eventBreakpointForTypeAndEventName(WI.EventBreakpoint.Type.AnimationFrame,n.eventName);if(console.assert(p,"Expected AnimationFrame breakpoint for event name.",n.eventName),!p)return!1;this._pauseReasonTreeOutline=this.createContentTreeOutline({suppressFiltering:!0});var f=new WI.EventBreakpointTreeElement(p,{className:WI.DebuggerSidebarPanel.PausedBreakpointIconStyleClassName,title:WI.UIString("%s Fired").format(n.eventName)});this._pauseReasonTreeOutline.appendChild(f);var _=new WI.DetailsSectionRow;return _.element.appendChild(this._pauseReasonTreeOutline.element),this._pauseReasonGroup.rows=[_],!0;case WI.DebuggerManager.PauseReason.Assertion:return console.assert(n,"Expected data with an assertion, but found none."),n&&n.message?(this._pauseReasonTextRow.text=WI.UIString("Assertion with message: %s").format(n.message),!0):(this._pauseReasonTextRow.text=WI.UIString("Assertion Failed"),this._pauseReasonGroup.rows=[this._pauseReasonTextRow],!0);case WI.DebuggerManager.PauseReason.Breakpoint:if(console.assert(n,"Expected breakpoint identifier, but found none."),n&&n.breakpointId){this._pauseReasonTreeOutline=this.createContentTreeOutline({suppressFiltering:!0}),this._pauseReasonTreeOutline.addEventListener(WI.TreeOutline.Event.SelectionDidChange,this._treeSelectionDidChange,this);let b=WI.debuggerManager.breakpointForIdentifier(n.breakpointId),w=new WI.BreakpointTreeElement(b,{className:WI.DebuggerSidebarPanel.PausedBreakpointIconStyleClassName,title:WI.UIString("Triggered Breakpoint")}),S=new WI.DetailsSectionRow;return this._pauseReasonTreeOutline.appendChild(w),S.element.appendChild(this._pauseReasonTreeOutline.element),this._pauseReasonGroup.rows=[S],!0}break;case WI.DebuggerManager.PauseReason.CSPViolation:if(console.assert(n,"Expected data with a CSP Violation, but found none."),n)return this._pauseReasonTextRow.text=WI.UIString("Content Security Policy violation of directive: %s").format(n.directive||n.directiveText),this._pauseReasonGroup.rows=[this._pauseReasonTextRow],!0;break;case WI.DebuggerManager.PauseReason.DebuggerStatement:return this._pauseReasonTextRow.text=WI.UIString("Debugger Statement"),this._pauseReasonGroup.rows=[this._pauseReasonTextRow],!0;case WI.DebuggerManager.PauseReason.DOM:if(console.assert(WI.domDebuggerManager.supported),console.assert(n,"Expected DOM breakpoint data, but found none."),n&&n.nodeId){let b=WI.domManager.nodeForId(n.nodeId),w=WI.domDebuggerManager.domBreakpointsForNode(b),S;for(let V of w)if(V.type===n.type){S=V;break}if(!S)return;this._pauseReasonTreeOutline=this.createContentTreeOutline({suppressFiltering:!0});let E=WI.DOMBreakpointTreeElement.displayNameForType(S.type),k=new WI.DOMBreakpointTreeElement(S,{className:WI.DebuggerSidebarPanel.PausedBreakpointIconStyleClassName,title:E}),R=new WI.DetailsSectionRow;this._pauseReasonTreeOutline.appendChild(k),R.element.appendChild(this._pauseReasonTreeOutline.element);let M=new WI.DetailsSectionSimpleRow(WI.UIString("Element"),WI.linkifyNodeReference(b));return this._pauseReasonGroup.rows=[R,M],S.type!==WI.DOMBreakpoint.Type.SubtreeModified||(console.assert(n.targetNode),WI.RemoteObject.fromPayload(n.targetNode,e).pushNodeToFrontend(V=>{if(!V)return;let H=WI.domManager.nodeForId(V);if(console.assert(H,"Missing node for id.",V),!H)return;let O=document.createDocumentFragment(),z=n.insertion?WI.UIString("Child added to "):WI.UIString("Removed descendant ");O.append(z,WI.linkifyNodeReference(H));let K=new WI.DetailsSectionSimpleRow(WI.UIString("Details"),O);K.element.classList.add("target-description"),this._pauseReasonGroup.rows=this._pauseReasonGroup.rows.concat(K)})),!0}break;case WI.DebuggerManager.PauseReason.EventListener:if(console.assert(n,"Expected data with an event listener, but found none."),!n)return!1;var p=null;if(n.eventListenerId&&(p=WI.domManager.breakpointForEventListenerId(n.eventListenerId)),p||(p=WI.domDebuggerManager.eventBreakpointForTypeAndEventName(WI.EventBreakpoint.Type.Listener,n.eventName)),console.assert(p,"Expected Event Listener breakpoint for event name.",n.eventName),!p)return!1;this._pauseReasonTreeOutline=this.createContentTreeOutline({suppressFiltering:!0});var f=new WI.EventBreakpointTreeElement(p,{className:WI.DebuggerSidebarPanel.PausedBreakpointIconStyleClassName,title:WI.UIString("\u201C%s\u201D Event Fired").format(n.eventName)});this._pauseReasonTreeOutline.appendChild(f);var _=new WI.DetailsSectionRow;_.element.appendChild(this._pauseReasonTreeOutline.element);var s=[_],a=p.eventListener;if(a){console.assert(a.eventListenerId===n.eventListenerId);let b=null;a.onWindow?b=WI.unlocalizedString("window"):a.node&&(b=WI.linkifyNodeReference(a.node)),b&&s.push(new WI.DetailsSectionSimpleRow(WI.UIString("Target"),b))}return this._pauseReasonGroup.rows=s,!0;case WI.DebuggerManager.PauseReason.Exception:if(console.assert(n,"Expected data with an exception, but found none."),n){var d=WI.RemoteObject.fromPayload(n,e);return this._pauseReasonTextRow.text=WI.UIString("Exception with thrown value: %s").format(d.description),this._pauseReasonGroup.rows=[this._pauseReasonTextRow],!0}break;case WI.DebuggerManager.PauseReason.PauseOnNextStatement:return this._pauseReasonTextRow.text=WI.UIString("Immediate Pause Requested"),this._pauseReasonGroup.rows=[this._pauseReasonTextRow],!0;case WI.DebuggerManager.PauseReason.Timer:if(console.assert(n,"Expected data with a timer, but found none."),!n)return!1;var p=WI.domDebuggerManager.eventBreakpointForTypeAndEventName(WI.EventBreakpoint.Type.Timer,n.eventName);if(console.assert(p,"Expected Timer breakpoint for event name.",n.eventName),!p)return!1;this._pauseReasonTreeOutline=this.createContentTreeOutline({suppressFiltering:!0});var f=new WI.EventBreakpointTreeElement(p,{className:WI.DebuggerSidebarPanel.PausedBreakpointIconStyleClassName,title:WI.UIString("%s Fired").format(n.eventName)});this._pauseReasonTreeOutline.appendChild(f);var _=new WI.DetailsSectionRow;return _.element.appendChild(this._pauseReasonTreeOutline.element),this._pauseReasonGroup.rows=[_],!0;case WI.DebuggerManager.PauseReason.Fetch:case WI.DebuggerManager.PauseReason.XHR:if(console.assert(WI.domDebuggerManager.supported),console.assert(n,"Expected URL breakpoint data, but found none."),n){if(n.breakpointURL){let b=WI.domDebuggerManager.urlBreakpointForURL(n.breakpointURL);console.assert(b,"Expected URL breakpoint for URL.",n.breakpointURL),this._pauseReasonTreeOutline=this.createContentTreeOutline({suppressFiltering:!0});let w=new WI.URLBreakpointTreeElement(b,{className:WI.DebuggerSidebarPanel.PausedBreakpointIconStyleClassName,title:WI.DOMDebuggerManager.supportsURLBreakpoints()?WI.UIString("Triggered URL Breakpoint"):WI.UIString("Triggered XHR Breakpoint")}),S=new WI.DetailsSectionRow;this._pauseReasonTreeOutline.appendChild(w),S.element.appendChild(this._pauseReasonTreeOutline.element),this._pauseReasonTextRow.text=n.url,this._pauseReasonGroup.rows=[S,this._pauseReasonTextRow]}else console.assert(n.breakpointURL==="","Should be the All Requests breakpoint which has an empty URL"),this._pauseReasonTextRow.text=WI.UIString("Requesting: %s").format(n.url),this._pauseReasonGroup.rows=[this._pauseReasonTextRow];return this._pauseReasonTextRow.element.title=n.url,!0}break;case WI.DebuggerManager.PauseReason.Other:console.error("Paused for unknown reason. We should always have a reason.");break}return!1}_updatePauseReasonGotoArrow(){this._pauseReasonLinkContainerElement.removeChildren();var e=WI.debuggerManager.activeCallFrame;if(!e)return;var t=e.sourceCodeLocation;if(!t)return;const i={useGoToArrowButton:!0,ignoreNetworkTab:!0,ignoreSearchTab:!0};let n=WI.createSourceCodeLocationLink(t,i);this._pauseReasonLinkContainerElement.appendChild(n)}_addIssue(e){let t=this._scriptsContentTreeOutline.findTreeElement(e);if(t)return t;let i=this._addTreeElementForSourceCodeToTreeOutline(e.sourceCodeLocation.sourceCode,this._scriptsContentTreeOutline);return i?(t=new WI.IssueTreeElement(e),i.insertChild(t,insertionIndexForObjectInListSortedByFunction(t,i.children,this._compareBreakpointTreeElements)),i.children.length===1&&i.expand(),t):null}_handleDOMBreakpointDOMNodeChanged(e){let t=e.target;t.domNodeIdentifier?this._addBreakpoint(t):this._removeBreakpoint(t)}_handleIssueAdded(e){var t=e.data.issue;!t.sourceCodeLocation||!t.sourceCodeLocation.sourceCode||t.source!=="javascript"&&t.source!=="console-api"||this._addIssue(t)}_handleIssuesCleared(e){let t=this._scriptsContentTreeOutline.children[0],i=[];for(;t&&!t.root;)t instanceof WI.IssueTreeElement&&i.push(t),t=t.traverseNextTreeElement(!1,null,!0);i.forEach(n=>n.parent.removeChild(n))}_handleBreakpointElementAddedOrRemoved(e){let t=e.data.element,i=null;t.breakpoint===WI.debuggerManager.assertionFailuresBreakpoint?i=WI.settings.showAssertionFailuresBreakpoint:t.representedObject===WI.domDebuggerManager.allRequestsBreakpoint&&(i=WI.settings.showAllRequestsBreakpoint),i&&(i.value=!!t.parent)}_handleCreateBreakpointMouseDown(e){if(this._ignoreCreateBreakpointMouseDown)return;this._ignoreCreateBreakpointMouseDown=!0;let t=WI.ContextMenu.createFromEvent(e);if(t.addBeforeShowCallback(()=>{this._ignoreCreateBreakpointMouseDown=!1}),InspectorBackend.domains.Debugger.setPauseOnAssertions){let i=WI.settings.showAssertionFailuresBreakpoint.value;t.appendCheckboxItem(WI.repeatedUIString.assertionFailures(),()=>{i?WI.debuggerManager.removeBreakpoint(WI.debuggerManager.assertionFailuresBreakpoint):(WI.debuggerManager.assertionFailuresBreakpoint.disabled=!1,WI.debuggerManager.addBreakpoint(WI.debuggerManager.assertionFailuresBreakpoint))},i)}if(WI.domDebuggerManager.supported){t.appendSeparator(),t.appendItem(WI.UIString("Event Breakpoint\u2026"),()=>{new WI.EventBreakpointPopover(this).show(this._createBreakpointButton.element,[WI.RectEdge.MAX_Y,WI.RectEdge.MIN_Y,WI.RectEdge.MAX_X])}),t.appendSeparator();let i=WI.settings.showAllRequestsBreakpoint.value;t.appendCheckboxItem(WI.repeatedUIString.allRequests(),()=>{i?WI.domDebuggerManager.removeURLBreakpoint(WI.domDebuggerManager.allRequestsBreakpoint):(WI.domDebuggerManager.allRequestsBreakpoint.disabled=!1,WI.domDebuggerManager.addURLBreakpoint(WI.domDebuggerManager.allRequestsBreakpoint))},i),t.appendItem(WI.DOMDebuggerManager.supportsURLBreakpoints()?WI.UIString("URL Breakpoint\u2026"):WI.UIString("XHR Breakpoint\u2026"),()=>{new WI.URLBreakpointPopover(this).show(this._createBreakpointButton.element,[WI.RectEdge.MAX_Y,WI.RectEdge.MIN_Y,WI.RectEdge.MAX_X])})}t.show()}};WI.DebuggerSidebarPanel.DebuggerPausedStyleClassName="paused";WI.DebuggerSidebarPanel.ExceptionIconStyleClassName="breakpoint-exception-icon";WI.DebuggerSidebarPanel.AssertionIconStyleClassName="breakpoint-assertion-icon";WI.DebuggerSidebarPanel.PausedBreakpointIconStyleClassName="breakpoint-paused-icon";WI.DebuggerSidebarPanel.SelectedAllExceptionsCookieKey="debugger-sidebar-panel-all-exceptions-breakpoint";WI.DebuggerSidebarPanel.SelectedUncaughtExceptionsCookieKey="debugger-sidebar-panel-uncaught-exceptions-breakpoint";WI.DebuggerSidebarPanel.SelectedAssertionFailuresCookieKey="debugger-sidebar-panel-assertion-failures-breakpoint";WI.DebuggerSidebarPanel.SelectedAllRequestsCookieKey="debugger-sidebar-panel-all-requests-breakpoint";WI.DefaultDashboardView=class extends WI.DashboardView{constructor(e){super(e,"default"),e.addEventListener(WI.DefaultDashboard.Event.DataDidChange,()=>{this._updateDisplaySoon()}),this._scheduledUpdateIdentifier=void 0,this._items={resourcesCount:{tooltip:WI.UIString("Show page resources"),handler:this._resourcesItemWasClicked},resourcesSize:{tooltip:WI.UIString("Show network information"),handler:this._networkItemWasClicked},time:{tooltip:WI.UIString("Show page load timing"),handler:this._timelineItemWasClicked},logs:{tooltip:WI.UIString("Show messages logged to the Console"),handler:this._consoleItemWasClicked.bind(this,WI.LogContentView.Scopes.Logs)},errors:{tooltip:WI.UIString("Show errors logged to the Console"),handler:this._consoleItemWasClicked.bind(this,WI.LogContentView.Scopes.Errors)},issues:{tooltip:WI.UIString("Show warnings logged to the Console"),handler:this._consoleItemWasClicked.bind(this,WI.LogContentView.Scopes.Warnings)}};for(var t in this._items)this._appendElementForNamedItem(t)}_updateDisplaySoon(){this._scheduledUpdateIdentifier||(this._scheduledUpdateIdentifier=requestAnimationFrame(this._updateDisplay.bind(this)))}_updateDisplay(){this._scheduledUpdateIdentifier=void 0;var e=this.representedObject;for(var t of["logs","issues","errors"])this._setConsoleItemValue(t,e[t]);var i=this._items.time;i.text=e.time?Number.secondsToString(e.time):emDash,this._setItemEnabled(i,e.time>0);var n=this._items.resourcesCount;n.text=Number.abbreviate(e.resourcesCount),this._setItemEnabled(n,e.resourcesCount>0);var s=this._items.resourcesSize;s.text=e.resourcesSize?Number.bytesToString(e.resourcesSize,!1):emDash,this._setItemEnabled(s,e.resourcesSize>0)}_appendElementForNamedItem(e){var t=this._items[e];t.container=this._element.appendChild(document.createElement("div")),t.container.className="item "+e,t.container.appendChild(document.createElement("img")),t.outlet=t.container.appendChild(document.createElement("div")),Object.defineProperty(t,"text",{set:function(i){i=i.toString(),i!==t.outlet.textContent&&(t.outlet.textContent=i)}}),t.container.addEventListener("click",i=>{this._itemWasClicked(e)})}_itemWasClicked(e){var t=this._items[e];!t.container.classList.contains(WI.DefaultDashboardView.EnabledItemStyleClassName)||t.handler&&t.handler.call(this)}_resourcesItemWasClicked(){WI.settings.experimentalEnableSourcesTab.value?WI.showSourcesTab():WI.showResourcesTab()}_networkItemWasClicked(){WI.showNetworkTab()}_timelineItemWasClicked(){WI.showTimelineTab()}_consoleItemWasClicked(e){WI.showConsoleTab(e)}_setConsoleItemValue(e,t){var i="_"+e,n=this[i];this[i]=t;var s=this._items[e];if(s.text=Number.abbreviate(t),this._setItemEnabled(s,t>0),t<=n)return;var a=s.container;function d(p){p.target===a&&(a.classList.remove("pulsing"),a.removeEventListener("animationend",d))}a.classList.contains("pulsing")?(a.classList.remove("pulsing"),a.recalculateStyles()):a.addEventListener("animationend",d),a.classList.add("pulsing")}_setItemEnabled(e,t){t?(e.container.title=e.tooltip,e.container.classList.add(WI.DefaultDashboardView.EnabledItemStyleClassName)):(e.container.title="",e.container.classList.remove(WI.DefaultDashboardView.EnabledItemStyleClassName))}};WI.DefaultDashboardView.EnabledItemStyleClassName="enabled";WI.DividerNavigationItem=class extends WI.NavigationItem{get additionalClassNames(){return["divider"]}};WI.EditableDataGridNode=class extends WI.DataGridNode{constructor(e){super(e,!1)}get element(){let e=super.element;return e&&e.classList.add("editable"),e}createCellContent(e,t){let i=super.createCellContent(e,t);if(console.assert(typeof i=="string"),typeof i!="string")return i;let n=document.createElement("input");return n.value=i,n.addEventListener("keypress",this._handleKeyPress.bind(this,e)),n.addEventListener("blur",this._handleBlur.bind(this,e)),n}_handleKeyPress(e,t){t.keyCode===WI.KeyboardShortcut.Key.Escape.keyCode&&this.dataGrid.element.focus(),t.keyCode===WI.KeyboardShortcut.Key.Enter.keyCode&&this._notifyInputElementValueChanged(e,t.target.value)}_handleBlur(e,t){this._notifyInputElementValueChanged(e,t.target.value)}_notifyInputElementValueChanged(e,t){t!==this.data[e]&&this.dispatchEventToListeners(WI.EditableDataGridNode.Event.ValueChanged,{value:t,columnIdentifier:e})}};WI.EditableDataGridNode.Event={ValueChanged:"editable-data-grid-node-value-changed"};WI.enclosingCodeMirror=function(c){for(;c;){if(c.CodeMirror)return c.CodeMirror;c=c.parentNode}return null};WI.isBeingEdited=function(c){for(;c;){if(c.__editing)return!0;c=c.parentNode}return!1};WI.markBeingEdited=function(c,e){if(e){if(c.__editing)return!1;c.__editing=!0,WI.__editingCount=(WI.__editingCount||0)+1}else{if(!c.__editing)return!1;delete c.__editing,--WI.__editingCount}return!0};WI.isEditingAnyField=function(){return!!WI.__editingCount};WI.isEventTargetAnEditableField=function(c){if(c.target instanceof HTMLInputElement||c.target instanceof HTMLTextAreaElement||c.target.isContentEditable||WI.isBeingEdited(c.target))return!0;let e=WI.enclosingCodeMirror(c.target);return e?!e.getOption("readOnly"):!1};WI.EditingConfig=class{constructor(e,t,i){this.commitHandler=e,this.cancelHandler=t,this.context=i,this.spellcheck=!1}setPasteHandler(e){this.pasteHandler=e}setMultiline(e){this.multiline=e}setCustomFinishHandler(e){this.customFinishHandler=e}setNumberCommitHandler(e){this.numberCommitHandler=e}};WI.startEditing=function(c,e){if(!WI.markBeingEdited(c,!0))return null;e=e||new WI.EditingConfig(function(){},function(){});var t=e.commitHandler,i=e.cancelHandler,n=e.pasteHandler,s=e.context,a=b(c),d="";c.classList.add("editing"),c.contentEditable="plaintext-only";var p=c.hasAttribute("spellcheck")?c.spellcheck:void 0;c.spellcheck=e.spellcheck,e.multiline&&c.classList.add("multiline");var f=c.tabIndex;c.tabIndex<0&&(c.tabIndex=0);function _(){E.call(c)}function b(V){return V.tagName==="INPUT"&&V.type==="text"?V.value:V.textContent}function w(){WI.markBeingEdited(c,!1),this.classList.remove("editing"),this.contentEditable=!1,this.scrollTop=0,this.scrollLeft=0,p===void 0?c.removeAttribute("spellcheck"):c.spellcheck=p,f===-1?this.removeAttribute("tabindex"):this.tabIndex=f,c.removeEventListener("blur",_,!1),c.removeEventListener("keydown",L,!0),n&&c.removeEventListener("paste",M,!0),WI.restoreFocusFromElement(c)}function S(){this.tagName==="INPUT"&&this.type==="text"?this.value=a:this.textContent=a,w.call(this),i(this,s)}function E(){w.call(this),t(this,b(this),a,s,d)}function k(V){var H=V.metaKey&&!V.shiftKey&&!V.ctrlKey&&!V.altKey;if(isEnterKey(V)&&(!e.multiline||H))return"commit";if(V.keyCode===WI.KeyboardShortcut.Key.Escape.keyCode||V.keyIdentifier==="U+001B")return"cancel";if(V.keyIdentifier==="U+0009")return"move-"+(V.shiftKey?"backward":"forward");if(V.altKey){if(V.keyIdentifier==="Up"||V.keyIdentifier==="Down")return"modify-"+(V.keyIdentifier==="Up"?"up":"down");if(V.keyIdentifier==="PageUp"||V.keyIdentifier==="PageDown")return"modify-"+(V.keyIdentifier==="PageUp"?"up-big":"down-big")}}function R(V,H){if(V==="commit")E.call(c),H.preventDefault(),H.stopPropagation();else if(V==="cancel")S.call(c),H.preventDefault(),H.stopPropagation();else if(V&&V.startsWith("move-"))d=V.substring(5),H.keyIdentifier!=="U+0009"&&_();else if(V&&V.startsWith("modify-")){let O=V.substring(7),z=O.startsWith("up")?1:-1;if(O.endsWith("big")&&(z*=10),H.shiftKey?z*=10:H.ctrlKey&&(z/=10),!WI.incrementElementValue(c,z))return;typeof e.numberCommitHandler=="function"&&e.numberCommitHandler(c,b(c),a,s,d),H.preventDefault()}}function M(V){var H=n(V);R(H,V)}function L(V){var H=e.customFinishHandler||k,O=H(V);R(O,V)}return c.addEventListener("blur",_,!1),c.addEventListener("keydown",L,!0),n&&c.addEventListener("paste",M,!0),c.focus(),{cancel:S.bind(c),commit:E.bind(c)}};WI.incrementElementValue=function(c,e){let t=c.ownerDocument.defaultView.getSelection();if(!t.rangeCount)return!1;let i=t.getRangeAt(0);if(!c.contains(i.commonAncestorContainer))return!1;let n=i.startContainer.rangeOfWord(i.startOffset,WI.EditingSupport.StyleValueDelimiters,c),s=n.toString(),a="",d="",p=/[^\d-\.]+/.exec(s);if(p){let E=p.index+p[0].length;i.startOffset>n.startOffset+p.index&&E<s.length&&i.startOffset!==n.startOffset?(a=s.substring(0,E),s=s.substring(E)):(d=s.substring(p.index),s=s.substring(0,p.index))}let f=WI.EditingSupport.CSSNumberRegex.exec(s);if(!f||f.length!==4)return!1;let _=f[1]+Math.round((parseFloat(f[2])+e)*100)/100+f[3];t.removeAllRanges(),t.addRange(n),document.execCommand("insertText",!1,a+_+d);let b=i.commonAncestorContainer,w=i.startOffset;if(b.parentNode.classList.contains("editing")&&b.nextSibling&&(b=b.nextSibling.firstChild,w=0),w+=a.length,!b)return!1;let S=document.createRange();return S.setStart(b,w),S.setEnd(b,w+_.length),t.removeAllRanges(),t.addRange(S),!0};WI.EditingSupport={StyleValueDelimiters:` \xA0	
"':;,/()`,CSSNumberRegex:/(.*?)(-?(?:\d+(?:\.\d+)?|\.\d+))(.*)/,NumberRegex:/^(-?(?:\d+(?:\.\d+)?|\.\d+))$/};WI.ErrorObjectView=class extends WI.Object{constructor(e){super(),console.assert(e instanceof WI.RemoteObject&&e.subtype==="error",e),this._object=e,this._expanded=!1,this._hasStackTrace=!1,this._element=document.createElement("div"),this._element.classList.add("error-object");var t=WI.FormattedValue.createElementForError(this._object);this._element.append(t),t.addEventListener("click",this._handlePreviewOrTitleElementClick.bind(this)),this._outlineElement=this._element.appendChild(document.createElement("div")),this._outlineElement.className="content"}static makeSourceLinkWithPrefix(e,t,i){if(!e)return null;var n=document.createElement("span");n.classList.add("error-object-link-container"),n.textContent=` ${emDash} `;const s={ignoreNetworkTab:!0,ignoreSearchTab:!0};let a=WI.linkifyLocation(e,new WI.SourceCodePosition(parseInt(t)-1,parseInt(i)),s);return a.classList.add("error-object-link"),n.appendChild(a),n}get object(){return this._object}get element(){return this._element}get expanded(){return this._expanded}update(){if(this._hasStackTrace)return;const e={ownProperties:!0,generatePreview:!0};this._object.getPropertyDescriptors(t=>{if(!t||this._hasStackTrace)return;let i=t.find(n=>n.name==="stack");console.assert(i),i&&(this._buildStackTrace(i.value.value),this._hasStackTrace=!0)},e)}expand(){this._expanded||(this._expanded=!0,this._element.classList.add("expanded"),this.update())}collapse(){!this._expanded||(this._expanded=!1,this._element.classList.remove("expanded"))}appendTitleSuffix(e){this._element.insertBefore(e,this._outlineElement)}_handlePreviewOrTitleElementClick(e){this._expanded?this.collapse():this.expand(),e.stopPropagation()}_buildStackTrace(e){let t=WI.StackTrace.fromString(this._object.target,e),i=new WI.StackTraceView(t).element;this._outlineElement.appendChild(i)}};WI.EventBreakpointPopover=class extends WI.Popover{constructor(e){super(e),this._breakpoint=null,this._currentCompletions=[],this._suggestionsView=new WI.CompletionSuggestionsView(this,{preventBlur:!0}),this._targetElement=null,this._preferredEdges=null,this.windowResizeHandler=this._presentOverTargetElement.bind(this)}get breakpoint(){return this._breakpoint}show(e,t){this._targetElement=e,this._preferredEdges=t;let i=document.createElement("div");i.classList.add("event-breakpoint-content");let n=i.appendChild(document.createElement("div"));n.classList.add("label"),n.textContent=WI.UIString("Break on events with name:");let s=i.appendChild(document.createElement("div"));s.classList.add("event-type"),this._typeSelectElement=s.appendChild(document.createElement("select")),this._typeSelectElement.addEventListener("change",this._handleTypeSelectChange.bind(this)),this._typeSelectElement.addEventListener("keydown",d=>{isEnterKey(d)&&this.dismiss()});let a=(d,p)=>{let f=this._typeSelectElement.appendChild(document.createElement("option"));f.value=p,f.textContent=d};a(WI.UIString("DOM Event"),WI.EventBreakpoint.Type.Listener),WI.DOMDebuggerManager.supportsEventBreakpoints()?(a(WI.unlocalizedString("requestAnimationFrame"),"requestAnimationFrame"),a(WI.unlocalizedString("setTimeout"),"setTimeout"),a(WI.unlocalizedString("setInterval"),"setInterval")):this._typeSelectElement.hidden=!0,this._domEventNameInputElement=s.appendChild(document.createElement("input")),this._domEventNameInputElement.setAttribute("dir","ltr"),this._domEventNameInputElement.placeholder=WI.UIString("Example: \u201C%s\u201D").format("click"),this._domEventNameInputElement.spellcheck=!1,this._domEventNameInputElement.addEventListener("keydown",d=>{isEnterKey(d)||d.key==="Tab"?(this._result=WI.InputPopover.Result.Committed,this._suggestionsView.visible&&this._suggestionsView.selectedIndex<this._currentCompletions.length&&(this._domEventNameInputElement.value=this._currentCompletions[this._suggestionsView.selectedIndex]),this.dismiss()):(d.key==="ArrowUp"||d.key==="ArrowDown")&&this._suggestionsView.visible&&(d.stop(),d.key==="ArrowDown"?this._suggestionsView.selectNext():this._suggestionsView.selectPrevious())}),this._domEventNameInputElement.addEventListener("input",d=>{WI.domManager.getSupportedEventNames().then(p=>{this._currentCompletions=[];for(let f of p)f.toLowerCase().startsWith(this._domEventNameInputElement.value.toLowerCase())&&this._currentCompletions.push(f);if(!this._currentCompletions.length){this._suggestionsView.hide();return}this._suggestionsView.update(this._currentCompletions),this._showSuggestionsView()})}),this.content=i,this._presentOverTargetElement(),this._typeSelectElement.value=WI.EventBreakpoint.Type.Listener,this._domEventNameInputElement.select()}dismiss(){let e=this._typeSelectElement.value,t=null;e===WI.EventBreakpoint.Type.Listener?t=this._domEventNameInputElement.value:(t=e,t==="requestAnimationFrame"?e=WI.EventBreakpoint.Type.AnimationFrame:(t==="setTimeout"||t==="setInterval")&&(e=WI.EventBreakpoint.Type.Timer)),e&&t&&(this._breakpoint=new WI.EventBreakpoint(e,t)),super.dismiss(),this._suggestionsView.hide()}completionSuggestionsClickedCompletion(e,t){this._domEventNameInputElement.value=t,this.dismiss()}_presentOverTargetElement(){if(!this._targetElement)return;let e=WI.Rect.rectFromClientRect(this._targetElement.getBoundingClientRect());this.present(e,this._preferredEdges)}_handleTypeSelectChange(e){let t=this._typeSelectElement.value===WI.EventBreakpoint.Type.Listener;this._domEventNameInputElement.hidden=!t,this.update(),t?(this._domEventNameInputElement.focus(),this._domEventNameInputElement.value&&this._showSuggestionsView()):this._suggestionsView.hide()}_showSuggestionsView(){let e=window.getComputedStyle(this._domEventNameInputElement),t=parseInt(e.borderLeftWidth)+parseInt(e.paddingLeft),i=WI.Rect.rectFromClientRect(this._domEventNameInputElement.getBoundingClientRect());i.origin.x+=t,i.size.width-=t+parseInt(e.borderRightWidth)+parseInt(e.paddingRight),this._suggestionsView.show(i)}};WI.EventBreakpointTreeElement=class extends WI.GeneralTreeElement{constructor(e,{className:t,title:i}={}){console.assert(e instanceof WI.EventBreakpoint);let n=["breakpoint","event",`breakpoint-for-${e.type}`];t&&n.push(t),i||(i=e.eventName);const s=null;super(n,i,s,e),this.status=WI.ImageUtilities.useSVGSymbol("data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2019 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 23 12'%3e %3cpolygon points='0.5 0.5 17.355 0.5 21.904 6 17.355 11.5 0.5 11.5 0.5 0.5'/%3e %3c/svg%3e"),this.status.className=WI.BreakpointTreeElement.StatusImageElementStyleClassName,this.tooltipHandledSeparately=!0}onattach(){super.onattach(),this.representedObject.addEventListener(WI.EventBreakpoint.Event.DisabledStateChanged,this._updateStatus,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.BreakpointsEnabledDidChange,this._updateStatus,this),this._boundStatusImageElementClicked=this._statusImageElementClicked.bind(this),this._boundStatusImageElementFocused=this._statusImageElementFocused.bind(this),this._boundStatusImageElementMouseDown=this._statusImageElementMouseDown.bind(this),this.status.addEventListener("click",this._boundStatusImageElementClicked),this.status.addEventListener("focus",this._boundStatusImageElementFocused),this.status.addEventListener("mousedown",this._boundStatusImageElementMouseDown),this._updateStatus()}ondetach(){super.ondetach(),this.representedObject.removeEventListener(null,null,this),WI.debuggerManager.removeEventListener(null,null,this),this.status.removeEventListener("click",this._boundStatusImageElementClicked),this.status.removeEventListener("focus",this._boundStatusImageElementFocused),this.status.removeEventListener("mousedown",this._boundStatusImageElementMouseDown),this._boundStatusImageElementClicked=null,this._boundStatusImageElementFocused=null,this._boundStatusImageElementMouseDown=null}ondelete(){return this.__deletedViaDeleteKeyboardShortcut=!0,this.representedObject.eventListener?WI.domManager.removeBreakpointForEventListener(this.representedObject.eventListener):WI.domDebuggerManager.removeEventBreakpoint(this.representedObject),!0}onenter(){return this._toggleBreakpoint(),!0}onspace(){return this._toggleBreakpoint(),!0}populateContextMenu(e,t){let i=this.representedObject,n=i.disabled?WI.UIString("Enable Breakpoint"):WI.UIString("Disable Breakpoint");e.appendItem(n,this._toggleBreakpoint.bind(this)),e.appendItem(WI.UIString("Delete Breakpoint"),()=>{i.eventListener?WI.domManager.removeBreakpointForEventListener(i.eventListener):WI.domDebuggerManager.removeEventBreakpoint(i)})}_statusImageElementClicked(e){this._toggleBreakpoint()}_statusImageElementFocused(e){e.stopPropagation()}_statusImageElementMouseDown(e){e.stopPropagation()}_toggleBreakpoint(){this.representedObject.disabled=!this.representedObject.disabled}_updateStatus(){!this.status||(this.status.classList.toggle(WI.BreakpointTreeElement.StatusImageDisabledStyleClassName,this.representedObject.disabled),this.status.classList.toggle(WI.BreakpointTreeElement.StatusImageResolvedStyleClassName,WI.debuggerManager.breakpointsEnabled))}};WI.EventListenerSectionGroup=class extends WI.DetailsSectionGroup{constructor(e,t={}){super(),this._eventListener=e;var i=[];t.hideType||i.push(new WI.DetailsSectionSimpleRow(WI.UIString("Event"),this._eventListener.type)),t.hideTarget||i.push(new WI.DetailsSectionSimpleRow(WI.UIString("Target"),this._targetTextOrLink())),i.push(new WI.DetailsSectionSimpleRow(WI.UIString("Function"),this._functionTextOrLink())),this._eventListener.useCapture?i.push(new WI.DetailsSectionSimpleRow(WI.UIString("Capturing"),WI.UIString("Yes"))):i.push(new WI.DetailsSectionSimpleRow(WI.UIString("Bubbling"),WI.UIString("Yes"))),this._eventListener.isAttribute&&i.push(new WI.DetailsSectionSimpleRow(WI.UIString("Attribute"),WI.UIString("Yes"))),this._eventListener.passive&&i.push(new WI.DetailsSectionSimpleRow(WI.UIString("Passive"),WI.UIString("Yes"))),this._eventListener.once&&i.push(new WI.DetailsSectionSimpleRow(WI.UIString("Once"),WI.UIString("Yes"))),this._eventListener.eventListenerId&&(DOMAgent.setEventListenerDisabled&&i.push(this._createDisabledToggleRow()),DOMAgent.setBreakpointForEventListener&&DOMAgent.removeBreakpointForEventListener&&i.push(this._createBreakpointToggleRow())),this.rows=i}_targetTextOrLink(){if(this._eventListener.onWindow)return WI.unlocalizedString("window");let e=this._eventListener.node;return e?WI.linkifyNodeReference(e):(console.assert(),"")}_functionTextOrLink(){let e=!1,t=this._eventListener.handlerName;if(!t&&this._eventListener.handlerBody){let p=this._eventListener.handlerBody.match(/function ([^\(]+?)\(/);p&&(t=p[1])}if(t||(e=!0,t=WI.UIString("(anonymous function)")),!this._eventListener.location)return t;var i=WI.debuggerManager.scriptForIdentifier(this._eventListener.location.scriptId,WI.mainTarget);if(!i)return t;var n=i.createSourceCodeLocation(this._eventListener.location.lineNumber,this._eventListener.location.columnNumber||0);const s={dontFloat:e,ignoreNetworkTab:!0,ignoreSearchTab:!0};let a=WI.createSourceCodeLocationLink(n,s);if(e)return a;var d=document.createDocumentFragment();return d.append(a,t),d}_createDisabledToggleRow(){let e=document.createElement("input");e.type="checkbox",e.checked=!this._eventListener.disabled;let t=()=>{this._eventListener.disabled?e.title=WI.UIString("Enable Event Listener"):e.title=WI.UIString("Disable Event Listener")};t(),e.addEventListener("change",n=>{this._eventListener.disabled=!e.checked,WI.domManager.setEventListenerDisabled(this._eventListener,this._eventListener.disabled),t()});let i=document.createElement("span");return i.textContent=WI.UIString("Enabled"),i.addEventListener("click",n=>{e.click()}),new WI.DetailsSectionSimpleRow(i,e)}_createBreakpointToggleRow(){let e=document.createElement("input");e.type="checkbox",e.checked=!!this._eventListener.hasBreakpoint;let t=()=>{this._eventListener.hasBreakpoint?e.title=WI.UIString("Delete Breakpoint"):e.title=WI.UIString("Add Breakpoint")};t(),e.addEventListener("change",n=>{this._eventListener.hasBreakpoint=!!e.checked,this._eventListener.hasBreakpoint?WI.domManager.setBreakpointForEventListener(this._eventListener):WI.domManager.removeBreakpointForEventListener(this._eventListener),t()});let i=document.createElement("span");return i.textContent=WI.UIString("Breakpoint"),i.addEventListener("click",n=>{e.click()}),new WI.DetailsSectionSimpleRow(i,e)}};WI.ExpandableView=class{constructor(e,t,i){if(this._element=document.createElement("div"),i){let n=document.createElement("button");n.classList.add("disclosure-button"),n.addEventListener("click",this._onDisclosureButtonClick.bind(this)),this._element.append(n)}this._element.append(t),this._expandedSetting=new WI.Setting("expanded-"+e,!1),i&&(this._element.append(i),this._element.classList.toggle("expanded",this._expandedSetting.value))}get element(){return this._element}_onDisclosureButtonClick(e){let t=!this._expandedSetting.value;this._update(t)}_update(e){this._element.classList.toggle("expanded",e),this._expandedSetting.value=e}};WI.FilterBar=class extends WI.Object{constructor(e){super(),this._element=e||document.createElement("div"),this._element.classList.add("filter-bar"),this._filtersNavigationBar=new WI.NavigationBar,this._element.appendChild(this._filtersNavigationBar.element),this._filterFunctionsMap=new Map,this._inputField=document.createElement("input"),this._inputField.type="search",this._inputField.placeholder=WI.UIString("Filter"),this._inputField.spellcheck=!1,this._inputField.incremental=!0,this._inputField.addEventListener("search",this._handleFilterChanged.bind(this)),this._inputField.addEventListener("input",this._handleFilterInputEvent.bind(this)),this._element.appendChild(this._inputField),this._lastFilterValue=this.filters}get element(){return this._element}get inputField(){return this._inputField}get placeholder(){return this._inputField.placeholder}set placeholder(e){this._inputField.placeholder=e}get incremental(){return this._inputField.incremental}set incremental(e){this._inputField.incremental=e}get filters(){return{text:this._inputField.value,functions:[...this._filterFunctionsMap.values()]}}set filters(e){e=e||{};var t=this._inputField.value;this._inputField.value=e.text||"",t!==this._inputField.value&&this._handleFilterChanged()}get indicatingProgress(){return this._element.classList.contains("indicating-progress")}set indicatingProgress(e){this._element.classList.toggle("indicating-progress",!!e)}get indicatingActive(){return this._element.classList.contains("active")}set indicatingActive(e){this._element.classList.toggle("active",!!e)}clear(){this._filterFunctionsMap.clear(),this.filters=null;for(let e of this._filtersNavigationBar.navigationItems)e instanceof WI.FilterBarButton&&e.toggle(!1);this._inputField.value=null}addFilterBarButton(e,t,i,n,s,a,d,p){var f=new WI.FilterBarButton(e,t,i,n,s,a,d,p);f.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._handleFilterBarButtonClicked,this),f.addEventListener(WI.FilterBarButton.Event.ActivatedStateToggled,this._handleFilterButtonToggled,this),this._filtersNavigationBar.addNavigationItem(f),f.activated&&(this._filterFunctionsMap.set(f.identifier,f.filterFunction),this._handleFilterChanged())}hasActiveFilters(){return!!this._inputField.value||!!this._filterFunctionsMap.size}hasFilterChanged(){var e=this.filters.functions;if(this._lastFilterValue.text!==this._inputField.value||this._lastFilterValue.functions.length!==e.length)return!0;for(var t=0;t<e.length;++t)if(this._lastFilterValue.functions[t]!==e[t])return!0;return!1}_handleFilterBarButtonClicked(e){var t=e.target;t.toggle()}_handleFilterButtonToggled(e){var t=e.target;t.activated?this._filterFunctionsMap.set(t.identifier,t.filterFunction):this._filterFunctionsMap.delete(t.identifier),this._handleFilterChanged()}_handleFilterChanged(){this.hasFilterChanged()&&(this._lastFilterValue=this.filters,this.dispatchEventToListeners(WI.FilterBar.Event.FilterDidChange))}_handleFilterInputEvent(e){this.incremental||this._inputField.value||this._handleFilterChanged()}};WI.FilterBar.Event={FilterDidChange:"filter-bar-text-filter-did-change"};WI.FilterBarButton=class extends WI.ActivateButtonNavigationItem{constructor(e,t,i,n,s,a,d,p,f){super(e,n,s,a,d,p,f),this._filterFunction=t,this._activatedSetting=new WI.Setting(e,i),this.activated=!!this._activatedSetting.value}get filterFunction(){return this._filterFunction}toggle(e){this.activated=e===void 0?!this.activated:e,this._activatedSetting.value=this.activated,this.dispatchEventToListeners(WI.FilterBarButton.Event.ActivatedStateToggled)}};WI.FilterBarButton.Event={ActivatedStateToggled:"filter-bar-activated-state-toggled"};WI.FilterBarNavigationItem=class extends WI.NavigationItem{constructor(){super(),this._filterBar=new WI.FilterBar(this.element)}get filterBar(){return this._filterBar}};WI.FindBanner=class extends WI.NavigationItem{constructor(e,t,i=!1){super(),this._delegate=e||null,this.element.classList.add("find-banner"),t&&this.element.classList.add(t),this._resultCountLabel=document.createElement("label"),this.element.appendChild(this._resultCountLabel),this._inputField=document.createElement("input"),this._inputField.type="search",this._inputField.spellcheck=!1,this._inputField.incremental=!0,this._inputField.setAttribute("results",5),this._inputField.setAttribute("autosave","inspector-search"),this._inputField.addEventListener("keydown",this._inputFieldKeyDown.bind(this),!1),this._inputField.addEventListener("keyup",this._inputFieldKeyUp.bind(this),!1),this._inputField.addEventListener("search",this._inputFieldSearch.bind(this),!1),this.element.appendChild(this._inputField),this._previousResultButton=document.createElement("button"),this._previousResultButton.classList.add("segmented","previous-result"),this._previousResultButton.disabled=!0,this._previousResultButton.title=WI.UIString("Find Previous (%s)").format(WI.findPreviousKeyboardShortcut.displayName),this._previousResultButton.addEventListener("click",this._previousResultButtonClicked.bind(this)),this.element.appendChild(this._previousResultButton);let n=document.createElement("div");n.classList.add(WI.FindBanner.SegmentGlyphStyleClassName),this._previousResultButton.appendChild(n),this._nextResultButton=document.createElement("button"),this._nextResultButton.classList.add("segmented","next-result"),this._nextResultButton.disabled=!0,this._nextResultButton.title=WI.UIString("Find Next (%s)").format(WI.findNextKeyboardShortcut.displayName),this._nextResultButton.addEventListener("click",this._nextResultButtonClicked.bind(this)),this.element.appendChild(this._nextResultButton);let s=document.createElement("div");if(s.classList.add(WI.FindBanner.SegmentGlyphStyleClassName),this._nextResultButton.appendChild(s),i)this._clearAndBlurKeyboardShortcut=new WI.KeyboardShortcut(null,WI.KeyboardShortcut.Key.Escape,this._clearAndBlur.bind(this),this.element);else{let a=document.createElement("button");a.textContent=WI.UIString("Done"),a.addEventListener("click",this._doneButtonClicked.bind(this)),this.element.appendChild(a),this._hideKeyboardShortcut=new WI.KeyboardShortcut(null,WI.KeyboardShortcut.Key.Escape,this.hide.bind(this),this.element)}this._numberOfResults=null,this._searchBackwards=!1,this._searchKeyPressed=!1,this._previousSearchValue=""}get delegate(){return this._delegate}set delegate(e){this._delegate=e||null}get inputField(){return this._inputField}get searchQuery(){return this._inputField.value||""}set searchQuery(e){this._inputField.value=e||""}get numberOfResults(){return this._numberOfResults}set numberOfResults(e){(e===void 0||isNaN(e))&&(e=null),this._numberOfResults=e,this._previousResultButton.disabled=this._nextResultButton.disabled=e<=0,e===null?this._resultCountLabel.textContent="":e<=0?this._resultCountLabel.textContent=WI.UIString("Not found"):e===1?this._resultCountLabel.textContent=WI.UIString("1 match"):e>1&&(this._resultCountLabel.textContent=WI.UIString("%d matches").format(e))}get targetElement(){return this._targetElement}set targetElement(e){function t(){i.classList.remove(WI.FindBanner.NoTransitionStyleClassName),this.element.classList.remove(WI.FindBanner.NoTransitionStyleClassName)}if(this._targetElement){var i=this._targetElement;this._targetElement.classList.add(WI.FindBanner.NoTransitionStyleClassName),this._targetElement.classList.remove(WI.FindBanner.SupportsFindBannerStyleClassName),this._targetElement.classList.remove(WI.FindBanner.ShowingFindBannerStyleClassName),this.element.classList.add(WI.FindBanner.NoTransitionStyleClassName),this.element.classList.remove(WI.FindBanner.ShowingStyleClassName),setTimeout(t.bind(this),0)}this._targetElement=e||null,this._targetElement&&this._targetElement.classList.add(WI.FindBanner.SupportsFindBannerStyleClassName)}get showing(){return this.element.classList.contains(WI.FindBanner.ShowingStyleClassName)}focus(){this._inputField.value.length?this._inputField.select():this._inputField.focus()}_clearAndBlur(){this.numberOfResults=null,this._inputField.value="",this._previousSearchValue="",this._delegate.findBannerSearchCleared&&this._delegate.findBannerSearchCleared(),this._delegate.findBannerWantsToClearAndBlur&&this._delegate.findBannerWantsToClearAndBlur()}show(){if(console.assert(this._targetElement),!this._targetElement||(console.assert(this._targetElement.parentNode),!this._targetElement.parentNode))return;this.element.parentNode!==this._targetElement.parentNode&&this._targetElement.parentNode.insertBefore(this.element,this._targetElement);function e(){this._targetElement.classList.add(WI.FindBanner.ShowingFindBannerStyleClassName),this.element.classList.add(WI.FindBanner.ShowingStyleClassName),this._inputField.select()}setTimeout(e.bind(this),0),this.dispatchEventToListeners(WI.FindBanner.Event.DidShow)}hide(){console.assert(this._targetElement),this._targetElement&&(this._inputField.blur(),this._targetElement.classList.remove(WI.FindBanner.ShowingFindBannerStyleClassName),this.element.classList.remove(WI.FindBanner.ShowingStyleClassName),this.dispatchEventToListeners(WI.FindBanner.Event.DidHide))}_inputFieldKeyDown(e){e.keyIdentifier==="Shift"?this._searchBackwards=!0:e.keyIdentifier==="Enter"&&(this._searchKeyPressed=!0)}_inputFieldKeyUp(e){e.keyIdentifier==="Shift"?this._searchBackwards=!1:e.keyIdentifier==="Enter"&&(this._searchKeyPressed=!1)}_inputFieldSearch(e){this._inputField.value?this._previousSearchValue!==this.searchQuery?this._delegate&&typeof this._delegate.findBannerPerformSearch=="function"&&this._delegate.findBannerPerformSearch(this,this.searchQuery):this._searchKeyPressed&&this._numberOfResults>0&&(this._searchBackwards?this._delegate&&typeof this._delegate.findBannerRevealPreviousResult=="function"&&this._delegate.findBannerRevealPreviousResult(this):this._delegate&&typeof this._delegate.findBannerRevealNextResult=="function"&&this._delegate.findBannerRevealNextResult(this)):(this.numberOfResults=null,this._delegate&&typeof this._delegate.findBannerSearchCleared=="function"&&this._delegate.findBannerSearchCleared(this)),this._previousSearchValue=this.searchQuery}_previousResultButtonClicked(e){this._delegate&&typeof this._delegate.findBannerRevealPreviousResult=="function"&&this._delegate.findBannerRevealPreviousResult(this)}_nextResultButtonClicked(e){this._delegate&&typeof this._delegate.findBannerRevealNextResult=="function"&&this._delegate.findBannerRevealNextResult(this)}_doneButtonClicked(e){this.hide()}};WI.FindBanner.SupportsFindBannerStyleClassName="supports-find-banner";WI.FindBanner.ShowingFindBannerStyleClassName="showing-find-banner";WI.FindBanner.NoTransitionStyleClassName="no-find-banner-transition";WI.FindBanner.ShowingStyleClassName="showing";WI.FindBanner.SegmentGlyphStyleClassName="glyph";WI.FindBanner.Event={DidShow:"find-banner-did-show",DidHide:"find-banner-did-hide"};WI.FlexibleSpaceNavigationItem=class extends WI.NavigationItem{constructor(e,t){super(),console.assert(!e||e instanceof WI.NavigationItem),this._navigationItem=e||null,this._navigationItem&&(this._navigationItem=e,this.element.classList.add(t||WI.FlexibleSpaceNavigationItem.Align.Start))}get additionalClassNames(){return["flexible-space"]}updateLayout(e){if(super.updateLayout(e),!!this._navigationItem&&e){let t=this.width;if(!t)return;this.element.appendChild(this._navigationItem.element),this._navigationItem.updateLayout(!0);let i=this._navigationItem.width;t-i<=0&&this.element.removeChild(this._navigationItem.element)}}};WI.FlexibleSpaceNavigationItem.Align={Start:"align-start",End:"align-end"};WI.FontResourceContentView=class extends WI.ResourceContentView{constructor(e){super(e,"font"),this._styleElement=null,this._previewElement=null}get previewElement(){return this._previewElement}sizeToFit(){if(!!this._previewElement)for(var e=WI.FontResourceContentView.MaximumFontSize;e>=WI.FontResourceContentView.MinimumFontSize&&(this._previewElement.style.fontSize=e+"px",!(this._previewElement.offsetWidth<=this.element.offsetWidth));e-=5);}contentAvailable(e,t){if(this._fontObjectURL=this.resource.createObjectURL(),!this._fontObjectURL){this.showGenericErrorMessage();return}const i="WebInspectorFontPreview"+ ++WI.FontResourceContentView._uniqueFontIdentifier;var n="";this.resource.mimeTypeComponents.type==="image/svg+xml"&&(n=' format("svg")'),this._styleElement&&this._styleElement.parentNode&&this._styleElement.parentNode.removeChild(this._styleElement),this.removeLoadingIndicator(),this._styleElement=document.createElement("style"),this._styleElement.textContent='@font-face { font-family: "'+i+'"; src: url('+this._fontObjectURL+")"+n+"; }",this.visible&&document.head.appendChild(this._styleElement),this._previewElement=document.createElement("div"),this._previewElement.className="preview",this._previewElement.style.fontFamily=i;function s(_){var b=document.createElement("div");return b.className="metric "+_,b}for(var a=WI.FontResourceContentView.PreviewLines,d=0;d<a.length;++d){var p=document.createElement("div");p.className="line",p.appendChild(s("top")),p.appendChild(s("xheight")),p.appendChild(s("middle")),p.appendChild(s("baseline")),p.appendChild(s("bottom"));var f=document.createElement("div");f.className="content",f.textContent=a[d],p.appendChild(f),this._previewElement.appendChild(p)}this.element.appendChild(this._previewElement),this.sizeToFit()}shown(){this._styleElement&&document.head.appendChild(this._styleElement)}hidden(){this._styleElement&&this._styleElement.parentNode&&this._styleElement.parentNode.removeChild(this._styleElement)}closed(){this._fontObjectURL&&URL.revokeObjectURL(this._fontObjectURL)}layout(){this.sizeToFit()}};WI.FontResourceContentView._uniqueFontIdentifier=0;WI.FontResourceContentView.PreviewLines=["ABCDEFGHIJKLM","NOPQRSTUVWXYZ","abcdefghijklm","nopqrstuvwxyz","1234567890"];WI.FontResourceContentView.MaximumFontSize=72;WI.FontResourceContentView.MinimumFontSize=12;WI.FormattedValue={};WI.FormattedValue.hasSimpleDisplay=function(c){switch(c.type){case"boolean":case"number":case"string":case"symbol":case"undefined":return!0;case"function":return!1;case"object":var e=c.subtype;return e==="null"||e==="regexp"||e==="date"}return console.assert(!1,"All RemoteObject types should be handled above"),!1};WI.FormattedValue.classNameForTypes=function(c,e){return"formatted-"+(e||c)};WI.FormattedValue.classNameForObject=function(c){return WI.FormattedValue.classNameForTypes(c.type,c.subtype)};WI.FormattedValue.createLinkifiedElementString=function(c){var e=document.createElement("span");return e.className="formatted-string",e.append('"',WI.linkifyStringAsFragment(c.replace(/\\/g,"\\\\").replace(/"/g,'\\"')),'"'),e};WI.FormattedValue.createElementForNode=function(c){var e=document.createElement("span");return e.className="formatted-node",c.pushNodeToFrontend(function(t){if(!t){e.textContent=c.description;return}var i=new WI.DOMTreeOutline;i.setVisible(!0),i.rootDOMNode=WI.domManager.nodeForId(t),i.children[0].hasChildren||i.element.classList.add("single-node"),e.appendChild(i.element)}),e};WI.FormattedValue.createElementForError=function(c){var e=document.createElement("span");if(e.classList.add("formatted-error"),e.textContent=c.description,!c.preview)return e;function t(s){var a={};for(var d of s.propertyPreviews)a[d.name]=d.value;return a}var i=t(c.preview);if(!i.sourceURL)return e;var n=WI.ErrorObjectView.makeSourceLinkWithPrefix(i.sourceURL,i.line,i.column);return e.append(n),e};WI.FormattedValue.createElementForNodePreview=function(c,{remoteObjectAccessor:e}={}){var t=c.value||c.description,i=document.createElement("span");if(i.className="formatted-node-preview syntax-highlighted",e){let w=null;i.addEventListener("mouseenter",S=>{if(w){WI.domManager.highlightDOMNode(w.id,"all");return}e(E=>{E.pushNodeToFrontend(k=>{w=WI.domManager.nodeForId(k),w&&WI.domManager.highlightDOMNode(w.id,"all")})})}),i.addEventListener("mouseleave",S=>{WI.domManager.hideDOMNodeHighlight()}),i.addEventListener("contextmenu",S=>{if(!w)return;let E=WI.ContextMenu.createFromEvent(S);WI.appendContextMenuItemsForDOMNode(E,w)})}if(t.startsWith("<!--")){var n=i.appendChild(document.createElement("span"));return n.className="html-comment",n.textContent=t,i}if(t.startsWith("<!DOCTYPE")){var s=i.appendChild(document.createElement("span"));return s.className="html-doctype",s.textContent=t,i}var a=t.match(/^<(\S+?)(?: (\S+?)="(.*?)")?>$/);if(!a)return console.assert(!t.startsWith("<"),"Unexpected node preview format: "+t),i.textContent=t,i;var d=document.createElement("span");d.className="html-tag",d.append("<");var p=d.appendChild(document.createElement("span"));if(p.className="html-tag-name",p.textContent=a[1],a[2]){d.append(" ");var f=d.appendChild(document.createElement("span"));f.className="html-attribute";var _=f.appendChild(document.createElement("span"));_.className="html-attribute-name",_.textContent=a[2],f.append('="');var b=f.appendChild(document.createElement("span"));b.className="html-attribute-value",b.textContent=a[3],f.append('"')}return d.append(">"),i.appendChild(d),i};WI.FormattedValue.createElementForFunctionWithName=function(c){var e=document.createElement("span");return e.classList.add("formatted-function"),e.textContent=c.substring(0,c.indexOf("(")),e};WI.FormattedValue.createElementForTypesAndValue=function(c,e,t,i,n,s){var a=document.createElement("span");if(a.classList.add(WI.FormattedValue.classNameForTypes(c,e)),s)return a.textContent="[Exception: "+t+"]",a;if(c==="string")return t=t.truncate(WI.FormattedValue.MAX_PREVIEW_STRING_LENGTH),a.textContent=doubleQuotedString(t.replace(/\n/g,"\u21B5")),a;if(c==="function")return e==="class"?a.textContent=t:a.textContent=n?"function":t,a;if(a.textContent=t,i!==void 0&&(e==="array"||e==="set"||e==="map"||e==="weakmap"||e==="weakset")){var d=a.appendChild(document.createElement("span"));d.className="size",d.textContent=" ("+i+")"}return a};WI.FormattedValue.createElementForRemoteObject=function(c,e){return WI.FormattedValue.createElementForTypesAndValue(c.type,c.subtype,c.description,c.size,!1,e)};WI.FormattedValue.createElementForObjectPreview=function(c){return WI.FormattedValue.createElementForTypesAndValue(c.type,c.subtype,c.description,c.size,!0,!1)};WI.FormattedValue.createElementForPropertyPreview=function(c){return WI.FormattedValue.createElementForTypesAndValue(c.type,c.subtype,c.value,void 0,!0,!1)};WI.FormattedValue.createObjectPreviewOrFormattedValueForObjectPreview=function(c,e){if(c.subtype==="node")return WI.FormattedValue.createElementForNodePreview(c);if(c.type==="function")return WI.FormattedValue.createElementForFunctionWithName(c.description);const t=null;return new WI.ObjectPreviewView(t,c,e).element};WI.FormattedValue.createObjectPreviewOrFormattedValueForRemoteObject=function(c,e){return c.subtype==="node"?WI.FormattedValue.createElementForNode(c):c.subtype==="error"?WI.FormattedValue.createElementForError(c):c.preview?new WI.ObjectPreviewView(c,c.preview,e):WI.FormattedValue.createElementForRemoteObject(c)};WI.FormattedValue.createObjectTreeOrFormattedValueForRemoteObject=function(c,e,t){if(c.subtype==="node")return WI.FormattedValue.createElementForNode(c);if(c.subtype==="null")return WI.FormattedValue.createElementForRemoteObject(c);if(c.type==="object"||c.subtype==="class"){var i=new WI.ObjectTreeView(c,null,e,t);return i.element}return WI.FormattedValue.createElementForRemoteObject(c)};WI.FormattedValue.MAX_PREVIEW_STRING_LENGTH=140;WI.FrameDOMTreeContentView=class extends WI.DOMTreeContentView{constructor(e){console.assert(e instanceof WI.DOMTree,e),super(e),this._domTree=e,this._domTree.addEventListener(WI.DOMTree.Event.RootDOMNodeInvalidated,this._rootDOMNodeInvalidated,this),this._requestRootDOMNode()}get domTree(){return this._domTree}closed(){this._domTree.removeEventListener(null,null,this),super.closed()}getSearchContextNodes(e){this._domTree.requestRootDOMNode(function(t){e([t.id])})}_rootDOMNodeAvailable(e){if(this.domTreeOutline.rootDOMNode=e,!e){this.domTreeOutline.selectDOMNode(null,!1);return}this._restoreBreakpointsAfterUpdate(),this._restoreSelectedNodeAfterUpdate(this._domTree.frame.url,e.body||e.documentElement||e.firstChild)}_rootDOMNodeInvalidated(e){this._requestRootDOMNode()}_requestRootDOMNode(){this._domTree.requestRootDOMNode(this._rootDOMNodeAvailable.bind(this))}};WI.FrameTreeElement=class extends WI.ResourceTreeElement{constructor(e){console.assert(e instanceof WI.Frame),super(e.mainResource,e),this._frame=e,this._updateExpandedSetting(),e.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this),e.addEventListener(WI.Frame.Event.ResourceWasAdded,this._resourceWasAdded,this),e.addEventListener(WI.Frame.Event.ResourceWasRemoved,this._resourceWasRemoved,this),e.addEventListener(WI.Frame.Event.ExtraScriptAdded,this._extraScriptAdded,this),e.addEventListener(WI.Frame.Event.ChildFrameWasAdded,this._childFrameWasAdded,this),e.addEventListener(WI.Frame.Event.ChildFrameWasRemoved,this._childFrameWasRemoved,this),this.shouldRefreshChildren=!0,this.folderSettingsKey=this._frame.url.hash,this.registerFolderizeSettings("frames",WI.UIString("Frames"),this._frame.childFrameCollection,WI.FrameTreeElement),this.registerFolderizeSettings("extra-scripts",WI.UIString("Extra Scripts"),this._frame.extraScriptCollection,WI.ScriptTreeElement);function t(i,...n){return i instanceof WI.CSSStyleSheet?new WI.CSSStyleSheetTreeElement(i,...n):new WI.ResourceTreeElement(i,...n)}for(let[i,n]of Object.entries(WI.Resource.Type)){let s=WI.Resource.displayNameForType(n,!0),a=t;n===WI.Resource.Type.WebSocket&&(a=WI.WebSocketResourceTreeElement),this.registerFolderizeSettings(i,s,this._frame.resourceCollectionForType(n),a)}this.updateParentStatus()}get frame(){return this._frame}descendantResourceTreeElementTypeDidChange(e,t){this._addTreeElement(e)}descendantResourceTreeElementMainTitleDidChange(e,t){this._addTreeElement(e)}updateSourceMapResources(){!this.treeOutline||!this.treeOutline.includeSourceMapResourceChildren||!this._frame||(this.updateParentStatus(),this.resource&&this.resource.sourceMaps.length&&(this.shouldRefreshChildren=!0))}onattach(){WI.GeneralTreeElement.prototype.onattach.call(this),WI.cssManager.addEventListener(WI.CSSManager.Event.StyleSheetAdded,this._styleSheetAdded,this)}ondetach(){WI.cssManager.removeEventListener(WI.CSSManager.Event.StyleSheetAdded,this._styleSheetAdded,this),super.ondetach()}compareChildTreeElements(e,t){if(e===t)return 0;var i=e instanceof WI.ResourceTreeElement,n=t instanceof WI.ResourceTreeElement;return i&&n?WI.ResourceTreeElement.compareResourceTreeElements(e,t):!i&&!n?super.compareChildTreeElements(e,t):i?1:-1}onpopulate(){if(this.children.length&&!this.shouldRefreshChildren)return;this.shouldRefreshChildren=!1,this.removeChildren(),this.updateParentStatus(),this.prepareToPopulate();for(let a of this._frame.childFrameCollection)this.addChildForRepresentedObject(a);for(let a of this._frame.resourceCollection)this.addChildForRepresentedObject(a);for(var e=this.resource&&this.resource.sourceMaps,t=0;t<e.length;++t)for(var i=e[t],n=0;n<i.resources.length;++n)this.addChildForRepresentedObject(i.resources[n]);for(let a of this._frame.extraScriptCollection)(a.sourceURL||a.sourceMappingURL)&&this.addChildForRepresentedObject(a);const s=!0;WI.cssManager.preferredInspectorStyleSheetForFrame(this._frame,this.addRepresentedObjectToNewChildQueue.bind(this),s)}onexpand(){this._expandedSetting.value=!0}oncollapse(){this.hasChildren&&(this._expandedSetting.value=!1)}get mainTitleText(){return this.resource.parentFrame.name?WI.UIString("%s (%s)").format(this.resource.parentFrame.name,super.mainTitleText):super.mainTitleText}_updateExpandedSetting(){this._expandedSetting=new WI.Setting("frame-expanded-"+this._frame.url.hash,!!this._frame.isMainFrame()),this._expandedSetting.value?this.expand():this.collapse()}_mainResourceDidChange(e){this._updateResource(this._frame.mainResource),this.updateParentStatus(),this.removeChildren(),this._updateExpandedSetting(),this.shouldRefreshChildren=!0}_resourceWasAdded(e){this.addRepresentedObjectToNewChildQueue(e.data.resource)}_resourceWasRemoved(e){this.removeChildForRepresentedObject(e.data.resource)}_extraScriptAdded(e){let t=e.data.script;(t.sourceURL||t.sourceMappingURL)&&this.addRepresentedObjectToNewChildQueue(t)}_childFrameWasAdded(e){this.addRepresentedObjectToNewChildQueue(e.data.childFrame)}_childFrameWasRemoved(e){this.removeChildForRepresentedObject(e.data.childFrame)}_styleSheetAdded(e){!e.data.styleSheet.isInspectorStyleSheet()||this.addRepresentedObjectToNewChildQueue(e.data.styleSheet)}};WI.GaugeChart=class extends WI.View{constructor({height:e,strokeWidth:t,segments:i}){super(),t=t||10,this._needleValue=null;const n=10,s=8;this._center=e-s,this._radius=e-s-n-1,this._innerRadius=Math.floor(this._radius-t);let a=(this._radius+n+1)*2;this._size=new WI.Size(a,e),console.assert(!this._segments,"Set segments only once"),console.assert(i.length>=1,"Need at least one segment"),console.assert(this._validateSegments(i)),this._segments=i,this.element.classList.add("gauge-chart"),this._chartElement=this.element.appendChild(createSVGElement("svg")),this._chartElement.setAttribute("width",a),this._chartElement.setAttribute("height",e),this._chartElement.setAttribute("viewBox",`0 0 ${a} ${e}`),this._needleElement=null}get size(){return this._size}get segments(){return this._segments}get value(){return this._needleValue}set value(e){console.assert(e>=0&&e<=100,"value should be between 0 and 100.",e),this._needleValue=e}clear(){this._needleValue=null}initialLayout(){super.initialLayout();let e=Math.PI;const t=Math.PI/100;for(let{className:p,limit:f}of this._segments){let b=Math.PI+(f-(f===100?0:1))/100*Math.PI,w=this._chartElement.appendChild(createSVGElement("path"));w.classList.add("segment",p),w.setAttribute("d",this._createSegmentPathData(this._center,e,b,this._radius,this._innerRadius)),e=b+t}const i=.5,n=4.5,s=6;let a=this.size.width/2,d=this._center;this._needleElement=this._chartElement.appendChild(createSVGElement("polygon")),this._needleElement.classList.add("needle"),this._needleElement.setAttribute("points",`0,${d+i}, 0,${d-i} ${a+s},${d-n} ${a+s},${d+n}`),this._needleElement.style.transformOrigin=`${a}px ${d}px`}layout(){if(super.layout(),this.layoutReason===WI.View.LayoutReason.Resize)return;let e=this._needleValue===null;this.element.classList.toggle("empty",e);let i=180*((e?0:this._needleValue)/100);this._needleElement.style.transform=`rotate(${i}deg)`}_validateSegments(e){let t=-1;for(let{className:i,limit:n}of e)console.assert(n>=1&&n<=100,"limit should be between 1 and 100",n),console.assert(n>=t+1,"limits should always increase between segments"),t=n;return!0}_createSegmentPathData(e,t,i,n,s){let d=s-7,p=Math.PI/100,f=(i-t)%(Math.PI*2)>Math.PI?1:0,_=e+Math.cos(t)*n,b=e+Math.sin(t)*n,w=e+Math.cos(i)*n,S=e+Math.sin(i)*n,E=e+Math.cos(i)*s,k=e+Math.sin(i)*s,R=e+Math.cos(t+p)*s,M=e+Math.sin(t+p)*s,L=e+Math.cos(t+p)*d,V=e+Math.sin(t+p)*d,H=e+Math.cos(t)*d,O=e+Math.sin(t)*d;return["M",_,b,"A",n,n,0,f,1,w,S,"L",E,k,"A",s,s,0,f,0,R,M,"L",L,V,"A",d,d,0,f,0,H,O,"Z"].join(" ")}};WI.GeneralTreeElementPathComponent=class extends WI.HierarchicalPathComponent{constructor(e){super(e.mainTitle,e.classNames,e.representedObject),this._generalTreeElement=e,this._generalTreeElement.addEventListener(WI.GeneralTreeElement.Event.MainTitleDidChange,this._mainTitleDidChange,this)}get generalTreeElement(){return this._generalTreeElement}get previousSibling(){let e=this._generalTreeElement.previousSibling;for(;e&&e.hidden;)e=e.previousSibling;return e?new WI.GeneralTreeElementPathComponent(e):null}get nextSibling(){let e=this._generalTreeElement.nextSibling;for(;e&&e.hidden;)e=e.nextSibling;return e?new WI.GeneralTreeElementPathComponent(e):null}_mainTitleDidChange(e){this.displayName=this._generalTreeElement.mainTitle}};WI.GenericResourceContentView=class extends WI.ResourceContentView{constructor(e){super(e,"generic")}};WI.GoToLineDialog=class extends WI.Dialog{constructor(e){super(e),this.element.classList.add("go-to-line-dialog");let t=this.element.appendChild(document.createElement("div"));this._input=t.appendChild(document.createElement("input")),this._input.type="text",this._input.placeholder=WI.UIString("Line Number"),this._input.spellcheck=!1,this._clearIcon=t.appendChild(document.createElement("img")),this._input.addEventListener("input",this),this._input.addEventListener("keydown",this),this._input.addEventListener("blur",this),this._clearIcon.addEventListener("mousedown",this),this._clearIcon.addEventListener("click",this),this._dismissing=!1}handleEvent(e){switch(e.type){case"input":this._handleInputEvent(e);break;case"keydown":this._handleKeydownEvent(e);break;case"blur":this._handleBlurEvent(e);break;case"mousedown":this._handleMousedownEvent(e);break;case"click":this._handleClickEvent(e);break}}didPresentDialog(){this._input.focus(),this._clear()}_handleInputEvent(e){let t=this._input.value!=="";this.element.classList.toggle(WI.GoToLineDialog.NonEmptyClassName,t)}_handleKeydownEvent(e){if(e.keyCode===WI.KeyboardShortcut.Key.Escape.keyCode)this._input.value===""?(this.dismiss(),e.preventDefault()):this._clear(),e.preventDefault();else if(e.keyCode===WI.KeyboardShortcut.Key.Enter.keyCode){let t=parseInt(this._input.value,10);if(this.representedObjectIsValid(t)){this.dismiss(t),e.preventDefault();return}this._input.select(),InspectorFrontendHost.beep()}}_handleBlurEvent(e){this.dismiss()}_handleMousedownEvent(e){this._input.select(),e.preventDefault()}_handleClickEvent(e){this._clear()}_clear(){this._input.value="",this.element.classList.remove(WI.GoToLineDialog.NonEmptyClassName)}};WI.GoToLineDialog.NonEmptyClassName="non-empty";WI.GradientEditor=class extends WI.Object{constructor(){super(),this._element=document.createElement("div"),this._element.classList.add("gradient-editor"),this._gradient=null,this._gradientTypes={"linear-gradient":{type:WI.LinearGradient,label:WI.UIString("Linear Gradient"),repeats:!1},"radial-gradient":{type:WI.RadialGradient,label:WI.UIString("Radial Gradient"),repeats:!1},"repeating-linear-gradient":{type:WI.LinearGradient,label:WI.UIString("Repeating Linear Gradient"),repeats:!0},"repeating-radial-gradient":{type:WI.RadialGradient,label:WI.UIString("Repeating Radial Gradient"),repeats:!0}},this._editingColor=!1,this._gradientTypePicker=this._element.appendChild(document.createElement("select")),this._gradientTypePicker.classList.add("gradient-type-select");for(let n in this._gradientTypes){let s=this._gradientTypePicker.appendChild(document.createElement("option"));s.value=n,s.text=this._gradientTypes[n].label}this._gradientTypePicker.addEventListener("change",this._gradientTypeChanged.bind(this)),this._gradientSlider=new WI.GradientSlider(this),this._element.appendChild(this._gradientSlider.element),this._colorPicker=new WI.ColorPicker,this._colorPicker.colorWheel.dimension=190,this._colorPicker.enableColorComponentInputs=!1,this._colorPicker.addEventListener(WI.ColorPicker.Event.ColorChanged,this._colorPickerColorChanged,this);let e=this._element.appendChild(document.createElement("div"));e.classList.add("gradient-angle"),e.append(WI.UIString("Angle"));let t=this._angleValueChanged.bind(this);this._angleSliderElement=e.appendChild(document.createElement("input")),this._angleSliderElement.type="range",this._angleSliderElement.addEventListener("input",t),this._angleInputElement=e.appendChild(document.createElement("input")),this._angleInputElement.type="number",this._angleInputElement.addEventListener("input",t),this._angleUnitsSelectElement=e.appendChild(document.createElement("select")),this._angleUnitsSelectElement.addEventListener("change",this._angleUnitsChanged.bind(this));const i=[{name:WI.LinearGradient.AngleUnits.DEG,min:0,max:360,step:1},{name:WI.LinearGradient.AngleUnits.RAD,min:0,max:2*Math.PI,step:.01},{name:WI.LinearGradient.AngleUnits.GRAD,min:0,max:400,step:1},{name:WI.LinearGradient.AngleUnits.TURN,min:0,max:1,step:.01}];this._angleUnitsConfiguration=new Map(i.map(({name:n,min:s,max:a,step:d})=>{let p=this._angleUnitsSelectElement.appendChild(document.createElement("option"));return p.value=p.textContent=n,[n,{element:p,min:s,max:a,step:d}]}))}get element(){return this._element}set gradient(e){if(!e)return;const t=e instanceof WI.LinearGradient,i=e instanceof WI.RadialGradient;console.assert(t||i),!(!t&&!i)&&(this._gradient=e,this._gradientSlider.stops=this._gradient.stops,t?(this._gradientTypePicker.value=this._gradient.repeats?"repeating-linear-gradient":"linear-gradient",this._angleUnitsChanged()):this._gradientTypePicker.value=this._gradient.repeats?"repeating-radial-gradient":"radial-gradient",this._updateCSSClassForGradientType())}get gradient(){return this._gradient}gradientSliderStopsDidChange(e){this._gradient.stops=e.stops,this.dispatchEventToListeners(WI.GradientEditor.Event.GradientChanged,{gradient:this._gradient})}gradientSliderStopWasSelected(e,t){const i=e.selectedStop;i&&!this._editingColor?(this._element.appendChild(this._colorPicker.element),this._element.classList.add("editing-color"),this._colorPicker.color=i.color,this._editingColor=!0):i||(this._colorPicker.element.remove(),this._element.classList.remove("editing-color"),this._editingColor=!1),this._angleInputElement.blur(),this.dispatchEventToListeners(WI.GradientEditor.Event.ColorPickerToggled),this.dispatchEventToListeners(WI.GradientEditor.Event.GradientChanged,{gradient:this._gradient})}_updateCSSClassForGradientType(){const e=this._gradient instanceof WI.RadialGradient;this._element.classList.toggle("radial-gradient",e),this.dispatchEventToListeners(WI.GradientEditor.Event.ColorPickerToggled)}_gradientTypeChanged(e){const t=this._gradientTypes[this._gradientTypePicker.value];this._gradient instanceof t.type||(t.type===WI.LinearGradient?(this._gradient=new WI.LinearGradient({value:180,units:WI.LinearGradient.AngleUnits.DEG},this._gradient.stops),this._angleUnitsChanged()):this._gradient=new WI.RadialGradient("",this._gradient.stops),this._updateCSSClassForGradientType()),this._gradient.repeats=t.repeats,this.dispatchEventToListeners(WI.GradientEditor.Event.GradientChanged,{gradient:this._gradient})}_colorPickerColorChanged(e){this._gradientSlider.selectedStop.color=e.target.color,this._gradientSlider.stops=this._gradient.stops,this.dispatchEventToListeners(WI.GradientEditor.Event.GradientChanged,{gradient:this._gradient})}_angleValueChanged(e){switch(e.target){case this._angleInputElement:this._gradient.angleValue=this._angleSliderElement.value=parseFloat(this._angleInputElement.value)||0;break;case this._angleSliderElement:this._gradient.angleValue=this._angleInputElement.value=parseFloat(this._angleSliderElement.value)||0;break;default:WI.reportInternalError("Input event fired for disabled color component input");return}this.dispatchEventToListeners(WI.GradientEditor.Event.GradientChanged,{gradient:this._gradient})}_angleUnitsChanged(e){let t=this._angleUnitsSelectElement.value,i=this._angleUnitsConfiguration.get(t);if(!i){WI.reportInternalError(`Missing configuration data for selected angle units "${t}"`);return}this._gradient.angleUnits=t,this._angleInputElement.min=this._angleSliderElement.min=i.min,this._angleInputElement.max=this._angleSliderElement.max=i.max,this._angleInputElement.step=this._angleSliderElement.step=i.step,this._angleInputElement.value=this._angleSliderElement.value=this._gradient.angleValue,this.dispatchEventToListeners(WI.GradientEditor.Event.GradientChanged,{gradient:this._gradient})}};WI.GradientEditor.Event={GradientChanged:"gradient-editor-gradient-changed",ColorPickerToggled:"gradient-editor-color-picker-toggled"};WI.GradientSlider=class extends WI.Object{constructor(e){super(),this.delegate=e,this._element=null,this._stops=[],this._knobs=[],this._selectedKnob=null,this._canvas=document.createElement("canvas"),this._keyboardShortcutEsc=new WI.KeyboardShortcut(null,WI.KeyboardShortcut.Key.Escape)}get element(){return this._element||(this._element=document.createElement("div"),this._element.className="gradient-slider",this._element.appendChild(this._canvas),this._addArea=this._element.appendChild(document.createElement("div")),this._addArea.addEventListener("mouseover",this),this._addArea.addEventListener("mousemove",this),this._addArea.addEventListener("mouseout",this),this._addArea.addEventListener("click",this),this._addArea.className=WI.GradientSlider.AddAreaClassName),this._element}get stops(){return this._stops}set stops(e){this._stops=e,this._updateStops()}get selectedStop(){return this._selectedKnob?this._selectedKnob.stop:null}handleEvent(e){switch(e.type){case"mouseover":this._handleMouseover(e);break;case"mousemove":this._handleMousemove(e);break;case"mouseout":this._handleMouseout(e);break;case"click":this._handleClick(e);break}}handleKeydownEvent(e){return!this._keyboardShortcutEsc.matchesEvent(e)||!this._selectedKnob||!this._selectedKnob.selected?!1:(this._selectedKnob.selected=!1,!0)}knobXDidChange(e){e.stop.offset=e.x/WI.GradientSlider.Width,this._sortStops(),this._updateCanvas()}knobCanDetach(e){return this._knobs.length>2}knobWillDetach(e){e.element.classList.add(WI.GradientSlider.DetachingClassName),this._stops.remove(e.stop),this._knobs.remove(e),this._sortStops(),this._updateCanvas()}knobSelectionChanged(e){this._selectedKnob&&this._selectedKnob!==e&&e.selected&&(this._selectedKnob.selected=!1),this._selectedKnob=e.selected?e:null,this.delegate&&typeof this.delegate.gradientSliderStopWasSelected=="function"&&this.delegate.gradientSliderStopWasSelected(this,e.stop),this._selectedKnob?WI.addWindowKeydownListener(this):WI.removeWindowKeydownListener(this)}_handleMouseover(e){this._updateShadowKnob(e)}_handleMousemove(e){this._updateShadowKnob(e)}_handleMouseout(e){!this._shadowKnob||(this._shadowKnob.element.remove(),delete this._shadowKnob)}_handleClick(e){this._updateShadowKnob(e),this._knobs.push(this._shadowKnob),this._shadowKnob.element.classList.remove(WI.GradientSlider.ShadowClassName);var t={offset:this._shadowKnob.x/WI.GradientSlider.Width,color:this._shadowKnob.wellColor};this._stops.push(t),this._sortStops(),this._updateStops(),this._knobs[this._stops.indexOf(t)].selected=!0,delete this._shadowKnob}_updateShadowKnob(e){this._shadowKnob||(this._shadowKnob=new WI.GradientSliderKnob(this),this._shadowKnob.element.classList.add(WI.GradientSlider.ShadowClassName),this.element.appendChild(this._shadowKnob.element)),this._shadowKnob.x=window.webkitConvertPointFromPageToNode(this.element,new WebKitPoint(e.pageX,e.pageY)).x;var t=this._canvas.getContext("2d").getImageData(this._shadowKnob.x-1,0,1,1).data;this._shadowKnob.wellColor=new WI.Color(WI.Color.Format.RGB,[t[0],t[1],t[2],t[3]/255])}_sortStops(){this._stops.sort(function(e,t){return e.offset-t.offset})}_updateStops(){this._updateCanvas(),this._updateKnobs()}_updateCanvas(){var e=WI.GradientSlider.Width,t=WI.GradientSlider.Height;this._canvas.width=e,this._canvas.height=t;var i=this._canvas.getContext("2d"),n=i.createLinearGradient(0,0,e,0);for(var s of this._stops)n.addColorStop(s.offset,s.color);i.clearRect(0,0,e,t),i.fillStyle=n,i.fillRect(0,0,e,t),this.delegate&&typeof this.delegate.gradientSliderStopsDidChange=="function"&&this.delegate.gradientSliderStopsDidChange(this)}_updateKnobs(){for(var e=this._selectedKnob?this._selectedKnob.stop:null;this._knobs.length>this._stops.length;)this._knobs.pop().element.remove();for(;this._knobs.length<this._stops.length;){var t=new WI.GradientSliderKnob(this);this.element.appendChild(t.element),this._knobs.push(t)}for(var i=0;i<this._stops.length;++i){var n=this._stops[i],t=this._knobs[i];t.stop=n,t.x=Math.round(n.offset*WI.GradientSlider.Width),t.selected=n===e}}};WI.GradientSlider.Width=238;WI.GradientSlider.Height=19;WI.GradientSlider.AddAreaClassName="add-area";WI.GradientSlider.DetachingClassName="detaching";WI.GradientSlider.ShadowClassName="shadow";WI.GradientSliderKnob=class extends WI.Object{constructor(e){super(),this._x=0,this._y=0,this._stop=null,this.delegate=e,this._element=document.createElement("div"),this._element.className="gradient-slider-knob",this._element.appendChild(document.createElement("img")),this._well=this._element.appendChild(document.createElement("div")),this._element.addEventListener("mousedown",this)}get element(){return this._element}get stop(){return this._stop}set stop(e){this.wellColor=e.color,this._stop=e}get x(){return this._x}set x(e){this._x=e,this._updateTransform()}get y(){return this._x}set y(e){this._y=e,this._updateTransform()}get wellColor(){return this._wellColor}set wellColor(e){this._wellColor=e,this._well.style.backgroundColor=e}get selected(){return this._element.classList.contains(WI.GradientSliderKnob.SelectedClassName)}set selected(e){this.selected!==e&&(this._element.classList.toggle(WI.GradientSliderKnob.SelectedClassName,e),this.delegate&&typeof this.delegate.knobSelectionChanged=="function"&&this.delegate.knobSelectionChanged(this))}handleEvent(e){switch(e.preventDefault(),e.stopPropagation(),e.type){case"mousedown":this._handleMousedown(e);break;case"mousemove":this._handleMousemove(e);break;case"mouseup":this._handleMouseup(e);break;case"transitionend":this._handleTransitionEnd(e);break}}_handleMousedown(e){this._moved=!1,this._detaching=!1,window.addEventListener("mousemove",this,!0),window.addEventListener("mouseup",this,!0),this._startX=this.x,this._startMouseX=e.pageX,this._startMouseY=e.pageY}_handleMousemove(e){var t=WI.GradientSlider.Width;if(this._moved=!0,!this._detaching&&Math.abs(e.pageY-this._startMouseY)>50&&(this._detaching=this.delegate&&typeof this.delegate.knobCanDetach=="function"&&this.delegate.knobCanDetach(this),this._detaching&&this.delegate&&typeof this.delegate.knobWillDetach=="function")){var i=window.webkitConvertPointFromNodeToPage(this.element.parentNode,new WebKitPoint(0,0));this._startMouseX-=i.x,this._startMouseY-=i.y,document.body.appendChild(this.element),this.delegate.knobWillDetach(this)}var n=this._startX+e.pageX-this._startMouseX;this._detaching||(n=Math.min(Math.max(0,n),t)),this.x=n,this._detaching?this.y=e.pageY-this._startMouseY:this.delegate&&typeof this.delegate.knobXDidChange=="function"&&this.delegate.knobXDidChange(this)}_handleMouseup(e){window.removeEventListener("mousemove",this,!0),window.removeEventListener("mouseup",this,!0),this._detaching?(this.element.addEventListener("transitionend",this),this.element.classList.add(WI.GradientSliderKnob.FadeOutClassName),this.selected=!1):this._moved||(this.selected=!this.selected)}_handleTransitionEnd(e){this.element.removeEventListener("transitionend",this),this.element.classList.remove(WI.GradientSliderKnob.FadeOutClassName),this.element.remove()}_updateTransform(){this.element.style.webkitTransform="translate3d("+this._x+"px, "+this._y+"px, 0)"}};WI.GradientSliderKnob.SelectedClassName="selected";WI.GradientSliderKnob.FadeOutClassName="fade-out";WI.HeapAllocationsTimelineDataGridNode=class extends WI.TimelineDataGridNode{constructor(e,t={}){console.assert(e instanceof WI.HeapAllocationsTimelineRecord),super([e],t),this._heapAllocationsView=t.heapAllocationsView,this.heapSnapshot.addEventListener(WI.HeapSnapshotProxy.Event.CollectedNodes,this._handleHeapSnapshotCollectedNodes,this),this.heapSnapshot.addEventListener(WI.HeapSnapshotProxy.Event.Invalidated,this._handleHeapSnapshotInvalidated,this)}get heapSnapshot(){return this.record.heapSnapshot}get data(){return this._cachedData?this._cachedData:(this._cachedData=super.data,this._cachedData.name=this.displayName(),this._cachedData.timestamp=this.record.timestamp-(this.graphDataSource?this.graphDataSource.zeroTime:0),this._cachedData.size=this.heapSnapshot.totalSize,this._cachedData.liveSize=this.heapSnapshot.liveSize,this._cachedData)}createCellContent(e,t){let n=this.data[e];switch(e){case"name":t.classList.add(...this.iconClassNames());var s=document.createDocumentFragment(),a=s.appendChild(document.createElement("span"));if(a.textContent=n,this._heapAllocationsView&&!this.heapSnapshot.invalid){var d=s.appendChild(WI.createGoToArrowButton());d.addEventListener("click",p=>{this._heapAllocationsView.showHeapSnapshotTimelineRecord(this.record)})}return s;case"timestamp":return isNaN(n)?emDash:Number.secondsToString(n,!0);case"size":case"liveSize":return Number.bytesToString(n,!0)}return super.createCellContent(e,t)}markAsBaseline(){this.element.classList.add("baseline")}clearBaseline(){this.element.classList.remove("baseline")}createCells(){super.createCells(),this.heapSnapshot.invalid&&this.element.classList.add("invalid")}_handleHeapSnapshotCollectedNodes(){this.needsRefresh()}_handleHeapSnapshotInvalidated(){this.needsRefresh()}};WI.HeapAllocationsTimelineDataGridNodePathComponent=class extends WI.TimelineDataGridNodePathComponent{get previousSibling(){let e=this.timelineDataGridNode.previousSibling;for(;e&&(e.hidden||e.record.heapSnapshot.invalid);)e=e.previousSibling;return e?new WI.HeapAllocationsTimelineDataGridNodePathComponent(e):null}get nextSibling(){let e=this.timelineDataGridNode.nextSibling;for(;e&&(e.hidden||e.record.heapSnapshot.invalid);)e=e.nextSibling;return e?new WI.HeapAllocationsTimelineDataGridNodePathComponent(e):null}};WI.HeapAllocationsTimelineOverviewGraph=class extends WI.TimelineOverviewGraph{constructor(e,t){super(t),this.element.classList.add("heap-allocations"),this._heapAllocationsTimeline=e,this._heapAllocationsTimeline.addEventListener(WI.Timeline.Event.RecordAdded,this._heapAllocationTimelineRecordAdded,this),this._selectedImageElement=null,this.reset()}reset(){super.reset(),this.element.removeChildren()}layout(){if(!this.visible)return;this.element.removeChildren(),this._selectedImageElement&&(this._selectedImageElement.classList.remove("selected"),this._selectedImageElement=null);let e=this._heapAllocationsTimeline.recordsInTimeRange(this.startTime,this.endTime);if(!e.length)return;let t=this.startTime,i=this.timelineOverview.secondsPerPixel;function n(s){return(s-t)/i}for(let s of e){if(isNaN(s.timestamp))continue;const a=8;let d=n(s.timestamp)-a;d<=1&&(d=1);let p=s[WI.HeapAllocationsTimelineOverviewGraph.RecordElementAssociationSymbol];p||(p=s[WI.HeapAllocationsTimelineOverviewGraph.RecordElementAssociationSymbol]=document.createElement("img"),p.classList.add("snapshot"),p.addEventListener("click",f=>{s.heapSnapshot.invalid||(f.__timelineRecordClickEventHandled=!0,this.selectedRecord=s)})),p.style.setProperty(WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?"right":"left",`${d}px`),s.heapSnapshot.invalid&&p.classList.add("invalid"),this.element.appendChild(p)}this._updateSnapshotMarkers()}updateSelectedRecord(){this._updateSnapshotMarkers()}_updateSnapshotMarkers(){if(this._selectedImageElement&&this._selectedImageElement.classList.remove("selected"),!this.selectedRecord){this._selectedImageElement=null;return}let e=this.selectedRecord[WI.HeapAllocationsTimelineOverviewGraph.RecordElementAssociationSymbol];!e||(e.classList.add("selected"),this._selectedImageElement=e)}_heapAllocationTimelineRecordAdded(e){this.needsLayout()}};WI.HeapAllocationsTimelineOverviewGraph.RecordElementAssociationSymbol=Symbol("record-element-association");WI.HeapAllocationsTimelineView=class extends WI.TimelineView{constructor(e,t){super(e,t),console.assert(e.type===WI.TimelineRecord.Type.HeapAllocations,e),this.element.classList.add("heap-allocations");let i={name:{title:WI.UIString("Name"),width:"150px",icon:!0},timestamp:{title:WI.UIString("Time"),width:"80px",sortable:!0,aligned:"right"},size:{title:WI.UIString("Size"),width:"80px",sortable:!0,aligned:"right"},liveSize:{title:WI.UIString("Live Size"),width:"80px",sortable:!0,aligned:"right"}};this._importButtonNavigationItem=new WI.ButtonNavigationItem("import",WI.UIString("Import"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' d='M 7.5 8.5 V 1'/%3e %3cpath fill='none' stroke='currentColor' d='M 10.5 5.5 l -3%2c 3 l -3 -3'/%3e %3cpolyline fill='none' stroke='currentColor' points='12.5 9 12.5 12.5 2.5 12.5 2.5 9'/%3e %3c/svg%3e",15,15),this._importButtonNavigationItem.tooltip=WI.UIString("Import"),this._importButtonNavigationItem.buttonStyle=WI.ButtonNavigationItem.Style.ImageAndText,this._importButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._importButtonNavigationItemClicked,this);let n=WI.UIString("Take snapshot");this._takeHeapSnapshotButtonItem=new WI.ButtonNavigationItem("take-snapshot",n,"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2016 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath d='M 12 3.5 L 11.5 2.41528547 C 11.5 2.41528547 11.0826911 1.5 10.5 1.5 L 5.5 1.5 C 4.91636759 1.5 4.5 2.41528544 4.5 2.41528544 L 4 3.5 L 2.38174379 3.5 C 2.38174379 3.5 0.5 3.65837937 0.5 5.5 L 0.5 12.5 C 0.5 14.3416206 2.38174379 14.5 2.38174379 14.5 L 13.5 14.5 C 13.5 14.5 15.5 14.3416206 15.5 12.5 L 15.5 5.5 C 15.5 3.65837937 13.5 3.5 13.5 3.5 L 12 3.5 Z' fill='none' stroke='currentColor'/%3e %3cpath d='M 8 12.5 C 10.209139 12.5 12 10.709139 12 8.5 C 12 6.290861 10.209139 4.5 8 4.5 C 5.790861 4.5 4 6.290861 4 8.5 C 4 10.709139 5.790861 12.5 8 12.5 Z' fill='none' stroke='currentColor'/%3e %3cpath d='M 8 10.5 C 9.1045695 10.5 10 9.6045695 10 8.5 C 10 7.3954305 9.1045695 6.5 8 6.5 C 6.8954305 6.5 6 7.3954305 6 8.5 C 6 9.6045695 6.8954305 10.5 8 10.5 Z' fill='none' stroke='currentColor'/%3e %3c/svg%3e",16,16),this._takeHeapSnapshotButtonItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._takeHeapSnapshotClicked,this);let s=WI.UIString("Compare snapshots"),a=WI.UIString("Cancel comparison");this._compareHeapSnapshotsButtonItem=new WI.ActivateButtonNavigationItem("compare-heap-snapshots",s,a,"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2016 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect fill='none' stroke='currentColor' x='0.5' y='0.5' width='15' height='15' rx='2'/%3e %3cpath fill='none' stroke-linecap='round' stroke='currentColor' d='M 3.5 5.5 L 12.5 5.5'/%3e %3cpath fill='none' stroke-linecap='round' stroke='currentColor' d='M 12.5 5.5 L 9.5 2.5'/%3e %3cpath fill='none' stroke-linecap='round' stroke='currentColor' d='M 12.5 5.5 L 9.5 8.5'/%3e %3cpath fill='none' stroke-linecap='round' stroke='currentColor' d='M 3.5 10.5 L 12.5 10.5'/%3e %3cpath fill='none' stroke-linecap='round' stroke='currentColor' d='M 3.5 10.5 L 6.5 7.5'/%3e %3cpath fill='none' stroke-linecap='round' stroke='currentColor' d='M 3.5 10.5 L 6.5 13.5'/%3e %3c/svg%3e",16,16),this._compareHeapSnapshotsButtonItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._compareHeapSnapshotsClicked,this),this._compareHeapSnapshotsButtonItem.enabled=!1,this._compareHeapSnapshotsButtonItem.activated=!1,this._compareHeapSnapshotHelpTextItem=new WI.TextNavigationItem("compare-heap-snapshot-help-text",""),this._selectingComparisonHeapSnapshots=!1,this._baselineDataGridNode=null,this._baselineHeapSnapshotTimelineRecord=null,this._heapSnapshotDiff=null,this._snapshotListScrollTop=0,this._showingSnapshotList=!0,this._snapshotListPathComponent=new WI.HierarchicalPathComponent(WI.UIString("Snapshot List"),"snapshot-list-icon","snapshot-list",!1,!1),this._snapshotListPathComponent.addEventListener(WI.HierarchicalPathComponent.Event.Clicked,this._snapshotListPathComponentClicked,this),this._dataGrid=new WI.TimelineDataGrid(i),this._dataGrid.sortColumnIdentifier="timestamp",this._dataGrid.sortOrder=WI.DataGrid.SortOrder.Ascending,this._dataGrid.createSettings("heap-allocations-timeline-view"),this._dataGrid.addEventListener(WI.DataGrid.Event.SelectedNodeChanged,this._dataGridNodeSelected,this),this.setupDataGrid(this._dataGrid),this.addSubview(this._dataGrid),this._contentViewContainer=new WI.ContentViewContainer,this._contentViewContainer.addEventListener(WI.ContentViewContainer.Event.CurrentContentViewDidChange,this._currentContentViewDidChange,this),WI.ContentView.addEventListener(WI.ContentView.Event.SelectionPathComponentsDidChange,this._contentViewSelectionPathComponentDidChange,this),this._pendingRecords=[],e.addEventListener(WI.Timeline.Event.RecordAdded,this._heapAllocationsTimelineRecordAdded,this),WI.HeapSnapshotProxy.addEventListener(WI.HeapSnapshotProxy.Event.Invalidated,this._heapSnapshotInvalidated,this),WI.HeapSnapshotWorkerProxy.singleton().addEventListener("HeapSnapshot.CollectionEvent",this._heapSnapshotCollectionEvent,this)}get scrollableElements(){return this._showingSnapshotList?[this._dataGrid.scrollContainer]:this._contentViewContainer.currentContentView?this._contentViewContainer.currentContentView.scrollableElements:[]}showHeapSnapshotList(){this._showingSnapshotList||(this._showingSnapshotList=!0,this._heapSnapshotDiff=null,this._cancelSelectComparisonHeapSnapshots(),this._contentViewContainer.hidden(),this.removeSubview(this._contentViewContainer),this.addSubview(this._dataGrid),this._dataGrid.scrollContainer.scrollTop=this._snapshotListScrollTop,this.dispatchEventToListeners(WI.ContentView.Event.SelectionPathComponentsDidChange),this.dispatchEventToListeners(WI.ContentView.Event.NavigationItemsDidChange))}showHeapSnapshotTimelineRecord(e){this._showingSnapshotList&&(this._snapshotListScrollTop=this._dataGrid.scrollContainer.scrollTop,this.removeSubview(this._dataGrid),this.addSubview(this._contentViewContainer),this._contentViewContainer.shown()),this._showingSnapshotList=!1,this._heapSnapshotDiff=null,this._cancelSelectComparisonHeapSnapshots();for(let i of this._dataGrid.children)if(i.record===e){i.hidden=!1,i.select();break}let t=this._contentViewContainer.currentContentView&&this._contentViewContainer.currentContentView.representedObject===e.heapSnapshot;this._contentViewContainer.showContentViewForRepresentedObject(e.heapSnapshot),t&&this._currentContentViewDidChange()}showHeapSnapshotDiff(e){this._showingSnapshotList&&(this.removeSubview(this._dataGrid),this.addSubview(this._contentViewContainer),this._contentViewContainer.shown()),this._showingSnapshotList=!1,this._heapSnapshotDiff=e,this._contentViewContainer.showContentViewForRepresentedObject(e)}get showsFilterBar(){return this._showingSnapshotList}get navigationItems(){if(this._showingSnapshotList){let e=[this._importButtonNavigationItem,this._takeHeapSnapshotButtonItem,this._compareHeapSnapshotsButtonItem];return this._selectingComparisonHeapSnapshots&&e.push(this._compareHeapSnapshotHelpTextItem),e}return this._contentViewContainer.currentContentView?this._contentViewContainer.currentContentView.navigationItems:[]}get selectionPathComponents(){let e=[this._snapshotListPathComponent];if(this._showingSnapshotList)return e;if(this._heapSnapshotDiff){let t=this._heapSnapshotDiff.snapshot1.identifier,i=this._heapSnapshotDiff.snapshot2.identifier,n=new WI.HierarchicalPathComponent(WI.UIString("Snapshot Comparison (%d and %d)").format(t,i),"snapshot-diff-icon","snapshot-diff");e.push(n)}else if(this._dataGrid.selectedNode){let t=new WI.HeapAllocationsTimelineDataGridNodePathComponent(this._dataGrid.selectedNode);t.addEventListener(WI.HierarchicalPathComponent.Event.SiblingWasSelected,this._snapshotPathComponentSelected,this),e.push(t)}return this._contentViewContainer.currentContentView&&(e=e.concat(this._contentViewContainer.currentContentView.selectionPathComponents)),e}selectRecord(e){e?this.showHeapSnapshotTimelineRecord(e):this.showHeapSnapshotList()}shown(){super.shown(),this._dataGrid.shown(),this._showingSnapshotList||this._contentViewContainer.shown()}hidden(){super.hidden(),this._dataGrid.hidden(),this._showingSnapshotList||this._contentViewContainer.hidden()}closed(){console.assert(this.representedObject instanceof WI.Timeline),this.representedObject.removeEventListener(null,null,this),this._dataGrid.closed(),this._contentViewContainer.closeAllContentViews(),WI.ContentView.removeEventListener(null,null,this),WI.HeapSnapshotProxy.removeEventListener(null,null,this),WI.HeapSnapshotWorkerProxy.singleton().removeEventListener("HeapSnapshot.CollectionEvent",this._heapSnapshotCollectionEvent,this)}layout(){if(super.layout(),!!this._pendingRecords.length){for(let e of this._pendingRecords)this._dataGrid.addRowInSortOrder(new WI.HeapAllocationsTimelineDataGridNode(e,{graphDataSource:this,heapAllocationsView:this}));this._pendingRecords=[],this._updateCompareHeapSnapshotButton()}}reset(){super.reset(),this._dataGrid.reset(),this.showHeapSnapshotList(),this._pendingRecords=[],this._updateCompareHeapSnapshotButton()}updateFilter(e){this._dataGrid.filterText=e?e.text:""}_heapAllocationsTimelineRecordAdded(e){this._pendingRecords.push(e.data.record),this.needsLayout()}_heapSnapshotCollectionEvent(e){function t(i){i.invalid||i.updateForCollectionEvent(e)}for(let i of this._dataGrid.children)t(i.record.heapSnapshot);for(let i of this._pendingRecords)t(i.heapSnapshot);this._heapSnapshotDiff&&t(this._heapSnapshotDiff)}_snapshotListPathComponentClicked(e){this.showHeapSnapshotList()}_snapshotPathComponentSelected(e){console.assert(e.data.pathComponent.representedObject instanceof WI.HeapAllocationsTimelineRecord),this.showHeapSnapshotTimelineRecord(e.data.pathComponent.representedObject)}_currentContentViewDidChange(e){this.dispatchEventToListeners(WI.ContentView.Event.SelectionPathComponentsDidChange),this.dispatchEventToListeners(WI.ContentView.Event.NavigationItemsDidChange)}_contentViewSelectionPathComponentDidChange(e){e.target===this._contentViewContainer.currentContentView&&this.dispatchEventToListeners(WI.ContentView.Event.SelectionPathComponentsDidChange)}_heapSnapshotInvalidated(e){let t=e.target;this._baselineHeapSnapshotTimelineRecord&&t===this._baselineHeapSnapshotTimelineRecord.heapSnapshot&&this._cancelSelectComparisonHeapSnapshots(),this._heapSnapshotDiff?(t===this._heapSnapshotDiff.snapshot1||t===this._heapSnapshotDiff.snapshot2)&&this.showHeapSnapshotList():this._dataGrid.selectedNode&&t===this._dataGrid.selectedNode.record.heapSnapshot&&this.showHeapSnapshotList(),this._updateCompareHeapSnapshotButton()}_updateCompareHeapSnapshotButton(){let e=!1,t=0;for(let i of this._dataGrid.children)if(i.revealed&&!i.hidden&&!i.record.heapSnapshot.invalid&&(t++,t===2)){e=!0;break}this._compareHeapSnapshotsButtonItem.enabled=e}_importButtonNavigationItemClicked(){WI.FileUtilities.importText(e=>{let t=e.text;WI.HeapSnapshotWorkerProxy.singleton().createImportedSnapshot(t,e.filename,({objectId:n,snapshot:s})=>{let a=WI.HeapSnapshotProxy.deserialize(n,s);a.snapshotStringData=t;const d=NaN;WI.timelineManager.heapSnapshotAdded(d,a),this.dispatchEventToListeners(WI.TimelineView.Event.NeedsEntireSelectedRange)})})}_takeHeapSnapshotClicked(){HeapAgent.snapshot((e,t,i)=>{WI.HeapSnapshotWorkerProxy.singleton().createSnapshot(i,({objectId:s,snapshot:a})=>{let d=WI.HeapSnapshotProxy.deserialize(s,a);d.snapshotStringData=i,WI.timelineManager.heapSnapshotAdded(t,d),this.dispatchEventToListeners(WI.TimelineView.Event.NeedsEntireSelectedRange)})})}_cancelSelectComparisonHeapSnapshots(){!this._selectingComparisonHeapSnapshots||(this._baselineDataGridNode&&this._baselineDataGridNode.clearBaseline(),this._selectingComparisonHeapSnapshots=!1,this._baselineDataGridNode=null,this._baselineHeapSnapshotTimelineRecord=null,this._compareHeapSnapshotsButtonItem.activated=!1,this.dispatchEventToListeners(WI.ContentView.Event.NavigationItemsDidChange))}_compareHeapSnapshotsClicked(e){let t=!this._compareHeapSnapshotsButtonItem.activated;if(this._compareHeapSnapshotsButtonItem.activated=t,!t){this._cancelSelectComparisonHeapSnapshots();return}this._dataGrid.selectedNode&&this._dataGrid.selectedNode.deselect(),this._selectingComparisonHeapSnapshots=!0,this._baselineHeapSnapshotTimelineRecord=null,this._compareHeapSnapshotHelpTextItem.text=WI.UIString("Select baseline snapshot"),this.dispatchEventToListeners(WI.ContentView.Event.NavigationItemsDidChange)}_dataGridNodeSelected(e){if(!this._selectingComparisonHeapSnapshots)return;let t=this._dataGrid.selectedNode;if(!t)return;let i=t.record;if(i.heapSnapshot.invalid||this._baselineHeapSnapshotTimelineRecord===i){this._dataGrid.selectedNode.deselect();return}if(!this._baselineHeapSnapshotTimelineRecord){this._baselineDataGridNode=t,this._baselineDataGridNode.markAsBaseline(),this._baselineHeapSnapshotTimelineRecord=i,this._dataGrid.selectedNode.deselect(),this._compareHeapSnapshotHelpTextItem.text=WI.UIString("Select comparison snapshot"),this.dispatchEventToListeners(WI.ContentView.Event.NavigationItemsDidChange);return}let n=this._baselineHeapSnapshotTimelineRecord.heapSnapshot,s=i.heapSnapshot;n.identifier>s.identifier&&([n,s]=[s,n]),WI.HeapSnapshotWorkerProxy.singleton().createSnapshotDiff(n.proxyObjectId,s.proxyObjectId,({objectId:d,snapshotDiff:p})=>{let f=WI.HeapSnapshotDiffProxy.deserialize(d,p);this.showHeapSnapshotDiff(f)}),this._baselineDataGridNode.clearBaseline(),this._baselineDataGridNode=null,this._selectingComparisonHeapSnapshots=!1,this._compareHeapSnapshotsButtonItem.activated=!1}};WI.HeapSnapshotClassDataGridNode=class extends WI.DataGridNode{constructor(e,t){super(e,!0),this._data=e,this._tree=t,this._batched=!1,this._instances=null,this.addEventListener("populate",this._populate,this)}get data(){return this._data}createCellContent(e){if(e==="retainedSize"){let t=this._data.retainedSize,i=document.createDocumentFragment(),n=i.appendChild(document.createElement("span"));n.classList.add("size"),n.textContent=Number.bytesToString(t);let s=i.appendChild(document.createElement("span"));return s.classList.add("percentage"),s.textContent=emDash,i}if(e==="size")return Number.bytesToString(this._data.size);if(e==="className"){let{className:i,isObjectSubcategory:n}=this._data,s=document.createDocumentFragment();s.appendChild(document.createElement("img")).classList.add("icon",WI.HeapSnapshotClusterContentView.iconStyleClassNameForClassName(i,!1,n));let d=s.appendChild(document.createElement("span"));return d.classList.add("class-name"),d.textContent=i,s}return super.createCellContent(e)}sort(){if(this._batched){this._removeFetchMoreDataGridNode(),this._sortInstances(),this._updateBatchedChildren(),this._appendFetchMoreDataGridNode();return}let e=this.children;e.sort(this._tree._sortComparator);for(let t=0;t<e.length;++t)e[t]._recalculateSiblings(t),e[t].sort()}removeCollectedNodes(e){let t=[];if(this.forEachImmediateChild(i=>{i instanceof WI.HeapSnapshotInstanceDataGridNode&&i.node.id in e&&t.push(i)}),t.length)for(let i of t)this.removeChild(i);this._instances&&(this._instances=this._instances.filter(i=>!(i.id in e)),this._fetchBatch(t.length))}updateCount(e){if(e!==this._data.count){if(!e){this._tree.removeChild(this);return}this._data.count=e,this.needsRefresh()}}_populate(){this.removeEventListener("populate",this._populate,this),this._tree.heapSnapshot.instancesWithClassName(this._data.className,e=>{if(this._instances=e.filter(t=>!t.dead),this._sortInstances(),e.length>WI.HeapSnapshotClassDataGridNode.ChildrenBatchLimit){this._batched=!0,this._fetchBatch(WI.HeapSnapshotClassDataGridNode.ChildrenBatchLimit);return}for(let t of this._instances)this.appendChild(new WI.HeapSnapshotInstanceDataGridNode(t,this._tree))})}_fetchBatch(e){this._batched&&this.children.length&&this._removeFetchMoreDataGridNode();let t=this.children.length,i=t+e;i>=this._instances.length&&(i=this._instances.length-1,this._batched=!1);let n=i-t;if(n)for(let s=0;s<=n;++s){let a=this._instances[t+s];this.appendChild(new WI.HeapSnapshotInstanceDataGridNode(a,this._tree))}this._batched&&this._appendFetchMoreDataGridNode()}_sortInstances(){this._instances.sort((e,t)=>{let i={data:e},n={data:t};return this._tree._sortComparator(i,n)})}_updateBatchedChildren(){let e=this.children.length;this.removeChildren();for(let t=0;t<e;++t)this.appendChild(new WI.HeapSnapshotInstanceDataGridNode(this._instances[t],this._tree))}_removeFetchMoreDataGridNode(){console.assert(this.children[this.children.length-1]instanceof WI.HeapSnapshotInstanceFetchMoreDataGridNode),this.removeChild(this.children[this.children.length-1])}_appendFetchMoreDataGridNode(){console.assert(!(this.children[this.children.length-1]instanceof WI.HeapSnapshotInstanceFetchMoreDataGridNode));let e=this.children.length,i=this._instances.length-e,n=i>=WI.HeapSnapshotClassDataGridNode.ChildrenBatchLimit?WI.HeapSnapshotClassDataGridNode.ChildrenBatchLimit:0;this.appendChild(new WI.HeapSnapshotInstanceFetchMoreDataGridNode(this._tree,n,i,this._fetchBatch.bind(this)))}};WI.HeapSnapshotClassDataGridNode.ChildrenBatchLimit=100;WI.HeapSnapshotClusterContentView=class extends WI.ClusterContentView{constructor(e){super(e),console.assert(e instanceof WI.HeapSnapshotProxy||e instanceof WI.HeapSnapshotDiffProxy),this._heapSnapshot=e;function t(i,n,s){let a=new WI.HierarchicalPathComponent(i,n,s,!1,!0);return a.addEventListener(WI.HierarchicalPathComponent.Event.SiblingWasSelected,this._pathComponentSelected,this),a.comparisonData=e,a}this._shownInitialContent=!1,this._instancesContentView=null,this._objectGraphContentView=null,this._instancesPathComponent=t.call(this,WI.UIString("Instances"),"heap-snapshot-instances-icon",WI.HeapSnapshotClusterContentView.InstancesIdentifier),this._objectGraphPathComponent=t.call(this,WI.UIString("Object Graph"),"heap-snapshot-object-graph-icon",WI.HeapSnapshotClusterContentView.ObjectGraphIdentifier),this._supportsObjectGraph()&&(this._instancesPathComponent.nextSibling=this._objectGraphPathComponent,this._objectGraphPathComponent.previousSibling=this._instancesPathComponent),this._currentContentViewSetting=new WI.Setting("heap-snapshot-cluster-current-view",WI.HeapSnapshotClusterContentView.InstancesIdentifier)}static iconStyleClassNameForClassName(e,t,i){if(t)return"native";if(i)return"object";switch(e){case"Object":case"Array":case"Map":case"Set":case"WeakMap":case"WeakSet":case"Promise":case"Error":case"Window":case"Map Iterator":case"Set Iterator":case"Math":case"JSON":case"GlobalObject":return"object";case"Function":return"function";case"RegExp":return"regex";case"Number":return"number";case"Boolean":return"boolean";case"String":case"string":return"string";case"Symbol":case"symbol":return"symbol"}return e.endsWith("Prototype")?"object":e.endsWith("Element")||e==="Node"||e==="Text"?"node":"native"}get heapSnapshot(){return this._heapSnapshot}get instancesContentView(){return this._instancesContentView||(this._instancesContentView=new WI.HeapSnapshotInstancesContentView(this._heapSnapshot)),this._instancesContentView}get objectGraphContentView(){return this._supportsObjectGraph()?(this._objectGraphContentView||(this._objectGraphContentView=new WI.HeapSnapshotObjectGraphContentView(this._heapSnapshot)),this._objectGraphContentView):null}get selectionPathComponents(){let e=this._contentViewContainer.currentContentView;return e?[this._pathComponentForContentView(e)].concat(e.selectionPathComponents):[]}shown(){super.shown(),!this._shownInitialContent&&this._showContentViewForIdentifier(this._currentContentViewSetting.value)}closed(){super.closed(),this._shownInitialContent=!1}saveToCookie(e){e[WI.HeapSnapshotClusterContentView.ContentViewIdentifierCookieKey]=this._currentContentViewSetting.value}restoreFromCookie(e){this._showContentViewForIdentifier(e[WI.HeapSnapshotClusterContentView.ContentViewIdentifierCookieKey])}showInstances(){return this._shownInitialContent=!0,this._showContentViewForIdentifier(WI.HeapSnapshotClusterContentView.InstancesIdentifier)}showObjectGraph(){return this._shownInitialContent=!0,this._showContentViewForIdentifier(WI.HeapSnapshotClusterContentView.ObjectGraphIdentifier)}_supportsObjectGraph(){return this._heapSnapshot instanceof WI.HeapSnapshotProxy}_pathComponentForContentView(e){return console.assert(e),e?e===this._instancesContentView?this._instancesPathComponent:e===this._objectGraphContentView?this._objectGraphPathComponent:(console.error("Unknown contentView."),null):null}_identifierForContentView(e){return console.assert(e),e?e===this._instancesContentView?WI.HeapSnapshotClusterContentView.InstancesIdentifier:e===this._objectGraphContentView?WI.HeapSnapshotClusterContentView.ObjectGraphIdentifier:(console.error("Unknown contentView."),null):null}_showContentViewForIdentifier(e){let t=null;switch(e){case WI.HeapSnapshotClusterContentView.InstancesIdentifier:t=this.instancesContentView;break;case WI.HeapSnapshotClusterContentView.ObjectGraphIdentifier:t=this.objectGraphContentView;break}return t||(t=this.instancesContentView),console.assert(t),this._shownInitialContent=!0,this._currentContentViewSetting.value=this._identifierForContentView(t),this.contentViewContainer.showContentView(t)}_pathComponentSelected(e){this._showContentViewForIdentifier(e.data.pathComponent.representedObject)}};WI.HeapSnapshotClusterContentView.ContentViewIdentifierCookieKey="heap-snapshot-cluster-content-view-identifier";WI.HeapSnapshotClusterContentView.InstancesIdentifier="instances";WI.HeapSnapshotClusterContentView.ObjectGraphIdentifier="object-graph";WI.HeapSnapshotContentView=class extends WI.ContentView{constructor(e,t,i,n){console.assert(e instanceof WI.HeapSnapshotProxy||e instanceof WI.HeapSnapshotDiffProxy),super(e),this.element.classList.add("heap-snapshot"),this._exportButtonNavigationItem=new WI.ButtonNavigationItem("export",WI.UIString("Export"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' d='M 7.5 2 v 7.5'/%3e %3cpath fill='none' stroke='currentColor' d='M 4.5 5 l 3 -3 l 3 3'/%3e %3cpolyline fill='none' stroke='currentColor' points='12.5 9 12.5 12.5 2.5 12.5 2.5 9'/%3e %3c/svg%3e",15,15),this._exportButtonNavigationItem.tooltip=WI.UIString("Export (%s)").format(WI.saveKeyboardShortcut.displayName),this._exportButtonNavigationItem.buttonStyle=WI.ButtonNavigationItem.Style.ImageAndText,this._exportButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.High,this._exportButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,()=>{this._exportSnapshot()}),this._dataGrid=new WI.DataGrid(i),this._dataGrid.sortColumnIdentifier="retainedSize",this._dataGrid.sortOrder=WI.DataGrid.SortOrder.Descending,this._dataGrid.createSettings(t),this._dataGrid.addEventListener(WI.DataGrid.Event.SortChanged,this._sortDataGrid,this);let s=WI.HeapSnapshotDataGridTree.buildSortComparator(this._dataGrid.sortColumnIdentifier,this._dataGrid.sortOrder);this._heapSnapshotDataGridTree=new n(this.representedObject,s),this._heapSnapshotDataGridTree.addEventListener(WI.HeapSnapshotDataGridTree.Event.DidPopulate,this._heapSnapshotDataGridTreeDidPopulate,this);for(let a of this._heapSnapshotDataGridTree.children)this._dataGrid.appendChild(a);this.addSubview(this._dataGrid),this._dataGrid.updateLayout()}get navigationItems(){return this.representedObject instanceof WI.HeapSnapshotProxy?[this._exportButtonNavigationItem]:[]}shown(){super.shown(),this._heapSnapshotDataGridTree.shown()}hidden(){super.hidden(),this._heapSnapshotDataGridTree.hidden()}get scrollableElements(){return[this._dataGrid.scrollContainer]}_exportSnapshot(){if(!this.representedObject.snapshotStringData){InspectorFrontendHost.beep();return}let e=new Date,t=[e.getFullYear(),Number.zeroPad(e.getMonth()+1,2),Number.zeroPad(e.getDate(),2),Number.zeroPad(e.getHours(),2),Number.zeroPad(e.getMinutes(),2),Number.zeroPad(e.getSeconds(),2)],i=WI.UIString("Heap Snapshot %s-%s-%s at %s.%s.%s").format(...t);WI.FileUtilities.save({url:WI.FileUtilities.inspectorURLForFilename(i+".json"),content:this.representedObject.snapshotStringData,forceSaveAs:!0})}_sortDataGrid(){if(!!this._heapSnapshotDataGridTree){this._heapSnapshotDataGridTree.sortComparator=WI.HeapSnapshotDataGridTree.buildSortComparator(this._dataGrid.sortColumnIdentifier,this._dataGrid.sortOrder),this._dataGrid.removeChildren();for(let e of this._heapSnapshotDataGridTree.children)this._dataGrid.appendChild(e)}}_heapSnapshotDataGridTreeDidPopulate(){this._dataGrid.removeChildren();for(let e of this._heapSnapshotDataGridTree.children)this._dataGrid.appendChild(e)}};WI.HeapSnapshotInstancesContentView=class extends WI.HeapSnapshotContentView{constructor(e){let t={retainedSize:{title:WI.UIString("Retained Size"),tooltip:WI.UIString("Size of current object plus all objects it keeps alive"),width:"140px",aligned:"right",sortable:!0},size:{title:WI.UIString("Self Size"),width:"90px",aligned:"right",sortable:!0},count:{title:WI.UIString("Count"),width:"75px",aligned:"right",sortable:!0},className:{title:WI.UIString("Name"),sortable:!0,disclosure:!0}};super(e,"heap-snapshot-instances-content-view",t,WI.HeapSnapshotInstancesDataGridTree)}};WI.HeapSnapshotObjectGraphContentView=class extends WI.HeapSnapshotContentView{constructor(e){let t={retainedSize:{title:WI.UIString("Retained Size"),tooltip:WI.UIString("Size of current object plus all objects it keeps alive"),width:"140px",aligned:"right",sortable:!0},size:{title:WI.UIString("Self Size"),width:"90px",aligned:"right",sortable:!0},className:{title:WI.UIString("Name"),sortable:!0,disclosure:!0}};super(e,"heap-snapshot-object-graph-content-view",t,WI.HeapSnapshotObjectGraphDataGridTree)}};WI.HeapSnapshotDataGridTree=class extends WI.Object{constructor(e,t){super(),console.assert(e instanceof WI.HeapSnapshotProxy||e instanceof WI.HeapSnapshotDiffProxy),this._heapSnapshot=e,this._heapSnapshot.addEventListener(WI.HeapSnapshotProxy.Event.CollectedNodes,this._heapSnapshotCollectedNodes,this),this._children=[],this._sortComparator=t,this._visible=!1,this._popover=null,this._popoverGridNode=null,this._popoverTargetElement=null,this.populateTopLevel()}static buildSortComparator(e,t){let i=t===WI.DataGrid.SortOrder.Ascending?1:-1,n=(a,d,p)=>i*(d.data[a]-p.data[a]),s=(a,d)=>{if(a.propertyName||d.propertyName){if(a.propertyName&&!d.propertyName)return i*-1;if(!a.propertyName&&d.propertyName)return i*1;let f=a.propertyName.extendedLocaleCompare(d.propertyName);return console.assert(f!==0,"Property names should be unique, we shouldn't have equal property names."),i*f}let p=a.data.className.extendedLocaleCompare(d.data.className);return p?i*p:a.data.id||d.data.id?i*(a.data.id-d.data.id):0};switch(e){case"retainedSize":return n.bind(this,"retainedSize");case"size":return n.bind(this,"size");case"count":return n.bind(this,"count");case"className":return s}}get heapSnapshot(){return this._heapSnapshot}get visible(){return this._visible}get popoverGridNode(){return this._popoverGridNode}set popoverGridNode(e){this._popoverGridNode=e}get popoverTargetElement(){return this._popoverTargetElement}set popoverTargetElement(e){this._popoverTargetElement=e}get popover(){return this._popover||(this._popover=new WI.Popover(this),this._popover.windowResizeHandler=()=>{let e=WI.Rect.rectFromClientRect(this._popoverTargetElement.getBoundingClientRect());this._popover.present(e.pad(2),[WI.RectEdge.MAX_Y,WI.RectEdge.MIN_Y,WI.RectEdge.MAX_X])}),this._popover}get children(){return this._children}appendChild(e){this._children.push(e)}insertChild(e,t){this._children.splice(t,0,e)}removeChild(e){this._children.remove(e,!0)}removeChildren(){this._children=[]}set sortComparator(e){this._sortComparator=e,this.sort()}sort(){let e=this._children;e.sort(this._sortComparator);for(let t=0;t<e.length;++t)e[t]._recalculateSiblings(t),e[t].sort()}shown(){this._visible=!0}hidden(){this._visible=!1,this._popover&&this._popover.visible&&this._popover.dismiss()}willDismissPopover(e){this._popoverGridNode=null,this._popoverTargetElement=null}get alwaysShowRetainedSize(){return!1}populateTopLevel(){}removeCollectedNodes(e){}didPopulate(){this.sort(),this.dispatchEventToListeners(WI.HeapSnapshotDataGridTree.Event.DidPopulate)}_heapSnapshotCollectedNodes(e){this.removeCollectedNodes(e.data.collectedNodes)}};WI.HeapSnapshotDataGridTree.Event={DidPopulate:"heap-snapshot-data-grid-tree-did-populate"};WI.HeapSnapshotInstancesDataGridTree=class extends WI.HeapSnapshotDataGridTree{get alwaysShowRetainedSize(){return!1}populateTopLevel(){let e=!WI.settings.debugShowInternalObjectsInHeapSnapshot.value;for(let[t,{size:i,retainedSize:n,count:s,internalCount:a,deadCount:d,objectCount:p}]of this.heapSnapshot.categories){if(console.assert(s>0),e&&s===a)continue;let f=s-d;if(!f)continue;let _=p/s>.5;this.appendChild(new WI.HeapSnapshotClassDataGridNode({className:t,size:i,retainedSize:n,isObjectSubcategory:_,count:f},this))}this.didPopulate()}removeCollectedNodes(e){for(let t of this.children){let{count:i,deadCount:n}=this.heapSnapshot.categories.get(t.data.className),s=i-n;t.updateCount(s),s&&t.removeCollectedNodes(e)}this.didPopulate()}};WI.HeapSnapshotObjectGraphDataGridTree=class extends WI.HeapSnapshotDataGridTree{get alwaysShowRetainedSize(){return!0}populateTopLevel(){this.heapSnapshot.instancesWithClassName("GlobalObject",e=>{for(let t of e)this.appendChild(new WI.HeapSnapshotInstanceDataGridNode(t,this))}),this.heapSnapshot.instancesWithClassName("Window",e=>{for(let t of e)t.dominatorNodeIdentifier===0&&this.appendChild(new WI.HeapSnapshotInstanceDataGridNode(t,this));this.didPopulate()})}};WI.HeapSnapshotInstanceDataGridNode=class extends WI.DataGridNode{constructor(e,t,i,n){let s=e.hasChildren&&e.className!=="string";super(e,s),console.assert(e instanceof WI.HeapSnapshotNodeProxy),console.assert(!i||i instanceof WI.HeapSnapshotEdgeProxy),console.assert(!n||n instanceof WI.HeapSnapshotInstanceDataGridNode),this._node=e,this._tree=t,this._edge=i||null,this._base=n||null,this.copyable=!1,s&&this.addEventListener("populate",this._populate,this)}static logHeapSnapshotNode(e){e.shortestGCRootPath(t=>{let i=WI.UIString("Heap Snapshot Object (%s)").format("@"+e.id),n=!t.length;if(t.length){t=t.slice().reverse();let a=t.findIndex(p=>p instanceof WI.HeapSnapshotNodeProxy&&p.className==="Window"),d=WI.HeapSnapshotRootPath.emptyPath();for(let p=a===-1?0:a;p<t.length;++p){let f=t[p];f instanceof WI.HeapSnapshotNodeProxy?f.className==="Window"&&(d=d.appendGlobalScopeName(f,"window")):f instanceof WI.HeapSnapshotEdgeProxy&&(d=d.appendEdge(f))}d.isFullPathImpossible()?n=!0:i=d.fullPath}const s=!0;e.className==="string"?HeapAgent.getPreview(e.id,function(a,d,p,f){let _=a?WI.RemoteObject.fromPrimitiveValue(void 0):WI.RemoteObject.fromPrimitiveValue(d);WI.consoleLogViewController.appendImmediateExecutionWithResult(i,_,n,s)}):HeapAgent.getRemoteObject(e.id,WI.RuntimeManager.ConsoleObjectGroup,function(a,d){let p=a?WI.RemoteObject.fromPrimitiveValue(void 0):WI.RemoteObject.fromPayload(d,WI.assumingMainTarget());WI.consoleLogViewController.appendImmediateExecutionWithResult(i,p,n,s)})})}get data(){return this._node}get node(){return this._node}get propertyName(){return this._edge?(this._propertyName||(this._propertyName=WI.HeapSnapshotRootPath.pathComponentForIndividualEdge(this._edge)),this._propertyName):""}createCells(){super.createCells(),this.element.classList.add("instance")}createCellContent(e){if(e==="retainedSize"){let t=!1;if(this._base&&!this._tree.alwaysShowRetainedSize){if(this._isDominatedByNonBaseParent())t=!0;else if(!this._isDominatedByBase())return emDash}let i=this._node.retainedSize,n=document.createDocumentFragment(),s=n.appendChild(document.createElement("span"));s.classList.add("size"),s.textContent=Number.bytesToString(i);let a=i/this._tree._heapSnapshot.totalSize,d=n.appendChild(document.createElement("span"));return d.classList.add("percentage"),d.textContent=Number.percentageString(a),t&&(s.classList.add("sub-retained"),d.classList.add("sub-retained")),n}if(e==="size")return Number.bytesToString(this._node.size);if(e==="className"){let{className:t,id:i,internal:n,isObjectType:s}=this._node,a=document.createElement("span");if(a.addEventListener("contextmenu",this._contextMenuHandler.bind(this)),a.appendChild(document.createElement("img")).classList.add("icon",WI.HeapSnapshotClusterContentView.iconStyleClassNameForClassName(t,n,s)),this._edge){let _=a.appendChild(document.createElement("span")),b=this.propertyName;b?_.textContent=b+": "+this._node.className+" ":_.textContent=this._node.className+" "}let p=a.appendChild(document.createElement("span"));p.classList.add("object-id"),p.textContent="@"+i,p.addEventListener("click",WI.HeapSnapshotInstanceDataGridNode.logHeapSnapshotNode.bind(null,this._node)),p.addEventListener("mouseover",this._mouseoverHandler.bind(this));let f=a.appendChild(document.createElement("span"));return f.textContent=" ",t==="Window"&&this._node.dominatorNodeIdentifier===0?(a.append("Window "),this._populateWindowPreview(a)):this._populatePreview(a),a}return super.createCellContent(e)}sort(){let e=this.children;e.sort(this._tree._sortComparator);for(let t=0;t<e.length;++t)e[t]._recalculateSiblings(t),e[t].sort()}_isDominatedByBase(){return this._node.dominatorNodeIdentifier===this._base.node.id}_isDominatedByNonBaseParent(){for(let e=this.parent;e;e=e.parent){if(e===this._base)return!1;if(this._node.dominatorNodeIdentifier===e.node.id)return!0}return!1}_populate(){this.removeEventListener("populate",this._populate,this);function e(t){return t?WI.HeapSnapshotRootPath.pathComponentForIndividualEdge(t):""}this._node.retainedNodes((t,i)=>{for(let n=0;n<t.length;++n)t[n].__edge=i[n];t.sort((n,s)=>{let a={data:n,propertyName:e(n.__edge)},d={data:s,propertyName:e(s.__edge)};return this._tree._sortComparator(a,d)});for(let n of t)n.__edge&&n.__edge.isPrivateSymbol()||this.appendChild(new WI.HeapSnapshotInstanceDataGridNode(n,this._tree,n.__edge,this._base||this))})}_contextMenuHandler(e){let t=WI.ContextMenu.createFromEvent(e);t.appendSeparator(),t.appendItem(WI.UIString("Log Value"),WI.HeapSnapshotInstanceDataGridNode.logHeapSnapshotNode.bind(null,this._node))}_populateError(e){if(this._node.internal)return;let t=e.appendChild(document.createElement("span"));t.classList.add("preview-error"),t.textContent=WI.UIString("No preview available")}_populateWindowPreview(e){HeapAgent.getRemoteObject(this._node.id,(t,i)=>{if(t){this._populateError(e);return}function n(){return this.location.href}let s=WI.RemoteObject.fromPayload(i,WI.assumingMainTarget());s.callFunctionJSON(n,void 0,a=>{if(s.release(),!a)this._populateError(e);else{let d=WI.RemoteObject.fromPrimitiveValue(a);e.appendChild(WI.FormattedValue.createElementForRemoteObject(d))}})})}_populatePreview(e){HeapAgent.getPreview(this._node.id,(t,i,n,s)=>{if(t){this._populateError(e);return}if(i){let a=WI.RemoteObject.fromPrimitiveValue(i);e.appendChild(WI.FormattedValue.createElementForRemoteObject(a));return}if(n){let{location:a,name:d,displayName:p}=n,f=e.appendChild(document.createElement("span"));f.classList.add("function-name"),f.textContent=d||p||WI.UIString("(anonymous function)");let _=WI.debuggerManager.scriptForIdentifier(a.scriptId,WI.assumingMainTarget());if(_){let b=e.appendChild(document.createElement("span"));b.classList.add("location");let w=_.createSourceCodeLocation(a.lineNumber,a.columnNumber);w.populateLiveDisplayLocationString(b,"textContent",WI.SourceCodeLocation.ColumnStyle.Hidden,WI.SourceCodeLocation.NameStyle.Short);const S={dontFloat:!0,useGoToArrowButton:!0,ignoreNetworkTab:!0,ignoreSearchTab:!0};let E=WI.createSourceCodeLocationLink(w,S);e.appendChild(E)}return}if(s){let a=WI.ObjectPreview.fromPayload(s),d=WI.FormattedValue.createObjectPreviewOrFormattedValueForObjectPreview(a);e.appendChild(d);return}})}_mouseoverHandler(e){let t=WI.Rect.rectFromClientRect(e.target.getBoundingClientRect());if(!t.size.width&&!t.size.height||this._tree.popoverGridNode===this._node)return;this._tree.popoverGridNode=this._node,this._tree.popoverTargetElement=e.target;let i=document.createElement("div");i.classList.add("heap-snapshot","heap-snapshot-instance-popover-content");function n(f){let _=document.createElement("span");_.classList.add("object-id"),_.textContent="@"+f.id,_.addEventListener("click",WI.HeapSnapshotInstanceDataGridNode.logHeapSnapshotNode.bind(null,f));let b=i.appendChild(document.createElement("div"));b.classList.add("title");let w=WI.UIString("Shortest property path to %s").format("@@@"),[S,E]=w.split(/\s*@@@\s*/);b.append(S+" ",_," "+E)}function s(f){let _=i.appendChild(document.createElement("div"));_.classList.add("table-container");let b=_.appendChild(document.createElement("table"));f=f.slice().reverse();let w=f.findIndex(E=>E instanceof WI.HeapSnapshotNodeProxy&&E.className==="Window"),S=null;for(let E=w===-1?0:w;E<f.length;++E){let k=f[E];if(k instanceof WI.HeapSnapshotEdgeProxy){S=k;continue}a(b,S,k),S=null}}function a(f,_,b){let w=f.appendChild(document.createElement("tr")),S=w.appendChild(document.createElement("td"));if(S.classList.add("edge-name"),b.className==="Window")S.textContent="window";else if(_){let V=p(_);S.textContent=typeof V=="string"?V:emDash}else S.textContent=emDash;S.textContent.length>10&&(S.title=S.textContent);let E=w.appendChild(document.createElement("td"));E.classList.add("object-data");let k=E.appendChild(document.createElement("div"));k.classList.add("node"),k.appendChild(document.createElement("img")).classList.add("icon",WI.HeapSnapshotClusterContentView.iconStyleClassNameForClassName(b.className,b.internal,b.isObjectType));let M=k.appendChild(document.createElement("span"));M.textContent=d(b.className)+" ";let L=k.appendChild(document.createElement("span"));if(L.classList.add("object-id"),L.textContent="@"+b.id,L.addEventListener("click",WI.HeapSnapshotInstanceDataGridNode.logHeapSnapshotNode.bind(null,b)),b.className==="Function"){let V=k.appendChild(document.createElement("span"));V.style.display="inline-block",V.style.width="10px",HeapAgent.getPreview(b.id,function(H,O,z,K){if(z){let q=z.location,Y=WI.debuggerManager.scriptForIdentifier(q.scriptId,WI.assumingMainTarget());if(Y){let se=Y.createSourceCodeLocation(q.lineNumber,q.columnNumber);const ce={dontFloat:!0,useGoToArrowButton:!0,ignoreNetworkTab:!0,ignoreSearchTab:!0};let le=WI.createSourceCodeLocationLink(se,ce);k.replaceChild(le,V)}}})}}function d(f){return f.endsWith("LexicalEnvironment")?WI.UIString("Scope"):f}function p(f){switch(f.type){case WI.HeapSnapshotEdgeProxy.EdgeType.Property:case WI.HeapSnapshotEdgeProxy.EdgeType.Variable:return/^(?![0-9])\w+$/.test(f.data)?f.data:"["+doubleQuotedString(f.data)+"]";case WI.HeapSnapshotEdgeProxy.EdgeType.Index:return"["+f.data+"]";case WI.HeapSnapshotEdgeProxy.EdgeType.Internal:default:return null}}this._node.shortestGCRootPath(f=>{if(!!this._tree.visible){if(f.length)n(this._node),s(f);else if(this._node.gcRoot){let _=i.appendChild(document.createElement("div"));_.textContent=WI.UIString("This object is a root")}else{let _=i.appendChild(document.createElement("div"));_.textContent=WI.UIString("This object is referenced by internal objects")}this._tree.popover.presentNewContentWithFrame(i,t.pad(2),[WI.RectEdge.MAX_Y,WI.RectEdge.MIN_Y,WI.RectEdge.MAX_X])}})}};WI.HeapSnapshotInstanceFetchMoreDataGridNode=class extends WI.DataGridNode{constructor(e,t,i,n){super({},!1),console.assert(typeof t=="number"),console.assert(typeof i=="number"),console.assert(typeof n=="function"),this._tree=e,this._batchCount=t,this._remainingCount=i,this._fetchCallback=n}createCellContent(e){if(e!=="className")return"";let t=document.createDocumentFragment();if(this._batchCount){let n=t.appendChild(document.createElement("span"));n.classList.add("more"),n.textContent=WI.UIString("Show %d More").format(this._batchCount),n.addEventListener("click",s=>{this._fetchCallback(this._batchCount)})}let i=t.appendChild(document.createElement("span"));return i.classList.add("more"),i.textContent=WI.UIString("Show Remaining (%d)").format(this._remainingCount),i.addEventListener("click",n=>{this._fetchCallback(this._remainingCount)}),t}sort(){}};WI.HierarchicalPathNavigationItem=class extends WI.NavigationItem{constructor(e,t){super(e),this._collapsedComponent=null,this._needsUpdate=!1,this.components=t}get components(){return this._components}set components(e){e||(e=[]);let t=function(i,n){let s=b=>b.representedObject,a=i.map(s),d=n.map(s);if(!Array.shallowEqual(a,d))return!1;let p=b=>b.comparisonData,f=i.map(p),_=n.map(p);return Array.shallowEqual(f,_)};if(!(this._components&&t(this._components,e))){if(this._components)for(let i of this._components)i.removeEventListener(WI.HierarchicalPathComponent.Event.SiblingWasSelected,this._siblingPathComponentWasSelected,this);this._components=e.slice(0);for(let i of this._components)i.addEventListener(WI.HierarchicalPathComponent.Event.SiblingWasSelected,this._siblingPathComponentWasSelected,this);this._needsUpdate=!0,this.parentNavigationBar&&this.parentNavigationBar.needsLayout()}}get lastComponent(){return this._components.lastValue||null}get alwaysShowLastPathComponentSeparator(){return this.element.classList.contains(WI.HierarchicalPathNavigationItem.AlwaysShowLastPathComponentSeparatorStyleClassName)}set alwaysShowLastPathComponentSeparator(e){e?this.element.classList.add(WI.HierarchicalPathNavigationItem.AlwaysShowLastPathComponentSeparatorStyleClassName):this.element.classList.remove(WI.HierarchicalPathNavigationItem.AlwaysShowLastPathComponentSeparatorStyleClassName)}updateLayout(e){this._updateComponentsIfNeeded(),super.updateLayout(e);var t=this.parentNavigationBar;if(!!t){this._collapsedComponent&&(this.element.removeChild(this._collapsedComponent.element),this._collapsedComponent=null);for(var w=0;w<this._components.length;++w)this._components[w].hidden=!1,this._components[w].forcedWidth=null,this._components[w].hideTooltip=!0;if(!e&&!t.sizesToFit){for(var i=0,w=0;w<t.navigationItems.length;++w)t.navigationItems[w]!==this&&(t.navigationItems[w]instanceof WI.FlexibleSpaceNavigationItem||(i+=t.navigationItems[w].element.realOffsetWidth));for(var n=0,s=[],w=0;w<this._components.length;++w){var a=this._components[w].element.realOffsetWidth;s.push(a),n+=a}var d=t.element.realOffsetWidth;if(!(i+n<=d)){for(var p=i+n-d,w=0;w<this._components.length;++w){var a=s[w];this._components[w].hideTooltip=!1;var f=a-p;if(this._components[w].forcedWidth=f,s[w]=Math.max(this._components[w].minimumWidth,f),p-=a-s[w],p<=0)break}if(!(p<=0)&&!(this._components.length<=3)){var _=this._components.length>>1,b=-1,w=_;this._collapsedComponent=new WI.HierarchicalPathComponent(ellipsis,[]),this._collapsedComponent.collapsed=!0,this.element.insertBefore(this._collapsedComponent.element,this._components[_].element),p+=this._collapsedComponent.minimumWidth;for(var S=[];w>=0&&w<=this._components.length-1;){if(w>0&&w<this._components.length-1){var E=this._components[w];if(E.hidden=!0,b>0?S.unshift(E.displayName):S.push(E.displayName),p-=s[w],p<=0)break}w=_+b,b>0&&++b,b*=-1}this._collapsedComponent.element.title=S.join(`
`)}}}}}get additionalClassNames(){return["hierarchical-path"]}_updateComponentsIfNeeded(){if(!!this._needsUpdate){this._needsUpdate=!1,this.element.removeChildren(),this._collapsedComponent=null;for(let e of this._components)this.element.appendChild(e.element)}}_siblingPathComponentWasSelected(e){this.dispatchEventToListeners(WI.HierarchicalPathNavigationItem.Event.PathComponentWasSelected,e.data)}};WI.HierarchicalPathNavigationItem.AlwaysShowLastPathComponentSeparatorStyleClassName="always-show-last-path-component-separator";WI.HierarchicalPathNavigationItem.Event={PathComponentWasSelected:"hierarchical-path-navigation-item-path-component-was-selected"};WI.HoverMenu=class extends WI.Object{constructor(e){super(),this.delegate=e,this._element=document.createElement("div"),this._element.className="hover-menu",this._element.addEventListener("transitionend",this,!0),this._outlineElement=this._element.appendChild(document.createElementNS("http://www.w3.org/2000/svg","svg")),this._button=this._element.appendChild(document.createElement("img")),this._button.addEventListener("click",this)}get element(){return this._element}present(e){this._outlineElement.textContent="",document.body.appendChild(this._element),this._drawOutline(e),this._element.classList.add(WI.HoverMenu.VisibleClassName),window.addEventListener("scroll",this,!0)}dismiss(e){this._element.parentNode===document.body&&(e&&this._element.remove(),this._element.classList.remove(WI.HoverMenu.VisibleClassName),window.removeEventListener("scroll",this,!0))}handleEvent(e){switch(e.type){case"scroll":this._element.contains(e.target)||this.dismiss(!0);break;case"click":this._handleClickEvent(e);break;case"transitionend":this._element.classList.contains(WI.HoverMenu.VisibleClassName)||this._element.remove();break}}_handleClickEvent(e){this.delegate&&typeof this.delegate.hoverMenuButtonWasPressed=="function"&&this.delegate.hoverMenuButtonWasPressed(this)}_drawOutline(e){var t=this._button.width,i=this._button.height,n=e.pop();n.size.width+=t,e.push(n),e.length===1?this._drawSingleLine(e[0]):e.length===2&&e[0].minX()>=e[1].maxX()?this._drawTwoNonOverlappingLines(e):this._drawOverlappingLines(e);var s=WI.Rect.unionOfRects(e).pad(3),a=this._element.style;a.left=s.minX()+"px",a.top=s.minY()+"px",a.width=s.size.width+"px",a.height=s.size.height+"px",this._outlineElement.style.width=s.size.width+"px",this._outlineElement.style.height=s.size.height+"px",this._button.style.left=n.maxX()-s.minX()-t+"px",this._button.style.top=n.maxY()-s.minY()-i+"px"}_addRect(e){var t=4,i=document.createElementNS("http://www.w3.org/2000/svg","rect");return i.setAttribute("x",1),i.setAttribute("y",1),i.setAttribute("width",e.size.width),i.setAttribute("height",e.size.height),i.setAttribute("rx",t),i.setAttribute("ry",t),this._outlineElement.appendChild(i)}_addPath(e,t,i){var n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",e.join(" ")),n.setAttribute("transform","translate("+(t+1)+","+(i+1)+")"),this._outlineElement.appendChild(n)}_drawSingleLine(e){this._addRect(e.pad(2))}_drawTwoNonOverlappingLines(e){var t=4,i=e[0].pad(2),n=e[1].pad(2),s=-n.minX(),a=-i.minY(),d=i;this._addPath(["M",d.maxX(),d.minY(),"H",d.minX()+t,"q",-t,0,-t,t,"V",d.maxY()-t,"q",0,t,t,t,"H",d.maxX()],s,a),d=n,this._addPath(["M",d.minX(),d.minY(),"H",d.maxX()-t,"q",t,0,t,t,"V",d.maxY()-t,"q",0,t,-t,t,"H",d.minX()],s,a)}_drawOverlappingLines(e){var t=2,i=4,n=Number.MAX_VALUE,s=-Number.MAX_VALUE;for(var a of e)var n=Math.min(a.minX(),n),s=Math.max(a.maxX(),s);n-=t,s+=t;var d=e[0].minY()-t,p=e.lastValue.maxY()+t,f=e[0].minX()-t,_=e.lastValue.maxX()+t;if(f===n&&_===s)return this._addRect(new WI.Rect(n,d,s-n,p-d));var b=e.lastValue.minY()+t;if(e[0].minX()===n+t)return this._addPath(["M",n+i,d,"H",s-i,"q",i,0,i,i,"V",b-i,"q",0,i,-i,i,"H",_+i,"q",-i,0,-i,i,"V",p-i,"q",0,i,-i,i,"H",n+i,"q",-i,0,-i,-i,"V",d+i,"q",0,-i,i,-i],-n,-d);var w=e[0].maxY()-t;return e.lastValue.maxX()===s-t?this._addPath(["M",f+i,d,"H",s-i,"q",i,0,i,i,"V",p-i,"q",0,i,-i,i,"H",n+i,"q",-i,0,-i,-i,"V",w+i,"q",0,-i,i,-i,"H",f-i,"q",i,0,i,-i,"V",d+i,"q",0,-i,i,-i],-n,-d):this._addPath(["M",f+i,d,"H",s-i,"q",i,0,i,i,"V",b-i,"q",0,i,-i,i,"H",_+i,"q",-i,0,-i,i,"V",p-i,"q",0,i,-i,i,"H",n+i,"q",-i,0,-i,-i,"V",w+i,"q",0,-i,i,-i,"H",f-i,"q",i,0,i,-i,"V",d+i,"q",0,-i,i,-i],-n,-d)}};WI.HoverMenu.VisibleClassName="visible";WI.IdleTreeElement=class extends WI.GeneralTreeElement{constructor(){super("idle",WI.UIString("Idle"))}};WI.ImageResourceContentView=class extends WI.ResourceContentView{constructor(e){super(e,"image"),this._imageElement=null;const t=WI.UIString("Show Grid"),i=WI.UIString("Hide Grid");this._showGridButtonNavigationItem=new WI.ActivateButtonNavigationItem("show-grid",t,i,"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 13'%3e %3crect fill='none' stroke='currentColor' stroke-width='1' x='0.5' y='0.5' width='12' height='12'/%3e %3crect fill='currentColor' opacity='0.5' x='1' y='1' width='5.5' height='5.5'/%3e %3crect fill='currentColor' opacity='0.5' x='6.5' y='6.5' width='5.5' height='5.5'/%3e %3c/svg%3e",13,13),this._showGridButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._showGridButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._showGridButtonClicked,this),this._showGridButtonNavigationItem.activated=!!WI.settings.showImageGrid.value}get navigationItems(){return[this._showGridButtonNavigationItem]}contentAvailable(e,t){if(this.removeLoadingIndicator(),!e){this.showGenericNoContentMessage();return}let i=this.resource.createObjectURL();if(!i){this.showGenericErrorMessage();return}this._imageElement=document.createElement("img"),this._imageElement.addEventListener("load",function(){URL.revokeObjectURL(i)}),this._imageElement.src=i,this._imageElement.setAttribute("filename",this.resource.urlComponents.lastPathComponent||""),this._updateImageGrid(),this.element.appendChild(this._imageElement)}shown(){super.shown(),this._updateImageGrid(),WI.settings.showImageGrid.addEventListener(WI.Setting.Event.Changed,this._updateImageGrid,this)}hidden(){WI.settings.showImageGrid.removeEventListener(WI.Setting.Event.Changed,this._updateImageGrid,this),super.hidden()}_updateImageGrid(){if(!this._imageElement)return;let e=WI.settings.showImageGrid.value;this._showGridButtonNavigationItem.activated=e,this._imageElement.classList.toggle("show-grid",e)}_showGridButtonClicked(e){WI.settings.showImageGrid.value=!this._showGridButtonNavigationItem.activated,this._updateImageGrid()}};WI.IndeterminateProgressSpinner=class extends WI.Object{constructor(){super(),this._element=document.createElement("div"),this._element.classList.add("indeterminate-progress-spinner")}get element(){return this._element}};WI.IndexedDatabaseContentView=class extends WI.ContentView{constructor(e){super(e),this._element.classList.add("indexed-database"),this._databaseHostRow=new WI.DetailsSectionSimpleRow(WI.UIString("Host")),this._databaseSecurityOriginRow=new WI.DetailsSectionSimpleRow(WI.UIString("Security Origin")),this._databaseVersionRow=new WI.DetailsSectionSimpleRow(WI.UIString("Version")),this._databaseGroup=new WI.DetailsSectionGroup([this._databaseHostRow,this._databaseSecurityOriginRow,this._databaseVersionRow]),this._databaseSection=new WI.DetailsSection("indexed-database-details",WI.UIString("Database"),[this._databaseGroup]),this.element.append(this._databaseSection.element),this._databaseHostRow.value=e.host,this._databaseSecurityOriginRow.value=e.securityOrigin,this._databaseVersionRow.value=e.version.toLocaleString()}};WI.IndexedDatabaseDetailsSidebarPanel=class extends WI.DetailsSidebarPanel{constructor(){super("indexed-database-details",WI.UIString("Storage")),this.element.classList.add("indexed-database"),this._database=null,this._objectStore=null,this._index=null}inspect(e){e instanceof Array||(e=[e]),this._database=null,this._objectStore=null,this._index=null;for(let i of e)i instanceof WI.IndexedDatabaseObjectStore?(console.assert(!this._database,"Shouldn't have multiple IndexedDatabase objects in the list."),this._objectStore=i,this._database=this._objectStore.parentDatabase):i instanceof WI.IndexedDatabaseObjectStoreIndex&&(console.assert(!this._database,"Shouldn't have multiple IndexedDatabase objects in the list."),this._index=i,this._objectStore=this._index.parentObjectStore,this._database=this._objectStore.parentDatabase);let t=this._database||this._objectStore||this._index;return t&&this.needsLayout(),t}initialLayout(){super.initialLayout(),this._databaseNameRow=new WI.DetailsSectionSimpleRow(WI.UIString("Name")),this._databaseVersionRow=new WI.DetailsSectionSimpleRow(WI.UIString("Version")),this._databaseSecurityOriginRow=new WI.DetailsSectionSimpleRow(WI.UIString("Security Origin"));let e=new WI.DetailsSectionGroup([this._databaseNameRow,this._databaseVersionRow,this._databaseSecurityOriginRow]);this._databaseSection=new WI.DetailsSection("indexed-database-database",WI.UIString("Database"),[e]),this._objectStoreNameRow=new WI.DetailsSectionSimpleRow(WI.UIString("Name")),this._objectStoreKeyPathRow=new WI.DetailsSectionSimpleRow(WI.UIString("Key Path")),this._objectStoreAutoIncrementRow=new WI.DetailsSectionSimpleRow(WI.UIString("Auto Increment"));let t=new WI.DetailsSectionGroup([this._objectStoreNameRow,this._objectStoreKeyPathRow,this._objectStoreAutoIncrementRow]);this._objectStoreSection=new WI.DetailsSection("indexed-database-object-store",WI.UIString("Object Store"),[t]),this._indexNameRow=new WI.DetailsSectionSimpleRow(WI.UIString("Name")),this._indexKeyPathRow=new WI.DetailsSectionSimpleRow(WI.UIString("Key Path")),this._indexUniqueRow=new WI.DetailsSectionSimpleRow(WI.UIString("Unique")),this._indexMultiEntryRow=new WI.DetailsSectionSimpleRow(WI.UIString("Multi-Entry"));let i=new WI.DetailsSectionGroup([this._indexNameRow,this._indexKeyPathRow,this._indexUniqueRow,this._indexMultiEntryRow]);this._indexSection=new WI.DetailsSection("indexed-database-index",WI.UIString("Index"),[i]),this.contentView.element.appendChild(this._databaseSection.element),this.contentView.element.appendChild(this._objectStoreSection.element),this.contentView.element.appendChild(this._indexSection.element)}layout(){super.layout(),this._database?(this._databaseSection.element.hidden=!1,this._databaseSecurityOriginRow.value=this._database.securityOrigin,this._databaseNameRow.value=this._database.name,this._databaseVersionRow.value=this._database.version.toLocaleString()):this._databaseSection.element.hidden=!0,this._objectStore?(this._objectStoreSection.element.hidden=!1,this._objectStoreNameRow.value=this._objectStore.name,this._objectStoreKeyPathRow.value=this._keyPathString(this._objectStore.keyPath),this._objectStoreAutoIncrementRow.value=this._objectStore.autoIncrement?WI.UIString("Yes"):WI.UIString("No")):this._objectStoreSection.element.hidden=!0,this._index?(this._indexSection.element.hidden=!1,this._indexNameRow.value=this._index.name,this._indexKeyPathRow.value=this._keyPathString(this._index.keyPath),this._indexUniqueRow.value=this._index.unique?WI.UIString("Yes"):WI.UIString("No"),this._index.keyPath.type!==IndexedDBAgent.KeyPathType.Array?this._indexMultiEntryRow.value=null:this._indexMultiEntryRow.value=this._index.multiEntry?WI.UIString("Yes"):WI.UIString("No")):this._indexSection.element.hidden=!0}_keyPathString(e){return e?JSON.stringify(e):emDash}};WI.IndexedDatabaseEntryDataGridNode=class extends WI.DataGridNode{constructor(e){super(e),this._entry=e}get entry(){return this._entry}createCellContent(e,t){var i=this._entry[e];return i instanceof WI.RemoteObject?WI.FormattedValue.createObjectTreeOrFormattedValueForRemoteObject(i,null,!0):super.createCellContent(e,t)}};WI.IndexedDatabaseHostTreeElement=class extends WI.StorageTreeElement{constructor(e){super(WI.FolderTreeElement.FolderIconStyleClassName,WI.displayNameForHost(e),null),this._host=e,this.hasChildren=!0,this.expanded=!0}get name(){return WI.displayNameForHost(this._host)}get categoryName(){return WI.UIString("Indexed Databases")}};WI.IndexedDatabaseObjectStoreContentView=class extends WI.ContentView{constructor(e){super(e),this.element.classList.add("indexed-database-object-store"),e instanceof WI.IndexedDatabaseObjectStore?(this._objectStore=e,this._objectStoreIndex=null):e instanceof WI.IndexedDatabaseObjectStoreIndex&&(this._objectStore=e.parentObjectStore,this._objectStoreIndex=e);function t(a){return a?a instanceof Array?a.join(WI.UIString(", ")):(console.assert(a instanceof String||typeof a=="string"),a):""}var i=t(this._objectStore.keyPath),n={primaryKey:{title:i?WI.UIString("Primary Key \u2014 %s").format(i):WI.UIString("Primary Key")},key:{},value:{title:WI.UIString("Value")}};if(this._objectStoreIndex){var s=t(this._objectStoreIndex.keyPath);n.key.title=WI.UIString("Index Key \u2014 %s").format(s)}else delete n.key;this._dataGrid=new WI.DataGrid(n),this._dataGrid.variableHeightRows=!0,this._dataGrid.scrollContainer.addEventListener("scroll",this._dataGridScrolled.bind(this)),this.addSubview(this._dataGrid),this._entries=[],this._fetchingMoreData=!1,this._fetchMoreData(),this._refreshButtonNavigationItem=new WI.ButtonNavigationItem("indexed-database-object-store-refresh",WI.UIString("Refresh"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='1 1 13 13'%3e %3cpath fill='currentColor' d='M 12.007 8.01 L 12.007 8.488 L 12 8.488 C 12 10.974 9.985 12.988 7.5 12.988 C 5.015 12.988 3 10.974 3 8.488 C 3 6.17 4.759 4.284 7.012 4.037 L 7.012 6.549 L 11.519 3.775 L 7.012 1 L 7.012 3.013 C 4.203 3.26 2 5.615 2 8.488 C 2 11.526 4.462 13.988 7.5 13.988 C 10.509 13.988 12.95 11.571 12.996 8.572 L 13 8.572 L 13 8.01 L 12.007 8.01 Z'/%3e %3c/svg%3e",13,13),this._refreshButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._refreshButtonClicked,this),this._clearButtonNavigationItem=new WI.ButtonNavigationItem("indexed-database-object-store-clear",WI.UIString("Clear object store"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' d='M 3.5 12.5 l -1 -10 h -1 h 11.9 h -1 l -1 10 H 3.5 z'/%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' d='M 5.5 2 L 5.5 0.5 L 9.5 0.5 L 9.5 2'/%3e %3cline fill='none' stroke='currentColor' stroke-linecap='round' x1='5.5' y1='9.2' x2='9.4' y2='5.3'/%3e %3cline fill='none' stroke='currentColor' stroke-linecap='round' x1='5.5' y1='5.2' x2='9.4' y2='9.2'/%3e %3c/svg%3e",15,15),this._clearButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._clearButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._clearButtonClicked,this)}get navigationItems(){return[this._refreshButtonNavigationItem,this._clearButtonNavigationItem]}closed(){super.closed(),this._reset()}saveToCookie(e){e.type=WI.ContentViewCookieType.IndexedDatabaseObjectStore,e.securityOrigin=this._objectStore.parentDatabase.securityOrigin,e.databaseName=this._objectStore.parentDatabase.name,e.objectStoreName=this._objectStore.name,e.objectStoreIndexName=this._objectStoreIndex&&this._objectStoreIndex.name}get scrollableElements(){return[this._dataGrid.scrollContainer]}_reset(){for(var e of this._entries)e.primaryKey.release(),e.key.release(),e.value.release();this._entries=[],this._dataGrid.removeChildren()}_dataGridScrolled(){!this._moreEntriesAvailable||!this._dataGrid.isScrolledToLastRow()||this._fetchMoreData()}_fetchMoreData(){if(this._fetchingMoreData)return;function e(t,i){this._entries=this._entries.concat(t),this._moreEntriesAvailable=i;for(var n of t){var s=new WI.IndexedDatabaseEntryDataGridNode(n);this._dataGrid.appendChild(s)}this._fetchingMoreData=!1,i&&this._dataGrid.isScrolledToLastRow()&&this._fetchMoreData()}this._fetchingMoreData=!0,WI.indexedDBManager.requestIndexedDatabaseData(this._objectStore,this._objectStoreIndex,this._entries.length,25,e.bind(this))}_refreshButtonClicked(){this._reset(),this._fetchMoreData()}_clearButtonClicked(){WI.indexedDBManager.clearObjectStore(this._objectStore),this._reset()}};WI.IndexedDatabaseObjectStoreIndexTreeElement=class extends WI.GeneralTreeElement{constructor(e){console.assert(e instanceof WI.IndexedDatabaseObjectStoreIndex);const t=null;super("database-table-icon",e.name,t,e),this._objectStoreIndex=e}get objectStoreIndex(){return this._objectStoreIndex}};WI.IndexedDatabaseObjectStoreTreeElement=class extends WI.GeneralTreeElement{constructor(e){console.assert(e instanceof WI.IndexedDatabaseObjectStore);const t=null;super("database-table-icon",e.name,t,e,{hasChildren:!!e.indexes.length}),this._objectStore=e}get objectStore(){return this._objectStore}oncollapse(){this.shouldRefreshChildren=!0}onpopulate(){if(!(this.children.length&&!this.shouldRefreshChildren)){this.shouldRefreshChildren=!1,this.removeChildren();for(var e of this._objectStore.indexes)this.appendChild(new WI.IndexedDatabaseObjectStoreIndexTreeElement(e))}}};WI.IndexedDatabaseTreeElement=class extends WI.GeneralTreeElement{constructor(e){console.assert(e instanceof WI.IndexedDatabase);const t=null;super("database-icon",e.name,t,e,{hasChildren:!!e.objectStores.length}),this._indexedDatabase=e}get indexedDatabase(){return this._indexedDatabase}oncollapse(){this.shouldRefreshChildren=!0}onpopulate(){if(!(this.children.length&&!this.shouldRefreshChildren)){this.shouldRefreshChildren=!1,this.removeChildren();for(var e of this._indexedDatabase.objectStores)this.appendChild(new WI.IndexedDatabaseObjectStoreTreeElement(e))}}};WI.InlineSwatch=class extends WI.Object{constructor(e,t,i){if(super(),this._type=e,this._type===WI.InlineSwatch.Type.Bezier||this._type===WI.InlineSwatch.Type.Spring?this._swatchElement=WI.ImageUtilities.useSVGSymbol("data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect fill='currentColor' x='0' y='0' width='16' height='16' rx='3' ry='3'/%3e %3cpath fill='none' stroke='white' stroke-width='3' d='M 4 14 C 4.5 2.5 11.5 13.5 12 2'/%3e %3c/svg%3e"):this._type===WI.InlineSwatch.Type.Variable?this._swatchElement=WI.ImageUtilities.useSVGSymbol("data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Devin Rousso %3cwebkit%40devinrousso.com%3e. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect fill='currentColor' x='0' y='0' width='16' height='16' rx='3' ry='3'/%3e %3crect fill='white' x='3.5' y='4.5' width='9' height='2.5'/%3e %3crect fill='white' x='3.5' y='9' width='9' height='2.5'/%3e %3c/svg%3e"):this._swatchElement=document.createElement("span"),this._swatchElement.classList.add("inline-swatch",this._type.split("-").lastValue),i)this._swatchElement.classList.add("read-only");else{switch(this._type){case WI.InlineSwatch.Type.Color:this._swatchElement.title=WI.UIString(`Click to select a color
Shift-click to switch color formats`);break;case WI.InlineSwatch.Type.Gradient:this._swatchElement.title=WI.UIString("Edit custom gradient");break;case WI.InlineSwatch.Type.Bezier:this._swatchElement.title=WI.UIString("Edit \u201Ccubic-bezier\u201D function");break;case WI.InlineSwatch.Type.Spring:this._swatchElement.title=WI.UIString("Edit \u201Cspring\u201D function");break;case WI.InlineSwatch.Type.Variable:this._swatchElement.title=WI.UIString(`Click to view variable value
Shift-click to replace variable with value`);break;case WI.InlineSwatch.Type.Image:this._swatchElement.title=WI.UIString("View Image");break;default:WI.reportInternalError(`Unknown InlineSwatch type "${e}"`);break}this._swatchElement.addEventListener("click",this._swatchElementClicked.bind(this)),this._type===WI.InlineSwatch.Type.Color&&this._swatchElement.addEventListener("contextmenu",this._handleContextMenuEvent.bind(this))}this._swatchInnerElement=this._swatchElement.createChild("span"),this._value=t||this._fallbackValue(),this._valueEditor=null,this._updateSwatch()}get element(){return this._swatchElement}get value(){return this._value}set value(e){this._value=e,this._updateSwatch(!0)}didDismissPopover(e){!this._valueEditor||(this._valueEditor.removeListeners&&this._valueEditor.removeListeners(),this._valueEditor instanceof WI.Object&&this._valueEditor.removeEventListener(null,null,this),this._valueEditor=null,this.dispatchEventToListeners(WI.InlineSwatch.Event.Deactivated))}_fallbackValue(){switch(this._type){case WI.InlineSwatch.Type.Bezier:return WI.CubicBezier.fromString("linear");case WI.InlineSwatch.Type.Gradient:return WI.Gradient.fromString("linear-gradient(transparent, transparent)");case WI.InlineSwatch.Type.Spring:return WI.Spring.fromString("1 100 10 0");case WI.InlineSwatch.Type.Color:return WI.Color.fromString("white");default:return null}}_updateSwatch(e){this._type===WI.InlineSwatch.Type.Color||this._type===WI.InlineSwatch.Type.Gradient?this._swatchInnerElement.style.background=this._value?this._value.toString():null:this._type===WI.InlineSwatch.Type.Image&&this._swatchInnerElement.style.setProperty("background-image",`url(${this._value.src})`),e||this.dispatchEventToListeners(WI.InlineSwatch.Event.ValueChanged,{value:this._value})}_swatchElementClicked(e){if(e.stop(),e.shiftKey&&this._value){if(this._type===WI.InlineSwatch.Type.Color){let a=this._value.nextFormat();console.assert(a),a&&(this._value.format=a,this._updateSwatch());return}if(this._type===WI.InlineSwatch.Type.Variable){this._swatchElement.remove(),this._updateSwatch();return}}if(this._valueEditor)return;let t=WI.Rect.rectFromClientRect(this._swatchElement.getBoundingClientRect()),i=new WI.Popover(this);switch(i.windowResizeHandler=()=>{let a=WI.Rect.rectFromClientRect(this._swatchElement.getBoundingClientRect());i.present(a.pad(2),[WI.RectEdge.MIN_X])},this._valueEditor=null,this._type){case WI.InlineSwatch.Type.Color:this._valueEditor=new WI.ColorPicker,this._valueEditor.addEventListener(WI.ColorPicker.Event.ColorChanged,this._valueEditorValueDidChange,this),this._valueEditor.addEventListener(WI.ColorPicker.Event.FormatChanged,a=>i.update());break;case WI.InlineSwatch.Type.Gradient:this._valueEditor=new WI.GradientEditor,this._valueEditor.addEventListener(WI.GradientEditor.Event.GradientChanged,this._valueEditorValueDidChange,this),this._valueEditor.addEventListener(WI.GradientEditor.Event.ColorPickerToggled,a=>i.update());break;case WI.InlineSwatch.Type.Bezier:this._valueEditor=new WI.BezierEditor,this._valueEditor.addEventListener(WI.BezierEditor.Event.BezierChanged,this._valueEditorValueDidChange,this);break;case WI.InlineSwatch.Type.Spring:this._valueEditor=new WI.SpringEditor,this._valueEditor.addEventListener(WI.SpringEditor.Event.SpringChanged,this._valueEditorValueDidChange,this);break;case WI.InlineSwatch.Type.Variable:this._valueEditor={},this._valueEditor.element=document.createElement("div"),this._valueEditor.element.classList.add("inline-swatch-variable-popover"),this._valueEditor.codeMirror=WI.CodeMirrorEditor.create(this._valueEditor.element,{mode:"css",readOnly:!0}),this._valueEditor.codeMirror.on("update",()=>{i.update()});break;case WI.InlineSwatch.Type.Image:this._valueEditor={},this._valueEditor.element=document.createElement("img"),this._valueEditor.element.src=this._value.src,this._valueEditor.element.classList.add("show-grid"),this._valueEditor.element.style.setProperty("max-width","50vw"),this._valueEditor.element.style.setProperty("max-height","50vh");break}if(!this._valueEditor)return;i.content=this._valueEditor.element,i.present(t.pad(2),[WI.RectEdge.MIN_X]),this.dispatchEventToListeners(WI.InlineSwatch.Event.Activated);let n=this._value||this._fallbackValue();switch(this._type){case WI.InlineSwatch.Type.Color:this._valueEditor.color=n;break;case WI.InlineSwatch.Type.Gradient:this._valueEditor.gradient=n;break;case WI.InlineSwatch.Type.Bezier:this._valueEditor.bezier=n;break;case WI.InlineSwatch.Type.Spring:this._valueEditor.spring=n;break;case WI.InlineSwatch.Type.Variable:{let p=function(f){return{allowedTokens:/\btag\b/,callback(_,b,w){let S=new WI.InlineSwatch(f,b,!0);a.setUniqueBookmark({line:0,ch:0},S.element)}}};var s=p;let a=this._valueEditor.codeMirror;a.setValue(n);const d=null;createCodeMirrorColorTextMarkers(a,d,p(WI.InlineSwatch.Type.Color)),createCodeMirrorGradientTextMarkers(a,d,p(WI.InlineSwatch.Type.Gradient)),createCodeMirrorCubicBezierTextMarkers(a,d,p(WI.InlineSwatch.Type.Bezier)),createCodeMirrorSpringTextMarkers(a,d,p(WI.InlineSwatch.Type.Spring));break}}}_valueEditorValueDidChange(e){this._type===WI.InlineSwatch.Type.Color?this._value=e.data.color:this._type===WI.InlineSwatch.Type.Gradient?this._value=e.data.gradient:this._type===WI.InlineSwatch.Type.Bezier?this._value=e.data.bezier:this._type===WI.InlineSwatch.Type.Spring&&(this._value=e.data.spring),this._updateSwatch()}_handleContextMenuEvent(e){if(!this._value)return;let t=WI.ContextMenu.createFromEvent(e);this._value.isKeyword()&&this._value.format!==WI.Color.Format.Keyword&&t.appendItem(WI.UIString("Format: Keyword"),()=>{this._value.format=WI.Color.Format.Keyword,this._updateSwatch()});let i=this._getNextValidHEXFormat();i&&t.appendItem(i.title,()=>{this._value.format=i.format,this._updateSwatch()}),this._value.simple&&this._value.format!==WI.Color.Format.HSL?t.appendItem(WI.UIString("Format: HSL"),()=>{this._value.format=WI.Color.Format.HSL,this._updateSwatch()}):this._value.format!==WI.Color.Format.HSLA&&t.appendItem(WI.UIString("Format: HSLA"),()=>{this._value.format=WI.Color.Format.HSLA,this._updateSwatch()}),this._value.simple&&this._value.format!==WI.Color.Format.RGB?t.appendItem(WI.UIString("Format: RGB"),()=>{this._value.format=WI.Color.Format.RGB,this._updateSwatch()}):this._value.format!==WI.Color.Format.RGBA&&t.appendItem(WI.UIString("Format: RGBA"),()=>{this._value.format=WI.Color.Format.RGBA,this._updateSwatch()})}_getNextValidHEXFormat(){if(this._type!==WI.InlineSwatch.Type.Color)return!1;function e(n){return!((n.format===WI.Color.Format.ShortHEX||n.format===WI.Color.Format.HEX)&&!this._value.simple||(n.format===WI.Color.Format.ShortHEX||n.format===WI.Color.Format.ShortHEXAlpha)&&!this._value.canBeSerializedAsShortHEX())}const t=[{format:WI.Color.Format.ShortHEX,title:WI.UIString("Format: Short Hex")},{format:WI.Color.Format.ShortHEXAlpha,title:WI.UIString("Format: Short Hex with Alpha")},{format:WI.Color.Format.HEX,title:WI.UIString("Format: Hex")},{format:WI.Color.Format.HEXAlpha,title:WI.UIString("Format: Hex with Alpha")}];let i=t.some(n=>n.format===this._value.format);for(let n=0;n<t.length;++n)if(!(i&&this._value.format!==t[n].format)){for(let s=~~i;s<t.length;++s){let a=(n+s)%t.length;if(e.call(this,t[a]))return t[a]}return null}return t[0]}};WI.InlineSwatch.Type={Color:"inline-swatch-type-color",Gradient:"inline-swatch-type-gradient",Bezier:"inline-swatch-type-bezier",Spring:"inline-swatch-type-spring",Variable:"inline-swatch-type-variable",Image:"inline-swatch-type-image"};WI.InlineSwatch.Event={ValueChanged:"inline-swatch-value-changed",Activated:"inline-swatch-activated",Deactivated:"inline-swatch-deactivated"};WI.InputPopover=class extends WI.Popover{constructor(e,t){super(t),this._message=e,this._value=null,this._result=WI.InputPopover.Result.None,this._targetElement=null,this._preferredEdges=null,this.windowResizeHandler=this._presentOverTargetElement.bind(this)}get value(){return this._value}get result(){return this._result}show(e,t){this._targetElement=e,this._preferredEdges=t;let i=document.createElement("div");if(i.classList.add("input-popover-content"),this._message){let n=document.createElement("div");n.classList.add("label"),n.textContent=this._message,i.appendChild(n)}this._inputElement=document.createElement("input"),this._inputElement.type="text",this._inputElement.addEventListener("keydown",n=>{!isEnterKey(n)||(this._result=WI.InputPopover.Result.Committed,this._value=n.target.value,this.dismiss())}),i.appendChild(this._inputElement),this.content=i,this._presentOverTargetElement()}_presentOverTargetElement(){if(!this._targetElement)return;let e=WI.Rect.rectFromClientRect(this._targetElement.getBoundingClientRect());this.present(e,this._preferredEdges),this._inputElement.select()}};WI.InputPopover.Result={None:Symbol("result-none"),Cancelled:Symbol("result-cancelled"),Committed:Symbol("result-committed")};WI.IssueTreeElement=class extends WI.GeneralTreeElement{constructor(e){var t;switch(e.level){case"error":t=WI.IssueTreeElement.ErrorStyleClassName;break;case"warning":t=WI.IssueTreeElement.WarningStyleClassName;break}const i=null,n=null;super([WI.IssueTreeElement.StyleClassName,t],i,n,e),this._issueMessage=e,this._updateTitles(),this._issueMessage.addEventListener(WI.IssueMessage.Event.DisplayLocationDidChange,this._updateTitles,this)}get issueMessage(){return this._issueMessage}_updateTitles(){var e=this._issueMessage.sourceCodeLocation.displayLineNumber,t=this._issueMessage.sourceCodeLocation.displayColumnNumber,i;t>0?i=WI.UIString("Line %d:%d").format(e+1,t+1):i=WI.UIString("Line %d").format(e+1),this.mainTitle=i+" "+this._issueMessage.text}};WI.IssueTreeElement.StyleClassName="issue";WI.IssueTreeElement.ErrorStyleClassName="error";WI.IssueTreeElement.WarningStyleClassName="warning";WI.JSONResourceContentView=class extends WI.ResourceContentView{constructor(e){super(e,"json"),this._remoteObject=null}static customContentViewDisplayName(){return WI.UIString("JSON")}contentAvailable(e,t){try{JSON.parse(e)}catch(n){this.showMessage(WI.UIString("Unable to parse as JSON: %s").format(n.message));return}const i={expression:"("+e+")",includeCommandLineAPI:!1,doNotPauseOnExceptionsAndMuteConsole:!0,contextId:void 0,returnByValue:!1,generatePreview:!0};this.resource.target.RuntimeAgent.evaluate.invoke(i,(n,s,a)=>{if(n||a){this.showMessage(WI.UIString("Unable to parse as JSON: %s").format(s.description));return}this.removeLoadingIndicator(),this._remoteObject=WI.RemoteObject.fromPayload(s,this.resource.target);let d=new WI.ObjectTreeView(this._remoteObject);d.showOnlyJSON(),d.expand(),this.element.appendChild(d.element)},this.resource.target)}closed(){this._remoteObject&&(this._remoteObject.release(),this._remoteObject=null)}};WI.LayerDetailsSidebarPanel=class extends WI.DetailsSidebarPanel{constructor(){super("layer",WI.UIString("All Layers")),this.element.classList.add("layer"),this._layers=[],this._layerIdToSelect=null,this._dataGrid=null,this._hoveredDataGridNode=null,this._dataGridNodesByLayerId=new Map,this._bottomBar=null,this._layersCountLabel=null,this._layersMemoryLabel=null}inspect(e){e instanceof Array||(e=[e]);let t=e.filter(i=>i instanceof WI.Layer);return this._updateLayers(t),!!t.length}selectNodeByLayerId(e){this._layerIdToSelect=null;let t=this._dataGridNodesByLayerId.get(e);if(t===this._dataGrid.selectedNode)return;const i=!0;t?t.revealAndSelect(i):this._dataGrid.selectedNode?this._dataGrid.selectedNode.deselect(i):this._layerIdToSelect=e}_buildDataGrid(){const e={name:{title:WI.UIString("Node"),sortable:!1},paintCount:{title:WI.UIString("Paints"),sortable:!0,aligned:"right",width:"70px"},memory:{title:WI.UIString("Memory"),sortable:!0,aligned:"right",width:"70px"}};this._dataGrid=new WI.DataGrid(e),this._dataGrid.addEventListener(WI.DataGrid.Event.SortChanged,this._sortDataGrid,this),this._dataGrid.addEventListener(WI.DataGrid.Event.SelectedNodeChanged,this._dataGridSelectedNodeChanged,this),this._dataGrid.sortColumnIdentifier="memory",this._dataGrid.sortOrder=WI.DataGrid.SortOrder.Descending,this._dataGrid.createSettings("layer-details-sidebar-panel"),this._dataGrid.element.addEventListener("mousemove",this._dataGridMouseMove.bind(this)),this._dataGrid.element.addEventListener("mouseleave",this._dataGridMouseLeave.bind(this)),this._dataGrid.inline=!0,this._dataGrid.element.classList.remove("inline"),this.contentView.addSubview(this._dataGrid)}_buildBottomBar(){this._bottomBar=this.element.appendChild(document.createElement("div")),this._bottomBar.className="bottom-bar",this._layersCountLabel=this._bottomBar.appendChild(document.createElement("div")),this._layersCountLabel.className="layers-count-label",this._layersMemoryLabel=this._bottomBar.appendChild(document.createElement("div")),this._layersMemoryLabel.className="layers-memory-label"}_sortDataGrid(){let e=this._dataGrid.sortColumnIdentifier;function t(i,n){let s=i.layer[e]||0,a=n.layer[e]||0;return s-a}this._dataGrid.sortNodes(t)}_dataGridSelectedNodeChanged(){let e=this._dataGrid.selectedNode?this._dataGrid.selectedNode.layer.layerId:null;this.dispatchEventToListeners(WI.LayerDetailsSidebarPanel.Event.SelectedLayerChanged,{layerId:e})}_dataGridMouseMove(e){let t=this._dataGrid.dataGridNodeFromNode(e.target);if(t!==this._hoveredDataGridNode){if(!t){this._hideDOMNodeHighlight();return}this._hoveredDataGridNode=t,t.layer.isGeneratedContent||t.layer.isReflection||t.layer.isAnonymous?WI.domManager.highlightRect(t.layer.bounds,!0):WI.domManager.highlightDOMNode(t.layer.nodeId)}}_dataGridMouseLeave(e){this._hideDOMNodeHighlight()}_hideDOMNodeHighlight(){WI.domManager.hideDOMNodeHighlight(),this._hoveredDataGridNode=null}_updateLayers(e){this._updateDataGrid(e),this._updateBottomBar(e),this._layers=e}_updateDataGrid(e){this._dataGrid||this._buildDataGrid();let{removals:t,additions:i,preserved:n}=WI.layerTreeManager.layerTreeMutations(this._layers,e);t.forEach(s=>{let a=this._dataGridNodesByLayerId.get(s.layerId);this._dataGrid.removeChild(a),this._dataGridNodesByLayerId.delete(s.layerId)}),i.forEach(s=>{let a=new WI.LayerTreeDataGridNode(s);this._dataGridNodesByLayerId.set(s.layerId,a),this._dataGrid.appendChild(a)}),n.forEach(s=>{let a=this._dataGridNodesByLayerId.get(s.layerId);a.layer=s}),this._sortDataGrid(),this._layerIdToSelect&&this.selectNodeByLayerId(this._layerIdToSelect)}_updateBottomBar(e){this._bottomBar||this._buildBottomBar(),this._layersCountLabel.textContent=WI.UIString("Layer Count: %d").format(e.length);let t=e.reduce((i,n)=>i+(n.memory||0),0);this._layersMemoryLabel.textContent=WI.UIString("Memory: %s").format(Number.bytesToString(t))}};WI.LayerDetailsSidebarPanel.Event={SelectedLayerChanged:"selected-layer-changed"};WI.LayerTreeDataGridNode=class extends WI.DataGridNode{constructor(e){super(),this._outlets={},this.layer=e}createCells(){super.createCells(),this._cellsWereCreated=!0}createCellContent(e,t){return t=e==="name"?this._makeNameCell():this._makeOutlet(e,document.createTextNode(enDash)),this._updateCell(e),t}get layer(){return this._layer}set layer(e){this._layer=e;var t=WI.domManager.nodeForId(e.nodeId);this.data={name:t?t.displayName:WI.UIString("Unknown node"),paintCount:e.paintCount||emDash,memory:Number.bytesToString(e.memory||0)}}get data(){return this._data}set data(e){Object.keys(e).forEach(function(t){this._data[t]!==e[t]&&(this._data[t]=e[t],this._cellsWereCreated&&this._updateCell(t))},this)}_makeOutlet(e,t){return this._outlets[e]=t,t}_makeNameCell(){var e=document.createDocumentFragment();e.appendChild(document.createElement("img")).className="icon";var t=this._makeOutlet("goToButton",e.appendChild(WI.createGoToArrowButton()));t.addEventListener("click",this._goToArrowWasClicked.bind(this),!1);var i=this._makeOutlet("label",e.appendChild(document.createElement("span")));i.className="label";var n=this._makeOutlet("nameLabel",i.appendChild(document.createElement("span")));n.className="name";var s=this._makeOutlet("pseudoLabel",document.createElement("span"));s.className="pseudo-element";var a=this._makeOutlet("reflectionLabel",document.createElement("span"));return a.className="reflection",a.textContent=" \u2014 "+WI.UIString("Reflection"),e}_updateCell(e){var t=this._data[e];e==="name"?this._updateNameCellData(t):this._outlets[e].textContent=t}_updateNameCellData(e){var t=this._layer,i=this._outlets.label;this._outlets.nameLabel.textContent=e,WI.domManager.nodeForId(t.nodeId)?i.parentNode.insertBefore(this._outlets.goToButton,i.parentNode.firstChild):this._outlets.goToButton.parentNode&&i.parentNode.removeChild(this._outlets.goToButton),t.pseudoElement?i.appendChild(this._outlets.pseudoLabel).textContent="::"+t.pseudoElement:this._outlets.pseudoLabel.parentNode&&i.removeChild(this._outlets.pseudoLabel),t.isReflection?i.appendChild(this._outlets.reflectionLabel):this._outlets.reflectionLabel.parentNode&&i.removeChild(this._outlets.reflectionLabel);var n=this.element;t.isReflection?n.classList.add("reflection"):t.pseudoElement&&n.classList.add("pseudo-element")}_goToArrowWasClicked(){var e=WI.domManager.nodeForId(this._layer.nodeId);WI.showMainFrameDOMTree(e,{ignoreSearchTab:!0})}};WI.LayerTreeDetailsSidebarPanel=class extends WI.DOMDetailsSidebarPanel{constructor(){super("layer-tree",WI.UIString("Layers")),this._dataGridNodesByLayerId=new Map,this.element.classList.add("layer-tree")}shown(){WI.layerTreeManager.addEventListener(WI.LayerTreeManager.Event.LayerTreeDidChange,this._layerTreeDidChange,this),console.assert(this.parentSidebar),super.shown()}hidden(){WI.layerTreeManager.removeEventListener(WI.LayerTreeManager.Event.LayerTreeDidChange,this._layerTreeDidChange,this),super.hidden()}supportsDOMNode(e){return WI.layerTreeManager.supported&&e.nodeType()===Node.ELEMENT_NODE}initialLayout(){super.initialLayout(),WI.settings.showShadowDOM.addEventListener(WI.Setting.Event.Changed,this._showShadowDOMSettingChanged,this),this._buildLayerInfoSection(),this._buildDataGridSection(),this._buildBottomBar()}layout(){super.layout(),this.domNode&&WI.layerTreeManager.layersForNode(this.domNode,e=>{let t=e[0]&&e[0].nodeId===this.domNode.id&&!e[0].isGeneratedContent?e[0]:null,i=e.slice(t?1:0);this._unfilteredChildLayers=i,this._updateDisplayWithLayers(t,i)})}sizeDidChange(){super.sizeDidChange(),this._childLayersRow.sizeDidChange()}_layerTreeDidChange(e){this.needsLayout()}_showShadowDOMSettingChanged(e){this.selected&&this._updateDisplayWithLayers(this._layerForNode,this._unfilteredChildLayers)}_buildLayerInfoSection(){var e=this._layerInfoRows={},t=[];t.push(e.Width=new WI.DetailsSectionSimpleRow(WI.UIString("Width"))),t.push(e.Height=new WI.DetailsSectionSimpleRow(WI.UIString("Height"))),t.push(e.Paints=new WI.DetailsSectionSimpleRow(WI.UIString("Paints"))),t.push(e.Memory=new WI.DetailsSectionSimpleRow(WI.UIString("Memory"))),this._layerInfoGroup=new WI.DetailsSectionGroup(t);var i=new WI.DetailsSectionRow(WI.UIString("No Layer Available"));i.showEmptyMessage(),this._noLayerInformationGroup=new WI.DetailsSectionGroup([i]),this._layerInfoSection=new WI.DetailsSection("layer-info",WI.UIString("Layer Info"),[this._noLayerInformationGroup]),this.contentView.element.appendChild(this._layerInfoSection.element)}_buildDataGridSection(){var e={name:{},paintCount:{},memory:{}};e.name.title=WI.UIString("Node"),e.name.sortable=!1,e.paintCount.title=WI.UIString("Paints","Paints @ Column title","A count of how many times an element was painted (rendered)"),e.paintCount.sortable=!0,e.paintCount.aligned="right",e.paintCount.width="70px",e.memory.title=WI.UIString("Memory"),e.memory.sortable=!0,e.memory.aligned="right",e.memory.width="70px",this._dataGrid=new WI.DataGrid(e),this._dataGrid.inline=!0,this._dataGrid.addEventListener(WI.DataGrid.Event.SortChanged,this._sortDataGrid,this),this._dataGrid.addEventListener(WI.DataGrid.Event.SelectedNodeChanged,this._selectedDataGridNodeChanged,this),this._dataGrid.sortColumnIdentifier="memory",this._dataGrid.sortOrder=WI.DataGrid.SortOrder.Descending,this._dataGrid.createSettings("layer-tree-details-sidebar-panel");var t=this._dataGrid.element;t.addEventListener("focus",this._dataGridGainedFocus.bind(this),!1),t.addEventListener("blur",this._dataGridLostFocus.bind(this),!1),t.addEventListener("click",this._dataGridWasClicked.bind(this),!1),this._childLayersRow=new WI.DetailsSectionDataGridRow(null,WI.UIString("No Child Layers"));var i=new WI.DetailsSectionGroup([this._childLayersRow]),n=new WI.DetailsSection("layer-children",WI.UIString("Child Layers"),[i],null,!0);this.contentView.element.appendChild(n.element)}_buildBottomBar(){var e=this.element.appendChild(document.createElement("div"));e.className="bottom-bar",this._layersCountLabel=e.appendChild(document.createElement("div")),this._layersCountLabel.className="layers-count-label",this._layersMemoryLabel=e.appendChild(document.createElement("div")),this._layersMemoryLabel.className="layers-memory-label"}_sortDataGrid(){var e=this._dataGrid.sortColumnIdentifier;function t(i,n){var s=i.layer[e]||0,a=n.layer[e]||0;return s-a}this._dataGrid.sortNodes(t),this._updatePopoverForSelectedNode()}_selectedDataGridNodeChanged(){this._dataGrid.selectedNode?(this._highlightSelectedNode(),this._showPopoverForSelectedNode()):(WI.domManager.hideDOMNodeHighlight(),this._hidePopover())}_dataGridGainedFocus(e){this._highlightSelectedNode(),this._showPopoverForSelectedNode()}_dataGridLostFocus(e){WI.domManager.hideDOMNodeHighlight(),this._hidePopover()}_dataGridWasClicked(e){this._dataGrid.selectedNode&&e.target.parentNode.classList.contains("filler")&&this._dataGrid.selectedNode.deselect()}_highlightSelectedNode(){var e=this._dataGrid.selectedNode;if(!!e){var t=e.layer;t.isGeneratedContent||t.isReflection||t.isAnonymous?WI.domManager.highlightRect(t.bounds,!0):WI.domManager.highlightDOMNode(t.nodeId)}}_updateDisplayWithLayers(e,t){WI.settings.showShadowDOM.value||(t=t.filter(function(i){return!i.isInShadowTree})),this._updateLayerInfoSection(e),this._updateDataGrid(e,t),this._updateMetrics(e,t),this._layerForNode=e,this._childLayers=t}_updateLayerInfoSection(e){this._layerInfoSection.groups=e?[this._layerInfoGroup]:[this._noLayerInformationGroup],e&&(this._layerInfoRows.Memory.value=Number.bytesToString(e.memory),this._layerInfoRows.Width.value=e.compositedBounds.width+"px",this._layerInfoRows.Height.value=e.compositedBounds.height+"px",this._layerInfoRows.Paints.value=e.paintCount+"")}_updateDataGrid(e,t){let i=this._dataGrid,n=WI.layerTreeManager.layerTreeMutations(this._childLayers,t);n.removals.forEach(function(s){let a=this._dataGridNodesByLayerId.get(s.layerId);a&&(i.removeChild(a),this._dataGridNodesByLayerId.delete(s.layerId))},this),n.additions.forEach(function(s){let a=this._dataGridNodeForLayer(s);a&&i.appendChild(a)},this),n.preserved.forEach(function(s){let a=this._dataGridNodesByLayerId.get(s.layerId);a&&(a.layer=s)},this),this._sortDataGrid(),this._childLayersRow.dataGrid=isEmptyObject(t)?null:this._dataGrid}_dataGridNodeForLayer(e){let t=new WI.LayerTreeDataGridNode(e);return this._dataGridNodesByLayerId.set(e.layerId,t),t}_updateMetrics(e,t){var i=0,n=0;e&&(i++,n+=e.memory||0),t.forEach(function(s){i++,n+=s.memory||0}),this._layersCountLabel.textContent=WI.UIString("Layer Count: %d").format(i),this._layersMemoryLabel.textContent=WI.UIString("Memory: %s").format(Number.bytesToString(n))}_showPopoverForSelectedNode(){var e=this._dataGrid.selectedNode;!e||this._contentForPopover(e.layer,t=>{e===this._dataGrid.selectedNode&&this._updatePopoverForSelectedNode(t)})}_updatePopoverForSelectedNode(e){var t=this._dataGrid.selectedNode;if(!!t){var i=this._popover;i||(i=this._popover=new WI.Popover,i.windowResizeHandler=()=>{this._updatePopoverForSelectedNode()});var n=WI.Rect.rectFromClientRect(t.element.getBoundingClientRect());e?this._popover.presentNewContentWithFrame(e,n.pad(2),[WI.RectEdge.MIN_X]):i.present(n.pad(2),[WI.RectEdge.MIN_X])}}_hidePopover(){this._popover&&this._popover.dismiss()}_contentForPopover(e,t){var i=document.createElement("div");i.className="layer-tree-popover",i.appendChild(document.createElement("p")).textContent=WI.UIString("Reasons for compositing:");var n=i.appendChild(document.createElement("ul"));return WI.layerTreeManager.reasonsForCompositingLayer(e,s=>{if(isEmptyObject(s)){t(i);return}this._populateListOfCompositingReasons(n,s),t(i)}),i}_populateListOfCompositingReasons(e,t){function i(n){e.appendChild(document.createElement("li")).textContent=n}t.transform3D&&i(WI.UIString("Element has a 3D transform")),t.video&&i(WI.UIString("Element is <video>")),t.canvas&&i(WI.UIString("Element is <canvas>")),t.plugin&&i(WI.UIString("Element is a plug-in")),t.iFrame&&i(WI.UIString("Element is <iframe>")),t.backfaceVisibilityHidden&&i(WI.UIString("Element has \u201Cbackface-visibility: hidden\u201D style")),t.clipsCompositingDescendants&&i(WI.UIString("Element clips compositing descendants")),t.animation&&i(WI.UIString("Element is animated")),t.filters&&i(WI.UIString("Element has CSS filters applied")),t.positionFixed&&i(WI.UIString("Element has \u201Cposition: fixed\u201D style")),t.positionSticky&&i(WI.UIString("Element has \u201Cposition: sticky\u201D style")),t.overflowScrollingTouch&&i(WI.UIString("Element has \u201C-webkit-overflow-scrolling: touch\u201D style")),t.stacking&&i(WI.UIString("Element may overlap another compositing element")),t.overlap&&i(WI.UIString("Element overlaps other compositing element")),t.negativeZIndexChildren&&i(WI.UIString("Element has children with a negative z-index")),t.transformWithCompositedDescendants&&i(WI.UIString("Element has a 2D transform and composited descendants")),t.opacityWithCompositedDescendants&&i(WI.UIString("Element has opacity applied and composited descendants")),t.maskWithCompositedDescendants&&i(WI.UIString("Element is masked and has composited descendants")),t.reflectionWithCompositedDescendants&&i(WI.UIString("Element has a reflection and composited descendants")),t.filterWithCompositedDescendants&&i(WI.UIString("Element has CSS filters applied and composited descendants")),t.blendingWithCompositedDescendants&&i(WI.UIString("Element has CSS blending applied and composited descendants")),t.isolatesCompositedBlendingDescendants&&i(WI.UIString("Element is a stacking context and has composited descendants with CSS blending applied")),t.perspective&&i(WI.UIString("Element has perspective applied")),t.preserve3D&&i(WI.UIString("Element has \u201Ctransform-style: preserve-3d\u201D style")),t.willChange&&i(WI.UIString("Element has \u201Cwill-change\u201D style which includes opacity, transform, transform-style, perspective, filter or backdrop-filter")),t.root&&i(WI.UIString("Element is the root element")),t.blending&&i(WI.UIString("Element has \u201Cblend-mode\u201D style"))}};WI.Layers3DContentView=class extends WI.ContentView{constructor(){super(),this.element.classList.add("layers-3d"),this._compositingBordersButtonNavigationItem=new WI.ActivateButtonNavigationItem("layer-borders",WI.UIString("Show compositing borders"),WI.UIString("Hide compositing borders"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 13'%3e %3crect fill='none' stroke='currentColor' x='0.5' y='0.5' width='5' height='5'/%3e %3crect fill='none' stroke='currentColor' x='0.5' y='7.5' width='5' height='5'/%3e %3crect fill='none' stroke='currentColor' x='7.5' y='0.5' width='5' height='5'/%3e %3crect fill='none' stroke='currentColor' x='7.5' y='7.5' width='5' height='5'/%3e %3c/svg%3e",13,13),this._compositingBordersButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._toggleCompositingBorders,this),this._compositingBordersButtonNavigationItem.enabled=!!InspectorBackend.domains.Page,this._compositingBordersButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,WI.settings.showPaintRects.addEventListener(WI.Setting.Event.Changed,this._showPaintRectsSettingChanged,this),this._paintFlashingButtonNavigationItem=new WI.ActivateButtonNavigationItem("paint-flashing",WI.UIString("Enable paint flashing"),WI.UIString("Disable paint flashing"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2013 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='currentColor' d='M 1.367188 13.789062 C 1.367188 13.789062 2.820312 14.105469 3.289062 12.722656 C 3.757812 11.34375 3.960938 10.867188 5.222656 10.976562 C 5.222656 10.976562 5.714844 11.886719 6.933594 12.308594 C 6.933594 12.308594 5.75 16.207031 1.367188 13.789062 Z M 14.339844 2.351562 C 14.054688 2.839844 10.289062 8.804688 9.554688 9.65625 C 8.820312 10.511719 6.917969 11.71875 6.917969 11.71875 C 6.003906 11.242188 5.710938 10.738281 5.710938 10.738281 C 5.710938 10.738281 6.328125 8.992188 7.230469 7.683594 C 8.132812 6.378906 13.050781 1.949219 13.460938 1.636719 C 13.871094 1.320312 14.625 1.867188 14.339844 2.351562 Z'/%3e %3c/svg%3e",16,16),this._paintFlashingButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._togglePaintFlashing,this),this._paintFlashingButtonNavigationItem.enabled=InspectorBackend.domains.Page&&!!InspectorBackend.domains.Page.setShowPaintRects,this._paintFlashingButtonNavigationItem.activated=InspectorBackend.domains.Page.setShowPaintRects&&WI.settings.showPaintRects.value,this._paintFlashingButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._layers=[],this._layerGroupsById=new Map,this._selectedLayerGroup=null,this._candidateSelection=null,this._nodeToSelect=null,this._renderer=null,this._camera=null,this._controls=null,this._scene=null,this._boundingBox=null,this._raycaster=null,this._animationFrameRequestId=null,this._documentNode=null,this._layerInfoElement=null,this._compositedDimensionsElement=null,this._visibleDimensionsElement=null,this._reasonsListElement=null}get navigationItems(){return[this._compositingBordersButtonNavigationItem,this._paintFlashingButtonNavigationItem]}get supplementalRepresentedObjects(){return this._layers}shown(){super.shown(),this._updateCompositingBordersButtonState(),this.updateLayout(),WI.layerTreeManager.addEventListener(WI.LayerTreeManager.Event.LayerTreeDidChange,this._layerTreeDidChange,this),this.didInitialLayout&&this._animate()}hidden(){WI.layerTreeManager.removeEventListener(WI.LayerTreeManager.Event.LayerTreeDidChange,this._layerTreeDidChange,this),this._stopAnimation(),super.hidden()}closed(){WI.settings.showPaintRects.removeEventListener(WI.Setting.Event.Changed,this._showPaintRectsSettingChanged,this),super.closed()}selectLayerById(e){let t=this._layerGroupsById.get(e);this._updateLayerGroupSelection(t),this._updateLayerInfoElement(),this._centerOnSelection()}selectLayerForNode(e){if(!this._layers.length){this._nodeToSelect=e;return}this._nodeToSelect=null;let t=null;for(;e&&!t;)t=this._layers.find(i=>i.nodeId===e.id),t||(e=e.parentNode);console.assert(t,"There should always be a top level (document) layer"),t&&(this.selectLayerById(t.layerId),this.dispatchEventToListeners(WI.Layers3DContentView.Event.SelectedLayerChanged,{layerId:t.layerId}))}initialLayout(){super.initialLayout(),this._renderer=new THREE.WebGLRenderer({antialias:!0});const e=window.getComputedStyle(document.documentElement).getPropertyValue("--background-color-content").trim();this._renderer.setClearColor(e),this._renderer.setSize(this.element.offsetWidth,this.element.offsetHeight),this._camera=new THREE.PerspectiveCamera(45,this.element.offsetWidth/this.element.offsetHeight,1,1e5),this._controls=new THREE.OrbitControls(this._camera,this._renderer.domElement),this._controls.enableDamping=!0,this._controls.panSpeed=.5,this._controls.enableKeys=!1,this._controls.zoomSpeed=.5,this._controls.minDistance=1e3,this._controls.rotateSpeed=.5,this._controls.minAzimuthAngle=-Math.PI/2,this._controls.maxAzimuthAngle=Math.PI/2,this._controls.screenSpacePanning=!0,this._renderer.domElement.addEventListener("contextmenu",t=>{t.stopPropagation()}),this._scene=new THREE.Scene,this._boundingBox=new THREE.Box3,this._raycaster=new THREE.Raycaster,this._renderer.domElement.addEventListener("mousedown",this._canvasMouseDown.bind(this)),this._renderer.domElement.addEventListener("mouseup",this._canvasMouseUp.bind(this)),this.element.appendChild(this._renderer.domElement),this._animate()}layout(){this.layoutReason!==WI.View.LayoutReason.Resize&&WI.domManager.requestDocument(e=>{let t=this._updateDocument(e);WI.layerTreeManager.layersForNode(e,i=>{this._updateLayers(i),t&&this._resetCamera(),this._nodeToSelect&&this.selectLayerForNode(this._nodeToSelect)})})}sizeDidChange(){super.sizeDidChange(),this._stopAnimation(),this._camera.aspect=this.element.offsetWidth/this.element.offsetHeight,this._camera.updateProjectionMatrix(),this._renderer.setSize(this.element.offsetWidth,this.element.offsetHeight),this._animate()}_layerTreeDidChange(e){this.needsLayout()}_animate(){this._controls.update(),this._restrictPan(),this._renderer.render(this._scene,this._camera),this._animationFrameRequestId=requestAnimationFrame(()=>{this._animate()})}_stopAnimation(){cancelAnimationFrame(this._animationFrameRequestId),this._animationFrameRequestId=null}_updateDocument(e){return e===this._documentNode?!1:(this._scene.children.length=0,this._layerGroupsById.clear(),this._layers.length=0,this._documentNode=e,!0)}_updateLayers(e){let{removals:t,additions:i}=WI.layerTreeManager.layerTreeMutations(this._layers,e);for(let s of t){let a=this._layerGroupsById.get(s.layerId);this._scene.remove(a),this._layerGroupsById.delete(s.layerId)}this._selectedLayerGroup&&!this._layerGroupsById.get(this._selectedLayerGroup.userData.layer.layerId)&&(this.selectedLayerGroup=null);for(let s of i){let a=this._createLayerGroup(s);this._layerGroupsById.set(s.layerId,a),this._scene.add(a)}const n=25;e.forEach((s,a)=>{this._layerGroupsById.get(s.layerId).position.set(s.bounds.x,-s.bounds.y,a*n)}),this._boundingBox.setFromObject(this._scene),this._controls.maxDistance=this._boundingBox.max.z+WI.Layers3DContentView._zPadding,this._layers=e,this.dispatchEventToListeners(WI.ContentView.Event.SelectionPathComponentsDidChange)}_createLayerGroup(e){let t=new THREE.Group;return t.userData.layer=e,t.add(this._createLayerMesh(e.bounds),this._createLayerMesh(e.compositedBounds,!0)),t}_createLayerMesh({width:e,height:t},i=!1){let n=new THREE.Geometry;if(n.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,-t,0),new THREE.Vector3(e,-t,0),new THREE.Vector3(e,0,0)),i){let a=new THREE.LineBasicMaterial({color:WI.Layers3DContentView._layerColor.stroke});return new THREE.LineLoop(n,a)}n.faces.push(new THREE.Face3(0,1,3),new THREE.Face3(1,2,3));let s=new THREE.MeshBasicMaterial({color:WI.Layers3DContentView._layerColor.fill,transparent:!0,opacity:.4,side:THREE.DoubleSide,depthWrite:!1});return new THREE.Mesh(n,s)}_canvasMouseDown(e){let t=e.offsetX/e.target.offsetWidth*2-1,i=-(e.offsetY/e.target.offsetHeight)*2+1;this._raycaster.setFromCamera(new THREE.Vector2(t,i),this._camera);const n=!0;let s=this._raycaster.intersectObjects(this._scene.children,n),a=s.length?s[0].object.parent:null;this._candidateSelection={layerGroup:a};let d=p=>{this._candidateSelection=null,this._renderer.domElement.removeEventListener("mousemove",d)};this._renderer.domElement.addEventListener("mousemove",d)}_canvasMouseUp(e){if(!this._candidateSelection)return;let t=this._candidateSelection.layerGroup;if(t&&t===this._selectedLayerGroup){if(!e.metaKey)return;t=null}this._updateLayerGroupSelection(t),this._updateLayerInfoElement();let i=t?t.userData.layer.layerId:null;this.dispatchEventToListeners(WI.Layers3DContentView.Event.SelectedLayerChanged,{layerId:i})}_updateLayerGroupSelection(e){let t=({fill:i,stroke:n})=>{let[s,a]=this._selectedLayerGroup.children;s.material.color.set(i),a.material.color.set(n)};this._selectedLayerGroup&&t(WI.Layers3DContentView._layerColor),this._selectedLayerGroup=e,this._selectedLayerGroup&&t(WI.Layers3DContentView._selectedLayerColor)}_centerOnSelection(){if(!this._selectedLayerGroup)return;let{x:e,y:t,width:i,height:n}=this._selectedLayerGroup.userData.layer.bounds;this._controls.target.set(e+i/2,-t-n/2,0),this._camera.position.set(e+i/2,-t-n/2,this._selectedLayerGroup.position.z+WI.Layers3DContentView._zPadding/2)}_resetCamera(){let{x:e,y:t,width:i,height:n}=this._layers[0].bounds;this._controls.target.set(e+i/2,-t-n/2,0),this._camera.position.set(e+i/2,-t-n/2,this._controls.maxDistance-WI.Layers3DContentView._zPadding/2)}_restrictPan(){let e=new THREE.Vector3;this._boundingBox.clampPoint(this._controls.target,e).setZ(0).sub(this._controls.target),this._controls.target.add(e),this._camera.position.add(e)}_showPaintRectsSettingChanged(e){let t=WI.settings.showPaintRects.value;this._paintFlashingButtonNavigationItem.activated=t;for(let i of WI.targets)i.PageAgent&&i.PageAgent.setShowPaintRects&&i.PageAgent.setShowPaintRects(t)}_togglePaintFlashing(e){WI.settings.showPaintRects.value=!WI.settings.showPaintRects.value}_updateCompositingBordersButtonState(){if(!WI.targetsAvailable()){WI.whenTargetsAvailable().then(()=>{this._updateCompositingBordersButtonState()});return}!window.PageAgent||PageAgent.getCompositingBordersVisible((e,t)=>{this._compositingBordersButtonNavigationItem.activated=e?!1:t,this._compositingBordersButtonNavigationItem.enabled=e!=="unsupported"})}_toggleCompositingBorders(e){let t=!this._compositingBordersButtonNavigationItem.activated;this._compositingBordersButtonNavigationItem.activated=t;for(let i of WI.targets)i.PageAgent&&i.PageAgent.setCompositingBordersVisible(t)}_buildLayerInfoElement(){this._layerInfoElement=this._element.appendChild(document.createElement("div")),this._layerInfoElement.classList.add("layer-info","hidden");let e=this._layerInfoElement.appendChild(document.createElement("div"));e.className="content";let t=e.appendChild(document.createElement("div"));t.textContent=WI.UIString("Dimensions");let i=e.appendChild(document.createElement("table")),n=i.appendChild(document.createElement("tr")),s=n.appendChild(document.createElement("td"));s.textContent=WI.UIString("Composited"),this._compositedDimensionsElement=n.appendChild(document.createElement("td"));let a=i.appendChild(document.createElement("tr")),d=a.appendChild(document.createElement("td"));d.textContent=WI.UIString("Visible"),this._visibleDimensionsElement=a.appendChild(document.createElement("td"));let p=e.appendChild(document.createElement("div"));p.textContent=WI.UIString("Reasons for compositing"),this._reasonsListElement=e.appendChild(document.createElement("ul"))}_updateLayerInfoElement(){if(this._layerInfoElement||this._buildLayerInfoElement(),!this._selectedLayerGroup){this._layerInfoElement.classList.add("hidden");return}let e=this._selectedLayerGroup.userData.layer;this._compositedDimensionsElement.textContent=`${e.compositedBounds.width}px ${multiplicationSign} ${e.compositedBounds.height}px`,this._visibleDimensionsElement.textContent=`${e.bounds.width}px ${multiplicationSign} ${e.bounds.height}px`,WI.layerTreeManager.reasonsForCompositingLayer(e,t=>{this._updateReasonsList(t),this._layerInfoElement.classList.remove("hidden")})}_updateReasonsList(e){this._reasonsListElement.removeChildren();let t=i=>{let n=this._reasonsListElement.appendChild(document.createElement("li"));n.textContent=i};e.transform3D&&t(WI.UIString("Element has a 3D transform")),e.video&&t(WI.UIString("Element is <video>")),e.canvas&&t(WI.UIString("Element is <canvas>")),e.plugin&&t(WI.UIString("Element is a plug-in")),e.iFrame&&t(WI.UIString("Element is <iframe>")),e.backfaceVisibilityHidden&&t(WI.UIString("Element has \u201Cbackface-visibility: hidden\u201D style")),e.clipsCompositingDescendants&&t(WI.UIString("Element clips compositing descendants")),e.animation&&t(WI.UIString("Element is animated")),e.filters&&t(WI.UIString("Element has CSS filters applied")),e.positionFixed&&t(WI.UIString("Element has \u201Cposition: fixed\u201D style")),e.positionSticky&&t(WI.UIString("Element has \u201Cposition: sticky\u201D style")),e.overflowScrollingTouch&&t(WI.UIString("Element has \u201C-webkit-overflow-scrolling: touch\u201D style")),e.stacking&&t(WI.UIString("Element may overlap another compositing element")),e.overlap&&t(WI.UIString("Element overlaps other compositing element")),e.negativeZIndexChildren&&t(WI.UIString("Element has children with a negative z-index")),e.transformWithCompositedDescendants&&t(WI.UIString("Element has a 2D transform and composited descendants")),e.opacityWithCompositedDescendants&&t(WI.UIString("Element has opacity applied and composited descendants")),e.maskWithCompositedDescendants&&t(WI.UIString("Element is masked and has composited descendants")),e.reflectionWithCompositedDescendants&&t(WI.UIString("Element has a reflection and composited descendants")),e.filterWithCompositedDescendants&&t(WI.UIString("Element has CSS filters applied and composited descendants")),e.blendingWithCompositedDescendants&&t(WI.UIString("Element has CSS blending applied and composited descendants")),e.isolatesCompositedBlendingDescendants&&t(WI.UIString("Element is a stacking context and has composited descendants with CSS blending applied")),e.perspective&&t(WI.UIString("Element has perspective applied")),e.preserve3D&&t(WI.UIString("Element has \u201Ctransform-style: preserve-3d\u201D style")),e.willChange&&t(WI.UIString("Element has \u201Cwill-change\u201D style which includes opacity, transform, transform-style, perspective, filter or backdrop-filter")),e.root&&t(WI.UIString("Element is the root element")),e.blending&&t(WI.UIString("Element has \u201Cblend-mode\u201D style"))}};WI.Layers3DContentView._zPadding=3e3;WI.Layers3DContentView._layerColor={fill:"hsl(76, 49%, 75%)",stroke:"hsl(79, 45%, 50%)"};WI.Layers3DContentView._selectedLayerColor={fill:"hsl(208, 66%, 79%)",stroke:"hsl(202, 57%, 68%)"};WI.Layers3DContentView.Event={SelectedLayerChanged:"selected-layer-changed"};WI.LayoutTimelineDataGrid=class extends WI.TimelineDataGrid{callFramePopoverAnchorElement(){return this.selectedNode.elementWithColumnIdentifier("location")}shouldShowCallFramePopover(){return this.isColumnVisible("location")}};WI.LayoutTimelineDataGridNode=class extends WI.TimelineDataGridNode{constructor(e,t={}){console.assert(e instanceof WI.LayoutTimelineRecord),super([e],t)}get data(){return this._cachedData?this._cachedData:(this._cachedData=super.data,this._cachedData.type=this.record.eventType,this._cachedData.name=this.displayName(),this._cachedData.width=this.record.width,this._cachedData.height=this.record.height,this._cachedData.area=this.record.width*this.record.height,this._cachedData.startTime=this.record.startTime-(this.graphDataSource?this.graphDataSource.zeroTime:0),this._cachedData.totalTime=this.record.duration,this._cachedData.initiator=this.record.initiatorCallFrame,this._cachedData)}createCellContent(e,t){var i=this.data[e];const n=!0;switch(e){case"name":return t.classList.add(...this.iconClassNames()),i;case"width":case"height":return isNaN(i)?emDash:WI.UIString("%dpx").format(i);case"area":return isNaN(i)?emDash:WI.UIString("%dpx\xB2").format(i);case"startTime":return isNaN(i)?emDash:Number.secondsToString(i,n);case"totalTime":return isNaN(i)?emDash:Number.secondsToString(i,n);case"source":return super.createCellContent("initiator",t)}return super.createCellContent(e,t)}};WI.LayoutTimelineOverviewGraph=class extends WI.TimelineOverviewGraph{constructor(e,t){super(t),this.element.classList.add("layout-overview"),this._layoutTimeline=e,this._layoutTimeline.addEventListener(WI.Timeline.Event.RecordAdded,this._layoutTimelineRecordAdded,this),this.reset();for(let i of this._layoutTimeline.records)this._processRecord(i)}reset(){super.reset();function e(){var t=document.createElement("div");return t.className="graph-row",this.element.appendChild(t),{element:t,recordBars:[],records:[]}}this.element.removeChildren(),this._timelineLayoutRecordRow=e.call(this),this._timelinePaintRecordRow=e.call(this)}layout(){!this.visible||(this._updateRowLayout(this._timelinePaintRecordRow),this._updateRowLayout(this._timelineLayoutRecordRow))}updateSelectedRecord(){super.updateSelectedRecord();for(let e of[this._timelineLayoutRecordRow,this._timelinePaintRecordRow])for(let t of e.recordBars)if(t.records.includes(this.selectedRecord)){this.selectedRecordBar=t;return}this.selectedRecordBar=null}_updateRowLayout(e){var t=this.timelineOverview.secondsPerPixel,i=0;function n(s,a){var d=e.recordBars[i];d?(d.renderMode=a,d.records=s):d=e.recordBars[i]=new WI.TimelineRecordBar(this,s,a),d.refresh(this),d.element.parentNode||e.element.appendChild(d.element),++i}for(WI.TimelineRecordBar.createCombinedBars(e.records,t,this,n.bind(this));i<e.recordBars.length;++i)e.recordBars[i].records=null,e.recordBars[i].element.remove()}_layoutTimelineRecordAdded(e){let t=e.data.record;console.assert(t instanceof WI.LayoutTimelineRecord),this._processRecord(t),this.needsLayout()}_processRecord(e){e.eventType===WI.LayoutTimelineRecord.EventType.Paint||e.eventType===WI.LayoutTimelineRecord.EventType.Composite?this._timelinePaintRecordRow.records.push(e):this._timelineLayoutRecordRow.records.push(e)}};WI.LayoutTimelineView=class extends WI.TimelineView{constructor(e,t){super(e,t),console.assert(e.type===WI.TimelineRecord.Type.Layout,e);let i={type:{},name:{},initiator:{},area:{},width:{},height:{},startTime:{},totalTime:{}};i.name.title=WI.UIString("Type"),i.name.width="15%";var n=new Map;for(var s in WI.LayoutTimelineRecord.EventType){var a=WI.LayoutTimelineRecord.EventType[s];n.set(a,WI.LayoutTimelineRecord.displayNameForEventType(a))}i.type.scopeBar=WI.TimelineDataGrid.createColumnScopeBar("layout",n),i.type.hidden=!0,i.type.locked=!0,i.name.disclosure=!0,i.name.icon=!0,i.name.locked=!0,this._scopeBar=i.type.scopeBar,i.initiator.title=WI.UIString("Initiator"),i.initiator.width="25%",i.area.title=WI.UIString("Area"),i.area.width="8%",i.width.title=WI.UIString("Width"),i.width.width="8%",i.height.title=WI.UIString("Height"),i.height.width="8%",i.startTime.title=WI.UIString("Start Time"),i.startTime.width="8%",i.startTime.aligned="right",i.totalTime.title=WI.UIString("Duration"),i.totalTime.width="8%",i.totalTime.aligned="right";for(var d in i)i[d].sortable=!0;this._dataGrid=new WI.LayoutTimelineDataGrid(i),this._dataGrid.addEventListener(WI.DataGrid.Event.SelectedNodeChanged,this._dataGridSelectedNodeChanged,this),this.setupDataGrid(this._dataGrid),this._dataGrid.sortColumnIdentifier="startTime",this._dataGrid.sortOrder=WI.DataGrid.SortOrder.Ascending,this._dataGrid.createSettings("layout-timeline-view"),this._hoveredTreeElement=null,this._hoveredDataGridNode=null,this._showingHighlight=!1,this._showingHighlightForRecord=null,this._dataGrid.element.addEventListener("mouseover",this._mouseOverDataGrid.bind(this)),this._dataGrid.element.addEventListener("mouseleave",this._mouseLeaveDataGrid.bind(this)),this.element.classList.add("layout"),this.addSubview(this._dataGrid),e.addEventListener(WI.Timeline.Event.RecordAdded,this._layoutTimelineRecordAdded,this),this._pendingRecords=[];for(let p of e.records)this._processRecord(p)}get selectionPathComponents(){let e=this._dataGrid.selectedNode;if(!e||e.hidden)return null;let t=[];for(;e&&!e.root;){if(console.assert(e instanceof WI.TimelineDataGridNode),e.hidden)return null;let i=new WI.TimelineDataGridNodePathComponent(e);i.addEventListener(WI.HierarchicalPathComponent.Event.SiblingWasSelected,this.dataGridNodePathComponentSelected,this),t.unshift(i),e=e.parent}return t}shown(){super.shown(),this._updateHighlight(),this._dataGrid.shown()}hidden(){this._hideHighlightIfNeeded(),this._dataGrid.hidden(),super.hidden()}closed(){console.assert(this.representedObject instanceof WI.Timeline),this.representedObject.removeEventListener(null,null,this),this._dataGrid.closed()}reset(){super.reset(),this._hideHighlightIfNeeded(),this._dataGrid.reset(),this._pendingRecords=[]}dataGridNodePathComponentSelected(e){let t=e.data.pathComponent.timelineDataGridNode;console.assert(t.dataGrid===this._dataGrid),t.revealAndSelect()}filterDidChange(){super.filterDidChange(),this._updateHighlight()}treeElementSelected(e,t){this._dataGrid.shouldIgnoreSelectionEvent()||(super.treeElementSelected(e,t),this._updateHighlight())}layout(){this._processPendingRecords()}_processPendingRecords(){if(!!this._pendingRecords.length){for(var e of this._pendingRecords){let t=new WI.LayoutTimelineDataGridNode(e,{graphDataSource:this});this._dataGrid.addRowInSortOrder(t);let i=[{children:e.children,parentDataGridNode:t,index:0}];for(;i.length;){let n=i.lastValue;if(n.index>=n.children.length){i.pop();continue}let s=n.children[n.index];const a={graphDataSource:this};let d=null;s.type===WI.TimelineRecord.Type.Script?d=new WI.ScriptTimelineDataGridNode(s,a):(console.assert(s.type===WI.TimelineRecord.Type.Layout,s),d=new WI.LayoutTimelineDataGridNode(s,a)),console.assert(n.parentDataGridNode,"Missing parent node for entry.",n),this._dataGrid.addRowInSortOrder(d,n.parentDataGridNode),d&&s.children.length&&i.push({children:s.children,parentDataGridNode:d,index:0}),++n.index}}this._pendingRecords=[]}}_layoutTimelineRecordAdded(e){let t=e.data.record;console.assert(t instanceof WI.LayoutTimelineRecord),this._processRecord(t),this.needsLayout()}_processRecord(e){e.parent instanceof WI.LayoutTimelineRecord||this._pendingRecords.push(e)}_updateHighlight(){var e=this._hoveredOrSelectedRecord();if(!e){this._hideHighlightIfNeeded();return}this._showHighlightForRecord(e)}_showHighlightForRecord(e){if(this._showingHighlightForRecord===e)return;this._showingHighlightForRecord=e;const t={r:111,g:168,b:220,a:.66},i={r:255,g:229,b:153,a:.66};var n=e.quad;if(n){DOMAgent.highlightQuad(n.toProtocol(),t,i),this._showingHighlight=!0;return}this._showingHighlight&&(this._showingHighlight=!1,DOMAgent.hideHighlight())}_hideHighlightIfNeeded(){this._showingHighlightForRecord=null,this._showingHighlight&&(this._showingHighlight=!1,DOMAgent.hideHighlight())}_hoveredOrSelectedRecord(){return this._hoveredDataGridNode?this._hoveredDataGridNode.record:this._dataGrid.selectedNode&&this._dataGrid.selectedNode.revealed?this._dataGrid.selectedNode.record:null}_mouseOverDataGrid(e){var t=this._dataGrid.dataGridNodeFromNode(e.target);!t||(this._hoveredDataGridNode=t,this._updateHighlight())}_mouseLeaveDataGrid(e){this._hoveredDataGridNode=null,this._updateHighlight()}_dataGridSelectedNodeChanged(e){this._updateHighlight()}};WI.LogContentView=class extends WI.ContentView{constructor(e){super(e),this._nestingLevel=0,this._selectedMessages=[],this._provisionalMessages=[],this.element.classList.add("log"),this.messagesElement=document.createElement("div"),this.messagesElement.classList.add("console-messages"),this.messagesElement.tabIndex=0,this.messagesElement.setAttribute("role","log"),this.messagesElement.addEventListener("mousedown",this._mousedown.bind(this)),this.messagesElement.addEventListener("keydown",this._keyDown.bind(this)),this.messagesElement.addEventListener("keypress",this._keyPress.bind(this)),this.messagesElement.addEventListener("dragstart",this._ondragstart.bind(this),!0),this.messagesElement.addEventListener("dragover",this._handleDragOver.bind(this)),this.messagesElement.addEventListener("drop",this._handleDrop.bind(this)),this.element.appendChild(this.messagesElement),this.prompt=WI.quickConsole.prompt,this._keyboardShortcutCommandA=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl,"A"),this._keyboardShortcutEsc=new WI.KeyboardShortcut(null,WI.KeyboardShortcut.Key.Escape),this._logViewController=new WI.JavaScriptLogViewController(this.messagesElement,this.element,this.prompt,this,"console-prompt-history"),this._lastMessageView=null;const t=!0;this._findBanner=new WI.FindBanner(this,"console-find-banner",t),this._findBanner.targetElement=this.element,this._currentSearchQuery="",this._searchMatches=[],this._selectedSearchMatch=null,this._selectedSearchMatchIsValid=!1,this._preserveLogNavigationItem=new WI.CheckboxNavigationItem("preserve-log",WI.UIString("Preserve Log"),!WI.settings.clearLogOnNavigate.value),this._preserveLogNavigationItem.tooltip=WI.UIString("Do not clear the console on new page loads"),this._preserveLogNavigationItem.addEventListener(WI.CheckboxNavigationItem.Event.CheckedDidChange,()=>{WI.settings.clearLogOnNavigate.value=!WI.settings.clearLogOnNavigate.value}),WI.settings.clearLogOnNavigate.addEventListener(WI.Setting.Event.Changed,this._handleClearLogOnNavigateSettingChanged,this),this._emulateInUserGestureNavigationItem=new WI.CheckboxNavigationItem("emulate-in-user-gesture",WI.UIString("Emulate User Gesture"),WI.settings.emulateInUserGesture.value),this._emulateInUserGestureNavigationItem.tooltip=WI.UIString("Run console commands as if inside a user gesture"),this._emulateInUserGestureNavigationItem.addEventListener(WI.CheckboxNavigationItem.Event.CheckedDidChange,()=>{WI.settings.emulateInUserGesture.value=!WI.settings.emulateInUserGesture.value}),WI.settings.emulateInUserGesture.addEventListener(WI.Setting.Event.Changed,this._handleEmulateInUserGestureSettingChanged,this),this._checkboxesNavigationItemGroup=new WI.GroupNavigationItem([this._preserveLogNavigationItem,this._emulateInUserGestureNavigationItem,new WI.DividerNavigationItem]);let i=[new WI.ScopeBarItem(WI.LogContentView.Scopes.All,WI.UIString("All"),{exclusive:!0}),new WI.ScopeBarItem(WI.LogContentView.Scopes.Evaluations,WI.UIString("Evaluations"),{className:"evaluations"}),new WI.ScopeBarItem(WI.LogContentView.Scopes.Errors,WI.UIString("Errors"),{className:"errors"}),new WI.ScopeBarItem(WI.LogContentView.Scopes.Warnings,WI.UIString("Warnings"),{className:"warnings"}),new WI.ScopeBarItem(WI.LogContentView.Scopes.Logs,WI.UIString("Logs"),{className:"logs"}),new WI.ScopeBarItem(WI.LogContentView.Scopes.Infos,WI.UIString("Infos"),{className:"infos",hidden:!0}),new WI.ScopeBarItem(WI.LogContentView.Scopes.Debugs,WI.UIString("Debugs"),{className:"debugs",hidden:!0})];for(let n of i){let s=n.element.insertBefore(document.createElement("div"),n.element.firstChild);s.className="indicator"}if(this._scopeBar=new WI.ScopeBar("log-scope-bar",i,i[0]),this._scopeBar.addEventListener(WI.ScopeBar.Event.SelectionChanged,this._scopeBarSelectionDidChange,this),this._hasNonDefaultLogChannelMessage=!1,WI.ConsoleManager.supportsLogChannels()){let n=[new WI.ScopeBarItem(WI.LogContentView.Scopes.AllChannels,WI.UIString("All"),{exclusive:!0}),new WI.ScopeBarItem(WI.LogContentView.Scopes.Media,WI.UIString("Media"),{className:"media"}),new WI.ScopeBarItem(WI.LogContentView.Scopes.MediaSource,WI.UIString("MediaSource"),{className:"mediasource"}),new WI.ScopeBarItem(WI.LogContentView.Scopes.WebRTC,WI.UIString("WebRTC"),{className:"webrtc"})];this._messageSourceBar=new WI.ScopeBar("message-channel-scope-bar",n,n[0]),this._messageSourceBar.addEventListener(WI.ScopeBar.Event.SelectionChanged,this._messageSourceBarSelectionDidChange,this)}this._garbageCollectNavigationItem=new WI.ButtonNavigationItem("garbage-collect",WI.UIString("Collect garbage"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' viewBox='0 0 16 16'%3e %3cpath fill='currentColor' fill-rule='evenodd' d='M 10.1589104 13.4997743C 7.6207023 14.9652094 4.41851284 14.2388343 2.74398502 11.9078979L 4.31515363 11.0007832.421523602 8.89653784.296314315 13.3210612 1.65145707 12.5386692C 3.54608019 15.2801236 7.14278804 16.2718354 10.1691404 14.9049059L 10.1589104 13.4997743zM 1.67902543 8.51419182C 1.7234718 5.64447423 3.9060071 3.29358667 6.70386082 2.98429963L 6.70386082 4.76349105 10.4730058 2.44363124 6.70386082.122935137 6.70386082 1.72158218C 3.41613949 2.01785462.792429597 4.61690383.457986941 7.89347401.457986941 7.89347401 1.67856516 8.54390992 1.67902543 8.51419182zM 11.412545 3.02613865C 11.412545 3.02613865 10.2139156 3.73931007 10.2411398 3.75563434 12.7083426 5.23502792 13.6489697 8.31336275 12.5013398 10.8944151L 11.1011966 10.0860421 11.2256817 14.5101473 15.1200359 12.4063201 13.5944092 11.5254991C 14.9935767 8.53568734 14.068459 4.96425679 11.412545 3.02613865 Z'/%3e %3c/svg%3e",16,16),this._garbageCollectNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._garbageCollectNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._garbageCollect,this),this._clearLogNavigationItem=new WI.ButtonNavigationItem("clear-log",WI.UIString("Clear log (%s or %s)").format(WI.clearKeyboardShortcut.displayName,this._logViewController.messagesAlternateClearKeyboardShortcut.displayName),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' d='M 3.5 12.5 l -1 -10 h -1 h 11.9 h -1 l -1 10 H 3.5 z'/%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' d='M 5.5 2 L 5.5 0.5 L 9.5 0.5 L 9.5 2'/%3e %3cline fill='none' stroke='currentColor' stroke-linecap='round' x1='5.5' y1='9.2' x2='9.4' y2='5.3'/%3e %3cline fill='none' stroke='currentColor' stroke-linecap='round' x1='5.5' y1='5.2' x2='9.4' y2='9.2'/%3e %3c/svg%3e",15,15),this._clearLogNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._clearLogNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._clearLog,this),this._showConsoleTabNavigationItem=new WI.ButtonNavigationItem("show-tab",WI.UIString("Show Console tab"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='none' stroke='currentColor' d='M 12 7 L 8 3 L 4 7'/%3e %3cpath fill='none' stroke='currentColor' d='M 12 13 L 8 9 L 4 13'/%3e %3c/svg%3e",16,16),this._showConsoleTabNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.High,this._showConsoleTabNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._showConsoleTab,this),this.messagesElement.addEventListener("contextmenu",this._handleContextMenuEvent.bind(this),!1),WI.consoleManager.addEventListener(WI.ConsoleManager.Event.SessionStarted,this._sessionStarted,this),WI.consoleManager.addEventListener(WI.ConsoleManager.Event.MessageAdded,this._messageAdded,this),WI.consoleManager.addEventListener(WI.ConsoleManager.Event.PreviousMessageRepeatCountUpdated,this._previousMessageRepeatCountUpdated,this),WI.consoleManager.addEventListener(WI.ConsoleManager.Event.Cleared,this._logCleared,this),WI.Frame.addEventListener(WI.Frame.Event.ProvisionalLoadStarted,this._provisionalLoadStarted,this)}get navigationItems(){let e=[this._scopeBar,new WI.DividerNavigationItem];return this._hasNonDefaultLogChannelMessage&&this._messageSourceBar&&e.push(this._messageSourceBar,new WI.DividerNavigationItem),window.HeapAgent&&HeapAgent.gc&&e.push(this._garbageCollectNavigationItem),e.push(this._clearLogNavigationItem),WI.isShowingSplitConsole()?e.push(new WI.DividerNavigationItem,this._showConsoleTabNavigationItem):WI.isShowingConsoleTab()&&e.unshift(this._findBanner,this._checkboxesNavigationItemGroup),e}get scopeBar(){return this._scopeBar}get logViewController(){return this._logViewController}get scrollableElements(){return[this.element]}get shouldKeepElementsScrolledToBottom(){return!0}shown(){super.shown(),this._logViewController.renderPendingMessages()}closed(){console.assert(this===WI.consoleContentView),super.closed()}didAppendConsoleMessageView(e){console.assert(e instanceof WI.ConsoleMessageView||e instanceof WI.ConsoleCommandView);var t=e instanceof WI.ConsoleCommandView?null:e.message.type;if(this._nestingLevel&&t!==WI.ConsoleMessage.MessageType.EndGroup){var i=16*this._nestingLevel,n=e.element;n.style.left=i+"px",n.style.width="calc(100% - "+i+"px)"}switch(t){case WI.ConsoleMessage.MessageType.StartGroup:case WI.ConsoleMessage.MessageType.StartGroupCollapsed:++this._nestingLevel;break;case WI.ConsoleMessage.MessageType.EndGroup:this._nestingLevel>0&&--this._nestingLevel;break}this._clearFocusableChildren(),(e.message?e.message.target:WI.runtimeManager.activeExecutionContext.target).connection.runAfterPendingDispatches(this._clearFocusableChildren.bind(this)),e instanceof WI.ConsoleCommandView||e.message instanceof WI.ConsoleCommandResultMessage?this._markScopeBarItemUnread(WI.LogContentView.Scopes.Evaluations):this._markScopeBarItemForMessageLevelUnread(e.message.level),console.assert(e.element instanceof Element),this._filterMessageElements([e.element])}get supportsSearch(){return!0}get numberOfSearchResults(){return this.hasPerformedSearch?this._searchMatches.length:null}get hasPerformedSearch(){return this._currentSearchQuery!==""}get supportsCustomFindBanner(){return WI.isShowingConsoleTab()}showCustomFindBanner(){!this.visible||this._findBanner.focus()}get supportsSave(){return!(!this.visible||WI.isShowingSplitConsole())}get saveData(){return{url:WI.FileUtilities.inspectorURLForFilename("Console.txt"),content:this._formatMessagesAsData(!1),forceSaveAs:!0}}handleCopyEvent(e){!this._selectedMessages.length||(e.clipboardData.setData("text/plain",this._formatMessagesAsData(!0)),e.stopPropagation(),e.preventDefault())}handleClearShortcut(e){this._logViewController.requestClearMessages()}handlePopulateFindShortcut(){let e=this.searchQueryWithSelection();!e||(this._findBanner.searchQuery=e,this.performSearch(this._findBanner.searchQuery))}handleFindNextShortcut(){this.findBannerRevealNextResult(this._findBanner)}handleFindPreviousShortcut(){this.findBannerRevealPreviousResult(this._findBanner)}findBannerRevealPreviousResult(){this.highlightPreviousSearchMatch()}highlightPreviousSearchMatch(){if(!(!this.hasPerformedSearch||isEmptyObject(this._searchMatches))){var e=this._selectedSearchMatch?this._searchMatches.indexOf(this._selectedSearchMatch):this._searchMatches.length;this._highlightSearchMatchAtIndex(e-1)}}findBannerRevealNextResult(){this.highlightNextSearchMatch()}highlightNextSearchMatch(){if(!(!this.hasPerformedSearch||isEmptyObject(this._searchMatches))){var e=this._selectedSearchMatch?this._searchMatches.indexOf(this._selectedSearchMatch)+1:0;this._highlightSearchMatchAtIndex(e)}}findBannerWantsToClearAndBlur(e){this._selectedMessages.length?this.messagesElement.focus():this.prompt.focus()}layout(){this._scrollElementHeight=this.messagesElement.getBoundingClientRect().height}_formatMessagesAsData(e){var t=this._allMessageElements();e&&(t=t.filter(function(s){return s.classList.contains(WI.LogContentView.SelectedStyleClassName)}));var i="",n=t.length<=1&&e;return t.forEach(function(s,a){var d=s.__messageView||s.__commandView;!d||(a>0&&(i+=`
`),i+=d.toClipboardString(n))}),i}_sessionStarted(e){if(WI.settings.clearLogOnNavigate.value){this._reappendProvisionalMessages();return}const t=!1,i=e.data.wasReloaded?WI.ConsoleSession.NewSessionReason.PageReloaded:WI.ConsoleSession.NewSessionReason.PageNavigated;this._logViewController.startNewSession(t,{newSessionReason:i,timestamp:e.data.timestamp}),this._clearProvisionalState()}_scopeFromMessageSource(e){switch(e){case WI.ConsoleMessage.MessageSource.Media:return WI.LogContentView.Scopes.Media;case WI.ConsoleMessage.MessageSource.WebRTC:return WI.LogContentView.Scopes.WebRTC;case WI.ConsoleMessage.MessageSource.MediaSource:return WI.LogContentView.Scopes.MediaSource}}_scopeFromMessageLevel(e){switch(e){case WI.ConsoleMessage.MessageLevel.Warning:return WI.LogContentView.Scopes.Warnings;case WI.ConsoleMessage.MessageLevel.Error:return WI.LogContentView.Scopes.Errors;case WI.ConsoleMessage.MessageLevel.Log:return WI.LogContentView.Scopes.Logs;case WI.ConsoleMessage.MessageLevel.Info:return this._hasNonDefaultLogChannelMessage?WI.LogContentView.Scopes.Infos:WI.LogContentView.Scopes.Logs;case WI.ConsoleMessage.MessageLevel.Debug:return this._hasNonDefaultLogChannelMessage?WI.LogContentView.Scopes.Debugs:WI.LogContentView.Scopes.Logs}console.assert(!1,"This should not be reached.")}_markScopeBarItemUnread(e){let t=this._scopeBar.item(e);t&&!t.selected&&!this._scopeBar.item(WI.LogContentView.Scopes.All).selected&&t.element.classList.add("unread")}_markScopeBarItemForMessageLevelUnread(e){let t=this._scopeFromMessageLevel(e);!t||this._markScopeBarItemUnread(t)}_messageAdded(e){let t=e.data.message;this._startedProvisionalLoad&&this._provisionalMessages.push(t),!this._hasNonDefaultLogChannelMessage&&WI.consoleManager.logChannelSources.includes(t.source)&&(this._hasNonDefaultLogChannelMessage=!0,this.dispatchEventToListeners(WI.ContentView.Event.NavigationItemsDidChange),this._scopeBar.item(WI.LogContentView.Scopes.Infos).hidden=!1,this._scopeBar.item(WI.LogContentView.Scopes.Debugs).hidden=!1),this._logViewController.appendConsoleMessage(t)}_previousMessageRepeatCountUpdated(e){this._logViewController.updatePreviousMessageRepeatCount(e.data.count)&&this._lastMessageView&&this._markScopeBarItemForMessageLevelUnread(this._lastMessageView.message.level)}_handleContextMenuEvent(e){if(!window.getSelection().isCollapsed||(this._selectedMessages.length&&!this._selectedMessages.some(i=>i.contains(e.target))&&(this._clearMessagesSelection(),this._mousedown(e)),this._selectedMessages.length||this._mouseup(e),e.target.closest("a")))return;let t=WI.ContextMenu.createFromEvent(e);this._selectedMessages.length&&(t.appendItem(WI.UIString("Copy Selected"),()=>{InspectorFrontendHost.copyText(this._formatMessagesAsData(!0))}),t.appendItem(WI.UIString("Save Selected"),()=>{WI.FileUtilities.save({url:WI.FileUtilities.inspectorURLForFilename("Console.txt"),content:this._formatMessagesAsData(!0)},!0)}),t.appendSeparator()),t.appendItem(WI.UIString("Clear Log"),this._clearLog.bind(this)),t.appendSeparator()}_mousedown(e){if(!(this._selectedMessages.length&&(e.button!==0||e.ctrlKey))){if(e.defaultPrevented){this._clearMessagesSelection();return}this._mouseDownWrapper=e.target.closest("."+WI.LogContentView.ItemWrapperStyleClassName),this._mouseDownShiftKey=e.shiftKey,this._mouseDownCommandKey=e.metaKey,this._mouseMoveIsRowSelection=!1,window.addEventListener("mousemove",this),window.addEventListener("mouseup",this)}}_targetInMessageCanBeSelected(e,t){return!e.closest("a")}_mousemove(e){var t=window.getSelection(),i=e.target.closest("."+WI.LogContentView.ItemWrapperStyleClassName);if(!i&&(t.isCollapsed||(i=t.focusNode.closest("."+WI.LogContentView.ItemWrapperStyleClassName)),!i)){t.removeAllRanges();return}t.isCollapsed||this._clearMessagesSelection(),!(i===this._mouseDownWrapper&&!this._mouseMoveIsRowSelection)&&(!this.element.contains(e.target)||(t.removeAllRanges(),this._mouseMoveIsRowSelection||this._updateMessagesSelection(this._mouseDownWrapper,this._mouseDownCommandKey,this._mouseDownShiftKey,!1),this._updateMessagesSelection(i,!1,!0,!1),this._mouseMoveIsRowSelection=!0,e.preventDefault(),e.stopPropagation()))}_mouseup(e){window.removeEventListener("mousemove",this),window.removeEventListener("mouseup",this);var t=window.getSelection(),i=e.target.closest("."+WI.LogContentView.ItemWrapperStyleClassName);if(i&&(t.isCollapsed||e.shiftKey)){if(t.removeAllRanges(),this._targetInMessageCanBeSelected(e.target,i)){var n=i===this._mouseDownWrapper;this._updateMessagesSelection(i,n?this._mouseDownCommandKey:!1,n?this._mouseDownShiftKey:!0,!1)}}else t.isCollapsed?this._mouseDownWrapper||(this._clearMessagesSelection(),setTimeout(()=>{this.prompt.focus()},0)):this._clearMessagesSelection();delete this._mouseMoveIsRowSelection,delete this._mouseDownWrapper,delete this._mouseDownShiftKey,delete this._mouseDownCommandKey}_ondragstart(e){e.target.closest("."+WI.DOMTreeOutline.StyleClassName)&&(e.stopPropagation(),e.preventDefault())}_handleDragOver(e){e.dataTransfer.types.includes(WI.DOMTreeOutline.DOMNodeIdDragType)&&(e.preventDefault(),e.dataTransfer.dropEffect="copy")}_handleDrop(e){let t=e.dataTransfer.getData(WI.DOMTreeOutline.DOMNodeIdDragType);if(t){e.preventDefault();let i=WI.domManager.nodeForId(t);WI.RemoteObject.resolveNode(i,WI.RuntimeManager.ConsoleObjectGroup).then(n=>{let s=i.nodeType()===Node.ELEMENT_NODE?WI.UIString("Dropped Element"):WI.UIString("Dropped Node");const a=!0;WI.consoleLogViewController.appendImmediateExecutionWithResult(s,n,a),this.prompt.focus()})}}handleEvent(e){switch(e.type){case"mousemove":this._mousemove(e);break;case"mouseup":this._mouseup(e);break}}_updateMessagesSelection(e,t,i,n){if(console.assert(e),!!e){var s=this._selectedMessages.includes(e);if(s&&this._selectedMessages.length&&t){e.classList.remove(WI.LogContentView.SelectedStyleClassName),this._selectedMessages.remove(e);return}if(!t&&!i&&this._clearMessagesSelection(),i){var a=this._visibleMessageElements(),d=this._referenceMessageForRangeSelection?a.indexOf(this._referenceMessageForRangeSelection):0,p=a.indexOf(e),f=[Math.min(d,p),Math.max(d,p)];if(this._selectionRange&&this._selectionRange[0]===f[0]&&this._selectionRange[1]===f[1])return;for(var _=this._selectionRange?Math.min(this._selectionRange[0],f[0]):f[0],b=this._selectionRange?Math.max(this._selectionRange[1],f[1]):f[1],w=_;w<=b;++w){var S=a[w];w>=f[0]&&w<=f[1]&&!S.classList.contains(WI.LogContentView.SelectedStyleClassName)?(S.classList.add(WI.LogContentView.SelectedStyleClassName),this._selectedMessages.push(S)):(w<f[0]||w>f[1]&&S.classList.contains(WI.LogContentView.SelectedStyleClassName))&&(S.classList.remove(WI.LogContentView.SelectedStyleClassName),this._selectedMessages.remove(S))}this._selectionRange=f}else e.classList.add(WI.LogContentView.SelectedStyleClassName),this._selectedMessages.push(e),this._selectionRange=null;i||(this._referenceMessageForRangeSelection=e),n&&!s&&this._ensureMessageIsVisible(this._selectedMessages.lastValue)}}_ensureMessageIsVisible(e){if(!!e){var t=this._positionForMessage(e).y;if(t<0){this.element.scrollTop+=t;return}var i=this._nextMessage(e);i?(t=this._positionForMessage(i).y,t>this._scrollElementHeight&&(this.element.scrollTop+=t-this._scrollElementHeight)):(t+=e.getBoundingClientRect().height,t>this._scrollElementHeight&&(this.element.scrollTop+=t-this._scrollElementHeight))}}_positionForMessage(e){var t=window.webkitConvertPointFromNodeToPage(e,new WebKitPoint(0,0));return window.webkitConvertPointFromPageToNode(this.element,t)}_isMessageVisible(e){var t=e;if(t.classList.contains(WI.LogContentView.FilteredOutStyleClassName)||this.hasPerformedSearch&&t.classList.contains(WI.LogContentView.FilteredOutBySearchStyleClassName))return!1;for(e.classList.contains("console-group-title")&&(t=t.parentNode.parentNode);t&&t!==this.messagesElement;){if(t.classList.contains("collapsed"))return!1;t=t.parentNode}return!0}_isMessageSelected(e){return e.classList.contains(WI.LogContentView.SelectedStyleClassName)}_clearMessagesSelection(){this._selectedMessages.forEach(function(e){e.classList.remove(WI.LogContentView.SelectedStyleClassName)}),this._selectedMessages=[],delete this._referenceMessageForRangeSelection}_selectAllMessages(){this._clearMessagesSelection();for(var e=this._visibleMessageElements(),t=0;t<e.length;++t){var i=e[t];i.classList.add(WI.LogContentView.SelectedStyleClassName),this._selectedMessages.push(i)}}_allMessageElements(){return Array.from(this.messagesElement.querySelectorAll(".console-message, .console-user-command"))}_unfilteredMessageElements(){return this._allMessageElements().filter(function(e){return!e.classList.contains(WI.LogContentView.FilteredOutStyleClassName)})}_visibleMessageElements(){var e=this._unfilteredMessageElements();return this.hasPerformedSearch?e.filter(function(t){return!t.classList.contains(WI.LogContentView.FilteredOutBySearchStyleClassName)}):e}_logCleared(e){for(let t of this._scopeBar.items)t.element.classList.remove("unread");this._logViewController.clear(),this._nestingLevel=0,this._currentSearchQuery&&this.performSearch(this._currentSearchQuery)}_showConsoleTab(){WI.showConsoleTab()}_clearLog(){WI.consoleManager.requestClearMessages()}_garbageCollect(){for(let e of WI.targets)e.HeapAgent&&e.HeapAgent.gc()}_messageShouldBeVisible(e){let t=this._messageSourceBar&&this._scopeFromMessageSource(e.source);if(t&&!this._messageSourceBar.item(t).selected&&!this._messageSourceBar.item(WI.LogContentView.Scopes.AllChannels).selected)return!1;let i=this._scopeFromMessageLevel(e.level);return i?this._scopeBar.item(i).selected||this._scopeBar.item(WI.LogContentView.Scopes.All).selected:!0}_messageSourceBarSelectionDidChange(e){let t=this._messageSourceBar.selectedItems;t.some(i=>i.id===WI.LogContentView.Scopes.AllChannels)&&(t=this._messageSourceBar.items);for(let i of t)i.element.classList.remove("unread");this._filterMessageElements(this._allMessageElements())}_scopeBarSelectionDidChange(e){let t=this._scopeBar.selectedItems;t.some(i=>i.id===WI.LogContentView.Scopes.All)&&(t=this._scopeBar.items);for(let i of t)i.element.classList.remove("unread");this._filterMessageElements(this._allMessageElements())}_filterMessageElements(e){e.forEach(function(t){let i=!1;t.__commandView instanceof WI.ConsoleCommandView||t.__message instanceof WI.ConsoleCommandResultMessage?i=this._scopeBar.selectedItems.some(s=>s.id===WI.LogContentView.Scopes.Evaluations||s.id===WI.LogContentView.Scopes.All):i=this._messageShouldBeVisible(t.__message);let n=t.classList;i?n.remove(WI.LogContentView.FilteredOutStyleClassName):(this._selectedMessages.remove(t),n.remove(WI.LogContentView.SelectedStyleClassName),n.add(WI.LogContentView.FilteredOutStyleClassName))},this),this.performSearch(this._currentSearchQuery)}_handleClearLogOnNavigateSettingChanged(){this._preserveLogNavigationItem.checked=!WI.settings.clearLogOnNavigate.value}_handleEmulateInUserGestureSettingChanged(){this._emulateInUserGestureNavigationItem.checked=WI.settings.emulateInUserGesture.value}_keyDown(e){let t=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL;this._keyboardShortcutCommandA.matchesEvent(e)?this._commandAWasPressed(e):this._keyboardShortcutEsc.matchesEvent(e)?this._escapeWasPressed(e):e.keyIdentifier==="Up"?this._upArrowWasPressed(e):e.keyIdentifier==="Down"?this._downArrowWasPressed(e):!t&&e.keyIdentifier==="Left"||t&&e.keyIdentifier==="Right"?this._leftArrowWasPressed(e):!t&&e.keyIdentifier==="Right"||t&&e.keyIdentifier==="Left"?this._rightArrowWasPressed(e):e.keyIdentifier==="Enter"&&e.metaKey&&this._commandEnterWasPressed(e)}_keyPress(e){e.metaKey&&e.keyCode===99||this.prompt.focus()}_commandAWasPressed(e){this._selectAllMessages(),e.preventDefault()}_escapeWasPressed(e){this._selectedMessages.length?this._clearMessagesSelection():this.prompt.focus(),e.preventDefault()}_upArrowWasPressed(e){var t=this._visibleMessageElements();if(!this._selectedMessages.length){t.length&&this._updateMessagesSelection(t.lastValue,!1,!1,!0);return}var i=this._selectedMessages.lastValue,n=this._previousMessage(i);n?this._updateMessagesSelection(n,!1,e.shiftKey,!0):e.shiftKey||(this._clearMessagesSelection(),this._updateMessagesSelection(t[0],!1,!1,!0)),e.preventDefault()}_downArrowWasPressed(e){var t=this._visibleMessageElements();if(!this._selectedMessages.length){t.length&&this._updateMessagesSelection(t[0],!1,!1,!0);return}var i=this._selectedMessages.lastValue,n=this._nextMessage(i);n?this._updateMessagesSelection(n,!1,e.shiftKey,!0):e.shiftKey||(this._clearMessagesSelection(),this._updateMessagesSelection(t.lastValue,!1,!1,!0)),e.preventDefault()}_leftArrowWasPressed(e){if(this._selectedMessages.length===1){var t=this._selectedMessages[0];t.classList.contains("console-group-title")?(t.parentNode.classList.add("collapsed"),e.preventDefault()):t.__messageView&&t.__messageView.expandable&&(t.__messageView.collapse(),e.preventDefault())}}_rightArrowWasPressed(e){if(this._selectedMessages.length===1){var t=this._selectedMessages[0];t.classList.contains("console-group-title")?(t.parentNode.classList.remove("collapsed"),e.preventDefault()):t.__messageView&&t.__messageView.expandable&&(t.__messageView.expand(),e.preventDefault())}}_commandEnterWasPressed(e){if(this._selectedMessages.length!==1)return;let t=this._selectedMessages[0];t.__commandView&&t.__commandView.commandText&&(this._logViewController.consolePromptTextCommitted(null,t.__commandView.commandText),e.preventDefault())}_previousMessage(e){for(var t=this._visibleMessageElements(),i=t.indexOf(e)-1;i>=0;--i)if(this._isMessageVisible(t[i]))return t[i];return null}_nextMessage(e){for(var t=this._visibleMessageElements(),i=t.indexOf(e)+1;i<t.length;++i)if(this._isMessageVisible(t[i]))return t[i];return null}_clearFocusableChildren(){for(var e=this.messagesElement.querySelectorAll("[tabindex]"),t=0,i=e.length;t<i;++t)e[t].removeAttribute("tabindex")}findBannerPerformSearch(e,t){this.performSearch(t)}findBannerSearchCleared(){this.searchCleared()}revealNextSearchResult(){this.findBannerRevealNextResult()}revealPreviousSearchResult(){this.findBannerRevealPreviousResult()}performSearch(e){isEmptyObject(this._searchHighlightDOMChanges)||WI.revertDOMChanges(this._searchHighlightDOMChanges),this._currentSearchQuery=e,this._searchHighlightDOMChanges=[],this._searchMatches=[],this._selectedSearchMatchIsValid=!1,this._selectedSearchMatch=null;let t=0;if(this._currentSearchQuery===""){this.element.classList.remove(WI.LogContentView.SearchInProgressStyleClassName),this.dispatchEventToListeners(WI.ContentView.Event.NumberOfSearchResultsDidChange);return}this.element.classList.add(WI.LogContentView.SearchInProgressStyleClassName);let i=WI.SearchUtilities.regExpForString(this._currentSearchQuery,WI.SearchUtilities.defaultSettings);this._unfilteredMessageElements().forEach(function(n){let s=[],a=n.textContent,d=i.exec(a);for(;d;)t++,s.push({offset:d.index,length:d[0].length}),d=i.exec(a);isEmptyObject(s)||this._highlightRanges(n,s);let p=n.classList;isEmptyObject(s)?p.add(WI.LogContentView.FilteredOutBySearchStyleClassName):p.remove(WI.LogContentView.FilteredOutBySearchStyleClassName)},this),this.dispatchEventToListeners(WI.ContentView.Event.NumberOfSearchResultsDidChange),this._findBanner.numberOfResults=t,!this._selectedSearchMatchIsValid&&this._selectedSearchMatch&&(this._selectedSearchMatch.highlight.classList.remove(WI.LogContentView.SelectedStyleClassName),this._selectedSearchMatch=null)}searchHidden(){this.searchCleared()}searchCleared(){this.performSearch("")}_highlightRanges(e,t){var i=WI.highlightRangesWithStyleClass(e,t,WI.LogContentView.HighlightedStyleClassName,this._searchHighlightDOMChanges);console.assert(i.length===t.length),t.forEach(function(n,s){this._searchMatches.push({message:e,range:n,highlight:i[s]}),this._selectedSearchMatch&&!this._selectedSearchMatchIsValid&&this._selectedSearchMatch.message===e&&(this._selectedSearchMatchIsValid=this._rangesOverlap(this._selectedSearchMatch.range,n),this._selectedSearchMatchIsValid&&(delete this._selectedSearchMatch,this._highlightSearchMatchAtIndex(this._searchMatches.length-1)))},this)}_rangesOverlap(e,t){return e.offset<=t.offset+t.length&&t.offset<=e.offset+e.length}_highlightSearchMatchAtIndex(e){e>=this._searchMatches.length?e=0:e<0&&(e=this._searchMatches.length-1),this._selectedSearchMatch&&this._selectedSearchMatch.highlight.classList.remove(WI.LogContentView.SelectedStyleClassName),this._selectedSearchMatch=this._searchMatches[e],this._selectedSearchMatch.highlight.classList.add(WI.LogContentView.SelectedStyleClassName),this._ensureMessageIsVisible(this._selectedSearchMatch.message)}_provisionalLoadStarted(){this._startedProvisionalLoad=!0}_reappendProvisionalMessages(){if(!!this._startedProvisionalLoad){this._startedProvisionalLoad=!1;for(let e of this._provisionalMessages)this._logViewController.appendConsoleMessage(e);this._provisionalMessages=[]}}_clearProvisionalState(){this._startedProvisionalLoad=!1,this._provisionalMessages=[]}};WI.LogContentView.Scopes={All:"log-all",Debugs:"log-debugs",Errors:"log-errors",Evaluations:"log-evaluations",Infos:"log-infos",Logs:"log-logs",Warnings:"log-warnings",AllChannels:"log-all-channels",Media:"log-media",MediaSource:"log-mediasource",WebRTC:"log-webrtc"};WI.LogContentView.ItemWrapperStyleClassName="console-item";WI.LogContentView.FilteredOutStyleClassName="filtered-out";WI.LogContentView.SelectedStyleClassName="selected";WI.LogContentView.SearchInProgressStyleClassName="search-in-progress";WI.LogContentView.FilteredOutBySearchStyleClassName="filtered-out-by-search";WI.LogContentView.HighlightedStyleClassName="highlighted";WI.MediaTimelineDataGridNode=class extends WI.TimelineDataGridNode{constructor(e,t={}){console.assert(e instanceof WI.MediaTimelineRecord),super([e],t)}get data(){return this._cachedData?this._cachedData:(this._cachedData=super.data,this._cachedData.name=this.record.displayName,this.record.domNode&&(this._cachedData.element=this.record.domNode),this._cachedData.time=this.record.startTime-(this.graphDataSource?this.graphDataSource.zeroTime:0),this.record.eventType===WI.MediaTimelineRecord.EventType.DOMEvent&&this.record.domEvent.originator&&(this._cachedData.originator=this.record.domEvent.originator),this._cachedData)}createCellContent(e,t){let i=this.data[e];switch(e){case"name":return t.classList.add(...this.iconClassNames()),i;case"source":case"element":return i?WI.linkifyNodeReference(i):emDash;case"time":return Number.secondsToString(i,!0);case"originator":return i?WI.linkifyNodeReference(i):zeroWidthSpace}return super.createCellContent(e,t)}iconClassNames(){let e=super.iconClassNames();return this.record.eventType===WI.MediaTimelineRecord.EventType.DOMEvent&&this.record.domEvent.eventName==="webkitfullscreenchange"&&e.push("fullscreen"),e}filterableDataForColumn(e){return e==="element"&&this.record.domNode?this.record.domNode.displayName:e==="originator"&&this.record.eventType===WI.MediaTimelineRecord.EventType.DOMEvent&&this.record.domEvent.originator?this.record.domEvent.originator.displayName:super.filterableDataForColumn(e)}};WI.MediaTimelineOverviewGraph=class extends WI.TimelineOverviewGraph{constructor(e,t){console.assert(e instanceof WI.Timeline),console.assert(e.type===WI.TimelineRecord.Type.Media),super(t),this._timeline=e,this._recordBars=[],this.element.classList.add("media"),this.reset()}reset(){this.element.removeChildren(),super.reset()}shown(){super.shown(),this._timeline.addEventListener(WI.Timeline.Event.RecordAdded,this._handleRecordAdded,this)}hidden(){this._timeline.removeEventListener(null,null,this),super.hidden()}layout(){if(!this.visible)return;let e=0,t=(i,n)=>{let s=this._recordBars[e];s?(s.renderMode=n,s.records=i):s=this._recordBars[e]=new WI.TimelineRecordBar(this,i,n),s.refresh(this),s.element.parentNode||this.element.appendChild(s.element),++e};WI.TimelineRecordBar.createCombinedBars(this._timeline.records,this.timelineOverview.secondsPerPixel,this,t);for(let i=e;i<this._recordBars.length;++i)this._recordBars[i].records=null,this._recordBars[i].element.remove()}updateSelectedRecord(){super.updateSelectedRecord();for(let e of this._recordBars)if(e.records.includes(this.selectedRecord)){this.selectedRecordBar=e;return}this.selectedRecordBar=null}_handleRecordAdded(e){this.needsLayout()}};WI.MediaTimelineOverviewGraph.MaximumRowCount=6;WI.MediaTimelineView=class extends WI.TimelineView{constructor(e,t){console.assert(e instanceof WI.Timeline),console.assert(e.type===WI.TimelineRecord.Type.Media),super(e,t),this._timelineRuler=new WI.TimelineRuler;const i={name:{title:WI.UIString("Name"),width:"200px",icon:!0,sortable:!0,locked:!0},element:{title:WI.UIString("Element"),width:"150px",sortable:!0},time:{title:WI.UIString("Time"),width:"80px",sortable:!0,locked:!0},originator:{title:WI.UIString("Originator"),width:"150px",sortable:!0,hidden:!0},graph:{headerView:this._timelineRuler,locked:!0}};this._dataGrid=new WI.TimelineDataGrid(i),this._dataGrid.sortDelegate=this,this._dataGrid.sortColumnIdentifier="time",this._dataGrid.sortOrder=WI.DataGrid.SortOrder.Ascending,this._dataGrid.setColumnVisible("originator",!1),this._dataGrid.createSettings("media-timeline-view"),this.setupDataGrid(this._dataGrid),this.addSubview(this._dataGrid),this.element.classList.add("media"),e.addEventListener(WI.Timeline.Event.RecordAdded,this._handleRecordAdded,this),this._pendingRecords=[];for(let n of e.records)this._processRecord(n)}get secondsPerPixel(){return this._timelineRuler.secondsPerPixel}get selectionPathComponents(){if(!this._dataGrid.selectedNode||this._dataGrid.selectedNode.hidden)return null;let e=new WI.TimelineDataGridNodePathComponent(this._dataGrid.selectedNode);return e.addEventListener(WI.HierarchicalPathComponent.Event.SiblingWasSelected,this._handleSelectionPathComponentSiblingSelected,this),[e]}closed(){this.representedObject.removeEventListener(null,null,this),super.closed()}reset(){super.reset(),this._pendingRecords=[]}dataGridSortComparator(e,t,i,n){function s(d,p){return d&&!p?-1:p&&!d?1:!d&&!p?0:d.id-p.id}if(e==="name"){let d=i.displayName(),p=n.displayName();return d.extendedLocaleCompare(p)*t}if(e==="element")return s(i.record.domNode,n.record.domNode)*t;if(e==="time")return(i.record.startTime-n.record.startTime)*t;if(e==="originator"){let d=function(p){return p.eventType!==WI.MediaTimelineRecord.EventType.DOMEvent||!p.domEvent?null:p.domEvent.originator};var a=d;return s(d(i.record),d(n.record))*t}return null}layout(){super.layout(),this.endTime=Math.min(this.endTime,this.currentTime);let e=this._timelineRuler.zeroTime,t=this._timelineRuler.startTime,i=this._timelineRuler.endTime;if(this._timelineRuler.zeroTime=this.zeroTime,this._timelineRuler.startTime=this.startTime,this._timelineRuler.endTime=this.endTime,this.zeroTime!==e||this.startTime!==t||this.endTime!==i)for(let n of this._dataGrid.children)n.refreshGraph();this._processPendingRecords()}_processPendingRecords(){if(!!this._pendingRecords.length){for(let e of this._pendingRecords)e.domEvent&&e.domEvent.originator&&this._dataGrid.setColumnVisible("originator",!0),this._dataGrid.addRowInSortOrder(new WI.MediaTimelineDataGridNode(e,{graphDataSource:this}));this._pendingRecords=[]}}_handleRecordAdded(e){let t=e.data.record;console.assert(t instanceof WI.MediaTimelineRecord),this._processRecord(t),this.needsLayout()}_processRecord(e){this._pendingRecords.push(e)}_handleSelectionPathComponentSiblingSelected(e){let t=e.data.pathComponent;console.assert(t instanceof WI.TimelineDataGridNodePathComponent);let i=t.timelineDataGridNode;console.assert(i.dataGrid===this._dataGrid),i.revealAndSelect()}};WI.MemoryCategoryView=class extends WI.View{constructor(e,t){console.assert(typeof e=="string"),super(),this._category=e,this.element.classList.add("memory-category-view",e),this._detailsElement=this.element.appendChild(document.createElement("div")),this._detailsElement.classList.add("details");let i=this._detailsElement.appendChild(document.createElement("span"));i.classList.add("name"),i.textContent=t,this._detailsElement.appendChild(document.createElement("br")),this._detailsMaxElement=this._detailsElement.appendChild(document.createElement("span")),this._detailsElement.appendChild(document.createElement("br")),this._detailsMinElement=this._detailsElement.appendChild(document.createElement("span")),this._updateDetails(NaN,NaN),this._graphElement=this.element.appendChild(document.createElement("div")),this._graphElement.classList.add("graph"),this._chart=new WI.AreaChart,this.addSubview(this._chart),this._graphElement.appendChild(this._chart.element)}get category(){return this._category}clear(){this._cachedMinSize=void 0,this._cachedMaxSize=void 0,this._updateDetails(NaN,NaN),this._chart.clear()}updateChart(e,t,i,n,s,a,d){if(console.assert(t instanceof WI.Size),console.assert(n>=0),console.assert(s>=0),console.assert(n<=s),this._updateDetails(n,s),this._chart.clear(),this._chart.size=t,this._chart.needsLayout(),!e.length||!s)return;let p=0,f=d(e[0].size);this._chart.addPoint(p,f);for(let S of e){let E=a(S.time),k=d(S.size);this._chart.addPoint(E,k)}let _=e.lastValue,b=Math.floor(a(i)),w=d(_.size);this._chart.addPoint(b,w)}_updateDetails(e,t){this._cachedMinSize===e&&this._cachedMaxSize===t||(this._cachedMinSize=e,this._cachedMaxSize=t,this._detailsMaxElement.textContent=WI.UIString("Highest: %s").format(Number.isFinite(t)?Number.bytesToString(t):emDash),this._detailsMinElement.textContent=WI.UIString("Lowest: %s").format(Number.isFinite(e)?Number.bytesToString(e):emDash))}};WI.MemoryTimelineOverviewGraph=class extends WI.TimelineOverviewGraph{constructor(e,t){console.assert(e instanceof WI.MemoryTimeline),super(t),this.element.classList.add("memory"),this._memoryTimeline=e,this._memoryTimeline.addEventListener(WI.Timeline.Event.RecordAdded,this._memoryTimelineRecordAdded,this),this._memoryTimeline.addEventListener(WI.MemoryTimeline.Event.MemoryPressureEventAdded,this._memoryTimelineMemoryPressureEventAdded,this),this._didInitializeCategories=!1,this._chart=new WI.StackedAreaChart,this._chart.size=new WI.Size(0,this.height),this.addSubview(this._chart),this.element.appendChild(this._chart.element),this._legendElement=this.element.appendChild(document.createElement("div")),this._legendElement.classList.add("legend"),this._memoryPressureMarkersContainerElement=this.element.appendChild(document.createElement("div")),this._memoryPressureMarkersContainerElement.classList.add("memory-pressure-markers-container"),this._memoryPressureMarkerElements=[],this.reset();for(let i of this._memoryTimeline.records)this._processRecord(i)}get height(){return 108}reset(){super.reset(),this._maxSize=0,this._cachedMaxSize=void 0,this._updateLegend(),this._chart.clear(),this._chart.needsLayout(),this._memoryPressureMarkersContainerElement.removeChildren(),this._memoryPressureMarkerElements=[]}layout(){if(!this.visible||(this._updateLegend(),this._chart.clear(),!this._didInitializeCategories))return;let e=this.timelineOverview.scrollContainerWidth;if(isNaN(e))return;(this._chart.size.width!==e||this._chart.size.height!==this.height)&&(this._chart.size=new WI.Size(e,this.height));let t=this.startTime,i=Math.min(this.endTime,this.currentTime),n=this.timelineOverview.secondsPerPixel,s=this._maxSize*1.05;function a(R){return(R-t)/n}let d=this.height;function p(R){return d-R/s*d}let f=this._visibleMemoryPressureEvents(t,i);for(let R=0;R<f.length;++R){let M=this._memoryPressureMarkerElements[R];M||(M=this._memoryPressureMarkersContainerElement.appendChild(document.createElement("div")),M.classList.add("memory-pressure-event"),this._memoryPressureMarkerElements[R]=M);let L=f[R],V=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?"right":"left";M.style.setProperty(V,`${a(L.timestamp)}px`)}if(this._memoryPressureMarkerElements.length-f.length){let R=this._memoryPressureMarkerElements.splice(f.length);for(let M of R)M.remove()}let b=this.timelineOverview.discontinuitiesInTimeRange(t,i),w=this._memoryTimeline.recordsInTimeRange(t,i,{includeRecordBeforeStart:!b.length||b[0].startTime>t,includeRecordAfterEnd:!0});if(!w.length)return;function S(R){let M=0,L=[];for(let V=0;V<R.categories.length;++V)M+=R.categories[V].size,L[V]=p(M);return L}w[0]===this._memoryTimeline.records[0]&&(!b.length||b[0].startTime>w[0].startTime)&&this._chart.addPointSet(0,S(w[0]));function E(R,M,L,V){if(console.assert(R||V),!(R||V))return;let H=a(M.startTime),O=a(L.endTime);R&&this._chart.addPointSet(H,S(R));let z=Array((R||V).categories.length).fill(p(0));this._chart.addPointSet(H,z),V?(this._chart.addPointSet(O,z),this._chart.addPointSet(O,S(V))):this._chart.addPointSet(a(i),z)}let k=null;for(let R of w){if(b.length&&b[0].endTime<=R.startTime){let L=b.shift(),V=L;for(;b.length&&b[0].endTime<=R.startTime;)V=b.shift();E.call(this,k,L,V,R)}let M=a(R.startTime);this._chart.addPointSet(M,S(R)),k=R}if(b.length)E.call(this,k,b[0],b[0],null);else{let R=w.lastValue;if(R.startTime<=i){let M=Math.floor(a(i));this._chart.addPointSet(M,S(R))}}}_updateLegend(){this._cachedMaxSize!==this._maxSize&&(this._cachedMaxSize=this._maxSize,this._maxSize?(this._legendElement.hidden=!1,this._legendElement.textContent=WI.UIString("Maximum Size: %s").format(Number.bytesToString(this._maxSize))):(this._legendElement.hidden=!0,this._legendElement.textContent=""))}_visibleMemoryPressureEvents(e,t){let i=this._memoryTimeline.memoryPressureEvents;if(!i.length)return[];let n=i.lowerBound(e,(a,d)=>a-d.timestamp),s=i.upperBound(t,(a,d)=>a-d.timestamp);return i.slice(n,s)}_memoryTimelineRecordAdded(e){let t=e.data.record;console.assert(t instanceof WI.MemoryTimelineRecord),this._processRecord(t),this.needsLayout()}_processRecord(e){if(this._maxSize=Math.max(this._maxSize,e.totalSize),!this._didInitializeCategories){this._didInitializeCategories=!0;let t=[];for(let i of e.categories)t.push(i.type);this._chart.initializeSections(t)}}_memoryTimelineMemoryPressureEventAdded(e){this.needsLayout()}};WI.MemoryTimelineView=class Ou extends WI.TimelineView{constructor(e,t){super(e,t),this._recording=t.recording,console.assert(e.type===WI.TimelineRecord.Type.Memory,e),this.element.classList.add("memory");let i=this.element.appendChild(document.createElement("div"));i.classList.add("content");let n=i.appendChild(document.createElement("div"));n.classList.add("overview");function s(S,E,k){let R=S.appendChild(document.createElement("div"));R.classList.add("chart");let M=R.appendChild(document.createElement("div"));M.classList.add("subtitle"),M.textContent=E,M.title=k;let L=R.appendChild(document.createElement("div"));return L.classList.add("container"),L}let a=WI.UIString("Breakdown of each memory category at the end of the selected time range"),d=s(n,WI.UIString("Breakdown"),a);this._usageCircleChart=new WI.CircleChart({size:120,innerRadiusRatio:.5}),this.addSubview(this._usageCircleChart),d.appendChild(this._usageCircleChart.element),this._usageLegendElement=d.appendChild(document.createElement("div")),this._usageLegendElement.classList.add("legend","usage"),n.appendChild(document.createElement("div")).classList.add("divider");let f=WI.UIString("Comparison of total memory size at the end of the selected time range to the maximum memory size in this recording"),_=s(n,WI.UIString("Max Comparison"),f);this._maxComparisonCircleChart=new WI.CircleChart({size:120,innerRadiusRatio:.5}),this.addSubview(this._maxComparisonCircleChart),_.appendChild(this._maxComparisonCircleChart.element),this._maxComparisonLegendElement=_.appendChild(document.createElement("div")),this._maxComparisonLegendElement.classList.add("legend","maximum");let b=this._detailsContainerElement=i.appendChild(document.createElement("div"));b.classList.add("details"),this._timelineRuler=new WI.TimelineRuler,this.addSubview(this._timelineRuler),b.appendChild(this._timelineRuler.element);let w=b.appendChild(document.createElement("div"));w.classList.add("subtitle"),w.textContent=WI.UIString("Categories"),this._didInitializeCategories=!1,this._categoryViews=[],this._usageLegendSizeElementMap=new Map,this._maxSize=0,this._maxComparisonMaximumSizeElement=null,this._maxComparisonCurrentSizeElement=null,e.addEventListener(WI.Timeline.Event.RecordAdded,this._memoryTimelineRecordAdded,this),this.element.addEventListener("mousemove",this._handleGraphMouseMove.bind(this));for(let S of e.records)this._processRecord(S)}static displayNameForCategory(e){switch(e){case WI.MemoryCategory.Type.JavaScript:return WI.UIString("JavaScript");case WI.MemoryCategory.Type.Images:return WI.UIString("Images");case WI.MemoryCategory.Type.Layers:return WI.UIString("Layers");case WI.MemoryCategory.Type.Page:return WI.UIString("Page")}}static get memoryCategoryViewHeight(){return 75}shown(){super.shown(),this._timelineRuler.updateLayout(WI.View.LayoutReason.Resize)}closed(){console.assert(this.representedObject instanceof WI.Timeline),this.representedObject.removeEventListener(null,null,this)}reset(){super.reset(),this._maxSize=0,this.clear()}clear(){this._cachedLegendRecord=null,this._cachedLegendMaxSize=void 0,this._cachedLegendCurrentSize=void 0,this._usageCircleChart.clear(),this._usageCircleChart.needsLayout(),this._clearUsageLegend(),this._maxComparisonCircleChart.clear(),this._maxComparisonCircleChart.needsLayout(),this._clearMaxComparisonLegend();for(let e of this._categoryViews)e.clear()}get scrollableElements(){return[this.element]}get showsFilterBar(){return!1}initialLayout(){super.initialLayout(),this.element.style.setProperty("--memory-category-view-height",Ou.memoryCategoryViewHeight+"px")}layout(){if(this.layoutReason===WI.View.LayoutReason.Resize||(this._timelineRuler.zeroTime=this.zeroTime,this._timelineRuler.startTime=this.startTime,this._timelineRuler.endTime=this.endTime,!this._didInitializeCategories))return;let e=this.startTime,t=this.endTime,i=this._timelineRuler.secondsPerPixel,n=Math.min(this.endTime,this.currentTime),s=this._recording.discontinuitiesInTimeRange(e,n),a=this.representedObject.recordsInTimeRange(e,n,{includeRecordBeforeStart:!s.length||s[0].startTime>e,includeRecordAfterEnd:!0});if(!a.length||a.length===1&&a[0].endTime<e){this.clear();return}let d=a.lastValue,p=[];for(let{size:b}of d.categories)p.push(b);this._usageCircleChart.values=p,this._usageCircleChart.updateLayout(),this._updateUsageLegend(d),this._maxComparisonCircleChart.values=[d.totalSize,this._maxSize-d.totalSize],this._maxComparisonCircleChart.updateLayout(),this._updateMaxComparisonLegend(d.totalSize);let f={};for(let b of this._categoryViews)f[b.category]={dataPoints:[],max:-1/0,min:1/0};for(let b of a){let w=b.startTime,S=null,E=null;if(s.length&&s[0].endTime<=w)for(S=s.shift(),E=S;s.length&&s[0].endTime<=w;)E=s.shift();for(let k of b.categories){let R=f[k.type];if(S){if(R.dataPoints.length){let M=R.dataPoints.lastValue;R.dataPoints.push({time:S.startTime,size:M.size})}R.dataPoints.push({time:S.startTime,size:0}),R.dataPoints.push({time:E.endTime,size:0}),R.dataPoints.push({time:E.endTime,size:k.size})}R.dataPoints.push({time:w,size:k.size}),R.max=Math.max(R.max,k.size),R.min=Math.min(R.min,k.size)}}s.length&&(n=s[0].startTime);function _(b,{dataPoints:w,min:S,max:E}){S===1/0&&(S=0),E===-1/0&&(E=0);let k=S*.95,R=E*1.05-k;function M(H){return(H-e)/i}let L=new WI.Size(M(t),Ou.memoryCategoryViewHeight);function V(H){return L.height-(H-k)/R*L.height}b.updateChart(w,L,n,S,E,M,V)}for(let b of this._categoryViews)_(b,f[b.category])}_graphPositionForMouseEvent(e){let t=e.target.closest(".area-chart, .stacked-area-chart, .range-chart");if(!t)return NaN;let i=t.getBoundingClientRect(),n=e.pageX-i.left;return WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?i.width-n:n}_handleGraphMouseMove(e){let t=this._graphPositionForMouseEvent(e);if(isNaN(t)){this.dispatchEventToListeners(WI.TimelineView.Event.ScannerHide);return}let i=this._timelineRuler.secondsPerPixel,n=this.startTime+t*i;this.dispatchEventToListeners(WI.TimelineView.Event.ScannerShow,{time:n})}_clearUsageLegend(){for(let t of this._usageLegendSizeElementMap.values())t.textContent=emDash;let e=this._usageCircleChart.centerElement.firstChild;e&&(e.firstChild.textContent="",e.lastChild.textContent="")}_updateUsageLegend(e){if(this._cachedLegendRecord===e)return;this._cachedLegendRecord=e;for(let{type:s,size:a}of e.categories){let d=this._usageLegendSizeElementMap.get(s);d.textContent=Number.isFinite(a)?Number.bytesToString(a):emDash}let t=this._usageCircleChart.centerElement,i=t.firstChild;i||(i=t.appendChild(document.createElement("div")),i.classList.add("total-usage"),i.appendChild(document.createElement("span")),i.appendChild(document.createElement("br")),i.appendChild(document.createElement("span")));let n=Number.bytesToString(e.totalSize).split(/\s+/);i.firstChild.textContent=n[0],i.lastChild.textContent=n[1]}_clearMaxComparisonLegend(){this._maxComparisonMaximumSizeElement&&(this._maxComparisonMaximumSizeElement.textContent=emDash),this._maxComparisonCurrentSizeElement&&(this._maxComparisonCurrentSizeElement.textContent=emDash);let e=this._maxComparisonCircleChart.centerElement.firstChild;e&&(e.textContent="")}_updateMaxComparisonLegend(e){if(this._cachedLegendMaxSize===this._maxSize&&this._cachedLegendCurrentSize===e)return;this._cachedLegendMaxSize=this._maxSize,this._cachedLegendCurrentSize=e,this._maxComparisonMaximumSizeElement.textContent=Number.isFinite(this._maxSize)?Number.bytesToString(this._maxSize):emDash,this._maxComparisonCurrentSizeElement.textContent=Number.isFinite(e)?Number.bytesToString(e):emDash;let t=this._maxComparisonCircleChart.centerElement,i=t.firstChild;i||(i=t.appendChild(document.createElement("div")),i.classList.add("max-percentage"));let n=e/this._maxSize;i.textContent=Number.percentageString(n===1?n:n-5e-4)}_initializeCategoryViews(e){console.assert(!this._didInitializeCategories,"Should only initialize category views once"),this._didInitializeCategories=!0;let t=[],i=null;function n(s,a,d,p){let f=s.appendChild(document.createElement("div"));f.classList.add("row"),f.appendChild(document.createElement("div")).classList.add("swatch",a);let b=f.appendChild(document.createElement("div"));b.classList.add("value");let w=b.appendChild(document.createElement("div"));w.classList.add("label"),w.textContent=d;let S=b.appendChild(document.createElement("div"));return S.classList.add("size"),p&&(f.title=p),S}for(let{type:s}of e.categories){t.push(s);let a=new WI.MemoryCategoryView(s,WI.MemoryTimelineView.displayNameForCategory(s));this._categoryViews.push(a),this.addSubview(a),i?this._detailsContainerElement.insertBefore(a.element,i):this._detailsContainerElement.appendChild(a.element),i=a.element;let d=n.call(this,this._usageLegendElement,s,WI.MemoryTimelineView.displayNameForCategory(s));this._usageLegendSizeElementMap.set(s,d)}this._usageCircleChart.segments=t,this._maxComparisonCircleChart.segments=["current","remainder"],this._maxComparisonMaximumSizeElement=n.call(this,this._maxComparisonLegendElement,"remainder",WI.UIString("Maximum"),WI.UIString("Maximum maximum memory size in this recording")),this._maxComparisonCurrentSizeElement=n.call(this,this._maxComparisonLegendElement,"current",WI.UIString("Current"),WI.UIString("Total memory size at the end of the selected time range"))}_memoryTimelineRecordAdded(e){let t=e.data.record;console.assert(t instanceof WI.MemoryTimelineRecord),this._processRecord(t),t.startTime>=this.startTime&&t.endTime<=this.endTime&&this.needsLayout()}_processRecord(e){this._didInitializeCategories||this._initializeCategoryViews(e),this._maxSize=Math.max(this._maxSize,e.totalSize)}};WI.MultipleScopeBarItem=class extends WI.Object{constructor(e){super(),this._element=document.createElement("li"),this._element.classList.add("multiple"),this._titleElement=document.createElement("span"),this._element.appendChild(this._titleElement),this._element.addEventListener("mousedown",this._handleMouseDown.bind(this)),this._selectElement=document.createElement("select"),this._selectElement.addEventListener("change",this._selectElementSelectionChanged.bind(this)),this._element.appendChild(this._selectElement),this._element.appendChild(WI.ImageUtilities.useSVGSymbol("data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 5 12'%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='square' d='M 0.5 3.5 L 2.5 1.5 L 4.5 3.5'/%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='square' d='M 0.5 8.5 L 2.5 10.5 L 4.5 8.5'/%3e %3c/svg%3e","arrows")),this.scopeBarItems=e}get element(){return this._element}get exclusive(){return!1}get scopeBarItems(){return this._scopeBarItems}set scopeBarItems(e){if(this._scopeBarItems)for(var t of this._scopeBarItems)t.removeEventListener(null,null,this);this._scopeBarItems=e||[],this._selectedScopeBarItem=null,this._selectElement.removeChildren();function i(n){var s=document.createElement("option"),a=130;return s.textContent=n.label.length<=a?n.label:n.label.substring(0,a)+ellipsis,s}for(var t of this._visibleScopeBarItems)t.selected&&!this._selectedScopeBarItem?this._selectedScopeBarItem=t:t.selected&&(t.selected=!1),t.addEventListener(WI.ScopeBarItem.Event.SelectionChanged,this._itemSelectionDidChange,this),t.addEventListener(WI.ScopeBarItem.Event.HiddenChanged,this._handleItemHiddenChanged,this),this._selectElement.appendChild(i(t));this._lastSelectedScopeBarItem=this._selectedScopeBarItem||this._scopeBarItems[0]||null,this._titleElement.textContent=this._lastSelectedScopeBarItem?this._lastSelectedScopeBarItem.label:"",this._element.classList.toggle("selected",!!this._selectedScopeBarItem),this._selectElement.selectedIndex=this._scopeBarItems.indexOf(this._selectedScopeBarItem)}get selected(){return!!this._selectedScopeBarItem}set selected(e){this.selectedScopeBarItem=e?this._lastSelectedScopeBarItem:null}get selectedScopeBarItem(){return this._selectedScopeBarItem}set selectedScopeBarItem(e){this._ignoreItemSelectedEvent=!0,this._selectedScopeBarItem?(this._selectedScopeBarItem.selected=!1,this._lastSelectedScopeBarItem=this._selectedScopeBarItem):this._lastSelectedScopeBarItem||(this._lastSelectedScopeBarItem=e),this._element.classList.toggle("selected",!!e),this._selectedScopeBarItem=e||null;let t=this._visibleScopeBarItems.indexOf(this._selectedScopeBarItem);t<0&&(t=0),this._selectElement.selectedIndex=t,this._selectedScopeBarItem&&(this.displaySelectedItem(),this._selectedScopeBarItem.selected=!0),this.dispatchEventToListeners(WI.ScopeBarItem.Event.SelectionChanged,{extendSelection:WI.modifierKeys.metaKey&&!WI.modifierKeys.ctrlKey&&!WI.modifierKeys.altKey&&!WI.modifierKeys.shiftKey}),this._ignoreItemSelectedEvent=!1}displaySelectedItem(){this._titleElement.textContent=(this._selectedScopeBarItem||this._scopeBarItems[0]).label}displayWidestItem(){let e=null,t=0;for(let i of Array.from(this._selectElement.options))this._titleElement.textContent=i.label,this._titleElement.realOffsetWidth>t&&(t=this._titleElement.realOffsetWidth,e=i.label);this._titleElement.textContent=e}get _visibleScopeBarItems(){return this._scopeBarItems.filter(e=>!e.hidden)}_handleMouseDown(e){if(e.button===0&&!e.__original){if(this._element.classList.contains("selected")){let t=new e.constructor(e.type,e);t.__original=e,e.stop(),this._selectElement.dispatchEvent(t);return}this.selected=!0}}_selectElementSelectionChanged(e){this.selectedScopeBarItem=this._visibleScopeBarItems[this._selectElement.selectedIndex]}_itemSelectionDidChange(e){this._ignoreItemSelectedEvent||(this.selectedScopeBarItem=e.target.selected?e.target:null)}_handleItemHiddenChanged(e){this.scopeBarItems=this._scopeBarItems}};WI.NavigationBar=class extends WI.View{constructor(e,t,i,n){if(super(e),this.element.classList.add(this.constructor.StyleClassName||"navigation-bar"),this.element.tabIndex=0,i&&this.element.setAttribute("role",i),n&&this.element.setAttribute("aria-label",n),this.element.addEventListener("focus",this._focus.bind(this),!1),this.element.addEventListener("blur",this._blur.bind(this),!1),this.element.addEventListener("keydown",this._keyDown.bind(this),!1),this.element.addEventListener("mousedown",this._mouseDown.bind(this),!1),this._mouseMovedEventListener=this._mouseMoved.bind(this),this._mouseUpEventListener=this._mouseUp.bind(this),this._forceLayout=!1,this._minimumWidth=NaN,this._navigationItems=[],this._selectedNavigationItem=null,t)for(var s=0;s<t.length;++s)this.addNavigationItem(t[s])}addNavigationItem(e,t){return this.insertNavigationItem(e,this._navigationItems.length,t)}insertNavigationItem(e,t,i){if(console.assert(e instanceof WI.NavigationItem),!(e instanceof WI.NavigationItem))return null;e.parentNavigationBar&&e.parentNavigationBar.removeNavigationItem(e),e.didAttach(this),console.assert(t>=0&&t<=this._navigationItems.length),t=Math.max(0,Math.min(t,this._navigationItems.length)),this._navigationItems.splice(t,0,e),i||(i=this.element);var n=this._navigationItems[t+1],s=n?n.element:null;return s&&s.parentNode!==i&&(s=null),i.insertBefore(e.element,s),this._minimumWidth=NaN,this.needsLayout(),e}removeNavigationItem(e){return console.assert(e instanceof WI.NavigationItem),!(e instanceof WI.NavigationItem)||!e._parentNavigationBar||(console.assert(e._parentNavigationBar===this,"Cannot remove item with unexpected parent bar.",e),e._parentNavigationBar!==this)?null:(e.didDetach(),this._selectedNavigationItem===e&&(this.selectedNavigationItem=null),this._navigationItems.remove(e),e.element.remove(),this._minimumWidth=NaN,this.needsLayout(),e)}get selectedNavigationItem(){return this._selectedNavigationItem}set selectedNavigationItem(e){let t=e&&e.parentNavigationBar!==this;console.assert(!t,"Cannot select item with unexpected parent bar.",e),!t&&(e instanceof WI.RadioButtonNavigationItem||(e=null),this._selectedNavigationItem!==e&&(this._selectedNavigationItem&&(this._selectedNavigationItem.selected=!1),this._selectedNavigationItem=e||null,this._selectedNavigationItem&&(this._selectedNavigationItem.selected=!0),this._mouseIsDown||this.dispatchEventToListeners(WI.NavigationBar.Event.NavigationItemSelected)))}get navigationItems(){return this._navigationItems}get minimumWidth(){return isNaN(this._minimumWidth)&&(this._minimumWidth=this._calculateMinimumWidth()),this._minimumWidth}get sizesToFit(){return!1}findNavigationItem(e){function t(i){if(i.identifier===e)return i;if(i instanceof WI.GroupNavigationItem)for(let n of i.navigationItems){let s=t(n);if(s)return s}return null}for(let i of this._navigationItems){let n=t(i);if(n)return n}return null}needsLayout(){this._forceLayout=!0,super.needsLayout()}sizeDidChange(){super.sizeDidChange(),this._updateContent()}layout(){super.layout(),this._forceLayout&&this._updateContent()}_updateContent(){this._forceLayout=!1,this.element.classList.remove(WI.NavigationBar.CollapsedStyleClassName);function e(p,f){p[WI.NavigationBar.ForceHiddenSymbol]=f,p.element.classList.toggle("force-hidden",f)}function t(p){return p instanceof WI.DividerNavigationItem}for(let p of this._navigationItems)e(p,!1),p.updateLayout(!0);if(this.sizesToFit)return;let i=this._visibleNavigationItems;function n(){return i.reduce((p,f)=>p+f.width,0)}let s=n();const a=this.element.realOffsetWidth;s>a&&this.element.classList.add(WI.NavigationBar.CollapsedStyleClassName);for(let p of i)p.updateLayout(!1);if(s=n(),s>a){for(i.sort((p,f)=>p.visibilityPriority-f.visibilityPriority);s>a&&i.length;){let p=i.shift();s-=p.width,e(p,!0)}i=this._visibleNavigationItems}let d=null;for(let p of i){if(t(p)&&(!d||t(d))){e(p);continue}d=p}t(d)&&e(d)}_mouseDown(e){if(e.button===0){this._focused||this.element.removeAttribute("tabindex");var t=e.target.closest("."+WI.RadioButtonNavigationItem.StyleClassName);!t||!t.navigationItem||(this._previousSelectedNavigationItem=this.selectedNavigationItem,this.selectedNavigationItem=t.navigationItem,this._mouseIsDown=!0,!(typeof this.selectedNavigationItem.dontPreventDefaultOnNavigationBarMouseDown=="function"&&this.selectedNavigationItem.dontPreventDefaultOnNavigationBarMouseDown()&&this._previousSelectedNavigationItem===this.selectedNavigationItem)&&(document.addEventListener("mousemove",this._mouseMovedEventListener,!1),document.addEventListener("mouseup",this._mouseUpEventListener,!1),e.preventDefault(),e.stopPropagation()))}}_mouseMoved(e){if(console.assert(e.button===0),console.assert(this._mouseIsDown),!!this._mouseIsDown){e.preventDefault(),e.stopPropagation();var t=e.target.closest("."+WI.RadioButtonNavigationItem.StyleClassName);if(!t||!t.navigationItem||!this.element.contains(t)){var i=document.elementFromPoint(e.pageX,this.element.totalOffsetTop+this.element.offsetHeight/2);if(!i||(t=i.closest("."+WI.RadioButtonNavigationItem.StyleClassName),!t||!t.navigationItem||!this.element.contains(t)))return}this.selectedNavigationItem&&(this.selectedNavigationItem.active=!1),this.selectedNavigationItem=t.navigationItem,this.selectedNavigationItem.active=!0}}_mouseUp(e){console.assert(e.button===0),console.assert(this._mouseIsDown),this._mouseIsDown&&(this.selectedNavigationItem&&(this.selectedNavigationItem.active=!1),this._mouseIsDown=!1,document.removeEventListener("mousemove",this._mouseMovedEventListener,!1),document.removeEventListener("mouseup",this._mouseUpEventListener,!1),this.element.tabIndex=0,this._previousSelectedNavigationItem!==this.selectedNavigationItem&&this.dispatchEventToListeners(WI.NavigationBar.Event.NavigationItemSelected),delete this._previousSelectedNavigationItem,e.preventDefault(),e.stopPropagation())}_keyDown(e){if(!!this._focused&&!(e.keyIdentifier!=="Left"&&e.keyIdentifier!=="Right")){e.preventDefault(),e.stopPropagation();var t=this._navigationItems.indexOf(this._selectedNavigationItem);if(e.keyIdentifier==="Left"){t===-1&&(t=this._navigationItems.length);do t=Math.max(0,t-1);while(t&&!(this._navigationItems[t]instanceof WI.RadioButtonNavigationItem))}else if(e.keyIdentifier==="Right")do t=Math.min(t+1,this._navigationItems.length-1);while(t<this._navigationItems.length-1&&!(this._navigationItems[t]instanceof WI.RadioButtonNavigationItem));this._navigationItems[t]instanceof WI.RadioButtonNavigationItem&&(this.selectedNavigationItem=this._navigationItems[t])}}_focus(e){this._focused=!0}_blur(e){this._focused=!1}_calculateMinimumWidth(){let e=this._visibleNavigationItems;if(!e.length)return 0;const t=this.element.classList.contains(WI.NavigationBar.CollapsedStyleClassName);t||this.element.classList.add(WI.NavigationBar.CollapsedStyleClassName);let i=e.reduce((n,s)=>n+s.minimumWidth,0);return t||this.element.classList.remove(WI.NavigationBar.CollapsedStyleClassName),i}get _visibleNavigationItems(){return this._navigationItems.filter(e=>!(e instanceof WI.FlexibleSpaceNavigationItem||e.hidden||e[WI.NavigationBar.ForceHiddenSymbol]))}};WI.NavigationBar.ForceHiddenSymbol=Symbol("force-hidden");WI.NavigationBar.CollapsedStyleClassName="collapsed";WI.NavigationBar.Event={NavigationItemSelected:"navigation-bar-navigation-item-selected"};WI.NetworkDOMNodeDetailView=class extends WI.NetworkDetailView{constructor(e,t){console.assert(e instanceof WI.DOMNode),super(e,t),this.element.classList.add("dom-node"),this._domEventsContentView=null}initialLayout(){this.createDetailNavigationItem("dom-events",WI.UIString("DOM Events")),super.initialLayout()}showContentViewForIdentifier(e){switch(super.showContentViewForIdentifier(e),e){case"dom-events":this._domEventsContentView||(this._domEventsContentView=new WI.DOMNodeEventsContentView(this.representedObject)),this._contentBrowser.showContentView(this._domEventsContentView,this._contentViewCookie);break}}};WI.NetworkResourceDetailView=class extends WI.NetworkDetailView{constructor(e,t){console.assert(e instanceof WI.Resource),super(e,t),this.element.classList.add("resource"),this._resourceContentView=null,this._headersContentView=null,this._cookiesContentView=null,this._sizesContentView=null,this._timingContentView=null,this._securityContentView=null}shown(){this._contentBrowser&&this._contentViewCookie&&"lineNumber"in this._contentViewCookie&&"columnNumber"in this._contentViewCookie&&(this._contentBrowser.navigationBar.selectedNavigationItem=this.detailNavigationItemForIdentifier("preview")),super.shown()}headersContentViewGoToRequestData(e){this._contentBrowser.navigationBar.selectedNavigationItem=this.detailNavigationItemForIdentifier("preview"),this._resourceContentView.showRequest()}sizesContentViewGoToHeaders(e){this._contentBrowser.navigationBar.selectedNavigationItem=this.detailNavigationItemForIdentifier("headers")}sizesContentViewGoToRequestBody(e){this._contentBrowser.navigationBar.selectedNavigationItem=this.detailNavigationItemForIdentifier("preview"),this._resourceContentView.showRequest()}sizesContentViewGoToResponseBody(e){this._contentBrowser.navigationBar.selectedNavigationItem=this.detailNavigationItemForIdentifier("preview"),this._resourceContentView.showResponse()}initialLayout(){this.createDetailNavigationItem("preview",WI.UIString("Preview")),this.createDetailNavigationItem("headers",WI.UIString("Headers")),this.createDetailNavigationItem("cookies",WI.UIString("Cookies")),this.createDetailNavigationItem("sizes",WI.UIString("Sizes")),this.createDetailNavigationItem("timing",WI.UIString("Timing")),this.createDetailNavigationItem("security",WI.UIString("Security")),super.initialLayout()}showContentViewForIdentifier(e){switch(super.showContentViewForIdentifier(e),this._contentViewCookie&&"lineNumber"in this._contentViewCookie&&"columnNumber"in this._contentViewCookie&&(e="preview"),e){case"preview":this._resourceContentView||(this._resourceContentView=this._contentBrowser.showContentViewForRepresentedObject(this.representedObject)),this._contentBrowser.showContentView(this._resourceContentView,this._contentViewCookie);break;case"headers":this._headersContentView||(this._headersContentView=new WI.ResourceHeadersContentView(this.representedObject,this)),this._contentBrowser.showContentView(this._headersContentView,this._contentViewCookie);break;case"cookies":this._cookiesContentView||(this._cookiesContentView=new WI.ResourceCookiesContentView(this.representedObject)),this._contentBrowser.showContentView(this._cookiesContentView,this._contentViewCookie);break;case"sizes":this._sizesContentView||(this._sizesContentView=new WI.ResourceSizesContentView(this.representedObject,this)),this._contentBrowser.showContentView(this._sizesContentView,this._contentViewCookie);break;case"timing":this._timingContentView||(this._timingContentView=new WI.ResourceTimingContentView(this.representedObject)),this._contentBrowser.showContentView(this._timingContentView,this._contentViewCookie);break;case"security":this._securityContentView||(this._securityContentView=new WI.ResourceSecurityContentView(this.representedObject)),this._contentBrowser.showContentView(this._securityContentView,this._contentViewCookie);break}this._contentViewCookie=null}};WI.NetworkTableContentView=class nc extends WI.ContentView{constructor(e,t){super(e),this._collections=[],this._activeCollection=null,this._mainCollection=this._addCollection(),this._setActiveCollection(this._mainCollection),this._entriesSortComparator=null,this._showingRepresentedObjectCookie=null,this._table=null,this._nameColumnWidthSetting=new WI.Setting("network-table-content-view-name-column-width",250),this._selectedObject=null,this._detailView=null,this._detailViewMap=new Map,this._domNodeEntries=new Map,this._waterfallTimelineRuler=null,this._waterfallPopover=null,this._typeFilterScopeBarItemAll=new WI.ScopeBarItem("network-type-filter-all",WI.UIString("All"),{exclusive:!0});let i=[this._typeFilterScopeBarItemAll],n=[["Document",a=>a===WI.Resource.Type.Document],["Stylesheet",a=>a===WI.Resource.Type.Stylesheet],["Image",a=>a===WI.Resource.Type.Image],["Font",a=>a===WI.Resource.Type.Font],["Script",a=>a===WI.Resource.Type.Script],["XHR",a=>a===WI.Resource.Type.XHR||a===WI.Resource.Type.Fetch],["Other",a=>a!==WI.Resource.Type.Document&&a!==WI.Resource.Type.Stylesheet&&a!==WI.Resource.Type.Image&&a!==WI.Resource.Type.Font&&a!==WI.Resource.Type.Script&&a!==WI.Resource.Type.XHR&&a!==WI.Resource.Type.Fetch]];for(let[a,d]of n){let p=WI.Resource.Type[a],f=new WI.ScopeBarItem("network-type-filter-"+a,WI.NetworkTableContentView.shortDisplayNameForResourceType(p));f.__checker=d,i.push(f)}this._typeFilterScopeBar=new WI.ScopeBar("network-type-filter-scope-bar",i,i[0]),this._typeFilterScopeBar.addEventListener(WI.ScopeBar.Event.SelectionChanged,this._typeFilterScopeBarSelectionChanged,this),WI.MediaInstrument.supported()?(this._groupMediaRequestsByDOMNodeNavigationItem=new WI.CheckboxNavigationItem("group-media-requests",WI.UIString("Group Media Requests"),WI.settings.groupMediaRequestsByDOMNode.value),this._groupMediaRequestsByDOMNodeNavigationItem.addEventListener(WI.CheckboxNavigationItem.Event.CheckedDidChange,this._handleGroupMediaRequestsByDOMNodeCheckedDidChange,this)):WI.settings.groupMediaRequestsByDOMNode.value=!1,this._urlFilterSearchText=null,this._urlFilterSearchRegex=null,this._urlFilterIsActive=!1,this._urlFilterNavigationItem=new WI.FilterBarNavigationItem,this._urlFilterNavigationItem.filterBar.addEventListener(WI.FilterBar.Event.FilterDidChange,this._urlFilterDidChange,this),this._urlFilterNavigationItem.filterBar.placeholder=WI.UIString("Filter Full URL"),this._activeTypeFilters=this._generateTypeFilter(),this._activeURLFilterResources=new Set,this._emptyFilterResultsMessageElement=null,this._clearOnLoadNavigationItem=new WI.CheckboxNavigationItem("preserve-log",WI.UIString("Preserve Log"),!WI.settings.clearNetworkOnNavigate.value),this._clearOnLoadNavigationItem.tooltip=WI.UIString("Do not clear network items on new page loads"),this._clearOnLoadNavigationItem.addEventListener(WI.CheckboxNavigationItem.Event.CheckedDidChange,()=>{WI.settings.clearNetworkOnNavigate.value=!WI.settings.clearNetworkOnNavigate.value}),WI.settings.clearNetworkOnNavigate.addEventListener(WI.Setting.Event.Changed,this._clearNetworkOnNavigateSettingChanged,this),this._harImportNavigationItem=new WI.ButtonNavigationItem("har-import",WI.UIString("Import"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' d='M 7.5 8.5 V 1'/%3e %3cpath fill='none' stroke='currentColor' d='M 10.5 5.5 l -3%2c 3 l -3 -3'/%3e %3cpolyline fill='none' stroke='currentColor' points='12.5 9 12.5 12.5 2.5 12.5 2.5 9'/%3e %3c/svg%3e",15,15),this._harImportNavigationItem.buttonStyle=WI.ButtonNavigationItem.Style.ImageAndText,this._harImportNavigationItem.tooltip=WI.UIString("HAR Import"),this._harImportNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,()=>{this._importHAR()}),this._harExportNavigationItem=new WI.ButtonNavigationItem("har-export",WI.UIString("Export"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' d='M 7.5 2 v 7.5'/%3e %3cpath fill='none' stroke='currentColor' d='M 4.5 5 l 3 -3 l 3 3'/%3e %3cpolyline fill='none' stroke='currentColor' points='12.5 9 12.5 12.5 2.5 12.5 2.5 9'/%3e %3c/svg%3e",15,15),this._harExportNavigationItem.buttonStyle=WI.ButtonNavigationItem.Style.ImageAndText,this._harExportNavigationItem.tooltip=WI.UIString("HAR Export (%s)").format(WI.saveKeyboardShortcut.displayName),this._harExportNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,()=>{this._exportHAR()}),this._collectionsPathNavigationItem=new WI.HierarchicalPathNavigationItem,this._collectionsPathNavigationItem.addEventListener(WI.HierarchicalPathNavigationItem.Event.PathComponentWasSelected,this._collectionsHierarchicalPathComponentWasSelected,this),this._pathComponentsMap=new Map,this._lastPathComponent=null;let s=this._addCollectionPathComponent(this._mainCollection,WI.UIString("Live Activity"),"network-overview-icon");if(this._collectionsPathNavigationItem.components=[s],this._checkboxesNavigationItemGroup=new WI.GroupNavigationItem([this._clearOnLoadNavigationItem,new WI.DividerNavigationItem]),this._checkboxesNavigationItemGroup.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._pathComponentsNavigationItemGroup=new WI.GroupNavigationItem([this._collectionsPathNavigationItem,new WI.DividerNavigationItem]),this._pathComponentsNavigationItemGroup.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._pathComponentsNavigationItemGroup.hidden=!0,this._buttonsNavigationItemGroup=new WI.GroupNavigationItem([this._harImportNavigationItem,this._harExportNavigationItem,new WI.DividerNavigationItem]),this._buttonsNavigationItemGroup.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,window.NetworkAgent&&NetworkAgent.setResourceCachingDisabled){let a=WI.UIString("Ignore the resource cache when loading resources"),d=WI.UIString("Use the resource cache when loading resources");this._disableResourceCacheNavigationItem=new WI.ActivateButtonNavigationItem("disable-resource-cache",a,d,"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' viewBox='0 0 16 16'%3e %3cpath fill='none' stroke='currentColor' d='M 10.4 6'/%3e %3cpath fill='none' stroke='currentColor' d='M 12.3 4 C 12.4 4 12.4 4 12.3 4'/%3e %3cpath fill='none' stroke='currentColor' d='M 10 4'/%3e %3cpath fill='none' stroke='currentColor' d='M 9 5'/%3e %3cpath fill='none' stroke='currentColor' d='M -7.5-2.4'/%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='round' d='M 10.4 2.8 C 9.7 2.6 8.9 2.5 8 2.5 c -2.5 0-4.5 0.9-4.5 2 c 0 0.9 1.3 1.7 3.2 1.9'/%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' d='M 12.5 11.2 V 3.8 V 11.2 z'/%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='square' stroke-linejoin='round' d='M 3.5 10 V 4.5 v 4.6'/%3e %3cpath fill='none' stroke='currentColor' stroke-linejoin='round' d='M 12.5 11 c 0 1.2-2 2.2-4.5 2.2 c -1.5 0-2.9-0.4-3.7-1'/%3e %3cpolyline fill='none' stroke='currentColor' stroke-linejoin='round' points='1.2 15 10.2 6 12.8 3.4 14.8 1.5'/%3e %3c/svg%3e",16,16),this._disableResourceCacheNavigationItem.activated=WI.settings.resourceCachingDisabled.value,this._disableResourceCacheNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._toggleDisableResourceCache,this),WI.settings.resourceCachingDisabled.addEventListener(WI.Setting.Event.Changed,this._resourceCachingDisabledSettingChanged,this)}this._clearNetworkItemsNavigationItem=new WI.ButtonNavigationItem("clear-network-items",WI.UIString("Clear Network Items (%s)").format(WI.clearKeyboardShortcut.displayName),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' d='M 3.5 12.5 l -1 -10 h -1 h 11.9 h -1 l -1 10 H 3.5 z'/%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' d='M 5.5 2 L 5.5 0.5 L 9.5 0.5 L 9.5 2'/%3e %3cline fill='none' stroke='currentColor' stroke-linecap='round' x1='5.5' y1='9.2' x2='9.4' y2='5.3'/%3e %3cline fill='none' stroke='currentColor' stroke-linecap='round' x1='5.5' y1='5.2' x2='9.4' y2='9.2'/%3e %3c/svg%3e",15,15),this._clearNetworkItemsNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,()=>{this.reset()}),WI.Target.addEventListener(WI.Target.Event.ResourceAdded,this._handleResourceAdded,this),WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this),WI.Frame.addEventListener(WI.Frame.Event.ResourceWasAdded,this._handleResourceAdded,this),WI.Frame.addEventListener(WI.Frame.Event.ChildFrameWasAdded,this._handleFrameWasAdded,this),WI.Resource.addEventListener(WI.Resource.Event.LoadingDidFinish,this._resourceLoadingDidFinish,this),WI.Resource.addEventListener(WI.Resource.Event.LoadingDidFail,this._resourceLoadingDidFail,this),WI.Resource.addEventListener(WI.Resource.Event.TransferSizeDidChange,this._resourceTransferSizeDidChange,this),WI.networkManager.addEventListener(WI.NetworkManager.Event.MainFrameDidChange,this._mainFrameDidChange,this),this._needsInitialPopulate=!0,this._transitioningPageTarget=!1,WI.notifications.addEventListener(WI.Notification.TransitionPageTarget,this._transitionPageTarget,this)}static displayNameForResource(e){if(e.type===WI.Resource.Type.Image||e.type===WI.Resource.Type.Font||e.type===WI.Resource.Type.Other){let t;if(e.mimeType&&(t=WI.fileExtensionForMIMEType(e.mimeType)),t||(t=WI.fileExtensionForURL(e.url)),t)return t}return WI.NetworkTableContentView.shortDisplayNameForResourceType(e.type).toLowerCase()}static shortDisplayNameForResourceType(e){switch(e){case WI.Resource.Type.Document:return WI.UIString("Document");case WI.Resource.Type.Stylesheet:return"CSS";case WI.Resource.Type.Image:return WI.UIString("Image");case WI.Resource.Type.Font:return WI.UIString("Font");case WI.Resource.Type.Script:return"JS";case WI.Resource.Type.XHR:return"XHR";case WI.Resource.Type.Fetch:return WI.repeatedUIString.fetch();case WI.Resource.Type.Ping:return WI.UIString("Ping");case WI.Resource.Type.Beacon:return WI.UIString("Beacon");case WI.Resource.Type.WebSocket:case WI.Resource.Type.Other:return WI.UIString("Other");default:return console.error("Unknown resource type",e),null}}static get nodeWaterfallDOMEventSize(){return 8}get selectionPathComponents(){return null}get navigationItems(){let e=[this._checkboxesNavigationItemGroup,this._pathComponentsNavigationItemGroup,this._buttonsNavigationItemGroup];return this._disableResourceCacheNavigationItem&&e.push(this._disableResourceCacheNavigationItem),e.push(this._clearNetworkItemsNavigationItem),e}get filterNavigationItems(){let e=[this._urlFilterNavigationItem,this._typeFilterScopeBar];return WI.MediaInstrument.supported()&&e.push(this._groupMediaRequestsByDOMNodeNavigationItem),e}get supportsSave(){return this._canExportHAR()}get saveData(){return{customSaveHandler:()=>{this._exportHAR()}}}shown(){super.shown(),this._detailView&&this._detailView.shown(),this._table&&this._table.restoreScrollPosition()}hidden(){this._hidePopover(),this._detailView&&this._detailView.hidden(),super.hidden()}closed(){for(let e of this._detailViewMap.values())e.dispose();this._detailViewMap.clear(),this._domNodeEntries.clear(),this._hidePopover(),this._hideDetailView(),WI.Target.removeEventListener(null,null,this),WI.Frame.removeEventListener(null,null,this),WI.Resource.removeEventListener(null,null,this),WI.settings.resourceCachingDisabled.removeEventListener(null,null,this),WI.settings.clearNetworkOnNavigate.removeEventListener(null,null,this),WI.networkManager.removeEventListener(WI.NetworkManager.Event.MainFrameDidChange,this._mainFrameDidChange,this),super.closed()}reset(){this._runForMainCollection(e=>{this._resetCollection(e)});for(let e of this._detailViewMap.values())e.dispose();this._detailViewMap.clear(),this._domNodeEntries.clear(),this._updateWaterfallTimelineRuler(),this._updateExportButton(),this._table&&(this._selectedObject=null,this._table.reloadData(),this._hidePopover(),this._hideDetailView())}showRepresentedObject(e,t){console.assert(e instanceof WI.Resource);let i=this._rowIndexForRepresentedObject(e);if(i===-1){this._selectedObject=null,this._table.deselectAll(),this._hideDetailView();return}this._showingRepresentedObjectCookie=t,this._table.selectRow(i),this._showingRepresentedObjectCookie=null}networkDetailViewClose(e){this._selectedObject=null,this._table.deselectAll(),this._hideDetailView()}tableIndexForRepresentedObject(e,t){return this._activeCollection.filteredEntries.indexOf(t)}tableRepresentedObjectForIndex(e,t){return console.assert(t>=0&&t<this._activeCollection.filteredEntries.length),this._activeCollection.filteredEntries[t]}tableNumberOfRows(e){return this._activeCollection.filteredEntries.length}tableSortChanged(e){if(this._generateSortComparator(),!!this._entriesSortComparator){this._hideDetailView();for(let t of this._domNodeEntries.values())t.initiatedResourceEntries.sort(this._entriesSortComparator);this._updateSort(),this._updateFilteredEntries(),this._reloadTable()}}tableCellContextMenuClicked(e,t,i,n,s){if(i!==this._nameColumn)return;this._table.selectRow(n);let a=this._activeCollection.filteredEntries[n],d=WI.ContextMenu.createFromEvent(s);WI.appendContextMenuItemsForSourceCode(d,a.resource),d.appendSeparator(),d.appendItem(WI.UIString("Export HAR"),()=>{this._exportHAR()},!this._canExportHAR())}tableShouldSelectRow(e,t,i,n){return i===this._nameColumn}tableSelectionDidChange(e){let t=e.selectedRow;if(isNaN(t)){this._selectedObject=null,this._hideDetailView();return}let i=this._activeCollection.filteredEntries[t];i.resource===this._selectedObject||i.domNode===this._selectedObject||(this._selectedObject=i.resource||i.domNode,this._selectedObject?this._showDetailView(this._selectedObject):this._hideDetailView())}tablePopulateCell(e,t,i,n){let s=this._activeCollection.filteredEntries[n];s.resource&&t.classList.toggle("error",s.resource.hadLoadingError());let a=d=>{let p=this._uniqueValuesForDOMNodeEntry(s,d);if(p){if(p.size>1){t.classList.add("multiple"),t.textContent=WI.UIString("(multiple)");return}t.textContent=p.values().next().value||emDash;return}t.textContent=d(s)||emDash};switch(i.identifier){case"name":this._populateNameCell(t,s);break;case"domain":this._populateDomainCell(t,s);break;case"type":a(d=>d.displayType);break;case"mimeType":a(d=>d.mimeType);break;case"method":a(d=>d.method);break;case"scheme":a(d=>d.scheme);break;case"status":a(d=>d.status);break;case"protocol":a(d=>d.protocol);break;case"initiator":this._populateInitiatorCell(t,s);break;case"priority":a(d=>WI.Resource.displayNameForPriority(d.priority));break;case"remoteAddress":a(d=>d.remoteAddress);break;case"connectionIdentifier":a(d=>d.connectionIdentifier);break;case"resourceSize":{let d=s.resourceSize,p=s.initiatedResourceEntries;p&&(d=p.reduce((f,_)=>f+(_.resourceSize||0),0)),t.textContent=isNaN(d)?emDash:Number.bytesToString(d);break}case"transferSize":this._populateTransferSizeCell(t,s);break;case"time":{let d=s.time,p=s.initiatedResourceEntries;p&&(d=p.reduce((f,_)=>f+(_.time||0),0)),t.textContent=isNaN(d)?emDash:Number.secondsToString(Math.max(d,0));break}case"waterfall":this._populateWaterfallGraph(t,s);break}return t}_addCollection(){let e={};return this._resetCollection(e),this._collections.push(e),e}_resetCollection(e){e.entries=[],e.filteredEntries=[],e.pendingInsertions=[],e.pendingUpdates=[],e.waterfallStartTime=NaN,e.waterfallEndTime=NaN}_setActiveCollection(e){console.assert(this._collections.includes(e)),this._activeCollection!==e&&(this._activeCollection=e)}_addCollectionPathComponent(e,t,i){let n=new WI.HierarchicalPathComponent(t,i,e);return this._pathComponentsMap.set(e,n),this._lastPathComponent&&(this._lastPathComponent.nextSibling=n,n.previousSibling=this._lastPathComponent),this._lastPathComponent=n,this._pathComponentsNavigationItemGroup&&this._pathComponentsMap.size>1&&(this._pathComponentsNavigationItemGroup.hidden=!1),n}_collectionsHierarchicalPathComponentWasSelected(e){console.assert(e.data.pathComponent instanceof WI.HierarchicalPathComponent);let t=e.data.pathComponent.representedObject;this._changeCollection(t)}_changeCollection(e){if(e===this._activeCollection)return;this._setActiveCollection(e);let t=e===this._mainCollection;this._checkboxesNavigationItemGroup.hidden=!t,this._groupMediaRequestsByDOMNodeNavigationItem.hidden=!t,this._clearNetworkItemsNavigationItem.enabled=t,this._collectionsPathNavigationItem.components=[this._pathComponentsMap.get(e)],this._updateSort(),this._updateActiveFilterResources(),this._updateFilteredEntries(),this._updateWaterfallTimelineRuler(),this._reloadTable(),this._hideDetailView(),this.needsLayout()}_populateNameCell(e,t){console.assert(!e.firstChild,"We expect the cell to be empty.",e,e.firstChild);function i(){let p=e.appendChild(document.createElement("img"));p.className="icon"}let n=t.domNode;if(n){this._table.element.classList.add("grouped"),e.classList.add("parent");let p=e.appendChild(document.createElement("img"));p.classList.add("disclosure"),p.classList.toggle("expanded",!!t.expanded),p.addEventListener("click",f=>{t.expanded=!t.expanded,this._updateFilteredEntries(),this._reloadTable()}),i(),e.classList.add("dom-node"),e.appendChild(WI.linkifyNodeReference(n));return}let s=t.resource;if(s.isLoading()){let p=e.appendChild(document.createElement("div"));p.className="status";let f=new WI.IndeterminateProgressSpinner;p.appendChild(f.element)}if(i(),e.classList.add(WI.ResourceTreeElement.ResourceIconStyleClassName),WI.settings.groupMediaRequestsByDOMNode.value&&s.initiatorNode){let p=this._domNodeEntries.get(s.initiatorNode);(p.initiatedResourceEntries.length>1||p.domNode.domEvents.length)&&e.classList.add("child")}let a=e.appendChild(document.createElement("span"));a.textContent=t.name;let d=s.requestedByteRange;if(d){let p=a.appendChild(document.createElement("span"));p.classList.add("range"),p.textContent=WI.UIString("Byte Range %s\u2013%s").format(d.start,d.end)}e.title=s.url,e.classList.add(WI.Resource.classNameForResource(s))}_populateDomainCell(e,t){console.assert(!e.firstChild,"We expect the cell to be empty.",e,e.firstChild);function i(a,d){if(a==="https"||a==="wss"){let f=e.appendChild(document.createElement("img"));f.className="lock"}e.append(d||emDash)}let n=this._uniqueValuesForDOMNodeEntry(t,a=>a.scheme),s=this._uniqueValuesForDOMNodeEntry(t,a=>a.domain);if(n&&s){if(n.size>1||s.size>1){e.classList.add("multiple"),e.textContent=WI.UIString("(multiple)");return}i(n.values().next().value,s.values().next().value);return}i(t.scheme,t.domain)}_populateInitiatorCell(e,t){if(t.domNode){e.textContent=emDash;return}let n=t.resource.initiatorSourceCodeLocation;if(!n){e.textContent=emDash;return}const s={dontFloat:!0,ignoreSearchTab:!0};e.appendChild(WI.createSourceCodeLocationLink(n,s))}_populateTransferSizeCell(e,t){let i=t.initiatedResourceEntries;if(i){if(i.every(d=>d.resource.responseSource===WI.Resource.ResponseSource.MemoryCache)){e.classList.add("cache-type"),e.textContent=WI.UIString("(memory)");return}if(i.every(d=>d.resource.responseSource===WI.Resource.ResponseSource.DiskCache)){e.classList.add("cache-type"),e.textContent=WI.UIString("(disk)");return}if(i.every(d=>d.resource.responseSource===WI.Resource.ResponseSource.ServiceWorker)){e.classList.add("cache-type"),e.textContent=WI.UIString("(service worker)");return}let a=i.reduce((d,p)=>d+(p.transferSize||0),0);isNaN(a)?e.textContent=emDash:e.textContent=Number.bytesToString(a);return}let n=t.resource.responseSource;if(n===WI.Resource.ResponseSource.MemoryCache){e.classList.add("cache-type"),e.textContent=WI.UIString("(memory)");return}if(n===WI.Resource.ResponseSource.DiskCache){e.classList.add("cache-type"),e.textContent=WI.UIString("(disk)");return}if(n===WI.Resource.ResponseSource.ServiceWorker){e.classList.add("cache-type"),e.textContent=WI.UIString("(service worker)");return}let s=t.transferSize;e.textContent=isNaN(s)?emDash:Number.bytesToString(s),console.assert(!e.classList.contains("cache-type"),"Should not have cache-type class on cell.")}_populateWaterfallGraph(e,t){e.removeChildren();let i=e.appendChild(document.createElement("div"));i.className="waterfall-container";let n=this._activeCollection,s=this._waterfallTimelineRuler.startTime,a=this._waterfallTimelineRuler.secondsPerPixel;function d(ve,Pe){let Be=WI.resolvedLayoutDirection()===WI.LayoutDirection.LTR?"left":"right";ve.style.setProperty(Be,(Pe-s)/a+"px")}function p(ve,Pe,Be){ve.style.setProperty("width",(Be-Pe)/a+"px")}let f=t.domNode;if(f){let qe=function(Ue,Ge,it){if(WI.DOMNode.isStopEvent(Ue.lastValue.eventName))return;for(let bt=Ue.length-1;bt>=0;--bt){let Yt=Ue[bt];if(WI.DOMNode.isPlayEvent(Yt.eventName)){Be=!0;break}if(WI.DOMNode.isPauseEvent(Yt.eventName)){Be=!1;break}}let lt=i.appendChild(document.createElement("div"));lt.classList.add("dom-activity"),lt.classList.toggle("playing",Be),d(lt,Ge),p(lt,Ge,it)};var te=qe;let ve=[];for(let Ue of f.domEvents)Ue.originator||((!ve.length||Ue.timestamp-ve.lastValue.endTimestamp>=nc.nodeWaterfallDOMEventSize*a)&&ve.push({startTimestamp:Ue.timestamp,domEvents:[]}),ve.lastValue.endTimestamp=Ue.timestamp,ve.lastValue.domEvents.push(Ue));let Pe=WI.DOMNode.getFullscreenDOMEvents(f.domEvents);if(Pe.length){Pe[0].data.enabled||Pe.unshift({timestamp:s}),Pe.lastValue.data.enabled&&Pe.push({timestamp:n.waterfallEndTime}),console.assert(Pe.length%2===0,"Every enter/exit of fullscreen should have a corresponding exit/enter.");for(let Ue=0;Ue<Pe.length;Ue+=2){let Ge=i.appendChild(document.createElement("div"));Ge.classList.add("area","dom-fullscreen"),d(Ge,Pe[Ue].timestamp),p(Ge,Pe[Ue].timestamp,Pe[Ue+1].timestamp);let it=Pe[Ue].originator||Pe[Ue+1].originator;it?Ge.title=WI.UIString("Full-Screen from \u201C%s\u201D").format(it.displayName):Ge.title=WI.UIString("Full-Screen")}}for(let Ue of f.powerEfficientPlaybackRanges){let Ge=Ue.startTimestamp||s,it=Ue.endTimestamp||n.waterfallEndTime,lt=i.appendChild(document.createElement("div"));lt.classList.add("area","power-efficient-playback"),lt.title=WI.UIString("Power Efficient Playback"),d(lt,Ge),p(lt,Ge,it)}let Be=!1;for(let[Ue,Ge]of ve.adjacencies())qe(Ue.domEvents,Ue.endTimestamp,Ge.startTimestamp);ve.length&&qe(ve.lastValue.domEvents,ve.lastValue.endTimestamp,n.waterfallEndTime);for(let{startTimestamp:Ue,endTimestamp:Ge,domEvents:it}of ve){let lt=nc.nodeWaterfallDOMEventSize*a/2,bt=i.appendChild(document.createElement("div"));bt.classList.add("dom-event"),d(bt,Ue-lt),p(bt,Ue,Ge+lt),bt.addEventListener("mousedown",Yt=>{Yt.button!==0||Yt.ctrlKey||this._handleNodeEntryMousedownWaterfall(t,it)});for(let Yt of it)t.domEventElements.set(Yt,bt)}return}let _=t.resource;if(!_.hasResponse()){e.textContent=zeroWidthSpace;return}let{startTime:b,redirectStart:w,redirectEnd:S,fetchStart:E,domainLookupStart:k,domainLookupEnd:R,connectStart:M,connectEnd:L,secureConnectionStart:V,requestStart:H,responseStart:O,responseEnd:z}=_.timingData;if(isNaN(b)||isNaN(z)||b>z){e.textContent=zeroWidthSpace;return}if(z<s){e.textContent=zeroWidthSpace;return}let K=this._waterfallTimelineRuler.endTime;if(b>K){e.textContent=zeroWidthSpace;return}let q=NaN;function Y(ve,Pe,Be){if(isNaN(ve)||isNaN(Pe))return null;Math.abs(ve-q)<a*2&&(ve=q),q=Pe;let qe=i.appendChild(document.createElement("div"));return qe.classList.add("block",Be),d(qe,ve),p(qe,ve,Pe),qe}let se=10*a;if(Y(b-se,z+se,"mouse-tracking").addEventListener("mousedown",ve=>{ve.button!==0||ve.ctrlKey||this._handleResourceEntryMousedownWaterfall(t)}),(z-b)/a<=3){let ve=a*2;Y(b,b+ve,"queue"),Y(b+ve,b+2*ve,"response");return}Y(b,z,"filler"),Y(w,S,"redirect"),k?(Y(E,k,"queue"),Y(k,R||M||H,"dns")):M?Y(E,M,"queue"):H&&Y(E,H,"queue"),M&&Y(M,V||L,"connect"),V&&Y(V,L,"secure"),Y(H,O,"request"),Y(O,z,"response")}_generateSortComparator(){let e=this._table.sortColumnIdentifier;if(!e){this._entriesSortComparator=null;return}let t;switch(e){case"name":case"domain":case"mimeType":case"method":case"scheme":case"protocol":case"initiator":case"remoteAddress":t=(s,a)=>(s[e]||"").extendedLocaleCompare(a[e]||"");break;case"status":case"connectionIdentifier":case"resourceSize":case"time":t=(s,a)=>{let d=s[e];if(isNaN(d))return 1;let p=a[e];return isNaN(p)?-1:d-p};break;case"priority":t=(s,a)=>WI.Resource.comparePriority(s.priority,a.priority);break;case"type":t=(s,a)=>(s.displayType||"").extendedLocaleCompare(a.displayType||"");break;case"transferSize":t=(s,a)=>{let d=s.transferSize,p=a.transferSize;if(isNaN(d))return 1;if(isNaN(p))return-1;let f=s.resource.responseSource;f===WI.Resource.ResponseSource.MemoryCache?d=-20:f===WI.Resource.ResponseSource.DiskCache?d=-10:f===WI.Resource.ResponseSource.ServiceWorker&&(d=-5);let _=a.resource.responseSource;return _===WI.Resource.ResponseSource.MemoryCache?p=-20:_===WI.Resource.ResponseSource.DiskCache?p=-10:_===WI.Resource.ResponseSource.ServiceWorker&&(p=-5),d-p};break;case"waterfall":t=(s,a)=>s.startTime-a.startTime;break;default:console.assert("Unexpected sort column",e);return}let i=this._table.sortOrder===WI.Table.SortOrder.Ascending?1:-1,n=(s,a)=>{if(WI.settings.groupMediaRequestsByDOMNode.value&&s.resource.initiatorNode){let d=this._domNodeEntries.get(s.resource.initiatorNode);if(!d.initiatedResourceEntries.includes(a))return d.initiatedResourceEntries[0]}return s};this._entriesSortComparator=(s,a)=>i*t(n(s,a),n(a,s))}initialLayout(){super.initialLayout(),this.element.style.setProperty("--node-waterfall-dom-event-size",nc.nodeWaterfallDOMEventSize+"px"),this._waterfallTimelineRuler=new WI.TimelineRuler,this._waterfallTimelineRuler.allowsClippedLabels=!0,this._nameColumn=new WI.TableColumn("name",WI.UIString("Name"),{minWidth:WI.Sidebar.AbsoluteMinimumWidth,maxWidth:500,initialWidth:this._nameColumnWidthSetting.value,resizeType:WI.TableColumn.ResizeType.Locked}),this._domainColumn=new WI.TableColumn("domain",WI.UIString("Domain"),{minWidth:120,maxWidth:200,initialWidth:150}),this._typeColumn=new WI.TableColumn("type",WI.UIString("Type"),{minWidth:70,maxWidth:120,initialWidth:90}),this._mimeTypeColumn=new WI.TableColumn("mimeType",WI.UIString("MIME Type"),{hidden:!0,minWidth:100,maxWidth:150,initialWidth:120}),this._methodColumn=new WI.TableColumn("method",WI.UIString("Method"),{hidden:!0,minWidth:55,maxWidth:80,initialWidth:65}),this._schemeColumn=new WI.TableColumn("scheme",WI.UIString("Scheme"),{hidden:!0,minWidth:55,maxWidth:80,initialWidth:65}),this._statusColumn=new WI.TableColumn("status",WI.UIString("Status"),{hidden:!0,minWidth:50,maxWidth:50,align:"left"}),this._protocolColumn=new WI.TableColumn("protocol",WI.UIString("Protocol"),{hidden:!0,minWidth:65,maxWidth:80,initialWidth:75}),this._initiatorColumn=new WI.TableColumn("initiator",WI.UIString("Initiator"),{hidden:!0,minWidth:75,maxWidth:175,initialWidth:125}),this._priorityColumn=new WI.TableColumn("priority",WI.UIString("Priority"),{hidden:!0,minWidth:65,maxWidth:80,initialWidth:70}),this._remoteAddressColumn=new WI.TableColumn("remoteAddress",WI.UIString("IP Address"),{hidden:!0,minWidth:150}),this._connectionIdentifierColumn=new WI.TableColumn("connectionIdentifier",WI.UIString("Connection ID"),{hidden:!0,minWidth:50,maxWidth:120,initialWidth:80,align:"right"}),this._resourceSizeColumn=new WI.TableColumn("resourceSize",WI.UIString("Resource Size"),{hidden:!0,minWidth:80,maxWidth:100,initialWidth:80,align:"right"}),this._transferSizeColumn=new WI.TableColumn("transferSize",WI.UIString("Transfer Size","Amount of data sent over the network for a single resource"),{minWidth:100,maxWidth:150,initialWidth:100,align:"right"}),this._timeColumn=new WI.TableColumn("time",WI.UIString("Time"),{minWidth:65,maxWidth:90,initialWidth:65,align:"right"}),this._waterfallColumn=new WI.TableColumn("waterfall",WI.UIString("Waterfall"),{minWidth:230,headerView:this._waterfallTimelineRuler,needsReloadOnResize:!0}),this._nameColumn.addEventListener(WI.TableColumn.Event.WidthDidChange,this._tableNameColumnDidChangeWidth,this),this._waterfallColumn.addEventListener(WI.TableColumn.Event.WidthDidChange,this._tableWaterfallColumnDidChangeWidth,this),this._table=new WI.Table("network-table",this,this,20),this._table.addColumn(this._nameColumn),this._table.addColumn(this._domainColumn),this._table.addColumn(this._typeColumn),this._table.addColumn(this._mimeTypeColumn),this._table.addColumn(this._methodColumn),this._table.addColumn(this._schemeColumn),this._table.addColumn(this._statusColumn),this._table.addColumn(this._protocolColumn),this._table.addColumn(this._initiatorColumn),this._table.addColumn(this._priorityColumn),this._table.addColumn(this._remoteAddressColumn),this._table.addColumn(this._connectionIdentifierColumn),this._table.addColumn(this._resourceSizeColumn),this._table.addColumn(this._transferSizeColumn),this._table.addColumn(this._timeColumn),this._table.addColumn(this._waterfallColumn),this._table.sortColumnIdentifier||(this._table.sortOrder=WI.Table.SortOrder.Ascending,this._table.sortColumnIdentifier="waterfall"),this.addSubview(this._table)}layout(){this._updateWaterfallTimelineRuler(),this._processPendingEntries(),this._positionDetailView(),this._positionEmptyFilterMessage(),this._updateExportButton()}didLayoutSubtree(){super.didLayoutSubtree(),this._waterfallPopover&&this._waterfallPopover.resize()}processHAR(e){let t=WI.networkManager.processHAR(e);if(!t)return;let i=this._addCollection(),n=WI.UIString("Imported - %s").format(e.filename);this._addCollectionPathComponent(i,n,"network-har-icon"),this._changeCollection(i);for(let s of t)this._insertResourceAndReloadTable(s)}handleClearShortcut(e){!this._isShowingMainCollection()||this.reset()}_updateWaterfallTimeRange(e,t){let i=this._activeCollection;(isNaN(i.waterfallStartTime)||e<i.waterfallStartTime)&&(i.waterfallStartTime=e),(isNaN(i.waterfallEndTime)||t>i.waterfallEndTime)&&(i.waterfallEndTime=t)}_updateWaterfallTimelineRuler(){if(!this._waterfallTimelineRuler)return;let e=this._activeCollection;if(isNaN(e.waterfallStartTime))this._waterfallTimelineRuler.zeroTime=0,this._waterfallTimelineRuler.startTime=0,this._waterfallTimelineRuler.endTime=.25;else{this._waterfallTimelineRuler.zeroTime=e.waterfallStartTime,this._waterfallTimelineRuler.startTime=e.waterfallStartTime,this._waterfallTimelineRuler.endTime=e.waterfallEndTime;let i=5*this._waterfallTimelineRuler.secondsPerPixel;this._waterfallTimelineRuler.zeroTime=e.waterfallStartTime-i,this._waterfallTimelineRuler.startTime=e.waterfallStartTime-i,this._waterfallTimelineRuler.endTime=e.waterfallEndTime+i}}_canExportHAR(){if(!this._isShowingMainCollection())return!1;let e=WI.networkManager.mainFrame;if(!e)return!1;let t=e.mainResource;return!(!t||!t.requestSentDate||!this._HARResources().length)}_updateExportButton(){this._harExportNavigationItem.enabled=this._canExportHAR()}_processPendingEntries(){let e=this._activeCollection;if(!(e.pendingUpdates.length>0)){let i=e.pendingInsertions.length;for(let n of e.pendingInsertions)this._insertResourceAndReloadTable(n);console.assert(e.pendingInsertions.length===i),e.pendingInsertions=[];return}for(let i of e.pendingInsertions){let n=this._entryForResource(i);this._tryLinkResourceToDOMNode(n),e.entries.push(n)}e.pendingInsertions=[];for(let i of e.pendingUpdates)i instanceof WI.Resource&&this._updateEntryForResource(i);e.pendingUpdates=[],this._updateSort(),this._updateFilteredEntries(),this._reloadTable()}_populateWithInitialResourcesIfNeeded(e){if(!this._needsInitialPopulate)return;this._needsInitialPopulate=!1;let t=n=>{n.provisionalMainResource?e.pendingInsertions.push(n.provisionalMainResource):n.mainResource&&e.pendingInsertions.push(n.mainResource);for(let s of n.resourceCollection)e.pendingInsertions.push(s);for(let s of n.childFrameCollection)t(s)},i=n=>{n.mainResource instanceof WI.Resource&&e.pendingInsertions.push(n.mainResource);for(let s of n.resourceCollection)e.pendingInsertions.push(s)};for(let n of WI.targets)n===WI.pageTarget?t(WI.networkManager.mainFrame):i(n);this.needsLayout()}_checkURLFilterAgainstResource(e){if(this._urlFilterSearchRegex.test(e.url)){this._activeURLFilterResources.add(e);return}for(let t of e.redirects)if(this._urlFilterSearchRegex.test(t.url)){this._activeURLFilterResources.add(e);return}}_rowIndexForRepresentedObject(e){return this._activeCollection.filteredEntries.findIndex(t=>t.resource===e||t.domNode===e)}_updateEntryForResource(e){let t=this._activeCollection,i=t.entries.findIndex(d=>d.resource===e);if(i===-1)return;function n(d,p){for(let f in p)d[f]=p[f]}let s=this._entryForResource(e);n(t.entries[i],s);let a=this._rowIndexForRepresentedObject(e);a!==-1&&n(t.filteredEntries[a],s)}_hidePopover(){this._waterfallPopover&&this._waterfallPopover.dismiss()}_hideDetailView(){!this._detailView||(this.element.classList.remove("showing-detail"),this._table.scrollContainer.style.removeProperty("width"),this.removeSubview(this._detailView),this._detailView.hidden(),this._detailView=null,this._table.updateLayout(WI.View.LayoutReason.Resize),this._table.reloadVisibleColumnCells(this._waterfallColumn))}_showDetailView(e){let t=this._detailView;this._detailView=this._detailViewMap.get(e),this._detailView!==t&&(this._detailView||(e instanceof WI.Resource?this._detailView=new WI.NetworkResourceDetailView(e,this):e instanceof WI.DOMNode&&(this._detailView=new WI.NetworkDOMNodeDetailView(e,this)),this._detailViewMap.set(e,this._detailView)),t?(t.hidden(),this.replaceSubview(t,this._detailView)):this.addSubview(this._detailView),this._showingRepresentedObjectCookie&&this._detailView.willShowWithCookie(this._showingRepresentedObjectCookie),this._detailView.shown(),this.element.classList.add("showing-detail"),this._table.scrollContainer.style.width=this._nameColumn.width+"px",this.updateLayout())}_positionDetailView(){if(!this._detailView)return;let e=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?"right":"left";this._detailView.element.style[e]=this._nameColumn.width+"px",this._table.scrollContainer.style.width=this._nameColumn.width+"px"}_updateURLFilterActiveIndicator(){this._urlFilterNavigationItem.filterBar.indicatingActive=this._hasURLFilter()}_updateEmptyFilterResultsMessage(){this._hasActiveFilter()&&!this._activeCollection.filteredEntries.length?this._showEmptyFilterResultsMessage():this._hideEmptyFilterResultsMessage()}_showEmptyFilterResultsMessage(){if(!this._emptyFilterResultsMessageElement){let e=document.createElement("button");e.textContent=WI.UIString("Clear Filters"),e.addEventListener("click",()=>{this._resetFilters()}),this._emptyFilterResultsMessageElement=WI.createMessageTextView(WI.UIString("No Filter Results")),this._emptyFilterResultsMessageElement.appendChild(e)}this.element.appendChild(this._emptyFilterResultsMessageElement),this._positionEmptyFilterMessage()}_hideEmptyFilterResultsMessage(){!this._emptyFilterResultsMessageElement||this._emptyFilterResultsMessageElement.remove()}_positionEmptyFilterMessage(){if(!this._emptyFilterResultsMessageElement)return;let e=this._nameColumn.width-1;this._emptyFilterResultsMessageElement.style.width=e+"px"}_clearNetworkOnNavigateSettingChanged(){this._clearOnLoadNavigationItem.checked=!WI.settings.clearNetworkOnNavigate.value}_resourceCachingDisabledSettingChanged(){this._disableResourceCacheNavigationItem.activated=WI.settings.resourceCachingDisabled.value}_toggleDisableResourceCache(){WI.settings.resourceCachingDisabled.value=!WI.settings.resourceCachingDisabled.value}_mainResourceDidChange(e){this._runForMainCollection((t,i)=>{let n=e.target;if(n.isMainFrame()&&WI.settings.clearNetworkOnNavigate.value&&(this._resetCollection(t),i&&!this._needsInitialPopulate&&this._hideDetailView()),this._transitioningPageTarget){this._transitioningPageTarget=!1,this._needsInitialPopulate=!0,this._populateWithInitialResourcesIfNeeded(t);return}this._insertResourceAndReloadTable(n.mainResource)})}_mainFrameDidChange(){this._runForMainCollection(e=>{this._populateWithInitialResourcesIfNeeded(e)})}_resourceLoadingDidFinish(e){this._runForMainCollection((t,i)=>{let n=e.target;t.pendingUpdates.push(n),this._updateWaterfallTimeRange(n.firstTimestamp,n.timingData.responseEnd),this._hasURLFilter()&&this._checkURLFilterAgainstResource(n),i&&this.needsLayout()})}_resourceLoadingDidFail(e){this._runForMainCollection((t,i)=>{let n=e.target;t.pendingUpdates.push(n),this._updateWaterfallTimeRange(n.firstTimestamp,n.timingData.responseEnd),this._hasURLFilter()&&this._checkURLFilterAgainstResource(n),i&&this.needsLayout()})}_resourceTransferSizeDidChange(e){!this._table||this._runForMainCollection((t,i)=>{let n=e.target;if(this._table.sortColumnIdentifier==="transferSize"){t.pendingUpdates.push(n),this.needsLayout();return}let s=t.entries.findIndex(p=>p.resource===n);if(s===-1)return;let a=t.entries[s];if(a.transferSize=isNaN(n.networkTotalTransferSize)?n.estimatedTotalTransferSize:n.networkTotalTransferSize,!i)return;let d=this._rowIndexForRepresentedObject(n);d!==-1&&this._table.reloadCell(d,"transferSize")})}_handleResourceAdded(e){this._runForMainCollection(t=>{this._insertResourceAndReloadTable(e.data.resource)})}_handleFrameWasAdded(e){this._needsInitialPopulate||this._runForMainCollection(t=>{let i=e.data.childFrame,n=i.provisionalMainResource||i.mainResource;console.assert(n,"Frame should have a main resource."),this._insertResourceAndReloadTable(n),console.assert(!i.resourceCollection.size,"New frame should be empty."),console.assert(!i.childFrameCollection.size,"New frame should be empty.")})}_runForMainCollection(e){let t=this._activeCollection,i=t===this._mainCollection;i||this._setActiveCollection(this._mainCollection),e(this._activeCollection,i),i||this._setActiveCollection(t)}_isShowingMainCollection(){return this._activeCollection===this._mainCollection}_isDefaultSort(){return this._table.sortColumnIdentifier==="waterfall"&&this._table.sortOrder===WI.Table.SortOrder.Ascending}_insertResourceAndReloadTable(e){if(this._needsInitialPopulate)return;let t=this._activeCollection;if(this._updateWaterfallTimeRange(e.firstTimestamp,e.timingData.responseEnd),!this._table||!(WI.tabBrowser.selectedTabContentView instanceof WI.NetworkTabContentView)){t.pendingInsertions.push(e),this.needsLayout();return}let i=this._entryForResource(e);if(this._tryLinkResourceToDOMNode(i),WI.settings.groupMediaRequestsByDOMNode.value&&e.initiatorNode)this._entriesSortComparator||this._generateSortComparator();else if(this._isDefaultSort()||!this._entriesSortComparator){t.entries.push(i),this._passFilter(i)&&(t.filteredEntries.push(i),this._table.reloadDataAddedToEndOnly());return}insertObjectIntoSortedArray(i,t.entries,this._entriesSortComparator),this._passFilter(i)&&(WI.settings.groupMediaRequestsByDOMNode.value?this._updateFilteredEntries():insertObjectIntoSortedArray(i,t.filteredEntries,this._entriesSortComparator),t.filteredEntries.lastValue===i?this._table.reloadDataAddedToEndOnly():this._reloadTable())}_entryForResource(e){return{resource:e,name:WI.displayNameForURL(e.url,e.urlComponents),domain:WI.displayNameForHost(e.urlComponents.host),scheme:e.urlComponents.scheme?e.urlComponents.scheme.toLowerCase():"",method:e.requestMethod,type:e.type,displayType:WI.NetworkTableContentView.displayNameForResource(e),mimeType:e.mimeType,status:e.statusCode,cached:e.cached,resourceSize:e.size,transferSize:isNaN(e.networkTotalTransferSize)?e.estimatedTotalTransferSize:e.networkTotalTransferSize,time:e.totalDuration,protocol:e.protocol,initiator:e.initiatorSourceCodeLocation?e.initiatorSourceCodeLocation.displayLocationString():"",priority:e.priority,remoteAddress:e.remoteAddress,connectionIdentifier:e.connectionIdentifier,startTime:e.firstTimestamp}}_entryForDOMNode(e){return{domNode:e,initiatedResourceEntries:[],domEventElements:new Map,expanded:!0}}_tryLinkResourceToDOMNode(e){let t=e.resource;if(!t||!t.initiatorNode)return;let i=this._domNodeEntries.get(t.initiatorNode);i||(i=this._entryForDOMNode(t.initiatorNode,Object.keys(e)),this._domNodeEntries.set(t.initiatorNode,i),t.initiatorNode.addEventListener(WI.DOMNode.Event.DidFireEvent,this._handleNodeDidFireEvent,this),t.initiatorNode.canEnterPowerEfficientPlaybackState()&&t.initiatorNode.addEventListener(WI.DOMNode.Event.PowerEfficientPlaybackStateChanged,this._handleDOMNodePowerEfficientPlaybackStateChanged,this)),this._entriesSortComparator||this._generateSortComparator(),insertObjectIntoSortedArray(e,i.initiatedResourceEntries,this._entriesSortComparator)}_uniqueValuesForDOMNodeEntry(e,t){let i=e.initiatedResourceEntries;return i?i.reduce((n,s)=>{let a=t(s);return(a||typeof a=="number")&&n.add(a),n},new Set):null}_handleNodeDidFireEvent(e){this._runForMainCollection((t,i)=>{let n=e.target,{domEvent:s}=e.data;t.pendingUpdates.push(n),this._updateWaterfallTimeRange(NaN,s.timestamp+this._waterfallTimelineRuler.secondsPerPixel*10),i&&this.needsLayout()})}_handleDOMNodePowerEfficientPlaybackStateChanged(e){this._runForMainCollection((t,i)=>{let n=e.target,{timestamp:s}=e.data;t.pendingUpdates.push(n),this._updateWaterfallTimeRange(NaN,s+this._waterfallTimelineRuler.secondsPerPixel*10),i&&this.needsLayout()})}_hasTypeFilter(){return!!this._activeTypeFilters}_hasURLFilter(){return this._urlFilterIsActive}_hasActiveFilter(){return this._hasTypeFilter()||this._hasURLFilter()}_passTypeFilter(e){return this._hasTypeFilter()?this._activeTypeFilters.some(t=>t(e.resource.type)):!0}_passURLFilter(e){return this._hasURLFilter()?this._activeURLFilterResources.has(e.resource):!0}_passFilter(e){return this._passTypeFilter(e)&&this._passURLFilter(e)}_updateSort(){if(this._entriesSortComparator){let e=this._activeCollection;e.entries=e.entries.sort(this._entriesSortComparator)}}_updateFilteredEntries(){let e=this._activeCollection;if(this._hasActiveFilter()?e.filteredEntries=e.entries.filter(this._passFilter,this):e.filteredEntries=e.entries.slice(),WI.settings.groupMediaRequestsByDOMNode.value){for(let t of this._domNodeEntries.values()){if(t.initiatedResourceEntries.length<2&&!t.domNode.domEvents.length)continue;let i=1/0;for(let n of t.initiatedResourceEntries){if(this._hasActiveFilter()&&!this._passFilter(n))continue;let s=e.filteredEntries.indexOf(n);s>=0&&s<i&&(i=s)}!isFinite(i)||e.filteredEntries.insertAtIndex(t,i)}e.filteredEntries=e.filteredEntries.filter(t=>!(t.resource&&t.resource.initiatorNode&&!this._domNodeEntries.get(t.resource.initiatorNode).expanded))}this._updateURLFilterActiveIndicator(),this._updateEmptyFilterResultsMessage()}_reloadTable(){this._table.reloadData(),this._restoreSelectedRow()}_generateTypeFilter(){let e=this._typeFilterScopeBar.selectedItems;return!e.length||e.includes(this._typeFilterScopeBarItemAll)?null:e.map(t=>t.__checker)}_resetFilters(){console.assert(this._hasActiveFilter()),this._urlFilterSearchText=null,this._urlFilterSearchRegex=null,this._urlFilterIsActive=!1,this._activeURLFilterResources.clear(),this._urlFilterNavigationItem.filterBar.clear(),console.assert(!this._hasURLFilter()),this._typeFilterScopeBar.resetToDefault(),console.assert(!this._hasTypeFilter()),console.assert(!this._hasActiveFilter()),this._updateFilteredEntries(),this._reloadTable()}_areFilterListsIdentical(e,t){if(e&&t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}return!1}_typeFilterScopeBarSelectionChanged(e){let t=this._activeTypeFilters,i=this._generateTypeFilter();this._areFilterListsIdentical(t,i)||(this._hideDetailView(),this._activeTypeFilters=i,this._updateFilteredEntries(),this._reloadTable())}_handleGroupMediaRequestsByDOMNodeCheckedDidChange(e){WI.settings.groupMediaRequestsByDOMNode.value=this._groupMediaRequestsByDOMNodeNavigationItem.checked,WI.settings.groupMediaRequestsByDOMNode.value||(this._table.element.classList.remove("grouped"),this._selectedObject&&this._selectedObject instanceof WI.DOMNode&&(this._selectedObject=null,this._hideDetailView())),this._updateSort(),this._updateFilteredEntries(),this._reloadTable()}_urlFilterDidChange(e){let t=this._urlFilterNavigationItem.filterBar.filters.text;if(t!==this._urlFilterSearchText){if(this._hideDetailView(),!t){this._urlFilterSearchText=null,this._urlFilterSearchRegex=null,this._urlFilterIsActive=!1,this._activeURLFilterResources.clear(),this._updateFilteredEntries(),this._reloadTable();return}this._urlFilterIsActive=!0,this._urlFilterSearchText=t,this._urlFilterSearchRegex=WI.SearchUtilities.regExpForString(t,WI.SearchUtilities.defaultSettings),this._updateActiveFilterResources(),this._updateFilteredEntries(),this._reloadTable()}}_updateActiveFilterResources(){if(this._activeURLFilterResources.clear(),this._hasURLFilter())for(let e of this._activeCollection.entries)this._checkURLFilterAgainstResource(e.resource)}_restoreSelectedRow(){if(!this._selectedObject)return;let e=this._rowIndexForRepresentedObject(this._selectedObject);if(e===-1){this._selectedObject=null,this._table.deselectAll();return}this._table.selectRow(e),this._showDetailView(this._selectedObject)}_HARResources(){let e=this._activeCollection.filteredEntries.map(i=>i.resource);const t=new Set(["http","https","ws","wss"]);return e.filter(i=>!(!i||!i.finished||!i.requestSentDate||!t.has(i.urlComponents.scheme)))}_exportHAR(){let e=this._HARResources();if(!e.length){InspectorFrontendHost.beep();return}WI.HARBuilder.buildArchive(e).then(t=>{let i=WI.networkManager.mainFrame,n=i.mainResource.urlComponents.host||i.mainResource.displayName||"Archive";WI.FileUtilities.save({url:WI.FileUtilities.inspectorURLForFilename(n+".har"),content:JSON.stringify(t,null,2),forceSaveAs:!0})})}_importHAR(){WI.FileUtilities.importJSON(e=>this.processHAR(e))}_waterfallPopoverContent(){let e=document.createElement("div");return e.classList.add("waterfall-popover-content"),e}_waterfallPopoverContentForResourceEntry(e){let t=this._waterfallPopoverContent(),i=e.resource;if(!i.hasResponse()||!i.firstTimestamp||!i.lastTimestamp)return t.textContent=WI.UIString("Resource has no timing data"),t;let n=new WI.ResourceTimingBreakdownView(i,300);return t.appendChild(n.element),n.updateLayout(),t}_waterfallPopoverContentForNodeEntry(e,t){let i=this._waterfallPopoverContent(),n=new WI.DOMEventsBreakdownView(t);return i.appendChild(n.element),n.updateLayout(),i}_handleResourceEntryMousedownWaterfall(e){let t=this._waterfallPopoverContentForResourceEntry(e);this._handleMousedownWaterfall(e,t,i=>i.querySelector(".block.mouse-tracking"))}_handleNodeEntryMousedownWaterfall(e,t){let i=this._waterfallPopoverContentForNodeEntry(e,t);this._handleMousedownWaterfall(e,i,n=>{let s=e.domEventElements.get(t[0]);if(s&&this._waterfallPopover.visible){let a=Array.from(e.domEventElements).filter(([d,p])=>p===s).map(([d,p])=>d);this._waterfallPopover.content=this._waterfallPopoverContentForNodeEntry(e,a)}return s})}_handleMousedownWaterfall(e,t,i){if(this._waterfallPopover||(this._waterfallPopover=new WI.Popover,this._waterfallPopover.element.classList.add("waterfall-popover")),this._waterfallPopover.visible)return;let n=()=>{let p=this._rowIndexForRepresentedObject(e.resource||e.domNode),f=this._table.cellForRowAndColumn(p,this._waterfallColumn);if(f){let _=i(f);if(_)return WI.Rect.rectFromClientRect(_.getBoundingClientRect())}return this._waterfallPopover.dismiss(),null},s=n();if(!s||!s.size.width&&!s.size.height)return;let d=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?[WI.RectEdge.MAX_Y,WI.RectEdge.MIN_Y,WI.RectEdge.MAX_X]:[WI.RectEdge.MAX_Y,WI.RectEdge.MIN_Y,WI.RectEdge.MIN_X];this._waterfallPopover.windowResizeHandler=()=>{let p=n();p&&this._waterfallPopover.present(p,d)},this._waterfallPopover.presentNewContentWithFrame(t,s,d)}_tableNameColumnDidChangeWidth(e){this._nameColumnWidthSetting.value=e.target.width,this._positionDetailView(),this._positionEmptyFilterMessage()}_tableWaterfallColumnDidChangeWidth(e){this._table.reloadVisibleColumnCells(this._waterfallColumn)}_transitionPageTarget(e){this._transitioningPageTarget=!0}};WI.NetworkTimelineOverviewGraph=class extends WI.TimelineOverviewGraph{constructor(e,t){super(t),this.element.classList.add("network"),e.addEventListener(WI.Timeline.Event.RecordAdded,this._networkTimelineRecordAdded,this),e.addEventListener(WI.Timeline.Event.TimesUpdated,this.needsLayout,this),this.reset();for(let i of e.records)this._processRecord(i)}reset(){super.reset(),this._nextDumpRow=0,this._timelineRecordGridRows=[];for(let e=0;e<WI.NetworkTimelineOverviewGraph.MaximumRowCount;++e)this._timelineRecordGridRows.push([]);this.element.removeChildren();for(let e of this._timelineRecordGridRows)e.__element=document.createElement("div"),e.__element.classList.add("graph-row"),this.element.appendChild(e.__element),e.__recordBars=[]}layout(){if(!this.visible)return;let e=this.timelineOverview.secondsPerPixel,t=0;function i(n,s,a,d){let p=s[t];p?(p.renderMode=d,p.records=a):p=s[t]=new WI.TimelineRecordBar(this,a,d),p.refresh(this),p.element.parentNode||n.appendChild(p.element),++t}for(let n of this._timelineRecordGridRows){let s=n.__element,a=n.__recordBars;for(t=0,WI.TimelineRecordBar.createCombinedBars(n,e,this,i.bind(this,s,a));t<a.length;++t)a[t].records=null,a[t].element.remove()}}_networkTimelineRecordAdded(e){let t=e.data.record;console.assert(t instanceof WI.ResourceTimelineRecord),this._processRecord(t),this.needsLayout()}_processRecord(e){let t=(s,a)=>s.startTime-a.startTime,i=WI.TimelineOverview.MinimumDurationPerPixel*(WI.TimelineRecordBar.MinimumWidthPixels+WI.TimelineRecordBar.MinimumMarginPixels),n=!1;for(let s=0;s<this._timelineRecordGridRows.length;++s){let a=this._timelineRecordGridRows[s],d=a.lastValue;if(!d||d.endTime+i<=e.startTime){insertObjectIntoSortedArray(e,a,t),this._nextDumpRow=s+1,n=!0;break}}if(!n)for(let s=0;s<this._timelineRecordGridRows.length;++s){let a=this._timelineRecordGridRows[s],d=a.lastValue;if(console.assert(d),d.activeStartTime+i<=e.startTime){insertObjectIntoSortedArray(e,a,t),this._nextDumpRow=s+1,n=!0;break}}n||(this._nextDumpRow>=WI.NetworkTimelineOverviewGraph.MaximumRowCount&&(this._nextDumpRow=0),insertObjectIntoSortedArray(e,this._timelineRecordGridRows[this._nextDumpRow++],t))}};WI.NetworkTimelineOverviewGraph.MaximumRowCount=6;WI.NetworkTimelineView=class extends WI.TimelineView{constructor(e,t){super(e,t),console.assert(e.type===WI.TimelineRecord.Type.Network);let i={name:{},domain:{},type:{},method:{},scheme:{},statusCode:{},cached:{},protocol:{},priority:{},remoteAddress:{},connectionIdentifier:{},size:{},transferSize:{},requestSent:{},latency:{},duration:{},initiator:{},graph:{}};i.name.title=WI.UIString("Name"),i.name.icon=!0,i.name.width="10%",i.name.locked=!0,i.domain.title=WI.UIString("Domain"),i.domain.width="8%",i.type.title=WI.UIString("Type"),i.type.width="7%";let n=new Map;for(let s in WI.Resource.Type){let a=WI.Resource.Type[s];n.set(a,WI.Resource.displayNameForType(a,!0))}i.type.scopeBar=WI.TimelineDataGrid.createColumnScopeBar("network",n),this._scopeBar=i.type.scopeBar,i.method.title=WI.UIString("Method"),i.method.width="4%",i.scheme.title=WI.UIString("Scheme"),i.scheme.width="4%",i.statusCode.title=WI.UIString("Status"),i.statusCode.width="4%",i.cached.title=WI.UIString("Cached"),i.cached.width="6%",i.protocol.title=WI.UIString("Protocol"),i.protocol.width="5%",i.protocol.hidden=!0,i.priority.title=WI.UIString("Priority"),i.priority.width="5%",i.priority.hidden=!0,i.remoteAddress.title=WI.UIString("IP Address"),i.remoteAddress.width="8%",i.remoteAddress.hidden=!0,i.connectionIdentifier.title=WI.UIString("Connection ID"),i.connectionIdentifier.width="5%",i.connectionIdentifier.hidden=!0,i.connectionIdentifier.aligned="right",i.size.title=WI.UIString("Size"),i.size.width="6%",i.size.aligned="right",i.transferSize.title=WI.UIString("Transferred"),i.transferSize.width="8%",i.transferSize.aligned="right",i.requestSent.title=WI.UIString("Start Time"),i.requestSent.width="9%",i.requestSent.aligned="right",i.latency.title=WI.UIString("Latency"),i.latency.width="9%",i.latency.aligned="right",i.duration.title=WI.UIString("Duration"),i.duration.width="9%",i.duration.aligned="right";for(let s in i)i[s].sortable=!0;this._timelineRuler=new WI.TimelineRuler,this._timelineRuler.allowsClippedLabels=!0,i.graph.title=WI.UIString("Timeline"),i.graph.width="15%",i.graph.headerView=this._timelineRuler,i.graph.sortable=!1,InspectorBackend.domains.Network.hasEventParameter("loadingFinished","metrics")||(delete i.protocol,delete i.priority,delete i.remoteAddress,delete i.connectionIdentifier),this._dataGrid=new WI.TimelineDataGrid(i),this._dataGrid.sortDelegate=this,this._dataGrid.sortColumnIdentifier="requestSent",this._dataGrid.sortOrder=WI.DataGrid.SortOrder.Ascending,this._dataGrid.createSettings("network-timeline-view"),this.setupDataGrid(this._dataGrid),this.element.classList.add("network"),this.addSubview(this._dataGrid),e.addEventListener(WI.Timeline.Event.RecordAdded,this._networkTimelineRecordAdded,this),this._pendingRecords=[],this._resourceDataGridNodeMap=new Map;for(let s of e.records)this._processRecord(s)}get secondsPerPixel(){return this._timelineRuler.secondsPerPixel}get selectionPathComponents(){if(!this._dataGrid.selectedNode||this._dataGrid.selectedNode.hidden)return null;console.assert(this._dataGrid.selectedNode instanceof WI.ResourceTimelineDataGridNode);let e=new WI.TimelineDataGridNodePathComponent(this._dataGrid.selectedNode,this._dataGrid.selectedNode.resource);return e.addEventListener(WI.HierarchicalPathComponent.Event.SiblingWasSelected,this.dataGridNodePathComponentSelected,this),[e]}shown(){super.shown(),this._dataGrid.shown()}hidden(){this._dataGrid.hidden(),super.hidden()}closed(){console.assert(this.representedObject instanceof WI.Timeline),this.representedObject.removeEventListener(null,null,this),this._dataGrid.closed()}reset(){super.reset(),this._dataGrid.reset(),this._pendingRecords=[],this._resourceDataGridNodeMap.clear()}dataGridSortComparator(e,t,i,n){if(e==="priority")return WI.Resource.comparePriority(i.data.priority,n.data.priority)*t;if(e==="name"){let s=i.displayName(),a=n.displayName();return s!==a?s.extendedLocaleCompare(a)*t:i.resource.url.extendedLocaleCompare(n.resource.url)*t}return null}dataGridNodePathComponentSelected(e){let t=e.data.pathComponent;console.assert(t instanceof WI.TimelineDataGridNodePathComponent);let i=t.timelineDataGridNode;console.assert(i.dataGrid===this._dataGrid),i.revealAndSelect()}layout(){this.endTime=Math.min(this.endTime,this.currentTime);let e=this._timelineRuler.zeroTime,t=this._timelineRuler.startTime,i=this._timelineRuler.endTime;if(this._timelineRuler.zeroTime=this.zeroTime,this._timelineRuler.startTime=this.startTime,this._timelineRuler.endTime=this.endTime,this.zeroTime!==e||this.startTime!==t||this.endTime!==i)for(let n of this._resourceDataGridNodeMap.values())n.refreshGraph();this._processPendingRecords()}_processPendingRecords(){if(!!this._pendingRecords.length){for(let e of this._pendingRecords){let t=this._resourceDataGridNodeMap.get(e.resource);t||(t=new WI.ResourceTimelineDataGridNode(e,{graphDataSource:this,shouldShowPopover:!0}),this._resourceDataGridNodeMap.set(e.resource,t),this._dataGrid.addRowInSortOrder(t))}this._pendingRecords=[]}}_networkTimelineRecordAdded(e){let t=e.data.record;console.assert(t instanceof WI.ResourceTimelineRecord),this._processRecord(t),this.needsLayout()}_processRecord(e){this._pendingRecords.push(e)}};WI.ObjectPreviewView=class extends WI.Object{constructor(e,t,i){if(console.assert(!e||e instanceof WI.RemoteObject),console.assert(t instanceof WI.ObjectPreview),super(),this._object=e||null,this._preview=t,this._mode=i||WI.ObjectPreviewView.Mode.Full,this._element=document.createElement("span"),this._element.className="object-preview",this._previewElement=this._element.appendChild(document.createElement("span")),this._previewElement.className="preview",this._lossless=this._appendPreview(this._previewElement,this._preview),this._titleElement=this._element.appendChild(document.createElement("span")),this._titleElement.className="title",this._titleElement.hidden=!0,this._initTitleElement(),this._preview.hasSize()){var n=this._element.appendChild(document.createElement("span"));n.className="size",n.textContent=" ("+this._preview.size+")"}this._lossless&&this._element.classList.add("lossless")}get preview(){return this._preview}get element(){return this._element}get mode(){return this._mode}get lossless(){return this._lossless}showTitle(){this._titleElement.hidden=!1,this._previewElement.hidden=!0}showPreview(){this._titleElement.hidden=!0,this._previewElement.hidden=!1}setOriginatingObjectInfo(e,t){console.assert(!this._remoteObject),console.assert(e instanceof WI.RemoteObject),console.assert(!t||t instanceof WI.PropertyPath),this._remoteObject=e,this._propertyPath=t||null,this.element.addEventListener("contextmenu",this._contextMenuHandler.bind(this))}_initTitleElement(){this._preview.subtype==="regexp"||this._preview.subtype==="null"?this._titleElement.appendChild(WI.FormattedValue.createElementForObjectPreview(this._preview)):this._preview.subtype==="node"?this._titleElement.appendChild(WI.FormattedValue.createElementForNodePreview(this._preview,{remoteObjectAccessor:e=>e(this._object)})):this._titleElement.textContent=this._preview.description||""}_numberOfPropertiesToShowInMode(){return this._mode===WI.ObjectPreviewView.Mode.Brief?3:1/0}_appendPreview(e,t){var i=!1;if(t.type==="object"){if(t.subtype==="regexp"||t.subtype==="null"||t.subtype==="node")i=!0;else if(t.subtype==="array"&&t.description!=="Array"||t.subtype!=="array"&&t.description!=="Object"){var n=e.appendChild(document.createElement("span"));n.className="object-preview-name",n.textContent=t.description+" "}}var s=e.appendChild(document.createElement("span"));if(s.className="object-preview-body",!i){if(t.collectionEntryPreviews)return this._appendEntryPreviews(s,t);if(t.propertyPreviews)return this._appendPropertyPreviews(s,t)}return this._appendValuePreview(s,t)}_appendEntryPreviews(e,t){var i=t.lossless&&!t.propertyPreviews.length,n=t.overflow,s=t.subtype==="iterator";e.append(s?"[":"{");for(var a=Math.min(t.collectionEntryPreviews.length,this._numberOfPropertiesToShowInMode()),d=0;d<a;++d){d>0&&e.append(", ");var p=!0,f=t.collectionEntryPreviews[d];f.keyPreview&&(p=this._appendPreview(e,f.keyPreview),e.append(" => "));var _=this._appendPreview(e,f.valuePreview);(!p||!_)&&(i=!1)}return t.collectionEntryPreviews.length>a&&(i=!1,n=!0),n&&(a>0&&e.append(", "),e.append(ellipsis)),e.append(s?"]":"}"),i}_appendPropertyPreviews(e,t){if(t.subtype==="error")return!1;if(t.subtype==="date")return!t.propertyPreviews.length;var i=t.lossless,n=t.overflow,s=t.subtype==="array";e.append(s?"[":"{");var a=0,d=this._numberOfPropertiesToShowInMode();for(let p=0;p<t.propertyPreviews.length&&a<d;++p){let f=t.propertyPreviews[p];if(f.type!=="accessor"&&f.name!=="constructor"){if(a++>0&&e.append(", "),!s||f.name!=p){let _=e.appendChild(document.createElement("span"));_.className="name",_.textContent=f.name,e.append(": ")}if(f.valuePreview)this._appendPreview(e,f.valuePreview);else if(f.subtype==="node"){let _={};t===this._preview&&this._object&&(_.remoteObjectAccessor=b=>{this._object.getProperty(f.name,(w,S,E)=>{!w&&S&&!E&&(WI.consoleManager.releaseRemoteObjectWithConsoleClear(S),b(S))})}),e.appendChild(WI.FormattedValue.createElementForNodePreview(f,_))}else e.appendChild(WI.FormattedValue.createElementForPropertyPreview(f))}}return a===d&&t.propertyPreviews.length>d&&(i=!1,n=!0),n&&(d>0&&e.append(", "),e.append(ellipsis)),e.append(s?"]":"}"),i}_appendValuePreview(e,t){if(t.subtype==="node"){let i={};return t===this._preview&&this._object&&(i.remoteObjectAccessor=n=>n(this._object)),e.appendChild(WI.FormattedValue.createElementForNodePreview(t,i)),!1}return e.appendChild(WI.FormattedValue.createElementForObjectPreview(t)),!0}_contextMenuHandler(e){let t=WI.ContextMenu.createFromEvent(e);e.__addedObjectPreviewContextMenuItems=!0,t.appendItem(WI.UIString("Log Value"),()=>{let i=!this._propertyPath||this._propertyPath.isFullPathImpossible(),n=i?WI.UIString("Selected Value"):this._propertyPath.displayPath(WI.PropertyPath.Type.Value);i||WI.quickConsole.prompt.pushHistoryItem(n),WI.consoleLogViewController.appendImmediateExecutionWithResult(n,this._remoteObject,i)})}};WI.ObjectPreviewView.Mode={Brief:Symbol("object-preview-brief"),Full:Symbol("object-preview-full")};WI.ObjectPropertiesDetailSectionRow=class extends WI.DetailsSectionRow{constructor(e,t){super(),console.assert(e instanceof WI.ObjectTreeView),console.assert(!t||t instanceof WI.DetailsSection),this._objectTree=e,this.hideEmptyMessage(),this.element.classList.add("properties",WI.SyntaxHighlightedStyleClassName),this.element.appendChild(e.element),t&&t.collapsed?t.addEventListener(WI.DetailsSection.Event.CollapsedStateChanged,this._detailsSectionCollapsedStateChanged,this):this._objectTree.expand()}get objectTree(){return this._objectTree}_detailsSectionCollapsedStateChanged(e){console.assert(!e.target.collapsed),this._objectTree.expand(),e.target.removeEventListener(WI.DetailsSection.Event.CollapsedStateChanged,this._detailsSectionCollapsedStateChanged,this)}};WI.ObjectTreeArrayIndexTreeElement=class extends WI.ObjectTreeBaseTreeElement{constructor(e,t){console.assert(e.isIndexProperty(),"ObjectTreeArrayIndexTreeElement expects numeric property names"),super(e,t,e),this.mainTitle=this._titleFragment(),this.addClassName("object-tree-property"),this.addClassName("object-tree-array-index"),this.property.hasValue()||this.addClassName("accessor")}invokedGetter(){this.mainTitle=this._titleFragment(),this.removeClassName("accessor")}_titleFragment(){var e=document.createDocumentFragment(),t=e.appendChild(document.createElement("span"));t.className="index-name",t.textContent=this.property.name,t.title=this.propertyPathString(this.thisPropertyPath()),e.append(" ");var i=e.appendChild(document.createElement("span"));i.className="index-value";var n=this.resolvedValue();return n?i.appendChild(WI.FormattedValue.createObjectTreeOrFormattedValueForRemoteObject(n,this.resolvedValuePropertyPath())):(this.property.hasGetter()&&e.appendChild(this.createGetterElement(!0)),this.property.hasSetter()&&e.appendChild(this.createSetterElement())),i.classList.add("value"),this.hadError()&&i.classList.add("error"),e}};WI.ObjectTreeMapEntryTreeElement=class extends WI.ObjectTreeBaseTreeElement{constructor(e,t){console.assert(e instanceof WI.RemoteObject),super(e,t),this._object=e,this.addClassName("object-tree-array-index"),this.addClassName("object-tree-map-entry")}get object(){return this._object}resolvedValue(){return this._object}propertyPathType(){return WI.PropertyPath.Type.Value}titleFragment(){var e=document.createDocumentFragment(),t=this.resolvedValuePropertyPath(),i=e.appendChild(document.createElement("span"));i.className="index-name",i.textContent=this.displayPropertyName(),i.title=this.propertyPathString(t),e.append(" ");var n=e.appendChild(document.createElement("span"));return n.className="index-value",n.appendChild(WI.FormattedValue.createObjectTreeOrFormattedValueForRemoteObject(this._object,t)),e}};WI.ObjectTreeMapKeyTreeElement=class extends WI.ObjectTreeMapEntryTreeElement{constructor(e,t){super(e,t),this.mainTitle=this.titleFragment(),this.addClassName("key")}displayPropertyName(){return WI.UIString("key")}resolvedValuePropertyPath(){return this._propertyPath.appendMapKey(this._object)}};WI.ObjectTreeMapValueTreeElement=class extends WI.ObjectTreeMapEntryTreeElement{constructor(e,t,i){super(e,t),this._key=i,this.mainTitle=this.titleFragment(),this.addClassName("value")}displayPropertyName(){return WI.UIString("value")}resolvedValuePropertyPath(){return this._propertyPath.appendMapValue(this._object,this._key)}};WI.ObjectTreePropertyTreeElement=class extends WI.ObjectTreeBaseTreeElement{constructor(e,t,i,n){super(e,t,e),this._mode=i||WI.ObjectTreeView.Mode.Properties,this._prototypeName=n,this.mainTitle=this._titleFragment(),this.addClassName("object-tree-property"),this.property.hasValue()?(this.addClassName(this.property.value.type),this.property.value.subtype&&this.addClassName(this.property.value.subtype)):this.addClassName("accessor"),this.property.wasThrown&&this.addClassName("had-error"),this.property.name==="__proto__"&&this.addClassName("prototype-property"),this._updateTooltips(),this._updateHasChildren()}onpopulate(){this._updateChildren()}onexpand(){this._previewView&&this._previewView.showTitle()}oncollapse(){this._previewView&&this._previewView.showPreview()}invokedGetter(){this.mainTitle=this._titleFragment();var e=this.resolvedValue();this.addClassName(e.type),e.subtype&&this.addClassName(e.subtype),this.hadError()&&this.addClassName("had-error"),this.removeClassName("accessor"),this._updateHasChildren()}_updateHasChildren(){var e=this.resolvedValue(),t=e&&e.hasChildren,i=this.hadError();this._mode===WI.ObjectTreeView.Mode.Properties?this.hasChildren=!i&&t:this.hasChildren=!i&&t&&(this.property.name==="__proto__"||this._alwaysDisplayAsProperty())}_updateTooltips(){var e=[];this.property.configurable&&e.push("configurable"),this.property.enumerable&&e.push("enumerable"),this.property.writable&&e.push("writable"),this.iconElement.title=e.join(" ")}_titleFragment(){return this.property.name==="__proto__"?this._createTitlePrototype():this._mode===WI.ObjectTreeView.Mode.Properties?this._createTitlePropertyStyle():this._createTitleAPIStyle()}_createTitlePrototype(){console.assert(this.property.hasValue()),console.assert(this.property.name==="__proto__");var e=document.createElement("span");return e.className="prototype-name",e.textContent=WI.UIString("%s Prototype").format(this._sanitizedPrototypeString(this.property.value)),e.title=this.propertyPathString(this.thisPropertyPath()),e}_createTitlePropertyStyle(){var e=document.createDocumentFragment(),t=document.createElement("span");t.className="property-name",t.textContent=this.property.name+": ",t.title=this.propertyPathString(this.thisPropertyPath()),this._mode===WI.ObjectTreeView.Mode.Properties&&(this.property.enumerable||t.classList.add("not-enumerable"));var i,n=this.resolvedValue();return n?n.preview?(this._previewView=new WI.ObjectPreviewView(n,n.preview),i=this._previewView.element):(this._loadPreviewLazilyIfNeeded(),i=WI.FormattedValue.createElementForRemoteObject(n,this.hadError()),n.type==="function"&&(i.textContent=this._functionPropertyString())):(i=document.createElement("span"),this.property.hasGetter()&&i.appendChild(this.createGetterElement(this._mode!==WI.ObjectTreeView.Mode.ClassAPI)),this.property.hasSetter()&&i.appendChild(this.createSetterElement())),i.classList.add("value"),this.hadError()&&i.classList.add("error"),e.appendChild(t),e.appendChild(i),e}_createTitleAPIStyle(){if(this._alwaysDisplayAsProperty())return this._createTitlePropertyStyle();var e=this.property.hasValue()&&this.property.value.type==="function";if(!e&&!this.property.hasGetter()&&!this.property.hasSetter())return null;var t=document.createDocumentFragment(),i=document.createElement("span");if(i.className="property-name",i.textContent=this.property.name,i.title=this.propertyPathString(this.thisPropertyPath()),t.appendChild(i),e){var n=document.createElement("span");n.className="function-parameters",n.textContent=this._functionParameterString(),t.appendChild(n)}else{var s=t.appendChild(document.createElement("span"));s.className="spacer",this.property.hasGetter()&&t.appendChild(this.createGetterElement(this._mode!==WI.ObjectTreeView.Mode.ClassAPI)),this.property.hasSetter()&&t.appendChild(this.createSetterElement())}return t}_loadPreviewLazilyIfNeeded(){let e=this.resolvedValue();!e.canLoadPreview()||e.updatePreview(t=>{t&&(this.mainTitle=this._titleFragment(),this.expanded&&this._previewView.showTitle())})}_alwaysDisplayAsProperty(){return!!(this.property.name==="constructor"||this.property.hasValue()&&this.property.value.type!=="function"||this._getterValue)}_functionPropertyString(){return"function"+this._functionParameterString()}_functionParameterString(){var e=this.resolvedValue();if(console.assert(e.type==="function"),isFunctionStringNativeCode(e.description)){if(this._prototypeName&&WI.NativePrototypeFunctionParameters[this._prototypeName]){var t=WI.NativePrototypeFunctionParameters[this._prototypeName][this._property.name];return t?"("+t+")":"()"}var i=this._propertyPath.object.description;if(isFunctionStringNativeCode(i)){var s=i.match(/^function\s+([^)]+?)\(/);if(s){var n=s[1];if(WI.NativeConstructorFunctionParameters[n]){var t=WI.NativeConstructorFunctionParameters[n][this._property.name];return t?"("+t+")":"()"}}}if(i.endsWith("Constructor")||["Math","JSON","Reflect","Console"].includes(i)){var n=i;if(WI.NativeConstructorFunctionParameters[n]){var t=WI.NativeConstructorFunctionParameters[n][this._property.name];return t?"("+t+")":"()"}}}var s=e.functionDescription.match(/^function.*?(\([^)]*?\))/);return s?s[1]:"()"}_sanitizedPrototypeString(e){return e.type==="function"?"Function":e.subtype==="date"?"Date":e.subtype==="regexp"?"RegExp":e.description.replace(/Prototype$/,"")}_updateChildren(){if(this.children.length&&!this.shouldRefreshChildren)return;const e={ownProperties:!0,generatePreview:!0};var t=this.resolvedValue();t.isCollectionType()&&this._mode===WI.ObjectTreeView.Mode.Properties?t.getCollectionEntries(0,100,this._updateChildrenInternal.bind(this,this._updateEntries,this._mode)):this._mode===WI.ObjectTreeView.Mode.ClassAPI||this._mode===WI.ObjectTreeView.Mode.PureAPI?t.getPropertyDescriptors(this._updateChildrenInternal.bind(this,this._updateProperties,WI.ObjectTreeView.Mode.ClassAPI),e):this.property.name==="__proto__"?t.getPropertyDescriptors(this._updateChildrenInternal.bind(this,this._updateProperties,WI.ObjectTreeView.Mode.PrototypeAPI),e):t.getDisplayablePropertyDescriptors(this._updateChildrenInternal.bind(this,this._updateProperties,this._mode))}_updateChildrenInternal(e,t,i){if(this.removeChildren(),!i){var n=WI.ObjectTreeView.createEmptyMessageElement(WI.UIString("Could not fetch properties. Object may no longer exist."));this.appendChild(new WI.TreeElement(n,null,!1));return}e.call(this,i,this.resolvedValuePropertyPath(),t)}_updateEntries(e,t,i){for(var n of e)n.key?(this.appendChild(new WI.ObjectTreeMapKeyTreeElement(n.key,t)),this.appendChild(new WI.ObjectTreeMapValueTreeElement(n.value,t,n.key))):this.appendChild(new WI.ObjectTreeSetIndexTreeElement(n.value,t));if(!this.children.length){var s=WI.ObjectTreeView.createEmptyMessageElement(WI.UIString("No Entries"));this.appendChild(new WI.TreeElement(s,null,!1))}var a=this.resolvedValue();a.getOwnPropertyDescriptor("__proto__",d=>{d&&this.appendChild(new WI.ObjectTreePropertyTreeElement(d,t,i))})}_updateProperties(e,t,i){e.sort(WI.ObjectTreeView.comparePropertyDescriptors);var n=this.resolvedValue(),s=n.isArray(),a=i===WI.ObjectTreeView.Mode.Properties||this._getterValue,d=i!==WI.ObjectTreeView.Mode.Properties,p;this.property.name==="__proto__"&&n.description&&(p=this._sanitizedPrototypeString(n));var f=!1;for(var _ of e)d&&_.nativeGetter||_.name==="__proto__"&&!_.hasValue()||(s&&a?_.isIndexProperty()?this.appendChild(new WI.ObjectTreeArrayIndexTreeElement(_,t)):_.name==="__proto__"&&this.appendChild(new WI.ObjectTreePropertyTreeElement(_,t,i,p)):this.appendChild(new WI.ObjectTreePropertyTreeElement(_,t,i,p)),_.name==="__proto__"&&(f=!0));if(!this.children.length||f&&this.children.length===1){var b=WI.ObjectTreeView.createEmptyMessageElement(WI.UIString("No Properties"));this.insertChild(new WI.TreeElement(b,null,!1),0)}}};WI.ObjectTreeSetIndexTreeElement=class extends WI.ObjectTreeBaseTreeElement{constructor(e,t){console.assert(e instanceof WI.RemoteObject),super(e,t),this._object=e,this.mainTitle=this._titleFragment(),this.addClassName("object-tree-array-index")}get object(){return this._object}resolvedValue(){return this._object}resolvedValuePropertyPath(){return this.propertyPath.appendSetIndex(this._object)}_titleFragment(){var e=document.createDocumentFragment(),t=this.resolvedValuePropertyPath(),i=e.appendChild(document.createElement("span"));i.className="index-name",i.textContent="\u2022",i.title=WI.UIString("Unable to determine path to property from root"),e.append(" ");var n=e.appendChild(document.createElement("span"));return n.className="index-value",n.appendChild(WI.FormattedValue.createObjectTreeOrFormattedValueForRemoteObject(this._object,t)),e}};WI.ObjectTreeView=class extends WI.Object{constructor(e,t,i,n){super(),console.assert(e instanceof WI.RemoteObject),console.assert(!i||i instanceof WI.PropertyPath);var s=i instanceof WI.PropertyPath;this._object=e,this._mode=t||WI.ObjectTreeView.defaultModeForObject(e),this._propertyPath=i||new WI.PropertyPath(this._object,"this"),this._expanded=!1,this._hasLosslessPreview=!1,this._includeProtoProperty=!0,this._inConsole=!0,this._object.isClass()&&(n=!0),this._element=document.createElement("div"),this._element.__objectTree=this,this._element.className="object-tree",this._object.preview?(this._previewView=new WI.ObjectPreviewView(this._object,this._object.preview),this._previewView.setOriginatingObjectInfo(this._object,s?i:null),this._previewView.element.addEventListener("click",this._handlePreviewOrTitleElementClick.bind(this)),this._element.appendChild(this._previewView.element),this._previewView.lossless&&!this._propertyPath.parent&&!n&&(this._hasLosslessPreview=!0,this.element.classList.add("lossless-preview"))):(this._titleElement=document.createElement("span"),this._titleElement.className="title",this._titleElement.appendChild(WI.FormattedValue.createElementForRemoteObject(this._object)),this._titleElement.addEventListener("click",this._handlePreviewOrTitleElementClick.bind(this)),this._element.appendChild(this._titleElement)),this._outline=new WI.TreeOutline,this._outline.compact=!0,this._outline.customIndent=!0,this._outline.element.classList.add("object"),this._element.appendChild(this._outline.element)}static defaultModeForObject(e){return e.subtype==="class"?WI.ObjectTreeView.Mode.ClassAPI:WI.ObjectTreeView.Mode.Properties}static createEmptyMessageElement(e){var t=document.createElement("div");return t.className="empty-message",t.textContent=e,t}static comparePropertyDescriptors(e,t){var i=e.name,n=t.name;if(i==="__proto__")return 1;if(n==="__proto__"||e.isInternalProperty&&!t.isInternalProperty)return-1;if(t.isInternalProperty&&!e.isInternalProperty||e.symbol&&!t.symbol)return 1;if(t.symbol&&!e.symbol)return-1;if(i===n)return 0;for(var s=0,a=/^\d+|^\D+/,d,p,f,_;s===0;){if(!i&&n)return-1;if(!n&&i)return 1;if(d=i.match(a)[0],p=n.match(a)[0],f=!isNaN(d),_=!isNaN(p),f&&!_)return-1;if(_&&!f)return 1;if(f&&_){if(s=d-p,s===0&&d.length!==p.length)return!+d&&!+p?d.length-p.length:p.length-d.length}else if(d!==p)return d<p?-1:1;i=i.substring(d.length),n=n.substring(p.length)}return s}get object(){return this._object}get element(){return this._element}get treeOutline(){return this._outline}get expanded(){return this._expanded}expand(){this._expanded||this._hasLosslessPreview||(this._expanded=!0,this._element.classList.add("expanded"),this._previewView&&this._previewView.showTitle(),this._trackWeakEntries(),this.update())}collapse(){!this._expanded||(this._expanded=!1,this._element.classList.remove("expanded"),this._previewView&&this._previewView.showPreview(),this._untrackWeakEntries())}showOnlyProperties(){this._inConsole=!1,this._element.classList.add("properties-only"),this._includeProtoProperty=!1}showOnlyJSON(){this.showOnlyProperties(),this._element.classList.add("json-only")}appendTitleSuffix(e){this._previewView?this._previewView.element.appendChild(e):this._titleElement.appendChild(e)}appendExtraPropertyDescriptor(e){this._extraProperties||(this._extraProperties=[]),this._extraProperties.push(e)}setPrototypeNameOverride(e){this._prototypeNameOverride=e}update(){const e={ownProperties:!0,generatePreview:!0};this._object.isCollectionType()&&this._mode===WI.ObjectTreeView.Mode.Properties?this._object.getCollectionEntries(0,100,this._updateChildren.bind(this,this._updateEntries)):this._object.isClass()?this._object.classPrototype.getDisplayablePropertyDescriptors(this._updateChildren.bind(this,this._updateProperties)):this._mode===WI.ObjectTreeView.Mode.PureAPI?this._object.getPropertyDescriptors(this._updateChildren.bind(this,this._updateProperties),e):this._object.getDisplayablePropertyDescriptors(this._updateChildren.bind(this,this._updateProperties))}_updateChildren(e,t){if(this._outline.removeChildren(),!t){var i=WI.ObjectTreeView.createEmptyMessageElement(WI.UIString("Could not fetch properties. Object may no longer exist."));this._outline.appendChild(new WI.TreeElement(i,null,!1));return}e.call(this,t,this._propertyPath),this.dispatchEventToListeners(WI.ObjectTreeView.Event.Updated)}_updateEntries(e,t){for(var i of e)i.key?(this._outline.appendChild(new WI.ObjectTreeMapKeyTreeElement(i.key,t)),this._outline.appendChild(new WI.ObjectTreeMapValueTreeElement(i.value,t,i.key))):this._outline.appendChild(new WI.ObjectTreeSetIndexTreeElement(i.value,t));if(!this._outline.children.length){var n=WI.ObjectTreeView.createEmptyMessageElement(WI.UIString("No Entries"));this._outline.appendChild(new WI.TreeElement(n,null,!1))}this._object.getOwnPropertyDescriptor("__proto__",s=>{s&&this._outline.appendChild(new WI.ObjectTreePropertyTreeElement(s,t,this._mode))})}_updateProperties(e,t){this._extraProperties&&(e=e.concat(this._extraProperties)),e.sort(WI.ObjectTreeView.comparePropertyDescriptors);var i=this._object.isArray(),n=this._mode===WI.ObjectTreeView.Mode.Properties,s=!1;for(var a of e){if(a.name==="__proto__"){if(!a.hasValue()||!this._includeProtoProperty)continue;s=!0}i&&n?a.isIndexProperty()?this._outline.appendChild(new WI.ObjectTreeArrayIndexTreeElement(a,t)):a.name==="__proto__"&&this._outline.appendChild(new WI.ObjectTreePropertyTreeElement(a,t,this._mode,this._prototypeNameOverride)):this._outline.appendChild(new WI.ObjectTreePropertyTreeElement(a,t,this._mode,this._prototypeNameOverride))}if(!this._outline.children.length||s&&this._outline.children.length===1){var d=WI.ObjectTreeView.createEmptyMessageElement(WI.UIString("No Properties"));this._outline.insertChild(new WI.TreeElement(d,null,!1),0)}}_handlePreviewOrTitleElementClick(e){this._hasLosslessPreview||(this._expanded?this.collapse():this.expand(),e.stopPropagation())}_trackWeakEntries(){this._trackingEntries||!this._object.isWeakCollection()||(this._trackingEntries=!0,this._inConsole&&(WI.consoleManager.addEventListener(WI.ConsoleManager.Event.Cleared,this._untrackWeakEntries,this),WI.consoleManager.addEventListener(WI.ConsoleManager.Event.SessionStarted,this._untrackWeakEntries,this)))}_untrackWeakEntries(){!this._trackingEntries||!this._object.isWeakCollection()||(this._trackingEntries=!1,this._object.releaseWeakCollectionEntries(),this._inConsole&&(WI.consoleManager.removeEventListener(WI.ConsoleManager.Event.Cleared,this._untrackWeakEntries,this),WI.consoleManager.removeEventListener(WI.ConsoleManager.Event.SessionStarted,this._untrackWeakEntries,this)))}};WI.ObjectTreeView.Mode={Properties:Symbol("object-tree-properties"),PrototypeAPI:Symbol("object-tree-prototype-api"),ClassAPI:Symbol("object-tree-class-api"),PureAPI:Symbol("object-tree-pure-api")};WI.ObjectTreeView.Event={Updated:"object-tree-updated"};WI.OpenResourceDialog=class extends WI.Dialog{constructor(e){super(e),this.element.classList.add("open-resource-dialog");let t=this.element.appendChild(document.createElement("div"));t.classList.add("field"),this._inputElement=t.appendChild(document.createElement("input")),this._inputElement.type="text",this._inputElement.placeholder=WI.UIString("File or Resource"),this._inputElement.spellcheck=!1,this._clearIconElement=t.appendChild(document.createElement("img")),this._inputElement.addEventListener("keydown",this._handleKeydownEvent.bind(this)),this._inputElement.addEventListener("keyup",this._handleKeyupEvent.bind(this)),this._inputElement.addEventListener("blur",this._handleBlurEvent.bind(this)),this._clearIconElement.addEventListener("mousedown",this._handleMousedownEvent.bind(this)),this._clearIconElement.addEventListener("click",this._handleClickEvent.bind(this)),this._treeOutline=new WI.TreeOutline,this._treeOutline.allowsRepeatSelection=!0,this._treeOutline.disclosureButtons=!1,this._treeOutline.large=!0,this._treeOutline.addEventListener(WI.TreeOutline.Event.SelectionDidChange,this._treeSelectionDidChange,this),this._treeOutline.element.addEventListener("focus",()=>{this._inputElement.focus()}),this.element.appendChild(this._treeOutline.element),this._queryController=new WI.ResourceQueryController,this._filteredResults=[]}_populateResourceTreeOutline(){function e(i,n){let s=document.createDocumentFragment(),a=0;for(let d of n){d.startColumn>a&&s.append(i.substring(a,d.startColumn));let p=document.createElement("span");p.classList.add("highlighted"),p.append(i.substring(d.startColumn,d.endColumn)),s.append(p),a=d.endColumn}return a<i.length&&s.append(i.substring(a,i.length)),s}function t(i){let n=null;return i instanceof WI.SourceMapResource?n=new WI.SourceMapResourceTreeElement(i):i instanceof WI.Resource?n=new WI.ResourceTreeElement(i):i instanceof WI.Script&&(n=new WI.ScriptTreeElement(i)),n}for(let i of this._filteredResults){let n=i.resource;if(this._treeOutline.findTreeElement(n))continue;let s=t(n);if(!s)continue;s.mainTitle=e(n.displayName,i.matchingTextRanges);let a=n.urlComponents.path,d=n.urlComponents.lastPathComponent;if(a&&d){let p=a.substring(0,a.length-d.length);p.length&&p!=="/"&&(s.titlesElement.dataset.path=p)}s[WI.OpenResourceDialog.ResourceMatchCookieDataSymbol]=i.cookie,this._treeOutline.appendChild(s)}this._treeOutline.children.length&&this._treeOutline.children[0].select(!0,!1,!0)}didDismissDialog(){WI.Frame.removeEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this),WI.Frame.removeEventListener(WI.Frame.Event.ResourceWasAdded,this._resourceWasAdded,this),WI.Target.removeEventListener(WI.Target.Event.ResourceAdded,this._resourceWasAdded,this),WI.debuggerManager.removeEventListener(WI.DebuggerManager.Event.ScriptAdded,this._scriptAdded,this),this._queryController.reset()}didPresentDialog(){WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this),WI.Frame.addEventListener(WI.Frame.Event.ResourceWasAdded,this._resourceWasAdded,this),WI.Target.addEventListener(WI.Target.Event.ResourceAdded,this._resourceWasAdded,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.ScriptAdded,this._scriptAdded,this),WI.networkManager.mainFrame&&this._addResourcesForFrame(WI.networkManager.mainFrame),this._addScriptsForTarget(WI.mainTarget);for(let e of WI.targets)e!==WI.mainTarget&&this._addResourcesForTarget(e);this._updateFilter(),this._inputElement.focus(),this._clear()}_handleKeydownEvent(e){if(e.keyCode===WI.KeyboardShortcut.Key.Escape.keyCode)this._inputElement.value===""?(this.dismiss(),e.preventDefault()):this._clear(),e.preventDefault();else if(e.keyCode===WI.KeyboardShortcut.Key.Enter.keyCode){if(this._treeOutline.selectedTreeElement){this.dismiss(this._treeOutline.selectedTreeElement.representedObject,this._treeOutline.selectedTreeElement[WI.OpenResourceDialog.ResourceMatchCookieDataSymbol]),e.preventDefault();return}if(/^:\d/.test(this._inputElement.value)){let t=WI.focusedOrVisibleContentView(),i=t?t.representedObject:null;if(i&&i instanceof WI.SourceCode){let[,n,s]=this._inputElement.value.split(":");n=n?parseInt(n,10)-1:0,s=s?parseInt(s,10)-1:0,this.dismiss(i,{lineNumber:n,columnNumber:s}),e.preventDefault();return}}this._inputElement.select()}else if(e.keyCode===WI.KeyboardShortcut.Key.Up.keyCode||e.keyCode===WI.KeyboardShortcut.Key.Down.keyCode){let t=this._treeOutline.selectedTreeElement;if(!t)return;let i=e.keyCode===WI.KeyboardShortcut.Key.Up.keyCode?"previousSibling":"nextSibling";t=t[i],t&&t.revealAndSelect(!0,!1,!0),e.preventDefault()}}_handleKeyupEvent(e){e.keyCode===WI.KeyboardShortcut.Key.Up.keyCode||e.keyCode===WI.KeyboardShortcut.Key.Down.keyCode||this._updateFilter()}_handleBlurEvent(e){e.relatedTarget!==this._treeOutline.element&&this.dismiss()}_handleMousedownEvent(e){this._inputElement.select(),e.preventDefault()}_handleClickEvent(e){this._clear()}_clear(){this._inputElement.value="",this._updateFilter()}_updateFilter(){this._filteredResults=[],this._treeOutline.removeChildren();let e=this._inputElement.value.trim();e&&(this._filteredResults=this._queryController.executeQuery(e),this._populateResourceTreeOutline()),this.element.classList.toggle("non-empty",this._inputElement.value!==""),this.element.classList.toggle("has-results",this._treeOutline.children.length)}_treeSelectionDidChange(e){let t=this._treeOutline.selectedTreeElement;!t||!e.data.selectedByUser||this.dismiss(t.representedObject,t[WI.OpenResourceDialog.ResourceMatchCookieDataSymbol])}_addResource(e,t){if(!!this.representedObjectIsValid(e)){for(let i of e.sourceMaps)for(let n of i.resources)this._addResource(n,t);this._queryController.addResource(e),!t&&this._updateFilter()}}_addResourcesForFrame(e){let i=[e];for(;i.length;){let n=i.shift();this._addResource(n.mainResource,!0);for(let s of n.resourceCollection)this._addResource(s,!0);i.push(...n.childFrameCollection)}}_addResourcesForTarget(e){this._addResource(e.mainResource);for(let i of e.resourceCollection)this._addResource(i,!0);this._addScriptsForTarget(e)}_addScriptsForTarget(e){let i=WI.debuggerManager.dataForTarget(e);for(let n of i.scripts)n.resource||n.dynamicallyAddedScriptElement||isWebKitInternalScript(n.sourceURL)||isWebInspectorConsoleEvaluationScript(n.sourceURL)||this._addResource(n,!0)}_mainResourceDidChange(e){e.target.isMainFrame()&&this._queryController.reset(),this._addResource(e.target.mainResource)}_resourceWasAdded(e){this._addResource(e.data.resource)}_scriptAdded(e){let t=e.data.script;t.resource||t.target!==WI.mainTarget&&this._addResource(t)}};WI.OpenResourceDialog.ResourceMatchCookieDataSymbol=Symbol("open-resource-dialog-resource-match-cookie-data");WI.OverviewTimelineView=class extends WI.TimelineView{constructor(e,t){console.assert(e instanceof WI.TimelineRecording),super(e,t),this._recording=e,this._pendingRepresentedObjects=[],this._resourceDataGridNodeMap=new Map,WI.TimelineRecording.sourceCodeTimelinesSupported()&&!this._recording.imported&&(WI.settings.timelineOverviewGroupBySourceCode.addEventListener(WI.Setting.Event.Changed,this._handleGroupBySourceCodeSettingChanged,this),this._groupBySourceCodeNavigationItem=new WI.CheckboxNavigationItem("overview-timeline-group-by-resource",WI.UIString("Group By Resource"),WI.settings.timelineOverviewGroupBySourceCode.value),this._groupBySourceCodeNavigationItem.addEventListener(WI.CheckboxNavigationItem.Event.CheckedDidChange,this._handleGroupBySourceCodeNavigationItemCheckedDidChange,this));let i={name:{},source:{},graph:{}};i.name.title=WI.UIString("Name"),i.name.width="20%",i.name.icon=!0,i.name.locked=!0,this._shouldGroupBySourceCode&&(i.name.disclosure=!0),i.source.title=WI.UIString("Source"),i.source.width="10%",i.source.icon=!0,i.source.locked=!0,this._shouldGroupBySourceCode&&(i.source.hidden=!0),this._timelineRuler=new WI.TimelineRuler,this._timelineRuler.allowsClippedLabels=!0,i.graph.width="70%",i.graph.headerView=this._timelineRuler,i.graph.locked=!0,this._dataGrid=new WI.TimelineDataGrid(i),this.setupDataGrid(this._dataGrid),this._currentTimeMarker=new WI.TimelineMarker(0,WI.TimelineMarker.Type.CurrentTime),this._timelineRuler.addMarker(this._currentTimeMarker),this.element.classList.add("overview"),this.addSubview(this._dataGrid);for(let n of this._relevantTimelines)n.addEventListener(WI.Timeline.Event.RecordAdded,this._handleTimelineRecordAdded,this);e.addEventListener(WI.TimelineRecording.Event.SourceCodeTimelineAdded,this._sourceCodeTimelineAdded,this),e.addEventListener(WI.TimelineRecording.Event.MarkerAdded,this._markerAdded,this),e.addEventListener(WI.TimelineRecording.Event.Reset,this._recordingReset,this),this._loadExistingRecords()}get secondsPerPixel(){return this._timelineRuler.secondsPerPixel}set secondsPerPixel(e){this._timelineRuler.secondsPerPixel=e}shown(){super.shown(),this._timelineRuler.updateLayout(WI.View.LayoutReason.Resize)}closed(){for(let e of this._recording.timelines.values())e.removeEventListener(null,null,this);this._recording.removeEventListener(null,null,this)}get navigationItems(){let e=[];return this._groupBySourceCodeNavigationItem&&e.push(this._groupBySourceCodeNavigationItem),e}get selectionPathComponents(){let e=this._dataGrid.selectedNode;if(!e||e.hidden)return null;let t=[];for(;e&&!e.root;){if(console.assert(e instanceof WI.TimelineDataGridNode),e.hidden)return null;let i=new WI.TimelineDataGridNodePathComponent(e);i.addEventListener(WI.HierarchicalPathComponent.Event.SiblingWasSelected,this.dataGridNodePathComponentSelected,this),t.unshift(i),e=e.parent}return t}reset(){super.reset(),this._dataGrid.reset(),this._pendingRepresentedObjects=[],this._resourceDataGridNodeMap.clear()}get showsImportedRecordingMessage(){return!0}dataGridNodePathComponentSelected(e){let t=e.data.pathComponent.timelineDataGridNode;console.assert(t.dataGrid===this._dataGrid),t.revealAndSelect()}layout(){let e=this._timelineRuler.zeroTime,t=this._timelineRuler.startTime,i=this._timelineRuler.endTime,n=this._currentTimeMarker.time;if(this._timelineRuler.zeroTime=this.zeroTime,this._timelineRuler.startTime=this.startTime,this._timelineRuler.endTime=this.endTime,this._currentTimeMarker.time=this.currentTime,this.zeroTime!==e||this.startTime!==t||this.endTime!==i||this.currentTime!==n){let s=this._dataGrid.children[0];for(;s;)s.refreshGraph(),s=s.traverseNextNode(!0,null,!0)}this._processPendingRepresentedObjects()}get _relevantTimelines(){let e=[];for(let[t,i]of this._recording.timelines)t===WI.TimelineRecord.Type.RenderingFrame||t===WI.TimelineRecord.Type.CPU||t===WI.TimelineRecord.Type.Memory||e.push(i);return e}get _shouldGroupBySourceCode(){return this._recording.imported?!1:WI.TimelineRecording.sourceCodeTimelinesSupported()&&WI.settings.timelineOverviewGroupBySourceCode.value}_loadExistingRecords(){if(this._pendingRepresentedObjects=[],this._resourceDataGridNodeMap.clear(),this._dataGrid.removeChildren(),this._shouldGroupBySourceCode){let e=this._recording.timelines.get(WI.TimelineRecord.Type.Network);e&&(this._pendingRepresentedObjects=this._pendingRepresentedObjects.concat(e.records.map(t=>t.resource))),this._pendingRepresentedObjects=this._pendingRepresentedObjects.concat(this._recording.sourceCodeTimelines)}else for(let e of this._relevantTimelines)this._pendingRepresentedObjects=this._pendingRepresentedObjects.concat(e.records);this.needsLayout()}_compareDataGridNodesByStartTime(e,t){function i(s){return s instanceof WI.ResourceTimelineDataGridNode?s.resource.firstTimestamp:s instanceof WI.SourceCodeTimelineTimelineDataGridNode?s.sourceCodeTimeline.startTime:(console.error("Unknown data grid node.",s),0)}let n=i(e)-i(t);return n||e.displayName().extendedLocaleCompare(t.displayName())}_insertDataGridNode(e,t){console.assert(e),console.assert(!e.parent),t||(t=this._dataGrid),t.insertChild(e,insertionIndexForObjectInListSortedByFunction(e,t.children,this._compareDataGridNodesByStartTime))}_addResourceToDataGridIfNeeded(e){if(console.assert(e),!e)return null;let t=this._resourceDataGridNodeMap.get(e);if(!t){let i=this._networkTimeline?this._networkTimeline.recordForResource(e):null;i||(i=new WI.ResourceTimelineRecord(e)),t=new WI.ResourceTimelineDataGridNode(i,{graphDataSource:this,includesGraph:!0}),this._resourceDataGridNodeMap.set(e,t)}if(!t.parent){let i=e.parentFrame;if(!i)return null;let n=!1;(i.mainResource===e||i.provisionalMainResource===e)&&(i=i.parentFrame,n=!i),n&&t.expand();let s=null;if(i){let a=i.provisionalMainResource||i.mainResource;if(s=this._addResourceToDataGridIfNeeded(a),console.assert(s),!s)return null}this._insertDataGridNode(t,s)}return t.refresh(),t}_addSourceCodeTimeline(e){let t=this._resourceDataGridNodeMap.get(e);if(t||(t=new WI.SourceCodeTimelineTimelineDataGridNode(e,{graphDataSource:this}),this._resourceDataGridNodeMap.set(e,t)),!t.parent){let i=e.sourceCodeLocation?this._addResourceToDataGridIfNeeded(e.sourceCode):null;this._insertDataGridNode(t,i)}}_processPendingRepresentedObjects(){if(!!this._pendingRepresentedObjects.length){for(var e of this._pendingRepresentedObjects)if(this._shouldGroupBySourceCode)e instanceof WI.Resource?this._addResourceToDataGridIfNeeded(e):e instanceof WI.SourceCodeTimeline?this._addSourceCodeTimeline(e):console.error("Unknown represented object",e);else{const t={graphDataSource:this,shouldShowPopover:!0};let i=null;if(e instanceof WI.ResourceTimelineRecord?i=new WI.ResourceTimelineDataGridNode(e,t):e instanceof WI.LayoutTimelineRecord?i=new WI.LayoutTimelineDataGridNode(e,t):e instanceof WI.MediaTimelineRecord?i=new WI.MediaTimelineDataGridNode(e,t):e instanceof WI.ScriptTimelineRecord?i=new WI.ScriptTimelineDataGridNode(e,t):e instanceof WI.HeapAllocationsTimelineRecord&&(i=new WI.HeapAllocationsTimelineDataGridNode(e,t)),console.assert(i,e),!i)continue;let n=(s,a)=>s.record.startTime-a.record.startTime;this._dataGrid.insertChild(i,insertionIndexForObjectInListSortedByFunction(i,this._dataGrid.children,n))}this._pendingRepresentedObjects=[]}}_handleGroupBySourceCodeSettingChanged(e){let t=this._shouldGroupBySourceCode;this._dataGrid.disclosureColumnIdentifier=t?"name":void 0,this._dataGrid.setColumnVisible("source",!t),this._groupBySourceCodeNavigationItem&&(this._groupBySourceCodeNavigationItem.checked=t),this._loadExistingRecords()}_handleGroupBySourceCodeNavigationItemCheckedDidChange(e){WI.settings.timelineOverviewGroupBySourceCode.value=!WI.settings.timelineOverviewGroupBySourceCode.value}_handleTimelineRecordAdded(e){let{record:t}=e.data;if(this._shouldGroupBySourceCode){if(e.target.type!==WI.TimelineRecord.Type.Network)return;console.assert(t instanceof WI.ResourceTimelineRecord),this._pendingRepresentedObjects.push(t.resource)}else this._pendingRepresentedObjects.push(t);this.needsLayout()}_sourceCodeTimelineAdded(e){if(!!this._shouldGroupBySourceCode){var t=e.data.sourceCodeTimeline;console.assert(t),t&&(this._pendingRepresentedObjects.push(t),this.needsLayout())}}_markerAdded(e){this._timelineRuler.addMarker(e.data.marker)}_recordingReset(e){this._timelineRuler.clearMarkers(),this._timelineRuler.addMarker(this._currentTimeMarker)}};WI.ProbeDetailsSidebarPanel=class extends WI.DetailsSidebarPanel{constructor(){super("probe",WI.UIString("Probes")),this._probeSetSections=new Map,this._inspectedProbeSets=[]}get inspectedProbeSets(){return this._inspectedProbeSets.slice()}set inspectedProbeSets(e){for(let t of this._inspectedProbeSets){let i=this._probeSetSections.get(t);i&&i.element.remove()}this._inspectedProbeSets=e;for(let t of e){let i=this._probeSetSections.get(t);i&&this.contentView.element.appendChild(i.element)}}inspect(e){e instanceof Array||(e=[e]);var t=e.filter(function(i){return i instanceof WI.ProbeSet});return t.sort(function(n,s){var a=n.breakpoint.sourceCodeLocation,d=s.breakpoint.sourceCodeLocation,p=a.sourceCode.displayName.extendedLocaleCompare(d.sourceCode.displayName);return p!==0||(p=a.displayLineNumber-d.displayLineNumber,p!==0)?p:a.displayColumnNumber-d.displayColumnNumber}),this.inspectedProbeSets=t,!!this._inspectedProbeSets.length}closed(){WI.debuggerManager.removeEventListener(null,null,this),super.closed()}initialLayout(){super.initialLayout(),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.ProbeSetAdded,this._probeSetAdded,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.ProbeSetRemoved,this._probeSetRemoved,this);for(let e of new Set([...this._inspectedProbeSets,...WI.debuggerManager.probeSets]))this._probeSetAdded(e);this.inspectedProbeSets=this._inspectedProbeSets}sizeDidChange(){super.sizeDidChange();for(let e of this._probeSetSections.values())e.sizeDidChange()}_probeSetAdded(e){var t;e instanceof WI.ProbeSet?t=e:t=e.data.probeSet,console.assert(!this._probeSetSections.has(t),"New probe group ",t," already has its own sidebar.");var i=new WI.ProbeSetDetailsSection(t);this._probeSetSections.set(t,i)}_probeSetRemoved(e){var t=e.data.probeSet;console.assert(this._probeSetSections.has(t),"Removed probe group ",t," doesn't have a sidebar.");var i=this.inspectedProbeSets,n=i.indexOf(t);n!==-1&&(i.splice(n,1),this.inspectedProbeSets=i);var s=this._probeSetSections.get(t);this._probeSetSections.delete(t),s.closed()}};WI.ProbeSetDataGrid=class extends WI.DataGrid{constructor(e){console.assert(e instanceof WI.ProbeSet,"Invalid ProbeSet argument: ",e);var t={};for(var i of e.probes){var n=i.expression||WI.UIString("(uninitialized)");t[WI.ProbeSetDataGrid.columnIdentifierForProbe(i)]={title:n}}super(t),this.probeSet=e,this.inline=!0,this._frameNodes=new Map,this._lastUpdatedFrame=null,this._nodesSinceLastNavigation=[],this._listenerSet=new WI.EventListenerSet(this,"ProbeSetDataGrid instance listeners"),this._listenerSet.register(e,WI.ProbeSet.Event.ProbeAdded,this._setupProbe),this._listenerSet.register(e,WI.ProbeSet.Event.ProbeRemoved,this._teardownProbe),this._listenerSet.register(e,WI.ProbeSet.Event.SamplesCleared,this._setupData),this._listenerSet.register(WI.Probe,WI.Probe.Event.ExpressionChanged,this._probeExpressionChanged),this._listenerSet.install(),this._setupData()}static columnIdentifierForProbe(e){return"probe"+e.id}closed(){for(var e of this.probeSet)this._teardownProbe(e);this._listenerSet.uninstall(!0)}_setupProbe(e){var t=e.data;this.insertColumn(WI.ProbeSetDataGrid.columnIdentifierForProbe(t),{title:t.expression});for(var i of this._data.frames)this._updateNodeForFrame(i)}_teardownProbe(e){var t=e.data;this.removeColumn(WI.ProbeSetDataGrid.columnIdentifierForProbe(t));for(var i of this._data.frames)this._updateNodeForFrame(i)}_setupData(){this._data=this.probeSet.dataTable;for(var e of this._data.frames)this._updateNodeForFrame(e);this._dataListeners=new WI.EventListenerSet(this,"ProbeSetDataGrid data table listeners"),this._dataListeners.register(this._data,WI.ProbeSetDataTable.Event.FrameInserted,this._dataFrameInserted),this._dataListeners.register(this._data,WI.ProbeSetDataTable.Event.SeparatorInserted,this._dataSeparatorInserted),this._dataListeners.register(this._data,WI.ProbeSetDataTable.Event.WillRemove,this._teardownData),this._dataListeners.install()}_teardownData(){this._dataListeners.uninstall(!0),this.removeChildren(),this._frameNodes=new Map,this._lastUpdatedFrame=null}_updateNodeForFrame(e){console.assert(e instanceof WI.ProbeSetDataFrame,"Invalid ProbeSetDataFrame argument: ",e);var t=null;if(this._frameNodes.has(e))t=this._frameNodes.get(e),t.frame=e,t.refresh();else{t=new WI.ProbeSetDataGridNode(this),t.frame=e,this._frameNodes.set(e,t),t.createCells();var i=function(s,a){return WI.ProbeSetDataFrame.compare(s.frame,a.frame)},n=insertionIndexForObjectInListSortedByFunction(t,this.children,i);n===this.children.length?this.appendChild(t):this.children[n].frame.key===e.key?(this.removeChild(this.children[n]),this.insertChild(t,n)):this.insertChild(t,n)}console.assert(t),this.updateLayoutIfNeeded(),t.element.classList.add("data-updated"),window.setTimeout(function(){t.element.classList.remove("data-updated")},WI.ProbeSetDataGrid.DataUpdatedAnimationDuration),this._nodesSinceLastNavigation.push(t)}_updateNodeForSeparator(e){console.assert(this._frameNodes.has(e),"Tried to add separator for unknown data frame: ",e),this._frameNodes.get(e).updateCellsForSeparator(e,this.probeSet);for(var t of this._nodesSinceLastNavigation)t.element.classList.add("past-value");this._nodesSinceLastNavigation=[]}_dataFrameInserted(e){var t=e.data;this._lastUpdatedFrame=t,this._updateNodeForFrame(t)}_dataSeparatorInserted(e){var t=e.data;this._updateNodeForSeparator(t)}_probeExpressionChanged(e){var t=e.target;if(t.breakpoint!==this.probeSet.breakpoint)return;let i=WI.ProbeSetDataGrid.columnIdentifierForProbe(t);if(!!this.columns.has(i)){var n=this.columns.get(i);this.removeColumn(i);var s=n.ordinal,a={title:e.data.newValue};this.insertColumn(i,a,s);for(var d of this._data.frames)this._updateNodeForFrame(d)}}};WI.ProbeSetDataGrid.DataUpdatedAnimationDuration=300;WI.ProbeSetDataGridNode=class extends WI.DataGridNode{constructor(e){console.assert(e instanceof WI.ProbeSetDataGrid,"Invalid ProbeSetDataGrid argument:",e),super(),this.dataGrid=e,this._data={},this._element=document.createElement("tr"),this._element.dataGridNode=this,this._element.classList.add("revealed")}get element(){return this._element}get data(){return this._data}set frame(e){console.assert(e instanceof WI.ProbeSetDataFrame,"Invalid ProbeSetDataFrame argument: ",e),this._frame=e;var t={};for(var i of this.dataGrid.probeSet.probes){let s=WI.ProbeSetDataGrid.columnIdentifierForProbe(i);var n=this.frame[i.id];!n||!n.object?t[s]=WI.ProbeSetDataFrame.MissingValue:t[s]=n.object}this._data=t}get frame(){return this._frame}createCellContent(e,t){var i=this.data[e];return i===WI.ProbeSetDataFrame.MissingValue?(t.classList.add("unknown-value"),i):i instanceof WI.RemoteObject?WI.FormattedValue.createObjectTreeOrFormattedValueForRemoteObject(i,null):i}updateCellsFromFrame(e,t){}updateCellsForSeparator(e,t){this._element.classList.add("separator")}};WI.ProbeSetDetailsSection=class extends WI.DetailsSection{constructor(e){console.assert(e instanceof WI.ProbeSet,"Invalid ProbeSet argument:",e);var t=document.createElement("div"),i=new WI.ProbeSetDataGrid(e),n=new WI.DetailsSectionRow;n.element.appendChild(i.element);var s=new WI.DetailsSectionGroup([n]);super("probe","",[s],t),this.element.classList.add("probe-set"),this._listenerSet=new WI.EventListenerSet(this,"ProbeSetDetailsSection UI listeners"),this._probeSet=e,this._dataGrid=i,this._navigationBar=new WI.NavigationBar,this._optionsElement.appendChild(this._navigationBar.element),this._addProbeButtonItem=new WI.ButtonNavigationItem("add-probe",WI.UIString("Add probe expression"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 13'%3e %3cpath fill='none' stroke='currentColor' d='M 6.5 1 V 12 M 1 6.5 H 12'/%3e %3c/svg%3e",13,13),this._addProbeButtonItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._addProbeButtonClicked,this),this._navigationBar.addNavigationItem(this._addProbeButtonItem),this._clearSamplesButtonItem=new WI.ButtonNavigationItem("clear-samples",WI.UIString("Clear samples"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' d='M 3.5 12.5 l -1 -10 h -1 h 11.9 h -1 l -1 10 H 3.5 z'/%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' d='M 5.5 2 L 5.5 0.5 L 9.5 0.5 L 9.5 2'/%3e %3cline fill='none' stroke='currentColor' stroke-linecap='round' x1='5.5' y1='9.2' x2='9.4' y2='5.3'/%3e %3cline fill='none' stroke='currentColor' stroke-linecap='round' x1='5.5' y1='5.2' x2='9.4' y2='9.2'/%3e %3c/svg%3e",15,15),this._clearSamplesButtonItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._clearSamplesButtonClicked,this),this._clearSamplesButtonItem.enabled=this._probeSetHasSamples(),this._navigationBar.addNavigationItem(this._clearSamplesButtonItem),this._removeProbeButtonItem=new WI.ButtonNavigationItem("remove-probe",WI.UIString("Remove probe"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='square' d='M 2.5 2.5 L 13.5 13.5 M 2.5 13.5 L 13.5 2.5'/%3e %3c/svg%3e",12,12),this._removeProbeButtonItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._removeProbeButtonClicked,this),this._navigationBar.addNavigationItem(this._removeProbeButtonItem),this._listenerSet.register(this._probeSet,WI.ProbeSet.Event.SampleAdded,this._probeSetSamplesChanged),this._listenerSet.register(this._probeSet,WI.ProbeSet.Event.SamplesCleared,this._probeSetSamplesChanged),this._updateLinkElement(),this._listenerSet.register(this._probeSet.breakpoint,WI.Breakpoint.Event.ResolvedStateDidChange,this._updateLinkElement),this._listenerSet.install()}closed(){this._listenerSet.uninstall(!0),this.element.remove()}sizeDidChange(){this._dataGrid.sizeDidChange()}_updateLinkElement(){const e={ignoreNetworkTab:!0,ignoreSearchTab:!0};var t=this._probeSet.breakpoint;t.sourceCodeLocation.sourceCode?this.titleElement=WI.createSourceCodeLocationLink(t.sourceCodeLocation,e):(console.assert(!t.resolved),this.titleElement=WI.linkifyLocation(t.contentIdentifier,t.sourceCodeLocation.position,e)),this.titleElement.classList.add(WI.ProbeSetDetailsSection.DontFloatLinkStyleClassName)}_addProbeButtonClicked(e){function t(d,p){if(p.keyCode!==13)return;let f=p.target.value;this._probeSet.createProbe(f),d.dismiss()}let i=new WI.Popover,n=document.createElement("div");n.classList.add(WI.ProbeSetDetailsSection.ProbePopoverElementStyleClassName),n.createChild("div").textContent=WI.UIString("Add New Probe Expression");let s=n.createChild("input");s.addEventListener("keypress",t.bind(this,i)),s.addEventListener("click",function(d){d.target.select()}),s.type="text",s.placeholder=WI.UIString("Expression"),i.content=n;let a=WI.Rect.rectFromClientRect(e.target.element.getBoundingClientRect());i.present(a,[WI.RectEdge.MAX_Y,WI.RectEdge.MIN_Y,WI.RectEdge.MAX_X]),i.windowResizeHandler=()=>{let d=WI.Rect.rectFromClientRect(e.target.element.getBoundingClientRect());i.present(d,[WI.RectEdge.MAX_Y,WI.RectEdge.MIN_Y,WI.RectEdge.MAX_X])},s.select()}_clearSamplesButtonClicked(e){this._probeSet.clearSamples()}_removeProbeButtonClicked(e){this._probeSet.clear()}_probeSetSamplesChanged(e){this._clearSamplesButtonItem.enabled=this._probeSetHasSamples()}_probeSetHasSamples(){return this._probeSet.probes.some(e=>e.samples.length)}};WI.ProbeSetDetailsSection.DontFloatLinkStyleClassName="dont-float";WI.ProbeSetDetailsSection.ProbePopoverElementStyleClassName="probe-popover";WI.ProfileDataGridNode=class extends WI.DataGridNode{constructor(e,t){super(e,!1),this._node=e,this._tree=t,this._childrenToChargeToSelf=new Set,this._extraSelfTimeFromChargedChildren=0,this.copyable=!1,this.addEventListener("populate",this._populate,this),this._updateChildrenForModifiers(),this._recalculateData()}get callingContextTreeNode(){return this._node}displayName(){let e=this._node.name;return e?e==="(program)"?WI.UIString("(program)"):e:WI.UIString("(anonymous function)")}iconClassName(){let e=WI.debuggerManager.scriptForIdentifier(this._node.sourceID,WI.assumingMainTarget());return!e||!e.url?"native-icon":this._node.name==="(program)"?"program-icon":"function-icon"}get data(){return this._data}createCellContent(e,t){switch(e){case"totalTime":return this._totalTimeContent();case"selfTime":return Number.secondsToMillisecondsString(this._data.selfTime);case"function":return this._displayContent()}return super.createCellContent(e,t)}sort(){let e=this.children;e.sort(this._tree._sortComparator);for(let t=0;t<e.length;++t)e[t]._recalculateSiblings(t),e[t].sort()}refresh(){this._updateChildrenForModifiers(),this._recalculateData(),super.refresh()}appendContextMenuItems(e){let t=this===this._tree.currentFocusNode;e.appendItem(WI.UIString("Focus on Subtree"),()=>{this._tree.addFocusNode(this)},t);let i=this._tree.callingContextTree.type===WI.CallingContextTree.Type.BottomUp;e.appendItem(WI.UIString("Charge \u201C%s\u201D to Callers").format(this.displayName()),()=>{this._tree.addModifier({type:WI.ProfileDataGridTree.ModifierType.ChargeToCaller,source:this._node})},i),e.appendSeparator()}filterableDataForColumn(e){if(e==="function"){let t=[this.displayName()],i=WI.debuggerManager.scriptForIdentifier(this._node.sourceID,WI.assumingMainTarget());return i&&i.url&&this._node.line>=0&&this._node.column>=0&&t.push(i.url),t}return super.filterableDataForColumn(e)}_updateChildrenForModifiers(){let e=this._tree.callingContextTree.type===WI.CallingContextTree.Type.BottomUp;if(!this._tree.hasModifiers()||e){if(!this.shouldRefreshChildren&&this._childrenToChargeToSelf.size){for(let i of this._childrenToChargeToSelf)console.assert(i.hasStackTraceInTimeRange(this._tree.startTime,this._tree.endTime)),this.appendChild(new WI.ProfileDataGridNode(i,this._tree));this.sort()}this._extraSelfTimeFromChargedChildren=0,this._childrenToChargeToSelf.clear(),this.hasChildren=this._node.hasChildrenInTimeRange(this._tree.startTime,this._tree.endTime);return}this._extraSelfTimeFromChargedChildren=0,this._childrenToChargeToSelf.clear();let t=!1;if(this._node.forEachChild(i=>{if(i.hasStackTraceInTimeRange(this._tree.startTime,this._tree.endTime))for(let{type:n,source:s}of this._tree.modifiers){if(n===WI.ProfileDataGridTree.ModifierType.ChargeToCaller&&i.equals(s)){this._childrenToChargeToSelf.add(i),this._extraSelfTimeFromChargedChildren+=i.filteredTimestampsAndDuration(this._tree.startTime,this._tree.endTime).duration;continue}t=!0}}),this.hasChildren=t,!this.shouldRefreshChildren&&this._childrenToChargeToSelf.size)for(let i of this.children)this._childrenToChargeToSelf.has(i.callingContextTreeNode)&&this.removeChild(i)}_recalculateData(){let{timestamps:e,duration:t}=this._node.filteredTimestampsAndDuration(this._tree.startTime,this._tree.endTime),{leafTimestamps:i,leafDuration:n}=this._node.filteredLeafTimestampsAndDuration(this._tree.startTime,this._tree.endTime),s=t,a=n+this._extraSelfTimeFromChargedChildren,d=s/this._tree.totalSampleTime;this._data={totalTime:s,selfTime:a,fraction:d}}_totalTimeContent(){let{totalTime:e,fraction:t}=this._data,i=document.createDocumentFragment(),n=i.appendChild(document.createElement("span"));n.classList.add("time"),n.textContent=Number.secondsToMillisecondsString(e);let s=i.appendChild(document.createElement("span"));return s.classList.add("percentage"),s.textContent=Number.percentageString(t),i}_displayContent(){let e=this.displayName(),t=this.iconClassName(),i=document.createDocumentFragment();i.appendChild(document.createElement("img")).classList.add("icon",t);let s=i.appendChild(document.createElement("span"));s.textContent=e;let a=WI.debuggerManager.scriptForIdentifier(this._node.sourceID,WI.assumingMainTarget());if(a&&a.url&&this._node.line>=0&&this._node.column>=0){let d=a.createSourceCodeLocation(this._node.line-1,this._node.column-1),p=i.appendChild(document.createElement("span"));p.classList.add("location"),d.populateLiveDisplayLocationString(p,"textContent",WI.SourceCodeLocation.ColumnStyle.Hidden,WI.SourceCodeLocation.NameStyle.Short);const f={dontFloat:!0,useGoToArrowButton:!0,ignoreNetworkTab:!0,ignoreSearchTab:!0};i.appendChild(WI.createSourceCodeLocationLink(d,f))}return i}_populate(){!this.shouldRefreshChildren||(this.removeEventListener("populate",this._populate,this),this._node.forEachChild(e=>{this._childrenToChargeToSelf.has(e)||e.hasStackTraceInTimeRange(this._tree.startTime,this._tree.endTime)&&this.appendChild(new WI.ProfileDataGridNode(e,this._tree))}),this.sort())}};WI.ProfileDataGridTree=class extends WI.Object{constructor(e,t,i,n){super(),console.assert(e instanceof WI.CallingContextTree),console.assert(typeof n=="function"),this._children=[],this._sortComparator=n,this._callingContextTree=e,this._startTime=t,this._endTime=i,this._totalSampleTime=this._callingContextTree.totalDurationInTimeRange(t,i),this._focusNodes=[],this._modifiers=[],this._repopulate()}static buildSortComparator(e,t){let i=t===WI.DataGrid.SortOrder.Ascending;return function(n,s){let a=n.data[e]-s.data[e];return i?a:-a}}get callingContextTree(){return this._callingContextTree}get focusNodes(){return this._focusNodes}get currentFocusNode(){return this._focusNodes.lastValue}get modifiers(){return this._modifiers}get startTime(){return this._focusNodes.length?this._currentFocusStartTime:this._startTime}get endTime(){return this._focusNodes.length?this._currentFocusEndTime:this._endTime}get totalSampleTime(){return this._focusNodes.length?this._currentFocusTotalSampleTime:this._totalSampleTime}get children(){return this._children}appendChild(e){this._children.push(e)}insertChild(e,t){this._children.splice(t,0,e)}removeChildren(){this._children=[]}set sortComparator(e){this._sortComparator=e,this.sort()}sort(){let e=this._children;e.sort(this._sortComparator);for(let t=0;t<e.length;++t)e[t]._recalculateSiblings(t),e[t].sort()}refresh(){for(let e of this._children)e.refreshRecursively()}addFocusNode(e){console.assert(e instanceof WI.ProfileDataGridNode),this._saveFocusedNodeOriginalParent(e),this._focusNodes.push(e),this._focusChanged()}rollbackFocusNode(e){console.assert(e instanceof WI.ProfileDataGridNode);let t=this._focusNodes.indexOf(e);if(console.assert(t!==-1,"rollbackFocusNode should be rolling back to a previous focused node"),console.assert(t!==this._focusNodes.length-1,"rollbackFocusNode should be rolling back to a previous focused node"),t!==-1){this._focusParentsToExpand=[];for(let i=t+1;i<this._focusNodes.length;++i)this._restoreFocusedNodeToOriginalParent(this._focusNodes[i]);this._focusNodes.splice(t+1),this._focusChanged()}}clearFocusNodes(){this._focusParentsToExpand=[];for(let e of this._focusNodes)this._restoreFocusedNodeToOriginalParent(e);this._focusNodes=[],this._focusChanged()}hasModifiers(){return this._modifiers.length>0}addModifier(e){this._modifiers.push(e),this._modifiersChanged()}clearModifiers(){this._modifiers=[],this._modifiersChanged()}_repopulate(){this.removeChildren(),this._focusNodes.length?this.appendChild(this.currentFocusNode):this._callingContextTree.forEachChild(e=>{e.hasStackTraceInTimeRange(this._startTime,this._endTime)&&this.appendChild(new WI.ProfileDataGridNode(e,this))}),this.sort()}_focusChanged(){let e=this.currentFocusNode;if(e&&this._updateCurrentFocusDetails(e),this._repopulate(),this.dispatchEventToListeners(WI.ProfileDataGridTree.Event.FocusChanged),this._focusParentsToExpand){for(let t of this._focusParentsToExpand)t.expand();this._focusParentsToExpand=null}}_updateCurrentFocusDetails(e){let{timestamps:t,duration:i}=e.callingContextTreeNode.filteredTimestampsAndDuration(this._startTime,this._endTime);this._currentFocusStartTime=t[0],this._currentFocusEndTime=t.lastValue,this._currentFocusTotalSampleTime=i}_saveFocusedNodeOriginalParent(e){e.__previousParent=e.parent,e.__previousParent.removeChild(e)}_restoreFocusedNodeToOriginalParent(e){e.__previousParent.collapse(),this._focusParentsToExpand.push(e.__previousParent),e.__previousParent.appendChild(e),e.__previousParent=void 0}_modifiersChanged(){this.dispatchEventToListeners(WI.ProfileDataGridTree.Event.ModifiersChanged)}};WI.ProfileDataGridTree.Event={FocusChanged:"profile-data-grid-tree-focus-changed",ModifiersChanged:"profile-data-grid-tree-modifiers-changed"};WI.ProfileDataGridTree.ModifierType={ChargeToCaller:"charge"};WI.ProfileNodeDataGridNode=class extends WI.TimelineDataGridNode{constructor(e,t={}){console.assert(e instanceof WI.ProfileNode),t.hasChildren=!!e.childNodes.length,super(null,t),this._profileNode=e,this.addEventListener("populate",this._populate,this)}get profileNode(){return this._profileNode}get data(){if(this._cachedData)return this._cachedData;let e=0,t=0,i=1/0;this.graphDataSource&&(e=this.graphDataSource.zeroTime,t=this.graphDataSource.startTime,i=this.graphDataSource.endTime);let n=this._profileNode.computeCallInfoForTimeRange(t,i);this._cachedData=super.data;for(let s in n)this._cachedData[s]=n[s];return this._cachedData.startTime-=e,this._cachedData.name=this.displayName(),this._cachedData.location=this._profileNode.sourceCodeLocation,this._cachedData}createCellContent(e,t){var n=this.data[e];switch(e){case"name":return t.classList.add(...this.iconClassNames()),n;case"startTime":case"selfTime":case"totalTime":case"averageTime":return isNaN(n)?emDash:Number.secondsToString(n,!0)}return super.createCellContent(e,t)}displayName(){let e=this._profileNode.functionName;if(!e)switch(this._profileNode.type){case WI.ProfileNode.Type.Function:e=WI.UIString("(anonymous function)");break;case WI.ProfileNode.Type.Program:e=WI.UIString("(program)");break;default:e=WI.UIString("(anonymous function)"),console.error("Unknown ProfileNode type: "+this._profileNode.type)}return e}iconClassNames(){let e;switch(this._profileNode.type){case WI.ProfileNode.Type.Function:e=WI.CallFrameView.FunctionIconStyleClassName,this._profileNode.sourceCodeLocation||(e=WI.CallFrameView.NativeIconStyleClassName);break;case WI.ProfileNode.Type.Program:e=WI.TimelineRecordTreeElement.EvaluatedRecordIconStyleClass;break}return console.assert(e),this._profileNode.functionName&&this._profileNode.functionName.startsWith("on")&&this._profileNode.functionName.length>=5&&(e=WI.CallFrameView.EventListenerIconStyleClassName),[e]}_populate(){if(!!this.shouldRefreshChildren){this.removeEventListener("populate",this._populate,this),this.removeChildren();for(let e of this._profileNode.childNodes)this.appendChild(new WI.ProfileNodeDataGridNode(e,{graphDataSource:this.graphDataSource}))}}};WI.ProfileNodeTreeElement=class extends WI.GeneralTreeElement{constructor(e,t){console.assert(e);var i=e.functionName,n="";if(!i)switch(e.type){case WI.ProfileNode.Type.Function:i=WI.UIString("(anonymous function)");break;case WI.ProfileNode.Type.Program:i=WI.UIString("(program)");break;default:i=WI.UIString("(anonymous function)"),console.error("Unknown ProfileNode type: "+e.type)}var s=e.sourceCodeLocation;s&&(n=document.createElement("span"),s.populateLiveDisplayLocationString(n,"textContent"));var a;switch(e.type){case WI.ProfileNode.Type.Function:a=WI.CallFrameView.FunctionIconStyleClassName,s||(a=WI.CallFrameView.NativeIconStyleClassName);break;case WI.ProfileNode.Type.Program:a=WI.TimelineRecordTreeElement.EvaluatedRecordIconStyleClass;break}console.assert(a),e.functionName&&e.functionName.startsWith("on")&&e.functionName.length>=5&&(a=WI.CallFrameView.EventListenerIconStyleClassName),super([a],i,n,e,{hasChildren:!!e.childNodes.length}),this._profileNode=e,this._delegate=t||null,this.shouldRefreshChildren=!0,s&&(this.tooltipHandledSeparately=!0)}get profileNode(){return this._profileNode}get filterableData(){var e=this._profileNode.sourceCodeLocation?this._profileNode.sourceCodeLocation.sourceCode.url:"";return{text:[this.mainTitle,e||""]}}onattach(){if(super.onattach(),console.assert(this.element),!!this.tooltipHandledSeparately){var e=this.mainTitle+`
`;this._profileNode.sourceCodeLocation.populateLiveDisplayLocationTooltip(this.element,e)}}onpopulate(){if(!(!this.hasChildren||!this.shouldRefreshChildren)){if(this.shouldRefreshChildren=!1,this.removeChildren(),this._delegate&&typeof this._delegate.populateProfileNodeTreeElement=="function"){this._delegate.populateProfileNodeTreeElement(this);return}for(var e of this._profileNode.childNodes){var t=new WI.ProfileNodeTreeElement(e);this.appendChild(t)}}}};WI.ProfileView=class extends WI.ContentView{constructor(e,t){super(e),console.assert(e instanceof WI.CallingContextTree),this._startTime=0,this._endTime=1/0,this._callingContextTree=e,this._hoveredDataGridNode=null,this.element.classList.add("profile");let i={totalTime:{title:WI.UIString("Total Time"),width:"120px",sortable:!0,aligned:"right"},selfTime:{title:WI.UIString("Self Time"),width:"75px",sortable:!0,aligned:"right"},function:{title:WI.UIString("Function"),disclosure:!0}};this._dataGrid=new WI.DataGrid(i),this._dataGrid.addEventListener(WI.DataGrid.Event.SortChanged,this._dataGridSortChanged,this),this._dataGrid.addEventListener(WI.DataGrid.Event.SelectedNodeChanged,this._dataGridNodeSelected,this),this._dataGrid.addEventListener(WI.DataGrid.Event.ExpandedNode,this._dataGridNodeExpanded,this),this._dataGrid.element.addEventListener("mouseover",this._mouseOverDataGrid.bind(this)),this._dataGrid.element.addEventListener("mouseleave",this._mouseLeaveDataGrid.bind(this)),this._dataGrid.indentWidth=20,this._dataGrid.sortColumnIdentifier="totalTime",this._dataGrid.sortOrder=WI.DataGrid.SortOrder.Descending,this._dataGrid.createSettings("profile-view"),this._sharedData=t,this.addSubview(this._dataGrid)}get callingContextTree(){return this._callingContextTree}get startTime(){return this._startTime}get endTime(){return this._endTime}get dataGrid(){return this._dataGrid}setStartAndEndTime(e,t){console.assert(e>=0),console.assert(t>=0),console.assert(e<=t),this._startTime=e,this._endTime=t,this._recreate()}hasFocusNodes(){return this._profileDataGridTree?this._profileDataGridTree.focusNodes.length>0:!1}clearFocusNodes(){!this._profileDataGridTree||this._profileDataGridTree.clearFocusNodes()}get scrollableElements(){return[this._dataGrid.scrollContainer]}get selectionPathComponents(){let e=[];if(this._profileDataGridTree)for(let t of this._profileDataGridTree.focusNodes){let i=t.displayName(),n=t.iconClassName(),s=new WI.HierarchicalPathComponent(i,n,t);s.addEventListener(WI.HierarchicalPathComponent.Event.Clicked,this._pathComponentClicked,this),e.push(s)}return e}_recreate(){let e=this.hasFocusNodes(),t=WI.ProfileDataGridTree.buildSortComparator(this._dataGrid.sortColumnIdentifier,this._dataGrid.sortOrder);this._profileDataGridTree=new WI.ProfileDataGridTree(this._callingContextTree,this._startTime,this._endTime,t),this._profileDataGridTree.addEventListener(WI.ProfileDataGridTree.Event.FocusChanged,this._dataGridTreeFocusChanged,this),this._profileDataGridTree.addEventListener(WI.ProfileDataGridTree.Event.ModifiersChanged,this._dataGridTreeModifiersChanged,this),this._repopulateDataGridFromTree(),e&&this.dispatchEventToListeners(WI.ContentView.Event.SelectionPathComponentsDidChange)}_repopulateDataGridFromTree(){this._dataGrid.removeChildren();for(let e of this._profileDataGridTree.children)this._dataGrid.appendChild(e);this._restoreSharedState()}_restoreSharedState(){const t=this._dataGrid,i=!0;if(this._sharedData.selectedNodeHash){let n=this._dataGrid.findNode(s=>s.callingContextTreeNode.hash===this._sharedData.selectedNodeHash,!1,t,i);n&&n.revealAndSelect()}}_pathComponentClicked(e){!e.data.pathComponent||e.data.pathComponent.representedObject===this._profileDataGridTree.currentFocusNode||this._profileDataGridTree.rollbackFocusNode(e.data.pathComponent.representedObject)}_dataGridTreeFocusChanged(e){this._repopulateDataGridFromTree(),this._profileDataGridTree.refresh(),this.dispatchEventToListeners(WI.ContentView.Event.SelectionPathComponentsDidChange)}_dataGridTreeModifiersChanged(e){this._profileDataGridTree.refresh()}_dataGridSortChanged(){!this._profileDataGridTree||(this._profileDataGridTree.sortComparator=WI.ProfileDataGridTree.buildSortComparator(this._dataGrid.sortColumnIdentifier,this._dataGrid.sortOrder),this._repopulateDataGridFromTree())}_dataGridNodeSelected(e){let t=e.data.oldSelectedNode;t&&(this._removeGuidanceElement(WI.ProfileView.GuidanceType.Selected,t),t.forEachChildInSubtree(n=>this._removeGuidanceElement(WI.ProfileView.GuidanceType.Selected,n)));let i=this._dataGrid.selectedNode;i&&(this._removeGuidanceElement(WI.ProfileView.GuidanceType.Selected,i),i.forEachChildInSubtree(n=>this._appendGuidanceElement(WI.ProfileView.GuidanceType.Selected,n,i)),this._sharedData.selectedNodeHash=i.callingContextTreeNode.hash)}_dataGridNodeExpanded(e){let t=e.data.dataGridNode;this._dataGrid.selectedNode&&t.isInSubtreeOfNode(this._dataGrid.selectedNode)&&t.forEachImmediateChild(i=>this._appendGuidanceElement(WI.ProfileView.GuidanceType.Selected,i,this._dataGrid.selectedNode)),this._hoveredDataGridNode&&t.isInSubtreeOfNode(this._hoveredDataGridNode)&&t.forEachImmediateChild(i=>this._appendGuidanceElement(WI.ProfileView.GuidanceType.Hover,i,this._hoveredDataGridNode))}_mouseOverDataGrid(e){let t=this._dataGrid.dataGridNodeFromNode(e.target);t!==this._hoveredDataGridNode&&(this._hoveredDataGridNode&&(this._removeGuidanceElement(WI.ProfileView.GuidanceType.Hover,this._hoveredDataGridNode),this._hoveredDataGridNode.forEachChildInSubtree(i=>this._removeGuidanceElement(WI.ProfileView.GuidanceType.Hover,i))),this._hoveredDataGridNode=t,this._hoveredDataGridNode&&(this._appendGuidanceElement(WI.ProfileView.GuidanceType.Hover,this._hoveredDataGridNode,this._hoveredDataGridNode),this._hoveredDataGridNode.forEachChildInSubtree(i=>this._appendGuidanceElement(WI.ProfileView.GuidanceType.Hover,i,this._hoveredDataGridNode))))}_mouseLeaveDataGrid(e){!this._hoveredDataGridNode||(this._removeGuidanceElement(WI.ProfileView.GuidanceType.Hover,this._hoveredDataGridNode),this._hoveredDataGridNode.forEachChildInSubtree(t=>this._removeGuidanceElement(WI.ProfileView.GuidanceType.Hover,t)),this._hoveredDataGridNode=null)}_guidanceElementKey(e){return"guidance-element-"+e}_removeGuidanceElement(e,t){let i=this._guidanceElementKey(e),n=t.elementWithColumnIdentifier("function");!n||!n[i]||(n[i].remove(),n[i]=null)}_appendGuidanceElement(e,t,i){let n=i.depth,s=n?n*this._dataGrid.indentWidth+1.5:7.5,a=this._guidanceElementKey(e),d=t.elementWithColumnIdentifier("function"),p=d[a]||d.appendChild(document.createElement("div"));d[a]=p,p.classList.add("guidance",e),p.classList.toggle("base",t===i),p.style.left=s+"px"}};WI.ProfileView.GuidanceType={Selected:"selected",Hover:"hover"};WI.ProgressView=class extends WI.View{constructor(e,t){super(),this.element.classList.add("progress-view"),this._title=e||"",this._subtitle=t||"",this._titlesElement=null,this._titleElement=null,this._subtitleElement=null}get title(){return this._title}set title(e){e=e||"",this._title!==e&&(this._title=e,this._updateTitles())}get subtitle(){return this._subtitle}set subtitle(e){e=e||"",this._subtitle!==e&&(this._subtitle=e,this._updateTitles())}get visible(){return this._visible}set visible(e){this._visible!==e&&(this._visible=e,this.element.classList.toggle("hidden",!this._visible))}initialLayout(){super.initialLayout(),this._titlesElement=this.element.appendChild(document.createElement("div")),this._titlesElement.className="titles",this._titleElement=this._titlesElement.appendChild(document.createElement("span")),this._titleElement.className="title",this._subtitleElement=this._titlesElement.appendChild(document.createElement("span")),this._subtitleElement.className="subtitle";let e=new WI.IndeterminateProgressSpinner;this.element.appendChild(e.element),this._updateTitles()}_updateTitles(){!this._titlesElement||(this._titleElement.textContent=this._title,this._titleElement.classList.toggle("hidden",!this._title),this._subtitleElement.textContent=this._subtitle,this._subtitleElement.classList.toggle("hidden",!this._subtitle))}};WI.QuickConsole=class extends WI.View{constructor(e){super(e),this._toggleOrFocusKeyboardShortcut=new WI.KeyboardShortcut(null,WI.KeyboardShortcut.Key.Escape,this._toggleOrFocus.bind(this)),this._toggleOrFocusKeyboardShortcut.implicitlyPreventsDefault=!1,this._automaticExecutionContextPathComponent=this._createExecutionContextPathComponent(null,WI.UIString("Auto")),this._automaticExecutionContextPathComponent.tooltip=WI.UIString("Execution context for $0"),this._mainExecutionContextPathComponent=null,this._otherExecutionContextPathComponents=[],this._frameToPathComponent=new Map,this._targetToPathComponent=new Map,this._shouldAutomaticallySelectExecutionContext=!0,this._restoreSelectedExecutionContextForFrame=!1,this.element.classList.add("quick-console"),this.element.addEventListener("mousedown",this._handleMouseDown.bind(this)),this.element.addEventListener("dragover",this._handleDragOver.bind(this)),this.element.addEventListener("drop",this._handleDrop.bind(this),!0),this.prompt=new WI.ConsolePrompt(null,"text/javascript"),this.addSubview(this.prompt),this.prompt.escapeKeyHandlerWhenEmpty=function(){WI.toggleSplitConsole()},this._navigationBar=new WI.QuickConsoleNavigationBar,this.addSubview(this._navigationBar),this._executionContextSelectorItem=new WI.HierarchicalPathNavigationItem,this._executionContextSelectorItem.showSelectorArrows=!0,this._navigationBar.addNavigationItem(this._executionContextSelectorItem),this._executionContextSelectorDivider=new WI.DividerNavigationItem,this._navigationBar.addNavigationItem(this._executionContextSelectorDivider),this.initializeMainExecutionContextPathComponent(),WI.consoleDrawer.toggleButtonShortcutTooltip(this._toggleOrFocusKeyboardShortcut),WI.consoleDrawer.addEventListener(WI.ConsoleDrawer.Event.CollapsedStateChanged,this._updateStyles,this),WI.Frame.addEventListener(WI.Frame.Event.PageExecutionContextChanged,this._framePageExecutionContextsChanged,this),WI.Frame.addEventListener(WI.Frame.Event.ExecutionContextsCleared,this._frameExecutionContextsCleared,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.ActiveCallFrameDidChange,this._debuggerActiveCallFrameDidChange,this),WI.runtimeManager.addEventListener(WI.RuntimeManager.Event.ActiveExecutionContextChanged,this._activeExecutionContextChanged,this),WI.targetManager.addEventListener(WI.TargetManager.Event.TargetAdded,this._targetAdded,this),WI.targetManager.addEventListener(WI.TargetManager.Event.TargetRemoved,this._targetRemoved,this),WI.domManager.addEventListener(WI.DOMManager.Event.InspectedNodeChanged,this._handleInspectedNodeChanged,this),WI.TabBrowser.addEventListener(WI.TabBrowser.Event.SelectedTabContentViewDidChange,this._updateStyles,this)}get navigationBar(){return this._navigationBar}closed(){WI.Frame.removeEventListener(null,null,this),WI.debuggerManager.removeEventListener(null,null,this),WI.runtimeManager.removeEventListener(null,null,this),WI.targetManager.removeEventListener(null,null,this),WI.consoleDrawer.removeEventListener(null,null,this),WI.TabBrowser.removeEventListener(null,null,this),super.closed()}initializeMainExecutionContextPathComponent(){!WI.mainTarget||!WI.mainTarget.executionContext||(this._mainExecutionContextPathComponent=this._createExecutionContextPathComponent(WI.mainTarget.executionContext),this._mainExecutionContextPathComponent.previousSibling=this._automaticExecutionContextPathComponent,this._automaticExecutionContextPathComponent.nextSibling=this._mainExecutionContextPathComponent,this._shouldAutomaticallySelectExecutionContext=!0,this._selectExecutionContext(WI.mainTarget.executionContext),this._rebuildExecutionContextPathComponents())}layout(){let e=Math.round(window.innerHeight*.33);this.prompt.element.style.maxHeight=e+"px"}_preferredNameForFrame(e){return e.name?WI.UIString("%s (%s)").format(e.name,e.mainResource.displayName):e.mainResource.displayName}_selectExecutionContext(e){let t=null,i=WI.domManager.inspectedNode;if(i){let n=i.frame;n&&(this._shouldAutomaticallySelectExecutionContext&&(e=n.pageExecutionContext),t=this._preferredNameForFrame(n))}console.assert(e),e||(e=WI.mainTarget.executionContext),WI.runtimeManager.activeExecutionContext=e,this._automaticExecutionContextPathComponent.displayName=WI.UIString("Auto - %s").format(t||e.name)}_handleMouseDown(e){e.target===this.element&&(e.preventDefault(),this.prompt.focus())}_handleDragOver(e){e.dataTransfer.types.includes(WI.DOMTreeOutline.DOMNodeIdDragType)&&(e.preventDefault(),e.dataTransfer.dropEffect="copy")}_handleDrop(e){let t=e.dataTransfer.getData(WI.DOMTreeOutline.DOMNodeIdDragType);if(t){e.preventDefault();let i=WI.domManager.nodeForId(t);WI.RemoteObject.resolveNode(i,WI.RuntimeManager.ConsoleObjectGroup).then(n=>{let s=i.nodeType()===Node.ELEMENT_NODE?WI.UIString("Dropped Element"):WI.UIString("Dropped Node");const a=!0;WI.consoleLogViewController.appendImmediateExecutionWithResult(s,n,a),this.prompt.focus()})}}_executionContextPathComponentsToDisplay(){return WI.debuggerManager.activeCallFrame?[]:this._otherExecutionContextPathComponents.length?this._shouldAutomaticallySelectExecutionContext?[this._automaticExecutionContextPathComponent]:WI.runtimeManager.activeExecutionContext===WI.mainTarget.executionContext?[this._mainExecutionContextPathComponent]:this._otherExecutionContextPathComponents.filter(e=>e.representedObject===WI.runtimeManager.activeExecutionContext):[]}_rebuildExecutionContextPathComponents(){let e=this._executionContextPathComponentsToDisplay(),t=!e.length;this._executionContextSelectorItem.element.classList.toggle("automatic-execution-context",this._shouldAutomaticallySelectExecutionContext),this._executionContextSelectorItem.components=e,this._executionContextSelectorItem.hidden=t,this._executionContextSelectorDivider.hidden=t}_framePageExecutionContextsChanged(e){let t=e.target,i=this._insertExecutionContextPathComponentForFrame(t);this._restoreSelectedExecutionContextForFrame===t&&(this._restoreSelectedExecutionContextForFrame=null,this._selectExecutionContext(i.representedObject))}_frameExecutionContextsCleared(e){let t=e.target;if(e.data.committingProvisionalLoad&&!this._restoreSelectedExecutionContextForFrame){let i=this._frameToPathComponent.get(t);i&&i.representedObject===WI.runtimeManager.activeExecutionContext&&(this._restoreSelectedExecutionContextForFrame=t,setTimeout(()=>{this._restoreSelectedExecutionContextForFrame=!1},10))}this._removeExecutionContextPathComponentForFrame(t)}_activeExecutionContextChanged(e){this._rebuildExecutionContextPathComponents()}_createExecutionContextPathComponent(e,t){console.assert(!e||e instanceof WI.ExecutionContext);let i=new WI.HierarchicalPathComponent(t||e.name,"execution-context",e,!0,!0);return i.addEventListener(WI.HierarchicalPathComponent.Event.SiblingWasSelected,this._pathComponentSelected,this),i.addEventListener(WI.HierarchicalPathComponent.Event.Clicked,this._pathComponentClicked,this),i.truncatedDisplayNameLength=50,i}_compareExecutionContextPathComponents(e,t){let i=e.representedObject,n=t.representedObject,s=i.target!==WI.mainTarget,a=n.target!==WI.mainTarget;return s&&!a?-1:a&&!s?1:s&&a?e.displayName.extendedLocaleCompare(t.displayName):i===WI.mainTarget.executionContext?-1:n===WI.mainTarget.executionContext?1:(console.assert(i.frame),console.assert(n.frame),i.frame.name&&!n.frame.name?-1:!i.frame.name&&n.frame.name?1:e.displayName.extendedLocaleCompare(t.displayName))}_insertOtherExecutionContextPathComponent(e){let t=insertionIndexForObjectInListSortedByFunction(e,this._otherExecutionContextPathComponents,this._compareExecutionContextPathComponents),i=t>0?this._otherExecutionContextPathComponents[t-1]:this._mainExecutionContextPathComponent,n=this._otherExecutionContextPathComponents[t]||null;i&&(i.nextSibling=e,e.previousSibling=i),n&&(n.previousSibling=e,e.nextSibling=n),this._otherExecutionContextPathComponents.splice(t,0,e),this._rebuildExecutionContextPathComponents()}_removeOtherExecutionContextPathComponent(e){e.removeEventListener(WI.HierarchicalPathComponent.Event.SiblingWasSelected,this._pathComponentSelected,this),e.removeEventListener(WI.HierarchicalPathComponent.Event.Clicked,this._pathComponentClicked,this);let t=e.previousSibling,i=e.nextSibling;t&&(t.nextSibling=i),i&&(i.previousSibling=t),this._otherExecutionContextPathComponents.remove(e,!0),this._rebuildExecutionContextPathComponents()}_insertExecutionContextPathComponentForFrame(e){if(e.isMainFrame())return this._mainExecutionContextPathComponent;let t=this._createExecutionContextPathComponent(e.pageExecutionContext,this._preferredNameForFrame(e));return this._insertOtherExecutionContextPathComponent(t),this._frameToPathComponent.set(e,t),t}_removeExecutionContextPathComponentForFrame(e){if(e.isMainFrame()){this._shouldAutomaticallySelectExecutionContext=!0;return}let t=this._frameToPathComponent.take(e);this._removeOtherExecutionContextPathComponent(t)}_targetAdded(e){let t=e.data.target;if(t.type!==WI.Target.Type.Worker)return;console.assert(t.type===WI.Target.Type.Worker);let i=WI.UIString("Worker \u2014 %s").format(t.displayName),n=this._createExecutionContextPathComponent(t.executionContext,i);this._targetToPathComponent.set(t,n),this._insertOtherExecutionContextPathComponent(n)}_targetRemoved(e){let t=e.data.target;if(t.type!==WI.Target.Type.Worker)return;let i=this._targetToPathComponent.take(t);WI.runtimeManager.activeExecutionContext===i.representedObject&&(this._shouldAutomaticallySelectExecutionContext=!0,this._selectExecutionContext()),this._removeOtherExecutionContextPathComponent(i)}_pathComponentSelected(e){this._shouldAutomaticallySelectExecutionContext=e.data.pathComponent===this._automaticExecutionContextPathComponent,this._selectExecutionContext(e.data.pathComponent.representedObject)}_pathComponentClicked(e){this.prompt.focus()}_debuggerActiveCallFrameDidChange(e){this._rebuildExecutionContextPathComponents()}_toggleOrFocus(e){this.prompt.focused?(WI.toggleSplitConsole(),e.preventDefault()):!WI.isEditingAnyField()&&!WI.isEventTargetAnEditableField(e)&&(this.prompt.focus(),e.preventDefault())}_updateStyles(){this.element.classList.toggle("showing-log",WI.isShowingConsoleTab()||WI.isShowingSplitConsole())}_handleInspectedNodeChanged(e){this._selectExecutionContext(WI.runtimeManager.activeExecutionContext)}};WI.QuickConsoleNavigationBar=class extends WI.NavigationBar{get sizesToFit(){return!0}addNavigationItem(e){return this.insertNavigationItem(e,0)}};WI.RadioButtonNavigationItem=class extends WI.ButtonNavigationItem{constructor(e,t,i,n,s){super(e,t,i,n,s,null,"tab"),this._initializedMinWidth=!1}get selected(){return this.element.classList.contains(WI.RadioButtonNavigationItem.SelectedStyleClassName)}set selected(e){e?(this.element.classList.add(WI.RadioButtonNavigationItem.SelectedStyleClassName),this.element.setAttribute("aria-selected","true")):(this.element.classList.remove(WI.RadioButtonNavigationItem.SelectedStyleClassName),this.element.setAttribute("aria-selected","false"))}get active(){return this.element.classList.contains(WI.RadioButtonNavigationItem.ActiveStyleClassName)}set active(e){this.element.classList.toggle(WI.RadioButtonNavigationItem.ActiveStyleClassName,e)}updateLayout(e){if(super.updateLayout(e),!e){var t=this.selected;if(t||(this.element.classList.add(WI.RadioButtonNavigationItem.SelectedStyleClassName),this.element.setAttribute("aria-selected","true")),!this._initializedMinWidth){var i=this.element.offsetWidth;i&&(this._initializedMinWidth=!0,this.element.style.minWidth=i+"px")}t||(this.element.classList.remove(WI.RadioButtonNavigationItem.SelectedStyleClassName),this.element.setAttribute("aria-selected","false"))}}get additionalClassNames(){return["radio","button"]}};WI.RadioButtonNavigationItem.StyleClassName="radio";WI.RadioButtonNavigationItem.ActiveStyleClassName="active";WI.RadioButtonNavigationItem.SelectedStyleClassName="selected";WI.RangeChart=class extends WI.View{constructor(){super(),this.element.classList.add("range-chart"),this._svgElement=this.element.appendChild(createSVGElement("svg")),this._svgElement.setAttribute("preserveAspectRatio","none"),this._ranges=[],this._size=null}get size(){return this._size}set size(e){this._size&&this._size.equals(e)||(this._size=e,this._svgElement.setAttribute("viewBox",`0 0 ${e.width} ${e.height}`))}addRange(e,t,i){this._ranges.push({x:e,width:t,className:i})}clear(){this._ranges=[]}layout(){if(super.layout(),this.layoutReason===WI.View.LayoutReason.Resize||!this._size)return;this._svgElement.removeChildren();let e=this.size.height;for(let{x:t,width:i,className:n}of this._ranges){let s=this._svgElement.appendChild(createSVGElement("rect"));s.setAttribute("width",i),s.setAttribute("height",e),s.setAttribute("x",t),s.classList.add(n)}}};WI.RecordingActionTreeElement=class extends WI.GeneralTreeElement{constructor(e,t,i){console.assert(e instanceof WI.RecordingAction);let{titleFragment:n,copyText:s}=WI.RecordingActionTreeElement._generateDOM(e,i),a=WI.RecordingActionTreeElement._getClassNames(e);const d=null;super(a,n,d,e),this._index=t,this._copyText=s,this.representedObject.valid&&this.representedObject.addEventListener(WI.RecordingAction.Event.ValidityChanged,this._handleValidityChanged,this)}static _generateDOM(e,t){let i=e.parameters.length;function n(M,L,V){let H=document.createElement("span");switch(H.classList.add("parameter"),L){case WI.Recording.Swizzle.Number:var O=WI.RecordingAction.constantNameForParameter(t,e.name,M,V,i);O?(H.classList.add("constant"),H.textContent="context."+O):H.textContent=M.maxDecimals(2);break;case WI.Recording.Swizzle.Boolean:H.textContent=M;break;case WI.Recording.Swizzle.String:H.textContent=JSON.stringify(M);break;case WI.Recording.Swizzle.Array:H.classList.add("swizzled"),H.textContent=JSON.stringify(M);break;case WI.Recording.Swizzle.TypedArray:case WI.Recording.Swizzle.Image:case WI.Recording.Swizzle.ImageBitmap:case WI.Recording.Swizzle.ImageData:case WI.Recording.Swizzle.DOMMatrix:case WI.Recording.Swizzle.Path2D:case WI.Recording.Swizzle.CanvasGradient:case WI.Recording.Swizzle.CanvasPattern:case WI.Recording.Swizzle.WebGLBuffer:case WI.Recording.Swizzle.WebGLFramebuffer:case WI.Recording.Swizzle.WebGLRenderbuffer:case WI.Recording.Swizzle.WebGLTexture:case WI.Recording.Swizzle.WebGLShader:case WI.Recording.Swizzle.WebGLProgram:case WI.Recording.Swizzle.WebGLUniformLocation:case WI.Recording.Swizzle.WebGLQuery:case WI.Recording.Swizzle.WebGLSampler:case WI.Recording.Swizzle.WebGLSync:case WI.Recording.Swizzle.WebGLTransformFeedback:case WI.Recording.Swizzle.WebGLVertexArrayObject:H.classList.add("swizzled"),H.textContent=WI.Recording.displayNameForSwizzleType(L);break}return H.textContent||(H.classList.add("invalid"),H.textContent=L===WI.Recording.Swizzle.None?M:WI.Recording.displayNameForSwizzleType(L)),H}let s=document.createDocumentFragment(),a=e.name,d=e.contextReplacer;if(d){a=d+"."+a;let M=s.appendChild(document.createElement("span"));M.classList.add("context-replacer"),M.textContent=d}let p=s.appendChild(document.createElement("span"));if(p.classList.add("name"),p.textContent=e.name,!i)return{titleFragment:s,copyText:a};let f=s.appendChild(document.createElement("span"));f.classList.add("parameters"),e.isFunction?a+="(":a+=" = ";for(let M=0;M<i;++M){let L=e.parameters[M],V=e.swizzleTypes[M],H=n(L,V,M);f.appendChild(H),M&&(a+=", "),a+=H.textContent}e.isFunction&&(a+=")");let _=e.getColorParameters();if(_.length){let M=WI.RecordingActionTreeElement._createSwatchForColorParameters(_);if(M){let L=e.parameters.indexOf(_[0]);f.insertBefore(M.element,f.children[L])}}let b=e.getImageParameters(),w=b[0]instanceof HTMLImageElement,S=b[0]instanceof ImageBitmap,E=b[0]instanceof ImageData,k=b[0]instanceof CanvasGradient,R=b[0]instanceof CanvasPattern;if(b.length&&(w||S||E||k||R)){let M=b[0];if(S?M=WI.ImageUtilities.imageFromImageBitmap(M):E?M=WI.ImageUtilities.imageFromImageData(M):k?M=WI.ImageUtilities.imageFromCanvasGradient(M,100,100):R&&(M=M.__image),M){let L=new WI.InlineSwatch(WI.InlineSwatch.Type.Image,M),V=e.parameters.indexOf(b[0]),H=f.children[V];f.insertBefore(L.element,H)}}return{titleFragment:s,copyText:a}}static _createSwatchForColorParameters(e){let t=[],i=null;switch(e.length){case 1:case 2:typeof e[0]=="string"?i=WI.Color.fromString(e[0].trim()):isNaN(e[0])||(t=WI.Color.normalized2rgb(e[0],e[0],e[0]));break;case 4:t=WI.Color.normalized2rgb(e[0],e[1],e[2]);break;case 5:t=WI.Color.cmyk2rgb(...e);break;default:return console.error("Unexpected number of color parameters."),null}if(!i){if(t.length!==3)return null;let s=e.length===1?1:e.lastValue;if(i=new WI.Color(WI.Color.Format.RGBA,[...t,s]),!i)return null}const n=!0;return new WI.InlineSwatch(WI.InlineSwatch.Type.Color,i,n)}static _getClassNames(e){let t=["recording-action"];if(e instanceof WI.RecordingInitialStateAction)return t.push("initial-state"),t;e.isFunction||t.push("attribute");let i=WI.RecordingActionTreeElement._classNameForAction(e);return i.length&&t.push(i),e.isVisual&&t.push("visual"),e.valid||t.push("invalid"),t}static _classNameForAction(e){if(e.contextReplacer)return"has-context-replacer";switch(e.name){case"arc":case"arcTo":return"arc";case"globalAlpha":case"globalCompositeOperation":case"setAlpha":case"setGlobalAlpha":case"setCompositeOperation":case"setGlobalCompositeOperation":return"composite";case"bezierCurveTo":case"quadraticCurveTo":return"curve";case"clearRect":case"fill":case"fillRect":case"fillText":return"fill";case"createImageData":case"drawFocusIfNeeded":case"drawImage":case"drawImageFromRect":case"filter":case"getImageData":case"imageSmoothingEnabled":case"imageSmoothingQuality":case"putImageData":case"transferFromImageBitmap":case"webkitImageSmoothingEnabled":return"image";case"getLineDash":case"lineCap":case"lineDashOffset":case"lineJoin":case"lineWidth":case"miterLimit":case"setLineCap":case"setLineDash":case"setLineJoin":case"setLineWidth":case"setMiterLimit":case"webkitLineDash":case"webkitLineDashOffset":return"line-style";case"closePath":case"lineTo":return"line-to";case"beginPath":case"moveTo":return"move-to";case"isPointInPath":return"point-in-path";case"isPointInStroke":return"point-in-stroke";case"clearShadow":case"setShadow":case"shadowBlur":case"shadowColor":case"shadowOffsetX":case"shadowOffsetY":return"shadow";case"createLinearGradient":case"createPattern":case"createRadialGradient":case"fillStyle":case"setFillColor":case"setStrokeColor":case"strokeStyle":return"style";case"stroke":case"strokeRect":case"strokeText":return"stroke";case"direction":case"font":case"measureText":case"textAlign":case"textBaseline":return"text";case"getTransform":case"resetTransform":case"rotate":case"scale":case"setTransform":case"transform":case"translate":return"transform";case"clip":case"ellipse":case"rect":case"restore":case"save":return e.name}return"name-unknown"}get index(){return this._index}get filterableData(){let e=[];function t(i){typeof i=="string"?e.push(i):i instanceof Node&&e.push(i.textContent)}return t(this._mainTitleElement||this._mainTitle),t(this._subtitleElement||this._subtitle),{text:e}}customTitleTooltip(){return this._copyText}onattach(){super.onattach(),this.element.dataset.index=this._index.toLocaleString(),this.representedObject.valid&&this.representedObject.warning&&(this.addClassName("warning"),this.status=WI.ImageUtilities.useSVGSymbol("data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2013 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 10 10'%3e %3cpath fill='white' d='M 4 2 L 6.195312 2 L 6.195312 8.996094 L 4 8.996094 Z'/%3e %3cpath fill='rgb(246%2c 187%2c 14)' d='M 9.851562 9.453125 C 9.574219 9.859375 9.007812 9.996094 8.632812 9.996094 C 8.398438 9.996094 1.59375 9.996094 1.367188 9.996094 C 0.992188 9.996094 0.425781 9.859375 0.148438 9.453125 C -0.109375 9.074219 0.03125 8.410156 0.230469 8.046875 C 1.351562 6.027344 2.4375 3.722656 4.023438 0.707031 C 4.535156 -0.265625 5.542969 -0.195312 6.003906 0.695312 C 7.105469 2.832031 8.648438 6.027344 9.769531 8.046875 C 9.96875 8.410156 10.109375 9.074219 9.851562 9.453125 Z M 6 3 C 6 2.449219 5.550781 2 5 2 C 4.449219 2 4 2.449219 4 3 L 4 5 C 4 5.550781 4.449219 6 5 6 C 5.550781 6 6 5.550781 6 5 Z M 5 7 C 4.449219 7 4 7.449219 4 8 C 4 8.550781 4.449219 9 5 9 C 5.550781 9 6 8.550781 6 8 C 6 7.449219 5.550781 7 5 7 Z'/%3e %3c/svg%3e","warning",this.representedObject.warning))}populateContextMenu(e,t){e.appendItem(WI.UIString("Copy Action"),()=>{InspectorFrontendHost.copyText("context."+this._copyText+";")}),e.appendSeparator();let i=null;for(let n of this.representedObject.trace)if(n.sourceCodeLocation){i=n.sourceCodeLocation;break}if(i){let n=null;WI.settings.experimentalEnableSourcesTab.value?n=WI.UIString("Reveal in Sources Tab"):n=WI.UIString("Reveal in Resources Tab"),e.appendItem(n,()=>{WI.showSourceCodeLocation(i,{ignoreNetworkTab:!0,ignoreSearchTab:!0})}),e.appendSeparator()}super.populateContextMenu(e,t)}_handleValidityChanged(e){this.addClassName("invalid"),this.representedObject.removeEventListener(null,null,this)}};WI.RecordingContentView=class extends WI.ContentView{constructor(e){console.assert(e instanceof WI.Recording),super(e);let t=this.representedObject.type===WI.Recording.Type.Canvas2D,i=this.representedObject.type===WI.Recording.Type.CanvasBitmapRenderer,n=this.representedObject.type===WI.Recording.Type.CanvasWebGL,s=this.representedObject.type===WI.Recording.Type.CanvasWebGL2;this._index=NaN,this._action=null,this._snapshots=[],this._initialContent=null,this._generateContentThrottler=new Throttler(()=>{t?this._generateContentCanvas2D(this._index):(i||n||s)&&this._generateContentFromSnapshot(this._index)},200),this.element.classList.add("recording",this.representedObject.type),(t||i||n||s)&&(t&&WI.ImageUtilities.supportsCanvasPathDebugging()&&(this._pathContext=null,this._showPathButtonNavigationItem=new WI.ActivateButtonNavigationItem("show-path",WI.UIString("Show Path"),WI.UIString("Hide Path"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3ccircle stroke='currentColor' fill='none' cx='3' cy='13' r='1.5'/%3e %3ccircle stroke='currentColor' fill='none' cx='13' cy='3' r='1.5'/%3e %3cpath stroke='currentColor' fill='none' d='M 3 12 S 3 2 8 8 c 5.44 6.52 5 -4 5 -4'/%3e %3c/svg%3e",16,16),this._showPathButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._showPathButtonClicked,this),this._showPathButtonNavigationItem.activated=!!WI.settings.showCanvasPath.value),this._showGridButtonNavigationItem=new WI.ActivateButtonNavigationItem("show-grid",WI.UIString("Show Grid"),WI.UIString("Hide Grid"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 13'%3e %3crect fill='none' stroke='currentColor' stroke-width='1' x='0.5' y='0.5' width='12' height='12'/%3e %3crect fill='currentColor' opacity='0.5' x='1' y='1' width='5.5' height='5.5'/%3e %3crect fill='currentColor' opacity='0.5' x='6.5' y='6.5' width='5.5' height='5.5'/%3e %3c/svg%3e",13,13),this._showGridButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._showGridButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._showGridButtonClicked,this),this._showGridButtonNavigationItem.activated=!!WI.settings.showImageGrid.value,this._exportButtonNavigationItem=new WI.ButtonNavigationItem("export-recording",WI.UIString("Export"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' d='M 7.5 2 v 7.5'/%3e %3cpath fill='none' stroke='currentColor' d='M 4.5 5 l 3 -3 l 3 3'/%3e %3cpolyline fill='none' stroke='currentColor' points='12.5 9 12.5 12.5 2.5 12.5 2.5 9'/%3e %3c/svg%3e",15,15),this._exportButtonNavigationItem.buttonStyle=WI.ButtonNavigationItem.Style.ImageAndText,this._exportButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.High,this._exportButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._handleExportNavigationItemClicked,this),this._updateExportButton())}get navigationItems(){let e=this.representedObject.type===WI.Recording.Type.Canvas2D,t=this.representedObject.type===WI.Recording.Type.CanvasBitmapRenderer,i=this.representedObject.type===WI.Recording.Type.CanvasWebGL,n=this.representedObject.type===WI.Recording.Type.CanvasWebGL2;if(!e&&!t&&!i&&!n)return[];let s=[this._exportButtonNavigationItem,new WI.DividerNavigationItem];return e&&WI.ImageUtilities.supportsCanvasPathDebugging()&&s.push(this._showPathButtonNavigationItem),s.push(this._showGridButtonNavigationItem),s}get supplementalRepresentedObjects(){return this._action?[this._action]:[]}updateActionIndex(e){!this.representedObject||this._index!==e&&(console.assert(e>=0&&e<this.representedObject.actions.length),!(e<0||e>=this.representedObject.actions.length)&&(this._index=e,this._updateSliderValue(),this.didInitialLayout&&this._generateContentThrottler.fire(),this._action=this.representedObject.actions[this._index],this.dispatchEventToListeners(WI.ContentView.Event.SupplementalRepresentedObjectsDidChange)))}shown(){super.shown();let e=this.representedObject.type===WI.Recording.Type.Canvas2D,t=this.representedObject.type===WI.Recording.Type.CanvasBitmapRenderer,i=this.representedObject.type===WI.Recording.Type.CanvasWebGL,n=this.representedObject.type===WI.Recording.Type.CanvasWebGL2;(e||t||i||n)&&(e&&this._updateCanvasPath(),this._updateImageGrid())}hidden(){super.hidden(),this._generateContentThrottler.cancel()}get supportsSave(){return!0}get saveData(){return{customSaveHandler:()=>{this._exportRecording()}}}initialLayout(){let t=this.element.appendChild(document.createElement("header")).appendChild(document.createElement("div"));t.className="slider-container",this._previewContainer=this.element.appendChild(document.createElement("div")),this._previewContainer.className="preview-container",this._sliderValueElement=t.appendChild(document.createElement("div")),this._sliderValueElement.className="slider-value",this._sliderElement=t.appendChild(document.createElement("input")),this._sliderElement.addEventListener("input",this._sliderChanged.bind(this)),this._sliderElement.type="range",this._sliderElement.min=0,this._sliderElement.max=0,this.representedObject.ready||(this.representedObject.addEventListener(WI.Recording.Event.ProcessedAction,this._handleRecordingProcessedAction,this),this.representedObject.processing||this.representedObject.startProcessing()),this._updateSliderValue(),isNaN(this._index)||this._generateContentThrottler.fire()}_exportRecording(){let e=this.representedObject.displayName;WI.FileUtilities.save({url:WI.FileUtilities.inspectorURLForFilename(e+".json"),content:JSON.stringify(this.representedObject.toJSON()),forceSaveAs:!0})}_exportReduction(){if(!this.representedObject.ready){InspectorFrontendHost.beep();return}let e=this.representedObject.displayName;WI.FileUtilities.save({url:WI.FileUtilities.inspectorURLForFilename(e+".html"),content:this.representedObject.toHTML(),forceSaveAs:!0})}_generateContentCanvas2D(e){let t=_=>{e===this._index&&this._generateContentCanvas2D(e)},i=this.representedObject.initialState;if(i.content&&!this._initialContent){this._initialContent=new Image,this._initialContent.src=i.content,this._initialContent.addEventListener("load",t);return}let n=Math.floor(e/WI.RecordingContentView.SnapshotInterval),s=this._snapshots[n],a=WI.ImageUtilities.supportsCanvasPathDebugging()&&WI.settings.showCanvasPath.value,d=1/0,p=this.representedObject.actions,f=(_,b,w)=>{let S=0;s.context.save();for(let M in s.attributes)s.element[M]=s.attributes[M];s.content&&(s.context.clearRect(0,0,s.element.width,s.element.height),s.context.drawImage(s.content,0,0));for(let M of s.states)M.apply(this.representedObject.type,s.context),++S,s.context.save();let E={},k={};for(let M=_;M<=b;++M){if(p[M].name==="save")++S;else if(p[M].name==="restore"&&!S)continue;p[M].apply(s.context)}if(a&&d<=b){let M=function(L){switch(L.name){case"arc":case"arcTo":case"beginPath":case"bezierCurveTo":case"closePath":case"ellipse":case"lineTo":case"moveTo":case"quadraticCurveTo":case"rect":return!0}return!1};var R=M;if(!this._pathContext){let L=document.createElement("canvas");L.classList.add("path"),this._pathContext=L.getContext("2d")}this._pathContext.canvas.width=s.element.width,this._pathContext.canvas.height=s.element.height,this._pathContext.clearRect(0,0,s.element.width,s.element.height),this._pathContext.save(),this._pathContext.fillStyle="hsla(0, 0%, 100%, 0.75)",this._pathContext.fillRect(0,0,s.element.width,s.element.height);for(let L=d;L<=b;++L){if(!M(p[L]))continue;E={x:this._pathContext.currentX,y:this._pathContext.currentY},L===d&&this._pathContext.setTransform(s.context.getTransform());let V=p[L].name==="moveTo";this._pathContext.lineWidth=V?.5:1,this._pathContext.setLineDash(V?[5,5]:[]),this._pathContext.strokeStyle=L===b?"red":"black",this._pathContext.beginPath(),isEmptyObject(E)||this._pathContext.moveTo(E.x,E.y),p[L].name==="closePath"&&!isEmptyObject(k)?(this._pathContext.lineTo(k.x,k.y),k={}):(p[L].apply(this._pathContext,{nameOverride:V?"lineTo":null}),V&&(k={x:this._pathContext.currentX,y:this._pathContext.currentY})),this._pathContext.stroke()}this._pathContext.restore(),this._previewContainer.appendChild(this._pathContext.canvas)}else this._pathContext&&this._pathContext.canvas.remove();for(s.context.restore();S-- >0;)s.context.restore()};if(!s){for(s=this._snapshots[n]={},s.index=n*WI.RecordingContentView.SnapshotInterval;s.index&&p[s.index].name!=="beginPath";)--s.index;s.context=this.representedObject.createContext(),s.element=s.context.canvas;let _=n;for(;--_>=0&&!this._snapshots[_];);let b=0;if(_<0)s.content=this._initialContent,s.states=p[0].states,s.attributes=Object.shallowCopy(i.attributes);else{let w=this._snapshots[_];s.content=w.content,s.states=w.states,s.attributes={};for(let S in i.attributes)s.attributes[S]=w.element[S];b=w.index}f(b,s.index-1),s.index>0&&(s.states=p[s.index-1].states),s.content=new Image,s.content.src=s.element.toDataURL(),s.content.addEventListener("load",t);return}if(this._previewContainer.removeChildren(),a)for(d=this._index;d>s.index&&p[d].name!=="beginPath";)--d;f(s.index,this._index),this._previewContainer.insertAdjacentElement("afterbegin",s.element),this._updateImageGrid()}_generateContentFromSnapshot(e){let t=d=>{e===this._index&&this._generateContentFromSnapshot(e)},i=this.representedObject.initialState;if(i.content&&!this._initialContent){this._initialContent=new Image,this._initialContent.src=i.content,this._initialContent.addEventListener("load",t);return}let n=this.representedObject.actions,s=e;for(;!n[s].isVisual&&!(n[s]instanceof WI.RecordingInitialStateAction);)s--;let a=this._snapshots[s];if(!a){if(n[s].snapshot){a=this._snapshots[s]={element:new Image},a.element.src=n[s].snapshot,a.element.addEventListener("load",t);return}n[s]instanceof WI.RecordingInitialStateAction&&(a=this._snapshots[s]={element:this._initialContent})}a&&(this._previewContainer.removeChildren(),this._previewContainer.appendChild(a.element),this._updateImageGrid())}_updateExportButton(){this.representedObject.type===WI.Recording.Type.Canvas2D&&this.representedObject.ready?this._exportButtonNavigationItem.tooltip=WI.UIString(`Export recording (%s)
Shift-click to export a HTML reduction`).format(WI.saveKeyboardShortcut.displayName):this._exportButtonNavigationItem.tooltip=WI.UIString("Export recording (%s)").format(WI.saveKeyboardShortcut.displayName)}_updateCanvasPath(){let e=WI.settings.showCanvasPath.value;this._showPathButtonNavigationItem.activated!==e&&this._generateContentCanvas2D(this._index),this._showPathButtonNavigationItem.activated=e}_updateImageGrid(){let e=WI.settings.showImageGrid.value;this._showGridButtonNavigationItem.activated=e,this.didInitialLayout&&!isNaN(this._index)&&this._previewContainer.firstElementChild.classList.toggle("show-grid",e)}_updateSliderValue(){if(!this._sliderElement)return;let e=this.representedObject.visualActionIndexes,t=0;if(this._index>0)for(;t<e.length&&e[t]<=this._index;)t++;this._sliderElement.value=t,this._sliderElement.max=e.length,this._sliderValueElement.textContent=WI.UIString("%d of %d").format(t,e.length)}_showPathButtonClicked(e){WI.settings.showCanvasPath.value=!this._showPathButtonNavigationItem.activated,this._updateCanvasPath()}_showGridButtonClicked(e){WI.settings.showImageGrid.value=!this._showGridButtonNavigationItem.activated,this._updateImageGrid()}_handleExportNavigationItemClicked(e){e.data.nativeEvent.shiftKey&&this.representedObject.type===WI.Recording.Type.Canvas2D&&this.representedObject.ready?this._exportReduction():this._exportRecording()}_sliderChanged(){let e=0,t=parseInt(this._sliderElement.value)-1;t!==-1&&(e=this.representedObject.visualActionIndexes[t]),this.updateActionIndex(e)}_handleRecordingProcessedAction(e){this._updateExportButton(),this._updateSliderValue(),this.representedObject.ready&&this.representedObject.removeEventListener(null,null,this)}};WI.RecordingContentView.SnapshotInterval=5e3;WI.RecordingStateDetailsSidebarPanel=class extends WI.DetailsSidebarPanel{constructor(){super("recording-state",WI.UIString("State")),this._recording=null,this._action=null,this._dataGrids=[]}inspect(e){return e instanceof Array||(e=[e]),this.recording=e.find(t=>t instanceof WI.Recording&&t.type===WI.Recording.Type.Canvas2D),this.action=e.find(t=>t instanceof WI.RecordingAction),this._recording&&this._action}set recording(e){if(e!==this._recording){this._recording=e,this._action=null;for(let t of this.contentView.subviews)this.contentView.removeSubview(t);this._dataGrids=[]}}set action(e){console.assert(!e||e instanceof WI.RecordingAction),!(!this._recording||e===this._action)&&(this._action=e,this._action&&this._recording.type===WI.Recording.Type.Canvas2D&&this._generateDetailsCanvas2D(this._action),this.updateLayoutIfNeeded())}get scrollElement(){return this._dataGrids.length===1?this._dataGrids[0].scrollContainer:super.scrollElement}sizeDidChange(){if(super.sizeDidChange(),this._dataGrids.length!==1)for(let e of this._dataGrids)e.sizeDidChange()}_generateDetailsCanvas2D(e){this._dataGrids.length===1&&this.contentView.removeSubview(this._dataGrids[0]),this.contentView.element.removeChildren(),this._dataGrids=[];let t=e.states.lastValue;if(console.assert(t),!t)return;let i=f=>{let _=new WI.DataGrid({name:{title:WI.UIString("Name")},value:{title:WI.UIString("Value")}});this._dataGrids.push(_);for(let[b,w]of f){if(b==="setPath")continue;if(typeof w=="object"){let k=w instanceof CanvasGradient,R=w instanceof CanvasPattern;if(k||R){let M=document.createElement("span");M.classList.add("unavailable");let L=null;k?(M.textContent=WI.unlocalizedString("CanvasGradient"),L=WI.ImageUtilities.imageFromCanvasGradient(w,100,100)):R&&(M.textContent=WI.unlocalizedString("CanvasPattern"),L=w.__image);let V=document.createDocumentFragment();if(L){let H=new WI.InlineSwatch(WI.InlineSwatch.Type.Image,L);V.appendChild(H.element)}V.appendChild(M),w=V}else w instanceof DOMMatrix&&(w=[w.a,w.b,w.c,w.d,w.e,w.f]),w=JSON.stringify(w)}else if(b==="fillStyle"||b==="strokeStyle"||b==="shadowColor"){let k=WI.Color.fromString(w);const R=!0;let M=new WI.InlineSwatch(WI.InlineSwatch.Type.Color,k,R);w=document.createElement("span"),w.append(M.element,k.toString())}let S=[];f===t&&!e.isGetter&&e.stateModifiers.has(b)&&S.push("modified"),b.startsWith("webkit")&&S.push("non-standard");const E=!1;_.appendChild(new WI.DataGridNode({name:b,value:w},E,S))}return _.updateLayoutIfNeeded(),_},n=(f,_=NaN)=>{let b=isNaN(_),w=i(f),S=new WI.DetailsSectionDataGridRow(w),E=new WI.DetailsSectionGroup([S]),k=b?"recording-current-state":`recording-saved-state-${_+1}`;const R=null,M=null;let L=!b,V=new WI.DetailsSection(k,R,[E],M,L);if(b)V.title=WI.UIString("Current State");else if(V.title=WI.UIString("Save %d").format(_+1),f.source){let H=this._recording.actions.indexOf(f.source);if(H>=0){let O=V.titleElement.appendChild(document.createElement("span"));O.classList.add("source"),O.textContent=WI.UIString("(Action %s)").format(H)}}return V};if(e.states.length===1){this.contentView.addSubview(i(t));return}let s=n(t);this.contentView.element.appendChild(s.element);let a=[];for(let f=e.states.length-2;f>=0;--f){let _=n(e.states[f],f);a.push(_)}let d=new WI.DetailsSectionGroup(a),p=new WI.DetailsSection("recording-saved-states",WI.UIString("Saved States"),[d]);this.contentView.element.appendChild(p.element)}};WI.RecordingTraceDetailsSidebarPanel=class extends WI.DetailsSidebarPanel{constructor(){super("recording-trace",WI.UIString("Trace"));const e=!1;this._backtraceTreeOutline=new WI.TreeOutline(e),this._backtraceTreeOutline.disclosureButtons=!1,this._backtraceTreeController=new WI.CallFrameTreeController(this._backtraceTreeOutline),this._recording=null,this._action=null}inspect(e){return e instanceof Array||(e=[e]),this.recording=e.find(t=>t instanceof WI.Recording),this.action=e.find(t=>t instanceof WI.RecordingAction),this._recording&&this._action}set recording(e){e!==this._recording&&(this._recording=e,this._action=null,this.contentView.element.removeChildren())}set action(e){if(console.assert(!e||e instanceof WI.RecordingAction),!this._recording||e===this._action||(this._action=e,this.contentView.element.removeChildren(),!this._action))return;let t=this._action.trace;if(this._backtraceTreeController.callFrames=t,!t.length){let i=this.contentView.element.appendChild(document.createElement("div"));i.classList.add("no-trace-data");let n=i.appendChild(document.createElement("div"));n.classList.add("message"),n.textContent=WI.UIString("Call Stack Unavailable");return}this.contentView.element.appendChild(this._backtraceTreeOutline.element)}};WI.RenderingFrameTimelineDataGridNode=class extends WI.TimelineDataGridNode{constructor(e,t={}){console.assert(e instanceof WI.RenderingFrameTimelineRecord),super([e],t)}get data(){return this._cachedData?this._cachedData:(this._cachedData=super.data,this._cachedData.name=WI.TimelineTabContentView.displayNameForRecord(this.record),this._cachedData.startTime=this.record.startTime-(this.graphDataSource?this.graphDataSource.zeroTime:0),this._cachedData.totalTime=this.record.duration,this._cachedData.scriptTime=this.record.durationForTask(WI.RenderingFrameTimelineRecord.TaskType.Script),this._cachedData.layoutTime=this.record.durationForTask(WI.RenderingFrameTimelineRecord.TaskType.Layout),this._cachedData.paintTime=this.record.durationForTask(WI.RenderingFrameTimelineRecord.TaskType.Paint),this._cachedData.otherTime=this.record.durationForTask(WI.RenderingFrameTimelineRecord.TaskType.Other),this._cachedData)}createCellContent(e,t){var n=this.data[e];switch(e){case"name":return t.classList.add(...this.iconClassNames()),n;case"startTime":return isNaN(n)?emDash:Number.secondsToString(n,!0);case"scriptTime":case"layoutTime":case"paintTime":case"otherTime":case"totalTime":return isNaN(n)||n===0?emDash:Number.secondsToString(n,!0)}return super.createCellContent(e,t)}};WI.RenderingFrameTimelineOverviewGraph=class extends WI.TimelineOverviewGraph{constructor(e,t){super(t),this.element.classList.add("rendering-frame"),this.element.addEventListener("click",this._mouseClicked.bind(this)),this._renderingFrameTimeline=e,this._renderingFrameTimeline.addEventListener(WI.Timeline.Event.RecordAdded,this._timelineRecordAdded,this),this._selectedFrameMarker=document.createElement("div"),this._selectedFrameMarker.classList.add("frame-marker"),this._timelineRecordFrames=[],this._selectedTimelineRecordFrame=null,this._graphHeightSeconds=NaN,this._framesPerSecondDividerMap=new Map,this.reset()}get graphHeightSeconds(){if(!isNaN(this._graphHeightSeconds))return this._graphHeightSeconds;var e=this._renderingFrameTimeline.records.reduce(function(t,i){return Math.max(t,i.duration)},0);return this._graphHeightSeconds=e*1.1,this._graphHeightSeconds=Math.min(this._graphHeightSeconds,WI.RenderingFrameTimelineOverviewGraph.MaximumGraphHeightSeconds),this._graphHeightSeconds=Math.max(this._graphHeightSeconds,WI.RenderingFrameTimelineOverviewGraph.MinimumGraphHeightSeconds),this._graphHeightSeconds}reset(){super.reset(),this.element.removeChildren(),this.selectedRecord=null,this._framesPerSecondDividerMap.clear()}recordWasFiltered(e,t){if(super.recordWasFiltered(e,t),!(e instanceof WI.RenderingFrameTimelineRecord))return;e[WI.RenderingFrameTimelineOverviewGraph.RecordWasFilteredSymbol]=t;const i=Math.floor(this.startTime),n=Math.min(Math.floor(this.endTime),this._renderingFrameTimeline.records.length-1);if(e.frameIndex<i||e.frameIndex>n)return;const s=e.frameIndex-i;this._timelineRecordFrames[s].filtered=t}get height(){return 108}layout(){if(!this.visible||!this._renderingFrameTimeline.records.length)return;let e=this._renderingFrameTimeline.records,t=Math.floor(this.startTime),i=Math.min(Math.floor(this.endTime),e.length-1),n=0;for(let s=t;s<=i;++s){let a=e[s],d=this._timelineRecordFrames[n];d?d.record=a:d=this._timelineRecordFrames[n]=new WI.TimelineRecordFrame(this,a),d.refresh(this),d.element.parentNode||this.element.appendChild(d.element),d.filtered=a[WI.RenderingFrameTimelineOverviewGraph.RecordWasFilteredSymbol]||!1,++n}for(;n<this._timelineRecordFrames.length;++n)this._timelineRecordFrames[n].record=null,this._timelineRecordFrames[n].element.remove();this._updateDividers(),this._updateFrameMarker()}updateSelectedRecord(){if(!this.selectedRecord){this._updateFrameMarker();return}const e=this.timelineOverview.visibleDuration,t=this.selectedRecord.frameIndex;if(t<Math.ceil(this.timelineOverview.scrollStartTime)||t>=this.timelineOverview.scrollStartTime+e){var i=t;(!this._selectedTimelineRecordFrame||Math.abs(this._selectedTimelineRecordFrame.record.frameIndex-this.selectedRecord.frameIndex)>1)&&(i-=Math.floor(e/2),i=Math.max(Math.min(i,this.timelineOverview.endTime),this.timelineOverview.startTime)),this.timelineOverview.scrollStartTime=i;return}this._updateFrameMarker()}_timelineRecordAdded(e){this._graphHeightSeconds=NaN,this.needsLayout()}_updateDividers(){if(this.graphHeightSeconds===0)return;let e=this.height;function t(i){var n=1/i,s=1-n/this.graphHeightSeconds;if(!(s<.01||s>=1)){var a=this._framesPerSecondDividerMap.get(i);if(!a){a=document.createElement("div"),a.classList.add("divider");var d=document.createElement("div");d.classList.add("label"),d.innerText=WI.UIString("%d fps").format(i),a.appendChild(d),this.element.appendChild(a),this._framesPerSecondDividerMap.set(i,a)}a.style.marginTop=(s*e).toFixed(2)+"px"}}t.call(this,60),t.call(this,30)}_updateFrameMarker(){if(this._selectedTimelineRecordFrame&&(this._selectedTimelineRecordFrame.selected=!1,this._selectedTimelineRecordFrame=null),!this.selectedRecord){this._selectedFrameMarker.parentElement&&this.element.removeChild(this._selectedFrameMarker);return}var e=1/this.timelineOverview.secondsPerPixel;this._selectedFrameMarker.style.width=e+"px";var t=this.selectedRecord.frameIndex-this.startTime;let i=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?"right":"left";this._selectedFrameMarker.style.setProperty(i,(t/this.timelineOverview.visibleDuration*100).toFixed(2)+"%"),this._selectedFrameMarker.parentElement||this.element.appendChild(this._selectedFrameMarker);var n=this._timelineRecordFrames.binaryIndexOf(this.selectedRecord,function(s,a){return a.record?s.frameIndex-a.record.frameIndex:-1});console.assert(n>=0&&n<this._timelineRecordFrames.length,"Selected record not within visible graph duration.",this.selectedRecord),!(n<0||n>=this._timelineRecordFrames.length)&&(this._selectedTimelineRecordFrame=this._timelineRecordFrames[n],this._selectedTimelineRecordFrame.selected=!0)}_mouseClicked(e){let t=0;WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?t=this.element.totalOffsetRight-e.pageX:t=e.pageX-this.element.totalOffsetLeft;var i=Math.floor(t*this.timelineOverview.secondsPerPixel+this.startTime);if(!(i<0||i>=this._renderingFrameTimeline.records.length)){var n=this._renderingFrameTimeline.records[i];if(!n[WI.RenderingFrameTimelineOverviewGraph.RecordWasFilteredSymbol]&&this.selectedRecord!==n){if(i>=this.timelineOverview.selectionStartTime&&i<this.timelineOverview.selectionStartTime+this.timelineOverview.selectionDuration){this.selectedRecord=n;return}this.selectedRecord=n,this.timelineOverview.selectionStartTime=i,this.timelineOverview.selectionDuration=1}}}};WI.RenderingFrameTimelineOverviewGraph.RecordWasFilteredSymbol=Symbol("rendering-frame-overview-graph-record-was-filtered");WI.RenderingFrameTimelineOverviewGraph.MaximumGraphHeightSeconds=.037;WI.RenderingFrameTimelineOverviewGraph.MinimumGraphHeightSeconds=.0185;WI.RenderingFrameTimelineView=class extends WI.TimelineView{constructor(e,t){super(e,t),console.assert(WI.TimelineRecord.Type.RenderingFrame);var i=[];for(var n in WI.RenderingFrameTimelineView.DurationFilter){var s=WI.RenderingFrameTimelineView.DurationFilter[n];i.push(new WI.ScopeBarItem(s,WI.RenderingFrameTimelineView.displayNameForDurationFilter(s)))}this._scopeBar=new WI.ScopeBar("rendering-frame-scope-bar",i,i[0],!0),this._scopeBar.addEventListener(WI.ScopeBar.Event.SelectionChanged,this._scopeBarSelectionDidChange,this);let a={name:{},totalTime:{},scriptTime:{},layoutTime:{},paintTime:{},otherTime:{},startTime:{},location:{}};a.name.title=WI.UIString("Name"),a.name.width="20%",a.name.icon=!0,a.name.disclosure=!0,a.name.locked=!0,a.totalTime.title=WI.UIString("Total Time"),a.totalTime.width="15%",a.totalTime.aligned="right",a.scriptTime.title=WI.RenderingFrameTimelineRecord.displayNameForTaskType(WI.RenderingFrameTimelineRecord.TaskType.Script),a.scriptTime.width="10%",a.scriptTime.aligned="right",a.layoutTime.title=WI.RenderingFrameTimelineRecord.displayNameForTaskType(WI.RenderingFrameTimelineRecord.TaskType.Layout),a.layoutTime.width="10%",a.layoutTime.aligned="right",a.paintTime.title=WI.RenderingFrameTimelineRecord.displayNameForTaskType(WI.RenderingFrameTimelineRecord.TaskType.Paint),a.paintTime.width="10%",a.paintTime.aligned="right",a.otherTime.title=WI.RenderingFrameTimelineRecord.displayNameForTaskType(WI.RenderingFrameTimelineRecord.TaskType.Other),a.otherTime.width="10%",a.otherTime.aligned="right",a.startTime.title=WI.UIString("Start Time"),a.startTime.width="15%",a.startTime.aligned="right",a.location.title=WI.UIString("Location");for(var d in a)a[d].sortable=!0;this._dataGrid=new WI.TimelineDataGrid(a),this._dataGrid.sortColumnIdentifier="startTime",this._dataGrid.sortOrder=WI.DataGrid.SortOrder.Ascending,this._dataGrid.createSettings("rendering-frame-timeline-view"),this.setupDataGrid(this._dataGrid),this.element.classList.add("rendering-frame"),this.addSubview(this._dataGrid),e.addEventListener(WI.Timeline.Event.RecordAdded,this._renderingFrameTimelineRecordAdded,this),this._pendingRecords=[];for(let p of e.records)this._processRecord(p)}static displayNameForDurationFilter(e){switch(e){case WI.RenderingFrameTimelineView.DurationFilter.All:return WI.UIString("All");case WI.RenderingFrameTimelineView.DurationFilter.OverOneMillisecond:return WI.UIString("Over 1 ms");case WI.RenderingFrameTimelineView.DurationFilter.OverFifteenMilliseconds:return WI.UIString("Over 15 ms");default:console.error("Unknown filter type",e)}return null}get showsLiveRecordingData(){return!1}shown(){super.shown(),this._dataGrid.shown()}hidden(){this._dataGrid.hidden(),super.hidden()}closed(){console.assert(this.representedObject instanceof WI.Timeline),this.representedObject.removeEventListener(null,null,this),this._dataGrid.closed()}get selectionPathComponents(){let e=this._dataGrid.selectedNode;if(!e||e.hidden)return null;let t=[];for(;e&&!e.root;){if(console.assert(e instanceof WI.TimelineDataGridNode),e.hidden)return null;let i=new WI.TimelineDataGridNodePathComponent(e);i.addEventListener(WI.HierarchicalPathComponent.Event.SiblingWasSelected,this.dataGridNodePathComponentSelected,this),t.unshift(i),e=e.parent}return t}get filterStartTime(){let e=this.representedObject.records,t=this.startTime;return t>=e.length?1/0:e[t].startTime}get filterEndTime(){let e=this.representedObject.records,t=this.endTime-1;return t>=e.length?1/0:e[t].endTime}reset(){super.reset(),this._dataGrid.reset(),this._pendingRecords=[]}dataGridNodePathComponentSelected(e){let t=e.data.pathComponent.timelineDataGridNode;console.assert(t.dataGrid===this._dataGrid),t.revealAndSelect()}matchDataGridNodeAgainstCustomFilters(e){if(!super.matchDataGridNodeAgainstCustomFilters(e))return!1;console.assert(e instanceof WI.TimelineDataGridNode),console.assert(this._scopeBar.selectedItems.length===1);let t=this._scopeBar.selectedItems[0];if(!t||t.id===WI.RenderingFrameTimelineView.DurationFilter.All)return!0;for(;e&&!(e.record instanceof WI.RenderingFrameTimelineRecord);)e=e.parent;if(console.assert(e,"Cannot apply duration filter: no RenderingFrameTimelineRecord found."),!e)return!1;let i=t.id===WI.RenderingFrameTimelineView.DurationFilter.OverOneMillisecond?.001:.015;return e.record.duration>i}layout(){this._processPendingRecords()}_processPendingRecords(){if(!!this._pendingRecords.length){for(let e of this._pendingRecords){console.assert(e instanceof WI.RenderingFrameTimelineRecord);let t=new WI.RenderingFrameTimelineDataGridNode(e,{graphDataSource:this});this._dataGrid.addRowInSortOrder(t);let i=[{children:e.children,parentDataGridNode:t,index:0}];for(;i.length;){let n=i.lastValue;if(n.index>=n.children.length){i.pop();continue}let s=n.children[n.index],a=null;if(s.type===WI.TimelineRecord.Type.Layout)a=new WI.LayoutTimelineDataGridNode(s,{graphDataSource:this}),this._dataGrid.addRowInSortOrder(a,n.parentDataGridNode);else if(s.type===WI.TimelineRecord.Type.Script){let d=[];s.profile&&(d=s.profile.topDownRootNodes),a=new WI.ScriptTimelineDataGridNode(s,{graphDataSource:this}),this._dataGrid.addRowInSortOrder(a,n.parentDataGridNode);for(let p of d){let f=new WI.ProfileNodeDataGridNode(p,{graphDataSource:this});this._dataGrid.addRowInSortOrder(f,a)}}a&&s.children.length&&i.push({children:s.children,parentDataGridNode:a,index:0}),++n.index}}this._pendingRecords=[]}}_renderingFrameTimelineRecordAdded(e){let t=e.data.record;console.assert(t instanceof WI.RenderingFrameTimelineRecord),console.assert(t.children.length,"Missing child records for rendering frame."),this._processRecord(t),this.needsLayout()}_processRecord(e){this._pendingRecords.push(e)}_scopeBarSelectionDidChange(){this._dataGrid.filterDidChange()}};WI.RenderingFrameTimelineView.DurationFilter={All:"rendering-frame-timeline-view-duration-filter-all",OverOneMillisecond:"rendering-frame-timeline-view-duration-filter-over-1-ms",OverFifteenMilliseconds:"rendering-frame-timeline-view-duration-filter-over-15-ms"};WI.Resizer=class extends WI.Object{constructor(e,t){console.assert(t),super(),this._delegate=t,this._orientation=e,this._element=document.createElement("div"),this._element.classList.add("resizer"),this._orientation===WI.Resizer.RuleOrientation.Horizontal?this._element.classList.add("horizontal-rule"):this._orientation===WI.Resizer.RuleOrientation.Vertical&&this._element.classList.add("vertical-rule"),this._element.addEventListener("mousedown",this._resizerMouseDown.bind(this),!1),this._resizerMouseMovedEventListener=this._resizerMouseMoved.bind(this),this._resizerMouseUpEventListener=this._resizerMouseUp.bind(this)}get element(){return this._element}get orientation(){return this._orientation}get initialPosition(){return this._resizerMouseDownPosition||NaN}_currentPosition(){if(this._orientation===WI.Resizer.RuleOrientation.Vertical)return event.pageX;if(this._orientation===WI.Resizer.RuleOrientation.Horizontal)return event.pageY;console.assert(!1,"Unexpected Resizer orientation.",this._orientation)}_resizerMouseDown(e){if(!(e.button!==0||e.ctrlKey)){this._resizerMouseDownPosition=this._currentPosition();var t=!1;if(typeof this._delegate.resizerDragStarted=="function"&&(t=this._delegate.resizerDragStarted(this,e.target)),t){delete this._resizerMouseDownPosition;return}this._orientation===WI.Resizer.RuleOrientation.Vertical?document.body.style.cursor="col-resize":(console.assert(this._orientation===WI.Resizer.RuleOrientation.Horizontal),document.body.style.cursor="row-resize"),document.addEventListener("mousemove",this._resizerMouseMovedEventListener,!1),document.addEventListener("mouseup",this._resizerMouseUpEventListener,!1),e.preventDefault(),e.stopPropagation(),WI._elementDraggingGlassPane&&WI._elementDraggingGlassPane.remove();var i=document.createElement("div");i.className="glass-pane-for-drag",document.body.appendChild(i),WI._elementDraggingGlassPane=i}}_resizerMouseMoved(e){e.preventDefault(),e.stopPropagation(),typeof this._delegate.resizerDragging=="function"&&this._delegate.resizerDragging(this,this._resizerMouseDownPosition-this._currentPosition())}_resizerMouseUp(e){e.button!==0||e.ctrlKey||(document.body.style.removeProperty("cursor"),WI._elementDraggingGlassPane&&(WI._elementDraggingGlassPane.remove(),delete WI._elementDraggingGlassPane),document.removeEventListener("mousemove",this._resizerMouseMovedEventListener,!1),document.removeEventListener("mouseup",this._resizerMouseUpEventListener,!1),e.preventDefault(),e.stopPropagation(),typeof this._delegate.resizerDragEnded=="function"&&this._delegate.resizerDragEnded(this),delete this._resizerMouseDownPosition)}};WI.Resizer.RuleOrientation={Horizontal:Symbol("resizer-rule-orientation-horizontal"),Vertical:Symbol("resizer-rule-orientation-vertical")};WI.ResourceClusterContentView=class extends WI.ClusterContentView{constructor(e){super(e),this._resource=e,this._resource.addEventListener(WI.Resource.Event.TypeDidChange,this._resourceTypeDidChange,this),this._resource.addEventListener(WI.Resource.Event.LoadingDidFinish,this._resourceLoadingDidFinish,this);function t(i,n,s){let a=new WI.HierarchicalPathComponent(i,n,s,!1,!0);return a.addEventListener(WI.HierarchicalPathComponent.Event.SiblingWasSelected,this._pathComponentSelected,this),a.comparisonData=e,a}this._requestContentView=null,this._responseContentView=null,this._customResponseContentView=null,this._customResponseContentViewConstructor=null,this._requestPathComponent=t.call(this,WI.UIString("Request"),WI.ResourceClusterContentView.RequestIconStyleClassName,WI.ResourceClusterContentView.RequestIdentifier),this._responsePathComponent=t.call(this,WI.UIString("Response"),WI.ResourceClusterContentView.ResponseIconStyleClassName,WI.ResourceClusterContentView.ResponseIdentifier),this._customResponsePathComponent=t.call(this,WI.UIString("Custom"),WI.ResourceClusterContentView.ResponseIconStyleClassName,WI.ResourceClusterContentView.CustomResponseIdentifier),this._canShowRequestContentView()&&(this._requestPathComponent.nextSibling=this._responsePathComponent,this._responsePathComponent.previousSibling=this._requestPathComponent),this._currentContentViewSetting=new WI.Setting("resource-current-view-"+this._resource.url.hash,WI.ResourceClusterContentView.ResponseIdentifier),this._tryEnableCustomResponseContentView()}get resource(){return this._resource}get responseContentView(){if(this._responseContentView)return this._responseContentView;if(this._responseContentView=this._contentViewForResourceType(this._resource.type),this._responseContentView)return this._responseContentView;let e=WI.Resource.typeFromMIMEType(this._resource.mimeType);return this._responseContentView=this._contentViewForResourceType(e),this._responseContentView?this._responseContentView:WI.shouldTreatMIMETypeAsText(this._resource.mimeType)?(this._responseContentView=new WI.TextResourceContentView(this._resource),this._responseContentView):(this._responseContentView=new WI.GenericResourceContentView(this._resource),this._responseContentView)}get requestContentView(){return this._canShowRequestContentView()?this._requestContentView?this._requestContentView:(this._requestContentView=new WI.TextContentView(this._resource.requestData||"",this._resource.requestDataContentType),this._requestContentView):null}get customResponseContentView(){return this._canShowCustomResponseContentView()?(this._customResponseContentView||(this._customResponseContentView=new this._customResponseContentViewConstructor(this._resource)),this._customResponseContentView):null}get selectionPathComponents(){let e=this._contentViewContainer.currentContentView;return e?!this._canShowRequestContentView()&&!this._canShowCustomResponseContentView()?e.selectionPathComponents:[this._pathComponentForContentView(e)].concat(e.selectionPathComponents):[]}shown(){super.shown(),!this._shownInitialContent&&this._showContentViewForIdentifier(this._currentContentViewSetting.value)}closed(){super.closed(),this._shownInitialContent=!1}saveToCookie(e){e[WI.ResourceClusterContentView.ContentViewIdentifierCookieKey]=this._currentContentViewSetting.value}restoreFromCookie(e){let t=this._showContentViewForIdentifier(e[WI.ResourceClusterContentView.ContentViewIdentifierCookieKey]);typeof t.revealPosition=="function"&&"lineNumber"in e&&"columnNumber"in e&&t.revealPosition(new WI.SourceCodePosition(e.lineNumber,e.columnNumber))}showRequest(){return this._shownInitialContent=!0,this._showContentViewForIdentifier(WI.ResourceClusterContentView.RequestIdentifier)}showResponse(e,t,i){this._shownInitialContent=!0,this._resource.finished||(this._positionToReveal=e,this._textRangeToSelect=t,this._forceUnformatted=i);let n=this._showContentViewForIdentifier(WI.ResourceClusterContentView.ResponseIdentifier);return typeof n.revealPosition=="function"&&n.revealPosition(e,t,i),n}_canShowRequestContentView(){return!(!this._resource.requestData||this._resource.hasRequestFormParameters())}_canShowCustomResponseContentView(){return!!this._customResponseContentViewConstructor}_contentViewForResourceType(e){switch(e){case WI.Resource.Type.Document:case WI.Resource.Type.Script:case WI.Resource.Type.Stylesheet:return new WI.TextResourceContentView(this._resource);case WI.Resource.Type.Image:return this._resource.mimeTypeComponents.type==="image/svg+xml"?new WI.SVGImageResourceClusterContentView(this._resource):new WI.ImageResourceContentView(this._resource);case WI.Resource.Type.Font:return new WI.FontResourceContentView(this._resource);case WI.Resource.Type.WebSocket:return new WI.WebSocketContentView(this._resource);default:return null}}_pathComponentForContentView(e){return console.assert(e),e?e===this._requestContentView?this._requestPathComponent:e===this._responseContentView?this._responsePathComponent:e===this._customResponseContentView?this._customResponsePathComponent:(console.error("Unknown contentView."),null):null}_identifierForContentView(e){return console.assert(e),e?e===this._requestContentView?WI.ResourceClusterContentView.RequestIdentifier:e===this._responseContentView?WI.ResourceClusterContentView.ResponseIdentifier:e===this._customResponseContentView?WI.ResourceClusterContentView.CustomResponseIdentifier:(console.error("Unknown contentView."),null):null}_showContentViewForIdentifier(e){let t=null;switch(e){case WI.ResourceClusterContentView.RequestIdentifier:t=this.requestContentView;break;case WI.ResourceClusterContentView.ResponseIdentifier:t=this.responseContentView;break;case WI.ResourceClusterContentView.CustomResponseIdentifier:t=this.customResponseContentView;break}return t||(t=this.responseContentView),console.assert(t),this._currentContentViewSetting.value=this._identifierForContentView(t),this.contentViewContainer.showContentView(t)}_pathComponentSelected(e){this._showContentViewForIdentifier(e.data.pathComponent.representedObject)}_resourceTypeDidChange(e){let t=this._responseContentView;!t||(this._responseContentView=null,this.contentViewContainer.replaceContentView(t,this.responseContentView))}_resourceLoadingDidFinish(e){this._tryEnableCustomResponseContentView(),"_positionToReveal"in this&&(this._contentViewContainer.currentContentView===this._responseContentView&&this._responseContentView.revealPosition(this._positionToReveal,this._textRangeToSelect,this._forceUnformatted),delete this._positionToReveal,delete this._textRangeToSelect,delete this._forceUnformatted)}_tryEnableCustomResponseContentView(){!this._resource.hasResponse()||(this._customResponseContentViewConstructor=this._customContentViewConstructorForResource(this._resource),this._customResponseContentViewConstructor&&(console.assert(this._customResponseContentViewConstructor.customContentViewDisplayName,"Custom Response ContentViews should have a static customContentViewDisplayName method.",this._customResponseContentViewConstructor),this._responsePathComponent.nextSibling=this._customResponsePathComponent,this._customResponsePathComponent.previousSibling=this._responsePathComponent,this._customResponsePathComponent.displayName=this._customResponseContentViewConstructor.customContentViewDisplayName(),this.dispatchEventToListeners(WI.ContentView.Event.SelectionPathComponentsDidChange)))}_customContentViewConstructorForResource(e){let t=this._resource.mimeType;return WI.fileExtensionForMIMEType(t)==="json"?WI.JSONResourceContentView:null}};WI.ResourceClusterContentView.ContentViewIdentifierCookieKey="resource-cluster-content-view-identifier";WI.ResourceClusterContentView.RequestIconStyleClassName="request-icon";WI.ResourceClusterContentView.ResponseIconStyleClassName="response-icon";WI.ResourceClusterContentView.RequestIdentifier="request";WI.ResourceClusterContentView.ResponseIdentifier="response";WI.ResourceClusterContentView.CustomResponseIdentifier="custom-response";WI.ResourceCollectionContentView=class extends WI.CollectionContentView{constructor(e){console.assert(e instanceof WI.ResourceCollection);let t=null;if(e.resourceType===WI.Resource.Type.Image&&(t=WI.ImageResourceContentView),super(e,t),e.resourceType===WI.Resource.Type.Image){let i=new WI.ScopeBarItem("all",WI.UIString("All")),n=[i];this._scopeBarItemTypeMap={};let s=(d,p)=>{let f=new WI.ScopeBarItem(d,p);n.push(f),this._scopeBarItemTypeMap[d]=f};s("bmp",WI.UIString("BMP")),s("gif",WI.UIString("GIF")),s("ico",WI.UIString("ICO")),s("jp2",WI.UIString("JP2")),s("jpg",WI.UIString("JPEG")),s("pdf",WI.UIString("PDF")),s("png",WI.UIString("PNG")),s("svg",WI.UIString("SVG")),s("tiff",WI.UIString("TIFF")),s("webp",WI.UIString("WebP")),s("xbm",WI.UIString("XBM"));const a=!0;this._imageTypeScopeBar=new WI.ScopeBar("resource-collection-image-type-scope-bar",n,i,a),this._imageTypeScopeBar.addEventListener(WI.ScopeBar.Event.SelectionChanged,this._handleImageTypeSelectionChanged,this)}}get navigationItems(){let e=super.navigationItems;return this._imageTypeScopeBar&&e.unshift(this._imageTypeScopeBar),e}contentViewAdded(e){console.assert(e instanceof WI.ResourceContentView);let t=e.representedObject;console.assert(t instanceof WI.Resource),this._updateImageTypeScopeBar(),e.addEventListener(WI.ResourceContentView.Event.ContentError,this._handleContentError,this),e.element.title=WI.displayNameForURL(t.url,t.urlComponents)}contentViewRemoved(e){this._updateImageTypeScopeBar()}_updateImageTypeScopeBar(){let e=new Set;for(let t of this.representedObject)e.add(WI.fileExtensionForMIMEType(t.mimeType));for(let[t,i]of Object.entries(this._scopeBarItemTypeMap)){let n=!e.has(t);i.hidden=n,n&&i.selected&&(i.selected=!1)}}_handleImageTypeSelectionChanged(){let e=this._imageTypeScopeBar.selectedItems.map(i=>i.id),t=e.length===1&&e[0]==="all";for(let i of this.subviews){let n=!t;n&&i instanceof WI.ResourceContentView&&(n=!e.includes(WI.fileExtensionForMIMEType(i.representedObject.mimeType))),i.element.hidden=n}}_handleContentError(e){e&&e.target&&this.removeContentViewForItem(e.target.representedObject)}};WI.ResourceCookiesContentView=class extends WI.ContentView{constructor(e){super(null),console.assert(e instanceof WI.Resource),this._resource=e,this._resource.addEventListener(WI.Resource.Event.RequestHeadersDidChange,this._resourceRequestHeadersDidChange,this),this._resource.addEventListener(WI.Resource.Event.ResponseReceived,this._resourceResponseReceived,this),this.element.classList.add("resource-details","resource-cookies")}tableNumberOfRows(e){return this._dataSourceForTable(e).length}tableSortChanged(e){let t=this._generateSortComparator(e);if(!t)return;this._dataSourceForTable(e).sort(t),e.reloadData()}tableIndexForRepresentedObject(e,t){let n=this._dataSourceForTable(e).indexOf(t);return console.assert(n>=0),n}tableRepresentedObjectForIndex(e,t){let i=this._dataSourceForTable(e);return console.assert(t>=0&&t<i.length),i[t]}tableShouldSelectRow(e,t,i,n){return!1}tablePopulateCell(e,t,i,n){let s=this._dataSourceForTable(e)[n];const a="\u2713";switch(i.identifier){case"name":t.textContent=s.name;break;case"value":t.textContent=s.value;break;case"domain":t.textContent=s.domain||emDash;break;case"path":t.textContent=s.path||emDash;break;case"expires":t.textContent=s.expires?s.expires.toLocaleString():WI.UIString("Session");break;case"maxAge":t.textContent=s.maxAge||emDash;break;case"secure":t.textContent=s.secure?a:zeroWidthSpace;break;case"httpOnly":t.textContent=s.httpOnly?a:zeroWidthSpace;break;case"sameSite":t.textContent=s.sameSite===WI.Cookie.SameSiteType.None?emDash:WI.Cookie.displayNameForSameSiteType(s.sameSite);break}return t}initialLayout(){super.initialLayout(),this._requestCookiesSection=new WI.ResourceDetailsSection(WI.UIString("Request Cookies")),this.element.appendChild(this._requestCookiesSection.element),this._refreshRequestCookiesSection(),this._responseCookiesSection=new WI.ResourceDetailsSection(WI.UIString("Response Cookies")),this.element.appendChild(this._responseCookiesSection.element),this._refreshResponseCookiesSection()}_dataSourceForTable(e){return e===this._requestCookiesTable?this._requestCookiesDataSource:this._responseCookiesDataSource}_generateSortComparator(e){let t=e.sortColumnIdentifier;if(!t)return null;let i;switch(t){case"name":case"value":case"domain":case"path":case"sameSite":i=(s,a)=>(s[t]||"").extendedLocaleCompare(a[t]||"");break;case"maxAge":i=(s,a)=>{let d=s[t];if(isNaN(d))return 1;let p=a[t];return isNaN(p)?-1:d-p};break;case"httpOnly":case"secure":i=(s,a)=>s[t]-a[t];break;case"expires":i=(s,a)=>{let d=s.expires;if(!d)return 1;let p=a.expires;return p?d.getTime()-p.getTime():-1};break;default:return console.assert("Unexpected sort column",t),null}let n=e.sortOrder===WI.Table.SortOrder.Ascending?1:-1;return(s,a)=>n*i(s,a)}_refreshRequestCookiesSection(){let e=this._requestCookiesSection.detailsElement;if(e.removeChildren(),this._resource.responseSource===WI.Resource.ResponseSource.MemoryCache){this._requestCookiesSection.markIncompleteSectionWithMessage(WI.UIString("No request, served from the memory cache."));return}this._requestCookiesDataSource=this._resource.requestCookies,this._requestCookiesTable||(this._requestCookiesTable=new WI.Table("request-cookies",this,this,20),this._requestCookiesTable.addColumn(new WI.TableColumn("name",WI.UIString("Name"),{minWidth:150,maxWidth:300,initialWidth:200,resizeType:WI.TableColumn.ResizeType.Locked})),this._requestCookiesTable.addColumn(new WI.TableColumn("value",WI.UIString("Value"),{minWidth:150,hideable:!1})),this._requestCookiesTable.sortColumnIdentifier||(this._requestCookiesTable.sortOrder=WI.Table.SortOrder.Ascending,this._requestCookiesTable.sortColumnIdentifier="name")),this._requestCookiesDataSource.length?(this._requestCookiesSection.toggleIncomplete(!1),this._requestCookiesTable.element.style.height=this._sizeForTable(this._requestCookiesTable)+"px",this.addSubview(this._requestCookiesTable),e.classList.add("has-table"),e.appendChild(this._requestCookiesTable.element)):(this._requestCookiesTable.isAttached&&this.removeSubview(this._requestCookiesTable),this._requestCookiesSection.markIncompleteSectionWithMessage(WI.UIString("No request cookies.")))}_refreshResponseCookiesSection(){let e=this._responseCookiesSection.detailsElement;if(e.removeChildren(),!this._resource.hasResponse()){this._responseCookiesSection.markIncompleteSectionWithLoadingIndicator();return}this._responseCookiesDataSource=this._resource.responseCookies,this._responseCookiesTable||(this._responseCookiesTable=new WI.Table("request-cookies",this,this,20),this._responseCookiesTable.addColumn(new WI.TableColumn("name",WI.UIString("Name"),{minWidth:150,maxWidth:300,initialWidth:200,resizeType:WI.TableColumn.ResizeType.Locked})),this._responseCookiesTable.addColumn(new WI.TableColumn("value",WI.UIString("Value"),{minWidth:150,hideable:!1})),this._responseCookiesTable.addColumn(new WI.TableColumn("domain",WI.unlocalizedString("Domain"),{})),this._responseCookiesTable.addColumn(new WI.TableColumn("path",WI.unlocalizedString("Path"),{})),this._responseCookiesTable.addColumn(new WI.TableColumn("expires",WI.unlocalizedString("Expires"),{maxWidth:150})),this._responseCookiesTable.addColumn(new WI.TableColumn("maxAge",WI.unlocalizedString("Max-Age"),{maxWidth:90,align:"right"})),this._responseCookiesTable.addColumn(new WI.TableColumn("secure",WI.unlocalizedString("Secure"),{minWidth:55,maxWidth:65,align:"center"})),this._responseCookiesTable.addColumn(new WI.TableColumn("httpOnly",WI.unlocalizedString("HttpOnly"),{minWidth:55,maxWidth:65,align:"center"})),this._responseCookiesTable.addColumn(new WI.TableColumn("sameSite",WI.unlocalizedString("SameSite"),{minWidth:55,maxWidth:65})),this._responseCookiesTable.sortColumnIdentifier||(this._responseCookiesTable.sortOrder=WI.Table.SortOrder.Ascending,this._responseCookiesTable.sortColumnIdentifier="name")),this._responseCookiesDataSource.length?(this._responseCookiesSection.toggleIncomplete(!1),this._responseCookiesTable.element.style.height=this._sizeForTable(this._responseCookiesTable)+"px",this.addSubview(this._responseCookiesTable),e.classList.add("has-table"),e.appendChild(this._responseCookiesTable.element)):(this._responseCookiesTable.isAttached&&this.removeSubview(this._responseCookiesTable),this._responseCookiesSection.markIncompleteSectionWithMessage(WI.UIString("No response cookies.")))}_sizeForTable(e){return this._dataSourceForTable(e).length*e.rowHeight+28+3}_resourceRequestHeadersDidChange(e){this._refreshRequestCookiesSection()}_resourceResponseReceived(e){this._refreshResponseCookiesSection()}};WI.ResourceDetailsSection=class{constructor(e,t){this._element=document.createElement("section"),t&&(this._element.className=t),this._titleElement=this._element.appendChild(document.createElement("div")),this._titleElement.className="title",this._titleElement.textContent=e,this._detailsElement=this._element.appendChild(document.createElement("div")),this._detailsElement.className="details",this._element.appendChild(document.createElement("br"))}get element(){return this._element}get titleElement(){return this._titleElement}get detailsElement(){return this._detailsElement}toggleIncomplete(e){console.assert(typeof e=="boolean"),this.element.classList.toggle("incomplete",e)}toggleError(e){console.assert(typeof e=="boolean"),this.element.classList.toggle("error",e)}markIncompleteSectionWithMessage(e){this.toggleIncomplete(!0);let t=this._detailsElement.appendChild(document.createElement("p"));t.textContent=e}markIncompleteSectionWithLoadingIndicator(){this.toggleIncomplete(!0);let e=this._detailsElement.appendChild(document.createElement("p")),t=new WI.IndeterminateProgressSpinner;e.appendChild(t.element)}appendKeyValuePair(e,t,i){let n=this._detailsElement.appendChild(document.createElement("p"));n.className="pair",i&&n.classList.add(i);let s=n.appendChild(document.createElement("span"));if(s.className="key",console.assert(typeof e=="string"||e instanceof Node),e instanceof Node)s.appendChild(e);else{s.textContent=e+(t?": ":"");let a=n.appendChild(document.createElement("span"));a.className="value",t instanceof Node?a.appendChild(t):a.textContent=t}return n}};WI.ResourceDetailsSidebarPanel=class extends WI.DetailsSidebarPanel{constructor(){super("resource-details",WI.UIString("Resource")),this.element.classList.add("resource"),this._resource=null,this._needsToApplyResourceEventListeners=!1,this._needsToRemoveResourceEventListeners=!1}inspect(e){e instanceof Array||(e=[e]);var t=null;for(let i of e){if(i instanceof WI.Resource){t=i;break}if(i instanceof WI.Frame){t=i.mainResource;break}if(i instanceof WI.Script&&i.isMainResource()&&i.resource){t=i.resource;break}}return this.resource=t,!!this._resource}get resource(){return this._resource}set resource(e){e!==this._resource&&(this._resource&&this._needsToRemoveResourceEventListeners&&(this._resource.removeEventListener(null,null,this),this._needsToRemoveResourceEventListeners=!1),this._resource=e,this._resource&&(this.didInitialLayout?this._applyResourceEventListeners():this._needsToApplyResourceEventListeners=!0),this.needsLayout())}initialLayout(){super.initialLayout(),this._typeMIMETypeRow=new WI.DetailsSectionSimpleRow(WI.UIString("MIME Type")),this._typeResourceTypeRow=new WI.DetailsSectionSimpleRow(WI.UIString("Resource Type")),this._typeSection=new WI.DetailsSection("resource-type",WI.UIString("Type")),this._typeSection.groups=[new WI.DetailsSectionGroup([this._typeMIMETypeRow,this._typeResourceTypeRow])],this._locationFullURLRow=new WI.DetailsSectionSimpleRow(WI.UIString("Full URL")),this._locationSchemeRow=new WI.DetailsSectionSimpleRow(WI.UIString("Scheme")),this._locationHostRow=new WI.DetailsSectionSimpleRow(WI.UIString("Host")),this._locationPortRow=new WI.DetailsSectionSimpleRow(WI.UIString("Port")),this._locationPathRow=new WI.DetailsSectionSimpleRow(WI.UIString("Path")),this._locationQueryStringRow=new WI.DetailsSectionSimpleRow(WI.UIString("Query String")),this._locationFragmentRow=new WI.DetailsSectionSimpleRow(WI.UIString("Fragment")),this._locationFilenameRow=new WI.DetailsSectionSimpleRow(WI.UIString("Filename")),this._initiatorRow=new WI.DetailsSectionSimpleRow(WI.UIString("Initiator")),this._initiatedRow=new WI.DetailsSectionSimpleRow(WI.UIString("Initiated"));var e=[this._locationFullURLRow],t=[this._locationSchemeRow,this._locationHostRow,this._locationPortRow,this._locationPathRow,this._locationQueryStringRow,this._locationFragmentRow,this._locationFilenameRow],i=[this._initiatorRow,this._initiatedRow];this._fullURLGroup=new WI.DetailsSectionGroup(e),this._locationURLComponentsGroup=new WI.DetailsSectionGroup(t),this._relatedResourcesGroup=new WI.DetailsSectionGroup(i),this._locationSection=new WI.DetailsSection("resource-location",WI.UIString("Location"),[this._fullURLGroup,this._locationURLComponentsGroup,this._relatedResourcesGroup]),this._queryParametersRow=new WI.DetailsSectionDataGridRow(null,WI.UIString("No Query Parameters")),this._queryParametersSection=new WI.DetailsSection("resource-query-parameters",WI.UIString("Query Parameters")),this._queryParametersSection.groups=[new WI.DetailsSectionGroup([this._queryParametersRow])],this._requestDataSection=new WI.DetailsSection("resource-request-data",WI.UIString("Request Data")),this._requestMethodRow=new WI.DetailsSectionSimpleRow(WI.UIString("Method")),this._protocolRow=new WI.DetailsSectionSimpleRow(WI.UIString("Protocol")),this._priorityRow=new WI.DetailsSectionSimpleRow(WI.UIString("Priority")),this._cachedRow=new WI.DetailsSectionSimpleRow(WI.UIString("Cached")),this._statusTextRow=new WI.DetailsSectionSimpleRow(WI.UIString("Status")),this._statusCodeRow=new WI.DetailsSectionSimpleRow(WI.UIString("Code")),this._errorReasonRow=new WI.DetailsSectionSimpleRow(WI.UIString("Error")),this._remoteAddressRow=new WI.DetailsSectionSimpleRow(WI.UIString("IP Address")),this._connectionIdentifierRow=new WI.DetailsSectionSimpleRow(WI.UIString("Connection ID")),this._encodedSizeRow=new WI.DetailsSectionSimpleRow(WI.UIString("Encoded")),this._decodedSizeRow=new WI.DetailsSectionSimpleRow(WI.UIString("Decoded")),this._transferSizeRow=new WI.DetailsSectionSimpleRow(WI.UIString("Transferred")),this._compressedRow=new WI.DetailsSectionSimpleRow(WI.UIString("Compressed")),this._compressionRow=new WI.DetailsSectionSimpleRow(WI.UIString("Compression"));let n=new WI.DetailsSectionGroup([this._requestMethodRow,this._protocolRow,this._priorityRow,this._cachedRow]),s=new WI.DetailsSectionGroup([this._statusTextRow,this._statusCodeRow,this._errorReasonRow]),a=new WI.DetailsSectionGroup([this._remoteAddressRow,this._connectionIdentifierRow]),d=new WI.DetailsSectionGroup([this._encodedSizeRow,this._decodedSizeRow,this._transferSizeRow]),p=new WI.DetailsSectionGroup([this._compressedRow,this._compressionRow]);this._requestAndResponseSection=new WI.DetailsSection("resource-request-response",WI.UIString("Request & Response")),this._requestAndResponseSection.groups=[n,s,a,d,p],this._requestHeadersRow=new WI.DetailsSectionDataGridRow(null,WI.UIString("No Request Headers")),this._requestHeadersSection=new WI.DetailsSection("resource-request-headers",WI.UIString("Request Headers")),this._requestHeadersSection.groups=[new WI.DetailsSectionGroup([this._requestHeadersRow])],this._responseHeadersRow=new WI.DetailsSectionDataGridRow(null,WI.UIString("No Response Headers")),this._responseHeadersSection=new WI.DetailsSection("resource-response-headers",WI.UIString("Response Headers")),this._responseHeadersSection.groups=[new WI.DetailsSectionGroup([this._responseHeadersRow])],this._imageWidthRow=new WI.DetailsSectionSimpleRow(WI.UIString("Width")),this._imageHeightRow=new WI.DetailsSectionSimpleRow(WI.UIString("Height")),this._imageSizeSection=new WI.DetailsSection("resource-type",WI.UIString("Image Size")),this._imageSizeSection.groups=[new WI.DetailsSectionGroup([this._imageWidthRow,this._imageHeightRow])],this.contentView.element.appendChild(this._typeSection.element),this.contentView.element.appendChild(this._locationSection.element),this.contentView.element.appendChild(this._requestAndResponseSection.element),this.contentView.element.appendChild(this._requestHeadersSection.element),this.contentView.element.appendChild(this._responseHeadersSection.element),this._needsToApplyResourceEventListeners&&(this._applyResourceEventListeners(),this._needsToApplyResourceEventListeners=!1)}layout(){super.layout(),this._resource&&(this._refreshURL(),this._refreshMIMEType(),this._refreshResourceType(),this._refreshRequestAndResponse(),this._refreshDecodedSize(),this._refreshTransferSize(),this._refreshRequestHeaders(),this._refreshImageSizeSection(),this._refreshRequestDataSection(),this._refreshRelatedResourcesSection())}sizeDidChange(){super.sizeDidChange(),this._queryParametersRow.sizeDidChange(),this._requestHeadersRow.sizeDidChange(),this._responseHeadersRow.sizeDidChange()}_refreshURL(){if(!!this._resource){this._locationFullURLRow.value=this._resource.url.insertWordBreakCharacters();var e=this._resource.urlComponents;if(e.scheme?(this._locationSection.groups=[this._fullURLGroup,this._locationURLComponentsGroup,this._relatedResourcesGroup],this._locationSchemeRow.value=e.scheme?e.scheme:null,this._locationHostRow.value=e.host?e.host:null,this._locationPortRow.value=e.port?e.port:null,this._locationPathRow.value=e.path?e.path.insertWordBreakCharacters():null,this._locationQueryStringRow.value=e.queryString?e.queryString.insertWordBreakCharacters():null,this._locationFragmentRow.value=e.fragment?e.fragment.insertWordBreakCharacters():null,this._locationFilenameRow.value=e.lastPathComponent?e.lastPathComponent.insertWordBreakCharacters():null):this._locationSection.groups=[this._fullURLGroup,this._relatedResourcesGroup],e.queryString)this.contentView.element.insertBefore(this._queryParametersSection.element,this._requestAndResponseSection.element.nextSibling),this._queryParametersRow.dataGrid=this._createNameValueDataGrid(parseQueryString(e.queryString,!0));else{var t=this._queryParametersSection.element;t.parentNode&&t.parentNode.removeChild(t)}}}_refreshRelatedResourcesSection(){let e=this._locationSection.groups,t=e.includes(this._relatedResourcesGroup);if(!this._resource.initiatorSourceCodeLocation&&!this._resource.initiatedResources.length){t&&(e.remove(this._relatedResourcesGroup),this._locationSection.groups=e);return}t||(e.push(this._relatedResourcesGroup),this._locationSection.groups=e);let i=this._resource.initiatorSourceCodeLocation;if(i){const s={dontFloat:!0,ignoreSearchTab:!0};this._initiatorRow.value=WI.createSourceCodeLocationLink(i,s)}else this._initiatorRow.value=null;let n=this._resource.initiatedResources;if(n.length){let s=document.createElement("div");for(let a of n)s.appendChild(WI.createResourceLink(a));this._initiatedRow.value=s}else this._initiatedRow.value=null}_refreshResourceType(){!this._resource||(this._typeResourceTypeRow.value=WI.Resource.displayNameForType(this._resource.type))}_refreshMIMEType(){!this._resource||(this._typeMIMETypeRow.value=this._resource.mimeType)}_refreshErrorReason(){if(!!this._resource){if(!this._resource.hadLoadingError()){this._errorReasonRow.value=null;return}this._resource.failureReasonText?this._errorReasonRow.value=this._resource.failureReasonText:this._resource.statusCode>=400?this._errorReasonRow.value=WI.UIString("Failure status code"):this._resource.canceled?this._errorReasonRow.value=WI.UIString("Load cancelled"):this._errorReasonRow.value=WI.UIString("Unknown error")}}_refreshRequestAndResponse(){if(!!this._resource){if(this._requestMethodRow.value=this._resource.requestMethod||emDash,InspectorBackend.domains.Network.hasEventParameter("loadingFinished","metrics")){let e=WI.Resource.displayNameForProtocol(this._resource.protocol);this._protocolRow.value=e||emDash,this._protocolRow.tooltip=e?this._resource.protocol:"",this._priorityRow.value=WI.Resource.displayNameForPriority(this._resource.priority)||emDash,this._remoteAddressRow.value=this._resource.remoteAddress||emDash,this._connectionIdentifierRow.value=this._resource.connectionIdentifier||emDash}this._cachedRow.value=this._cachedRowValue(),this._statusCodeRow.value=this._resource.statusCode||emDash,this._statusTextRow.value=this._resource.statusText||emDash,this._refreshErrorReason(),this._refreshResponseHeaders(),this._refreshCompressed()}}_valueForSize(e){return e>0?Number.bytesToString(e):emDash}_refreshCompressed(){this._resource.compressed?(this._compressedRow.value=WI.UIString("Yes"),this._resource.size?isNaN(this._resource.networkEncodedSize)?this._compressionRow.value=this._resource.estimatedNetworkEncodedSize?WI.UIString("%.2f\xD7").format(this._resource.size/this._resource.estimatedNetworkEncodedSize):emDash:this._compressionRow.value=this._resource.networkEncodedSize?WI.UIString("%.2f\xD7").format(this._resource.size/this._resource.networkEncodedSize):emDash:this._compressionRow.value=emDash):(this._compressedRow.value=WI.UIString("No"),this._compressionRow.value=null)}_refreshDecodedSize(){if(!this._resource)return;let e=isNaN(this._resource.networkEncodedSize)?this._resource.estimatedNetworkEncodedSize:this._resource.networkEncodedSize,t=isNaN(this._resource.networkDecodedSize)?this._resource.size:this._resource.networkDecodedSize;this._encodedSizeRow.value=this._valueForSize(e),this._decodedSizeRow.value=this._valueForSize(t),this._refreshCompressed()}_refreshTransferSize(){if(!this._resource)return;let e=isNaN(this._resource.networkEncodedSize)?this._resource.estimatedNetworkEncodedSize:this._resource.networkEncodedSize,t=isNaN(this._resource.networkTotalTransferSize)?this._resource.estimatedTotalTransferSize:this._resource.networkTotalTransferSize;this._encodedSizeRow.value=this._valueForSize(e),this._transferSizeRow.value=this._valueForSize(t),this._refreshCompressed()}_refreshRequestHeaders(){!this._resource||(this._requestHeadersRow.dataGrid=this._createNameValueDataGrid(this._resource.requestHeaders))}_refreshResponseHeaders(){!this._resource||(this._responseHeadersRow.dataGrid=this._createNameValueDataGrid(this._resource.responseHeaders))}_createNameValueDataGrid(e){if(!e||e instanceof Array?!e.length:isEmptyObject(e))return null;var t=new WI.DataGrid({name:{title:WI.UIString("Name"),width:"30%",sortable:!0},value:{title:WI.UIString("Value"),sortable:!0}});t.copyTextDelimiter=": ";function i(d){console.assert(typeof d.name=="string"),console.assert(!d.value||typeof d.value=="string");var p=new WI.DataGridNode({name:d.name,value:d.value||""},!1);t.appendChild(p)}if(e instanceof Array)for(var n=0;n<e.length;++n)i(e[n]);else for(var s in e)i({name:s,value:e[s]||""});t.addEventListener(WI.DataGrid.Event.SortChanged,a,this);function a(){var d=t.sortColumnIdentifier;function p(f,_){var b=f.data[d],w=_.data[d];return b.extendedLocaleCompare(w)}t.sortNodes(p)}return t}_refreshImageSizeSection(){var e=this._resource;if(!e)return;function t(){this._imageSizeSection.element.remove()}if(e.type!==WI.Resource.Type.Image||e.failed){t.call(this);return}this.contentView.element.insertBefore(this._imageSizeSection.element,this._locationSection.element),e.getImageSize(i=>{i?(this._imageWidthRow.value=WI.UIString("%dpx").format(i.width),this._imageHeightRow.value=WI.UIString("%dpx").format(i.height)):t.call(this)})}_cachedRowValue(){let e=this._resource.responseSource;if(e===WI.Resource.ResponseSource.MemoryCache||e===WI.Resource.ResponseSource.DiskCache){console.assert(this._resource.cached,"This resource has a cache responseSource it should also be marked as cached",this._resource);let t=document.createElement("span"),i=document.createElement("span");return i.classList="cache-type",i.textContent=e===WI.Resource.ResponseSource.MemoryCache?WI.UIString("(Memory)"):WI.UIString("(Disk)"),t.append(WI.UIString("Yes")," ",i),t}return this._resource.cached?WI.UIString("Yes"):WI.UIString("No")}_goToRequestDataClicked(){const e={ignoreSearchTab:!0};WI.showResourceRequest(this._resource,e)}_refreshRequestDataSection(){var e=this._resource;if(!!e){var t=e.requestData;if(!t){this._requestDataSection.element.remove();return}this.contentView.element.insertBefore(this._requestDataSection.element,this._requestHeadersSection.element);var i=e.requestDataContentType||"";if(i&&i.match(/^application\/x-www-form-urlencoded\s*(;.*)?$/i)){var n=new WI.DetailsSectionDataGridRow(null,WI.UIString("No Parameters"));n.dataGrid=this._createNameValueDataGrid(parseQueryString(t,!0)),this._requestDataSection.groups=[new WI.DetailsSectionGroup([n])];return}var s=parseMIMEType(i),a=s.type,d=s.boundary,p=s.encoding,f=[],_=new WI.DetailsSectionSimpleRow(WI.UIString("MIME Type"));if(_.value=a,f.push(_),d){var b=new WI.DetailsSectionSimpleRow(WI.UIString("Boundary"));b.value=d,f.push(b)}if(p){var w=new WI.DetailsSectionSimpleRow(WI.UIString("Encoding"));w.value=p,f.push(w)}var S=Number.bytesToString(t.length),E=document.createDocumentFragment();E.append(S);var k=E.appendChild(WI.createGoToArrowButton());k.addEventListener("click",this._goToRequestDataClicked.bind(this));var R=new WI.DetailsSectionSimpleRow(WI.UIString("Data"));R.value=E,f.push(R),this._requestDataSection.groups=[new WI.DetailsSectionGroup(f)]}}_applyResourceEventListeners(){this._refreshRelatedResourcesSectionThrottler||(this._refreshRelatedResourcesSectionThrottler=new Throttler(()=>{this._refreshRelatedResourcesSection()},250)),this._resource.addEventListener(WI.Resource.Event.URLDidChange,this._refreshURL,this),this._resource.addEventListener(WI.Resource.Event.MIMETypeDidChange,this._refreshMIMEType,this),this._resource.addEventListener(WI.Resource.Event.TypeDidChange,this._refreshResourceType,this),this._resource.addEventListener(WI.Resource.Event.LoadingDidFail,this._refreshErrorReason,this),this._resource.addEventListener(WI.Resource.Event.RequestHeadersDidChange,this._refreshRequestHeaders,this),this._resource.addEventListener(WI.Resource.Event.ResponseReceived,this._refreshRequestAndResponse,this),this._resource.addEventListener(WI.Resource.Event.CacheStatusDidChange,this._refreshRequestAndResponse,this),this._resource.addEventListener(WI.Resource.Event.MetricsDidChange,this._refreshRequestAndResponse,this),this._resource.addEventListener(WI.Resource.Event.SizeDidChange,this._refreshDecodedSize,this),this._resource.addEventListener(WI.Resource.Event.TransferSizeDidChange,this._refreshTransferSize,this),this._resource.addEventListener(WI.Resource.Event.InitiatedResourcesDidChange,()=>{this._refreshRelatedResourcesSectionThrottler.fire()},this),this._needsToRemoveResourceEventListeners=!0}};WI.ResourceHeadersContentView=class extends WI.ContentView{constructor(e,t){super(null),console.assert(e instanceof WI.Resource),console.assert(t),this._resource=e,this._resource.addEventListener(WI.Resource.Event.MetricsDidChange,this._resourceMetricsDidChange,this),this._resource.addEventListener(WI.Resource.Event.RequestHeadersDidChange,this._resourceRequestHeadersDidChange,this),this._resource.addEventListener(WI.Resource.Event.ResponseReceived,this._resourceResponseReceived,this),this._delegate=t,this._searchQuery=null,this._searchResults=null,this._searchDOMChanges=[],this._searchIndex=-1,this._automaticallyRevealFirstSearchResult=!1,this._bouncyHighlightElement=null,this._popover=null,this._popoverCallStackIconElement=null,this._redirectDetailsSections=[],this.element.classList.add("resource-details","resource-headers"),this.element.tabIndex=0,this._needsSummaryRefresh=!1,this._needsRedirectHeadersRefresh=!1,this._needsRequestHeadersRefresh=!1,this._needsResponseHeadersRefresh=!1}initialLayout(){super.initialLayout(),this._summarySection=new WI.ResourceDetailsSection(WI.UIString("Summary"),"summary"),this.element.appendChild(this._summarySection.element),this._refreshSummarySection(),this._refreshRedirectHeadersSections(),this._requestHeadersSection=new WI.ResourceDetailsSection(WI.UIString("Request"),"headers"),this.element.appendChild(this._requestHeadersSection.element),this._refreshRequestHeadersSection(),this._responseHeadersSection=new WI.ResourceDetailsSection(WI.UIString("Response"),"headers"),this.element.appendChild(this._responseHeadersSection.element),this._refreshResponseHeadersSection(),this._resource.urlComponents.queryString&&(this._queryStringSection=new WI.ResourceDetailsSection(WI.UIString("Query String Parameters")),this.element.appendChild(this._queryStringSection.element),this._refreshQueryStringSection()),this._resource.requestData&&(this._requestDataSection=new WI.ResourceDetailsSection(WI.UIString("Request Data")),this.element.appendChild(this._requestDataSection.element),this._refreshRequestDataSection()),this._needsSummaryRefresh=!1,this._needsRedirectHeadersRefresh=!1,this._needsRequestHeadersRefresh=!1,this._needsResponseHeadersRefresh=!1}layout(){super.layout(),this._needsSummaryRefresh&&(this._refreshSummarySection(),this._needsSummaryRefresh=!1),this._needsRedirectHeadersRefresh&&(this._refreshRedirectHeadersSections(),this._needsRedirectHeadersRefresh=!1),this._needsRequestHeadersRefresh&&(this._refreshRequestHeadersSection(),this._needsRequestHeadersRefresh=!1),this._needsResponseHeadersRefresh&&(this._refreshResponseHeadersSection(),this._needsResponseHeadersRefresh=!1)}hidden(){super.hidden(),this._popover&&this._popover.dismiss()}closed(){this._resource.removeEventListener(null,null,this),super.closed()}get supportsSearch(){return!0}get numberOfSearchResults(){return this._searchResults?this._searchResults.length:null}get hasPerformedSearch(){return this._searchResults!==null}set automaticallyRevealFirstSearchResult(e){this._automaticallyRevealFirstSearchResult=e,this._automaticallyRevealFirstSearchResult&&this.numberOfSearchResults>0&&this._searchIndex===-1&&this.revealNextSearchResult()}performSearch(e){e!==this._searchQuery&&(WI.revertDOMChanges(this._searchDOMChanges),this._searchQuery=e,this._searchResults=[],this._searchDOMChanges=[],this._searchIndex=-1,this._perfomSearchOnKeyValuePairs(),this.dispatchEventToListeners(WI.ContentView.Event.NumberOfSearchResultsDidChange),this._automaticallyRevealFirstSearchResult&&this._searchResults.length>0&&this.revealNextSearchResult())}searchCleared(){WI.revertDOMChanges(this._searchDOMChanges),this._searchQuery=null,this._searchResults=null,this._searchDOMChanges=[],this._searchIndex=-1}revealPreviousSearchResult(e){!this.numberOfSearchResults||(this._searchIndex>0?--this._searchIndex:this._searchIndex=this._searchResults.length-1,this._revealSearchResult(this._searchIndex,e))}revealNextSearchResult(e){!this.numberOfSearchResults||(this._searchIndex+1<this._searchResults.length?++this._searchIndex:this._searchIndex=0,this._revealSearchResult(this._searchIndex,e))}_responseSourceDisplayString(e){switch(e){case WI.Resource.ResponseSource.Network:return WI.UIString("Network");case WI.Resource.ResponseSource.MemoryCache:return WI.UIString("Memory Cache");case WI.Resource.ResponseSource.DiskCache:return WI.UIString("Disk Cache");case WI.Resource.ResponseSource.ServiceWorker:return WI.UIString("Service Worker");case WI.Resource.ResponseSource.Unknown:default:return null}}_refreshSummarySection(){this._summarySection.detailsElement.removeChildren(),this._summarySection.toggleError(this._resource.hadLoadingError());for(let s of this._resource.redirects)this._summarySection.appendKeyValuePair(WI.UIString("URL"),s.url.insertWordBreakCharacters(),"url");this._summarySection.appendKeyValuePair(WI.UIString("URL"),this._resource.url.insertWordBreakCharacters(),"url");let t=emDash;isNaN(this._resource.statusCode)||(t=this._resource.statusCode+(this._resource.statusText?" "+this._resource.statusText:"")),this._summarySection.appendKeyValuePair(WI.UIString("Status"),t);let i=this._responseSourceDisplayString(this._resource.responseSource)||emDash;this._summarySection.appendKeyValuePair(WI.UIString("Source"),i),this._resource.remoteAddress&&this._summarySection.appendKeyValuePair(WI.UIString("Address"),this._resource.remoteAddress);let n=this._resource.initiatorSourceCodeLocation;if(n){let s=document.createDocumentFragment();const a={dontFloat:!0,ignoreSearchTab:!0,ignoreNetworkTab:!0};let d=WI.createSourceCodeLocationLink(n,a);s.appendChild(d);let p=this._resource.initiatorCallFrames;p&&(this._popoverCallStackIconElement=document.createElement("img"),this._popoverCallStackIconElement.className="call-stack",s.appendChild(this._popoverCallStackIconElement),this._popoverCallStackIconElement.addEventListener("click",_=>{this._popover||(this._popover=new WI.Popover(this),this._popover.windowResizeHandler=()=>{this._presentPopoverBelowCallStackElement()});const b=!1;let w=new WI.TreeOutline(b);w.disclosureButtons=!1;let S=new WI.CallFrameTreeController(w);S.callFrames=p;let E=document.createElement("div");E.appendChild(S.treeOutline.element),this._popover.content=E,this._presentPopoverBelowCallStackElement()})),this._summarySection.appendKeyValuePair(WI.UIString("Initiator"),s).classList.add("initiator"),this._popover&&this._popover.visible&&this._presentPopoverBelowCallStackElement()}}_refreshRedirectHeadersSections(){let e=this._redirectDetailsSections.length?this._redirectDetailsSections.lastValue.element:this._summarySection.element;for(let t=this._redirectDetailsSections.length;t<this._resource.redirects.length;++t){let i=this._resource.redirects[t],n=new WI.ResourceDetailsSection(WI.UIString("Request"),"redirect");n.appendKeyValuePair(`${i.requestMethod} ${i.urlComponents.path}`,null,"h1-status");for(let a in i.requestHeaders)n.appendKeyValuePair(a,i.requestHeaders[a],"header");e=this.element.insertBefore(n.element,e.nextElementSibling),this._redirectDetailsSections.push(n);let s=new WI.ResourceDetailsSection(WI.UIString("Redirect Response"),"redirect");s.appendKeyValuePair(`${i.responseStatusCode} ${i.responseStatusText}`,null,"h1-status");for(let a in i.responseHeaders)s.appendKeyValuePair(a,i.responseHeaders[a],"header");e=this.element.insertBefore(s.element,e.nextElementSibling),this._redirectDetailsSections.push(s)}}_refreshRequestHeadersSection(){let e=this._requestHeadersSection.detailsElement;if(e.removeChildren(),this._resource.statusCode!==304){if(this._resource.responseSource===WI.Resource.ResponseSource.MemoryCache){this._requestHeadersSection.markIncompleteSectionWithMessage(WI.UIString("No request, served from the memory cache."));return}if(this._resource.responseSource===WI.Resource.ResponseSource.DiskCache){this._requestHeadersSection.markIncompleteSectionWithMessage(WI.UIString("No request, served from the disk cache."));return}}let t=this._resource.protocol||"",i=this._resource.urlComponents;if(t.startsWith("http/1")){let s=`${this._resource.requestMethod} ${i.path} ${t.toUpperCase()}`;this._requestHeadersSection.appendKeyValuePair(s,null,"h1-status")}else t==="h2"&&(this._requestHeadersSection.appendKeyValuePair(":method",this._resource.requestMethod,"h2-pseudo-header"),this._requestHeadersSection.appendKeyValuePair(":scheme",i.scheme,"h2-pseudo-header"),this._requestHeadersSection.appendKeyValuePair(":authority",WI.h2Authority(i),"h2-pseudo-header"),this._requestHeadersSection.appendKeyValuePair(":path",WI.h2Path(i),"h2-pseudo-header"));let n=this._resource.requestHeaders;for(let s in n)this._requestHeadersSection.appendKeyValuePair(s,n[s],"header");e.firstChild||this._requestHeadersSection.markIncompleteSectionWithMessage(WI.UIString("No request headers"))}_refreshResponseHeadersSection(){let e=this._responseHeadersSection.detailsElement;if(e.removeChildren(),!this._resource.hasResponse()){this._responseHeadersSection.markIncompleteSectionWithLoadingIndicator();return}this._responseHeadersSection.toggleIncomplete(!1);let t=this._resource.protocol||"";if(t.startsWith("http/1")){let n=`${t.toUpperCase()} ${this._resource.statusCode} ${this._resource.statusText}`;this._responseHeadersSection.appendKeyValuePair(n,null,"h1-status")}else t==="h2"&&this._responseHeadersSection.appendKeyValuePair(":status",this._resource.statusCode,"h2-pseudo-header");let i=this._resource.responseHeaders;for(let n in i){if(n.toLowerCase()==="set-cookie"){let s=this._resource.responseCookies;console.assert(s.length>0);for(let a of s)this._responseHeadersSection.appendKeyValuePair(n,a.header,"header");continue}this._responseHeadersSection.appendKeyValuePair(n,i[n],"header")}e.firstChild||this._responseHeadersSection.markIncompleteSectionWithMessage(WI.UIString("No response headers"))}_refreshQueryStringSection(){if(!this._queryStringSection)return;this._queryStringSection.detailsElement.removeChildren();let t=this._resource.urlComponents.queryString,i=parseQueryString(t,!0);for(let{name:n,value:s}of i)this._queryStringSection.appendKeyValuePair(n,s)}_refreshRequestDataSection(){if(!this._requestDataSection)return;let e=this._requestDataSection.detailsElement;e.removeChildren();let t=this._resource.requestData,i=this._resource.requestDataContentType||"";if(i&&i.match(/^application\/x-www-form-urlencoded\s*(;.*)?$/i)){this._requestDataSection.appendKeyValuePair(WI.UIString("MIME Type"),i);let f=parseQueryString(t,!0);for(let{name:_,value:b}of f)this._requestDataSection.appendKeyValuePair(_,b);return}let n=parseMIMEType(i),s=n.type,a=n.boundary,d=n.encoding;this._requestDataSection.appendKeyValuePair(WI.UIString("MIME Type"),s),a&&this._requestDataSection.appendKeyValuePair(WI.UIString("Boundary"),a),d&&this._requestDataSection.appendKeyValuePair(WI.UIString("Encoding"),d);let p=e.appendChild(WI.createGoToArrowButton());p.addEventListener("click",()=>{this._delegate.headersContentViewGoToRequestData(this)}),this._requestDataSection.appendKeyValuePair(WI.UIString("Request Data"),p)}_perfomSearchOnKeyValuePairs(){let e=WI.SearchUtilities.regExpForString(this._searchQuery,WI.SearchUtilities.defaultSettings),t=this.element.querySelectorAll(".key, .value");for(let i of t){let n=[],s=i.textContent,a;for(;a=e.exec(s);)n.push({offset:a.index,length:a[0].length});if(n.length){let d=WI.highlightRangesWithStyleClass(i,n,"search-highlight",this._searchDOMChanges);this._searchResults=this._searchResults.concat(d)}}}_revealSearchResult(e,t){let i=this._searchResults[e];if(!i)return;i.scrollIntoViewIfNeeded(),this._bouncyHighlightElement||(this._bouncyHighlightElement=document.createElement("div"),this._bouncyHighlightElement.className="bouncy-highlight",this._bouncyHighlightElement.addEventListener("animationend",f=>{this._bouncyHighlightElement.remove()})),this._bouncyHighlightElement.remove();let n=window.getComputedStyle(i),s=i.getBoundingClientRect(),a=this.element.getBoundingClientRect(),d=this.element.scrollTop,p=this.element.scrollLeft;this._bouncyHighlightElement.textContent=i.textContent,this._bouncyHighlightElement.style.top=s.top-a.top+d+"px",this._bouncyHighlightElement.style.left=s.left-a.left+p+"px",this._bouncyHighlightElement.style.fontWeight=n.fontWeight,this.element.appendChild(this._bouncyHighlightElement)}_presentPopoverBelowCallStackElement(){let e=WI.Rect.rectFromClientRect(this._popoverCallStackIconElement.getBoundingClientRect());this._popover.present(e.pad(2),[WI.RectEdge.MAX_Y,WI.RectEdge.MIN_Y,WI.RectEdge.MAX_X])}_resourceMetricsDidChange(e){this._needsSummaryRefresh=!0,this._needsRequestHeadersRefresh=!0,this._needsResponseHeadersRefresh=!0,this.needsLayout()}_resourceRequestHeadersDidChange(e){this._needsSummaryRefresh=!0,this._needsRedirectHeadersRefresh=!0,this._needsRequestHeadersRefresh=!0,this.needsLayout()}_resourceResponseReceived(e){this._needsSummaryRefresh=!0,this._needsResponseHeadersRefresh=!0,this.needsLayout()}};WI.ResourceSecurityContentView=class extends WI.ContentView{constructor(e){console.assert(e instanceof WI.Resource),super(),this._resource=e,this._insecureMessageElement=null,this._needsConnectionRefresh=!0,this._needsCertificateRefresh=!0,this._searchQuery=null,this._searchResults=null,this._searchDOMChanges=[],this._searchIndex=-1,this._automaticallyRevealFirstSearchResult=!1,this._bouncyHighlightElement=null,this.element.classList.add("resource-details","resource-security")}initialLayout(){super.initialLayout(),this._connectionSection=new WI.ResourceDetailsSection(WI.UIString("Connection"),"connection"),this.element.appendChild(this._connectionSection.element),this._certificateSection=new WI.ResourceDetailsSection(WI.UIString("Certificate"),"certificate"),this.element.appendChild(this._certificateSection.element),this._resource.addEventListener(WI.Resource.Event.ResponseReceived,this._handleResourceResponseReceived,this),this._resource.addEventListener(WI.Resource.Event.MetricsDidChange,this._handleResourceMetricsDidChange,this)}layout(){if(super.layout(),!this._resource.loadedSecurely){this._insecureMessageElement||(this._insecureMessageElement=WI.createMessageTextView(WI.UIString("The resource was requested insecurely."),!0)),this.element.appendChild(this._insecureMessageElement);return}this._needsConnectionRefresh&&(this._needsConnectionRefresh=!1,this._refreshConnectionSection()),this._needsCertificateRefresh&&(this._needsCertificateRefresh=!1,this._refreshCetificateSection())}closed(){this._resource.removeEventListener(null,null,this),super.closed()}get supportsSearch(){return!0}get numberOfSearchResults(){return this._searchResults?this._searchResults.length:null}get hasPerformedSearch(){return this._searchResults!==null}set automaticallyRevealFirstSearchResult(e){this._automaticallyRevealFirstSearchResult=e,this._automaticallyRevealFirstSearchResult&&this.numberOfSearchResults>0&&this._searchIndex===-1&&this.revealNextSearchResult()}performSearch(e){e!==this._searchQuery&&(WI.revertDOMChanges(this._searchDOMChanges),this._searchQuery=e,this._searchResults=[],this._searchDOMChanges=[],this._searchIndex=-1,this._perfomSearchOnKeyValuePairs(),this.dispatchEventToListeners(WI.ContentView.Event.NumberOfSearchResultsDidChange),this._automaticallyRevealFirstSearchResult&&this._searchResults.length>0&&this.revealNextSearchResult())}searchCleared(){WI.revertDOMChanges(this._searchDOMChanges),this._searchQuery=null,this._searchResults=null,this._searchDOMChanges=[],this._searchIndex=-1}revealPreviousSearchResult(e){!this.numberOfSearchResults||(this._searchIndex>0?--this._searchIndex:this._searchIndex=this._searchResults.length-1,this._revealSearchResult(this._searchIndex,e))}revealNextSearchResult(e){!this.numberOfSearchResults||(this._searchIndex<this._searchResults.length-1?++this._searchIndex:this._searchIndex=0,this._revealSearchResult(this._searchIndex,e))}_refreshConnectionSection(){this._connectionSection.detailsElement.removeChildren();let t=this._resource.security;if(isEmptyObject(t)){this._connectionSection.markIncompleteSectionWithMessage(WI.UIString("No connection security information."));return}let i=t.connection;if(isEmptyObject(i)||Object.values(i).every(n=>!n)){this._connectionSection.markIncompleteSectionWithMessage(WI.UIString("No connection security information."));return}this._connectionSection.appendKeyValuePair(WI.UIString("Protocol"),i.protocol||emDash),this._connectionSection.appendKeyValuePair(WI.UIString("Cipher"),i.cipher||emDash)}_refreshCetificateSection(){this._certificateSection.detailsElement.removeChildren();let t=this._resource.security;if(isEmptyObject(t)){this._certificateSection.markIncompleteSectionWithMessage(WI.UIString("No certificate security information."));return}let i=t.certificate;if(isEmptyObject(i)||Object.values(i).every(a=>!a)){this._certificateSection.markIncompleteSectionWithMessage(WI.UIString("No certificate security information."));return}if(WI.NetworkManager.supportsShowCertificate()){let a=document.createElement("button");a.textContent=WI.UIString("Show full certificate");let d=null;a.addEventListener("click",f=>{this._resource.showCertificate().then(()=>{d&&(d.remove(),d=null)}).catch(_=>{d||(d=WI.ImageUtilities.useSVGSymbol("data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2013 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 10 10'%3e %3cpath fill='white' d='M 4 0.558594 L 6.195312 0.558594 L 6.195312 9.304688 L 4 9.304688 Z'/%3e %3cpath fill='rgb(231%2c 38%2c 34)' d='M 9.996094 7.085938 L 7.058594 10.007812 L 2.917969 9.996094 L -0.00390625 7.0625 L 0.0078125 2.921875 L 2.945312 0 L 7.082031 0.0117188 L 10.007812 2.945312 Z M 6 2 C 6 1.449219 5.550781 1 5 1 C 4.445312 1 4 1.449219 4 2 L 4 5 C 4 5.550781 4.445312 6 5 6 C 5.550781 6 6 5.550781 6 5 Z M 5 7 C 4.445312 7 4 7.449219 4 8 C 4 8.550781 4.445312 9 5 9 C 5.550781 9 6 8.550781 6 8 C 6 7.449219 5.550781 7 5 7 Z'/%3e %3c/svg%3e","error",_)),a.insertAdjacentElement("afterend",d)})}),this._certificateSection.appendKeyValuePair(a).classList.add("show-certificate")}this._certificateSection.appendKeyValuePair(WI.UIString("Subject"),i.subject||emDash);let n=(a,d)=>{if(isNaN(d))return;let p=new Date(d*1e3),f=document.createElement("time");f.datetime=p.toISOString(),f.textContent=p.toLocaleString(),this._certificateSection.appendKeyValuePair(a,f)};n(WI.UIString("Valid From"),i.validFrom),n(WI.UIString("Valid Until"),i.validUntil);let s=(a,d,p)=>{if(!Array.isArray(d))return;const f=5;for(let S=0;S<Math.min(d.length,f);++S)this._certificateSection.appendKeyValuePair(a,d[S],p);let _=d.length-f;if(_<=0)return;let b=document.createElement("a");b.classList.add("show-more"),b.textContent=WI.UIString("Show %d More").format(_);let w=this._certificateSection.appendKeyValuePair(a,b,p);b.addEventListener("click",S=>{w.remove();for(let E=f;E<d.length;++E)this._certificateSection.appendKeyValuePair(a,d[E],p)},{once:!0})};s(WI.UIString("DNS"),i.dnsNames,"dns-name"),s(WI.UIString("IP"),i.ipAddresses,"ip-address")}_perfomSearchOnKeyValuePairs(){let e=WI.SearchUtilities.regExpForString(this._searchQuery,WI.SearchUtilities.defaultSettings),t=this.element.querySelectorAll(".key, .value");for(let i of t){let n=[],s=i.textContent,a;for(;a=e.exec(s);)n.push({offset:a.index,length:a[0].length});if(n.length){let d=WI.highlightRangesWithStyleClass(i,n,"search-highlight",this._searchDOMChanges);this._searchResults=this._searchResults.concat(d)}}}_revealSearchResult(e,t){let i=this._searchResults[e];if(!i)return;i.scrollIntoViewIfNeeded(),this._bouncyHighlightElement||(this._bouncyHighlightElement=document.createElement("div"),this._bouncyHighlightElement.className="bouncy-highlight",this._bouncyHighlightElement.addEventListener("animationend",f=>{this._bouncyHighlightElement.remove()})),this._bouncyHighlightElement.remove();let n=window.getComputedStyle(i),s=i.getBoundingClientRect(),a=this.element.getBoundingClientRect(),d=this.element.scrollTop,p=this.element.scrollLeft;this._bouncyHighlightElement.textContent=i.textContent,this._bouncyHighlightElement.style.top=s.top-a.top+d+"px",this._bouncyHighlightElement.style.left=s.left-a.left+p+"px",this._bouncyHighlightElement.style.fontWeight=n.fontWeight,this.element.appendChild(this._bouncyHighlightElement)}_handleResourceResponseReceived(e){this._needsCertificateRefresh=!0,this.needsLayout()}_handleResourceMetricsDidChange(e){this._needsConnectionRefresh=!0,this.needsLayout()}};WI.ResourceSidebarPanel=class md extends WI.NavigationSidebarPanel{constructor(){super("resource",WI.UIString("Resources"),!0),this._navigationBar=new WI.NavigationBar,this.addSubview(this._navigationBar),this._targetTreeElementMap=new Map;var e="resource-sidebar-",t=[];t.push(new WI.ScopeBarItem(e+"type-all",WI.UIString("All Resources"),{exclusive:!0}));for(var i in WI.Resource.Type){var n=WI.Resource.Type[i],s=new WI.ScopeBarItem(e+n,WI.Resource.displayNameForType(n,!0));s[WI.ResourceSidebarPanel.ResourceTypeSymbol]=n,t.push(s)}this._scopeBar=new WI.ScopeBar("resource-sidebar-scope-bar",t,t[0],!0),this._scopeBar.addEventListener(WI.ScopeBar.Event.SelectionChanged,this._scopeBarSelectionDidChange,this),this._navigationBar.addNavigationItem(this._scopeBar),WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this),WI.networkManager.addEventListener(WI.NetworkManager.Event.MainFrameDidChange,this._mainFrameDidChange,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.ScriptAdded,this._scriptWasAdded,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.ScriptRemoved,this._scriptWasRemoved,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.ScriptsCleared,this._scriptsCleared,this),WI.cssManager.addEventListener(WI.CSSManager.Event.StyleSheetAdded,this._styleSheetAdded,this),WI.targetManager.addEventListener(WI.TargetManager.Event.TargetRemoved,this._targetRemoved,this),WI.notifications.addEventListener(WI.Notification.ExtraDomainsActivated,this._extraDomainsActivated,this),this.contentTreeOutline.addEventListener(WI.TreeOutline.Event.SelectionDidChange,this._treeSelectionDidChange,this),this.contentTreeOutline.includeSourceMapResourceChildren=!0,md.shouldPlaceResourcesAtTopLevel()&&(this.contentTreeOutline.disclosureButtons=!1,WI.SourceCode.addEventListener(WI.SourceCode.Event.SourceMapAdded,()=>{this.contentTreeOutline.disclosureButtons=!0},this))}static shouldPlaceResourcesAtTopLevel(){return WI.sharedApp.debuggableType===WI.DebuggableType.JavaScript&&!WI.sharedApp.hasExtraDomains||WI.sharedApp.debuggableType===WI.DebuggableType.ServiceWorker}get minimumWidth(){return this._navigationBar.minimumWidth}closed(){super.closed(),WI.Frame.removeEventListener(null,null,this),WI.networkManager.removeEventListener(null,null,this),WI.debuggerManager.removeEventListener(null,null,this),WI.notifications.removeEventListener(null,null,this)}showDefaultContentView(){if(WI.networkManager.mainFrame){this.contentBrowser.showContentViewForRepresentedObject(WI.networkManager.mainFrame);return}var e=this.contentTreeOutline.children[0];e&&this.showDefaultContentViewForTreeElement(e)}treeElementForRepresentedObject(e){if(!this._mainFrameTreeElement&&(e instanceof WI.Resource||e instanceof WI.Frame||e instanceof WI.Collection))return null;e instanceof WI.Resource&&e.parentFrame&&e.parentFrame.mainResource===e&&(e=e.parentFrame);function t(d,p){if(p instanceof WI.SourceMapResource){if(p.sourceMap.originalSourceCode===d)return!0;p=p.sourceMap.originalSourceCode}for(var f=p.parentFrame;f;){if(f===d)return!0;f=f.parentFrame}return!1}function i(d){return d instanceof WI.SourceMapResource?d.sourceMap.originalSourceCode:d.parentFrame}var n=this.contentTreeOutline.findTreeElement(e,t,i);if(n)return n;if(!(e instanceof WI.Script))return console.error("Didn't find a TreeElement for representedObject",e),null;if(e.url)return console.error("Didn't find a ScriptTreeElement for a Script with a URL."),null;if(!this._anonymousScriptsFolderTreeElement){let d=new WI.ScriptCollection;this._anonymousScriptsFolderTreeElement=new WI.FolderTreeElement(WI.UIString("Anonymous Scripts"),d)}if(!this._anonymousScriptsFolderTreeElement.parent){var s=insertionIndexForObjectInListSortedByFunction(this._anonymousScriptsFolderTreeElement,this.contentTreeOutline.children,this._compareTreeElements);this.contentTreeOutline.insertChild(this._anonymousScriptsFolderTreeElement,s)}this._anonymousScriptsFolderTreeElement.representedObject.add(e);var a=new WI.ScriptTreeElement(e);return this._anonymousScriptsFolderTreeElement.appendChild(a),a}initialLayout(){super.initialLayout(),WI.networkManager.mainFrame&&this._createMainFrameTreeElement(WI.networkManager.mainFrame);for(let e of WI.debuggerManager.knownNonResourceScripts)this._addScript(e),e.sourceMaps.length&&md.shouldPlaceResourcesAtTopLevel()&&(this.contentTreeOutline.disclosureButtons=!0)}resetFilter(){this._scopeBar.resetToDefault(),super.resetFilter()}hasCustomFilters(){console.assert(this._scopeBar.selectedItems.length===1);var e=this._scopeBar.selectedItems[0];return e&&!e.exclusive}matchTreeElementAgainstCustomFilters(e,t){console.assert(this._scopeBar.selectedItems.length===1);var i=this._scopeBar.selectedItems[0];if(!i||i.exclusive)return!0;if(e instanceof WI.FolderTreeElement)return!1;function n(){return e instanceof WI.FrameTreeElement?i[WI.ResourceSidebarPanel.ResourceTypeSymbol]===WI.Resource.Type.Document:e instanceof WI.ScriptTreeElement?i[WI.ResourceSidebarPanel.ResourceTypeSymbol]===WI.Resource.Type.Script:e instanceof WI.CSSStyleSheetTreeElement?i[WI.ResourceSidebarPanel.ResourceTypeSymbol]===WI.Resource.Type.Stylesheet:(console.assert(e instanceof WI.ResourceTreeElement,"Unknown treeElement",e),e instanceof WI.ResourceTreeElement?e.resource.type===i[WI.ResourceSidebarPanel.ResourceTypeSymbol]:!1)}var s=n();return s&&(t.expandTreeElement=!0),s}_mainResourceDidChange(e){!e.target.isMainFrame()||this._mainFrameMainResourceDidChange(e.target)}_mainFrameDidChange(e){this._mainFrameMainResourceDidChange(WI.networkManager.mainFrame)}_mainFrameMainResourceDidChange(e){if(this.contentBrowser.contentViewContainer.closeAllContentViews(),this._createMainFrameTreeElement(e),!e)return;function t(){if(!this.contentTreeOutline.selectedTreeElement){var i=this.contentBrowser.currentContentView,n=i?this.treeElementForRepresentedObject(i.representedObject):null;n||(n=this._mainFrameTreeElement),this.showDefaultContentViewForTreeElement(n)}}setTimeout(t.bind(this))}_createMainFrameTreeElement(e){this._mainFrameTreeElement&&(this.contentTreeOutline.removeChild(this._mainFrameTreeElement),this._mainFrameTreeElement=null),e&&(this._mainFrameTreeElement=new WI.FrameTreeElement(e),this.contentTreeOutline.insertChild(this._mainFrameTreeElement,0))}_scriptWasAdded(e){this._addScript(e.data.script)}_addScript(e){if(!e.url&&!e.sourceURL)return;if(WI.sharedApp.debuggableType!==WI.DebuggableType.JavaScript&&e.target!==WI.pageTarget){e.isMainResource()&&this._addTargetWithMainResource(e.target),this.contentTreeOutline.disclosureButtons=!0;return}if(e.resource||e.dynamicallyAddedScriptElement)return;let t=!1,i=null;if(e.injected){if(!this._extensionScriptsFolderTreeElement){let a=new WI.ScriptCollection;this._extensionScriptsFolderTreeElement=new WI.FolderTreeElement(WI.UIString("Extension Scripts"),a)}i=this._extensionScriptsFolderTreeElement}else if(md.shouldPlaceResourcesAtTopLevel())t=!0;else{if(!this._extraScriptsFolderTreeElement){let a=new WI.ScriptCollection;this._extraScriptsFolderTreeElement=new WI.FolderTreeElement(WI.UIString("Extra Scripts"),a)}i=this._extraScriptsFolderTreeElement}i&&i.representedObject.add(e);var n=new WI.ScriptTreeElement(e);if(t){var s=insertionIndexForObjectInListSortedByFunction(n,this.contentTreeOutline.children,this._compareTreeElements);this.contentTreeOutline.insertChild(n,s)}else{if(!i.parent){var s=insertionIndexForObjectInListSortedByFunction(i,this.contentTreeOutline.children,this._compareTreeElements);this.contentTreeOutline.insertChild(i,s)}i.appendChild(n)}}_scriptWasRemoved(e){let t=e.data.script,i=this.contentTreeOutline.getCachedTreeElement(t);if(!i)return;let n=i.parent;n.removeChild(i),n instanceof WI.FolderTreeElement&&(n.representedObject.remove(t),n.children.length||n.parent.removeChild(n))}_scriptsCleared(e){if(this._extensionScriptsFolderTreeElement&&(this._extensionScriptsFolderTreeElement.parent&&this._extensionScriptsFolderTreeElement.parent.removeChild(this._extensionScriptsFolderTreeElement,!0,!0),this._extensionScriptsFolderTreeElement.representedObject.clear(),this._extensionScriptsFolderTreeElement=null),this._extraScriptsFolderTreeElement&&(this._extraScriptsFolderTreeElement.parent&&this._extraScriptsFolderTreeElement.parent.removeChild(this._extraScriptsFolderTreeElement,!0,!0),this._extraScriptsFolderTreeElement.representedObject.clear(),this._extraScriptsFolderTreeElement=null),this._anonymousScriptsFolderTreeElement&&(this._anonymousScriptsFolderTreeElement.parent&&this._anonymousScriptsFolderTreeElement.parent.removeChild(this._anonymousScriptsFolderTreeElement,!0,!0),this._anonymousScriptsFolderTreeElement.representedObject.clear(),this._anonymousScriptsFolderTreeElement=null),this._targetTreeElementMap.size){for(let n of this._targetTreeElementMap.values())n.parent.removeChild(n,!0,!0);this._targetTreeElementMap.clear()}}_styleSheetAdded(e){let t=e.data.styleSheet;if(!t.isInspectorStyleSheet())return;let i=this.treeElementForRepresentedObject(t.parentFrame);!i||i.addRepresentedObjectToNewChildQueue(t)}_addTargetWithMainResource(e){console.assert(e.type===WI.Target.Type.Worker||e.type===WI.Target.Type.ServiceWorker);let t=new WI.WorkerTreeElement(e);this._targetTreeElementMap.set(e,t);let i=insertionIndexForObjectInListSortedByFunction(t,this.contentTreeOutline.children,this._compareTreeElements);this.contentTreeOutline.insertChild(t,i)}_targetRemoved(e){let t=e.data.target,i=this._targetTreeElementMap.take(t);i&&i.parent.removeChild(i)}_treeSelectionDidChange(e){if(!this.selected)return;let t=this.contentTreeOutline.selectedTreeElement;if(!!t){if(t instanceof WI.FolderTreeElement||t instanceof WI.ResourceTreeElement||t instanceof WI.ScriptTreeElement||t instanceof WI.CSSStyleSheetTreeElement){const n={ignoreNetworkTab:!0,ignoreSearchTab:!0};WI.showRepresentedObject(t.representedObject,null,n);return}console.error("Unknown tree element",t)}}_compareTreeElements(e,t){return e instanceof WI.FrameTreeElement?-1:t instanceof WI.FrameTreeElement?1:(console.assert(e.mainTitle),console.assert(t.mainTitle),(e.mainTitle||"").extendedLocaleCompare(t.mainTitle||""))}_extraDomainsActivated(){md.shouldPlaceResourcesAtTopLevel()&&(this.contentTreeOutline.disclosureButtons=!0)}_scopeBarSelectionDidChange(e){this.updateFilter()}};WI.ResourceSidebarPanel.ResourceTypeSymbol=Symbol("resource-type");WI.ResourceSizesContentView=class extends WI.ContentView{constructor(e,t){super(null),console.assert(e instanceof WI.Resource),console.assert(t),this._resource=e,this._resource.addEventListener(WI.Resource.Event.SizeDidChange,this._resourceSizeDidChange,this),this._resource.addEventListener(WI.Resource.Event.TransferSizeDidChange,this._resourceTransferSizeDidChange,this),this._resource.addEventListener(WI.Resource.Event.MetricsDidChange,this._resourceMetricsDidChange,this),this._delegate=t,this.element.classList.add("resource-details","resource-sizes"),this._needsTransferSizesRefresh=!1,this._needsResourceSizeRefresh=!1}initialLayout(){super.initialLayout();let e=this.element.appendChild(document.createElement("div"));e.className="content";let t=e.appendChild(document.createElement("section"));t.className="network split";function i(w,S,E,k,R){let M=w.appendChild(document.createElement("div"));M.className="subtitle",M.textContent=S;let L=w.appendChild(document.createElement("div"));L.className="container";let V=L.appendChild(document.createElement("img"));E&&(V.src=E);let H=L.appendChild(document.createElement("div"));H.className="bytes-group";let O=H.appendChild(document.createElement("div"));O.className="bytes";let z=H.appendChild(document.createElement("div"));z.className="suffix";let K=w.appendChild(document.createElement("table")),q=K.appendChild(document.createElement("tr")),Y=q.appendChild(document.createElement("td")),se=q.appendChild(document.createElement("td")),ce=K.appendChild(document.createElement("tr")),le=ce.appendChild(document.createElement("td")),te=ce.appendChild(document.createElement("td"));return Y.textContent=k,Y.className="label",le.textContent=R,le.className="label",{container:L,bytesElement:O,suffixElement:z,imageElement:V,value1Element:se,value2Element:te}}let n=t.appendChild(document.createElement("div"));n.className="subsection";let s=i(n,WI.UIString("Bytes Sent"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 50 50'%3e %3cline stroke='hsl(0%2c 0%25%2c 75%25)' stroke-linecap='round' stroke-width='5' x1='25' y1='6' x2='25' y2='44'/%3e %3cline stroke='hsl(0%2c 0%25%2c 75%25)' stroke-linecap='round' stroke-width='5' x1='25' y1='6' x2='10' y2='22'/%3e %3cline stroke='hsl(0%2c 0%25%2c 75%25)' stroke-linecap='round' stroke-width='5' x1='25' y1='6' x2='40' y2='22'/%3e %3c/svg%3e",WI.UIString("Headers:"),WI.UIString("Body:"));this._sendingBytesElement=s.bytesElement,this._sendingBytesSuffixElement=s.suffixElement,this._sendingHeaderBytesElement=s.value1Element,this._sendingBodyBytesElement=s.value2Element;let a=t.appendChild(document.createElement("div"));a.className="divider";let d=t.appendChild(document.createElement("div"));d.className="subsection";let p=i(d,WI.UIString("Bytes Received"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 50 50'%3e %3cline stroke='hsl(0%2c 0%25%2c 75%25)' stroke-linecap='round' stroke-width='5' x1='25' y1='44' x2='25' y2='6'/%3e %3cline stroke='hsl(0%2c 0%25%2c 75%25)' stroke-linecap='round' stroke-width='5' x1='25' y1='44' x2='10' y2='28'/%3e %3cline stroke='hsl(0%2c 0%25%2c 75%25)' stroke-linecap='round' stroke-width='5' x1='25' y1='44' x2='40' y2='28'/%3e %3c/svg%3e",WI.UIString("Headers:"),WI.UIString("Body:"));this._receivingBytesElement=p.bytesElement,this._receivingBytesSuffixElement=p.suffixElement,this._receivingHeaderBytesElement=p.value1Element,this._receivingBodyBytesElement=p.value2Element;let f=t.appendChild(document.createElement("div"));f.className="divider";let _=t.appendChild(document.createElement("div"));_.className="subsection large";let b=i(_,WI.UIString("Resource Size"),null,WI.UIString("Compression:"),WI.UIString("MIME Type:"));b.container.classList.add(WI.ResourceTreeElement.ResourceIconStyleClassName,this._resource.type),b.imageElement.classList.add("icon"),this._resourceBytesElement=b.bytesElement,this._resourceBytesSuffixElement=b.suffixElement,this._compressionElement=b.value1Element,this._contentTypeElement=b.value2Element,this._refreshTransferSizeSections(),this._refreshResourceSizeSection(),this._needsTransferSizesRefresh=!1,this._needsResourceSizeRefresh=!1}layout(){super.layout(),this._needsTransferSizesRefresh&&(this._refreshTransferSizeSections(),this._needsTransferSizesRefresh=!1),this._needsResourceSizeRefresh&&(this._refreshResourceSizeSection(),this._needsResourceSizeRefresh=!1)}closed(){this._resource.removeEventListener(null,null,this),super.closed()}_sizeComponents(e){if(console.assert(e>=0),e<103)return[e.toFixed(0),"B"];let t=e/1024;if(t<1024)return[t.toFixed(1),"KB"];let i=t/1024;return i<1024?[i.toFixed(1),"MB"]:[(i/1024).toFixed(1),"GB"]}_refreshTransferSizeSections(){let e=this._resource.requestHeadersTransferSize,t=this._resource.requestBodyTransferSize,i=e+t,n=this._resource.responseHeadersTransferSize,s=this._resource.responseBodyTransferSize,a=n+s,[d,p]=this._sizeComponents(i||0);this._sendingBytesElement.textContent=d,this._sendingBytesSuffixElement.textContent=p,this._sendingHeaderBytesElement.textContent=e?Number.bytesToString(e):emDash,this._sendingBodyBytesElement.textContent=t?Number.bytesToString(t):emDash;let[f,_]=this._sizeComponents(a||0);this._receivingBytesElement.textContent=f,this._receivingBytesSuffixElement.textContent=_,this._receivingHeaderBytesElement.textContent=n?Number.bytesToString(n):emDash,this._receivingBodyBytesElement.textContent=s?Number.bytesToString(s):emDash;function b(w,S){w.appendChild(WI.createGoToArrowButton()).addEventListener("click",S)}e&&b(this._sendingHeaderBytesElement,()=>{this._delegate.sizesContentViewGoToHeaders(this)}),t&&b(this._sendingBodyBytesElement,()=>{this._delegate.sizesContentViewGoToRequestBody(this)}),n&&b(this._receivingHeaderBytesElement,()=>{this._delegate.sizesContentViewGoToHeaders(this)}),s&&b(this._receivingBodyBytesElement,()=>{this._delegate.sizesContentViewGoToResponseBody(this)})}_refreshResourceSizeSection(){let e=isNaN(this._resource.networkEncodedSize)?this._resource.estimatedNetworkEncodedSize:this._resource.networkEncodedSize,t=isNaN(this._resource.networkDecodedSize)?this._resource.size:this._resource.networkDecodedSize,i=t/e,n=i>0&&isFinite(i)?WI.UIString("%.2f\xD7").format(i):WI.UIString("None"),[s,a]=this._sizeComponents(t||0);this._resourceBytesElement.textContent=s,this._resourceBytesSuffixElement.textContent=a;let d=this._resource.responseHeaders.valueForCaseInsensitiveKey("Content-Encoding");d&&(n+=` (${d.toLowerCase()})`),this._compressionElement.textContent=n,this._contentTypeElement.textContent=this._resource.mimeType||emDash;const p=1024;i<=1&&e>=p&&WI.shouldTreatMIMETypeAsText(this._resource.mimeType)&&this._compressionElement.appendChild(WI.ImageUtilities.useSVGSymbol("data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2013 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 10 10'%3e %3cpath fill='white' d='M 4 2 L 6.195312 2 L 6.195312 8.996094 L 4 8.996094 Z'/%3e %3cpath fill='rgb(246%2c 187%2c 14)' d='M 9.851562 9.453125 C 9.574219 9.859375 9.007812 9.996094 8.632812 9.996094 C 8.398438 9.996094 1.59375 9.996094 1.367188 9.996094 C 0.992188 9.996094 0.425781 9.859375 0.148438 9.453125 C -0.109375 9.074219 0.03125 8.410156 0.230469 8.046875 C 1.351562 6.027344 2.4375 3.722656 4.023438 0.707031 C 4.535156 -0.265625 5.542969 -0.195312 6.003906 0.695312 C 7.105469 2.832031 8.648438 6.027344 9.769531 8.046875 C 9.96875 8.410156 10.109375 9.074219 9.851562 9.453125 Z M 6 3 C 6 2.449219 5.550781 2 5 2 C 4.449219 2 4 2.449219 4 3 L 4 5 C 4 5.550781 4.449219 6 5 6 C 5.550781 6 6 5.550781 6 5 Z M 5 7 C 4.449219 7 4 7.449219 4 8 C 4 8.550781 4.449219 9 5 9 C 5.550781 9 6 8.550781 6 8 C 6 7.449219 5.550781 7 5 7 Z'/%3e %3c/svg%3e","warning",WI.UIString("This text resource could benefit from compression")))}_resourceSizeDidChange(e){this._needsTransferSizesRefresh=!0,this.needsLayout()}_resourceTransferSizeDidChange(e){this._needsTransferSizesRefresh=!0,this.needsLayout()}_resourceMetricsDidChange(e){this._needsTransferSizesRefresh=!0,this._needsResourceSizeRefresh=!0,this.needsLayout()}};WI.ResourceTimelineDataGridNode=class extends WI.TimelineDataGridNode{constructor(e,t={}){console.assert(e instanceof WI.ResourceTimelineRecord),super([e],t),this._shouldShowPopover=t.shouldShowPopover,this.resource.addEventListener(WI.Resource.Event.LoadingDidFinish,this._needsRefresh,this),this.resource.addEventListener(WI.Resource.Event.LoadingDidFail,this._needsRefresh,this),this.resource.addEventListener(WI.Resource.Event.URLDidChange,this._needsRefresh,this),t.includesGraph?this.record.addEventListener(WI.TimelineRecord.Event.Updated,this._timelineRecordUpdated,this):(this.resource.addEventListener(WI.Resource.Event.TypeDidChange,this._needsRefresh,this),this.resource.addEventListener(WI.Resource.Event.SizeDidChange,this._needsRefresh,this),this.resource.addEventListener(WI.Resource.Event.TransferSizeDidChange,this._needsRefresh,this))}get resource(){return this.record.resource}get data(){return this._cachedData?this._cachedData:(this._cachedData=super.data,this._cachedData.domain=WI.displayNameForHost(this.resource.urlComponents.host),this._cachedData.scheme=this.resource.urlComponents.scheme?this.resource.urlComponents.scheme.toUpperCase():"",this._cachedData.method=this.resource.requestMethod,this._cachedData.type=this.resource.type,this._cachedData.statusCode=this.resource.statusCode,this._cachedData.cached=this.resource.cached,this._cachedData.size=this.resource.size,this._cachedData.transferSize=isNaN(this.resource.networkTotalTransferSize)?this.resource.estimatedTotalTransferSize:this.resource.networkTotalTransferSize,this._cachedData.requestSent=this.resource.requestSentTimestamp-(this.graphDataSource?this.graphDataSource.zeroTime:0),this._cachedData.duration=this.resource.receiveDuration,this._cachedData.latency=this.resource.latency,this._cachedData.protocol=this.resource.protocol,this._cachedData.priority=this.resource.priority,this._cachedData.remoteAddress=this.resource.remoteAddress,this._cachedData.connectionIdentifier=this.resource.connectionIdentifier,this._cachedData.initiator=this.resource.initiatorSourceCodeLocation,this._cachedData)}createCellContent(e,t){this.resource.hadLoadingError()&&t.classList.add("error");let i=this.data[e];switch(e){case"name":return t.classList.add(...this.iconClassNames()),t.title=this.resource.displayURL,this._updateStatus(t),this._createNameCellDocumentFragment();case"type":var s=WI.Resource.displayNameForType(i);return t.title=s,s;case"statusCode":return t.title=this.resource.statusText||"",i||emDash;case"cached":var n=this._cachedCellContent();return t.title=n.textContent,n;case"size":case"transferSize":var s=emDash;return isNaN(i)||(s=Number.bytesToString(i,!0),t.title=s),s;case"requestSent":case"latency":case"duration":var s=emDash;return isNaN(i)||(s=Number.secondsToString(i,!0),t.title=s),s;case"domain":case"method":case"scheme":case"protocol":case"remoteAddress":case"connectionIdentifier":return i&&(t.title=i),i||emDash;case"priority":var a=WI.Resource.displayNameForPriority(i);return a&&(t.title=a),a||emDash;case"source":return super.createCellContent("initiator",t)}return super.createCellContent(e,t)}refresh(){this._scheduledRefreshIdentifier&&(cancelAnimationFrame(this._scheduledRefreshIdentifier),this._scheduledRefreshIdentifier=void 0),this._cachedData=null,super.refresh()}iconClassNames(){return[WI.ResourceTreeElement.ResourceIconStyleClassName,this.resource.type]}appendContextMenuItems(e){WI.appendContextMenuItemsForSourceCode(e,this.resource)}didAddRecordBar(e){!this._shouldShowPopover||!e.records.length||e.records[0].type!==WI.TimelineRecord.Type.Network||(console.assert(!this._mouseEnterRecordBarListener),this._mouseEnterRecordBarListener=this._mouseoverRecordBar.bind(this),e.element.addEventListener("mouseenter",this._mouseEnterRecordBarListener))}didRemoveRecordBar(e){!this._shouldShowPopover||!e.records.length||e.records[0].type!==WI.TimelineRecord.Type.Network||(e.element.removeEventListener("mouseenter",this._mouseEnterRecordBarListener),this._mouseEnterRecordBarListener=null)}filterableDataForColumn(e){return e==="name"?this.resource.url:super.filterableDataForColumn(e)}_createNameCellDocumentFragment(){let e=document.createDocumentFragment(),t=this.displayName();e.append(t);let i=this.resource.parentFrame,n=this.resource.isMainResource(),s;if(i&&n?s=i.parentFrame?i.parentFrame.mainResource.urlComponents.host:null:i&&(s=i.mainResource.urlComponents.host),s!==this.resource.urlComponents.host||i.isMainFrame()&&n){let a=WI.displayNameForHost(this.resource.urlComponents.host);if(t!==a){let d=document.createElement("span");d.classList.add("subtitle"),d.textContent=a,e.append(d)}}return e}_cachedCellContent(){if(!this.resource.hasResponse())return emDash;let e=this.resource.responseSource;if(e===WI.Resource.ResponseSource.MemoryCache||e===WI.Resource.ResponseSource.DiskCache){console.assert(this.resource.cached,"This resource has a cache responseSource it should also be marked as cached",this.resource);let i=document.createElement("span"),n=document.createElement("span");return n.classList="cache-type",n.textContent=e===WI.Resource.ResponseSource.MemoryCache?WI.UIString("(Memory)"):WI.UIString("(Disk)"),i.append(WI.UIString("Yes")," ",n),i}let t=document.createDocumentFragment();return t.append(this.resource.cached?WI.UIString("Yes"):WI.UIString("No")),t}_needsRefresh(){if(this.dataGrid instanceof WI.TimelineDataGrid){this.dataGrid.dataGridNodeNeedsRefresh(this);return}this._scheduledRefreshIdentifier||(this._scheduledRefreshIdentifier=requestAnimationFrame(this.refresh.bind(this)))}_timelineRecordUpdated(e){this.isRecordVisible(this.record)&&this.needsGraphRefresh()}_dataGridNodeGoToArrowClicked(){const e={ignoreNetworkTab:!0,ignoreSearchTab:!0};WI.showSourceCode(this.resource,e)}_updateStatus(e){this.resource.failed?e.classList.add("error"):(e.classList.remove("error"),this.resource.finished&&this.createGoToArrowButton(e,this._dataGridNodeGoToArrowClicked.bind(this))),this.resource.isLoading()?(this._spinner||(this._spinner=new WI.IndeterminateProgressSpinner),e.firstChild.appendChild(this._spinner.element)):this._spinner&&this._spinner.element.remove()}_mouseoverRecordBar(e){let t=WI.TimelineRecordBar.fromElement(e.target);if(console.assert(t),!t)return;let i=()=>{let p=WI.Rect.rectFromClientRect(this.elementWithColumnIdentifier("graph").getBoundingClientRect()),f=WI.Rect.rectFromClientRect(e.target.getBoundingClientRect());return p.intersectionWithRect(f)},n=i();if(!n.size.width&&!n.size.height)return;console.assert(t.records.length);let s=t.records[0].resource;if(!s.timingData||!s.timingData.responseEnd)return;this.dataGrid._dismissPopoverTimeout&&(clearTimeout(this.dataGrid._dismissPopoverTimeout),this.dataGrid._dismissPopoverTimeout=void 0);let a=document.createElement("div");if(a.classList.add("resource-timing-popover-content"),s.failed||s.urlComponents.scheme==="data"||s.cached&&s.statusCode!==304){let p=document.createElement("span");p.classList.add("description"),s.failed?p.textContent=WI.UIString("Resource failed to load."):s.urlComponents.scheme==="data"?p.textContent=WI.UIString("Resource was loaded with the \u201Cdata\u201D scheme."):p.textContent=WI.UIString("Resource was served from the cache."),a.appendChild(p)}else{let p={description:{width:"80px"},graph:{width:`${WI.ResourceTimelineDataGridNode.PopoverGraphColumnWidthPixels}px`},duration:{width:"70px",aligned:"right"}},f=new WI.DataGrid(p);f.inline=!0,f.headerVisible=!1,a.appendChild(f.element);let _={get secondsPerPixel(){return s.totalDuration/WI.ResourceTimelineDataGridNode.PopoverGraphColumnWidthPixels},get zeroTime(){return s.firstTimestamp},get startTime(){return this.zeroTime},get currentTime(){return s.lastTimestamp+this._extraTimePadding},get endTime(){return this.currentTime},get _extraTimePadding(){return this.secondsPerPixel*WI.TimelineRecordBar.MinimumWidthPixels}};s.timingData.redirectEnd-s.timingData.redirectStart&&f.appendChild(new WI.ResourceTimingPopoverDataGridNode(WI.UIString("Redirects"),s.timingData.redirectStart,s.timingData.redirectEnd,_));let b=s.timingData.domainLookupStart||s.timingData.connectStart||s.timingData.requestStart;b-s.timingData.fetchStart&&f.appendChild(new WI.ResourceTimingPopoverDataGridNode(WI.UIString("Stalled"),s.timingData.fetchStart,b,_)),s.timingData.domainLookupStart&&f.appendChild(new WI.ResourceTimingPopoverDataGridNode(WI.UIString("DNS"),s.timingData.domainLookupStart,s.timingData.domainLookupEnd,_)),s.timingData.connectStart&&f.appendChild(new WI.ResourceTimingPopoverDataGridNode(WI.UIString("Connection"),s.timingData.connectStart,s.timingData.connectEnd,_)),s.timingData.secureConnectionStart&&f.appendChild(new WI.ResourceTimingPopoverDataGridNode(WI.UIString("Secure"),s.timingData.secureConnectionStart,s.timingData.connectEnd,_)),f.appendChild(new WI.ResourceTimingPopoverDataGridNode(WI.UIString("Request"),s.timingData.requestStart,s.timingData.responseStart,_)),f.appendChild(new WI.ResourceTimingPopoverDataGridNode(WI.UIString("Response"),s.timingData.responseStart,s.timingData.responseEnd,_));const w=!0;let S={description:WI.UIString("Total time"),duration:Number.secondsToMillisecondsString(s.timingData.responseEnd-s.timingData.startTime,w)};f.appendChild(new WI.DataGridNode(S)),f.updateLayout()}this.dataGrid._popover||(this.dataGrid._popover=new WI.Popover);let d=[WI.RectEdge.MAX_Y,WI.RectEdge.MIN_Y,WI.RectEdge.MIN_X];this.dataGrid._popover.windowResizeHandler=()=>{let p=i();this.dataGrid._popover.present(p.pad(2),d)},t.element.addEventListener("mouseleave",()=>{!this.dataGrid||(this.dataGrid._dismissPopoverTimeout=setTimeout(()=>{this.dataGrid&&this.dataGrid._popover.dismiss()},WI.ResourceTimelineDataGridNode.DelayedPopoverDismissalTimeout))},{once:!0}),this.dataGrid._popover.presentNewContentWithFrame(a,n.pad(2),d)}};WI.ResourceTimelineDataGridNode.PopoverGraphColumnWidthPixels=110;WI.ResourceTimelineDataGridNode.DelayedPopoverDismissalTimeout=500;WI.ResourceTimingBreakdownView=class extends WI.View{constructor(e,t){super(null),console.assert(e.timingData.startTime&&e.timingData.responseEnd,"Timing breakdown view requires a resource with timing data."),console.assert(!t||t>=100,"fixedWidth must be at least wide enough for strings."),this._resource=e,this.element.classList.add("resource-timing-breakdown"),t&&(this.element.style.width=t+"px")}_appendEmptyRow(){let e=this._tableElement.appendChild(document.createElement("tr"));return e.className="empty",e}_appendHeaderRow(e,t,i){let n=this._tableElement.appendChild(document.createElement("tr"));n.className="header",i&&n.classList.add(i);let s=n.appendChild(document.createElement("td"));s.className="label",s.textContent=e,s.colSpan=2;let a=n.appendChild(document.createElement("td"));return a.className="time",t?a.textContent=t:t===void 0&&a.appendChild(document.createElement("hr")),n}_appendRow(e,t,i,n){let s=this._tableElement.appendChild(document.createElement("tr")),a=s.appendChild(document.createElement("td"));a.className="label",a.textContent=e;let d=n-i,p=d/this._graphDuration*100,f=(i-this._graphStartTime)/this._graphDuration*100,_=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?"right":"left",b=s.appendChild(document.createElement("td"));b.className="graph";let w=b.appendChild(document.createElement("div"));w.classList.add("block",t),w.style.width=p+"%",w.style[_]=f+"%";let S=s.appendChild(document.createElement("td"));return S.className="time",S.textContent=Number.secondsToMillisecondsString(d),s}_appendServerTimingRow(e,t,i){let n=this._tableElement.appendChild(document.createElement("tr")),s=n.appendChild(document.createElement("td"));if(s.className="label",s.textContent=e,t!==void 0){let a=t/i*100,d=n.appendChild(document.createElement("td"));d.className="graph";let p=d.appendChild(document.createElement("div"));p.classList.add("block","response"),p.style.width=a+"%",p.style.right=0;let f=n.appendChild(document.createElement("td"));f.className="time",f.textContent=Number.secondsToMillisecondsString(t/1e3)}return n}_appendDividerRow(){let e=this._appendEmptyRow().appendChild(document.createElement("td"));e.colSpan=3,e.appendChild(document.createElement("hr"))}initialLayout(){super.initialLayout();let{startTime:e,redirectStart:t,redirectEnd:i,fetchStart:n,domainLookupStart:s,domainLookupEnd:a,connectStart:d,connectEnd:p,secureConnectionStart:f,requestStart:_,responseStart:b,responseEnd:w}=this._resource.timingData,S=this._resource.serverTiming;if(this._tableElement=this.element.appendChild(document.createElement("table")),this._tableElement.className="waterfall",this._graphStartTime=e,this._graphEndTime=w,this._graphDuration=this._graphEndTime-this._graphStartTime,this._appendHeaderRow(WI.UIString("Scheduling:")),i-t&&this._appendRow(WI.UIString("Redirects"),"redirect",t,i),this._appendRow(WI.UIString("Queued"),"queue",n,s||d||_),(s||d)&&(this._appendEmptyRow(),this._appendHeaderRow(WI.UIString("Connection:")),s&&this._appendRow(WI.UIString("DNS"),"dns",s,a||d||_),d&&this._appendRow(WI.UIString("TCP"),"connect",d,p||_),f&&this._appendRow(WI.UIString("Secure"),"secure",f,p||_)),this._appendEmptyRow(),this._appendHeaderRow(WI.UIString("Response:")),this._appendRow(WI.UIString("Waiting"),"request",_,b),this._appendRow(WI.UIString("Download"),"response",b,w),this._appendEmptyRow(),this._appendHeaderRow(WI.UIString("Totals:")),this._appendHeaderRow(WI.UIString("Time to First Byte"),Number.secondsToMillisecondsString(b-e),"total-row"),this._appendHeaderRow(WI.UIString("Start to Finish"),Number.secondsToMillisecondsString(w-e),"total-row"),S.length>0){this._appendDividerRow(),this._appendHeaderRow(WI.UIString("Server Timing:"));let E=S.reduce((k,{duration:R=0})=>Math.max(k,R),0);for(let k of S){let{name:R,duration:M,description:L}=k;this._appendServerTimingRow(L||R,M,E)}}}};WI.ResourceTimingContentView=class extends WI.ContentView{constructor(e){super(null),console.assert(e instanceof WI.Resource),this._resource=e,this._resource.addEventListener(WI.Resource.Event.MetricsDidChange,this._resourceMetricsDidChange,this),this._resource.addEventListener(WI.Resource.Event.TimestampsDidChange,this._resourceTimestampsDidChange,this),this.element.classList.add("resource-details","resource-timing"),this._needsTimingRefresh=!1}initialLayout(){super.initialLayout(),this._refreshTimingSection(),this._needsTimingRefresh=!1}layout(){super.layout(),this._needsTimingRefresh&&(this._refreshTimingSection(),this._needsTimingRefresh=!1)}closed(){this._resource.removeEventListener(null,null,this),super.closed()}_refreshTimingSection(){if(this.element.removeChildren(),!this._resource.hasResponse()){let n=new WI.IndeterminateProgressSpinner;this.element.appendChild(n.element);return}if(!this._resource.timingData.startTime||!this._resource.timingData.responseEnd){this.element.appendChild(WI.createMessageTextView(WI.UIString("Resource does not have timing data"),!1));return}let e=this.element.appendChild(document.createElement("div"));e.className="content";let t=e.appendChild(document.createElement("section"));t.className="timing";let i=new WI.ResourceTimingBreakdownView(this._resource);t.appendChild(i.element),i.updateLayout()}_resourceMetricsDidChange(e){this._needsTimingRefresh=!0,this.needsLayout()}_resourceTimestampsDidChange(e){this._needsTimingRefresh=!0,this.needsLayout()}};WI.ResourceTimingPopoverDataGridNode=class extends WI.TimelineDataGridNode{constructor(e,t,i,n){let s=new WI.TimelineRecord(WI.TimelineRecord.Type.Network,t,i);super([s],{includesGraph:!0,graphDataSource:n});const a=!0;let d=Number.secondsToMillisecondsString(i-t,a);this._data={description:e,duration:d}}get data(){return this._data}get selectable(){return!1}createCellContent(e,t){let i=this.data[e];switch(e){case"description":case"duration":return i||emDash}return super.createCellContent(e,t)}};WI.ScopeBar=class extends WI.NavigationItem{constructor(e,t,i,n){super(e),this._element.classList.add("scope-bar"),this._items=t,this._defaultItem=i,this._shouldGroupNonExclusiveItems=n||!1,this._minimumWidth=0,this._populate()}get minimumWidth(){return this._minimumWidth||(this.element.style.flexWrap="initial !important",this._multipleItem&&this._multipleItem.displayWidestItem(),this._minimumWidth=this.element.realOffsetWidth,this.element.style.flexWrap=null,this._multipleItem&&this._multipleItem.displaySelectedItem()),this._minimumWidth}get defaultItem(){return this._defaultItem}get items(){return this._items}item(e){return this._itemsById.get(e)}get selectedItems(){return this._items.filter(e=>e.selected)}hasNonDefaultItemSelected(){return this._items.some(e=>e.selected&&e!==this._defaultItem)}resetToDefault(){let e=this.selectedItems;if(!(e.length===1&&e[0]===this._defaultItem)){for(let t of this._items)t.selected=!1;this._defaultItem.selected=!0,this.dispatchEventToListeners(WI.ScopeBar.Event.SelectionChanged)}}_populate(){if(this._itemsById=new Map,this._shouldGroupNonExclusiveItems){var e=[];for(var t of this._items)this._itemsById.set(t.id,t),t.exclusive?this._element.appendChild(t.element):e.push(t),t.addEventListener(WI.ScopeBarItem.Event.SelectionChanged,this._itemSelectionDidChange,this);this._multipleItem=new WI.MultipleScopeBarItem(e),this._element.appendChild(this._multipleItem.element)}else for(var t of this._items)this._itemsById.set(t.id,t),this._element.appendChild(t.element),t.addEventListener(WI.ScopeBarItem.Event.SelectionChanged,this._itemSelectionDidChange,this);this._defaultItem&&(this.selectedItems.length||(this._defaultItem.selected=!0),this._element.classList.toggle("default-item-selected",this._defaultItem.selected))}_itemSelectionDidChange(e){var t=e.target,i;if(t.exclusive&&t.selected)for(var n=0;n<this._items.length;++n)i=this._items[n],i!==t&&(i.selected=!1);else{let s=this._shouldGroupNonExclusiveItems||!e.data.extendSelection;for(var n=0;n<this._items.length;++n)i=this._items[n],(i.exclusive&&i!==t&&t.selected||t.selected&&s&&t!==i)&&(i.selected=!1)}this._defaultItem&&(this.selectedItems.length||(this._defaultItem.selected=!0),this._element.classList.toggle("default-item-selected",this._defaultItem.selected)),this.dispatchEventToListeners(WI.ScopeBar.Event.SelectionChanged)}};WI.ScopeBar.Event={SelectionChanged:"scopebar-selection-did-change"};WI.ScopeBarItem=class extends WI.Object{constructor(e,t,{className:i,exclusive:n,independent:s,hidden:a}={}){super(),this._element=document.createElement("li"),this._element.classList.toggle("exclusive",!!n),i&&this._element.classList.add(i),this._element.textContent=t,this._element.addEventListener("mousedown",this._handleMouseDown.bind(this)),this._id=e,this._label=t,this._exclusive=!!n,this._independent=!!s,this._hidden=!!a,this._selectedSetting=new WI.Setting("scopebaritem-"+e,!1),this._element.classList.toggle("selected",this._selectedSetting.value),this._element.classList.toggle("hidden",this._hidden)}get element(){return this._element}get id(){return this._id}get label(){return this._label}get exclusive(){return this._exclusive}get selected(){return this._selectedSetting.value}set selected(e){this._selectedSetting.value!==e&&(this._element.classList.toggle("selected",e),this._selectedSetting.value=e,this.dispatchEventToListeners(WI.ScopeBarItem.Event.SelectionChanged,{extendSelection:this._independent||WI.modifierKeys.metaKey&&!WI.modifierKeys.ctrlKey&&!WI.modifierKeys.altKey&&!WI.modifierKeys.shiftKey}))}get hidden(){return this._hidden}set hidden(e){this._hidden!==e&&(this._hidden=e,this._element.classList.toggle("hidden",e),this.dispatchEventToListeners(WI.ScopeBarItem.Event.HiddenChanged))}_handleMouseDown(e){e.button===0&&(this.selected=!this.selected)}};WI.ScopeBarItem.Event={SelectionChanged:"scope-bar-item-selection-changed",HiddenChanged:"scope-bar-item-hidden-changed"};WI.ScopeChainDetailsSidebarPanel=class extends WI.DetailsSidebarPanel{constructor(){super("scope-chain",WI.UIString("Scope Chain")),this._callFrame=null,this._watchExpressionsSetting=new WI.Setting("watch-expressions",[]),this._watchExpressionsSetting.addEventListener(WI.Setting.Event.Changed,this._updateWatchExpressionsNavigationBar,this),this._watchExpressionOptionsElement=document.createElement("div"),this._watchExpressionOptionsElement.classList.add("options"),this._navigationBar=new WI.NavigationBar,this._watchExpressionOptionsElement.appendChild(this._navigationBar.element);let e=new WI.ButtonNavigationItem("add-watch-expression",WI.UIString("Add watch expression"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 13'%3e %3cpath fill='none' stroke='currentColor' d='M 6.5 1 V 12 M 1 6.5 H 12'/%3e %3c/svg%3e",13,13);e.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._addWatchExpressionButtonClicked,this),this._navigationBar.addNavigationItem(e),this._clearAllWatchExpressionButton=new WI.ButtonNavigationItem("clear-watch-expressions",WI.UIString("Clear watch expressions"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' d='M 3.5 12.5 l -1 -10 h -1 h 11.9 h -1 l -1 10 H 3.5 z'/%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' d='M 5.5 2 L 5.5 0.5 L 9.5 0.5 L 9.5 2'/%3e %3cline fill='none' stroke='currentColor' stroke-linecap='round' x1='5.5' y1='9.2' x2='9.4' y2='5.3'/%3e %3cline fill='none' stroke='currentColor' stroke-linecap='round' x1='5.5' y1='5.2' x2='9.4' y2='9.2'/%3e %3c/svg%3e",15,15),this._clearAllWatchExpressionButton.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._clearAllWatchExpressionsButtonClicked,this),this._navigationBar.addNavigationItem(this._clearAllWatchExpressionButton),this._refreshAllWatchExpressionButton=new WI.ButtonNavigationItem("refresh-watch-expressions",WI.UIString("Refresh watch expressions"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='1 1 13 13'%3e %3cpath fill='currentColor' d='M 12.007 8.01 L 12.007 8.488 L 12 8.488 C 12 10.974 9.985 12.988 7.5 12.988 C 5.015 12.988 3 10.974 3 8.488 C 3 6.17 4.759 4.284 7.012 4.037 L 7.012 6.549 L 11.519 3.775 L 7.012 1 L 7.012 3.013 C 4.203 3.26 2 5.615 2 8.488 C 2 11.526 4.462 13.988 7.5 13.988 C 10.509 13.988 12.95 11.571 12.996 8.572 L 13 8.572 L 13 8.01 L 12.007 8.01 Z'/%3e %3c/svg%3e",13,13),this._refreshAllWatchExpressionButton.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._refreshAllWatchExpressionsButtonClicked,this),this._navigationBar.addNavigationItem(this._refreshAllWatchExpressionButton),this._watchExpressionsSectionGroup=new WI.DetailsSectionGroup,this._watchExpressionsSection=new WI.DetailsSection("watch-expressions",WI.UIString("Watch Expressions"),[this._watchExpressionsSectionGroup],this._watchExpressionOptionsElement),this.contentView.element.appendChild(this._watchExpressionsSection.element),this._updateWatchExpressionsNavigationBar(),this.needsLayout(),WI.runtimeManager.addEventListener(WI.RuntimeManager.Event.DidEvaluate,this._didEvaluateExpression,this),WI.runtimeManager.addEventListener(WI.RuntimeManager.Event.ActiveExecutionContextChanged,this._activeExecutionContextChanged,this),WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.ActiveCallFrameDidChange,this._activeCallFrameDidChange,this)}inspect(e){e instanceof Array||(e=[e]);for(var t=null,i=0;i<e.length;++i)if(e[i]instanceof WI.CallFrame){t=e[i];break}return this.callFrame=t,!0}get callFrame(){return this._callFrame}set callFrame(e){e!==this._callFrame&&(this._callFrame=e,this.needsLayout())}closed(){WI.runtimeManager.removeEventListener(null,null,this),WI.Frame.removeEventListener(null,null,this),WI.debuggerManager.removeEventListener(null,null,this),super.closed()}layout(){let e=this._callFrame;Promise.all([this._generateWatchExpressionsSection(),this._generateCallFramesSection()]).then(function(t){let[i,n]=t;function s(){if(clearTimeout(d),i)this._watchExpressionsSectionGroup.rows=[i];else{let p=new WI.DetailsSectionRow(WI.UIString("No Watch Expressions"));this._watchExpressionsSectionGroup.rows=[p],p.showEmptyMessage()}if(this.contentView.element.removeChildren(),this.contentView.element.appendChild(this._watchExpressionsSection.element),this._callFrame===e&&!!n)for(let p of n)this.contentView.element.appendChild(p.element)}let a=WI.ScopeChainDetailsSidebarPanel._autoExpandProperties.size===0?50:250,d=setTimeout(s.bind(this),a);InspectorBackend.runAfterPendingDispatches(s.bind(this))}.bind(this)).catch(function(t){console.error(t)})}_generateCallFramesSection(){let e=this._callFrame;if(!e)return Promise.resolve(null);let t=[],i=!1,n=new Map;for(let a in WI.ScopeChainNode.Type)n.set(WI.ScopeChainNode.Type[a],0);let s=e.mergedScopeChain();for(let a of s){if(a.empty&&a.type!==WI.ScopeChainNode.Type.Local)continue;let d=null,p=null,f=!1,_=n.get(a.type);switch(n.set(a.type,++_),a.type){case WI.ScopeChainNode.Type.Local:i=!0,f=!1,d=WI.UIString("Local Variables"),e.thisObject&&(p=new WI.PropertyDescriptor({name:"this",value:e.thisObject}));break;case WI.ScopeChainNode.Type.Closure:a.__baseClosureScope&&a.name?d=WI.UIString("Closure Variables (%s)").format(a.name):d=WI.UIString("Closure Variables"),f=!1;break;case WI.ScopeChainNode.Type.Block:d=WI.UIString("Block Variables"),f=!1;break;case WI.ScopeChainNode.Type.Catch:d=WI.UIString("Catch Variables"),f=!1;break;case WI.ScopeChainNode.Type.FunctionName:d=WI.UIString("Function Name Variable"),f=!0;break;case WI.ScopeChainNode.Type.With:d=WI.UIString("With Object Properties"),f=i;break;case WI.ScopeChainNode.Type.Global:d=WI.UIString("Global Variables"),f=!0;break;case WI.ScopeChainNode.Type.GlobalLexicalEnvironment:d=WI.UIString("Global Lexical Environment"),f=!0;break}let b=a.type+"-"+n.get(a.type),w=new WI.DetailsSection(b,d,null,null,f),S=[];for(let E of a.objects){let k=WI.PropertyPath.emptyPropertyPathForScope(E),R=new WI.ObjectTreeView(E,WI.ObjectTreeView.Mode.Properties,k);R.showOnlyProperties(),p&&(R.appendExtraPropertyDescriptor(p),p=null);let M=R.treeOutline;M.registerScrollVirtualizer(this.contentView.element,16),M.addEventListener(WI.TreeOutline.Event.ElementAdded,this._treeElementAdded.bind(this,b),this),M.addEventListener(WI.TreeOutline.Event.ElementDisclosureDidChanged,this._treeElementDisclosureDidChange.bind(this,b),this),S.push(new WI.ObjectPropertiesDetailSectionRow(R,w))}w.groups[0].rows=S,t.push(w)}return Promise.resolve(t)}_generateWatchExpressionsSection(){let e=this._watchExpressionsSetting.value;if(!e.length){if(this._usedWatchExpressionsObjectGroup){this._usedWatchExpressionsObjectGroup=!1;for(let p of WI.targets)p.RuntimeAgent.releaseObjectGroup(WI.ScopeChainDetailsSidebarPanel.WatchExpressionsObjectGroupName)}return Promise.resolve(null)}for(let p of WI.targets)p.RuntimeAgent.releaseObjectGroup(WI.ScopeChainDetailsSidebarPanel.WatchExpressionsObjectGroupName);this._usedWatchExpressionsObjectGroup=!0;let t=WI.RemoteObject.createFakeRemoteObject(),i=WI.PropertyPath.emptyPropertyPathForScope(t),n=new WI.ObjectTreeView(t,WI.ObjectTreeView.Mode.Properties,i);n.showOnlyProperties();let s=n.treeOutline;const a="watch-expressions";s.addEventListener(WI.TreeOutline.Event.ElementAdded,this._treeElementAdded.bind(this,a),this),s.addEventListener(WI.TreeOutline.Event.ElementDisclosureDidChanged,this._treeElementDisclosureDidChange.bind(this,a),this),s.objectTreeElementAddContextMenuItems=this._objectTreeElementAddContextMenuItems.bind(this);let d=[];for(let p of e)d.push(new Promise(function(f,_){let b={objectGroup:WI.ScopeChainDetailsSidebarPanel.WatchExpressionsObjectGroupName,includeCommandLineAPI:!1,doNotPauseOnExceptionsAndMuteConsole:!0,returnByValue:!1,generatePreview:!0,saveResult:!1};WI.runtimeManager.evaluateInInspectedWindow(p,b,function(w,S){w=w||WI.RemoteObject.fromPrimitiveValue(void 0);let E=new WI.PropertyDescriptor({name:p,value:w},void 0,void 0,S);n.appendExtraPropertyDescriptor(E),f()})}));return Promise.all(d).then(function(){return Promise.resolve(new WI.ObjectPropertiesDetailSectionRow(n))})}_addWatchExpression(e){let t=this._watchExpressionsSetting.value.slice(0);t.push(e),this._watchExpressionsSetting.value=t,this.needsLayout()}_removeWatchExpression(e){let t=this._watchExpressionsSetting.value.slice(0);t.remove(e,!0),this._watchExpressionsSetting.value=t,this.needsLayout()}_clearAllWatchExpressions(){this._watchExpressionsSetting.value=[],this.needsLayout()}_addWatchExpressionButtonClicked(e){function t(){let p=WI.Rect.rectFromClientRect(e.target.element.getBoundingClientRect());i.present(p,[WI.RectEdge.MAX_Y,WI.RectEdge.MIN_Y,WI.RectEdge.MAX_X])}let i=new WI.Popover(this),n=document.createElement("div");n.classList.add("watch-expression"),n.appendChild(document.createElement("div")).textContent=WI.UIString("Add New Watch Expression");let s=n.appendChild(document.createElement("div"));s.classList.add("watch-expression-editor",WI.SyntaxHighlightedStyleClassName),this._codeMirror=WI.CodeMirrorEditor.create(s,{lineWrapping:!0,mode:"text/javascript",matchBrackets:!0,value:""}),this._popoverCommitted=!1,this._codeMirror.addKeyMap({Enter:()=>{this._popoverCommitted=!0,i.dismiss()}}),new WI.CodeMirrorCompletionController(this._codeMirror).addExtendedCompletionProvider("javascript",WI.javaScriptRuntimeCompletionProvider);let d=0;this._codeMirror.on("changes",function(p,f){let _=p.getScrollInfo().height;d!==_&&(d=_,i.update(!1))}),i.content=n,i.windowResizeHandler=t,t(),setTimeout(()=>{this._codeMirror.refresh(),this._codeMirror.focus(),i.update()},0)}willDismissPopover(e){if(this._popoverCommitted){let t=this._codeMirror.getValue().trim();t&&this._addWatchExpression(t)}this._codeMirror=null}_refreshAllWatchExpressionsButtonClicked(e){this.needsLayout()}_clearAllWatchExpressionsButtonClicked(e){this._clearAllWatchExpressions()}_didEvaluateExpression(e){e.data.objectGroup!==WI.ScopeChainDetailsSidebarPanel.WatchExpressionsObjectGroupName&&this.needsLayout()}_activeExecutionContextChanged(){this.needsLayout()}_activeCallFrameDidChange(){this.needsLayout()}_mainResourceDidChange(e){!e.target.isMainFrame()||this.needsLayout()}_objectTreeElementAddContextMenuItems(e,t){e.parent===e.treeOutline&&t.appendItem(WI.UIString("Remove Watch Expression"),()=>{let i=e.property.name;this._removeWatchExpression(i)})}_propertyPathIdentifierForTreeElement(e,t){if(!t.property)return null;let i=t.thisPropertyPath();return i.isFullPathImpossible()?null:e+"-"+i.fullPath}_treeElementAdded(e,t){let i=t.data.element,n=this._propertyPathIdentifierForTreeElement(e,i);!n||WI.ScopeChainDetailsSidebarPanel._autoExpandProperties.has(n)&&i.expand()}_treeElementDisclosureDidChange(e,t){let i=t.data.element,n=this._propertyPathIdentifierForTreeElement(e,i);!n||(i.expanded?WI.ScopeChainDetailsSidebarPanel._autoExpandProperties.add(n):WI.ScopeChainDetailsSidebarPanel._autoExpandProperties.delete(n))}_updateWatchExpressionsNavigationBar(){let e=this._watchExpressionsSetting.value.length;this._refreshAllWatchExpressionButton.enabled=e,this._clearAllWatchExpressionButton.enabled=e}};WI.ScopeChainDetailsSidebarPanel._autoExpandProperties=new Set;WI.ScopeChainDetailsSidebarPanel.WatchExpressionsObjectGroupName="watch-expressions";WI.ScopeRadioButtonNavigationItem=class extends WI.RadioButtonNavigationItem{constructor(e,t,i,n){super(e,t),this._scopeItems=i||[],this._element.classList.add("scope-radio-button-navigation-item"),this._element.title=n?n.label:this._scopeItems[0].label,this._scopeItemSelect=document.createElement("select"),this._scopeItemSelect.classList.add("scope-radio-button-item-select");for(var s of this._scopeItems){var a=document.createElement("option");a.value=s.identifier,a.text=s.label,this._scopeItemSelect.appendChild(a)}this.selectedItemIdentifier=n?n.identifier:this._scopeItems[0].identifier,this._scopeItemSelect.addEventListener("change",this._handleItemChanged.bind(this)),this._element.appendChild(this._scopeItemSelect),this._element.appendChild(WI.ImageUtilities.useSVGSymbol("data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 5 12'%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='square' d='M 0.5 3.5 L 2.5 1.5 L 4.5 3.5'/%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='square' d='M 0.5 8.5 L 2.5 10.5 L 4.5 8.5'/%3e %3c/svg%3e","arrows"))}set selectedItemIdentifier(e){!e||(this._scopeItemSelect.value=e)}get selectedItemIdentifier(){return this._scopeItemSelect.value}dontPreventDefaultOnNavigationBarMouseDown(){return!0}_handleItemChanged(){var e;for(var t of this._scopeItems)if(t.identifier===this.selectedItemIdentifier){e=t;break}this._element.title=e.label,this.dispatchEventToListeners(WI.ScopeRadioButtonNavigationItem.Event.SelectedItemChanged)}};WI.ScopeRadioButtonNavigationItem.Event={SelectedItemChanged:"scope-radio-button-navigation-item-selected-item-changed"};WI.ScriptClusterTimelineView=class extends WI.ClusterContentView{constructor(e,t){super(e),console.assert(e.type===WI.TimelineRecord.Type.Script),this._currentContentViewSetting=new WI.Setting("script-cluster-timeline-view-current-view",WI.ScriptClusterTimelineView.EventsIdentifier);let i=this._canShowProfileView();function n(s,a,d){let p=new WI.HierarchicalPathComponent(s,a,d,!1,i);return p.addEventListener(WI.HierarchicalPathComponent.Event.SiblingWasSelected,this._pathComponentSelected,this),p.comparisonData=e,p}this._eventsPathComponent=n.call(this,WI.UIString("Events"),"events-icon",WI.ScriptClusterTimelineView.EventsIdentifier),this._profilePathComponent=n.call(this,WI.UIString("Call Trees"),"call-trees-icon",WI.ScriptClusterTimelineView.ProfileIdentifier),this._canShowProfileView()&&(this._eventsPathComponent.nextSibling=this._profilePathComponent,this._profilePathComponent.previousSibling=this._eventsPathComponent),this._eventsContentView=new WI.ScriptDetailsTimelineView(this.representedObject,t),this._profileContentView=this._canShowProfileView()?new WI.ScriptProfileTimelineView(this.representedObject,t):null,this._showContentViewForIdentifier(this._currentContentViewSetting.value),this.contentViewContainer.addEventListener(WI.ContentViewContainer.Event.CurrentContentViewDidChange,this._scriptClusterViewCurrentContentViewDidChange,this)}get showsLiveRecordingData(){return this._contentViewContainer.currentContentView.showsLiveRecordingData}get showsFilterBar(){return this._contentViewContainer.currentContentView.showsFilterBar}get zeroTime(){return this._contentViewContainer.currentContentView.zeroTime}set zeroTime(e){this._contentViewContainer.currentContentView.zeroTime=e}get startTime(){return this._contentViewContainer.currentContentView.startTime}set startTime(e){this._contentViewContainer.currentContentView.startTime=e}get endTime(){return this._contentViewContainer.currentContentView.endTime}set endTime(e){this._contentViewContainer.currentContentView.endTime=e}get currentTime(){return this._contentViewContainer.currentContentView.currentTime}set currentTime(e){this._contentViewContainer.currentContentView.currentTime=e}selectRecord(e){this._contentViewContainer.currentContentView.selectRecord(e)}updateFilter(e){return this._contentViewContainer.currentContentView.updateFilter(e)}filterDidChange(){return this._contentViewContainer.currentContentView.filterDidChange()}matchDataGridNodeAgainstCustomFilters(e){return this._contentViewContainer.currentContentView.matchDataGridNodeAgainstCustomFilters(e)}reset(){this._eventsContentView.reset(),this._profileContentView&&this._profileContentView.reset()}get eventsContentView(){return this._eventsContentView}get profileContentView(){return this._profileContentView}get selectionPathComponents(){let e=this._contentViewContainer.currentContentView;if(!e)return[];let t=[this._pathComponentForContentView(e)],i=e.selectionPathComponents;return i?t.concat(i):t}saveToCookie(e){e[WI.ScriptClusterTimelineView.ContentViewIdentifierCookieKey]=this._currentContentViewSetting.value}restoreFromCookie(e){this._showContentViewForIdentifier(e[WI.ScriptClusterTimelineView.ContentViewIdentifierCookieKey])}showEvents(){return this._showContentViewForIdentifier(WI.ScriptClusterTimelineView.EventsIdentifier)}showProfile(){return this._canShowProfileView()?this._showContentViewForIdentifier(WI.ScriptClusterTimelineView.ProfileIdentifier):this.showEvents()}_canShowProfileView(){return window.ScriptProfilerAgent}_pathComponentForContentView(e){return console.assert(e),e?e===this._eventsContentView?this._eventsPathComponent:e===this._profileContentView?this._profilePathComponent:(console.error("Unknown contentView."),null):null}_identifierForContentView(e){return console.assert(e),e?e===this._eventsContentView?WI.ScriptClusterTimelineView.EventsIdentifier:e===this._profileContentView?WI.ScriptClusterTimelineView.ProfileIdentifier:(console.error("Unknown contentView."),null):null}_showContentViewForIdentifier(e){let t=null;switch(e){case WI.ScriptClusterTimelineView.EventsIdentifier:t=this.eventsContentView;break;case WI.ScriptClusterTimelineView.ProfileIdentifier:t=this.profileContentView;break}return t||(t=this.eventsContentView),console.assert(t),this._currentContentViewSetting.value=this._identifierForContentView(t),this.contentViewContainer.showContentView(t)}_pathComponentSelected(e){this._showContentViewForIdentifier(e.data.pathComponent.representedObject)}_scriptClusterViewCurrentContentViewDidChange(e){let t=this._contentViewContainer.currentContentView;if(!t)return;let i=t===this._eventsContentView?this._profileContentView:this._eventsContentView;t.zeroTime=i.zeroTime,t.startTime=i.startTime,t.endTime=i.endTime,t.currentTime=i.currentTime}};WI.ScriptClusterTimelineView.ContentViewIdentifierCookieKey="script-cluster-timeline-view-identifier";WI.ScriptClusterTimelineView.EventsIdentifier="events";WI.ScriptClusterTimelineView.ProfileIdentifier="profile";WI.ScriptContentView=class extends WI.ContentView{constructor(e){console.assert(e instanceof WI.Script,e),super(e),this.element.classList.add("script");var t=new WI.IndeterminateProgressSpinner;this.element.appendChild(t.element),this._script=e,console.assert(!e.resource),console.assert(e.range.startLine===0),console.assert(e.range.startColumn===0);var i=WI.UIString("Pretty print"),n=WI.UIString("Original formatting");this._prettyPrintButtonNavigationItem=new WI.ActivateButtonNavigationItem("pretty-print",i,n,"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 13'%3e %3cpath d='M 5 0.5 L 2.5 1 L 2.5 5 L 1.5 6.5 L 2.5 8 L 2.5 12 L 5 12.5' fill='none' stroke='currentColor' stroke-linecap='square'/%3e %3cpath d='M 8 0.5 L 10.5 1 L 10.5 5 L 11.5 6.5 L 10.5 8 L 10.5 12 L 8 12.5' fill='none' stroke='currentColor' stroke-linecap='square'/%3e %3c/svg%3e",13,13),this._prettyPrintButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._togglePrettyPrint,this),this._prettyPrintButtonNavigationItem.enabled=!1,this._prettyPrintButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low;var s=WI.UIString("Show type information"),a=WI.UIString("Hide type information");this._showTypesButtonNavigationItem=new WI.ActivateButtonNavigationItem("show-types",s,a,"data:image/svg+xml,%3c%3fxml version='1.0'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 14'%3e %3crect fill='none' stroke='currentColor' x='0.5' y='0.5' width='12' height='13' rx='2'/%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='square' d='M 6.5 5.5 L 6.5 9.5 M 4.0 4.5 L 9.0 4.5'/%3e %3c/svg%3e",13,14),this._showTypesButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._toggleTypeAnnotations,this),this._showTypesButtonNavigationItem.enabled=!1,this._showTypesButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,WI.settings.showJavaScriptTypeInformation.addEventListener(WI.Setting.Event.Changed,this._showJavaScriptTypeInformationSettingChanged,this);let d=WI.UIString("Fade unexecuted code"),p=WI.UIString("Do not fade unexecuted code");this._codeCoverageButtonNavigationItem=new WI.ActivateButtonNavigationItem("code-coverage",d,p,"data:image/svg+xml,%3c%3fxml version='1.0'%3f%3e %3c!-- Copyright %c2%a9 2016 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 14'%3e %3crect fill='none' stroke='currentColor' x='0.5' y='0.5' width='12' height='13' rx='2'/%3e %3cpath fill='none' stroke='currentColor' stroke-width='1' d='M9 5.5s0-1.5-2.5-1.5C3 4 3 10 6.5 10c2.5 0 2.5-1.5 2.5-1.5'/%3e %3c/svg%3e",13,14),this._codeCoverageButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._toggleUnexecutedCodeHighlights,this),this._codeCoverageButtonNavigationItem.enabled=!1,this._codeCoverageButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,WI.settings.enableControlFlowProfiler.addEventListener(WI.Setting.Event.Changed,this._enableControlFlowProfilerSettingChanged,this),this._textEditor=new WI.SourceCodeTextEditor(e),this._textEditor.addEventListener(WI.TextEditor.Event.ExecutionLineNumberDidChange,this._executionLineNumberDidChange,this),this._textEditor.addEventListener(WI.TextEditor.Event.NumberOfSearchResultsDidChange,this._numberOfSearchResultsDidChange,this),this._textEditor.addEventListener(WI.TextEditor.Event.FormattingDidChange,this._textEditorFormattingDidChange,this),this._textEditor.addEventListener(WI.TextEditor.Event.MIMETypeChanged,this._handleTextEditorMIMETypeChanged,this),this._textEditor.addEventListener(WI.SourceCodeTextEditor.Event.ContentWillPopulate,this._contentWillPopulate,this),this._textEditor.addEventListener(WI.SourceCodeTextEditor.Event.ContentDidPopulate,this._contentDidPopulate,this)}get navigationItems(){return[this._prettyPrintButtonNavigationItem,this._showTypesButtonNavigationItem,this._codeCoverageButtonNavigationItem]}get script(){return this._script}get textEditor(){return this._textEditor}get supplementalRepresentedObjects(){return isNaN(this._textEditor.executionLineNumber)?[]:[WI.debuggerManager.activeCallFrame]}revealPosition(e,t,i){this._textEditor.revealPosition(e,t,i)}shown(){super.shown(),this._textEditor.shown()}hidden(){super.hidden(),this._textEditor.hidden()}closed(){super.closed(),WI.settings.showJavaScriptTypeInformation.removeEventListener(null,null,this),WI.settings.enableControlFlowProfiler.removeEventListener(null,null,this),this._textEditor.close()}saveToCookie(e){e.type=WI.ContentViewCookieType.Resource,e.url=this.representedObject.url}restoreFromCookie(e){"lineNumber"in e&&"columnNumber"in e&&this.revealPosition(new WI.SourceCodePosition(e.lineNumber,e.columnNumber))}get supportsSave(){return!0}get saveData(){return{url:this._script.url||WI.FileUtilities.inspectorURLForFilename(this._script.displayName+".js"),content:this._textEditor.string}}get supportsSearch(){return!0}get numberOfSearchResults(){return this._textEditor.numberOfSearchResults}get hasPerformedSearch(){return this._textEditor.currentSearchQuery!==null}set automaticallyRevealFirstSearchResult(e){this._textEditor.automaticallyRevealFirstSearchResult=e}performSearch(e){this._textEditor.performSearch(e)}searchCleared(){this._textEditor.searchCleared()}searchQueryWithSelection(){return this._textEditor.searchQueryWithSelection()}revealPreviousSearchResult(e){this._textEditor.revealPreviousSearchResult(e)}revealNextSearchResult(e){this._textEditor.revealNextSearchResult(e)}_contentWillPopulate(e){this._textEditor.element.parentNode!==this.element&&(this._script.urlComponents.scheme==="file"&&(this._textEditor.readOnly=!1),this.element.removeChildren(),this.addSubview(this._textEditor))}_contentDidPopulate(e){this._prettyPrintButtonNavigationItem.enabled=this._textEditor.canBeFormatted(),this._showTypesButtonNavigationItem.enabled=this._textEditor.canShowTypeAnnotations(),this._showTypesButtonNavigationItem.activated=WI.settings.showJavaScriptTypeInformation.value,this._codeCoverageButtonNavigationItem.enabled=this._textEditor.canShowCoverageHints(),this._codeCoverageButtonNavigationItem.activated=WI.settings.enableControlFlowProfiler.value}_togglePrettyPrint(e){var t=!this._prettyPrintButtonNavigationItem.activated;this._textEditor.updateFormattedState(t)}_toggleTypeAnnotations(e){this._showTypesButtonNavigationItem.enabled=!1,this._textEditor.toggleTypeAnnotations().then(()=>{this._showTypesButtonNavigationItem.enabled=!0})}_toggleUnexecutedCodeHighlights(e){this._codeCoverageButtonNavigationItem.enabled=!1,this._textEditor.toggleUnexecutedCodeHighlights().then(()=>{this._codeCoverageButtonNavigationItem.enabled=!0})}_showJavaScriptTypeInformationSettingChanged(e){this._showTypesButtonNavigationItem.activated=WI.settings.showJavaScriptTypeInformation.value}_enableControlFlowProfilerSettingChanged(e){this._codeCoverageButtonNavigationItem.activated=WI.settings.enableControlFlowProfiler.value}_textEditorFormattingDidChange(e){this._prettyPrintButtonNavigationItem.activated=this._textEditor.formatted}_handleTextEditorMIMETypeChanged(e){this._prettyPrintButtonNavigationItem.enabled=this._textEditor.canBeFormatted()}_executionLineNumberDidChange(e){this.dispatchEventToListeners(WI.ContentView.Event.SupplementalRepresentedObjectsDidChange)}_numberOfSearchResultsDidChange(e){this.dispatchEventToListeners(WI.ContentView.Event.NumberOfSearchResultsDidChange)}};WI.ScriptDetailsTimelineView=class extends WI.TimelineView{constructor(e,t){super(e,t),console.assert(e.type===WI.TimelineRecord.Type.Script);let i={name:{},location:{},callCount:{},startTime:{},totalTime:{},selfTime:{},averageTime:{}};i.name.title=WI.UIString("Name"),i.name.width="30%",i.name.icon=!0,i.name.disclosure=!0,i.name.locked=!0,i.location.title=WI.UIString("Location"),i.location.icon=!0,i.location.width="15%",!!window.ScriptProfilerAgent?i.callCount.title=WI.UIString("Samples"):i.callCount.title=WI.UIString("Calls"),i.callCount.width="5%",i.callCount.aligned="right",i.startTime.title=WI.UIString("Start Time"),i.startTime.width="10%",i.startTime.aligned="right",i.totalTime.title=WI.UIString("Total Time"),i.totalTime.width="10%",i.totalTime.aligned="right",i.selfTime.title=WI.UIString("Self Time"),i.selfTime.width="10%",i.selfTime.aligned="right",i.averageTime.title=WI.UIString("Average Time"),i.averageTime.width="10%",i.averageTime.aligned="right";for(var s in i)i[s].sortable=!0;this._dataGrid=new WI.ScriptTimelineDataGrid(i),this._dataGrid.sortDelegate=this,this._dataGrid.sortColumnIdentifier="startTime",this._dataGrid.sortOrder=WI.DataGrid.SortOrder.Ascending,this._dataGrid.createSettings("script-timeline-view"),this.setupDataGrid(this._dataGrid),this.element.classList.add("script"),this.addSubview(this._dataGrid),e.addEventListener(WI.Timeline.Event.RecordAdded,this._scriptTimelineRecordAdded,this),e.addEventListener(WI.Timeline.Event.Refreshed,this._scriptTimelineRecordRefreshed,this),this._pendingRecords=[];for(let a of e.records)this._processRecord(a)}get showsLiveRecordingData(){return!1}shown(){super.shown(),this._dataGrid.shown()}hidden(){this._dataGrid.hidden(),super.hidden()}closed(){console.assert(this.representedObject instanceof WI.Timeline),this.representedObject.removeEventListener(null,null,this),this._dataGrid.closed()}get selectionPathComponents(){var e=this._dataGrid.selectedNode;if(!e)return null;for(var t=[];e&&!e.root;){if(console.assert(e instanceof WI.TimelineDataGridNode),e.hidden)return null;let i=new WI.TimelineDataGridNodePathComponent(e);i.addEventListener(WI.HierarchicalPathComponent.Event.SiblingWasSelected,this.dataGridNodePathComponentSelected,this),t.unshift(i),e=e.parent}return t}reset(){super.reset(),this._dataGrid.reset(),this._pendingRecords=[]}dataGridSortComparator(e,t,i,n){if(e!=="name")return null;let s=i.displayName(),a=n.displayName();return s!==a?s.extendedLocaleCompare(a)*t:i.subtitle.extendedLocaleCompare(n.subtitle)*t}dataGridNodePathComponentSelected(e){let t=e.data.pathComponent.timelineDataGridNode;console.assert(t.dataGrid===this._dataGrid),t.revealAndSelect()}layout(){if(this.startTime!==this._oldStartTime||this.endTime!==this._oldEndTime){let e=this._dataGrid.children[0];for(;e;)e.revealed?e.refresh():e.needsRefresh(),e=e.traverseNextNode(!1,null,!0);this._oldStartTime=this.startTime,this._oldEndTime=this.endTime}this._processPendingRecords()}_processPendingRecords(){if(!WI.timelineManager.scriptProfilerIsTracking()&&!!this._pendingRecords.length){for(let e of this._pendingRecords){let t=[];e.profile&&(t=e.profile.topDownRootNodes);let i=new WI.ScriptTimelineDataGridNode(e,{graphDataSource:this});this._dataGrid.addRowInSortOrder(i);for(let n of t){let s=new WI.ProfileNodeDataGridNode(n,{graphDataSource:this});this._dataGrid.addRowInSortOrder(s,i)}}this._pendingRecords=[]}}_scriptTimelineRecordAdded(e){let t=e.data.record;console.assert(t instanceof WI.ScriptTimelineRecord),this._processRecord(t),this.needsLayout()}_processRecord(e){this._pendingRecords.push(e)}_scriptTimelineRecordRefreshed(e){this.needsLayout()}};WI.ScriptProfileTimelineView=class extends WI.TimelineView{constructor(e,t){super(e,t),console.assert(e.type===WI.TimelineRecord.Type.Script),this.element.classList.add("script"),this._recording=t.recording,this._forceNextLayout=!1,this._lastLayoutStartTime=void 0,this._lastLayoutEndTime=void 0,this._sharedProfileViewData={selectedNodeHash:null},WI.ScriptProfileTimelineView.profileOrientationSetting||(WI.ScriptProfileTimelineView.profileOrientationSetting=new WI.Setting("script-profile-timeline-view-profile-orientation-setting",WI.ScriptProfileTimelineView.ProfileOrientation.TopDown)),WI.ScriptProfileTimelineView.profileTypeSetting||(WI.ScriptProfileTimelineView.profileTypeSetting=new WI.Setting("script-profile-timeline-view-profile-type-setting",WI.ScriptProfileTimelineView.ProfileViewType.Hierarchy)),this._showProfileViewForOrientation(WI.ScriptProfileTimelineView.profileOrientationSetting.value,WI.ScriptProfileTimelineView.profileTypeSetting.value);let i=WI.UIString("Clear focus");this._clearFocusNodesButtonItem=new WI.ButtonNavigationItem("clear-profile-focus",i,"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 14'%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='square' d='M 4.5 4.5 L 11.5 11.5 M 4.5 11.5 L 11.5 4.5'/%3e %3c/svg%3e",16,16),this._clearFocusNodesButtonItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._clearFocusNodes,this),this._updateClearFocusNodesButtonItem(),this._profileOrientationButton=new WI.TextToggleButtonNavigationItem("profile-orientation",WI.UIString("Inverted")),this._profileOrientationButton.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._profileOrientationButtonClicked,this),WI.ScriptProfileTimelineView.profileOrientationSetting.value===WI.ScriptProfileTimelineView.ProfileOrientation.TopDown?this._profileOrientationButton.activated=!1:this._profileOrientationButton.activated=!0,this._topFunctionsButton=new WI.TextToggleButtonNavigationItem("top-functions",WI.UIString("Top Functions")),this._topFunctionsButton.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._topFunctionsButtonClicked,this),WI.ScriptProfileTimelineView.profileTypeSetting.value===WI.ScriptProfileTimelineView.ProfileViewType.Hierarchy?this._topFunctionsButton.activated=!1:this._topFunctionsButton.activated=!0,e.addEventListener(WI.Timeline.Event.Refreshed,this._scriptTimelineRecordRefreshed,this)}get scrollableElements(){return this._profileView.scrollableElements}get showsLiveRecordingData(){return!1}closed(){console.assert(this.representedObject instanceof WI.Timeline),this.representedObject.removeEventListener(null,null,this)}get navigationItems(){return[this._clearFocusNodesButtonItem,this._profileOrientationButton,this._topFunctionsButton]}get selectionPathComponents(){return this._profileView.selectionPathComponents}layout(){!this._forceNextLayout&&this._lastLayoutStartTime===this.startTime&&this._lastLayoutEndTime===this.endTime||(this._forceNextLayout=!1,this._lastLayoutStartTime=this.startTime,this._lastLayoutEndTime=this.endTime,this._profileView.setStartAndEndTime(this.startTime,this.endTime))}_callingContextTreeForOrientation(e,t){switch(e){case WI.ScriptProfileTimelineView.ProfileOrientation.TopDown:return t===WI.ScriptProfileTimelineView.ProfileViewType.Hierarchy?this._recording.topDownCallingContextTree:this._recording.topFunctionsTopDownCallingContextTree;case WI.ScriptProfileTimelineView.ProfileOrientation.BottomUp:return t===WI.ScriptProfileTimelineView.ProfileViewType.Hierarchy?this._recording.bottomUpCallingContextTree:this._recording.topFunctionsBottomUpCallingContextTree}return console.assert(!1,"Should not be reached."),this._recording.topDownCallingContextTree}_profileViewSelectionPathComponentsDidChange(e){this._updateClearFocusNodesButtonItem(),this.dispatchEventToListeners(WI.ContentView.Event.SelectionPathComponentsDidChange)}_scriptTimelineRecordRefreshed(e){this._forceNextLayout=!0,this.needsLayout()}_profileOrientationButtonClicked(){this._profileOrientationButton.activated=!this._profileOrientationButton.activated;let e=this._profileOrientationButton.activated,t;e?t=WI.ScriptProfileTimelineView.ProfileOrientation.BottomUp:t=WI.ScriptProfileTimelineView.ProfileOrientation.TopDown,WI.ScriptProfileTimelineView.profileOrientationSetting.value=t,this._showProfileViewForOrientation(t,WI.ScriptProfileTimelineView.profileTypeSetting.value),this.dispatchEventToListeners(WI.ContentView.Event.SelectionPathComponentsDidChange),this._forceNextLayout=!0,this.needsLayout()}_topFunctionsButtonClicked(){this._topFunctionsButton.activated=!this._topFunctionsButton.activated;let e=this._topFunctionsButton.activated,t;e?t=WI.ScriptProfileTimelineView.ProfileViewType.TopFunctions:t=WI.ScriptProfileTimelineView.ProfileViewType.Hierarchy,WI.ScriptProfileTimelineView.profileTypeSetting.value=t,this._showProfileViewForOrientation(WI.ScriptProfileTimelineView.profileOrientationSetting.value,t),this.dispatchEventToListeners(WI.ContentView.Event.SelectionPathComponentsDidChange),this._forceNextLayout=!0,this.needsLayout()}_showProfileViewForOrientation(e,t){let i;this._profileView&&(this._profileView.removeEventListener(WI.ContentView.Event.SelectionPathComponentsDidChange,this._profileViewSelectionPathComponentsDidChange,this),this.removeSubview(this._profileView),i=this._profileView.dataGrid.filterText);let n=this._callingContextTreeForOrientation(e,t);this._profileView=new WI.ProfileView(n,this._sharedProfileViewData),this._profileView.addEventListener(WI.ContentView.Event.SelectionPathComponentsDidChange,this._profileViewSelectionPathComponentsDidChange,this),this.addSubview(this._profileView),this.setupDataGrid(this._profileView.dataGrid),i&&(this._profileView.dataGrid.filterText=i)}_updateClearFocusNodesButtonItem(){this._clearFocusNodesButtonItem.enabled=this._profileView.hasFocusNodes()}_clearFocusNodes(){this._profileView.clearFocusNodes()}};WI.ScriptProfileTimelineView.ProfileOrientation={BottomUp:"bottom-up",TopDown:"top-down"};WI.ScriptProfileTimelineView.ProfileViewType={Hierarchy:"hierarchy",TopFunctions:"top-functions"};WI.ScriptTimelineDataGrid=class extends WI.TimelineDataGrid{callFramePopoverAnchorElement(){return this.selectedNode.elementWithColumnIdentifier("location")}shouldShowCallFramePopover(){return this.isColumnVisible("location")}};WI.ScriptTimelineDataGridNode=class extends WI.TimelineDataGridNode{constructor(e,t={}){console.assert(e instanceof WI.ScriptTimelineRecord),super([e],t)}get data(){if(this._cachedData)return this._cachedData;let e=0,t=0,i=1/0;this.graphDataSource&&(e=this.graphDataSource.zeroTime,t=this.graphDataSource.startTime,i=this.graphDataSource.endTime);let n=this.record.startTime,s=this.record.startTime+this.record.duration-n;if(this.record.profile){let a=this.record.profile.topDownRootNodes[0];a&&a.calls&&(n=Math.max(t,this.record.startTime),s=Math.min(this.record.startTime+this.record.duration,i)-n)}return this._cachedData=super.data,this._cachedData.type=this.record.eventType,this._cachedData.name=this.displayName(),this._cachedData.startTime=n-e,this._cachedData.selfTime=s,this._cachedData.totalTime=s,this._cachedData.averageTime=s,this._cachedData.callCount=this.record.callCountOrSamples,this._cachedData.location=this.record.initiatorCallFrame||this.record.sourceCodeLocation,this._cachedData}get subtitle(){if(this._subtitle!==void 0)return this._subtitle;if(this._subtitle="",this.record.eventType===WI.ScriptTimelineRecord.EventType.TimerInstalled){let e=Number.secondsToString(this.record.details.timeout/1e3);this.record.details.repeating?this._subtitle=WI.UIString("%s interval").format(e):this._subtitle=WI.UIString("%s delay").format(e)}else this.record.eventType===WI.ScriptTimelineRecord.EventType.EventDispatched&&this.record.extraDetails&&this.record.extraDetails.defaultPrevented&&(this._subtitle=WI.UIString("default prevented"));return this._subtitle}createCellContent(e,t){var n=this.data[e];switch(e){case"name":return t.classList.add(...this.iconClassNames()),this._createNameCellDocumentFragment();case"startTime":case"selfTime":case"totalTime":case"averageTime":return isNaN(n)?emDash:Number.secondsToString(n,!0);case"callCount":return isNaN(n)?emDash:n.toLocaleString();case"width":case"height":case"area":return zeroWidthSpace;case"source":return super.createCellContent("location",t)}return super.createCellContent(e,t)}filterableDataForColumn(e){return e==="name"?[this.displayName(),this.subtitle]:super.filterableDataForColumn(e)}_createNameCellDocumentFragment(e){let t=document.createDocumentFragment();if(t.append(this.displayName()),this.subtitle){let i=document.createElement("span");i.classList.add("subtitle"),i.textContent=this.subtitle,t.append(i)}return t}};WI.ScriptTimelineOverviewGraph=class extends WI.TimelineOverviewGraph{constructor(e,t){super(t),this.element.classList.add("script"),this._scriptTimeline=e,this._scriptTimeline.addEventListener(WI.Timeline.Event.RecordAdded,this._scriptTimelineRecordAdded,this),this._timelineRecordBars=[],this.reset()}reset(){super.reset(),this.element.removeChildren()}layout(){if(!this.visible)return;let e=this.timelineOverview.secondsPerPixel,t=0;function i(d,p){let f=this._timelineRecordBars[t];f?(f.renderMode=p,f.records=d):f=this._timelineRecordBars[t]=new WI.TimelineRecordBar(this,d,p),f.refresh(this),f.element.parentNode||this.element.appendChild(f.element),++t}let[n,s]=this._scriptTimeline.records.partition(d=>d.isGarbageCollection()),a=i.bind(this);for(WI.TimelineRecordBar.createCombinedBars(s,e,this,a),WI.TimelineRecordBar.createCombinedBars(n,e,this,a);t<this._timelineRecordBars.length;++t)this._timelineRecordBars[t].records=null,this._timelineRecordBars[t].element.remove()}updateSelectedRecord(){super.updateSelectedRecord();for(let e of this._timelineRecordBars)if(e.records.includes(this.selectedRecord)){this.selectedRecordBar=e;return}this.selectedRecordBar=null}_scriptTimelineRecordAdded(e){this.needsLayout()}};WI.ScriptTreeElement=class extends WI.SourceCodeTreeElement{constructor(e){console.assert(e instanceof WI.Script);const t=null,i=null;if(super(e,"script",t,i),this.mainTitle=e.displayName,e.url&&!e.dynamicallyAddedScriptElement){let n=WI.displayNameForHost(e.urlComponents.host);this.subtitle=this.mainTitle!==n?n:null,this.tooltip=e.url,this.addClassName(WI.ResourceTreeElement.ResourceIconStyleClassName),this.addClassName(WI.Resource.Type.Script)}else this.addClassName(WI.ScriptTreeElement.AnonymousScriptIconStyleClassName);e.isMainResource()&&(console.assert(e.target.type===WI.Target.Type.Worker||e.target.type===WI.Target.Type.ServiceWorker,e.target.type),this.addClassName("worker-icon")),this._script=e}get script(){return this._script}};WI.ScriptTreeElement.AnonymousScriptIconStyleClassName="anonymous-script-icon";WI.ScrubberNavigationItem=class extends WI.FlexibleSpaceNavigationItem{constructor(e){super(e),this._sliderElement=this._element.appendChild(document.createElement("input")),this._sliderElement.type="range",this._sliderElement.addEventListener("input",this._sliderChanged.bind(this))}get value(){return parseInt(this._sliderElement.value)}set value(e){this._sliderElement.value=e}get min(){return parseInt(this._sliderElement.min)}set min(e){this._sliderElement.min=e}get max(){return parseInt(this._sliderElement.max)}set max(e){this._sliderElement.max=e}get disabled(){return this._sliderElement.disabled}set disabled(e){this._sliderElement.disabled=!!e}get additionalClassNames(){return super.additionalClassNames.concat(["scrubber"])}_sliderChanged(e){this.dispatchEventToListeners(WI.ScrubberNavigationItem.Event.ValueChanged)}};WI.ScrubberNavigationItem.Event={ValueChanged:"slider-navigation-item-value-changed"};WI.SearchBar=class extends WI.NavigationItem{constructor(e,t,i){super(e),this._element.classList.add("search-bar"),this._searchInput=this._element.appendChild(document.createElement("input")),this._searchInput.type="search",this._searchInput.spellcheck=!1,this._searchInput.incremental=i,this._searchInput.setAttribute("results",5),this._searchInput.setAttribute("autosave",e+"-autosave"),this._searchInput.setAttribute("placeholder",t),this._searchInput.addEventListener("search",this._handleSearchEvent.bind(this))}get text(){return this._searchInput.value}set text(e){this._searchInput.value=e}focus(){this._searchInput.value.length?this._searchInput.select():this._searchInput.focus()}_handleSearchEvent(e){this.dispatchEventToListeners(WI.SearchBar.Event.TextChanged)}};WI.SearchBar.Event={TextChanged:"searchbar-text-did-change"};WI.SearchResultTreeElement=class extends WI.GeneralTreeElement{constructor(e){console.assert(e instanceof WI.DOMSearchMatchObject||e instanceof WI.SourceCodeSearchMatchObject);var t=WI.SearchResultTreeElement.truncateAndHighlightTitle(e.title,e.searchTerm,e.sourceCodeTextRange);const i=null;super(e.className,t,i,e)}static truncateAndHighlightTitle(e,t,i){let n=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL;const s=n?20:15,a=n?15:50;var d=i.textRange;let p=d.startColumn,f=d.endColumn-d.startColumn;console.assert(d.startLine===d.endLine);var _=null;p>s?(_=ellipsis+e.substring(p-s),p=s+1):_=e,_=_.truncateEnd(p+f+a);var b=document.createDocumentFragment();b.append(_.substring(0,p));var w=document.createElement("span");return w.className="highlighted",w.append(_.substring(p,p+f)),b.appendChild(w),b.append(_.substring(p+f)),b}get filterableData(){return{text:[this.representedObject.title]}}get synthesizedTextValue(){return this.representedObject.sourceCodeTextRange.synthesizedTextValue+":"+this.representedObject.title}populateContextMenu(e,t){if(this.representedObject instanceof WI.DOMSearchMatchObject)e.appendItem(WI.UIString("Reveal in Elements Tab"),()=>{WI.showMainFrameDOMTree(this.representedObject.domNode,{ignoreSearchTab:!0})});else if(this.representedObject instanceof WI.SourceCodeSearchMatchObject){let i=null;WI.settings.experimentalEnableSourcesTab.value?i=WI.UIString("Reveal in Sources Tab"):i=WI.UIString("Reveal in Resources Tab"),e.appendItem(i,()=>{WI.showOriginalOrFormattedSourceCodeTextRange(this.representedObject.sourceCodeTextRange,{ignoreNetworkTab:!0,ignoreSearchTab:!0})})}super.populateContextMenu(e,t)}};WI.SearchSidebarPanel=class extends WI.NavigationSidebarPanel{constructor(){super("search",WI.UIString("Search"),!0,!0),this._searchInputSettings=WI.SearchUtilities.createSettings("search-sidebar",{handleChanged:t=>{this.focusSearchField(!0)}});var e=document.createElement("div");e.classList.add("search-bar"),this.element.appendChild(e),this._inputElement=document.createElement("input"),this._inputElement.type="search",this._inputElement.spellcheck=!1,this._inputElement.addEventListener("search",this._searchFieldChanged.bind(this)),this._inputElement.addEventListener("input",this._searchFieldInput.bind(this)),this._inputElement.setAttribute("results",5),this._inputElement.setAttribute("autosave","inspector-search-autosave"),this._inputElement.setAttribute("placeholder",WI.UIString("Search Resource Content")),e.appendChild(this._inputElement),e.appendChild(WI.SearchUtilities.createSettingsButton(this._searchInputSettings)),this._searchQuerySetting=new WI.Setting("search-sidebar-query",""),this._inputElement.value=this._searchQuerySetting.value,WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this),this.contentTreeOutline.addEventListener(WI.TreeOutline.Event.SelectionDidChange,this._treeSelectionDidChange,this)}closed(){super.closed(),WI.Frame.removeEventListener(null,null,this)}focusSearchField(e){!this.parentSidebar||(this.parentSidebar.selectedSidebarPanel=this,this.parentSidebar.collapsed=!1,this._inputElement.select(),e&&this.performSearch(this._inputElement.value))}performSearch(e){if(this.contentTreeOutline.removeChildren(),this.contentBrowser.contentViewContainer.closeAllContentViews(),this._inputElement.value=e,this._searchQuerySetting.value=e,this.hideEmptyContentPlaceholder(),this.element.classList.remove("changed"),this._changedBanner&&this._changedBanner.remove(),!e.length)return;let t=()=>{let E=WI.createMessageTextView("");String.format(WI.UIString("Searching %s"),[new WI.IndeterminateProgressSpinner().element],String.standardFormatters,E,(k,R)=>(k.append(R),k)),this.updateEmptyContentPlaceholder(E)};if(!WI.targetsAvailable()){t(),WI.whenTargetsAvailable().then(()=>{this._searchQuerySetting.value===e&&this.performSearch(e)});return}let i=0,n=async(E,k)=>{++i,i===1&&t();let R=await E;k&&k(R),--i,console.assert(i>=0),i===0&&this.updateEmptyContentPlaceholder(WI.UIString("No Search Results"))},s=!!this._searchInputSettings.caseSensitive.value,a=!!this._searchInputSettings.regularExpression.value;function d(E,k){let R=new WI.SearchResultTreeElement(E);R.addEventListener(WI.TreeElement.Event.DoubleClick,this._treeElementDoubleClick,this),k.appendChild(R),this.contentTreeOutline.selectedTreeElement||R.revealAndSelect(!1,!0)}function p(E,k,R){var M;let L=WI.SearchUtilities.regExpForString(E,{caseSensitive:s,regularExpression:a});for(;L.lastIndex<k.length&&(M=L.exec(k));)R(M,L.lastIndex)}let f=(E,k,{result:R})=>{if(!(!R||!R.length)){var M=WI.networkManager.frameForIdentifier(E);if(!!M){var L=M.url===k?M.mainResource:M.resourceForURL(k);if(!!L){for(var V=this._searchTreeElementForResource(L),H=0;H<R.length;++H){var O=R[H];p(e,O.lineContent,(z,K)=>{var q=new WI.SourceCodeSearchMatchObject(L,O.lineContent,e,new WI.TextRange(O.lineNumber,z.index,O.lineNumber,K));d.call(this,q,V)})}V.children.length||this.contentTreeOutline.removeChild(V)}}}},_=({result:E})=>{let k=new Set;for(let M of E){if(!M.url||!M.frameId)continue;let L=M.frameId+":"+M.url;k.has(L)||(k.add(L),n(PageAgent.searchInResource(M.frameId,M.url,e,s,a,M.requestId),f.bind(this,M.frameId,M.url)))}let R=[WI.Frame.awaitEvent(WI.Frame.Event.ResourceWasAdded),WI.Target.awaitEvent(WI.Target.Event.ResourceAdded)];Promise.race(R).then(this._contentChanged.bind(this))},b=(E,{result:k})=>{if(!(!k||!k.length)){var R=this._searchTreeElementForScript(E);for(let M of k)p(e,M.lineContent,(L,V)=>{var H=new WI.SourceCodeSearchMatchObject(E,M.lineContent,e,new WI.TextRange(M.lineNumber,L.index,M.lineNumber,V));d.call(this,H,R)});R.children.length||this.contentTreeOutline.removeChild(R)}},w=E=>{if(!!E.length)for(let k of E)n(k.target.DebuggerAgent.searchInContent(k.id,e,s,a),b.bind(this,k))},S=({searchId:E,resultCount:k})=>{if(!k)return;console.assert(E),this._domSearchIdentifier=E;let R=({nodeIds:M})=>{if(this._domSearchIdentifier===E)for(let K of M){let q=WI.domManager.nodeForId(K);if(!(!q||!q.ownerDocument)&&q.nodeType()!==Node.DOCUMENT_NODE){var L=WI.networkManager.resourceForURL(q.ownerDocument.documentURL);if(!!L){var V=this._searchTreeElementForResource(L),H=WI.DOMSearchMatchObject.titleForDOMNode(q),O=!1;if(p(e,H,(Y,se)=>{var ce=new WI.DOMSearchMatchObject(L,q,H,e,new WI.TextRange(0,Y.index,0,se));d.call(this,ce,V),O=!0}),!O){var z=new WI.DOMSearchMatchObject(L,q,H,H,new WI.TextRange(0,0,0,H.length));d.call(this,z,V)}V.children.length||this.contentTreeOutline.removeChild(V)}}}};n(DOMAgent.getSearchResults(E,0,k),R)};if(window.DOMAgent&&WI.domManager.ensureDocument(),window.PageAgent&&n(PageAgent.searchInResources(e,s,a),_),setTimeout(w.bind(this,WI.debuggerManager.searchableScripts),0),window.DOMAgent){this._domSearchIdentifier&&(DOMAgent.discardSearchResults(this._domSearchIdentifier),this._domSearchIdentifier=void 0);let E={query:e,caseSensitive:s};n(DOMAgent.performSearch.invoke(E),S)}}_searchFieldChanged(e){this.performSearch(e.target.value)}_searchFieldInput(e){e.target.value.length||this.performSearch("")}_searchTreeElementForResource(e){var t=this.contentTreeOutline.getCachedTreeElement(e);return t||(t=new WI.ResourceTreeElement(e),t.hasChildren=!0,t.expand(),this.contentTreeOutline.appendChild(t)),t}_searchTreeElementForScript(e){var t=this.contentTreeOutline.getCachedTreeElement(e);return t||(t=new WI.ScriptTreeElement(e),t.hasChildren=!0,t.expand(),this.contentTreeOutline.appendChild(t)),t}_mainResourceDidChange(e){!e.target.isMainFrame()||(this._delayedSearchTimeout&&(clearTimeout(this._delayedSearchTimeout),this._delayedSearchTimeout=void 0),this.contentTreeOutline.removeChildren(),this.contentBrowser.contentViewContainer.closeAllContentViews(),this.visible&&this.focusSearchField(!0))}_treeSelectionDidChange(e){if(!this.selected)return;let t=this.contentTreeOutline.selectedTreeElement;if(!t||t instanceof WI.FolderTreeElement)return;const i={ignoreNetworkTab:!0};if(t instanceof WI.ResourceTreeElement||t instanceof WI.ScriptTreeElement){WI.showRepresentedObject(t.representedObject,null,i);return}console.assert(t instanceof WI.SearchResultTreeElement),t instanceof WI.SearchResultTreeElement&&(t.representedObject instanceof WI.DOMSearchMatchObject?WI.showMainFrameDOMTree(t.representedObject.domNode):t.representedObject instanceof WI.SourceCodeSearchMatchObject&&WI.showOriginalOrFormattedSourceCodeTextRange(t.representedObject.sourceCodeTextRange,i))}_treeElementDoubleClick(e){let t=e.target;!t||(t.representedObject instanceof WI.DOMSearchMatchObject?WI.showMainFrameDOMTree(t.representedObject.domNode,{ignoreSearchTab:!0}):t.representedObject instanceof WI.SourceCodeSearchMatchObject&&WI.showOriginalOrFormattedSourceCodeTextRange(t.representedObject.sourceCodeTextRange,{ignoreNetworkTab:!0,ignoreSearchTab:!0}))}_contentChanged(e){if(this.element.classList.add("changed"),!this._changedBanner){this._changedBanner=document.createElement("div"),this._changedBanner.classList.add("banner"),this._changedBanner.append(WI.UIString("The page's content has changed"),document.createElement("br"));let t=this._changedBanner.appendChild(document.createElement("a"));t.textContent=WI.UIString("Search Again"),t.addEventListener("click",()=>{this.focusSearchField(!0)})}this.element.appendChild(this._changedBanner)}};WI.ShaderProgramContentView=class extends WI.ContentView{constructor(e){console.assert(e instanceof WI.ShaderProgram),super(e);let t=new Debouncer(n=>{this._contentDidChange(n)});this.element.classList.add("shader-program");let i=n=>{let s=new WI.TextEditor;s.readOnly=!1,s.addEventListener(WI.TextEditor.Event.Focused,this._editorFocused,this),s.addEventListener(WI.TextEditor.Event.NumberOfSearchResultsDidChange,this._numberOfSearchResultsDidChange,this),s.addEventListener(WI.TextEditor.Event.ContentDidChange,d=>{t.delayForTime(250,d)},this),s.element.classList.add("shader");let a=s.element.insertAdjacentElement("afterbegin",document.createElement("div"));switch(a.classList.add("type-title"),n){case WI.ShaderProgram.ShaderType.Vertex:a.textContent=WI.UIString("Vertex Shader"),s.mimeType="x-shader/x-vertex",s.element.classList.add("vertex");break;case WI.ShaderProgram.ShaderType.Fragment:a.textContent=WI.UIString("Fragment Shader"),s.mimeType="x-shader/x-fragment",s.element.classList.add("fragment");break}return this.addSubview(s),s};this._vertexEditor=i(WI.ShaderProgram.ShaderType.Vertex),this._fragmentEditor=i(WI.ShaderProgram.ShaderType.Fragment),this._lastActiveEditor=this._vertexEditor}shown(){super.shown(),this._vertexEditor.shown(),this._fragmentEditor.shown(),this.representedObject.requestVertexShaderSource(e=>{this._vertexEditor.string=e||""}),this.representedObject.requestFragmentShaderSource(e=>{this._fragmentEditor.string=e||""})}hidden(){this._vertexEditor.hidden(),this._fragmentEditor.hidden(),super.hidden()}get supportsSave(){return!0}get saveData(){let e=WI.UIString("Shader");return this._lastActiveEditor===this._vertexEditor?e=WI.UIString("Vertex"):this._lastActiveEditor===this._fragmentEditor&&(e=WI.UIString("Fragment")),{url:WI.FileUtilities.inspectorURLForFilename(e+".glsl"),content:this._lastActiveEditor.string,forceSaveAs:!0}}get supportsSearch(){return!0}get numberOfSearchResults(){return this._lastActiveEditor.numberOfSearchResults}get hasPerformedSearch(){return this._lastActiveEditor.currentSearchQuery!==null}set automaticallyRevealFirstSearchResult(e){this._lastActiveEditor.automaticallyRevealFirstSearchResult=e}performSearch(e){this._lastActiveEditor.performSearch(e)}searchCleared(){this._lastActiveEditor.searchCleared()}searchQueryWithSelection(){return this._lastActiveEditor.searchQueryWithSelection()}revealPreviousSearchResult(e){this._lastActiveEditor.revealPreviousSearchResult(e)}revealNextSearchResult(e){this._lastActiveEditor.revealNextSearchResult(e)}revealPosition(e,t,i){this._lastActiveEditor.revealPosition(e,t,i)}_editorFocused(e){if(this._lastActiveEditor===e.target)return;let t=null;this._lastActiveEditor&&(t=this._lastActiveEditor.currentSearchQuery,this._lastActiveEditor.searchCleared()),this._lastActiveEditor=e.target,t&&this._lastActiveEditor.performSearch(t)}_numberOfSearchResultsDidChange(e){this.dispatchEventToListeners(WI.ContentView.Event.NumberOfSearchResultsDidChange)}_contentDidChange(e){e.target===this._vertexEditor?this.representedObject.updateVertexShader(this._vertexEditor.string):e.target===this._fragmentEditor&&this.representedObject.updateFragmentShader(this._fragmentEditor.string)}};WI.ShaderProgramTreeElement=class extends WI.GeneralTreeElement{constructor(e){console.assert(e instanceof WI.ShaderProgram);const t=null;super("shader-program",e.displayName,t,e),this._disabledImageElement=document.createElement("img"),this._disabledImageElement.title=WI.UIString("Disable Program"),this._disabledImageElement.addEventListener("click",this._disabledImageElementClicked.bind(this)),this.status=this._disabledImageElement}onattach(){super.onattach(),this.element.addEventListener("mouseover",this._handleMouseOver.bind(this)),this.element.addEventListener("mouseout",this._handleMouseOut.bind(this))}canSelectOnMouseDown(e){return!this._statusElement.contains(e.target)}_disabledImageElementClicked(e){this.representedObject.toggleDisabled(()=>{this._listItemNode.classList.toggle("disabled",!!this.representedObject.disabled),this._disabledImageElement.title=this.representedObject.disabled?WI.UIString("Enable Program"):WI.UIString("Disable Program")})}_handleMouseOver(e){this.representedObject.showHighlight()}_handleMouseOut(e){this.representedObject.hideHighlight()}};WI.Sidebar=class extends WI.View{constructor(e,t,i,n,s,a){if(super(e),console.assert(!t||t===WI.Sidebar.Sides.Left||t===WI.Sidebar.Sides.Right),this._side=t||WI.Sidebar.Sides.Left,this._collapsed=!0,this.element.classList.add("sidebar",this._side,WI.Sidebar.CollapsedStyleClassName),this.element.setAttribute("role",n||"group"),s&&this.element.setAttribute("aria-label",s),a&&(this.element.classList.add("has-navigation-bar"),this._navigationBar=new WI.SidebarNavigationBar(null,null,"tablist"),this._navigationBar.addEventListener(WI.NavigationBar.Event.NavigationItemSelected,this._navigationItemSelected,this),this.addSubview(this._navigationBar)),this._resizer=new WI.Resizer(WI.Resizer.RuleOrientation.Vertical,this),this.element.insertBefore(this._resizer.element,this.element.firstChild),this._sidebarPanels=[],i)for(let d of i)this.addSidebarPanel(d)}addSidebarPanel(e){this.insertSidebarPanel(e,this._sidebarPanels.length)}insertSidebarPanel(e,t){console.assert(e instanceof WI.SidebarPanel),e instanceof WI.SidebarPanel&&(console.assert(!e.parentSidebar),!e.parentSidebar&&(console.assert(t>=0&&t<=this._sidebarPanels.length),this._sidebarPanels.splice(t,0,e),this._navigationBar&&(console.assert(e.navigationItem),this._navigationBar.insertNavigationItem(e.navigationItem,t))))}removeSidebarPanel(e){var t=this.findSidebarPanel(e);if(!!t){if(t.visible&&(t.hidden(),t.visibilityDidChange()),t.selected=!1,this._selectedSidebarPanel===t){var i=this._sidebarPanels.indexOf(t);this.selectedSidebarPanel=this._sidebarPanels[i-1]||this._sidebarPanels[i+1]||null}this._sidebarPanels.remove(t),this._navigationBar&&(console.assert(t.navigationItem),this._navigationBar.removeNavigationItem(t.navigationItem))}}get selectedSidebarPanel(){return this._selectedSidebarPanel||null}set selectedSidebarPanel(e){var t=this.findSidebarPanel(e);this._selectedSidebarPanel!==t&&(this._selectedSidebarPanel&&(this._selectedSidebarPanel.hidden(),this._selectedSidebarPanel.visibilityDidChange(),this._selectedSidebarPanel.selected=!1,this.removeSubview(this._selectedSidebarPanel)),this._selectedSidebarPanel=t||null,this._navigationBar&&(this._navigationBar.selectedNavigationItem=t?t.navigationItem:null),this._selectedSidebarPanel&&(this.addSubview(this._selectedSidebarPanel),this._selectedSidebarPanel.selected=!0,this._selectedSidebarPanel.shown(),this._selectedSidebarPanel.visibilityDidChange()),this.dispatchEventToListeners(WI.Sidebar.Event.SidebarPanelSelected))}get minimumWidth(){return this._navigationBar?Math.max(WI.Sidebar.AbsoluteMinimumWidth,this._navigationBar.minimumWidth):this._selectedSidebarPanel?Math.max(WI.Sidebar.AbsoluteMinimumWidth,this._selectedSidebarPanel.minimumWidth):WI.Sidebar.AbsoluteMinimumWidth}get maximumWidth(){return WI.getMaximumSidebarWidth(this)}get width(){return this.element.offsetWidth}set width(e){e!==this.width&&this._recalculateWidth(e)}get collapsed(){return this._collapsed}set collapsed(e){e!==this._collapsed&&(this._collapsed=e||!1,this.element.classList.toggle(WI.Sidebar.CollapsedStyleClassName),!this._collapsed&&this._navigationBar&&this._navigationBar.needsLayout(),this._selectedSidebarPanel&&(this._selectedSidebarPanel.visible?this._selectedSidebarPanel.shown():this._selectedSidebarPanel.hidden(),this._selectedSidebarPanel.visibilityDidChange()),this.dispatchEventToListeners(WI.Sidebar.Event.CollapsedStateDidChange),this.dispatchEventToListeners(WI.Sidebar.Event.WidthDidChange))}get sidebarPanels(){return this._sidebarPanels}get side(){return this._side}findSidebarPanel(e){var t=null;if(e instanceof WI.SidebarPanel)this._sidebarPanels.includes(e)&&(t=e);else if(typeof e=="number")t=this._sidebarPanels[e];else if(typeof e=="string"){for(var i=0;i<this._sidebarPanels.length;++i)if(this._sidebarPanels[i].identifier===e){t=this._sidebarPanels[i];break}}return t}resizerDragStarted(e){this._widthBeforeResize=this.width}resizerDragging(e,t){this._side===WI.Sidebar.Sides.Left&&(t*=-1),WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL&&(t*=-1);var i=t+this._widthBeforeResize;this.width=i,this.collapsed=i<this.minimumWidth/2}resizerDragEnded(e){this._widthBeforeResize!==this.width&&(!this.collapsed&&this._navigationBar&&this._navigationBar.sizeDidChange(),!this.collapsed&&this._selectedSidebarPanel&&this._selectedSidebarPanel.sizeDidChange())}_recalculateWidth(e=this.width){e=Math.ceil(Number.constrain(e,this.minimumWidth+1,this.maximumWidth)),this.element.style.width=`${e}px`,!this.collapsed&&(this._navigationBar&&this._navigationBar.updateLayoutIfNeeded(WI.View.LayoutReason.Resize),this._selectedSidebarPanel&&this._selectedSidebarPanel.updateLayoutIfNeeded(WI.View.LayoutReason.Resize),this.dispatchEventToListeners(WI.Sidebar.Event.WidthDidChange,{newWidth:e}))}_navigationItemSelected(e){this.selectedSidebarPanel=e.target.selectedNavigationItem?e.target.selectedNavigationItem.identifier:null}};WI.Sidebar.CollapsedStyleClassName="collapsed";WI.Sidebar.AbsoluteMinimumWidth=200;WI.Sidebar.Sides={Right:"right",Left:"left"};WI.Sidebar.Event={SidebarPanelSelected:"sidebar-panel-selected",CollapsedStateDidChange:"sidebar-collapsed-state-did-change",WidthDidChange:"sidebar-width-did-change"};WI.SidebarNavigationBar=class extends WI.NavigationBar{constructor(e,t,i,n){super(e,t,i,n),this.element.classList.add("sidebar-navigation-bar"),this._holderElement=this.element.appendChild(document.createElement("div")),this._holderElement.className="holder"}insertNavigationItem(e,t){return super.insertNavigationItem(e,t,this._holderElement)}_calculateMinimumWidth(){return this._holderElement.offsetWidth}};WI.Slider=class extends WI.Object{constructor(){super(),this._element=document.createElement("div"),this._element.className="slider",this._knob=this._element.appendChild(document.createElement("img")),this._value=0,this._knobX=0,this._maxX=0,this._element.addEventListener("mousedown",this)}get element(){return this._element}get value(){return this._value}set value(e){e=Math.max(Math.min(e,1),0),e!==this._value&&(this.knobX=e,this.delegate&&typeof this.delegate.sliderValueDidChange=="function"&&this.delegate.sliderValueDidChange(this,e))}set knobX(e){this._value=e,this._knobX=Math.round(e*this.maxX),this._knob.style.webkitTransform="translate3d("+this._knobX+"px, 0, 0)"}get maxX(){return this._maxX<=0&&document.body.contains(this._element)&&(this._maxX=Math.max(this._element.offsetWidth-Math.ceil(WI.Slider.KnobWidth/2),0)),this._maxX}recalculateKnobX(){this._maxX=0,this.knobX=this._value}handleEvent(e){switch(e.type){case"mousedown":this._handleMousedown(e);break;case"mousemove":this._handleMousemove(e);break;case"mouseup":this._handleMouseup(e);break}}_handleMousedown(e){e.target!==this._knob&&(this.value=(this._localPointForEvent(e).x-3)/this.maxX),this._startKnobX=this._knobX,this._startMouseX=this._localPointForEvent(e).x,this._element.classList.add("dragging"),window.addEventListener("mousemove",this,!0),window.addEventListener("mouseup",this,!0)}_handleMousemove(e){var t=this._localPointForEvent(e).x-this._startMouseX,i=Math.max(Math.min(this._startKnobX+t,this.maxX),0);this.value=i/this.maxX}_handleMouseup(e){this._element.classList.remove("dragging"),window.removeEventListener("mousemove",this,!0),window.removeEventListener("mouseup",this,!0)}_localPointForEvent(e){return window.webkitConvertPointFromPageToNode(this._element,new WebKitPoint(e.pageX,e.pageY))}};WI.Slider.KnobWidth=13;WI.SoftContextMenu=class{constructor(e,t){this._items=e,this._parentMenu=t}show(e){const t=!!this._parentMenu;this._contextMenuElement=document.createElement("div"),this._contextMenuElement.className="soft-context-menu",this._contextMenuElement.style.left=e.pageX+"px",this._contextMenuElement.style.top=e.pageY+"px",this._contextMenuElement.tabIndex=0,this._contextMenuElement.addEventListener("keydown",this._menuKeyDown.bind(this),!1);for(let i of this._items)this._contextMenuElement.appendChild(this._createMenuItem(i));t?this._parentGlassPaneElement().appendChild(this._contextMenuElement):(this._glassPaneElement=document.createElement("div"),this._glassPaneElement.className="soft-context-menu-glass-pane",this._glassPaneElement.addEventListener("mousedown",this._glassPaneMouseDown.bind(this),!1),this._glassPaneElement.appendChild(this._contextMenuElement),document.body.appendChild(this._glassPaneElement),this._focus(),this._consumeEvent(e,!0)),this._repositionMenuOnScreen(t)}_consumeEvent(e,t){e.stopImmediatePropagation(),t&&e.preventDefault(),e.handled=!0}_parentGlassPaneElement(){return this._parentMenu?this._parentMenu._glassPaneElement?this._parentMenu._glassPaneElement:this._parentMenu._parentGlassPaneElement():null}_createMenuItem(e){if(e.type==="separator")return this._createSeparator();const t="\u2713",i="\u25B6",n=document.createElement("div");n.className="item",e.enabled||n.classList.add("disabled");const s=document.createElement("span");s.textContent=e.checked?t:"",s.className="checkmark",n.appendChild(s);const a=document.createElement("span");if(a.textContent=e.label,a.className="label",n.appendChild(a),e.type==="subMenu"){const d=document.createElement("span");d.textContent=i,d.className="submenu-arrow",n.appendChild(d),n._subItems=e.subItems}else n._actionId=e.id;return n.addEventListener("contextmenu",this._menuItemContextMenu.bind(this),!1),n.addEventListener("mousedown",this._menuItemMouseDown.bind(this),!1),n.addEventListener("mouseup",this._menuItemMouseUp.bind(this),!1),n.addEventListener("mouseover",this._menuItemMouseOver.bind(this),!1),n.addEventListener("mouseout",this._menuItemMouseOut.bind(this),!1),n}_createSeparator(){const e=document.createElement("div");return e.className="separator",e._isSeparator=!0,e.createChild("div","line"),e.addEventListener("contextmenu",this._menuItemContextMenu.bind(this),!1),e.addEventListener("mousedown",this._menuItemMouseDown.bind(this),!1),e.addEventListener("mouseup",this._menuItemMouseUp.bind(this),!1),e.addEventListener("mouseover",this._menuItemMouseOver.bind(this),!1),e}_repositionMenuOnScreen(e){if(this._contextMenuElement.offsetLeft+this._contextMenuElement.offsetWidth>document.body.offsetWidth)if(e){const i=this._parentMenu._contextMenuElement.offsetLeft-this._contextMenuElement.offsetWidth+2,n=this._contextMenuElement.offsetLeft-this._contextMenuElement.offsetWidth+2;this._contextMenuElement.style.left=(i>=0?i:n)+"px"}else{const t=this._contextMenuElement.offsetLeft-this._contextMenuElement.offsetWidth,i=document.body.offsetWidth-this._contextMenuElement.offsetWidth;this._contextMenuElement.style.left=(t>=0?t:i)+"px"}if(this._contextMenuElement.offsetTop+this._contextMenuElement.offsetHeight>document.body.offsetHeight){const t=this._contextMenuElement.offsetTop-this._contextMenuElement.offsetHeight,i=document.body.offsetHeight-this._contextMenuElement.offsetHeight;this._contextMenuElement.style.top=(!e&&t>=0?t:i)+"px"}}_showSubMenu(e){e._subMenuTimer&&(clearTimeout(e._subMenuTimer),e._subMenuTimer=0),!this._subMenu&&(this._subMenu=new WI.SoftContextMenu(e._subItems,this),this._subMenu.show({pageX:this._contextMenuElement.offsetLeft+e.offsetWidth,pageY:this._contextMenuElement.offsetTop+e.offsetTop-4}))}_hideSubMenu(){!this._subMenu||(this._subMenu._discardSubMenus(),this._focus())}_menuItemContextMenu(e){this._consumeEvent(e,!0)}_menuItemMouseDown(e){this._consumeEvent(e,!0)}_menuItemMouseUp(e){this._triggerAction(e.target,e),this._consumeEvent(e)}_menuItemMouseOver(e){this._highlightMenuItem(e.target._isSeparator?null:e.target)}_menuItemMouseOut(e){(!this._subMenu||!e.relatedTarget||this._contextMenuElement.contains(e.relatedTarget)||e.relatedTarget.classList.contains("soft-context-menu-glass-pane"))&&this._highlightMenuItem(null)}_menuKeyDown(e){switch(e.keyIdentifier){case"Up":this._highlightPrevious();break;case"Down":this._highlightNext();break;case"Left":this._parentMenu&&(this._highlightMenuItem(null),this._parentMenu._hideSubMenu());break;case"Enter":if(!isEnterKey(e))break;case"U+0020":this._highlightedMenuItemElement&&!this._highlightedMenuItemElement._subItems&&this._triggerAction(this._highlightedMenuItemElement,e);case"Right":this._highlightedMenuItemElement&&this._highlightedMenuItemElement._subItems&&(this._showSubMenu(this._highlightedMenuItemElement),this._subMenu._focus(),this._subMenu._highlightNext());break;case"U+001B":this._discardMenu(!0,e);break}this._consumeEvent(e,!0)}_glassPaneMouseDown(e){this._discardMenu(!0,e),this._consumeEvent(e)}_focus(){this._contextMenuElement.focus()}_triggerAction(e,t){if(!e._subItems){this._discardMenu(!0,t),typeof e._actionId=="number"&&(WI.ContextMenu.contextMenuItemSelected(e._actionId),e._actionId=null);return}this._showSubMenu(e),this._consumeEvent(t)}_highlightMenuItem(e,t){this._highlightedMenuItemElement!==e&&(this._hideSubMenu(),this._highlightedMenuItemElement&&(this._highlightedMenuItemElement.classList.remove("highlighted"),this._highlightedMenuItemElement._subItems&&this._highlightedMenuItemElement._subMenuTimer&&(clearTimeout(this._highlightedMenuItemElement._subMenuTimer),this._highlightedMenuItemElement._subMenuTimer=0)),this._highlightedMenuItemElement=e,this._highlightedMenuItemElement&&(this._highlightedMenuItemElement.classList.add("highlighted"),this._contextMenuElement.focus(),!t&&this._highlightedMenuItemElement._subItems&&!this._highlightedMenuItemElement._subMenuTimer&&(this._highlightedMenuItemElement._subMenuTimer=setTimeout(this._showSubMenu.bind(this,this._highlightedMenuItemElement),150))))}_highlightPrevious(){let e=this._highlightedMenuItemElement?this._highlightedMenuItemElement.previousSibling:this._contextMenuElement.lastChild;for(;e&&e._isSeparator;)e=e.previousSibling;e&&this._highlightMenuItem(e,!0)}_highlightNext(){let e=this._highlightedMenuItemElement?this._highlightedMenuItemElement.nextSibling:this._contextMenuElement.firstChild;for(;e&&e._isSeparator;)e=e.nextSibling;e&&this._highlightMenuItem(e,!0)}_discardMenu(e,t){if(!(this._subMenu&&!e))if(this._glassPaneElement){const i=this._glassPaneElement;this._glassPaneElement=null,document.body.removeChild(i),this._parentMenu&&(this._parentMenu._subMenu=null,e&&this._parentMenu._discardMenu(e,t)),t&&this._consumeEvent(t,!0)}else this._parentMenu&&this._contextMenuElement.parentElement&&(this._discardSubMenus(),e&&this._parentMenu._discardMenu(e,t),t&&this._consumeEvent(t,!0))}_discardSubMenus(){this._subMenu&&this._subMenu._discardSubMenus(),this._contextMenuElement.parentElement&&this._contextMenuElement.parentElement.removeChild(this._contextMenuElement),this._parentMenu&&(this._parentMenu._subMenu=null)}};WI.SourceCodeTextEditor=class extends WI.TextEditor{constructor(e){console.assert(e instanceof WI.SourceCode),super(),this.delegate=this,this._sourceCode=e,this._breakpointMap={},this._issuesLineNumberMap=new Map,this._widgetMap=new Map,this._contentPopulated=!1,this._invalidLineNumbers={0:!0},this._requestingScriptContent=!1,this._activeCallFrameSourceCodeLocation=null,this._threadLineNumberMap=new Map,this._threadWidgetMap=new Map,this._threadTargetMap=new Map,this._typeTokenScrollHandler=null,this._typeTokenAnnotator=null,this._basicBlockAnnotator=null,this._editingController=null,this._autoFormat=!1,this._isProbablyMinified=!1,this._ignoreContentDidChange=0,this._ignoreLocationUpdateBreakpoint=null,this._ignoreBreakpointAddedBreakpoint=null,this._ignoreBreakpointRemovedBreakpoint=null,this._ignoreAllBreakpointLocationUpdates=!1,this._updateTokenTrackingControllerState(),this.element.classList.add("source-code"),this._supportsDebugging&&(WI.Breakpoint.addEventListener(WI.Breakpoint.Event.DisabledStateDidChange,this._breakpointStatusDidChange,this),WI.Breakpoint.addEventListener(WI.Breakpoint.Event.AutoContinueDidChange,this._breakpointStatusDidChange,this),WI.Breakpoint.addEventListener(WI.Breakpoint.Event.ResolvedStateDidChange,this._breakpointStatusDidChange,this),WI.Breakpoint.addEventListener(WI.Breakpoint.Event.LocationDidChange,this._updateBreakpointLocation,this),WI.targetManager.addEventListener(WI.TargetManager.Event.TargetAdded,this._targetAdded,this),WI.targetManager.addEventListener(WI.TargetManager.Event.TargetRemoved,this._targetRemoved,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.BreakpointsEnabledDidChange,this._breakpointsEnabledDidChange,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.BreakpointAdded,this._breakpointAdded,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.BreakpointRemoved,this._breakpointRemoved,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.CallFramesDidChange,this._callFramesDidChange,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.ActiveCallFrameDidChange,this._activeCallFrameDidChange,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.Paused,this._debuggerDidPause,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.Resumed,this._debuggerDidResume,this),WI.debuggerManager.activeCallFrame&&this._debuggerDidPause(),this._activeCallFrameDidChange()),WI.consoleManager.addEventListener(WI.ConsoleManager.Event.IssueAdded,this._issueWasAdded,this),this._sourceCode instanceof WI.SourceMapResource||this._sourceCode.sourceMaps.length>0?WI.notifications.addEventListener(WI.Notification.GlobalModifierKeysDidChange,this._updateTokenTrackingControllerState,this):this._sourceCode.addEventListener(WI.SourceCode.Event.SourceMapAdded,this._sourceCodeSourceMapAdded,this),e.requestContent().then(this._contentAvailable.bind(this)),new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.Control,"G",this.showGoToLineDialog.bind(this),this.element),WI.consoleManager.addEventListener(WI.ConsoleManager.Event.Cleared,this._logCleared,this)}get sourceCode(){return this._sourceCode}get target(){return this._sourceCode instanceof WI.SourceMapResource&&this._sourceCode.sourceMap.originalSourceCode instanceof WI.Script?this._sourceCode.sourceMap.originalSourceCode.target:this._sourceCode instanceof WI.Script?this._sourceCode.target:WI.mainTarget}shown(){super.shown(),WI.settings.showJavaScriptTypeInformation.value?(this._typeTokenAnnotator&&this._typeTokenAnnotator.resume(),!this._typeTokenScrollHandler&&this._typeTokenAnnotator&&this._enableScrollEventsForTypeTokenAnnotator()):this._typeTokenAnnotator&&this._setTypeTokenAnnotatorEnabledState(!1),WI.settings.enableControlFlowProfiler.value?(this._basicBlockAnnotator&&this._basicBlockAnnotator.resume(),!this._controlFlowScrollHandler&&this._basicBlockAnnotator&&this._enableScrollEventsForControlFlowAnnotator()):this._basicBlockAnnotatorEnabled=!1}hidden(){super.hidden(),this.tokenTrackingController.removeHighlightedRange(),this._dismissPopover(),this._dismissEditingController(!0),this._typeTokenAnnotator&&this._typeTokenAnnotator.pause(),this._basicBlockAnnotator&&this._basicBlockAnnotator.pause()}close(){this._supportsDebugging&&(WI.Breakpoint.removeEventListener(null,null,this),WI.debuggerManager.removeEventListener(null,null,this),WI.targetManager.removeEventListener(null,null,this),this._activeCallFrameSourceCodeLocation&&(this._activeCallFrameSourceCodeLocation.removeEventListener(WI.SourceCodeLocation.Event.LocationChanged,this._activeCallFrameSourceCodeLocationChanged,this),this._activeCallFrameSourceCodeLocation=null)),WI.consoleManager.removeEventListener(WI.ConsoleManager.Event.IssueAdded,this._issueWasAdded,this),this._sourceCode instanceof WI.SourceMapResource||this._sourceCode.sourceMaps.length>0?WI.notifications.removeEventListener(WI.Notification.GlobalModifierKeysDidChange,this._updateTokenTrackingControllerState,this):this._sourceCode.removeEventListener(WI.SourceCode.Event.SourceMapAdded,this._sourceCodeSourceMapAdded,this)}canBeFormatted(){return this._sourceCode instanceof WI.SourceMapResource?!1:super.canBeFormatted()}canShowTypeAnnotations(){return!!this._getAssociatedScript()&&!this.hasModified}canShowCoverageHints(){return!!this._getAssociatedScript()&&!this.hasModified}customPerformSearch(e){function t(s,a){if(this.currentSearchQuery!==e)return;if(s||!a||!a.length){this.dispatchEventToListeners(WI.TextEditor.Event.NumberOfSearchResultsDidChange);return}let d=WI.SearchUtilities.regExpForString(e,WI.SearchUtilities.defaultSettings);for(var p=[],f=0;f<a.length;++f){var _=a[f].lineNumber,b=this.line(_);if(!b)return;d.lastIndex=0;for(var w=null;d.lastIndex+e.length<=b.length&&(w=d.exec(b));){var S=new WI.TextRange(_,w.index,_,d.lastIndex);p.push(S)}}this.addSearchResults(p),this.dispatchEventToListeners(WI.TextEditor.Event.NumberOfSearchResultsDidChange)}if(this.hasEdits()||this._sourceCode instanceof WI.SourceMapResource)return!1;let i=WI.SearchUtilities.defaultSettings.caseSensitive.value,n=WI.SearchUtilities.defaultSettings.regularExpression.value;return this._sourceCode instanceof WI.Resource?PageAgent.searchInResource(this._sourceCode.parentFrame.id,this._sourceCode.url,e,i,n,t.bind(this)):this._sourceCode instanceof WI.Script&&this._sourceCode.target.DebuggerAgent.searchInContent(this._sourceCode.id,e,i,n,t.bind(this)),!0}showGoToLineDialog(){this._goToLineDialog||(this._goToLineDialog=new WI.GoToLineDialog(this)),this._goToLineDialog.present(this.element)}isDialogRepresentedObjectValid(e,t){return!isNaN(t)&&t>0&&t<=this.lineCount}dialogWasDismissedWithRepresentedObject(e,t){let i=new WI.SourceCodePosition(t-1,0),n=new WI.TextRange(t-1,0,t,0);this.revealPosition(i,n,!1,!0)}contentDidChange(e,t){if(super.contentDidChange(e,t),!(this._ignoreContentDidChange>0)){for(var i of t)this._updateEditableMarkers(i);this._basicBlockAnnotator&&(this._basicBlockAnnotatorEnabled=!1,this._basicBlockAnnotator=null),this._typeTokenAnnotator&&(this._setTypeTokenAnnotatorEnabledState(!1),this._typeTokenAnnotator=null)}}toggleTypeAnnotations(){if(!this._typeTokenAnnotator)return Promise.reject(new Error("TypeTokenAnnotator is not initialized."));var e=!this._typeTokenAnnotator.isActive();return e&&this._isProbablyMinified&&!this.formatted?this.updateFormattedState(!0).then(()=>{this._setTypeTokenAnnotatorEnabledState(e)}):(this._setTypeTokenAnnotatorEnabledState(e),Promise.resolve())}toggleUnexecutedCodeHighlights(){if(!this._basicBlockAnnotator)return Promise.reject(new Error("BasicBlockAnnotator is not initialized."));let e=!this._basicBlockAnnotator.isActive();return e&&this._isProbablyMinified&&!this.formatted?this.updateFormattedState(!0).then(()=>{this._basicBlockAnnotatorEnabled=e}):(this._basicBlockAnnotatorEnabled=e,Promise.resolve())}showPopoverForTypes(e,t,i){var n=document.createElement("div");n.className="object expandable";var s=document.createElement("div");s.className="title",s.textContent=i,n.appendChild(s);var a=n.appendChild(document.createElement("div"));a.className="body";var d=new WI.TypeTreeView(e);a.appendChild(d.element),this._showPopover(n,t)}prettyPrint(e){var t=this._basicBlockAnnotator&&this._basicBlockAnnotator.isActive();t&&(this._basicBlockAnnotatorEnabled=!1);let i=this._typeTokenAnnotator&&this._typeTokenAnnotator.isActive();return i&&this._setTypeTokenAnnotatorEnabledState(!1),super.prettyPrint(e).then(()=>{e||!this._isProbablyMinified?(t&&(this._basicBlockAnnotatorEnabled=!0),i&&this._setTypeTokenAnnotatorEnabledState(!0)):(console.assert(!e&&this._isProbablyMinified),this._basicBlockAnnotator&&(this._basicBlockAnnotatorEnabled=!1),this._setTypeTokenAnnotatorEnabledState(!1))})}_unformattedLineInfoForEditorLineInfo(e){return this.formatterSourceMap?this.formatterSourceMap.formattedToOriginal(e.lineNumber,e.columnNumber):e}_sourceCodeLocationForEditorPosition(e){var t={lineNumber:e.line,columnNumber:e.ch},i=this._unformattedLineInfoForEditorLineInfo(t);return this.sourceCode.createSourceCodeLocation(i.lineNumber,i.columnNumber)}_editorLineInfoForSourceCodeLocation(e){return this._sourceCode instanceof WI.SourceMapResource?{lineNumber:e.displayLineNumber,columnNumber:e.displayColumnNumber}:{lineNumber:e.formattedLineNumber,columnNumber:e.formattedColumnNumber}}_breakpointForEditorLineInfo(e){return this._breakpointMap[e.lineNumber]?this._breakpointMap[e.lineNumber][e.columnNumber]:null}_addBreakpointWithEditorLineInfo(e,t){this._breakpointMap[t.lineNumber]||(this._breakpointMap[t.lineNumber]={}),this._breakpointMap[t.lineNumber][t.columnNumber]=e}_removeBreakpointWithEditorLineInfo(e,t){console.assert(e===this._breakpointMap[t.lineNumber][t.columnNumber]),delete this._breakpointMap[t.lineNumber][t.columnNumber],isEmptyObject(this._breakpointMap[t.lineNumber])&&delete this._breakpointMap[t.lineNumber]}_populateWithContent(e){if(e=e||"",this._prepareEditorForInitialContent(e),this._autoFormat){console.assert(!this.formatted),this._autoFormat=!1,this.deferReveal=!0,this.string=e,this.deferReveal=!1,this.updateFormattedState(!0).then(()=>{this._proceedPopulateWithContent(this.string)});return}this._proceedPopulateWithContent(e)}_proceedPopulateWithContent(e){this.dispatchEventToListeners(WI.SourceCodeTextEditor.Event.ContentWillPopulate),this.string=e,this._createBasicBlockAnnotator(),WI.settings.enableControlFlowProfiler.value&&this._basicBlockAnnotator&&(this._basicBlockAnnotatorEnabled=!0),this._createTypeTokenAnnotator(),WI.settings.showJavaScriptTypeInformation.value&&this._setTypeTokenAnnotatorEnabledState(!0),this._contentDidPopulate()}_contentDidPopulate(){this._contentPopulated=!0,this.dispatchEventToListeners(WI.SourceCodeTextEditor.Event.ContentDidPopulate),this._reinsertAllIssues(),this._reinsertAllThreadIndicators(),this._updateEditableMarkers()}_prepareEditorForInitialContent(e){if(!this._contentPopulated){if(this._supportsDebugging){this._breakpointMap={};for(let i of WI.debuggerManager.breakpointsForSourceCode(this._sourceCode)){console.assert(this._matchesBreakpoint(i));var t=this._editorLineInfoForSourceCodeLocation(i.sourceCodeLocation);this._addBreakpointWithEditorLineInfo(i,t),this.setBreakpointInfoForLineAndColumn(t.lineNumber,t.columnNumber,this._breakpointInfoForBreakpoint(i))}}this._sourceCode instanceof WI.Resource?this.mimeType=this._sourceCode.syntheticMIMEType:this._sourceCode instanceof WI.Script?this.mimeType="text/javascript":this._sourceCode instanceof WI.CSSStyleSheet&&(this.mimeType="text/css"),console.assert(!this.formatted),this.canBeFormatted()&&isTextLikelyMinified(e)&&(this._autoFormat=!0,this._isProbablyMinified=!0)}}_contentAvailable(e){if(!e.error){var t=e.sourceCode,i=t.content,n=e.base64Encoded;console.assert(t===this._sourceCode),console.assert(!n),!this._fullContentPopulated&&(this._fullContentPopulated=!0,this._invalidLineNumbers={},this.repeatReveal=!!this.string,this._populateWithContent(i),this.repeatReveal=!1)}}_breakpointStatusDidChange(e){this._updateBreakpointStatus(e.target)}_breakpointsEnabledDidChange(){console.assert(this._supportsDebugging);for(let e of WI.debuggerManager.breakpointsForSourceCode(this._sourceCode))this._updateBreakpointStatus(e)}_updateBreakpointStatus(e){if(console.assert(this._supportsDebugging),!!this._contentPopulated&&!!this._matchesBreakpoint(e)){var t=this._editorLineInfoForSourceCodeLocation(e.sourceCodeLocation);this.setBreakpointInfoForLineAndColumn(t.lineNumber,t.columnNumber,this._breakpointInfoForBreakpoint(e))}}_updateBreakpointLocation(e){if(console.assert(this._supportsDebugging),!!this._contentPopulated){var t=e.target;if(!!this._matchesBreakpoint(t)&&!this._ignoreAllBreakpointLocationUpdates&&t!==this._ignoreLocationUpdateBreakpoint){var i=t.sourceCodeLocation;if(this._sourceCode instanceof WI.SourceMapResource){if(i.displaySourceCode!==this._sourceCode)return;var n={lineNumber:e.data.oldDisplayLineNumber,columnNumber:e.data.oldDisplayColumnNumber},s={lineNumber:i.displayLineNumber,columnNumber:i.displayColumnNumber}}else{if(i.sourceCode!==this._sourceCode)return;var n={lineNumber:e.data.oldFormattedLineNumber,columnNumber:e.data.oldFormattedColumnNumber},s={lineNumber:i.formattedLineNumber,columnNumber:i.formattedColumnNumber}}var a=this._breakpointForEditorLineInfo(n);!a||(console.assert(t===a),this.setBreakpointInfoForLineAndColumn(n.lineNumber,n.columnNumber,null),this.setBreakpointInfoForLineAndColumn(s.lineNumber,s.columnNumber,this._breakpointInfoForBreakpoint(t)),this._removeBreakpointWithEditorLineInfo(t,n),this._addBreakpointWithEditorLineInfo(t,s))}}}_breakpointAdded(e){if(console.assert(this._supportsDebugging),!!this._contentPopulated){var t=e.data.breakpoint;if(!!this._matchesBreakpoint(t)&&t!==this._ignoreBreakpointAddedBreakpoint){var i=this._editorLineInfoForSourceCodeLocation(t.sourceCodeLocation);this._addBreakpointWithEditorLineInfo(t,i),this.setBreakpointInfoForLineAndColumn(i.lineNumber,i.columnNumber,this._breakpointInfoForBreakpoint(t))}}}_breakpointRemoved(e){if(console.assert(this._supportsDebugging),!!this._contentPopulated){var t=e.data.breakpoint;if(!!this._matchesBreakpoint(t)&&t!==this._ignoreBreakpointRemovedBreakpoint){var i=this._editorLineInfoForSourceCodeLocation(t.sourceCodeLocation);this._removeBreakpointWithEditorLineInfo(t,i),this.setBreakpointInfoForLineAndColumn(i.lineNumber,i.columnNumber,null)}}}_targetAdded(e){WI.targets.length===2&&this._reinsertAllThreadIndicators()}_targetRemoved(e){if(WI.targets.length===1){this._reinsertAllThreadIndicators();return}let t=e.data.target;this._removeThreadIndicatorForTarget(t)}_callFramesDidChange(e){if(WI.targets.length===1)return;let t=e.data.target;this._removeThreadIndicatorForTarget(t),this._addThreadIndicatorForTarget(t)}_addThreadIndicatorForTarget(e){let i=WI.debuggerManager.dataForTarget(e).callFrames[0];if(!i)return;let n=i.sourceCodeLocation;if(console.assert(n,"Expected source code location to place thread indicator."),!n||!this._looselyMatchesSourceCodeLocation(n))return;let s=n.formattedLineNumber;this._threadTargetMap.set(e,s);let a=this._threadLineNumberMap.get(s);a||(a=[],this._threadLineNumberMap.set(s,a)),a.push(e);let d=this._threadIndicatorWidgetForLine(e,s);this._updateThreadIndicatorWidget(d,a),this.addStyleClassToLine(s,"thread-indicator")}_removeThreadIndicatorForTarget(e){let t=this._threadTargetMap.take(e);if(t===void 0)return;let i=this._threadLineNumberMap.get(t);if(i.remove(e),i.length){let s=this._threadWidgetMap.get(t);this._updateThreadIndicatorWidget(s,i);return}this._threadLineNumberMap.delete(t);let n=this._threadWidgetMap.take(t);n&&n.clear(),this.removeStyleClassFromLine(t,"thread-indicator")}_threadIndicatorWidgetForLine(e,t){let i=this._threadWidgetMap.get(t);if(i)return i;if(i=this.createWidgetForLine(t),!i)return null;let n=i.widgetElement;return n.classList.add("line-indicator-widget","thread-widget","inline"),n.addEventListener("click",this._handleThreadIndicatorWidgetClick.bind(this,i,t)),this._threadWidgetMap.set(t,i),i}_updateThreadIndicatorWidget(e,t){if(!e)return;console.assert(WI.targets.length>1);let i=e.widgetElement;if(i.removeChildren(),e[WI.SourceCodeTextEditor.WidgetContainsMultipleThreadsSymbol]=t.length>1,i.classList.contains("inline")||t.length===1){let n=i.appendChild(document.createElement("span"));n.className="text",n.textContent=t.length===1?t[0].displayName:WI.UIString("%d Threads").format(t.length)}else for(let n of t){let s=i.appendChild(document.createElement("span"));s.className="text",s.textContent=n.displayName,i.appendChild(document.createElement("br"))}e.update()}_handleThreadIndicatorWidgetClick(e,t,i){if(!this._isWidgetToggleable(e))return;e.widgetElement.classList.toggle("inline");let n=this._threadLineNumberMap.get(t);this._updateThreadIndicatorWidget(e,n)}_activeCallFrameDidChange(){console.assert(this._supportsDebugging),this._activeCallFrameSourceCodeLocation&&(this._activeCallFrameSourceCodeLocation.removeEventListener(WI.SourceCodeLocation.Event.LocationChanged,this._activeCallFrameSourceCodeLocationChanged,this),this._activeCallFrameSourceCodeLocation=null);let e=WI.debuggerManager.activeCallFrame;if(!e||!this._matchesSourceCodeLocation(e.sourceCodeLocation)){this.setExecutionLineAndColumn(NaN,NaN);return}this._dismissPopover(),this._activeCallFrameSourceCodeLocation=e.sourceCodeLocation,this._activeCallFrameSourceCodeLocation.addEventListener(WI.SourceCodeLocation.Event.LocationChanged,this._activeCallFrameSourceCodeLocationChanged,this);let t=this._editorLineInfoForSourceCodeLocation(e.sourceCodeLocation);this.setExecutionLineAndColumn(t.lineNumber,t.columnNumber),!(this._fullContentPopulated||!(this._sourceCode instanceof WI.Resource)||this._requestingScriptContent)&&(this._sourceCode.type===WI.Resource.Type.Document?this._populateWithInlineScriptContent():this._populateWithScriptContent())}_activeCallFrameSourceCodeLocationChanged(e){if(console.assert(!isNaN(this.executionLineNumber)),!isNaN(this.executionLineNumber)){console.assert(WI.debuggerManager.activeCallFrame),console.assert(this._activeCallFrameSourceCodeLocation===WI.debuggerManager.activeCallFrame.sourceCodeLocation);var t=this._editorLineInfoForSourceCodeLocation(this._activeCallFrameSourceCodeLocation);this.setExecutionLineAndColumn(t.lineNumber,t.columnNumber)}}_populateWithInlineScriptContent(){console.assert(this._sourceCode instanceof WI.Resource),console.assert(!this._fullContentPopulated),console.assert(!this._requestingScriptContent);var e=this._sourceCode.scripts;if(console.assert(e.length),!e.length)return;var t=e.length;if(this._inlineScriptContentPopulated===t)return;this._inlineScriptContentPopulated=t;function i(a){if(!--t&&(this._requestingScriptContent=!1,!this._fullContentPopulated)){var d="<script>",p="<\/script>",f="",_=0,b=0;this._invalidLineNumbers={};for(var w=0;w<e.length;++w){for(var S=e[w].range.startLine-_;S>0;--S)b||(this._invalidLineNumbers[e[w].range.startLine-S]=!0),b=0,f+=`
`;for(var E=e[w].range.startColumn-b-d.length;E>0;--E)f+=" ";f+=d,f+=e[w].content,f+=p,_=e[w].range.endLine,b=e[w].range.endColumn+p.length}this._populateWithContent(f)}}this._requestingScriptContent=!0;for(var n=i.bind(this),s=0;s<e.length;++s)e[s].requestContent().then(n)}_populateWithScriptContent(){console.assert(this._sourceCode instanceof WI.Resource),console.assert(!this._fullContentPopulated),console.assert(!this._requestingScriptContent);var e=this._sourceCode.scripts;if(console.assert(e.length===1),!e.length)return;console.assert(e[0].range.startLine===0),console.assert(e[0].range.startColumn===0);function t(i){var n=i.content;this._requestingScriptContent=!1,!this._fullContentPopulated&&(this._fullContentPopulated=!0,this._populateWithContent(n))}this._requestingScriptContent=!0,e[0].requestContent().then(t.bind(this))}_looselyMatchesSourceCodeLocation(e){return this._sourceCode instanceof WI.SourceMapResource?e.displaySourceCode===this._sourceCode:this._sourceCode instanceof WI.Resource||this._sourceCode instanceof WI.Script||this._sourceCode instanceof WI.CSSStyleSheet?e.sourceCode.url===this._sourceCode.url:!1}_matchesSourceCodeLocation(e){return this._sourceCode instanceof WI.SourceMapResource?e.displaySourceCode===this._sourceCode:this._sourceCode instanceof WI.Resource||this._sourceCode instanceof WI.CSSStyleSheet?e.sourceCode.url===this._sourceCode.url:this._sourceCode instanceof WI.Script?e.sourceCode===this._sourceCode:!1}_matchesBreakpoint(e){return console.assert(this._supportsDebugging),this._sourceCode instanceof WI.SourceMapResource?e.sourceCodeLocation.displaySourceCode===this._sourceCode:this._sourceCode instanceof WI.Resource?e.contentIdentifier===this._sourceCode.contentIdentifier:this._sourceCode instanceof WI.Script?e.contentIdentifier===this._sourceCode.contentIdentifier||e.scriptIdentifier===this._sourceCode.id:!1}_issueWasAdded(e){var t=e.data.issue;!WI.ConsoleManager.issueMatchSourceCode(t,this._sourceCode)||this._addIssue(t)}_addIssue(e){var t=e.sourceCodeLocation;if(console.assert(t,"Expected source code location to place issue."),!!t){var i=t.formattedLineNumber,n=this._issuesLineNumberMap.get(i);n||(n=[],this._issuesLineNumberMap.set(i,n));for(var s of n)if(s.sourceCodeLocation.columnNumber===t.columnNumber&&s.text===e.text)return;n.push(e),e.level===WI.IssueMessage.Level.Error?this.addStyleClassToLine(i,WI.SourceCodeTextEditor.LineErrorStyleClassName):e.level===WI.IssueMessage.Level.Warning?this.addStyleClassToLine(i,WI.SourceCodeTextEditor.LineWarningStyleClassName):console.error("Unknown issue level");var a=this._issueWidgetForLine(i);a&&(e.level===WI.IssueMessage.Level.Error?a.widgetElement.classList.add(WI.SourceCodeTextEditor.LineErrorStyleClassName):e.level===WI.IssueMessage.Level.Warning&&a.widgetElement.classList.add(WI.SourceCodeTextEditor.LineWarningStyleClassName),this._updateIssueWidgetForIssues(a,n))}}_issueWidgetForLine(e){var t=this._widgetMap.get(e);if(t)return t;if(t=this.createWidgetForLine(e),!t)return null;var i=t.widgetElement;return i.classList.add("line-indicator-widget","issue-widget","inline"),i.addEventListener("click",this._handleWidgetClick.bind(this,t,e)),this._widgetMap.set(e,t),t}_iconClassNameForIssueLevel(e){return e===WI.IssueMessage.Level.Warning?"icon-warning":(console.assert(e===WI.IssueMessage.Level.Error),"icon-error")}_updateIssueWidgetForIssues(e,t){var i=e.widgetElement;if(i.removeChildren(),i.classList.contains("inline")||t.length===1){var n=i.appendChild(document.createElement("span"));n.className="icon";var s=i.appendChild(document.createElement("span"));if(s.className="text",t.length===1)n.classList.add(this._iconClassNameForIssueLevel(t[0].level)),s.textContent=t[0].text;else{var a=0,d=0;for(var p of t)p.level===WI.IssueMessage.Level.Error?++a:p.level===WI.IssueMessage.Level.Warning&&++d;d&&a?(n.classList.add(this._iconClassNameForIssueLevel(p.level)),s.textContent=WI.UIString("%d Errors, %d Warnings").format(a,d)):a?(n.classList.add(this._iconClassNameForIssueLevel(p.level)),s.textContent=WI.UIString("%d Errors").format(a)):d&&(n.classList.add(this._iconClassNameForIssueLevel(p.level)),s.textContent=WI.UIString("%d Warnings").format(d)),e[WI.SourceCodeTextEditor.WidgetContainsMultipleIssuesSymbol]=!0}}else for(var p of t){var n=i.appendChild(document.createElement("span"));n.className="icon",n.classList.add(this._iconClassNameForIssueLevel(p.level));var s=i.appendChild(document.createElement("span"));s.className="text",s.textContent=p.text,i.appendChild(document.createElement("br"))}e.update()}_isWidgetToggleable(e){if(e[WI.SourceCodeTextEditor.WidgetContainsMultipleIssuesSymbol]||e[WI.SourceCodeTextEditor.WidgetContainsMultipleThreadsSymbol]||!e.widgetElement.classList.contains("inline"))return!0;var t=e.widgetElement.lastChild;return t.offsetWidth!==t.scrollWidth}_handleWidgetClick(e,t,i){if(!!this._isWidgetToggleable(e)){e.widgetElement.classList.toggle("inline");var n=this._issuesLineNumberMap.get(t);this._updateIssueWidgetForIssues(e,n)}}_breakpointInfoForBreakpoint(e){return{resolved:e.resolved,disabled:e.disabled,autoContinue:e.autoContinue}}get _supportsDebugging(){return this._sourceCode instanceof WI.Resource?this._sourceCode.type===WI.Resource.Type.Document||this._sourceCode.type===WI.Resource.Type.Script:this._sourceCode instanceof WI.Script?!(this._sourceCode instanceof WI.LocalScript):!1}textEditorBaseURL(e){return this._sourceCode.url}textEditorScriptSourceType(e){let t=this._getAssociatedScript();return t?t.sourceType:WI.Script.SourceType.Program}textEditorShouldHideLineNumber(e,t){return t in this._invalidLineNumbers}textEditorGutterContextMenu(e,t,i,n,s){if(!this._supportsDebugging)return;s.preventDefault();let a=()=>{let w=this.textEditorBreakpointAdded(this,t,i);this.setBreakpointInfoForLineAndColumn(w.lineNumber,w.columnNumber,w.breakpointInfo)},d=WI.ContextMenu.createFromEvent(s);if(WI.debuggerManager.paused){let w={lineNumber:t,columnNumber:i},S=this._unformattedLineInfoForEditorLineInfo(w),E=this._sourceCode.createSourceCodeLocation(S.lineNumber,S.columnNumber),k;E.sourceCode instanceof WI.Script?k=E.sourceCode:E.sourceCode instanceof WI.Resource&&(k=E.sourceCode.scriptForLocation(E)),k&&(d.appendItem(WI.UIString("Continue to Here"),()=>{WI.debuggerManager.continueToLocation(k,E.lineNumber,E.columnNumber)}),d.appendSeparator())}let p=[];for(let w of n){let S=this._breakpointForEditorLineInfo(w);console.assert(S),S&&p.push(S)}if(!p.length){d.appendItem(WI.UIString("Add Breakpoint"),a.bind(this));return}if(p.length===1){WI.breakpointPopoverController.appendContextMenuItems(d,p[0],s.target),WI.settings.experimentalEnableSourcesTab.value?WI.isShowingSourcesTab()||(d.appendSeparator(),d.appendItem(WI.UIString("Reveal in Sources Tab"),()=>{WI.showSourcesTab({breakpointToSelect:p[0]})})):WI.isShowingDebuggerTab()||(d.appendSeparator(),d.appendItem(WI.UIString("Reveal in Debugger Tab"),()=>{WI.showDebuggerTab({breakpointToSelect:p[0]})}));return}let f=()=>{for(let w of p)WI.debuggerManager.isBreakpointRemovable(w)&&WI.debuggerManager.removeBreakpoint(w)},_=p.some(w=>!w.disabled),b=w=>{for(let S of p)S.disabled=w};_?d.appendItem(WI.UIString("Disable Breakpoints"),b):d.appendItem(WI.UIString("Enable Breakpoints"),b),d.appendItem(WI.UIString("Delete Breakpoints"),f)}textEditorBreakpointAdded(e,t,i){if(!this._supportsDebugging)return null;var n={lineNumber:t,columnNumber:i},s=this._unformattedLineInfoForEditorLineInfo(n),a=this._sourceCode.createSourceCodeLocation(s.lineNumber,s.columnNumber),d=new WI.Breakpoint(a),p=this._editorLineInfoForSourceCodeLocation(d.sourceCodeLocation);return this._addBreakpointWithEditorLineInfo(d,p),this._ignoreBreakpointAddedBreakpoint=d,WI.debuggerManager.addBreakpoint(d),this._ignoreBreakpointAddedBreakpoint=null,{breakpointInfo:this._breakpointInfoForBreakpoint(d),lineNumber:p.lineNumber,columnNumber:p.columnNumber}}textEditorBreakpointRemoved(e,t,i){if(console.assert(this._supportsDebugging),!!this._supportsDebugging){var n={lineNumber:t,columnNumber:i},s=this._breakpointForEditorLineInfo(n);console.assert(s),s&&(this._removeBreakpointWithEditorLineInfo(s,n),this._ignoreBreakpointRemovedBreakpoint=s,WI.debuggerManager.removeBreakpoint(s),this._ignoreBreakpointRemovedBreakpoint=null)}}textEditorBreakpointMoved(e,t,i,n,s){if(console.assert(this._supportsDebugging),!!this._supportsDebugging){var a={lineNumber:t,columnNumber:i},d=this._breakpointForEditorLineInfo(a);if(console.assert(d),!!d){this._removeBreakpointWithEditorLineInfo(d,a);var p={lineNumber:n,columnNumber:s},f=this._unformattedLineInfoForEditorLineInfo(p);this._ignoreLocationUpdateBreakpoint=d,d.sourceCodeLocation.update(this._sourceCode,f.lineNumber,f.columnNumber),this._ignoreLocationUpdateBreakpoint=null;var _=this._editorLineInfoForSourceCodeLocation(d.sourceCodeLocation);this._addBreakpointWithEditorLineInfo(d,_),(_.lineNumber!==p.lineNumber||_.columnNumber!==p.columnNumber)&&this.updateBreakpointLineAndColumn(p.lineNumber,p.columnNumber,_.lineNumber,_.columnNumber)}}}textEditorBreakpointClicked(e,t,i){if(console.assert(this._supportsDebugging),!!this._supportsDebugging){var n=this._breakpointForEditorLineInfo({lineNumber:t,columnNumber:i});console.assert(n),n&&n.cycleToNextMode()}}textEditorUpdatedFormatting(e){if(this._ignoreAllBreakpointLocationUpdates=!0,this._sourceCode.formatterSourceMap=this.formatterSourceMap,this._ignoreAllBreakpointLocationUpdates=!1,this._sourceCode instanceof WI.Resource&&!(this._sourceCode instanceof WI.SourceMapResource))for(var t=this._sourceCode.scripts,i=0;i<t.length;++i)t[i].formatterSourceMap=this.formatterSourceMap;else this._sourceCode instanceof WI.Script&&this._sourceCode.resource&&(this._sourceCode.resource.formatterSourceMap=this.formatterSourceMap);var n=this._breakpointMap;this._breakpointMap={};for(var s in n)for(var a in n[s]){var d=n[s][a],p=this._editorLineInfoForSourceCodeLocation(d.sourceCodeLocation);this._addBreakpointWithEditorLineInfo(d,p),this.setBreakpointInfoForLineAndColumn(s,a,null),this.setBreakpointInfoForLineAndColumn(p.lineNumber,p.columnNumber,this._breakpointInfoForBreakpoint(d))}this._reinsertAllIssues(),this._reinsertAllThreadIndicators()}textEditorExecutionHighlightRange(e,t){let i=this.currentPositionToOriginalPosition(e),n=this._getAssociatedScript(i);if(!n){t(null);return}let{startLine:s,startColumn:a}=n.range;function d(_){let b=_.lineNumber===s?_.columnNumber-a:_.columnNumber;return new WI.SourceCodePosition(_.lineNumber-s,b)}function p(_){let b=_.lineNumber?_.columnNumber:_.columnNumber+a;return new WI.SourceCodePosition(_.lineNumber+s,b)}let f=(_,b)=>{_=this.originalPositionToCurrentPosition(p(_)),b=this.originalPositionToCurrentPosition(p(b)),t({startPosition:_,endPosition:b})};n.requestScriptSyntaxTree(_=>{if(!_){t(null);return}i=d(i);let b=_.containersOfPosition(i);if(!b.length){t(null);return}for(let E of b){if(E.startPosition.equals(i)&&E.type!==WI.ScriptSyntaxTree.NodeType.Program){f(E.startPosition,E.endPosition);return}if((E.type===WI.ScriptSyntaxTree.NodeType.ForInStatement||E.type===WI.ScriptSyntaxTree.NodeType.ForOfStatement)&&E.left.startPosition.equals(i)){f(E.left.startPosition,E.right.endPosition);return}if(E.startPosition.isAfter(i))break}for(let E of b){if(E.endPosition.equals(i)&&E.type===WI.ScriptSyntaxTree.NodeType.BlockStatement){f(i.offsetColumn(-1),i);return}if(E.startPosition.isAfter(i))break}b.sort((E,k)=>{let R=E.range[1]-E.range[0],M=k.range[1]-k.range[0];return R-M});let w=this.getTextInRange(e,e.offsetColumn(1)),S=w==="."||w==="[";for(let E=0;E<b.length;++E){let k=b[E];if(k.type===WI.ScriptSyntaxTree.NodeType.CallExpression||k.type===WI.ScriptSyntaxTree.NodeType.NewExpression||k.type===WI.ScriptSyntaxTree.NodeType.ThrowStatement){f(k.startPosition,k.endPosition);return}if(k.type===WI.ScriptSyntaxTree.NodeType.ThisExpression||S&&(k.type===WI.ScriptSyntaxTree.NodeType.Identifier||k.type===WI.ScriptSyntaxTree.NodeType.MemberExpression)){let R=null;for(let M=E+1;M<b.length;++M){let L=b[M];if(!(L.type===WI.ScriptSyntaxTree.NodeType.MemberExpression&&(R=L,i.equals(R.endPosition))))break}if(R){f(R.startPosition,R.endPosition);return}f(k.startPosition,k.endPosition);return}}t(null)})}_clearIssueWidgets(){for(var e of this._widgetMap.values())e.clear();this._widgetMap.clear()}_reinsertAllIssues(){this._issuesLineNumberMap.clear(),this._clearIssueWidgets();let e=WI.consoleManager.issuesForSourceCode(this._sourceCode);for(let t of e)this._addIssue(t)}_reinsertAllThreadIndicators(){for(let t of this._threadLineNumberMap.keys())this.removeStyleClassFromLine(t,"thread-indicator");this._threadLineNumberMap.clear();for(let t of this._threadWidgetMap.values())t.clear();this._threadWidgetMap.clear(),this._threadTargetMap.clear();let e=WI.targets;if(e.length>1)for(let t of e)this._addThreadIndicatorForTarget(t)}_debuggerDidPause(e){this._updateTokenTrackingControllerState(),this._typeTokenAnnotator&&this._typeTokenAnnotator.isActive()&&this._typeTokenAnnotator.refresh(),this._basicBlockAnnotator&&this._basicBlockAnnotator.isActive()&&this._basicBlockAnnotator.refresh()}_debuggerDidResume(e){this._updateTokenTrackingControllerState(),this._dismissPopover(),this._typeTokenAnnotator&&this._typeTokenAnnotator.isActive()&&this._typeTokenAnnotator.refresh(),this._basicBlockAnnotator&&this._basicBlockAnnotator.isActive()&&this._basicBlockAnnotator.refresh()}_sourceCodeSourceMapAdded(e){WI.notifications.addEventListener(WI.Notification.GlobalModifierKeysDidChange,this._updateTokenTrackingControllerState,this),this._sourceCode.removeEventListener(WI.SourceCode.Event.SourceMapAdded,this._sourceCodeSourceMapAdded,this),this._updateTokenTrackingControllerState()}_updateTokenTrackingControllerState(){var e=WI.CodeMirrorTokenTrackingController.Mode.None;if(WI.debuggerManager.paused?e=WI.CodeMirrorTokenTrackingController.Mode.JavaScriptExpression:this._typeTokenAnnotator&&this._typeTokenAnnotator.isActive()?e=WI.CodeMirrorTokenTrackingController.Mode.JavaScriptTypeInformation:this._hasColorMarkers()?e=WI.CodeMirrorTokenTrackingController.Mode.MarkedTokens:(this._sourceCode instanceof WI.SourceMapResource||this._sourceCode.sourceMaps.length!==0)&&WI.modifierKeys.metaKey&&!WI.modifierKeys.altKey&&!WI.modifierKeys.shiftKey&&(e=WI.CodeMirrorTokenTrackingController.Mode.NonSymbolTokens),this.tokenTrackingController.enabled=e!==WI.CodeMirrorTokenTrackingController.Mode.None,e!==this.tokenTrackingController.mode){switch(e){case WI.CodeMirrorTokenTrackingController.Mode.MarkedTokens:this.tokenTrackingController.mouseOverDelayDuration=0,this.tokenTrackingController.mouseOutReleaseDelayDuration=0;break;case WI.CodeMirrorTokenTrackingController.Mode.NonSymbolTokens:this.tokenTrackingController.mouseOverDelayDuration=0,this.tokenTrackingController.mouseOutReleaseDelayDuration=0,this.tokenTrackingController.classNameForHighlightedRange=WI.CodeMirrorTokenTrackingController.JumpToSymbolHighlightStyleClassName,this._dismissPopover();break;case WI.CodeMirrorTokenTrackingController.Mode.JavaScriptExpression:case WI.CodeMirrorTokenTrackingController.Mode.JavaScriptTypeInformation:this.tokenTrackingController.mouseOverDelayDuration=WI.SourceCodeTextEditor.DurationToMouseOverTokenToMakeHoveredToken,this.tokenTrackingController.mouseOutReleaseDelayDuration=WI.SourceCodeTextEditor.DurationToMouseOutOfHoveredTokenToRelease,this.tokenTrackingController.classNameForHighlightedRange=WI.SourceCodeTextEditor.HoveredExpressionHighlightStyleClassName;break}this.tokenTrackingController.mode=e}}_hasColorMarkers(){for(var e of this.markers)if(e.type===WI.TextMarker.Type.Color)return!0;return!1}tokenTrackingControllerCanReleaseHighlightedRange(e,t){return this._popover?!(!window.getSelection().isCollapsed&&this._popover.element.contains(window.getSelection().anchorNode)):!0}tokenTrackingControllerHighlightedRangeReleased(e,t=!1){(t||!this._mouseIsOverPopover)&&this._dismissPopover()}tokenTrackingControllerHighlightedRangeWasClicked(e){if(this.tokenTrackingController.mode!==WI.CodeMirrorTokenTrackingController.Mode.NonSymbolTokens||/\blink\b/.test(this.tokenTrackingController.candidate.hoveredToken.type))return;const t={ignoreNetworkTab:!0,ignoreSearchTab:!0};var i=this._sourceCodeLocationForEditorPosition(this.tokenTrackingController.candidate.hoveredTokenRange.start);this.sourceCode instanceof WI.SourceMapResource?WI.showOriginalOrFormattedSourceCodeLocation(i,t):WI.showSourceCodeLocation(i,t)}tokenTrackingControllerNewHighlightCandidate(e,t){if(this.tokenTrackingController.mode===WI.CodeMirrorTokenTrackingController.Mode.NonSymbolTokens){this.tokenTrackingController.highlightRange(t.hoveredTokenRange);return}if(this.tokenTrackingController.mode===WI.CodeMirrorTokenTrackingController.Mode.JavaScriptExpression){this._tokenTrackingControllerHighlightedJavaScriptExpression(t);return}if(this.tokenTrackingController.mode===WI.CodeMirrorTokenTrackingController.Mode.JavaScriptTypeInformation){this._tokenTrackingControllerHighlightedJavaScriptTypeInformation(t);return}if(this.tokenTrackingController.mode===WI.CodeMirrorTokenTrackingController.Mode.MarkedTokens){var i=this.markersAtPosition(t.hoveredTokenRange.start);i.length>0?this._tokenTrackingControllerHighlightedMarkedExpression(t,i):this._dismissEditingController()}}tokenTrackingControllerMouseOutOfHoveredMarker(e,t){this._dismissEditingController()}_tokenTrackingControllerHighlightedJavaScriptExpression(e){console.assert(e.expression);let t=WI.debuggerManager.activeCallFrame?WI.debuggerManager.activeCallFrame.target:this.target,i=appendWebInspectorSourceURL(e.expression);function n(s,a,d){if(s||d||e!==this.tokenTrackingController.candidate)return;let p=WI.RemoteObject.fromPayload(a,t);switch(p.type){case"function":this._showPopoverForFunction(p);break;case"object":p.subtype==="null"||p.subtype==="regexp"?this._showPopoverWithFormattedValue(p):this._showPopoverForObject(p);break;case"string":case"number":case"boolean":case"undefined":case"symbol":this._showPopoverWithFormattedValue(p);break}}if(WI.debuggerManager.activeCallFrame){t.DebuggerAgent.evaluateOnCallFrame.invoke({callFrameId:WI.debuggerManager.activeCallFrame.id,expression:i,objectGroup:"popover",doNotPauseOnExceptionsAndMuteConsole:!0},n.bind(this),t.DebuggerAgent);return}t.RuntimeAgent.evaluate.invoke({expression:i,objectGroup:"popover",doNotPauseOnExceptionsAndMuteConsole:!0},n.bind(this),t.RuntimeAgent)}_tokenTrackingControllerHighlightedJavaScriptTypeInformation(e){console.assert(e.expression);var t=this._sourceCode,i=t instanceof WI.Script?t.id:t.scripts[0].id,n=e.hoveredTokenRange,s=this.currentPositionToOriginalOffset(n.start),a=[{typeInformationDescriptor:WI.ScriptSyntaxTree.TypeProfilerSearchDescriptor.NormalExpression,sourceID:i,divot:s}];function d(p,f){if(!p&&e===this.tokenTrackingController.candidate&&(console.assert(f.length===1),!!f.length)){var _=WI.TypeDescription.fromPayload(f[0]);if(_.valid){var b=WI.TypeTokenView.titleForPopover(WI.TypeTokenView.TitleType.Variable,e.expression);this.showPopoverForTypes(_,null,b)}}}this.target.RuntimeAgent.getRuntimeTypesForVariablesAtOffsets(a,d.bind(this))}_showPopover(e,t){console.assert(this.tokenTrackingController.candidate||t);var i=!1,n=this.tokenTrackingController.candidate;if(!t){if(!n)return;var s=this.rectsForRange(n.hoveredTokenRange);if(t=WI.Rect.unionOfRects(s),this._popover&&this._popover.visible){let a=t.intersectionWithRect(this._popover.frame);if(a.size.width&&a.size.height)return}i=!0}e.classList.add(WI.SourceCodeTextEditor.PopoverDebuggerContentStyleClassName),this._popover=this._popover||new WI.Popover(this),this._popover.presentNewContentWithFrame(e,t.pad(5),[WI.RectEdge.MIN_Y,WI.RectEdge.MAX_Y,WI.RectEdge.MAX_X]),i&&this.tokenTrackingController.highlightRange(n.expressionRange),this._trackPopoverEvents()}_showPopoverForFunction(e){let t=this.tokenTrackingController.candidate;function i(n,s){if(n){console.error(n),this._dismissPopover();return}if(t!==this.tokenTrackingController.candidate)return;let a=document.createElement("div");a.classList.add("function");let d=document.createElement("div");d.classList.add("title"),d.textContent=s.name||s.displayName||WI.UIString("(anonymous function)"),a.appendChild(d);let p=s.location,_=WI.debuggerManager.scriptForIdentifier(p.scriptId,this.target).createSourceCodeLocation(p.lineNumber,p.columnNumber),b=WI.createSourceCodeLocationLink(_);d.appendChild(b);let w=document.createElement("div");w.classList.add("body"),a.appendChild(w);let S=WI.CodeMirrorEditor.create(w,{mode:"text/javascript",readOnly:"nocursor"});const E=!1,k=WI.indentString(),R=!1;WI.FormatterWorkerProxy.singleton().formatJavaScript(e.description,E,k,R,({formattedText:L})=>{t===this.tokenTrackingController.candidate&&(this._showPopover(a),S.setValue(L||e.description),this._popover.update())})}e.target.DebuggerAgent.getFunctionDetails(e.objectId,i.bind(this))}_showPopoverForObject(e){var t=document.createElement("div");t.className="object expandable";var i=document.createElement("div");i.className="title",i.textContent=e.description,t.appendChild(i),e.subtype==="node"&&e.pushNodeToFrontend(function(d){if(!!d){var p=WI.domManager.nodeForId(d);if(!!p.ownerDocument){var f=i.appendChild(WI.createGoToArrowButton());f.addEventListener("click",function(){WI.domManager.inspectElement(d)})}}});var n=new WI.ObjectTreeView(e);n.showOnlyProperties(),n.expand();var s=t.appendChild(document.createElement("div"));s.className="body",s.appendChild(n.element);var a=this.tokenTrackingController.candidate;n.addEventListener(WI.ObjectTreeView.Event.Updated,function(){a===this.tokenTrackingController.candidate&&this._showPopover(t),n.removeEventListener(null,null,this)},this)}_showPopoverWithFormattedValue(e){var t=WI.FormattedValue.createElementForRemoteObject(e);this._showPopover(t)}willDismissPopover(e){this.tokenTrackingController.removeHighlightedRange(),this.target.RuntimeAgent.releaseObjectGroup("popover")}_dismissPopover(){!this._popover||(this._popover.dismiss(),this._popoverEventListeners&&this._popoverEventListenersAreRegistered&&(this._popoverEventListenersAreRegistered=!1,this._popoverEventListeners.unregister()))}_trackPopoverEvents(){this._popoverEventListeners||(this._popoverEventListeners=new WI.EventListenerSet(this,"Popover listeners")),this._popoverEventListenersAreRegistered||(this._popoverEventListenersAreRegistered=!0,this._popoverEventListeners.register(this._popover.element,"mouseover",this._popoverMouseover),this._popoverEventListeners.register(this._popover.element,"mouseout",this._popoverMouseout),this._popoverEventListeners.install())}_popoverMouseover(e){this._mouseIsOverPopover=!0}_popoverMouseout(e){this._mouseIsOverPopover=this._popover.element.contains(e.relatedTarget)}_hasStyleSheetContents(){let e=this.mimeType;return e==="text/css"||e==="text/x-less"||e==="text/x-sass"||e==="text/x-scss"}_updateEditableMarkers(e){this._hasStyleSheetContents()&&(this.createColorMarkers(e),this.createGradientMarkers(e),this.createCubicBezierMarkers(e),this.createSpringMarkers(e)),this._updateTokenTrackingControllerState()}_tokenTrackingControllerHighlightedMarkedExpression(e,t){var i;for(var n of t)!n.range||!Object.values(WI.TextMarker.Type).includes(n.type)||(!i||n.range.startLine<i.range.startLine||n.range.startLine===i.range.startLine&&n.range.startColumn<i.range.startColumn)&&(i=n);if(!i){this.tokenTrackingController.hoveredMarker=null;return}if(this.tokenTrackingController.hoveredMarker!==i){if(this._dismissEditingController(),this.tokenTrackingController.hoveredMarker=i,this._editingController=this.editingControllerForMarker(i),n.type===WI.TextMarker.Type.Color){var s=this._editingController.value;if(!s||!s.valid){i.clear(),this._editingController=null;return}}this._editingController.delegate=this,this._editingController.presentHoverMenu()}}_dismissEditingController(e){this._editingController&&this._editingController.dismissHoverMenu(e),this.tokenTrackingController.hoveredMarker=null,this._editingController=null}editingControllerDidStartEditing(e){this.tokenTrackingController.enabled=!1,e.marker.clear(),this._ignoreContentDidChange++}editingControllerDidFinishEditing(e){this._updateEditableMarkers(e.range),this._ignoreContentDidChange--,this._editingController=null}_setTypeTokenAnnotatorEnabledState(e){!this._typeTokenAnnotator||(e?(console.assert(this.visible,"Annotators should not be enabled if the TextEditor is not visible"),this._typeTokenAnnotator.reset(),this._typeTokenScrollHandler||this._enableScrollEventsForTypeTokenAnnotator()):(this._typeTokenAnnotator.clear(),this._typeTokenScrollHandler&&this._disableScrollEventsForTypeTokenAnnotator()),WI.settings.showJavaScriptTypeInformation.value=e,this._updateTokenTrackingControllerState())}set _basicBlockAnnotatorEnabled(e){!this._basicBlockAnnotator||(e?(console.assert(this.visible,"Annotators should not be enabled if the TextEditor is not visible"),console.assert(!this._basicBlockAnnotator.isActive()),this._basicBlockAnnotator.reset(),this._controlFlowScrollHandler||this._enableScrollEventsForControlFlowAnnotator()):(this._basicBlockAnnotator.clear(),this._controlFlowScrollHandler&&this._disableScrollEventsForControlFlowAnnotator()),WI.settings.enableControlFlowProfiler.value=e)}_getAssociatedScript(e){let t=null;if(this._sourceCode instanceof WI.Script)t=this._sourceCode;else if(this._sourceCode instanceof WI.Resource&&this._sourceCode.scripts.length){if(this._sourceCode.type===WI.Resource.Type.Script)t=this._sourceCode.scripts[0];else if(this._sourceCode.type===WI.Resource.Type.Document&&e){for(let i of this._sourceCode.scripts)if(i.range.contains(e.lineNumber,e.columnNumber)){isNaN(i.range.startOffset)&&i.range.resolveOffsets(this._sourceCode.content),t=i;break}}}return t}_createTypeTokenAnnotator(){if(!!this.target.RuntimeAgent.getRuntimeTypesForVariablesAtOffsets){var e=this._getAssociatedScript();!e||(this._typeTokenAnnotator=new WI.TypeTokenAnnotator(this,e))}}_createBasicBlockAnnotator(){if(!!this.target.RuntimeAgent.getBasicBlocks){var e=this._getAssociatedScript();!e||(this._basicBlockAnnotator=new WI.BasicBlockAnnotator(this,e))}}_enableScrollEventsForTypeTokenAnnotator(){console.assert(!this._typeTokenScrollHandler),this._typeTokenScrollHandler=this._createTypeTokenScrollEventHandler(),this.addScrollHandler(this._typeTokenScrollHandler)}_enableScrollEventsForControlFlowAnnotator(){console.assert(!this._controlFlowScrollHandler),this._controlFlowScrollHandler=this._createControlFlowScrollEventHandler(),this.addScrollHandler(this._controlFlowScrollHandler)}_disableScrollEventsForTypeTokenAnnotator(){console.assert(this._typeTokenScrollHandler),this.removeScrollHandler(this._typeTokenScrollHandler),this._typeTokenScrollHandler=null}_disableScrollEventsForControlFlowAnnotator(){console.assert(this._controlFlowScrollHandler),this.removeScrollHandler(this._controlFlowScrollHandler),this._controlFlowScrollHandler=null}_createTypeTokenScrollEventHandler(){let e=null;return()=>{e?clearTimeout(e):this._typeTokenAnnotator&&this._typeTokenAnnotator.pause(),e=setTimeout(()=>{e=null,this._typeTokenAnnotator&&this._typeTokenAnnotator.resume()},WI.SourceCodeTextEditor.DurationToUpdateTypeTokensAfterScrolling)}}_createControlFlowScrollEventHandler(){let e=null;return()=>{e?clearTimeout(e):this._basicBlockAnnotator&&this._basicBlockAnnotator.pause(),e=setTimeout(()=>{e=null,this._basicBlockAnnotator&&this._basicBlockAnnotator.resume()},WI.SourceCodeTextEditor.DurationToUpdateTypeTokensAfterScrolling)}}_logCleared(e){for(let t of this._issuesLineNumberMap.keys())this.removeStyleClassFromLine(t,WI.SourceCodeTextEditor.LineErrorStyleClassName),this.removeStyleClassFromLine(t,WI.SourceCodeTextEditor.LineWarningStyleClassName);this._issuesLineNumberMap.clear(),this._clearIssueWidgets()}};WI.SourceCodeTextEditor.LineErrorStyleClassName="error";WI.SourceCodeTextEditor.LineWarningStyleClassName="warning";WI.SourceCodeTextEditor.PopoverDebuggerContentStyleClassName="debugger-popover-content";WI.SourceCodeTextEditor.HoveredExpressionHighlightStyleClassName="hovered-expression-highlight";WI.SourceCodeTextEditor.DurationToMouseOverTokenToMakeHoveredToken=500;WI.SourceCodeTextEditor.DurationToMouseOutOfHoveredTokenToRelease=1e3;WI.SourceCodeTextEditor.DurationToUpdateTypeTokensAfterScrolling=100;WI.SourceCodeTextEditor.WidgetContainsMultipleIssuesSymbol=Symbol("source-code-widget-contains-multiple-issues");WI.SourceCodeTextEditor.WidgetContainsMultipleThreadsSymbol=Symbol("source-code-widget-contains-multiple-threads");WI.SourceCodeTextEditor.Event={ContentWillPopulate:"source-code-text-editor-content-will-populate",ContentDidPopulate:"source-code-text-editor-content-did-populate"};WI.SourceCodeTimelineTimelineDataGridNode=class extends WI.TimelineDataGridNode{constructor(e,t={}){const i=[];super(i,{includesGraph:!0,...t}),this._sourceCodeTimeline=e,this._sourceCodeTimeline.addEventListener(WI.Timeline.Event.RecordAdded,this._timelineRecordAdded,this)}get records(){return this._sourceCodeTimeline.records}get sourceCodeTimeline(){return this._sourceCodeTimeline}get data(){return this._cachedData?this._cachedData:(this._cachedData=super.data,this._cachedData.graph=this._sourceCodeTimeline.startTime,this._cachedData)}createCellContent(e,t){return e==="name"&&this.records.length?(t.classList.add(...this.iconClassNames()),this._createNameCellContent(t)):super.createCellContent(e,t)}filterableDataForColumn(e){return e==="name"?this.displayName():super.filterableDataForColumn(e)}_createNameCellContent(e){if(!this.records.length)return null;let t=document.createDocumentFragment(),i=this.displayName();t.append(i);let n=this._sourceCodeTimeline.sourceCodeLocation;if(n){let s=document.createElement("span");s.classList.add("subtitle"),n.populateLiveDisplayLocationString(s,"textContent",null,WI.SourceCodeLocation.NameStyle.None,WI.UIString("line "));const a={useGoToArrowButton:!0,ignoreNetworkTab:!0,ignoreSearchTab:!0};let d=WI.createSourceCodeLocationLink(n,a);t.append(d,s),n.populateLiveDisplayLocationTooltip(e,i+`
`)}else e.title=i;return t}_timelineRecordAdded(e){this.isRecordVisible(e.data.record)&&this.needsGraphRefresh()}};WI.SourcesNavigationSidebarPanel=class xa extends WI.NavigationSidebarPanel{constructor(){super("sources",WI.UIString("Sources"),!0),this._workerTargetTreeElementMap=new Map,this._mainFrameTreeElement=null,this._extensionScriptsFolderTreeElement=null,this._extraScriptsFolderTreeElement=null,this._anonymousScriptsFolderTreeElement=null,this._originTreeElementMap=new Map,this._boundCompareTreeElements=this._compareTreeElements.bind(this),this._debuggerNavigationBar=new WI.NavigationBar,this.addSubview(this._debuggerNavigationBar);let t=({identifier:M,defaultToolTip:L,activatedToolTip:V,image:H})=>{let O=new WI.ActivateButtonNavigationItem(M,L,V,H,15,15);return this._debuggerNavigationBar.addNavigationItem(O),O},i=({identifier:M,defaultToolTip:L,alternateToolTip:V,defaultImage:H,alternateImage:O})=>{let z=new WI.ToggleButtonNavigationItem(M,L,V,H,O,15,15);return this._debuggerNavigationBar.addNavigationItem(z),z},n=({identifier:M,toolTipOrLabel:L,image:V})=>{let H=new WI.ButtonNavigationItem(M,L,V,15,15);return this._debuggerNavigationBar.addNavigationItem(H),H};this._debuggerBreakpointsButtonItem=t({identifier:"debugger-breakpoints",defaultToolTip:WI.UIString("Enable all breakpoints (%s)").format(WI.toggleBreakpointsKeyboardShortcut.displayName),activatedToolTip:WI.UIString("Disable all breakpoints (%s)").format(WI.toggleBreakpointsKeyboardShortcut.displayName),image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3cpath d='M 0.5 3.5 L 0.5 11.5 L 10.5 11.5 L 14.5 7.5 L 10.5 3.5 L 0.5 3.5 Z'/%3e %3c/svg%3e"}),this._debuggerBreakpointsButtonItem.activated=WI.debuggerManager.breakpointsEnabled,this._debuggerBreakpointsButtonItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,WI.debuggerToggleBreakpoints,this),this._debuggerPauseResumeButtonItem=i({identifier:"debugger-pause-resume",defaultToolTip:WI.UIString("Pause script execution (%s or %s)").format(WI.pauseOrResumeKeyboardShortcut.displayName,WI.pauseOrResumeAlternateKeyboardShortcut.displayName),alternateToolTip:WI.UIString("Continue script execution (%s or %s)").format(WI.pauseOrResumeKeyboardShortcut.displayName,WI.pauseOrResumeAlternateKeyboardShortcut.displayName),defaultImage:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3crect fill='none' stroke='currentColor' x='2.5' y='1.5' width='3' height='12'/%3e %3crect fill='none' stroke='currentColor' x='9.5' y='1.5' width='3' height='12'/%3e %3c/svg%3e",alternateImage:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3cpath d='M 6.5 2.5 L 6.5 12.5 L 14.5 7.5 L 6.5 2.5 Z'/%3e %3crect x='0.5' y='2.5' width='3' height='10'/%3e %3c/svg%3e"}),this._debuggerPauseResumeButtonItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,WI.debuggerPauseResumeToggle,this),this._debuggerStepOverButtonItem=n({identifier:"debugger-step-over",toolTipOrLabel:WI.UIString("Step over (%s or %s)").format(WI.stepOverKeyboardShortcut.displayName,WI.stepOverAlternateKeyboardShortcut.displayName),image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3crect fill='none' stroke='currentColor' x='3.5' y='10.5' width='8' height='2'/%3e %3cpath fill='currentColor' d='M 13 5.5 L 14 4.5 L 14 9 L 9.5 9 L 10.5 8 L 12.2953461 8 L 7.50812492 3.19898186 L 1.70710678 9 L 0.292893219 9 L 7.5 1.79289322 L 13 7.29289322 L 13 5.5 Z'/%3e %3c/svg%3e"}),this._debuggerStepOverButtonItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,WI.debuggerStepOver,this),this._debuggerStepOverButtonItem.enabled=!1,this._debuggerStepIntoButtonItem=n({identifier:"debugger-step-into",toolTipOrLabel:WI.UIString("Step into (%s or %s)").format(WI.stepIntoKeyboardShortcut.displayName,WI.stepIntoAlternateKeyboardShortcut.displayName),image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3crect fill='none' stroke='currentColor' x='3.5' y='10.5' width='8' height='2'/%3e %3cpath fill='none' stroke='currentColor' d='M 7.5 8.5 L 7.5 1'/%3e %3cpath fill='none' stroke='currentColor' d='M 10.5 5.5 L 7.5 8.5 L 4.5 5.5'/%3e %3c/svg%3e"}),this._debuggerStepIntoButtonItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,WI.debuggerStepInto,this),this._debuggerStepIntoButtonItem.enabled=!1,this._debuggerStepOutButtonItem=n({identifier:"debugger-step-out",toolTipOrLabel:WI.UIString("Step out (%s or %s)").format(WI.stepOutKeyboardShortcut.displayName,WI.stepOutAlternateKeyboardShortcut.displayName),image:"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3crect fill='none' stroke='currentColor' x='3.5' y='10.5' width='8' height='2'/%3e %3cpath fill='none' stroke='currentColor' d='M 7.5 9 L 7.5 2'/%3e %3cpath fill='none' stroke='currentColor' d='M 10.5 4.5 L 7.5 1.5 L 4.5 4.5'/%3e %3c/svg%3e"}),this._debuggerStepOutButtonItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,WI.debuggerStepOut,this),this._debuggerStepOutButtonItem.enabled=!1,this._timelineRecordingWarningElement=null,this._auditTestWarningElement=null,this._breakpointsDisabledWarningElement=null,this._pauseReasonTreeOutline=null,this._pauseReasonLinkContainerElement=document.createElement("span"),this._pauseReasonTextRow=new WI.DetailsSectionTextRow,this._pauseReasonGroup=new WI.DetailsSectionGroup([this._pauseReasonTextRow]),this._pauseReasonSection=new WI.DetailsSection("paused-reason",WI.UIString("Pause Reason"),[this._pauseReasonGroup],this._pauseReasonLinkContainerElement),this._callStackTreeOutline=this.createContentTreeOutline({suppressFiltering:!0}),this._callStackTreeOutline.addEventListener(WI.TreeOutline.Event.ElementAdded,this._handleCallStackElementAddedOrRemoved,this),this._callStackTreeOutline.addEventListener(WI.TreeOutline.Event.ElementRemoved,this._handleCallStackElementAddedOrRemoved,this),this._callStackTreeOutline.addEventListener(WI.TreeOutline.Event.SelectionDidChange,this._handleTreeSelectionDidChange,this);let s=new WI.DetailsSectionRow;s.element.appendChild(this._callStackTreeOutline.element);let a=new WI.DetailsSectionGroup([s]);this._callStackSection=new WI.DetailsSection("call-stack",WI.UIString("Call Stack"),[a]),this._mainTargetTreeElement=null,this._activeCallFrameTreeElement=null,this._breakpointsTreeOutline=this.createContentTreeOutline({ignoreCookieRestoration:!0}),this._breakpointsTreeOutline.addEventListener(WI.TreeOutline.Event.ElementAdded,this._handleBreakpointElementAddedOrRemoved,this),this._breakpointsTreeOutline.addEventListener(WI.TreeOutline.Event.ElementRemoved,this._handleBreakpointElementAddedOrRemoved,this),this._breakpointsTreeOutline.addEventListener(WI.TreeOutline.Event.SelectionDidChange,this._handleTreeSelectionDidChange,this),this._breakpointsTreeOutline.ondelete=M=>{if(console.assert(M.selected),M.representedObject===xa.__windowEventTargetRepresentedObject){let O=WI.domManager.eventListenerBreakpoints.filter(z=>z.eventListener.onWindow);for(let z of O)WI.domManager.removeBreakpointForEventListener(z.eventListener);return!0}if(console.assert(M instanceof WI.ResourceTreeElement||M instanceof WI.ScriptTreeElement),!(M instanceof WI.ResourceTreeElement)&&!(M instanceof WI.ScriptTreeElement))return!1;let L=M.previousSibling===this._assertionsBreakpointTreeElement||M.previousSibling===this._allUncaughtExceptionsBreakpointTreeElement,V=M.nextSibling,H=this._breakpointsBeneathTreeElement(M);return this._removeAllBreakpoints(H),L&&V&&V.select(!0,!0),!0},this._breakpointsTreeOutline.populateContextMenu=(M,L,V)=>{if(V instanceof WI.ResourceTreeElement||V instanceof WI.ScriptTreeElement){let H=this._breakpointsBeneathTreeElement(V),O=H.some(z=>!z.disabled);M.appendItem(O?WI.UIString("Disable Breakpoints"):WI.UIString("Enable Breakpoints"),()=>{this._toggleAllBreakpoints(H,O)}),M.appendItem(WI.UIString("Delete Breakpoints"),()=>{this._removeAllBreakpoints(H)})}WI.TreeOutline.prototype.populateContextMenu(M,L,V)};let d=new WI.DetailsSectionRow;d.element.appendChild(this._breakpointsTreeOutline.element);let p=document.createElement("div"),f=new WI.NavigationBar;p.appendChild(f.element),this._createBreakpointButton=new WI.ButtonNavigationItem("create-breakpoint",WI.UIString("Create Breakpoint"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 13'%3e %3cpath fill='none' stroke='currentColor' d='M 6.5 1 V 12 M 1 6.5 H 12'/%3e %3c/svg%3e",13,13),this._createBreakpointButton.element.addEventListener("mousedown",this._handleCreateBreakpointMouseDown.bind(this)),f.addNavigationItem(this._createBreakpointButton);let _=new WI.DetailsSectionGroup([d]);this._breakpointsSection=new WI.DetailsSection("breakpoints",WI.UIString("Breakpoints"),[_],p),this.contentView.element.insertBefore(this._breakpointsSection.element,this.contentView.element.firstChild),this._resourcesNavigationBar=new WI.NavigationBar,this.contentView.addSubview(this._resourcesNavigationBar),this.contentView.element.insertBefore(this._resourcesNavigationBar.element,this._breakpointsSection.element.nextSibling),this._resourcesNavigationBar.addNavigationItem(new WI.FlexibleSpaceNavigationItem);const b="sources-resource-type-";let w=[];w.push(new WI.ScopeBarItem(b+"all",WI.UIString("All Resources"),{exclusive:!0}));for(let M of Object.values(WI.Resource.Type)){let L=new WI.ScopeBarItem(b+M,WI.Resource.displayNameForType(M,!0));L[WI.SourcesNavigationSidebarPanel.ResourceTypeSymbol]=M,w.push(L)}const S=!0;this._resourceTypeScopeBar=new WI.ScopeBar("sources-resource-type-scope-bar",w,w[0],S),this._resourceTypeScopeBar.addEventListener(WI.ScopeBar.Event.SelectionChanged,this._handleResourceTypeScopeBarSelectionChanged,this),this._resourcesNavigationBar.addNavigationItem(this._resourceTypeScopeBar),this._resourcesNavigationBar.addNavigationItem(new WI.FlexibleSpaceNavigationItem);let E=new WI.ButtonNavigationItem("grouping-mode",WI.UIString("Grouping Mode"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' d='M 7.5009 14 C 8.3259 14 9.0009 13.325 9.0019 12.5 L 9.0009 11.725 C 9.1479 11.673 9.2909 11.616 9.4299 11.551 L 10.1759 12.298 C 10.7599 12.881 11.7149 12.88 12.2969 12.297 C 12.5899 12.005 12.7349 11.619 12.7349 11.235 C 12.7349 10.852 12.5899 10.467 12.2979 10.175 L 11.5519 9.429 C 11.6179 9.289 11.6739 9.146 11.7259 9 L 12.5009 8.999 C 13.3259 9 14.0009 8.325 14.0009 7.5 C 14.0009 6.674 13.3259 6 12.5009 5.999 L 11.7259 6 C 11.6739 5.853 11.6179 5.71 11.5519 5.571 L 12.2979 4.825 C 12.5889 4.533 12.7349 4.148 12.7349 3.764 C 12.7349 3.379 12.5899 2.995 12.2989 2.704 C 11.7149 2.119 10.7599 2.119 10.1769 2.702 L 9.4299 3.449 C 9.2899 3.382 9.1479 3.327 9.0009 3.275 L 9.0009 2.499 C 9.0009 1.674 8.3259 0.999 7.5009 0.999 C 6.6759 0.999 6.0009 1.674 6.0009 2.499 L 6.0009 3.275 C 5.8549 3.327 5.7109 3.383 5.5709 3.449 L 4.8249 2.703 C 4.2419 2.12 3.2869 2.12 2.7039 2.703 C 2.4119 2.995 2.2659 3.379 2.2659 3.763 C 2.2659 4.148 2.4119 4.532 2.7029 4.824 L 3.4499 5.571 C 3.3839 5.71 3.3289 5.853 3.2759 6 L 2.5009 5.999 C 1.6759 6 1.0009 6.674 1.0009 7.5 C 1.0009 8.325 1.6759 9 2.5009 9 L 3.2759 9 C 3.3279 9.146 3.3839 9.289 3.4499 9.429 L 2.7039 10.175 C 2.4119 10.467 2.2649 10.852 2.2659 11.236 C 2.2649 11.621 2.4129 12.006 2.7029 12.296 C 3.2869 12.88 4.2419 12.88 4.8249 12.297 L 5.5719 11.551 C 5.7109 11.616 5.8539 11.673 6.0009 11.725 L 5.9999 12.5 C 6.0009 13.325 6.6759 14 7.5009 14 Z'/%3e %3cpath fill='none' stroke='currentColor' d='M 7.5 5.6 C 8.548 5.6 9.4 6.452 9.4 7.5 C 9.4 8.548 8.548 9.4 7.5 9.4 C 6.452 9.4 5.6 8.548 5.6 7.5 C 5.6 6.452 6.452 5.6 7.5 5.6'/%3e %3c/svg%3e",15,15);E.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,E.element.addEventListener("mousedown",this._handleResourceGroupingModeMouseDown.bind(this)),this._resourcesNavigationBar.addNavigationItem(E),this._resourcesTreeOutline=this.contentTreeOutline,this._resourcesTreeOutline.element.classList.add("resources"),this._resourcesTreeOutline.addEventListener(WI.TreeOutline.Event.SelectionDidChange,this._handleTreeSelectionDidChange,this),this._resourcesTreeOutline.includeSourceMapResourceChildren=!0,this.contentView.element.insertBefore(this._resourcesTreeOutline.element,this._resourcesNavigationBar.element.nextSibling);let k=M=>{if(M.treeOutline!==this._resourcesTreeOutline||M instanceof WI.IssueTreeElement)return!0;if(M.hasChildren){for(let L of M.children)if(L instanceof WI.IssueTreeElement)return!0}return!1};const R=!1;this.filterBar.addFilterBarButton("sources-only-show-resources-with-issues",k,R,WI.UIString("Only show resources with issues"),WI.UIString("Show all resources"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='none' stroke='currentColor' d='M 11 2.5 L 14.5 6 L 14.5 11 L 11 14.5 L 6 14.5 L 2.5 11 L 2.5 6 L 6 2.5 L 11 2.5 Z '/%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='square' d='M 8.5 5.5 L 8.5 9.5'/%3e %3crect fill='currentColor' x='8' y='11' width='1' height='1'/%3e %3c/svg%3e",15,15),WI.settings.resourceGroupingMode.addEventListener(WI.Setting.Event.Changed,this._handleResourceGroupingModeChanged,this),WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._handleFrameMainResourceDidChange,this),WI.Frame.addEventListener(WI.Frame.Event.ResourceWasAdded,this._handleResourceAdded,this),WI.Target.addEventListener(WI.Target.Event.ResourceAdded,this._handleResourceAdded,this),WI.networkManager.addEventListener(WI.NetworkManager.Event.MainFrameDidChange,this._handleMainFrameDidChange,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.BreakpointAdded,this._handleDebuggerBreakpointAdded,this),WI.domDebuggerManager.addEventListener(WI.DOMDebuggerManager.Event.DOMBreakpointAdded,this._handleDebuggerBreakpointAdded,this),WI.domDebuggerManager.addEventListener(WI.DOMDebuggerManager.Event.EventBreakpointAdded,this._handleDebuggerBreakpointAdded,this),WI.domDebuggerManager.addEventListener(WI.DOMDebuggerManager.Event.URLBreakpointAdded,this._handleDebuggerBreakpointAdded,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.BreakpointRemoved,this._handleDebuggerBreakpointRemoved,this),WI.domDebuggerManager.addEventListener(WI.DOMDebuggerManager.Event.DOMBreakpointRemoved,this._handleDebuggerBreakpointRemoved,this),WI.domDebuggerManager.addEventListener(WI.DOMDebuggerManager.Event.EventBreakpointRemoved,this._handleDebuggerBreakpointRemoved,this),WI.domDebuggerManager.addEventListener(WI.DOMDebuggerManager.Event.URLBreakpointRemoved,this._handleDebuggerBreakpointRemoved,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.BreakpointsEnabledDidChange,this._handleDebuggerBreakpointsEnabledDidChange,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.ScriptAdded,this._handleDebuggerScriptAdded,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.ScriptRemoved,this._handleDebuggerScriptRemoved,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.ScriptsCleared,this._handleDebuggerScriptsCleared,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.Paused,this._handleDebuggerPaused,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.Resumed,this._handleDebuggerResumed,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.CallFramesDidChange,this._handleDebuggerCallFramesDidChange,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.ActiveCallFrameDidChange,this._handleDebuggerActiveCallFrameDidChange,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.WaitingToPause,this._handleDebuggerWaitingToPause,this),WI.Breakpoint.addEventListener(WI.Breakpoint.Event.DisplayLocationDidChange,this._handleDebuggerObjectDisplayLocationDidChange,this),WI.IssueMessage.addEventListener(WI.IssueMessage.Event.DisplayLocationDidChange,this._handleDebuggerObjectDisplayLocationDidChange,this),WI.DOMBreakpoint.addEventListener(WI.DOMBreakpoint.Event.DOMNodeChanged,this._handleDOMBreakpointDOMNodeChanged,this),WI.consoleManager.addEventListener(WI.ConsoleManager.Event.IssueAdded,this._handleConsoleIssueAdded,this),WI.consoleManager.addEventListener(WI.ConsoleManager.Event.Cleared,this._handleConsoleCleared,this),WI.timelineManager.addEventListener(WI.TimelineManager.Event.CapturingStateChanged,this._handleTimelineCapturingStateChanged,this),WI.auditManager.addEventListener(WI.AuditManager.Event.TestScheduled,this._handleAuditManagerTestScheduled,this),WI.auditManager.addEventListener(WI.AuditManager.Event.TestCompleted,this._handleAuditManagerTestCompleted,this),WI.cssManager.addEventListener(WI.CSSManager.Event.StyleSheetAdded,this._handleCSSStyleSheetAdded,this),WI.targetManager.addEventListener(WI.TargetManager.Event.TargetAdded,this._handleTargetAdded,this),WI.targetManager.addEventListener(WI.TargetManager.Event.TargetRemoved,this._handleTargetRemoved,this),WI.notifications.addEventListener(WI.Notification.ExtraDomainsActivated,this._handleExtraDomainsActivated,this),WI.SourcesNavigationSidebarPanel.shouldPlaceResourcesAtTopLevel()&&(this._resourcesTreeOutline.disclosureButtons=!1,WI.SourceCode.addEventListener(WI.SourceCode.Event.SourceMapAdded,()=>{this._resourcesTreeOutline.disclosureButtons=!0},this)),WI.debuggerManager.addBreakpoint(WI.debuggerManager.allExceptionsBreakpoint),WI.debuggerManager.addBreakpoint(WI.debuggerManager.uncaughtExceptionsBreakpoint),InspectorBackend.domains.Debugger.setPauseOnAssertions&&WI.settings.showAssertionFailuresBreakpoint.value&&WI.debuggerManager.addBreakpoint(WI.debuggerManager.assertionFailuresBreakpoint);for(let M of WI.targets)this._addTarget(M);if(this._updateCallStackTreeOutline(),this._handleResourceGroupingModeChanged(),WI.domDebuggerManager.supported){WI.settings.showAllRequestsBreakpoint.value&&WI.domDebuggerManager.addURLBreakpoint(WI.domDebuggerManager.allRequestsBreakpoint);for(let M of WI.domDebuggerManager.eventBreakpoints)this._addBreakpoint(M);for(let M of WI.domDebuggerManager.domBreakpoints)this._addBreakpoint(M);for(let M of WI.domManager.eventListenerBreakpoints)this._addBreakpoint(M);for(let M of WI.domDebuggerManager.urlBreakpoints)this._addBreakpoint(M)}WI.debuggerManager.paused&&this._handleDebuggerPaused(),WI.debuggerManager.breakpointsDisabledTemporarily&&(this._handleTimelineCapturingStateChanged(),(WI.auditManager.runningState===WI.AuditManager.RunningState.Active||WI.auditManager.runningState===WI.AuditManager.RunningState.Stopping)&&this._handleAuditManagerTestScheduled()),this._updateBreakpointsDisabledBanner()}static shouldPlaceResourcesAtTopLevel(){return WI.sharedApp.debuggableType===WI.DebuggableType.JavaScript&&!WI.sharedApp.hasExtraDomains||WI.sharedApp.debuggableType===WI.DebuggableType.ServiceWorker}get minimumWidth(){return Math.max(this._debuggerNavigationBar.minimumWidth,this._resourcesNavigationBar.minimumWidth)}closed(){WI.settings.resourceGroupingMode.removeEventListener(null,null,this),WI.Frame.removeEventListener(null,null,this),WI.Target.removeEventListener(null,null,this),WI.networkManager.removeEventListener(null,null,this),WI.debuggerManager.removeEventListener(null,null,this),WI.domDebuggerManager.removeEventListener(null,null,this),WI.Breakpoint.removeEventListener(null,null,this),WI.IssueMessage.removeEventListener(null,null,this),WI.DOMBreakpoint.removeEventListener(null,null,this),WI.consoleManager.removeEventListener(null,null,this),WI.timelineManager.removeEventListener(null,null,this),WI.auditManager.removeEventListener(null,null,this),WI.cssManager.removeEventListener(null,null,this),WI.targetManager.removeEventListener(null,null,this),WI.notifications.removeEventListener(null,null,this),WI.SourceCode.removeEventListener(null,null,this),super.closed()}showDefaultContentView(){if(WI.networkManager.mainFrame){this.contentBrowser.showContentViewForRepresentedObject(WI.networkManager.mainFrame);return}let e=this._resourcesTreeOutline.children[0];e&&this.showDefaultContentViewForTreeElement(e)}treeElementForRepresentedObject(e){if(!this._mainFrameTreeElement&&(e instanceof WI.Resource||e instanceof WI.Frame||e instanceof WI.Collection))return null;e instanceof WI.Resource&&e.parentFrame&&e.parentFrame.mainResource===e&&(e=e.parentFrame);function t(d,p){if(p instanceof WI.SourceMapResource){if(p.sourceMap.originalSourceCode===d)return!0;p=p.sourceMap.originalSourceCode}let f=p.parentFrame;for(;f;){if(f===d)return!0;f=f.parentFrame}return!1}function i(d){return d instanceof WI.SourceMapResource?d.sourceMap.originalSourceCode:d.parentFrame}function n(d,p){return!d||!d.selectedTreeElement&&!p?null:d.findTreeElement(e,t,i)}let s=n(this._pauseReasonTreeOutline)||n(this._callStackTreeOutline)||n(this._breakpointsTreeOutline)||n(this._resourcesTreeOutline,!0);if(s)return s;if(!(e instanceof WI.Script))return console.error("Didn't find a TreeElement for representedObject",e),null;if(e.url)return console.error("Didn't find a ScriptTreeElement for a Script with a URL."),null;if(this._anonymousScriptsFolderTreeElement||(this._anonymousScriptsFolderTreeElement=new WI.FolderTreeElement(WI.UIString("Anonymous Scripts"),new WI.ScriptCollection)),!this._anonymousScriptsFolderTreeElement.parent){let d=insertionIndexForObjectInListSortedByFunction(this._anonymousScriptsFolderTreeElement,this._resourcesTreeOutline.children,this._boundCompareTreeElements);this._resourcesTreeOutline.insertChild(this._anonymousScriptsFolderTreeElement,d)}this._anonymousScriptsFolderTreeElement.representedObject.add(e);let a=new WI.ScriptTreeElement(e);return this._anonymousScriptsFolderTreeElement.appendChild(a),a}createContentTreeOutline(e={}){let t=super.createContentTreeOutline(e);return t.addEventListener(WI.TreeOutline.Event.ElementRevealed,i=>{let n=i.data.element,a=[this._pauseReasonSection,this._callStackSection,this._breakpointsSection].find(p=>p.element.contains(n.listItemElement));if(!a)return;let d=a.headerElement.totalOffsetBottom-n.listItemElement.totalOffsetTop;d>0&&this.scrollElement.scrollBy(0,-d)}),t}resetFilter(){this._resourceTypeScopeBar.resetToDefault(),super.resetFilter()}hasCustomFilters(){console.assert(this._resourceTypeScopeBar.selectedItems.length===1);let e=this._resourceTypeScopeBar.selectedItems[0];return e&&!e.exclusive}matchTreeElementAgainstCustomFilters(e,t){if(e.treeOutline!==this._resourcesTreeOutline)return!0;console.assert(this._resourceTypeScopeBar.selectedItems.length===1);let i=this._resourceTypeScopeBar.selectedItems[0];if(!i||i.exclusive)return!0;if(e instanceof WI.FolderTreeElement)return!1;e instanceof WI.IssueTreeElement&&(e=e.parent);function n(){return e instanceof WI.FrameTreeElement?i[WI.SourcesNavigationSidebarPanel.ResourceTypeSymbol]===WI.Resource.Type.Document:e instanceof WI.ScriptTreeElement?i[WI.SourcesNavigationSidebarPanel.ResourceTypeSymbol]===WI.Resource.Type.Script:e instanceof WI.CSSStyleSheetTreeElement?i[WI.SourcesNavigationSidebarPanel.ResourceTypeSymbol]===WI.Resource.Type.Stylesheet:(console.assert(e instanceof WI.ResourceTreeElement,"Unknown treeElement",e),e instanceof WI.ResourceTreeElement?e.resource.type===i[WI.SourcesNavigationSidebarPanel.ResourceTypeSymbol]:!1)}let s=n();return s&&(t.expandTreeElement=!0),s}willDismissPopover(e){let t=e.breakpoint;!t||(t instanceof WI.EventBreakpoint?WI.domDebuggerManager.addEventBreakpoint(t):t instanceof WI.URLBreakpoint&&WI.domDebuggerManager.addURLBreakpoint(t))}_compareTreeElements(e,t){const i=[a=>a instanceof WI.CSSStyleSheetTreeElement&&a.representedObject.isInspectorStyleSheet(),a=>a===this._mainFrameTreeElement,a=>a instanceof WI.FrameTreeElement,a=>a instanceof WI.FolderTreeElement&&a!==this._extensionScriptsFolderTreeElement&&a!==this._extraScriptsFolderTreeElement&&a!==this._anonymousScriptsFolderTreeElement,a=>a===this._extensionScriptsFolderTreeElement,a=>a===this._extraScriptsFolderTreeElement,a=>a===this._anonymousScriptsFolderTreeElement];let n=i.findIndex(a=>a(e)),s=i.findIndex(a=>a(t));return n>=0&&s<0||n<s?-1:s>=0&&n<0||s<n?1:e.mainTitle.extendedLocaleCompare(t.mainTitle)||e.subtitle.extendedLocaleCompare(t.subtitle)}_updateMainFrameTreeElement(e){this.didInitialLayout&&this.contentBrowser.contentViewContainer.closeAllContentViews();let t=this._mainFrameTreeElement;if(this._mainFrameTreeElement&&(this._resourcesTreeOutline.removeChild(this._mainFrameTreeElement),this._mainFrameTreeElement=null),!e)return;switch(WI.settings.resourceGroupingMode.value){case WI.Resource.GroupingMode.Path:for(let n of this._originTreeElementMap.values())n!==t&&this._resourcesTreeOutline.removeChild(n);this._originTreeElementMap.clear(),this._mainFrameTreeElement=new WI.FolderTreeElement(e.securityOrigin,e),this._originTreeElementMap.set(e.securityOrigin,this._mainFrameTreeElement);break;default:WI.reportInternalError("Unknown resource grouping mode",{"Resource Grouping Mode":WI.settings.resourceGroupingMode.value});case WI.Resource.GroupingMode.Type:this._mainFrameTreeElement=new WI.FrameTreeElement(e);break}this._resourcesTreeOutline.insertChild(this._mainFrameTreeElement,0),setTimeout(()=>{if(this._resourcesTreeOutline.selectedTreeElement)return;let n=this.contentBrowser.currentContentView,s=n?this.treeElementForRepresentedObject(n.representedObject):null;s||(s=this.treeElementForRepresentedObject(WI.networkManager.mainFrame)),this.showDefaultContentViewForTreeElement(s)})}_addTarget(e){let t=new WI.ThreadTreeElement(e);this._callStackTreeOutline.appendChild(t),e===WI.mainTarget&&(this._mainTargetTreeElement=t),this._updateCallStackTreeOutline()}_findCallStackTargetTreeElement(e){for(let t of this._callStackTreeOutline.children)if(t.target===e)return t;return null}_updateCallStackTreeOutline(){let e=WI.targets.length<=1;this._callStackTreeOutline.element.classList.toggle("single-thread",e),this._mainTargetTreeElement&&(this._mainTargetTreeElement.selectable=!e)}_addResource(e){if(WI.settings.resourceGroupingMode.value===WI.Resource.GroupingMode.Path){if(!this._mainFrameTreeElement||this._resourcesTreeOutline.findTreeElement(e))return;let t=null;e.urlComponents.scheme&&e.urlComponents.host?(t=e.urlComponents.scheme+"://"+e.urlComponents.host,e.urlComponents.port&&(t+=":"+e.urlComponents.port)):e.parentFrame&&(t=e.parentFrame.securityOrigin);let i=null;if(t){let a=this._originTreeElementMap.get(t);if(!a){a=new WI.FolderTreeElement(t,t===e.parentFrame.securityOrigin?e.parentFrame:null),this._originTreeElementMap.set(t,a);let p=insertionIndexForObjectInListSortedByFunction(a,this._resourcesTreeOutline.children,this._boundCompareTreeElements);this._resourcesTreeOutline.insertChild(a,p)}let d=e.urlComponents.path;d&&d[0]==="/"&&(d=d.substring(1)),i=a.createFoldersAsNeededForSubpath(d)}else i=this._resourcesTreeOutline;let n=null;e instanceof WI.CSSStyleSheet?n=new WI.CSSStyleSheetTreeElement(e):n=new WI.ResourceTreeElement(e,e,{allowDirectoryAsName:!0,hideOrigin:!0});let s=insertionIndexForObjectInListSortedByFunction(n,i.children,this._boundCompareTreeElements);i.insertChild(n,s)}(e.type===WI.Resource.Type.Document||e.type===WI.Resource.Type.Script)&&(this._addBreakpointsForSourceCode(e),this._addIssuesForSourceCode(e))}_addResourcesRecursivelyForFrame(e){this._addResource(e.mainResource);for(let t of e.resourceCollection)this._addResource(t);for(let t of e.childFrameCollection)this._addResourcesRecursivelyForFrame(t);if(WI.settings.resourceGroupingMode.value===WI.Resource.GroupingMode.Path)for(let t of WI.cssManager.inspectorStyleSheetsForFrame(e))this._addResource(t)}_addScript(e){if(!e.url&&!e.sourceURL)return;if(WI.sharedApp.debuggableType!==WI.DebuggableType.JavaScript&&e.target!==WI.pageTarget){e.isMainResource()&&(this._addWorkerTargetWithMainResource(e.target),this._addBreakpointsForSourceCode(e),this._addIssuesForSourceCode(e)),this._resourcesTreeOutline.disclosureButtons=!0;return}if(e.resource||e.dynamicallyAddedScriptElement)return;let t=new WI.ScriptTreeElement(e);if(!e.injected&&WI.SourcesNavigationSidebarPanel.shouldPlaceResourcesAtTopLevel()){let i=insertionIndexForObjectInListSortedByFunction(t,this._resourcesTreeOutline.children,this._boundCompareTreeElements);this._resourcesTreeOutline.insertChild(t,i)}else{let i=null;if(e.injected){if(!this._extensionScriptsFolderTreeElement){let n=new WI.ScriptCollection;this._extensionScriptsFolderTreeElement=new WI.FolderTreeElement(WI.UIString("Extension Scripts"),n)}i=this._extensionScriptsFolderTreeElement}else{if(!this._extraScriptsFolderTreeElement){let n=new WI.ScriptCollection;this._extraScriptsFolderTreeElement=new WI.FolderTreeElement(WI.UIString("Extra Scripts"),n)}i=this._extraScriptsFolderTreeElement}if(i&&i.representedObject.add(e),!i.parent){let n=insertionIndexForObjectInListSortedByFunction(i,this._resourcesTreeOutline.children,this._boundCompareTreeElements);this._resourcesTreeOutline.insertChild(i,n)}i.appendChild(t)}this._addBreakpointsForSourceCode(e),this._addIssuesForSourceCode(e)}_addWorkerTargetWithMainResource(e){console.assert(e.type===WI.Target.Type.Worker||e.type===WI.Target.Type.ServiceWorker);let t=new WI.WorkerTreeElement(e);this._workerTargetTreeElementMap.set(e,t);let i=insertionIndexForObjectInListSortedByFunction(t,this._resourcesTreeOutline.children,this._boundCompareTreeElements);this._resourcesTreeOutline.insertChild(t,i)}_addDebuggerTreeElementForSourceCode(e){let t=this._breakpointsTreeOutline.findTreeElement(e);return t||(e instanceof WI.SourceMapResource?t=new WI.SourceMapResourceTreeElement(e):e instanceof WI.Resource?t=new WI.ResourceTreeElement(e):e instanceof WI.Script&&(t=new WI.ScriptTreeElement(e))),t?(t.parent||(t.hasChildren=!1,t.expand(),this._insertDebuggerTreeElement(t,this._breakpointsTreeOutline)),t):(console.error("Unknown sourceCode instance",e),null)}_insertDebuggerTreeElement(e,t){let i=(n,s)=>{const a=[f=>f.representedObject===WI.debuggerManager.allExceptionsBreakpoint,f=>f.representedObject===WI.debuggerManager.uncaughtExceptionsBreakpoint,f=>f.representedObject===WI.debuggerManager.assertionFailuresBreakpoint,f=>f instanceof WI.BreakpointTreeElement||f instanceof WI.ResourceTreeElement||f instanceof WI.ScriptTreeElement,f=>f instanceof WI.EventBreakpointTreeElement,f=>f instanceof WI.DOMNodeTreeElement,f=>f.representedObject===xa.__windowEventTargetRepresentedObject,f=>f instanceof WI.DOMBreakpointTreeElement,f=>f.representedObject===WI.domDebuggerManager.allRequestsBreakpoint,f=>f instanceof WI.URLBreakpointTreeElement];let d=a.findIndex(f=>f(n)),p=a.findIndex(f=>f(s));if(d>=0&&p>=0){if(d<p)return-1;if(p<d)return 1}return n instanceof WI.BreakpointTreeElement&&s instanceof WI.BreakpointTreeElement?this._compareBreakpointTreeElements(n,s):n.mainTitle.extendedLocaleCompare(s.mainTitle)||n.subtitle.extendedLocaleCompare(s.subtitle)};t.insertChild(e,insertionIndexForObjectInListSortedByFunction(e,t.children,i))}_compareBreakpointTreeElements(e,t){if(!e.representedObject||!t.representedObject)return 0;let i=e.representedObject.sourceCodeLocation,n=t.representedObject.sourceCodeLocation;return!i||!n?0:i.displayLineNumber-n.displayLineNumber||i.displayColumnNumber-n.displayColumnNumber}_addBreakpoint(e){if(this._breakpointsTreeOutline.findTreeElement(e))return null;let t=WI.BreakpointTreeElement,i={},n=this._breakpointsTreeOutline,s=d=>{if(console.assert(d,"Missing DOMNode for identifier",e.domNodeIdentifier),!d)return null;let p=this._breakpointsTreeOutline.findTreeElement(d);return p||(p=new WI.DOMNodeTreeElement(d),this._insertDebuggerTreeElement(p,this._breakpointsTreeOutline)),p};if(e===WI.debuggerManager.allExceptionsBreakpoint)i.className="breakpoint-exception-icon",i.title=WI.repeatedUIString.allExceptions();else if(e===WI.debuggerManager.uncaughtExceptionsBreakpoint)i.className="breakpoint-exception-icon",i.title=WI.repeatedUIString.uncaughtExceptions();else if(e===WI.debuggerManager.assertionFailuresBreakpoint)i.className="breakpoint-assertion-icon",i.title=WI.repeatedUIString.assertionFailures();else if(e instanceof WI.DOMBreakpoint){if(!e.domNodeIdentifier)return null;t=WI.DOMBreakpointTreeElement;let d=WI.domManager.nodeForId(e.domNodeIdentifier);n=s(d)}else if(e instanceof WI.EventBreakpoint){if(t=WI.EventBreakpointTreeElement,e.eventListener){let d=null;e.eventListener.onWindow?(xa.__windowEventTargetRepresentedObject||(xa.__windowEventTargetRepresentedObject={__window:!0}),d=this._breakpointsTreeOutline.findTreeElement(xa.__windowEventTargetRepresentedObject),d||(d=new WI.GeneralTreeElement(["event-target-window"],WI.unlocalizedString("window"),null,xa.__windowEventTargetRepresentedObject),this._insertDebuggerTreeElement(d,this._breakpointsTreeOutline))):e.eventListener.node&&(d=s(e.eventListener.node)),d&&(n=d)}}else if(e instanceof WI.URLBreakpoint)t=WI.URLBreakpointTreeElement,e===WI.domDebuggerManager.allRequestsBreakpoint&&(i.title=WI.repeatedUIString.allRequests());else{let d=e.sourceCodeLocation&&e.sourceCodeLocation.displaySourceCode;if(!d)return null;n=this._addDebuggerTreeElementForSourceCode(d),e.disabled&&(e.resolved=!0)}let a=new t(e,i);return this._insertDebuggerTreeElement(a,n),n.children.length===1&&n.expand(),a}_removeBreakpoint(e){if(this._pauseReasonTreeOutline){let i=this._pauseReasonTreeOutline.findTreeElement(e);i&&(i.status=null)}let t=this._breakpointsTreeOutline.findTreeElement(e);!t||this._removeDebuggerTreeElement(t)}_removeAllBreakpoints(e){for(let t of e)WI.debuggerManager.isBreakpointRemovable(t)&&WI.debuggerManager.removeBreakpoint(t)}_toggleAllBreakpoints(e,t){for(let i of e)i.disabled=t}_breakpointsBeneathTreeElement(e){if(console.assert(e instanceof WI.ResourceTreeElement||e instanceof WI.ScriptTreeElement),!(e instanceof WI.ResourceTreeElement)&&!(e instanceof WI.ScriptTreeElement))return[];let t=[];for(let i of e.children){console.assert(i instanceof WI.BreakpointTreeElement);let n=i.breakpoint;console.assert(n),n&&t.push(n)}return t}_addIssue(e){let t=this._resourcesTreeOutline.findTreeElement(e);if(!t){let i=this._resourcesTreeOutline.findTreeElement(e.sourceCodeLocation.sourceCode);if(!i)return null;t=new WI.IssueTreeElement(e),i.insertChild(t,insertionIndexForObjectInListSortedByFunction(t,i.children,this._compareBreakpointTreeElements)),i.children.length===1&&i.expand()}return t}_removeDebuggerTreeElement(e){e.__deletedViaDeleteKeyboardShortcut||e.deselect();let t=e.parent;t.removeChild(e),!(t.children.length||t===this._breakpointsTreeOutline)&&t.treeOutline.removeChild(t)}_addBreakpointsForSourceCode(e){for(let t of WI.debuggerManager.breakpointsForSourceCode(e))this._addBreakpoint(t)}_addIssuesForSourceCode(e){for(let t of WI.consoleManager.issuesForSourceCode(e))this._addIssue(t)}_updateTemporarilyDisabledBreakpointsButtons(){let e=WI.debuggerManager.breakpointsDisabledTemporarily;this._debuggerBreakpointsButtonItem.enabled=!e,this._debuggerPauseResumeButtonItem.enabled=!e}_updateBreakpointsDisabledBanner(){if(!WI.debuggerManager.breakpointsEnabled&&!this._timelineRecordingWarningElement&&!this._auditTestWarningElement){if(!this._breakpointsDisabledWarningElement){let e=document.createElement("button");e.textContent=WI.UIString("Enable Breakpoints"),e.addEventListener("click",()=>{WI.debuggerToggleBreakpoints()}),this._breakpointsDisabledWarningElement=document.createElement("div"),this._breakpointsDisabledWarningElement.classList.add("warning-banner"),this._breakpointsDisabledWarningElement.append(WI.UIString("Breakpoints disabled"),document.createElement("br"),e)}this.contentView.element.insertBefore(this._breakpointsDisabledWarningElement,this.contentView.element.firstChild)}else this._breakpointsDisabledWarningElement&&(this._breakpointsDisabledWarningElement.remove(),this._breakpointsDisabledWarningElement=null)}_updatePauseReason(){return this._pauseReasonTreeOutline=null,this._updatePauseReasonGotoArrow(),this._updatePauseReasonSection()}_updatePauseReasonGotoArrow(){this._pauseReasonLinkContainerElement.removeChildren();let e=WI.debuggerManager.activeCallFrame;if(!e)return;let t=e.sourceCodeLocation;if(!t)return;const i={useGoToArrowButton:!0};let n=WI.createSourceCodeLocationLink(t,i);this._pauseReasonLinkContainerElement.appendChild(n)}_updatePauseReasonSection(){let e=WI.debuggerManager.activeCallFrame.target,t=WI.debuggerManager.dataForTarget(e),{pauseReason:i,pauseData:n}=t;switch(i){case WI.DebuggerManager.PauseReason.AnimationFrame:{if(console.assert(n,"Expected data with an animation frame, but found none."),!n)break;let s=WI.domDebuggerManager.eventBreakpointForTypeAndEventName(WI.EventBreakpoint.Type.AnimationFrame,n.eventName);if(console.assert(s,"Expected AnimationFrame breakpoint for event name.",n.eventName),!s)break;this._pauseReasonTreeOutline=this.createContentTreeOutline({suppressFiltering:!0});let a=new WI.EventBreakpointTreeElement(s,{className:"breakpoint-paused-icon",title:WI.UIString("%s Fired").format(n.eventName)});this._pauseReasonTreeOutline.appendChild(a);let d=new WI.DetailsSectionRow;return d.element.appendChild(this._pauseReasonTreeOutline.element),this._pauseReasonGroup.rows=[d],!0}case WI.DebuggerManager.PauseReason.Assertion:return console.assert(n,"Expected data with an assertion, but found none."),n&&n.message?this._pauseReasonTextRow.text=WI.UIString("Assertion with message: %s").format(n.message):this._pauseReasonTextRow.text=WI.UIString("Assertion Failed"),this._pauseReasonGroup.rows=[this._pauseReasonTextRow],!0;case WI.DebuggerManager.PauseReason.Breakpoint:{if(console.assert(n,"Expected breakpoint identifier, but found none."),!n||!n.breakpointId)break;this._pauseReasonTreeOutline=this.createContentTreeOutline({suppressFiltering:!0}),this._pauseReasonTreeOutline.addEventListener(WI.TreeOutline.Event.SelectionDidChange,this._handleTreeSelectionDidChange,this);let s=WI.debuggerManager.breakpointForIdentifier(n.breakpointId),a=new WI.BreakpointTreeElement(s,{className:"breakpoint-paused-icon",title:WI.UIString("Triggered Breakpoint")}),d=new WI.DetailsSectionRow;return this._pauseReasonTreeOutline.appendChild(a),d.element.appendChild(this._pauseReasonTreeOutline.element),this._pauseReasonGroup.rows=[d],!0}case WI.DebuggerManager.PauseReason.CSPViolation:if(console.assert(n,"Expected data with a CSP Violation, but found none."),!n)break;return this._pauseReasonTextRow.text=WI.UIString("Content Security Policy violation of directive: %s").format(n.directive||n.directiveText),this._pauseReasonGroup.rows=[this._pauseReasonTextRow],!0;case WI.DebuggerManager.PauseReason.DebuggerStatement:return this._pauseReasonTextRow.text=WI.UIString("Debugger Statement"),this._pauseReasonGroup.rows=[this._pauseReasonTextRow],!0;case WI.DebuggerManager.PauseReason.DOM:{if(console.assert(WI.domDebuggerManager.supported),console.assert(n,"Expected DOM breakpoint data, but found none."),!n||!n.nodeId)break;let s=WI.domManager.nodeForId(n.nodeId),a=WI.domDebuggerManager.domBreakpointsForNode(s),d;for(let S of a)if(S.type===n.type){d=S;break}if(console.assert(d,"Missing DOM breakpoint of type for node",n.type,s),!d)break;this._pauseReasonTreeOutline=this.createContentTreeOutline({suppressFiltering:!0});let p=WI.DOMBreakpointTreeElement.displayNameForType(d.type),f=new WI.DOMBreakpointTreeElement(d,{className:"breakpoint-paused-icon",title:p}),_=new WI.DetailsSectionRow;this._pauseReasonTreeOutline.appendChild(f),_.element.appendChild(this._pauseReasonTreeOutline.element);let b=new WI.DetailsSectionSimpleRow(WI.UIString("Element"),WI.linkifyNodeReference(s));return this._pauseReasonGroup.rows=[_,b],d.type!==WI.DOMBreakpoint.Type.SubtreeModified||(console.assert(n.targetNode),WI.RemoteObject.fromPayload(n.targetNode,e).pushNodeToFrontend(S=>{if(!S)return;let E=WI.domManager.nodeForId(S);if(console.assert(E,"Missing node for id.",S),!E)return;let k=document.createDocumentFragment(),R=n.insertion?WI.UIString("Child added to "):WI.UIString("Removed descendant ");k.append(R,WI.linkifyNodeReference(E));let M=new WI.DetailsSectionSimpleRow(WI.UIString("Details"),k);M.element.classList.add("target-description"),this._pauseReasonGroup.rows=this._pauseReasonGroup.rows.concat(M)})),!0}case WI.DebuggerManager.PauseReason.EventListener:{if(console.assert(n,"Expected data with an event listener, but found none."),!n)break;let s=null;if(n.eventListenerId&&(s=WI.domManager.breakpointForEventListenerId(n.eventListenerId)),s||(s=WI.domDebuggerManager.eventBreakpointForTypeAndEventName(WI.EventBreakpoint.Type.Listener,n.eventName)),console.assert(s,"Expected Event Listener breakpoint for event name.",n.eventName),!s)break;this._pauseReasonTreeOutline=this.createContentTreeOutline({suppressFiltering:!0});let a=new WI.EventBreakpointTreeElement(s,{className:"breakpoint-paused-icon",title:WI.UIString("\u201C%s\u201D Event Fired").format(n.eventName)});this._pauseReasonTreeOutline.appendChild(a);let d=new WI.DetailsSectionRow;d.element.appendChild(this._pauseReasonTreeOutline.element);let p=[d],f=s.eventListener;if(f){console.assert(f.eventListenerId===n.eventListenerId);let _=null;f.onWindow?_=WI.unlocalizedString("window"):f.node&&(_=WI.linkifyNodeReference(f.node)),_&&p.push(new WI.DetailsSectionSimpleRow(WI.UIString("Target"),_))}return this._pauseReasonGroup.rows=p,!0}case WI.DebuggerManager.PauseReason.Exception:{if(console.assert(n,"Expected data with an exception, but found none."),!n)break;let s=WI.RemoteObject.fromPayload(n,e);return this._pauseReasonTextRow.text=WI.UIString("Exception with thrown value: %s").format(s.description),this._pauseReasonGroup.rows=[this._pauseReasonTextRow],!0}case WI.DebuggerManager.PauseReason.PauseOnNextStatement:return this._pauseReasonTextRow.text=WI.UIString("Immediate Pause Requested"),this._pauseReasonGroup.rows=[this._pauseReasonTextRow],!0;case WI.DebuggerManager.PauseReason.Timer:{if(console.assert(n,"Expected data with a timer, but found none."),!n)break;let s=WI.domDebuggerManager.eventBreakpointForTypeAndEventName(WI.EventBreakpoint.Type.Timer,n.eventName);if(console.assert(s,"Expected Timer breakpoint for event name.",n.eventName),!s)break;this._pauseReasonTreeOutline=this.createContentTreeOutline({suppressFiltering:!0});let a=new WI.EventBreakpointTreeElement(s,{className:"breakpoint-paused-icon",title:WI.UIString("%s Fired").format(n.eventName)});this._pauseReasonTreeOutline.appendChild(a);let d=new WI.DetailsSectionRow;return d.element.appendChild(this._pauseReasonTreeOutline.element),this._pauseReasonGroup.rows=[d],!0}case WI.DebuggerManager.PauseReason.Fetch:case WI.DebuggerManager.PauseReason.XHR:{if(console.assert(WI.domDebuggerManager.supported),console.assert(n,"Expected URL breakpoint data, but found none."),!n)break;if(n.breakpointURL){let s=WI.domDebuggerManager.urlBreakpointForURL(n.breakpointURL);console.assert(s,"Expected URL breakpoint for URL.",n.breakpointURL),this._pauseReasonTreeOutline=this.createContentTreeOutline({suppressFiltering:!0});let a=new WI.URLBreakpointTreeElement(s,{className:"breakpoint-paused-icon",title:WI.UIString("Triggered URL Breakpoint")}),d=new WI.DetailsSectionRow;this._pauseReasonTreeOutline.appendChild(a),d.element.appendChild(this._pauseReasonTreeOutline.element),this._pauseReasonTextRow.text=n.url,this._pauseReasonGroup.rows=[d,this._pauseReasonTextRow]}else console.assert(n.breakpointURL==="","Should be the All Requests breakpoint which has an empty URL"),this._pauseReasonTextRow.text=WI.UIString("Requesting: %s").format(n.url),this._pauseReasonGroup.rows=[this._pauseReasonTextRow];return this._pauseReasonTextRow.element.title=n.url,!0}case WI.DebuggerManager.PauseReason.Other:console.error("Paused for unknown reason. We should always have a reason.");break}return!1}_handleResourceTypeScopeBarSelectionChanged(e){this.updateFilter()}_handleResourceGroupingModeMouseDown(e){if(this._ignoreResourceGroupingModeMouseDown)return;this._ignoreResourceGroupingModeMouseDown=!0;let t=WI.ContextMenu.createFromEvent(e);t.addBeforeShowCallback(()=>{this._ignoreResourceGroupingModeMouseDown=!1});function i(n,s){t.appendCheckboxItem(s,()=>{WI.settings.resourceGroupingMode.value=n},WI.settings.resourceGroupingMode.value===n)}i(WI.Resource.GroupingMode.Path,WI.UIString("Group by Path")),i(WI.Resource.GroupingMode.Type,WI.UIString("Group by Type")),t.show()}_handleTreeSelectionDidChange(e){if(!this.selected)return;let t=e.target.selectedTreeElement;if(!!t&&!(t instanceof WI.DOMNodeTreeElement||t instanceof WI.DOMBreakpointTreeElement||t instanceof WI.EventBreakpointTreeElement||t instanceof WI.URLBreakpointTreeElement)&&t.representedObject!==xa.__windowEventTargetRepresentedObject){if(t instanceof WI.FolderTreeElement||t instanceof WI.ResourceTreeElement||t instanceof WI.ScriptTreeElement||t instanceof WI.CSSStyleSheetTreeElement){let i=t.representedObject;(i instanceof WI.Collection||i instanceof WI.SourceCode)&&WI.showRepresentedObject(i);return}if(t instanceof WI.CallFrameTreeElement){let i=t.callFrame;i.id&&(WI.debuggerManager.activeCallFrame=i),i.sourceCodeLocation&&WI.showSourceCodeLocation(i.sourceCodeLocation);return}if(t instanceof WI.IssueTreeElement){WI.showSourceCodeLocation(t.issueMessage.sourceCodeLocation);return}if(t instanceof WI.BreakpointTreeElement){let i=t.breakpoint;if(WI.debuggerManager.isBreakpointSpecial(i))return;if(t.treeOutline===this._pauseReasonTreeOutline){WI.showSourceCodeLocation(i.sourceCodeLocation);return}if(t.parent.representedObject&&(console.assert(t.parent.representedObject instanceof WI.SourceCode),t.parent.representedObject instanceof WI.SourceCode)){WI.showSourceCodeLocation(i.sourceCodeLocation);return}}console.error("Unknown tree element",t)}}_handleCallStackElementAddedOrRemoved(e){let t=this._callStackTreeOutline.children.length;for(let i of this._callStackTreeOutline.children)t+=i.children.length;WI.targets.length===1&&--t,this.element.style.setProperty("--call-stack-count",t)}_handleBreakpointElementAddedOrRemoved(e){let t=e.data.element,i=null;t.breakpoint===WI.debuggerManager.assertionFailuresBreakpoint?i=WI.settings.showAssertionFailuresBreakpoint:t.representedObject===WI.domDebuggerManager.allRequestsBreakpoint&&(i=WI.settings.showAllRequestsBreakpoint),i&&(i.value=!!t.parent);let n=this._breakpointsTreeOutline.children.length;for(let s of this._breakpointsTreeOutline.children)n+=s.children.length;this.element.style.setProperty("--breakpoints-count",n)}_handleCreateBreakpointMouseDown(e){if(this._ignoreCreateBreakpointMouseDown)return;this._ignoreCreateBreakpointMouseDown=!0;let t=WI.ContextMenu.createFromEvent(e);if(t.addBeforeShowCallback(()=>{this._ignoreCreateBreakpointMouseDown=!1}),InspectorBackend.domains.Debugger.setPauseOnAssertions){let i=WI.settings.showAssertionFailuresBreakpoint.value;t.appendCheckboxItem(WI.repeatedUIString.assertionFailures(),()=>{i?WI.debuggerManager.removeBreakpoint(WI.debuggerManager.assertionFailuresBreakpoint):(WI.debuggerManager.assertionFailuresBreakpoint.disabled=!1,WI.debuggerManager.addBreakpoint(WI.debuggerManager.assertionFailuresBreakpoint))},i)}if(WI.domDebuggerManager.supported){t.appendSeparator(),t.appendItem(WI.UIString("Event Breakpoint\u2026"),()=>{new WI.EventBreakpointPopover(this).show(this._createBreakpointButton.element,[WI.RectEdge.MAX_Y,WI.RectEdge.MIN_Y,WI.RectEdge.MAX_X])}),t.appendSeparator();let i=WI.settings.showAllRequestsBreakpoint.value;t.appendCheckboxItem(WI.repeatedUIString.allRequests(),()=>{i?WI.domDebuggerManager.removeURLBreakpoint(WI.domDebuggerManager.allRequestsBreakpoint):(WI.domDebuggerManager.allRequestsBreakpoint.disabled=!1,WI.domDebuggerManager.addURLBreakpoint(WI.domDebuggerManager.allRequestsBreakpoint))},i),t.appendItem(WI.UIString("URL Breakpoint\u2026"),()=>{new WI.URLBreakpointPopover(this).show(this._createBreakpointButton.element,[WI.RectEdge.MAX_Y,WI.RectEdge.MIN_Y,WI.RectEdge.MAX_X])})}t.show()}_handleResourceGroupingModeChanged(e){this._workerTargetTreeElementMap.clear(),this._mainFrameTreeElement=null,this._extensionScriptsFolderTreeElement=null,this._extraScriptsFolderTreeElement=null,this._anonymousScriptsFolderTreeElement=null,this._originTreeElementMap.clear(),this._resourcesTreeOutline.removeChildren();let t=WI.networkManager.mainFrame;t&&(this._updateMainFrameTreeElement(t),this._addResourcesRecursivelyForFrame(t));for(let i of WI.debuggerManager.knownNonResourceScripts)this._addScript(i),i.sourceMaps.length&&WI.SourcesNavigationSidebarPanel.shouldPlaceResourcesAtTopLevel()&&(this._resourcesTreeOutline.disclosureButtons=!0)}_handleFrameMainResourceDidChange(e){let t=e.target;if(t.isMainFrame()){this._updateMainFrameTreeElement(t),this._addResourcesRecursivelyForFrame(t);for(let i of WI.domDebuggerManager.domBreakpoints)this._removeBreakpoint(i)}if(!e.data.oldMainResource){let i=e.target.mainResource;this._addBreakpointsForSourceCode(i),this._addIssuesForSourceCode(i)}}_handleResourceAdded(e){this._addResource(e.data.resource)}_handleMainFrameDidChange(e){let t=WI.networkManager.mainFrame;this._updateMainFrameTreeElement(t),this._addResourcesRecursivelyForFrame(t)}_handleDebuggerBreakpointAdded(e){this._addBreakpoint(e.data.breakpoint)}_handleDebuggerBreakpointRemoved(e){this._removeBreakpoint(e.data.breakpoint)}_handleDebuggerBreakpointsEnabledDidChange(e){this._debuggerBreakpointsButtonItem.activated=WI.debuggerManager.breakpointsEnabled,this._updateBreakpointsDisabledBanner()}_handleDebuggerScriptAdded(e){this._addScript(e.data.script)}_handleDebuggerScriptRemoved(e){let t=e.data.script,i=this._resourcesTreeOutline.findTreeElement(t);if(!i)return;let n=i.parent;n.removeChild(i),n instanceof WI.FolderTreeElement&&(n.representedObject.remove(t),n.children.length||n.parent.removeChild(n))}_handleDebuggerScriptsCleared(e){for(let n=this._breakpointsTreeOutline.children.length-1;n>=0;--n){let s=this._breakpointsTreeOutline.children[n];s instanceof WI.ScriptTreeElement&&this._breakpointsTreeOutline.removeChild(s,!0,!0)}if(this._extensionScriptsFolderTreeElement&&(this._extensionScriptsFolderTreeElement.parent&&this._extensionScriptsFolderTreeElement.parent.removeChild(this._extensionScriptsFolderTreeElement,!0,!0),this._extensionScriptsFolderTreeElement.representedObject.clear(),this._extensionScriptsFolderTreeElement=null),this._extraScriptsFolderTreeElement&&(this._extraScriptsFolderTreeElement.parent&&this._extraScriptsFolderTreeElement.parent.removeChild(this._extraScriptsFolderTreeElement,!0,!0),this._extraScriptsFolderTreeElement.representedObject.clear(),this._extraScriptsFolderTreeElement=null),this._anonymousScriptsFolderTreeElement&&(this._anonymousScriptsFolderTreeElement.parent&&this._anonymousScriptsFolderTreeElement.parent.removeChild(this._anonymousScriptsFolderTreeElement,!0,!0),this._anonymousScriptsFolderTreeElement.representedObject.clear(),this._anonymousScriptsFolderTreeElement=null),this._workerTargetTreeElementMap.size){for(let n of this._workerTargetTreeElementMap.values())n.parent.removeChild(n,!0,!0);this._workerTargetTreeElementMap.clear()}this._addResourcesRecursivelyForFrame(WI.networkManager.mainFrame)}_handleDebuggerPaused(e){this.contentView.element.insertBefore(this._callStackSection.element,this.contentView.element.firstChild),this._updatePauseReason()&&this.contentView.element.insertBefore(this._pauseReasonSection.element,this.contentView.element.firstChild),this._debuggerPauseResumeButtonItem.enabled=!0,this._debuggerPauseResumeButtonItem.toggled=!0,this._debuggerStepOverButtonItem.enabled=!0,this._debuggerStepIntoButtonItem.enabled=!0,this._debuggerStepOutButtonItem.enabled=!0,this.element.classList.add("paused")}_handleDebuggerResumed(e){this._callStackSection.element.remove(),this._pauseReasonSection.element.remove(),this._debuggerPauseResumeButtonItem.enabled=!0,this._debuggerPauseResumeButtonItem.toggled=!1,this._debuggerStepOverButtonItem.enabled=!1,this._debuggerStepIntoButtonItem.enabled=!1,this._debuggerStepOutButtonItem.enabled=!1,this.element.classList.remove("paused")}_handleDebuggerCallFramesDidChange(e){let{target:t}=e.data,i=this._findCallStackTargetTreeElement(t);console.assert(i),i&&i.refresh();let n=this._callStackTreeOutline.findTreeElement(WI.debuggerManager.activeCallFrame);n&&n.reveal()}_handleDebuggerActiveCallFrameDidChange(e){this._activeCallFrameTreeElement&&(this._activeCallFrameTreeElement.isActiveCallFrame=!1,this._activeCallFrameTreeElement=null),WI.debuggerManager.activeCallFrame&&(this._activeCallFrameTreeElement=this._callStackTreeOutline.findTreeElement(WI.debuggerManager.activeCallFrame),this._activeCallFrameTreeElement&&(this._activeCallFrameTreeElement.isActiveCallFrame=!0))}_handleDebuggerWaitingToPause(e){this._debuggerPauseResumeButtonItem.enabled=!1}_handleDebuggerObjectDisplayLocationDidChange(e){let t=e.target;if(e.data.oldDisplaySourceCode===t.sourceCodeLocation.displaySourceCode)return;let i=!1,n=null,s=null;t instanceof WI.Breakpoint?(n=this._breakpointsTreeOutline.findTreeElement(t),n&&(i=n.selected),s=this._addBreakpoint(t)):t instanceof WI.IssueMessage&&(n=this._resourcesTreeOutline.findTreeElement(t),n&&(i=n.selected),s=this._addIssue(t)),s&&(n&&this._removeDebuggerTreeElement(n),i&&s.revealAndSelect(!0,!1,!0))}_handleDOMBreakpointDOMNodeChanged(e){let t=e.target;t.domNodeIdentifier?this._addBreakpoint(t):this._removeBreakpoint(t)}_handleConsoleIssueAdded(e){let{issue:t}=e.data;!t.sourceCodeLocation||!t.sourceCodeLocation.sourceCode||t.source!=="javascript"&&t.source!=="console-api"||this._addIssue(t)}_handleConsoleCleared(e){let t=[],i=this._resourcesTreeOutline.children[0];for(;i&&!i.root;){i instanceof WI.IssueTreeElement&&t.push(i);const n=!1,s=null,a=!0;i=i.traverseNextTreeElement(n,s,a)}t.forEach(n=>n.parent.removeChild(n))}_handleTimelineCapturingStateChanged(e){switch(this._updateTemporarilyDisabledBreakpointsButtons(),WI.timelineManager.capturingState){case WI.TimelineManager.CapturingState.Starting:if(!this._timelineRecordingWarningElement){let t=document.createElement("button");t.textContent=WI.UIString("Stop recording"),t.addEventListener("click",()=>{WI.timelineManager.stopCapturing()}),this._timelineRecordingWarningElement=document.createElement("div"),this._timelineRecordingWarningElement.classList.add("warning-banner"),this._timelineRecordingWarningElement.append(WI.UIString("Debugger disabled during Timeline recording"),document.createElement("br"),t)}this.contentView.element.insertBefore(this._timelineRecordingWarningElement,this.contentView.element.firstChild);break;case WI.TimelineManager.CapturingState.Inactive:this._timelineRecordingWarningElement&&(this._timelineRecordingWarningElement.remove(),this._timelineRecordingWarningElement=null);break}this._updateBreakpointsDisabledBanner()}_handleAuditManagerTestScheduled(e){if(this._updateTemporarilyDisabledBreakpointsButtons(),!this._auditTestWarningElement){let t=document.createElement("button");t.textContent=WI.UIString("Stop Audit"),t.addEventListener("click",i=>{WI.auditManager.stop()}),this._auditTestWarningElement=document.createElement("div"),this._auditTestWarningElement.classList.add("warning-banner"),this._auditTestWarningElement.append(WI.UIString("Debugger disabled during Audit"),document.createElement("br"),t)}this.contentView.element.insertBefore(this._auditTestWarningElement,this.contentView.element.firstChild),this._updateBreakpointsDisabledBanner()}_handleAuditManagerTestCompleted(e){this._updateTemporarilyDisabledBreakpointsButtons(),this._auditTestWarningElement&&(this._auditTestWarningElement.remove(),this._auditTestWarningElement=null),this._updateBreakpointsDisabledBanner()}_handleCSSStyleSheetAdded(e){let t=e.data.styleSheet;if(!!t.isInspectorStyleSheet()){if(WI.settings.resourceGroupingMode.value===WI.Resource.GroupingMode.Type){let i=this.treeElementForRepresentedObject(t.parentFrame);if(i){i.addRepresentedObjectToNewChildQueue(t);return}}this._addResource(t)}}_handleTargetAdded(e){this._addTarget(e.data.target)}_handleTargetRemoved(e){let{target:t}=e.data,i=this._workerTargetTreeElementMap.take(t);i&&i.parent.removeChild(i);let n=this._findCallStackTargetTreeElement(t);console.assert(n),n&&this._callStackTreeOutline.removeChild(n),this._updateCallStackTreeOutline()}_handleExtraDomainsActivated(){WI.SourcesNavigationSidebarPanel.shouldPlaceResourcesAtTopLevel()&&(this._resourcesTreeOutline.disclosureButtons=!0)}};WI.SourcesNavigationSidebarPanel.ResourceTypeSymbol=Symbol("resource-type");WI.SourceMapResourceTreeElement=class extends WI.ResourceTreeElement{constructor(e){console.assert(e instanceof WI.SourceMapResource),super(e),console.assert(this.resource===e),this.addClassName("source-map-resource")}_updateTitles(){var e=this.mainTitle;this.mainTitle=this.resource.displayName;var t=this.resource.urlComponents.host,i=this.resource.sourceMap.originalSourceCode.urlComponents.host,n=t!==i?WI.displayNameForHost(t):null;this.subtitle=this.mainTitle!==n?n:null,e!==this.mainTitle&&this.callFirstAncestorFunction("descendantResourceTreeElementMainTitleDidChange",[this,e])}};WI.SpanningDataGridNode=class extends WI.DataGridNode{constructor(e){super({[WI.SpanningDataGridNode.ColumnIdentifier]:e})}createCells(){let e=this.createCell(WI.SpanningDataGridNode.ColumnIdentifier);e.classList.add("spanning"),e.setAttribute("colspan",this.dataGrid.columns.size),this.element.appendChild(e)}};WI.SpanningDataGridNode.ColumnIdentifier="spanning-text";WI.SpreadsheetCSSStyleDeclarationEditor=class extends WI.View{constructor(e,t){super(),this.element.classList.add(WI.SpreadsheetCSSStyleDeclarationEditor.StyleClassName),this._delegate=e,this.style=t,this._propertyViews=[],this._focused=!1,this._inlineSwatchActive=!1,this._showsImplicitProperties=!1,this._alwaysShowPropertyNames=new Set,this._propertyVisibilityMode=WI.SpreadsheetCSSStyleDeclarationEditor.PropertyVisibilityMode.ShowAll,this._hideFilterNonMatchingProperties=!1,this._sortPropertiesByName=!1,this._propertyPendingStartEditing=null,this._pendingAddBlankPropertyIndexOffset=NaN,this._filterText=null,this._anchorIndex=NaN,this._focusIndex=NaN}initialLayout(){!this._style||(this.element.addEventListener("focus",()=>{this.focused=!0},!0),this.element.addEventListener("blur",e=>{let t=e.relatedTarget;t&&this.element.contains(t)||(this.focused=!1)},!0),this.element.addEventListener("keydown",this._handleKeyDown.bind(this)))}layout(){if(this.editing&&!this._propertyPendingStartEditing&&isNaN(this._pendingAddBlankPropertyIndexOffset))return;super.layout(),this.element.removeChildren(),this._style&&this._style.updatePropertiesModifiedState();let e=this.propertiesToRender;this.element.classList.toggle("no-properties",!e.length),this._propertyViews=[];let t=null;for(let i=0;i<e.length;i++){let n=e[i],s=new WI.SpreadsheetStyleProperty(this,n);s.index=i,this.element.append(s.element),this._propertyViews.push(s),n===this._propertyPendingStartEditing&&(t=s)}t&&(t.startEditingName(),this._propertyPendingStartEditing=null),this._filterText&&this.applyFilter(this._filterText),isNaN(this._pendingAddBlankPropertyIndexOffset)?this.hasSelectedProperties()&&this.selectProperties(this._anchorIndex,this._focusIndex):this.addBlankProperty(this._propertyViews.length-1-this._pendingAddBlankPropertyIndexOffset),this._updateDebugLockStatus()}detached(){this._inlineSwatchActive=!1,this.focused=!1;for(let e of this._propertyViews)e.detached()}hidden(){for(let e of this._propertyViews)e.hidden()}get style(){return this._style}set style(e){this._style!==e&&(this._style&&this._style.removeEventListener(WI.CSSStyleDeclaration.Event.PropertiesChanged,this._propertiesChanged,this),this._style=e||null,this._style&&this._style.addEventListener(WI.CSSStyleDeclaration.Event.PropertiesChanged,this._propertiesChanged,this),this.needsLayout())}get editing(){return this._focused||this._inlineSwatchActive}set focused(e){this._focused=e,this._updateStyleLock()}set inlineSwatchActive(e){this._inlineSwatchActive=e,this._updateStyleLock()}set showsImplicitProperties(e){e!==this._showsImplicitProperties&&(this._showsImplicitProperties=e,this.needsLayout())}set alwaysShowPropertyNames(e){this._alwaysShowPropertyNames=new Set(e),this.needsLayout()}set propertyVisibilityMode(e){this._propertyVisibilityMode!==e&&(this._propertyVisibilityMode=e,this.needsLayout())}set hideFilterNonMatchingProperties(e){e!==this._hideFilterNonMatchingProperties&&(this._hideFilterNonMatchingProperties=e,this.needsLayout())}set sortPropertiesByName(e){e!==this._sortPropertiesByName&&(this._sortPropertiesByName=e,this.needsLayout())}get propertiesToRender(){let e=[];return this._style?(this._style._styleSheetTextRange?e=this._style.visibleProperties:e=this._style.properties,this._sortPropertiesByName&&e.sort((t,i)=>t.name.extendedLocaleCompare(i.name)),e.filter(t=>!t.variable&&this._propertyVisibilityMode===WI.SpreadsheetCSSStyleDeclarationEditor.PropertyVisibilityMode.HideNonVariables||t.variable&&this._propertyVisibilityMode===WI.SpreadsheetCSSStyleDeclarationEditor.PropertyVisibilityMode.HideVariables?!1:!t.implicit||this._showsImplicitProperties||this._alwaysShowPropertyNames.has(t.canonicalName))):e}get selectionRange(){let e=Math.min(this._anchorIndex,this._focusIndex),t=Math.max(this._anchorIndex,this._focusIndex);return[e,t]}startEditingFirstProperty(){let e=this._editablePropertyAfter(-1);e?e.startEditingName():this.addBlankProperty(-1)}startEditingLastProperty(){let e=this._editablePropertyBefore(this._propertyViews.length);e?e.startEditingValue():this.addBlankProperty(-1)}highlightProperty(e){let t=n=>!!(n.attached&&!n.overridden&&(n.canonicalName===e.canonicalName||i(n))),i=n=>{let s=n.relatedLonghandProperties;if(!s.length)return!1;for(let a of s)if(t(a))return!0;return!1};for(let n=0;n<this._propertyViews.length;++n)if(t(this._propertyViews[n].property))return this.selectProperties(n,n),!0;return!1}addBlankProperty(e){this._pendingAddBlankPropertyIndexOffset=NaN,e===-1&&(e=this._propertyViews.length),this._propertyPendingStartEditing=this._style.newBlankProperty(e),this.needsLayout()}hasSelectedProperties(){return!isNaN(this._anchorIndex)&&!isNaN(this._focusIndex)}selectProperties(e,t){if(console.assert(e<this._propertyViews.length,`anchorIndex (${e}) is greater than the last property index (${this._propertyViews.length})`),console.assert(t<this._propertyViews.length,`focusIndex (${t}) is greater than the last property index (${this._propertyViews.length})`),isNaN(e)||isNaN(t)){console.error(`Nothing to select. anchorIndex (${e}) and focusIndex (${t}) must be numbers.`),this.deselectProperties();return}this._anchorIndex=e,this._focusIndex=t;let[i,n]=this.selectionRange;for(let a=0;a<this._propertyViews.length;++a){let d=this._propertyViews[a],p=a>=i&&a<=n;d.selected=p}this._suppressBlur=!0,this._propertyViews[t].element.focus(),this._suppressBlur=!1}extendSelectedProperties(e){this.selectProperties(this._anchorIndex,e)}deselectProperties(){for(let e of this._propertyViews)e.selected=!1;this._focused=!1,this._anchorIndex=NaN,this._focusIndex=NaN}applyFilter(e){if(this._filterText=e,!this.didInitialLayout)return;let t=!1;for(let i of this._propertyViews)i.applyFilter(this._filterText)?(t=!0,this._hideFilterNonMatchingProperties&&this.element.append(i.element)):this._hideFilterNonMatchingProperties&&i.element.remove();this.dispatchEventToListeners(WI.SpreadsheetCSSStyleDeclarationEditor.Event.FilterApplied,{matches:t})}spreadsheetStylePropertyBlur(e,t){this._suppressBlur||this._delegate.spreadsheetCSSStyleDeclarationEditorPropertyBlur&&this._delegate.spreadsheetCSSStyleDeclarationEditorPropertyBlur(e,t)}spreadsheetStylePropertyMouseEnter(e,t){this._delegate.spreadsheetCSSStyleDeclarationEditorPropertyMouseEnter&&this._delegate.spreadsheetCSSStyleDeclarationEditorPropertyMouseEnter(e,t)}spreadsheetStylePropertyFocusMoved(e,{direction:t,willRemoveProperty:i}){if(this._updatePropertiesStatus(),!t)return;let n=this._propertyViews.indexOf(e);if(console.assert(n!==-1,"Property doesn't exist, focusing on a selector as a fallback."),n===-1){this._style.selectorEditable&&this._delegate.spreadsheetCSSStyleDeclarationEditorStartEditingRuleSelector();return}if(t==="forward"){let s=this._editablePropertyAfter(n);s?s.startEditingName():i?this._delegate.spreadsheetCSSStyleDeclarationEditorStartEditingAdjacentRule(this,1):this.addBlankProperty(-1)}else{let s=this._editablePropertyBefore(n);s?s.startEditingValue():this._style.selectorEditable?this._delegate.spreadsheetCSSStyleDeclarationEditorStartEditingRuleSelector():this._delegate.spreadsheetCSSStyleDeclarationEditorStartEditingAdjacentRule(this,-1)}}spreadsheetStylePropertySelect(e){this.selectProperties(e,e)}spreadsheetStylePropertySelectByProperty(e){this._delegate&&this._delegate.spreadsheetCSSStyleDeclarationEditorSelectProperty&&this._delegate.spreadsheetCSSStyleDeclarationEditorSelectProperty(e)}spreadsheetStylePropertyAddBlankPropertySoon(e,{index:t}){isNaN(t)&&(t=this._propertyViews.length),this._pendingAddBlankPropertyIndexOffset=this._propertyViews.length-t}spreadsheetStylePropertyCopy(e){if(!this.hasSelectedProperties())return;let t=[],[i,n]=this.selectionRange;for(let s=i;s<=n;++s){let a=this._propertyViews[s];t.push(a.property.formattedText)}e.clipboardData.setData("text/plain",t.join(`
`)),e.stop()}spreadsheetStylePropertyWillRemove(e){this._propertyViews.remove(e);for(let i=0;i<this._propertyViews.length;i++)this._propertyViews[i].index=i;document.activeElement&&e.element.contains(document.activeElement)&&(this.focused=!1)}spreadsheetStylePropertyShowProperty(e,t){this._delegate.spreadsheetCSSStyleDeclarationEditorShowProperty&&this._delegate.spreadsheetCSSStyleDeclarationEditorShowProperty(this,t)}spreadsheetStylePropertyDidPressEsc(e){let t=this._propertyViews.indexOf(e);console.assert(t!==-1,`Can't find StyleProperty to select (${e.property.name})`),t!==-1&&this.selectProperties(t,t)}stylePropertyInlineSwatchActivated(){this.inlineSwatchActive=!0}stylePropertyInlineSwatchDeactivated(){this.inlineSwatchActive=!1}_handleKeyDown(e){if(!(!this.hasSelectedProperties()||!this._propertyViews.length))if(e.key==="ArrowUp"||e.key==="ArrowDown"){let t=e.key==="ArrowUp"?-1:1,i=Number.constrain(this._focusIndex+t,0,this._propertyViews.length-1);e.shiftKey?this.extendSelectedProperties(i):this.selectProperties(i,i),e.stop()}else if(e.key==="Tab"||e.key==="Enter"){if(!this.style.editable)return;let t=this._propertyViews[this._focusIndex];t&&t.enabled&&(e.stop(),t.startEditingName())}else if(e.key==="Backspace"||e.key==="Delete"){if(!this.style.editable)return;let[t,i]=this.selectionRange,n=NaN;i+1!==this._propertyViews.length?n=t:t>0&&(n=t-1),this.deselectProperties();for(let s=i;s>=t;s--)this._propertyViews[s].remove();isNaN(n)||this.selectProperties(n,n),e.stop()}else if(e.code==="Space"&&!e.shiftKey&&!e.metaKey&&!e.ctrlKey||e.key==="/"&&e.commandOrControlKey&&!e.shiftKey){if(!this.style.editable)return;let[t,i]=this.selectionRange,n=this._propertyViews[t].property.enabled;for(let s=i;s>=t;--s){let a=this._propertyViews[s];a.property.commentOut(n),a.update()}e.stop()}else e.key==="a"&&e.commandOrControlKey?(this.selectProperties(0,this._propertyViews.length-1),e.stop()):e.key==="Esc"&&this.deselectProperties()}_editablePropertyAfter(e){for(let t=e+1;t<this._propertyViews.length;t++){let i=this._propertyViews[t];if(i.enabled)return i}return null}_editablePropertyBefore(e){for(let t=e-1;t>=0;t--){let i=this._propertyViews[t];if(i.enabled)return i}return null}_propertiesChanged(e){this.editing&&isNaN(this._pendingAddBlankPropertyIndexOffset)?this._updatePropertiesStatus():this.needsLayout()}_updatePropertiesStatus(){for(let e of this._propertyViews)e.updateStatus()}_updateStyleLock(){!this._style||(this._style.locked=this._focused||this._inlineSwatchActive,this._updateDebugLockStatus())}_updateDebugLockStatus(){!this._style||!WI.settings.enableStyleEditingDebugMode.value||this.element.classList.toggle("debug-style-locked",this._style.locked)}};WI.SpreadsheetCSSStyleDeclarationEditor.Event={FilterApplied:"spreadsheet-css-style-declaration-editor-filter-applied"};WI.SpreadsheetCSSStyleDeclarationEditor.StyleClassName="spreadsheet-style-declaration-editor";WI.SpreadsheetCSSStyleDeclarationEditor.PropertyVisibilityMode={ShowAll:Symbol("variable-visibility-show-all"),HideVariables:Symbol("variable-visibility-hide-variables"),HideNonVariables:Symbol("variable-visibility-hide-non-variables")};WI.SpreadsheetCSSStyleDeclarationSection=class extends WI.View{constructor(e,t){console.assert(t instanceof WI.CSSStyleDeclaration,t);let i=document.createElement("section");i.classList.add("spreadsheet-css-declaration"),super(i),this._delegate=e||null,this._style=t,this._propertiesEditor=null,this._selectorElements=[],this._mediaElements=[],this._filterText=null,this._shouldFocusSelectorElement=!1,this._wasEditing=!1,this._isMousePressed=!1,this._mouseDownIndex=NaN,this._mouseDownPoint=null,this._boundHandleWindowMouseMove=null}get style(){return this._style}get editable(){return this._style.editable}initialLayout(){super.initialLayout(),this._headerElement=document.createElement("div"),this._headerElement.classList.add("header"),this._styleOriginView=new WI.StyleOriginView,this._headerElement.append(this._styleOriginView.element),this._selectorElement=document.createElement("span"),this._selectorElement.classList.add("selector"),this._selectorElement.addEventListener("mouseenter",this._highlightNodesWithSelector.bind(this)),this._selectorElement.addEventListener("mouseleave",this._hideDOMNodeHighlight.bind(this)),this._headerElement.append(this._selectorElement),this._openBrace=document.createElement("span"),this._openBrace.classList.add("open-brace"),this._openBrace.textContent=" {",this._headerElement.append(this._openBrace),this._style.selectorEditable&&(this._selectorTextField=new WI.SpreadsheetSelectorField(this,this._selectorElement),this._selectorTextField.addEventListener(WI.SpreadsheetSelectorField.Event.StartedEditing,e=>{this._headerElement.classList.add("editing-selector")}),this._selectorTextField.addEventListener(WI.SpreadsheetSelectorField.Event.StoppedEditing,e=>{this._headerElement.classList.remove("editing-selector")}),this._selectorElement.tabIndex=0),this._propertiesEditor=new WI.SpreadsheetCSSStyleDeclarationEditor(this,this._style),this._propertiesEditor.element.classList.add("properties"),this._propertiesEditor.addEventListener(WI.SpreadsheetCSSStyleDeclarationEditor.Event.FilterApplied,this._handleEditorFilterApplied,this),this._closeBrace=document.createElement("span"),this._closeBrace.classList.add("close-brace"),this._closeBrace.textContent="}",this._element.append(this._createMediaHeader(),this._headerElement),this.addSubview(this._propertiesEditor),this._propertiesEditor.needsLayout(),this._element.append(this._closeBrace),this._style.editable?this._style.ownerRule||this._element.classList.add("selector-locked"):this._element.classList.add("locked"),this.element.addEventListener("mousedown",this._handleMouseDown.bind(this)),this._style.editable&&(this.element.addEventListener("click",this._handleClick.bind(this)),new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl,"S",this._save.bind(this),this._element),new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl|WI.KeyboardShortcut.Modifier.Shift,"S",this._save.bind(this),this._element))}layout(){super.layout(),this._styleOriginView.update(this._style),this._renderSelector(),this._shouldFocusSelectorElement&&this.startEditingRuleSelector()}hidden(){this._propertiesEditor.hidden()}startEditingRuleSelector(){if(!this._selectorElement){this._shouldFocusSelectorElement=!0;return}this._shouldFocusSelectorElement=!1,this._style.selectorEditable?this._selectorTextField.startEditing():this._propertiesEditor.startEditingFirstProperty()}highlightProperty(e){return this.didInitialLayout||this.updateLayout(),this._propertiesEditor.highlightProperty(e)?(this._element.scrollIntoView(),!0):!1}spreadsheetSelectorFieldDidChange(e){let t=this._selectorElement.textContent.trim();!t||t===this._style.ownerRule.selectorText?this._discardSelectorChange():(this.dispatchEventToListeners(WI.SpreadsheetCSSStyleDeclarationSection.Event.SelectorWillChange),this._style.ownerRule.singleFireEventListener(WI.CSSRule.Event.SelectorChanged,this._renderSelector,this),this._style.ownerRule.selectorText=t),e&&(e==="forward"?this._propertiesEditor.startEditingFirstProperty():e==="backward"&&(this._delegate.spreadsheetCSSStyleDeclarationSectionStartEditingAdjacentRule?this._delegate.spreadsheetCSSStyleDeclarationSectionStartEditingAdjacentRule(this,-1):this._propertiesEditor.startEditingLastProperty()))}spreadsheetSelectorFieldDidDiscard(){this._discardSelectorChange()}spreadsheetCSSStyleDeclarationEditorStartEditingRuleSelector(){this.startEditingRuleSelector()}spreadsheetCSSStyleDeclarationEditorStartEditingAdjacentRule(e,t){!this._delegate||this._delegate.spreadsheetCSSStyleDeclarationSectionStartEditingAdjacentRule&&this._delegate.spreadsheetCSSStyleDeclarationSectionStartEditingAdjacentRule(this,t)}spreadsheetCSSStyleDeclarationEditorPropertyBlur(e,t){this._isMousePressed||this._propertiesEditor.deselectProperties()}spreadsheetCSSStyleDeclarationEditorPropertyMouseEnter(e,t){if(this._isMousePressed){let i=parseInt(t.element.dataset.propertyIndex);this._propertiesEditor.selectProperties(this._mouseDownIndex,i)}}spreadsheetCSSStyleDeclarationEditorSelectProperty(e){this._delegate&&this._delegate.spreadsheetCSSStyleDeclarationSectionSelectProperty&&this._delegate.spreadsheetCSSStyleDeclarationSectionSelectProperty(e)}applyFilter(e){this._filterText=e,this.didInitialLayout&&(this._element.classList.remove(WI.GeneralStyleDetailsSidebarPanel.NoFilterMatchInSectionClassName),this._propertiesEditor.applyFilter(this._filterText))}_discardSelectorChange(){this._renderSelector()}_renderSelector(){this._selectorElement.removeChildren(),this._selectorElements=[];let e=(s,a)=>{console.assert(s instanceof WI.CSSSelector);let d=this._selectorElement.appendChild(document.createElement("span"));if(d.textContent=s.text,a&&d.classList.add(WI.SpreadsheetCSSStyleDeclarationSection.MatchedSelectorElementStyleClassName),s.specificity){let p=s.specificity.map(_=>_.toLocaleString()),f=WI.UIString("Specificity: (%d, %d, %d)").format(...p);s.dynamic&&(f+=`
`,this._style.inherited?f+=WI.UIString("Dynamically calculated for the parent element"):f+=WI.UIString("Dynamically calculated for the selected element")),d.title=f}else if(s.dynamic){let p=WI.UIString("Specificity: No value for selected element");p+=`
`,p+=WI.UIString("Dynamically calculated for the selected element and did not match"),d.title=p}this._selectorElements.push(d)},t=s=>{let a=this._selectorElement.appendChild(document.createElement("span"));a.textContent=s,a.classList.add(WI.SpreadsheetCSSStyleDeclarationSection.MatchedSelectorElementStyleClassName)};switch(this._style.type){case WI.CSSStyleDeclaration.Type.Rule:console.assert(this._style.ownerRule);var i=this._style.ownerRule.selectors,n=this._style.ownerRule.matchedSelectorIndices;if(i.length)for(let s=0;s<i.length;++s)e(i[s],n.includes(s)),s<i.length-1&&this._selectorElement.append(", ");else t(this._style.ownerRule.selectorText);break;case WI.CSSStyleDeclaration.Type.Inline:this._selectorElement.textContent=WI.UIString("Style Attribute","CSS properties defined via HTML style attribute"),this._selectorElement.classList.add("style-attribute");break;case WI.CSSStyleDeclaration.Type.Attribute:t(this._style.node.displayName);break}this._filterText&&this.applyFilter(this._filterText)}_createMediaHeader(){let e=this._style.mediaList;if(!e.length||e.length===1&&(e[0].text==="all"||e[0].text==="screen"))return"";let t=document.createElement("div");t.classList.add("header-media");let i=t.appendChild(document.createElement("div"));return i.className="media-label",i.append("@media "),this._mediaElements=e.map((n,s)=>{s&&i.append(", ");let a=i.appendChild(document.createElement("span"));return a.textContent=n.text,a}),t}_save(e){if(e.stop(),this._style.type!==WI.CSSStyleDeclaration.Type.Rule){InspectorFrontendHost.beep();return}console.assert(this._style.ownerRule instanceof WI.CSSRule),console.assert(this._style.ownerRule.sourceCodeLocation instanceof WI.SourceCodeLocation);let t=this._style.ownerRule.sourceCodeLocation.sourceCode;if(t.type!==WI.Resource.Type.Stylesheet){InspectorFrontendHost.beep();return}let i;if(t.urlComponents.scheme==="data"){let s=WI.networkManager.mainFrame.mainResource;s.urlComponents.lastPathComponent.endsWith(".html")?i=s.url.replace(/\.html$/,"-data.css"):i=s.url.slice(0,-s.urlComponents.lastPathComponent.length)+"data.css"}else i=t.url;const n=e.shiftKey;WI.FileUtilities.save({url:i,content:t.content},n)}_handleMouseDown(e){if(e.button!==0)return;this._wasEditing=this._propertiesEditor.editing||document.activeElement===this._selectorElement;let t=e.target.closest(".property");if(!t)return;this._isMousePressed=!0,e.preventDefault(),this._wasEditing&&document.activeElement&&document.activeElement.blur(),window.addEventListener("click",this._handleWindowClick.bind(this),{capture:!0,once:!0});let i=parseInt(t.dataset.propertyIndex);e.shiftKey&&this._propertiesEditor.hasSelectedProperties()?this._propertiesEditor.extendSelectedProperties(i):(this._propertiesEditor.deselectProperties(),this._mouseDownPoint=WI.Point.fromEvent(e),this._boundHandleWindowMouseMove||(this._boundHandleWindowMouseMove=this._handleWindowMouseMove.bind(this)),window.addEventListener("mousemove",this._boundHandleWindowMouseMove)),t.parentNode?(this._mouseDownIndex=i,this._element.classList.add("selecting")):this._stopSelection()}_handleWindowClick(e){this._propertiesEditor.hasSelectedProperties()&&e.stop(),this._stopSelection()}_handleWindowMouseMove(e){console.assert(this._mouseDownPoint),!(this._mouseDownPoint.distance(WI.Point.fromEvent(e))<8)&&(this._propertiesEditor.hasSelectedProperties()||(console.assert(!isNaN(this._mouseDownIndex)),this._propertiesEditor.selectProperties(this._mouseDownIndex,this._mouseDownIndex)),window.removeEventListener("mousemove",this._boundHandleWindowMouseMove),this._mouseDownPoint=null)}_handleClick(e){if(this._stopSelection(),!(this._wasEditing||this._propertiesEditor.hasSelectedProperties())&&window.getSelection().type!=="Range"){if(e.stop(),e.target.classList.contains(WI.SpreadsheetStyleProperty.StyleClassName)){let t=parseInt(e.target.dataset.propertyIndex);this._propertiesEditor.addBlankProperty(t+1);return}if(e.target===this._headerElement||e.target===this._openBrace){this._propertiesEditor.addBlankProperty(0);return}(e.target===this._element||e.target===this._closeBrace)&&this._propertiesEditor.addBlankProperty(-1)}}_stopSelection(){this._isMousePressed=!1,this._mouseDownIndex=NaN,this._element.classList.remove("selecting"),window.removeEventListener("mousemove",this._boundHandleWindowMouseMove),this._mouseDownPoint=null}_highlightNodesWithSelector(){let e=this._style.node;if(!this._style.ownerRule){WI.domManager.highlightDOMNode(e.id);return}let t=this._selectorElement.textContent.trim();e.frame?WI.domManager.highlightSelector(t,e.frame.id):WI.domManager.highlightSelector(t)}_hideDOMNodeHighlight(){WI.domManager.hideDOMNodeHighlight()}_handleEditorFilterApplied(e){let t=!1;for(let s of this._mediaElements)s.classList.remove(WI.GeneralStyleDetailsSidebarPanel.FilterMatchSectionClassName),s.textContent.includes(this._filterText)&&(s.classList.add(WI.GeneralStyleDetailsSidebarPanel.FilterMatchSectionClassName),t=!0);let i=!1;for(let s of this._selectorElements)s.classList.remove(WI.GeneralStyleDetailsSidebarPanel.FilterMatchSectionClassName),s.textContent.includes(this._filterText)&&(s.classList.add(WI.GeneralStyleDetailsSidebarPanel.FilterMatchSectionClassName),i=!0);let n=e.data.matches||t||i;n||this._element.classList.add(WI.GeneralStyleDetailsSidebarPanel.NoFilterMatchInSectionClassName),this.dispatchEventToListeners(WI.SpreadsheetCSSStyleDeclarationSection.Event.FilterApplied,{matches:n})}};WI.SpreadsheetCSSStyleDeclarationSection.Event={FilterApplied:"spreadsheet-css-style-declaration-section-filter-applied",SelectorWillChange:"spreadsheet-css-style-declaration-section-selector-will-change"};WI.SpreadsheetCSSStyleDeclarationSection.MatchedSelectorElementStyleClassName="matched";WI.SpreadsheetRulesStyleDetailsPanel=class Lr extends WI.StyleDetailsPanel{constructor(e){const t="rules",i="rules",n=WI.UIString("Styles \u2014 Rules");super(e,t,i,n),this.element.dir="ltr",this._headerMap=new Map,this._sections=[],this._newRuleSelector=null,this._ruleMediaAndInherticanceList=[],this._propertyToSelectAndHighlight=null,this._filterText=null,this._shouldRefreshSubviews=!1,this._emptyFilterResultsElement=WI.createMessageTextView(WI.UIString("No Results Found"))}refresh(e){e&&(this._shouldRefreshSubviews=!0,this.needsLayout()),super.refresh(e)}hidden(){for(let e of this._sections)e.hidden();super.hidden()}scrollToSectionAndHighlightProperty(e){if(!this._visible){this._propertyToSelectAndHighlight=e;return}for(let t of this._sections)if(t.highlightProperty(e))return}nodeStylesRefreshed(e){super.nodeStylesRefreshed(e),this._propertyToSelectAndHighlight&&(this.scrollToSectionAndHighlightProperty(this._propertyToSelectAndHighlight),this._propertyToSelectAndHighlight=null)}newRuleButtonClicked(){this.nodeStyles.node.isInUserAgentShadowTree()||this._addNewRule()}newRuleButtonContextMenu(e){if(this.nodeStyles.node.isInUserAgentShadowTree())return;let t=WI.cssManager.styleSheets.filter(p=>p.hasInfo()&&!p.isInlineStyleTag()&&!p.isInlineStyleAttributeStyleSheet());if(!t.length)return;let i=WI.ContextMenu.createFromEvent(e);const n=null,s=!0;i.appendItem(WI.UIString("Available Style Sheets"),n,s);let[a,d]=t.partition(p=>p.isInspectorStyleSheet());console.assert(a.length<=1,"There should never be more than one inspector style sheet"),i.appendItem(WI.UIString("Inspector Style Sheet"),()=>{this._addNewRule(a.length?a[0].id:null)});for(let p of d)i.appendItem(p.displayName,()=>{this._addNewRule(p.id)})}applyFilter(e){if(this._filterText=e,!!this.didInitialLayout){this._filterText&&this.element.classList.add("filter-non-matching");for(let t of this._headerMap.values())t.classList.add(WI.GeneralStyleDetailsSidebarPanel.NoFilterMatchInSectionClassName);for(let t of this._sections)t.applyFilter(this._filterText)}}focusFirstSection(){this.spreadsheetCSSStyleDeclarationSectionStartEditingAdjacentRule(null,1)}focusLastSection(){this.spreadsheetCSSStyleDeclarationSectionStartEditingAdjacentRule(null,-1)}spreadsheetCSSStyleDeclarationSectionSelectProperty(e){this.scrollToSectionAndHighlightProperty(e)}spreadsheetCSSStyleDeclarationSectionStartEditingAdjacentRule(e,t){console.assert(t!==0);let i=this._sections.indexOf(e);for(i<0&&(t<0?i=this._sections.length:t>0&&(i=-1)),i+=t;this._sections[i]!==e;){if(i<0){if(this._delegate&&this._delegate.styleDetailsPanelFocusLastPseudoClassCheckbox){this._delegate.styleDetailsPanelFocusLastPseudoClassCheckbox(this);break}i=this._sections.length-1}else if(i>=this._sections.length){if(this._delegate&&this._delegate.styleDetailsPanelFocusFilterBar){this._delegate.styleDetailsPanelFocusFilterBar(this);break}i=0}let n=this._sections[i];if(n.editable){t<0?n._propertiesEditor.startEditingLastProperty():n.startEditingRuleSelector();break}i+=t}}layout(){if(!this._shouldRefreshSubviews)return;this._shouldRefreshSubviews=!1;let e=this._sections.slice(),t=e.filter(_=>(_[Lr.SectionShowingForNodeSymbol]!==this.nodeStyles.node&&(_[Lr.SectionShowingForNodeSymbol]=null,_[Lr.SectionIndexSymbol]=-1),_[Lr.SectionShowingForNodeSymbol]));if(t.length){for(let _ of e)t.includes(_)||this.removeSubview(_);for(let _ of this._headerMap.values())_.remove()}else this.removeAllSubviews();let i=null,n=null;this._headerMap.clear(),this._sections=[];let s=(_,b)=>{n=this.element.appendChild(document.createElement("h2")),n.classList.add("section-header"),n.append(_),b&&(b instanceof WI.DOMNode?n.append(" ",WI.linkifyNodeReference(b,{maxLength:100,excludeRevealElement:!0})):n.append(" ",WI.CSSManager.displayNameForPseudoId(b)))},a=_=>{if(_.style.inherited&&(!i||i.node!==_.style.node)&&s(WI.UIString("Inherited From","A section of CSS rules matching an ancestor DOM node"),_.style.node),!_.isDescendantOf(this)){let b=this.subviews[this._sections.length];!b||b[Lr.SectionIndexSymbol]===this._sections.length?this.addSubview(_):this.insertSubviewBefore(_,b)}this._sections.push(_),_.needsLayout(),n&&this._headerMap.set(_.style,n),i=_.style},d=_=>{let b=_[Lr.StyleSectionSymbol];b||(b=new WI.SpreadsheetCSSStyleDeclarationSection(this,_),b.addEventListener(WI.SpreadsheetCSSStyleDeclarationSection.Event.FilterApplied,this._handleSectionFilterApplied,this),b.addEventListener(WI.SpreadsheetCSSStyleDeclarationSection.Event.SelectorWillChange,this._handleSectionSelectorWillChange,this),_[Lr.StyleSectionSymbol]=b),this._newRuleSelector===_.selectorText&&_.enabledProperties.length===0&&b.startEditingRuleSelector(),a(b);let w=t.find(S=>S[Lr.SectionIndexSymbol]===this._sections.length-1);w&&a(w)};for(let _ of this.nodeStyles.uniqueOrderedStyles)d(_);let p=null,f=null;InspectorBackend.domains.CSS.PseudoId?(p=InspectorBackend.domains.CSS.PseudoId.Before,f=InspectorBackend.domains.CSS.PseudoId.After):(p=4,f=5);for(let[_,b]of this.nodeStyles.pseudoElements){let w=null;_===p?w=this.nodeStyles.node.beforePseudoElement():_===f&&(w=this.nodeStyles.node.afterPseudoElement()),s(WI.UIString("Pseudo-Element"),w||_);for(let S of WI.DOMNodeStyles.uniqueOrderedStyles(b.orderedStyles))d(S)}this._newRuleSelector=null,this.element.append(this._emptyFilterResultsElement),this._filterText&&this.applyFilter(this._filterText)}filterDidChange(e){super.filterDidChange(e),this.applyFilter(e.filters.text)}_handleSectionFilterApplied(e){if(!e.data.matches)return;this.element.classList.remove("filter-non-matching");let t=this._headerMap.get(e.target.style);t&&t.classList.remove(WI.GeneralStyleDetailsSidebarPanel.NoFilterMatchInSectionClassName)}_addNewRule(e){this._newRuleSelector=this.nodeStyles.node.appropriateSelectorFor(!0);const i="";this.nodeStyles.addRule(this._newRuleSelector,i,e)}_handleSectionSelectorWillChange(e){let t=e.target;t[Lr.SectionShowingForNodeSymbol]=this.nodeStyles.node,t[Lr.SectionIndexSymbol]=this._sections.indexOf(t),console.assert(t[Lr.SectionIndexSymbol]>=0)}};WI.SpreadsheetRulesStyleDetailsPanel.StyleSectionSymbol=Symbol("style-section");WI.SpreadsheetRulesStyleDetailsPanel.SectionShowingForNodeSymbol=Symbol("style-showing-for-node");WI.SpreadsheetRulesStyleDetailsPanel.SectionIndexSymbol=Symbol("style-index");WI.SpreadsheetSelectorField=class extends WI.Object{constructor(e,t){super(),this._delegate=e,this._element=t,this._element.classList.add("spreadsheet-selector-field"),this._element.addEventListener("mousedown",this._handleMouseDown.bind(this)),this._element.addEventListener("mouseup",this._handleMouseUp.bind(this)),this._element.addEventListener("blur",this._handleBlur.bind(this)),this._element.addEventListener("keydown",this._handleKeyDown.bind(this)),this._editing=!1,this._handledMouseDown=!1}get editing(){return this._editing}startEditing(){if(this._editing)return;this._editing=!0;let e=this._element;e.classList.add("editing"),e.contentEditable="plaintext-only",e.spellcheck=!1,e.scrollIntoViewIfNeeded(!1),e.textContent=e.textContent,this._selectText(),this.dispatchEventToListeners(WI.SpreadsheetSelectorField.Event.StartedEditing)}stopEditing(){!this._editing||(this._editing=!1,this._element.classList.remove("editing"),this._element.contentEditable=!1,this.dispatchEventToListeners(WI.SpreadsheetSelectorField.Event.StoppedEditing))}_selectText(){window.getSelection().selectAllChildren(this._element)}_handleMouseDown(e){this._handledMouseDown=!0}_handleMouseUp(e){!this._handledMouseDown||(this._handledMouseDown=!1,this.startEditing())}_handleBlur(e){document.activeElement!==this._element&&(this.stopEditing(),this._delegate&&typeof this._delegate.spreadsheetSelectorFieldDidChange=="function"&&this._delegate.spreadsheetSelectorFieldDidChange(null))}_handleKeyDown(e){if(e.key==="Enter"&&!this._editing){e.stop(),this.startEditing();return}if(!!this._editing){if(e.key==="Enter"||e.key==="Tab"){if(e.stop(),this.stopEditing(),this._delegate&&typeof this._delegate.spreadsheetSelectorFieldDidChange=="function"){let t=e.shiftKey&&e.key==="Tab"?"backward":"forward";this._delegate.spreadsheetSelectorFieldDidChange(t)}return}e.key==="Escape"&&(e.stop(),this.stopEditing(),this._delegate&&typeof this._delegate.spreadsheetSelectorFieldDidDiscard=="function"&&this._delegate.spreadsheetSelectorFieldDidDiscard())}}};WI.SpreadsheetSelectorField.Event={StartedEditing:"spreadsheet-selector-field-started-editing",StoppedEditing:"spreadsheet-selector-field-stopped-editing"};WI.SpreadsheetStyleProperty=class extends WI.Object{constructor(e,t,i={}){super(),console.assert(t instanceof WI.CSSProperty),this._delegate=e||null,this._property=t,this._readOnly=i.readOnly||!1,this._element=document.createElement("div"),this._contentElement=null,this._nameElement=null,this._valueElement=null,this._jumpToEffectivePropertyButton=null,this._nameTextField=null,this._valueTextField=null,this._selected=!1,this._hasInvalidVariableValue=!1,this.update(),t.addEventListener(WI.CSSProperty.Event.OverriddenStatusChanged,this.updateStatus,this),t.addEventListener(WI.CSSProperty.Event.Changed,this.updateStatus,this),this._readOnly||(this._element.tabIndex=-1,t.addEventListener(WI.CSSProperty.Event.ModifiedChanged,this.updateStatus,this),this._element.addEventListener("blur",n=>{document.activeElement!==this._element&&this._delegate.spreadsheetStylePropertyBlur&&this._delegate.spreadsheetStylePropertyBlur(n,this)}),this._element.addEventListener("mouseenter",n=>{this._delegate.spreadsheetStylePropertyMouseEnter&&this._delegate.spreadsheetStylePropertyMouseEnter(n,this)}),new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl,WI.KeyboardShortcut.Key.Slash,()=>{this._toggle(),this._select()},this._element),this._element.copyHandler=this)}get element(){return this._element}get property(){return this._property}get enabled(){return this._property.enabled}set index(e){this._element.dataset.propertyIndex=e}get selected(){return this._selected}set selected(e){e!==this._selected&&(this._selected=e,this.updateStatus())}startEditingName(){!this._nameTextField||this._nameTextField.startEditing()}startEditingValue(){!this._valueTextField||this._valueTextField.startEditing()}detached(){this._nameTextField&&this._nameTextField.detached(),this._valueTextField&&this._valueTextField.detached()}hidden(){this._nameTextField&&this._nameTextField.editing?this._nameTextField.element.blur():this._valueTextField&&this._valueTextField.editing&&this._valueTextField.element.blur()}remove(e=null){this._delegate&&typeof this._delegate.spreadsheetStylePropertyWillRemove=="function"&&this._delegate.spreadsheetStylePropertyWillRemove(this),this.element.remove(),e?this._property.replaceWithText(e):this._property.remove(),this.detached()}update(){this.element.removeChildren(),this._isEditable()&&(this._checkboxElement=this.element.appendChild(document.createElement("input")),this._checkboxElement.classList.add("property-toggle"),this._checkboxElement.type="checkbox",this._checkboxElement.checked=this._property.enabled,this._checkboxElement.tabIndex=-1,this._checkboxElement.addEventListener("click",i=>{i.stopPropagation(),this._toggle(),console.assert(this._checkboxElement.checked===this._property.enabled)})),this._contentElement=this.element.appendChild(document.createElement("span")),this._contentElement.className="content",this._property.enabled||this._contentElement.append("/* "),this._nameElement=this._contentElement.appendChild(document.createElement("span")),this._nameElement.classList.add("name"),this._nameElement.textContent=this._property.name;let e=this._contentElement.appendChild(document.createElement("span"));e.classList.add("colon"),e.textContent=": ",this._valueElement=this._contentElement.appendChild(document.createElement("span")),this._valueElement.classList.add("value"),this._renderValue(this._property.rawValue),this._isEditable()&&this._property.enabled&&(this._nameElement.tabIndex=0,this._nameElement.addEventListener("beforeinput",this._handleNameBeforeInput.bind(this)),this._nameElement.addEventListener("paste",this._handleNamePaste.bind(this)),this._nameTextField=new WI.SpreadsheetTextField(this,this._nameElement,this._nameCompletionDataProvider.bind(this)),this._valueElement.tabIndex=0,this._valueElement.addEventListener("beforeinput",this._handleValueBeforeInput.bind(this)),this._valueTextField=new WI.SpreadsheetTextField(this,this._valueElement,this._valueCompletionDataProvider.bind(this))),this._isEditable()&&(this._setupJumpToSymbol(this._nameElement),this._setupJumpToSymbol(this._valueElement));let t=this._contentElement.appendChild(document.createElement("span"));if(t.classList.add("semicolon"),t.textContent=";",this._property.enabled?(this._warningElement=this.element.appendChild(document.createElement("span")),this._warningElement.className="warning"):this._contentElement.append(" */"),!this._property.implicit&&this._property.ownerStyle.type===WI.CSSStyleDeclaration.Type.Computed){let i=this._property.ownerStyle.nodeStyles.effectivePropertyForName(this._property.name);i&&!i.styleSheetTextRange&&(i=i.relatedShorthandProperty);let n=i?i.ownerStyle.ownerRule:null,s=this._contentElement.appendChild(WI.createGoToArrowButton());s.addEventListener("click",a=>{if(!i||!n||!a.altKey){this._delegate.spreadsheetStylePropertyShowProperty&&this._delegate.spreadsheetStylePropertyShowProperty(this,this._property);return}let d=n.sourceCodeLocation.sourceCode,{startLine:p,startColumn:f}=i.styleSheetTextRange;WI.showSourceCodeLocation(d.createSourceCodeLocation(p,f),{ignoreNetworkTab:!0,ignoreSearchTab:!0})}),i&&n&&(s.title=WI.UIString("Option-click to show source"))}this.updateStatus()}updateStatus(){let e=n=>{let s=!1;for(let a of this._property.ownerStyle.enabledProperties)if(a===n)s=!0;else if(a.name===n.name&&s)return!0;return!1},t=[WI.SpreadsheetStyleProperty.StyleClassName],i="";if(this._property.overridden&&(!this._jumpToEffectivePropertyButton&&this._delegate&&this._delegate.spreadsheetStylePropertySelectByProperty&&WI.settings.experimentalEnableStylesJumpToEffective.value&&(console.assert(this._property.overridingProperty,`Overridden property is missing overridingProperty: ${this._property.formattedText}`),this._property.overridingProperty&&(this._jumpToEffectivePropertyButton=WI.createGoToArrowButton(),this._jumpToEffectivePropertyButton.classList.add("select-effective-property"),this._jumpToEffectivePropertyButton.dataset.value=this._property.overridingProperty.rawValue,this._element.append(this._jumpToEffectivePropertyButton),this._jumpToEffectivePropertyButton.addEventListener("click",n=>{console.assert(this._property.overridingProperty),n.stop(),this._delegate.spreadsheetStylePropertySelectByProperty(this._property.overridingProperty)}))),t.push("overridden"),e(this._property)&&(t.push("has-warning"),i=WI.UIString("Duplicate property"))),this._property.implicit&&t.push("implicit"),this._property.ownerStyle.inherited&&!this._property.inherited&&t.push("not-inherited"),!this._property.valid&&this._property.hasOtherVendorNameOrKeyword())t.push("other-vendor");else if(this._hasInvalidVariableValue||!this._property.valid&&this._property.value!==""){let n=!1;WI.CSSCompletions.cssNameCompletions&&(n=WI.CSSCompletions.cssNameCompletions.isValidPropertyName(this._property.name)),t.push("has-warning"),n?(t.push("invalid-value"),i=WI.UIString("Unsupported property value")):(t.push("invalid-name"),i=WI.UIString("Unsupported property name"))}this._property.enabled||t.push("disabled"),this._property.modified&&this._property.name&&this._property.rawValue&&t.push("modified"),this._selected&&t.push("selected"),this._element.className=t.join(" "),this._element.title=i}applyFilter(e){let t=this._nameElement.textContent.includes(e);this._nameElement.classList.toggle(WI.GeneralStyleDetailsSidebarPanel.FilterMatchSectionClassName,!!t);let i=this._valueElement.textContent.includes(e);this._valueElement.classList.toggle(WI.GeneralStyleDetailsSidebarPanel.FilterMatchSectionClassName,!!i);let n=t||i;return this._contentElement.classList.toggle(WI.GeneralStyleDetailsSidebarPanel.NoFilterMatchInPropertyClassName,!n),n}handleCopyEvent(e){this._delegate.spreadsheetStylePropertyCopy(e,this)}spreadsheetTextFieldWillStartEditing(e){let t=e===this._nameTextField;e.value=t?this._property.name:this._property.rawValue}spreadsheetTextFieldDidChange(e){e===this._valueTextField?this._handleValueChange():e===this._nameTextField&&this._handleNameChange()}spreadsheetTextFieldDidCommit(e,{direction:t}){let i=!1,n=e===this._nameTextField;if((!this._property.name||!this._property.rawValue&&!n&&t==="forward")&&(i=!0),!n&&!i&&this._renderValue(this._property.rawValue),t==="forward"){if(n&&!i){this._valueTextField.startEditing();return}}else if(!n){this._nameTextField.startEditing();return}typeof this._delegate.spreadsheetStylePropertyFocusMoved=="function"&&this._delegate.spreadsheetStylePropertyFocusMoved(this,{direction:t,willRemoveProperty:i}),i&&this.remove()}spreadsheetTextFieldDidBlur(e,t,i){if(t.relatedTarget!==this._nameElement&&t.relatedTarget!==this._valueElement&&(!this._nameTextField.value.trim()||!this._valueTextField.value.trim())){this.remove();return}e===this._valueTextField&&this._renderValue(this._property.rawValue),typeof this._delegate.spreadsheetStylePropertyFocusMoved=="function"&&this._delegate.spreadsheetStylePropertyFocusMoved(this,{direction:null}),i&&window.DOMAgent&&DOMAgent.markUndoableState()}spreadsheetTextFieldDidBackspace(e){e===this._nameTextField?this.spreadsheetTextFieldDidCommit(e,{direction:"backward"}):e===this._valueTextField&&this._nameTextField.startEditing()}spreadsheetTextFieldDidPressEsc(e,t){!t?this.remove():this._delegate.spreadsheetStylePropertyDidPressEsc&&this._delegate.spreadsheetStylePropertyDidPressEsc(this)}_toggle(){this._property.commentOut(this.property.enabled),this.update()}_select(){if(this._delegate&&this._delegate.spreadsheetStylePropertySelect){let e=parseInt(this._element.dataset.propertyIndex);this._delegate.spreadsheetStylePropertySelect(e)}}_isEditable(){return!this._readOnly&&this._property.editable}_renderValue(e){this._hasInvalidVariableValue=!1;const t=150;let i=WI.tokenizeCSSValue(e);this._property.enabled&&((this._property.variable||WI.CSSKeywordCompletions.isColorAwareProperty(this._property.name))&&(i=this._addGradientTokens(i),i=this._addColorTokens(i)),i=this._addTimingFunctionTokens(i,"cubic-bezier"),i=this._addTimingFunctionTokens(i,"spring"),i=this._addVariableTokens(i)),i=i.map(n=>{if(n instanceof Element)return n;let s="";if(n.type&&(n.type.includes("string")?s="token-string":n.type.includes("link")?s="token-link":n.type.includes("comment")&&(s="token-comment")),s){let a=document.createElement("span");return a.classList.add(s),a.textContent=n.value.truncateMiddle(t),n.type&&n.type.includes("link")&&a.addEventListener("contextmenu",this._handleLinkContextMenu.bind(this,n)),a}return n.value}),this._valueElement.removeChildren(),this._valueElement.append(...i)}_createInlineSwatch(e,t,i){let n=document.createElement("span"),s=document.createElement("span");s.textContent=t;let a=!this._isEditable(),d=new WI.InlineSwatch(e,i,a);return d.addEventListener(WI.InlineSwatch.Event.ValueChanged,p=>{let f=p.data.value&&p.data.value.toString();!f||(s.textContent=f,this._handleValueChange(),e===WI.InlineSwatch.Type.Variable&&this._renderValue(this._property.rawValue))},this),this._delegate&&typeof this._delegate.stylePropertyInlineSwatchActivated=="function"&&d.addEventListener(WI.InlineSwatch.Event.Activated,()=>{this._delegate.stylePropertyInlineSwatchActivated()}),this._delegate&&typeof this._delegate.stylePropertyInlineSwatchDeactivated=="function"&&d.addEventListener(WI.InlineSwatch.Event.Deactivated,()=>{this._delegate.stylePropertyInlineSwatchDeactivated()}),n.append(d.element,s),n}_addGradientTokens(e){let t=/^(repeating-)?(linear|radial)-gradient$/i,i=[],n=NaN,s=0;for(let a=0;a<e.length;a++){let d=e[a];if(d.type&&d.type.includes("atom")&&t.test(d.value))n=a,s=0;else if(d.value==="("&&!isNaN(n))s++;else if(d.value===")"&&!isNaN(n)){if(s--,s>0)continue;let p=e.slice(n,a+1),f=p.map(b=>b.value).join(""),_=WI.Gradient.fromString(f);_?i.push(this._createInlineSwatch(WI.InlineSwatch.Type.Gradient,f,_)):i.push(...p),n=NaN}else isNaN(n)&&i.push(d)}return i}_addColorTokens(e){let t=[],i=(s,...a)=>{let d=WI.Color.fromString(s);d?t.push(this._createInlineSwatch(WI.InlineSwatch.Type.Color,s,d)):t.push(...a)},n=NaN;for(let s=0;s<e.length;s++){let a=e[s];if(a.type&&a.type.includes("hex-color"))i(a.value,a);else if(WI.Color.FunctionNames.has(a.value)&&a.type&&(a.type.includes("atom")||a.type.includes("keyword")))n=s;else if(isNaN(n)&&a.type&&(a.type.includes("atom")||a.type.includes("keyword")))i(a.value,a);else if(isNaN(n))t.push(a);else{if(a.value!==")")continue;let d=e.slice(n,s+1),p=d.map(f=>f.value).join("");i(p,...d),n=NaN}}return t}_addTimingFunctionTokens(e,t){let i=[],n=NaN,s=0;for(let a=0;a<e.length;a++){let d=e[a];if(d.value===t&&d.type&&d.type.includes("atom"))n=a,s=0;else if(d.value==="("&&!isNaN(n))s++;else if(d.value===")"&&!isNaN(n)){if(s--,s>0)continue;let p=e.slice(n,a+1),f=p.map(w=>w.value).join(""),_,b;t==="cubic-bezier"?(_=WI.CubicBezier.fromString(f),b=WI.InlineSwatch.Type.Bezier):t==="spring"&&(_=WI.Spring.fromString(f),b=WI.InlineSwatch.Type.Spring),_?i.push(this._createInlineSwatch(b,f,_)):i.push(...p),n=NaN}else isNaN(n)&&i.push(d)}return i}_addVariableTokens(e){let t=[],i=NaN,n=0;for(let s=0;s<e.length;s++){let a=e[s];if(a.value==="var"&&a.type&&a.type.includes("atom"))i=s,n=0;else if(a.value==="("&&!isNaN(i))++n;else if(a.value===")"&&!isNaN(i)){if(--n,n>0)continue;let d=e.slice(i,s+1),p=d.map(w=>w.value),f=p.find((w,S)=>w.startsWith("--")&&/\bvariable-2\b/.test(d[S].type));const _=!0;let b=this._property.ownerStyle.nodeStyles.computedStyle.propertyForName(f,_);if(b){let w=b.value.trim();t.push(this._createInlineSwatch(WI.InlineSwatch.Type.Variable,p.join(""),w))}else this._hasInvalidVariableValue=!0,t.push(...d);i=NaN}else isNaN(i)&&t.push(a)}return t}_handleNameChange(){this._property.name=this._nameElement.textContent.trim()}_handleValueChange(){this._property.rawValue=this._valueElement.textContent.trim()}_handleNameBeforeInput(e){e.data!==":"||e.inputType!=="insertText"||(e.preventDefault(),this._nameTextField.discardCompletion(),this._valueTextField.startEditing())}_handleNamePaste(e){let t=e.clipboardData.getData("text/plain");!t||!t.includes(":")||(e.preventDefault(),this.remove(t),this._delegate.spreadsheetStylePropertyAddBlankPropertySoon&&this._delegate.spreadsheetStylePropertyAddBlankPropertySoon(this,{index:parseInt(this._element.dataset.propertyIndex)+1}))}_nameCompletionDataProvider(e,t={}){let i;return!e&&t.allowEmptyPrefix?i=WI.CSSCompletions.cssNameCompletions.values:i=WI.CSSCompletions.cssNameCompletions.startsWith(e),{prefix:e,completions:i}}_handleValueBeforeInput(e){if(e.data!==";"||e.inputType!=="insertText")return;let t=this._valueTextField.valueWithoutSuggestion(),i=window.getSelection();!i.rangeCount||i.getRangeAt(0).endOffset!==t.length||WI.CSSCompletions.completeUnbalancedValue(t)||(e.preventDefault(),this._valueTextField.stopEditing(),this.spreadsheetTextFieldDidCommit(this._valueTextField,{direction:"forward"}))}_valueCompletionDataProvider(e){let t=e.match(/[a-z0-9()-]+$/i);if(!t&&e)return{completions:[],prefix:""};e=t?t[0]:"";let i=this._nameElement.textContent.trim();return{prefix:e,completions:WI.CSSKeywordCompletions.forProperty(i).startsWith(e)}}_setupJumpToSymbol(e){e.addEventListener("mousedown",t=>{if(t.button!==0||!WI.modifierKeys.metaKey||e.isContentEditable)return;let i=null;if(this._property.ownerStyle.ownerRule&&(i=this._property.ownerStyle.ownerRule.sourceCodeLocation),!i)return;let n=this._property.styleSheetTextRange;const s={ignoreNetworkTab:!0,ignoreSearchTab:!0};let a=i.sourceCode;WI.showSourceCodeLocation(a.createSourceCodeLocation(n.startLine,n.startColumn),s)})}_handleLinkContextMenu(e,t){let i=WI.ContextMenu.createFromEvent(t),n=s=>{let a=this._property.ownerStyle;if(!a)return s;let d=a.ownerStyleSheet;if(!d){let f=a.ownerRule;f&&(d=f.ownerStyleSheet)}if(d){if(d.url)return absoluteURL(s,d.url);let f=d.parentFrame;if(f)return absoluteURL(s,f.url)}let p=a.node;if(!p){let f=a.nodeStyles;if(!f){let _=a.ownerRule;_&&(f=_.nodeStyles)}f&&(p=f.node)}return p&&p.ownerDocument?absoluteURL(s,p.ownerDocument.documentURL):s};WI.appendContextMenuItemsForURL(i,n(e.value))}};WI.SpreadsheetStyleProperty.StyleClassName="property";WI.SpreadsheetTextField=class{constructor(e,t,i){this._delegate=e,this._element=t,this._completionProvider=i||null,this._completionProvider&&(this._suggestionHintElement=document.createElement("span"),this._suggestionHintElement.contentEditable=!1,this._suggestionHintElement.classList.add("completion-hint"),this._suggestionsView=new WI.CompletionSuggestionsView(this,{preventBlur:!0})),this._element.classList.add("spreadsheet-text-field"),this._element.addEventListener("mousedown",this._handleMouseDown.bind(this),!0),this._element.addEventListener("click",this._handleClick.bind(this)),this._element.addEventListener("blur",this._handleBlur.bind(this)),this._element.addEventListener("keydown",this._handleKeyDown.bind(this)),this._element.addEventListener("input",this._handleInput.bind(this)),this._editing=!1,this._valueBeforeEditing="",this._completionPrefix="",this._controlSpaceKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.Control,WI.KeyboardShortcut.Key.Space)}get element(){return this._element}get editing(){return this._editing}get value(){return this._element.textContent}set value(e){this._element.textContent=e}valueWithoutSuggestion(){let e=this._element.textContent;return e.slice(0,e.length-this.suggestionHint.length)}get suggestionHint(){return this._suggestionHintElement.textContent}set suggestionHint(e){this._suggestionHintElement.textContent=e,e?this._reAttachSuggestionHint():this._suggestionHintElement.remove()}startEditing(){this._editing||(this._delegate&&typeof this._delegate.spreadsheetTextFieldWillStartEditing=="function"&&this._delegate.spreadsheetTextFieldWillStartEditing(this),this._editing=!0,this._valueBeforeEditing=this.value,this._element.classList.add("editing"),this._element.contentEditable="plaintext-only",this._element.spellcheck=!1,this._element.scrollIntoViewIfNeeded(!1),this._element.focus(),this._selectText(),this._updateCompletions())}stopEditing(){!this._editing||(this._editing=!1,this._valueBeforeEditing="",this._element.classList.remove("editing"),this._element.contentEditable=!1,this.discardCompletion())}discardCompletion(){if(!this._completionProvider)return;this._suggestionsView.hide();let e=!!this.suggestionHint;this.suggestionHint="",e&&this._delegate&&typeof this._delegate.spreadsheetTextFieldDidChange=="function"&&this._delegate.spreadsheetTextFieldDidChange(this)}detached(){this.discardCompletion(),this._element.remove()}completionSuggestionsSelectedCompletion(e,t=""){this.suggestionHint=t.slice(this._completionPrefix.length),this._reAttachSuggestionHint(),this._delegate&&typeof this._delegate.spreadsheetTextFieldDidChange=="function"&&this._delegate.spreadsheetTextFieldDidChange(this)}completionSuggestionsClickedCompletion(e,t){let n=this.valueWithoutSuggestion().slice(0,-this._completionPrefix.length);this._element.textContent=n+t,window.getSelection().setBaseAndExtent(this._element,t.length,this._element,t.length),this.discardCompletion(),this._delegate&&typeof this._delegate.spreadsheetTextFieldDidChange=="function"&&this._delegate.spreadsheetTextFieldDidChange(this)}_selectText(){window.getSelection().selectAllChildren(this._element)}_discardChange(){this._valueBeforeEditing!==this.value&&(this.value=this._valueBeforeEditing,this._delegate&&typeof this._delegate.spreadsheetTextFieldDidChange=="function"&&this._delegate.spreadsheetTextFieldDidChange(this))}_handleClick(e){this.startEditing()}_handleMouseDown(e){this._editing&&e.stopPropagation()}_handleBlur(e){if(!this._editing||document.activeElement===this._element)return;this._applyCompletionHint(),this.discardCompletion();let t=this._valueBeforeEditing!==this.value;this._delegate.spreadsheetTextFieldDidBlur(this,e,t),this.stopEditing()}_handleKeyDown(e){if(!!this._editing&&!(this._suggestionsView&&this._handleKeyDownForSuggestionView(e))){if(e.key==="Enter"||e.key==="Tab"){e.stop(),this._applyCompletionHint();let t=e.shiftKey&&e.key==="Tab"?"backward":"forward";this._delegate&&typeof this._delegate.spreadsheetTextFieldDidCommit=="function"&&this._delegate.spreadsheetTextFieldDidCommit(this,{direction:t}),this.stopEditing();return}if(e.key==="ArrowUp"||e.key==="ArrowDown"){let t=1;if(e.metaKey?t=100:e.shiftKey?t=10:e.altKey&&(t=.1),e.key==="ArrowDown"&&(t=-t),!WI.incrementElementValue(this._element,t))return;e.stop(),this._delegate&&typeof this._delegate.spreadsheetTextFieldDidChange=="function"&&this._delegate.spreadsheetTextFieldDidChange(this)}if(e.key==="Backspace"&&!this.value){e.stop(),this.stopEditing(),this._delegate&&this._delegate.spreadsheetTextFieldDidBackspace&&this._delegate.spreadsheetTextFieldDidBackspace(this);return}if(this._controlSpaceKeyboardShortcut.matchesEvent(e)){e.stop(),this._suggestionsView.visible?this._suggestionsView.hide():this._updateCompletions(!0);return}e.key==="Escape"&&(e.stop(),this._discardChange(),window.getSelection().removeAllRanges(),this._delegate&&this._delegate.spreadsheetTextFieldDidPressEsc&&this._delegate.spreadsheetTextFieldDidPressEsc(this,this._valueBeforeEditing))}}_handleKeyDownForSuggestionView(e){if((e.key==="ArrowDown"||e.key==="ArrowUp")&&this._suggestionsView.visible)return e.stop(),e.key==="ArrowDown"?this._suggestionsView.selectNext():this._suggestionsView.selectPrevious(),this._showSuggestionsView(),this._delegate&&typeof this._delegate.spreadsheetTextFieldDidChange=="function"&&this._delegate.spreadsheetTextFieldDidChange(this),!0;if(e.key==="ArrowRight"&&this.suggestionHint){let t=window.getSelection();if(t.isCollapsed&&(t.focusOffset===this.valueWithoutSuggestion().length||t.focusNode===this._suggestionHintElement))return e.stop(),document.execCommand("insertText",!1,this.suggestionHint),this._updateCompletions(),this._delegate&&typeof this._delegate.spreadsheetTextFieldDidChange=="function"&&this._delegate.spreadsheetTextFieldDidChange(this),!0}if(e.key==="Escape"&&this._suggestionsView.visible){e.stop();let t=!!this.suggestionHint;return this.discardCompletion(),t&&this._delegate&&typeof this._delegate.spreadsheetTextFieldDidChange=="function"&&this._delegate.spreadsheetTextFieldDidChange(this),!0}return e.key==="ArrowLeft"&&(this.suggestionHint||this._suggestionsView.visible)&&(this.discardCompletion(),this._delegate&&typeof this._delegate.spreadsheetTextFieldDidChange=="function"&&this._delegate.spreadsheetTextFieldDidChange(this)),!1}_handleInput(e){!this._editing||(this._updateCompletions(),this._delegate&&typeof this._delegate.spreadsheetTextFieldDidChange=="function"&&this._delegate.spreadsheetTextFieldDidChange(this))}_updateCompletions(e=!1){if(!this._completionProvider)return;let t=this.valueWithoutSuggestion(),{completions:i,prefix:n}=this._completionProvider(t,{allowEmptyPrefix:e});if(this._completionPrefix=n,!i.length){this.discardCompletion();return}if(i.length===1&&i[0]===t){this.discardCompletion();return}if(console.assert(this._element.isConnected,"SpreadsheetTextField already removed from the DOM."),!this._element.isConnected){this._suggestionsView.hide();return}this._suggestionsView.update(i),i.length===1?this._suggestionsView.hide():this._showSuggestionsView(),this._suggestionsView.selectedIndex=NaN,this._completionPrefix?this._suggestionsView.selectNext():this.suggestionHint=""}_showSuggestionsView(){let t=this.valueWithoutSuggestion().length-this._completionPrefix.length,i=this._getCaretRect(t);i?(this._suggestionsView.show(i),this._suggestionsView.hideWhenElementMoves(this._element)):this._suggestionsView.hide()}_getCaretRect(e){let t=window.getSelection(),i=a=>a.x===0&&a.y===0;if(t.rangeCount){let a=t.getRangeAt(0).cloneRange();a.setStart(a.startContainer,e);let d=a.getBoundingClientRect();if(!i(d))return WI.Rect.rectFromClientRect(d)}let n=this._element.getBoundingClientRect();if(i(n))return null;const s=parseInt(getComputedStyle(this._element).paddingLeft)||0;return new WI.Rect(n.left+s,n.top,n.width,n.height)}_applyCompletionHint(){!this._completionProvider||!this.suggestionHint||(this._element.textContent=this._element.textContent)}_reAttachSuggestionHint(){this._suggestionHintElement.parentElement!==this._element&&this._element.append(this._suggestionHintElement)}};WI.StyleOriginView=class{constructor(){this.element=document.createElement("span"),this.element.className="origin"}update(e){switch(this.element.removeChildren(),this.element.removeAttribute("title"),e.type){case WI.CSSStyleDeclaration.Type.Rule:if(console.assert(e.ownerRule),e.ownerRule.sourceCodeLocation){let t={dontFloat:!0,ignoreNetworkTab:!0,ignoreSearchTab:!0};e.ownerStyleSheet.isInspectorStyleSheet()&&(t.nameStyle=WI.SourceCodeLocation.NameStyle.None,t.prefix=WI.UIString("Inspector Style Sheet")+":");let i=WI.createSourceCodeLocationLink(e.ownerRule.sourceCodeLocation,t);this.element.appendChild(i)}else{let t="";switch(e.ownerRule.type){case WI.CSSStyleSheet.Type.Author:t=WI.UIString("Author Stylesheet");break;case WI.CSSStyleSheet.Type.User:t=WI.UIString("User Stylesheet");break;case WI.CSSStyleSheet.Type.UserAgent:t=WI.UIString("User Agent Stylesheet");break;case WI.CSSStyleSheet.Type.Inspector:t=WI.UIString("Web Inspector");break}if(console.assert(t),t&&this.element.append(t),!e.editable){let i="";e.ownerRule&&e.ownerRule.type===WI.CSSStyleSheet.Type.UserAgent?i=WI.UIString("User Agent Stylesheet"):i=WI.UIString("Style rule"),this.element.title=WI.UIString("%s cannot be modified").format(i)}}break;case WI.CSSStyleDeclaration.Type.Attribute:this.element.append(WI.UIString("HTML Attributes"));break}}};WI.SpringEditor=class extends WI.Object{constructor(){super();let e=i=>{this._resetPreviewAnimation(i)};this._element=document.createElement("div"),this._element.classList.add("spring-editor"),this._previewContainer=this._element.createChild("div","spring-preview"),this._previewContainer.title=WI.UIString("Restart animation"),this._previewContainer.addEventListener("mousedown",e),this._previewElement=this._previewContainer.createChild("div"),this._previewElement.addEventListener("transitionend",e),this._timingContainer=this._element.createChild("div","spring-timing"),this._timingElement=this._timingContainer.createChild("div"),this._numberInputContainer=this._element.createChild("div","number-input-container");function t(i,n){let s=this._numberInputContainer.createChild("div",`number-input-row ${i}`);s.createChild("div","number-input-row-title").textContent=n;let a=`_${i}Slider`;this[a]=s.createChild("input"),this[a].type="range",this[a].addEventListener("input",this._handleNumberSliderInput.bind(this)),this[a].addEventListener("mousedown",this._handleNumberSliderMousedown.bind(this)),this[a].addEventListener("mouseup",this._handleNumberSliderMouseup.bind(this));let d=`_${i}Input`;this[d]=s.createChild("input"),this[d].type="number",this[d].addEventListener("input",this._handleNumberInputInput.bind(this)),this[d].addEventListener("keydown",this._handleNumberInputKeydown.bind(this))}t.call(this,"mass",WI.UIString("Mass")),this._massInput.min=this._massSlider.min=1,t.call(this,"stiffness",WI.UIString("Stiffness")),this._stiffnessInput.min=this._stiffnessSlider.min=1,t.call(this,"damping",WI.UIString("Damping")),this._dampingInput.min=this._dampingSlider.min=0,t.call(this,"initialVelocity",WI.UIString("Initial Velocity")),this._spring=new WI.Spring(1,100,10,0)}get element(){return this._element}get spring(){return this._spring}set spring(e){if(!e)return;let t=e instanceof WI.Spring;console.assert(t),t&&(this._spring=e,this._massInput.value=this._massSlider.value=this._spring.mass,this._stiffnessInput.value=this._stiffnessSlider.value=this._spring.stiffness,this._dampingInput.value=this._dampingSlider.value=this._spring.damping,this._initialVelocityInput.value=this._initialVelocitySlider.value=this._spring.initialVelocity,this._resetPreviewAnimation())}_handleNumberInputInput(e){this._changeSpringForInput(e.target,e.target.value)}_handleNumberInputKeydown(e){let t=0;if(e.keyIdentifier==="Up"?t=1:e.keyIdentifier==="Down"&&(t=-1),!t)return;e.shiftKey?t*=10:e.altKey&&(t/=10);let i=parseFloat(e.target.value)||0;this._changeSpringForInput(e.target,i+t),e.preventDefault()}_handleNumberSliderInput(e){this._changeSpringForInput(e.target,e.target.value)}_handleNumberSliderMousedown(e){this._changeSpringForInput(e.target,e.target.value)}_handleNumberSliderMouseup(e){this._changeSpringForInput(e.target,e.target.value)}_changeSpringForInput(e,t){switch(t=parseFloat(t)||0,e){case this._massInput:case this._massSlider:if(this._spring.mass===t)return;this._spring.mass=Math.max(1,t),this._massInput.value=this._massSlider.value=this._spring.mass.maxDecimals(3);break;case this._stiffnessInput:case this._stiffnessSlider:if(this._spring.stiffness===t)return;this._spring.stiffness=Math.max(1,t),this._stiffnessInput.value=this._stiffnessSlider.value=this._spring.stiffness.maxDecimals(3);break;case this._dampingInput:case this._dampingSlider:if(this._spring.damping===t)return;this._spring.damping=Math.max(0,t),this._dampingInput.value=this._dampingSlider.value=this._spring.damping.maxDecimals(3);break;case this._initialVelocityInput:case this._initialVelocitySlider:if(this._spring.initialVelocity===t)return;this._spring.initialVelocity=t,this._initialVelocityInput.value=this._initialVelocitySlider.value=this._spring.initialVelocity.maxDecimals(3);break;default:WI.reportInternalError("Input event fired for unrecognized element");return}this.dispatchEventToListeners(WI.SpringEditor.Event.SpringChanged,{spring:this._spring}),this._resetPreviewAnimation()}_resetPreviewAnimation(e){this._previewContainer.classList.remove("animate"),this._previewElement.style.transitionTimingFunction=null,this._previewElement.style.transform=null,this._timingContainer.classList.remove("animate"),this._timingElement.style.transform=null,e||(this._timingContainer.dataset.duration="0"),this._updatePreviewAnimation(e)}_updatePreviewAnimation(e){if(this._previewContainer.classList.add("animate"),this._previewElement.style.transitionTimingFunction=this._spring.toString(),this._timingContainer.classList.add("animate"),WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?(this._previewElement.style.transform="translateX(-85px)",this._timingElement.style.transform="translateX(-170px)"):(this._previewElement.style.transform="translateX(85px)",this._timingElement.style.transform="translateX(170px)"),!e){let t=this._spring.calculateDuration();this._timingContainer.dataset.duration=t.toFixed(2),this._timingElement.style.transitionDuration=`${t}s`,this._previewElement.style.transitionDuration=`${t}s`}}};WI.SpringEditor.Event={SpringChanged:"spring-editor-spring-changed"};WI.SVGImageResourceClusterContentView=class extends WI.ClusterContentView{constructor(e){super(e),this._resource=e;let t=(i,n,s)=>{let p=new WI.HierarchicalPathComponent(i,n,s,!1,!0);return p.addEventListener(WI.HierarchicalPathComponent.Event.SiblingWasSelected,this._pathComponentSelected,this),p.comparisonData=e,p};this._imagePathComponent=t(WI.UIString("Image"),"image-icon",WI.SVGImageResourceClusterContentView.Identifier.Image),this._sourcePathComponent=t(WI.UIString("Source"),"source-icon",WI.SVGImageResourceClusterContentView.Identifier.Source),this._imagePathComponent.nextSibling=this._sourcePathComponent,this._sourcePathComponent.previousSibling=this._imagePathComponent,this._currentContentViewSetting=new WI.Setting("svg-image-resource-cluster-current-view-"+this._resource.url.hash,WI.SVGImageResourceClusterContentView.Identifier.Image)}get resource(){return this._resource}get selectionPathComponents(){let e=this._contentViewContainer.currentContentView;return e?[this._pathComponentForContentView(e)].concat(e.selectionPathComponents):[]}shown(){super.shown(),!this._shownInitialContent&&this._showContentViewForIdentifier(this._currentContentViewSetting.value)}closed(){super.closed(),this._shownInitialContent=!1}saveToCookie(e){e[WI.SVGImageResourceClusterContentView.ContentViewIdentifierCookieKey]=this._currentContentViewSetting.value}restoreFromCookie(e){let t=this._showContentViewForIdentifier(e[WI.SVGImageResourceClusterContentView.ContentViewIdentifierCookieKey]);typeof t.revealPosition=="function"&&"lineNumber"in e&&"columnNumber"in e&&t.revealPosition(new WI.SourceCodePosition(e.lineNumber,e.columnNumber))}_pathComponentForContentView(e){return console.assert(e),e?e instanceof WI.ImageResourceContentView?this._imagePathComponent:e instanceof WI.TextContentView?this._sourcePathComponent:(console.error("Unknown contentView."),null):null}_identifierForContentView(e){return console.assert(e),e?e instanceof WI.ImageResourceContentView?WI.SVGImageResourceClusterContentView.Identifier.Image:e instanceof WI.TextContentView?WI.SVGImageResourceClusterContentView.Identifier.Source:(console.error("Unknown contentView."),null):null}_showContentViewForIdentifier(e){let t=null;switch(e){case WI.SVGImageResourceClusterContentView.Identifier.Image:t=new WI.ImageResourceContentView(this._resource);break;case WI.SVGImageResourceClusterContentView.Identifier.Source:t=new WI.TextContentView("",this._resource.mimeType),this._resource.requestContent().then(i=>{if(typeof i.content=="string"){t.textEditor.string=i.content;return}blobAsText(i.content,n=>{t.textEditor.string=n})});break;default:t=new WI.ImageResourceContentView(this._resource);break}return this._currentContentViewSetting.value=this._identifierForContentView(t),this.contentViewContainer.showContentView(t)}_pathComponentSelected(e){this._showContentViewForIdentifier(e.data.pathComponent.representedObject)}};WI.SVGImageResourceClusterContentView.ContentViewIdentifierCookieKey="svg-image-resource-cluster-content-view-identifier";WI.SVGImageResourceClusterContentView.Identifier={Image:"image",Source:"source"};WI.StackTraceView=class extends WI.Object{constructor(e){super();var t=this._element=document.createElement("div");t.classList.add("stack-trace");for(var i of e.callFrames)if(!(!i.sourceCodeLocation&&i.functionName===null)&&!(i.isConsoleEvaluation&&!WI.isDebugUIEnabled())){var n=new WI.CallFrameView(i,!0);t.appendChild(n)}}get element(){return this._element}};WI.StackedAreaChart=class extends WI.View{constructor(){super(),this.element.classList.add("stacked-area-chart"),this._chartElement=this.element.appendChild(createSVGElement("svg")),this._chartElement.setAttribute("preserveAspectRatio","none"),this._pathElements=[],this._circleElements=[],this._points=[],this._markers=[],this._size=null}get size(){return this._size}set size(e){this._size&&this._size.equals(e)||(this._size=e,this._chartElement.setAttribute("viewBox",`0 0 ${e.width} ${e.height}`),this.needsLayout())}initializeSections(e){console.assert(!this._pathElements.length,"Should not initialize multiple times"),e.reverse();for(let t=0;t<e.length;++t){let i=this._chartElement.appendChild(createSVGElement("path"));i.classList.add(e[t]),this._pathElements.push(i)}this._pathElements.reverse()}addPointSet(e,t){console.assert(t.length===this._pathElements.length),this._points.push({x:e,ys:t})}clearPoints(){this._points=[]}addPointMarker(e,t){this._markers.push({x:e,y:t})}clearPointMarkers(){this._markers=[]}clear(){this.clearPoints(),this.clearPointMarkers()}layout(){if(super.layout(),this.layoutReason===WI.View.LayoutReason.Resize||!this._size)return;let e=[],t=this._pathElements.length;for(let n=0;n<t;++n)e[n]=[`M 0 ${this._size.height}`];for(let{x:n,ys:s}of this._points)for(let a=0;a<t;++a)e[a].push(`L ${n} ${s[a]}`);let i=this._points.length?this._points.lastValue.x:0;for(let n=0;n<t;++n){e[n].push(`L ${i} ${this._size.height}`),e[n].push("Z");let s=e[n].join(" ");this._pathElements[n].setAttribute("d",s)}if(this._circleElements.length){for(let n of this._circleElements)n.remove();this._circleElements=[]}if(this._markers.length)for(let{x:n,y:s}of this._markers){let a=this._chartElement.appendChild(createSVGElement("circle"));this._circleElements.push(a),a.setAttribute("cx",n),a.setAttribute("cy",s),a.setAttribute("r",3)}}};WI.StackedColumnChart=class extends WI.View{constructor(e){super(),this.element.classList.add("stacked-column-chart"),this._svgElement=this.element.appendChild(createSVGElement("svg")),this._svgElement.setAttribute("preserveAspectRatio","none"),this._sections=null,this._columns=[],this.size=e}get size(){return this._size}set size(e){this._size=e,this._svgElement.setAttribute("viewBox",`0 0 ${e.width} ${e.height}`)}initializeSections(e){console.assert(this._sections===null,"Should not initialize multiple times"),this._sections=e}addColumnSet(e,t,i,n,s){console.assert(n.length===this._sections.length,"Wrong number of sections in columns set",n.length,this._sections.length),this._columns.push({x:e,totalHeight:t,width:i,heights:n,additionalClass:s})}clear(){this._columns=[]}layout(){if(super.layout(),this.layoutReason!==WI.View.LayoutReason.Resize){this._svgElement.removeChildren();for(let{x:e,totalHeight:t,width:i,heights:n,additionalClass:s}of this._columns)for(let a=n.length-1;a>=0;--a){let d=n[a];if(d===n[a-1])continue;let p=t-d,f=this._svgElement.appendChild(createSVGElement("rect"));f.classList.add(this._sections[a]),s&&f.classList.add(s),f.setAttribute("width",i),f.setAttribute("height",d),f.setAttribute("x",e),f.setAttribute("y",p)}}}};WI.StorageSidebarPanel=class extends WI.NavigationSidebarPanel{constructor(){super("storage",WI.UIString("Storage")),this._navigationBar=new WI.NavigationBar,this.addSubview(this._navigationBar);var e="storage-sidebar-",t=[];t.push(new WI.ScopeBarItem(e+"type-all",WI.UIString("All Storage"),{exclusive:!0}));var i=[{identifier:"application-cache",title:WI.UIString("Application Cache"),classes:[WI.ApplicationCacheFrameTreeElement,WI.ApplicationCacheManifestTreeElement]},{identifier:"cookies",title:WI.UIString("Cookies"),classes:[WI.CookieStorageTreeElement]},{identifier:"database",title:WI.UIString("Databases"),classes:[WI.DatabaseHostTreeElement,WI.DatabaseTableTreeElement,WI.DatabaseTreeElement]},{identifier:"indexed-database",title:WI.UIString("Indexed Databases"),classes:[WI.IndexedDatabaseHostTreeElement,WI.IndexedDatabaseObjectStoreTreeElement,WI.IndexedDatabaseTreeElement]},{identifier:"local-storage",title:WI.UIString("Local Storage"),classes:[WI.DOMStorageTreeElement],localStorage:!0},{identifier:"session-storage",title:WI.UIString("Session Storage"),classes:[WI.DOMStorageTreeElement],localStorage:!1}];i.sort(function(b,w){return b.title.extendedLocaleCompare(w.title)});for(var n of i){var s=new WI.ScopeBarItem(e+n.identifier,n.title);s.__storageTypeInfo=n,t.push(s)}this._scopeBar=new WI.ScopeBar("storage-sidebar-scope-bar",t,t[0],!0),this._scopeBar.addEventListener(WI.ScopeBar.Event.SelectionChanged,this._scopeBarSelectionDidChange,this),this._navigationBar.addNavigationItem(this._scopeBar),this._localStorageRootTreeElement=null,this._sessionStorageRootTreeElement=null,this._databaseRootTreeElement=null,this._databaseHostTreeElementMap=new Map,this._indexedDatabaseRootTreeElement=null,this._indexedDatabaseHostTreeElementMap=new Map,this._cookieStorageRootTreeElement=null,this._applicationCacheRootTreeElement=null,this._applicationCacheURLTreeElementMap=new Map,WI.domStorageManager.addEventListener(WI.DOMStorageManager.Event.CookieStorageObjectWasAdded,this._cookieStorageObjectWasAdded,this),WI.domStorageManager.addEventListener(WI.DOMStorageManager.Event.DOMStorageObjectWasAdded,this._domStorageObjectWasAdded,this),WI.domStorageManager.addEventListener(WI.DOMStorageManager.Event.DOMStorageObjectWasInspected,this._domStorageObjectWasInspected,this),WI.domStorageManager.addEventListener(WI.DOMStorageManager.Event.Cleared,this._domStorageCleared,this),WI.databaseManager.addEventListener(WI.DatabaseManager.Event.DatabaseWasAdded,this._databaseWasAdded,this),WI.databaseManager.addEventListener(WI.DatabaseManager.Event.DatabaseWasInspected,this._databaseWasInspected,this),WI.databaseManager.addEventListener(WI.DatabaseManager.Event.Cleared,this._databaseCleared,this),WI.indexedDBManager.addEventListener(WI.IndexedDBManager.Event.IndexedDatabaseWasAdded,this._indexedDatabaseWasAdded,this),WI.indexedDBManager.addEventListener(WI.IndexedDBManager.Event.Cleared,this._indexedDatabaseCleared,this),WI.applicationCacheManager.addEventListener(WI.ApplicationCacheManager.Event.FrameManifestAdded,this._frameManifestAdded,this),WI.applicationCacheManager.addEventListener(WI.ApplicationCacheManager.Event.FrameManifestRemoved,this._frameManifestRemoved,this),WI.applicationCacheManager.addEventListener(WI.ApplicationCacheManager.Event.Cleared,this._applicationCacheCleared,this),this.contentTreeOutline.addEventListener(WI.TreeOutline.Event.SelectionDidChange,this._treeSelectionDidChange,this);for(var a of WI.domStorageManager.domStorageObjects)this._addDOMStorageObject(a);for(var d of WI.domStorageManager.cookieStorageObjects)this._addCookieStorageObject(d);for(var p of WI.databaseManager.databases)this._addDatabase(p);for(var f of WI.indexedDBManager.indexedDatabases)this._addIndexedDatabase(f);for(var _ of WI.applicationCacheManager.applicationCacheObjects)this._addFrameManifest(_)}get minimumWidth(){return this._navigationBar.minimumWidth}showDefaultContentView(){}closed(){super.closed(),WI.domStorageManager.removeEventListener(null,null,this),WI.databaseManager.removeEventListener(null,null,this),WI.indexedDBManager.removeEventListener(null,null,this),WI.applicationCacheManager.removeEventListener(null,null,this)}resetFilter(){this._scopeBar.resetToDefault(),super.resetFilter()}hasCustomFilters(){console.assert(this._scopeBar.selectedItems.length===1);var e=this._scopeBar.selectedItems[0];return e&&!e.exclusive}matchTreeElementAgainstCustomFilters(e,t){console.assert(this._scopeBar.selectedItems.length===1);var i=this._scopeBar.selectedItems[0];if(!i||i.exclusive)return!0;if(e instanceof WI.FolderTreeElement)return!1;function n(){for(var a of i.__storageTypeInfo.classes){if(a===WI.DOMStorageTreeElement&&e instanceof a)return e.representedObject.isLocalStorage()===i.__storageTypeInfo.localStorage;if(e instanceof a)return!0}return!1}var s=n();return s&&(t.expandTreeElement=!0),s}_treeSelectionDidChange(e){if(!this.selected)return;let t=this.contentTreeOutline.selectedTreeElement;if(!!t&&!(t instanceof WI.FolderTreeElement||t instanceof WI.DatabaseHostTreeElement||t instanceof WI.IndexedDatabaseHostTreeElement||t instanceof WI.ApplicationCacheManifestTreeElement)){if(t instanceof WI.StorageTreeElement||t instanceof WI.DatabaseTableTreeElement||t instanceof WI.DatabaseTreeElement||t instanceof WI.ApplicationCacheFrameTreeElement||t instanceof WI.IndexedDatabaseTreeElement||t instanceof WI.IndexedDatabaseObjectStoreTreeElement||t instanceof WI.IndexedDatabaseObjectStoreIndexTreeElement){WI.showRepresentedObject(t.representedObject);return}console.error("Unknown tree element",t)}}_domStorageObjectWasAdded(e){this._addDOMStorageObject(e.data.domStorage)}_addDOMStorageObject(e){var t=new WI.DOMStorageTreeElement(e);e.isLocalStorage()?this._localStorageRootTreeElement=this._addStorageChild(t,this._localStorageRootTreeElement,WI.UIString("Local Storage")):this._sessionStorageRootTreeElement=this._addStorageChild(t,this._sessionStorageRootTreeElement,WI.UIString("Session Storage"))}_domStorageObjectWasInspected(e){var t=e.data.domStorage,i=this.treeElementForRepresentedObject(t);i.revealAndSelect(!0)}_databaseWasAdded(e){this._addDatabase(e.data.database)}_addDatabase(e){console.assert(e instanceof WI.DatabaseObject);let t=this._databaseHostTreeElementMap.get(e.host);t||(t=new WI.DatabaseHostTreeElement(e.host),this._databaseHostTreeElementMap.set(e.host,t),this._databaseRootTreeElement=this._addStorageChild(t,this._databaseRootTreeElement,WI.UIString("Databases")));let i=new WI.DatabaseTreeElement(e);t.appendChild(i)}_databaseWasInspected(e){var t=e.data.database,i=this.treeElementForRepresentedObject(t);i.revealAndSelect(!0)}_indexedDatabaseWasAdded(e){this._addIndexedDatabase(e.data.indexedDatabase)}_addIndexedDatabase(e){console.assert(e instanceof WI.IndexedDatabase);let t=this._indexedDatabaseHostTreeElementMap.get(e.host);t||(t=new WI.IndexedDatabaseHostTreeElement(e.host),this._indexedDatabaseHostTreeElementMap.set(e.host,t),this._indexedDatabaseRootTreeElement=this._addStorageChild(t,this._indexedDatabaseRootTreeElement,WI.UIString("Indexed Databases")));let i=new WI.IndexedDatabaseTreeElement(e);t.appendChild(i)}_cookieStorageObjectWasAdded(e){this._addCookieStorageObject(e.data.cookieStorage)}_addCookieStorageObject(e){console.assert(e instanceof WI.CookieStorageObject);var t=new WI.CookieStorageTreeElement(e);this._cookieStorageRootTreeElement=this._addStorageChild(t,this._cookieStorageRootTreeElement,WI.UIString("Cookies"))}_frameManifestAdded(e){this._addFrameManifest(e.data.frameManifest)}_addFrameManifest(e){console.assert(e instanceof WI.ApplicationCacheFrame);let t=e.manifest,i=t.manifestURL,n=this._applicationCacheURLTreeElementMap.get(i);n||(n=new WI.ApplicationCacheManifestTreeElement(t),this._applicationCacheURLTreeElementMap.set(i,n),this._applicationCacheRootTreeElement=this._addStorageChild(n,this._applicationCacheRootTreeElement,WI.UIString("Application Cache")));let s=new WI.ApplicationCacheFrameTreeElement(e);n.appendChild(s)}_frameManifestRemoved(e){}_compareTreeElements(e,t){return console.assert(e.mainTitle),console.assert(t.mainTitle),(e.mainTitle||"").extendedLocaleCompare(t.mainTitle||"")}_addStorageChild(e,t,i){if(!t)return e.flattened=!0,this.contentTreeOutline.insertChild(e,insertionIndexForObjectInListSortedByFunction(e,this.contentTreeOutline.children,this._compareTreeElements)),e;if(t instanceof WI.StorageTreeElement){console.assert(t.flattened);var n=t;n.flattened=!1,this.contentTreeOutline.removeChild(n);var s=new WI.FolderTreeElement(i);return this.contentTreeOutline.insertChild(s,insertionIndexForObjectInListSortedByFunction(s,this.contentTreeOutline.children,this._compareTreeElements)),s.appendChild(n),s.insertChild(e,insertionIndexForObjectInListSortedByFunction(e,s.children,this._compareTreeElements)),s}return console.assert(t instanceof WI.FolderTreeElement),t.insertChild(e,insertionIndexForObjectInListSortedByFunction(e,t.children,this._compareTreeElements)),t}_closeContentViewForTreeElement(e){let i=this.contentBrowser.contentViewForRepresentedObject(e.representedObject,!0);i&&this.contentBrowser.contentViewContainer.closeContentView(i)}_domStorageCleared(e){this._localStorageRootTreeElement&&this._localStorageRootTreeElement.parent&&(this._closeContentViewForTreeElement(this._localStorageRootTreeElement),this._localStorageRootTreeElement.parent.removeChild(this._localStorageRootTreeElement)),this._sessionStorageRootTreeElement&&this._sessionStorageRootTreeElement.parent&&(this._closeContentViewForTreeElement(this._sessionStorageRootTreeElement),this._sessionStorageRootTreeElement.parent.removeChild(this._sessionStorageRootTreeElement)),this._cookieStorageRootTreeElement&&this._cookieStorageRootTreeElement.parent&&(this._closeContentViewForTreeElement(this._cookieStorageRootTreeElement),this._cookieStorageRootTreeElement.parent.removeChild(this._cookieStorageRootTreeElement)),this._localStorageRootTreeElement=null,this._sessionStorageRootTreeElement=null,this._cookieStorageRootTreeElement=null}_applicationCacheCleared(e){this._applicationCacheRootTreeElement&&this._applicationCacheRootTreeElement.parent&&(this._closeContentViewForTreeElement(this._applicationCacheRootTreeElement),this._applicationCacheRootTreeElement.parent.removeChild(this._applicationCacheRootTreeElement)),this._applicationCacheRootTreeElement=null,this._applicationCacheURLTreeElementMap.clear()}_indexedDatabaseCleared(e){this._indexedDatabaseRootTreeElement&&this._indexedDatabaseRootTreeElement.parent&&(this._closeContentViewForTreeElement(this._indexedDatabaseRootTreeElement),this._indexedDatabaseRootTreeElement.parent.removeChild(this._indexedDatabaseRootTreeElement)),this._indexedDatabaseRootTreeElement=null,this._indexedDatabaseHostTreeElementMap.clear()}_databaseCleared(e){this._databaseRootTreeElement&&this._databaseRootTreeElement.parent&&(this._closeContentViewForTreeElement(this._databaseRootTreeElement),this._databaseRootTreeElement.parent.removeChild(this._databaseRootTreeElement)),this._databaseRootTreeElement=null,this._databaseHostTreeElementMap.clear()}_scopeBarSelectionDidChange(e){this.updateFilter()}};WI.SyntaxHighlightedStyleClassName="syntax-highlighted";WI.syntaxHighlightStringAsDocumentFragment=function(c,e,t){var i=document.createDocumentFragment();function n(s,a){if(!a){i.append(s);return}var d=document.createElement("span");d.className="cm-"+a,d.textContent=s,i.appendChild(d)}return e=parseMIMEType(e).type,CodeMirror.runMode(c,e,n),i};WI.TextContentView=class extends WI.ContentView{constructor(e,t){super(e),this.element.classList.add("text"),this._textEditor=new WI.TextEditor,this._textEditor.addEventListener(WI.TextEditor.Event.NumberOfSearchResultsDidChange,this._numberOfSearchResultsDidChange,this),this._textEditor.addEventListener(WI.TextEditor.Event.FormattingDidChange,this._textEditorFormattingDidChange,this),this._textEditor.addEventListener(WI.TextEditor.Event.MIMETypeChanged,this._handleTextEditorMIMETypeChanged,this),this.addSubview(this._textEditor);var i=WI.UIString("Pretty print"),n=WI.UIString("Original formatting");this._prettyPrintButtonNavigationItem=new WI.ActivateButtonNavigationItem("pretty-print",i,n,"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 13'%3e %3cpath d='M 5 0.5 L 2.5 1 L 2.5 5 L 1.5 6.5 L 2.5 8 L 2.5 12 L 5 12.5' fill='none' stroke='currentColor' stroke-linecap='square'/%3e %3cpath d='M 8 0.5 L 10.5 1 L 10.5 5 L 11.5 6.5 L 10.5 8 L 10.5 12 L 8 12.5' fill='none' stroke='currentColor' stroke-linecap='square'/%3e %3c/svg%3e",13,13),this._prettyPrintButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._togglePrettyPrint,this),this._prettyPrintButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low;var s=WI.UIString("Show type information"),a=WI.UIString("Hide type information");this._showTypesButtonNavigationItem=new WI.ActivateButtonNavigationItem("show-types",s,a,"data:image/svg+xml,%3c%3fxml version='1.0'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 14'%3e %3crect fill='none' stroke='currentColor' x='0.5' y='0.5' width='12' height='13' rx='2'/%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='square' d='M 6.5 5.5 L 6.5 9.5 M 4.0 4.5 L 9.0 4.5'/%3e %3c/svg%3e",13,14),this._showTypesButtonNavigationItem.enabled=!1,this._showTypesButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low;let d=WI.UIString("Fade unexecuted code"),p=WI.UIString("Do not fade unexecuted code");this._codeCoverageButtonNavigationItem=new WI.ActivateButtonNavigationItem("code-coverage",d,p,"data:image/svg+xml,%3c%3fxml version='1.0'%3f%3e %3c!-- Copyright %c2%a9 2016 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 14'%3e %3crect fill='none' stroke='currentColor' x='0.5' y='0.5' width='12' height='13' rx='2'/%3e %3cpath fill='none' stroke='currentColor' stroke-width='1' d='M9 5.5s0-1.5-2.5-1.5C3 4 3 10 6.5 10c2.5 0 2.5-1.5 2.5-1.5'/%3e %3c/svg%3e",13,14),this._codeCoverageButtonNavigationItem.enabled=!1,this._codeCoverageButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._textEditor.readOnly=!0,this._textEditor.mimeType=t,this._textEditor.string=e,this._prettyPrintButtonNavigationItem.enabled=this._textEditor.canBeFormatted()}get textEditor(){return this._textEditor}get navigationItems(){return[this._prettyPrintButtonNavigationItem,this._showTypesButtonNavigationItem,this._codeCoverageButtonNavigationItem]}revealPosition(e,t,i){this._textEditor.revealPosition(e,t,i)}shown(){super.shown(),this._textEditor.shown()}hidden(){super.hidden(),this._textEditor.hidden()}get supportsSave(){return!0}get saveData(){return{url:WI.FileUtilities.inspectorURLForFilename(WI.UIString("Untitled")+".txt"),content:this._textEditor.string,forceSaveAs:!0}}get supportsSearch(){return!0}get numberOfSearchResults(){return this._textEditor.numberOfSearchResults}get hasPerformedSearch(){return this._textEditor.currentSearchQuery!==null}set automaticallyRevealFirstSearchResult(e){this._textEditor.automaticallyRevealFirstSearchResult=e}performSearch(e){this._textEditor.performSearch(e)}searchCleared(){this._textEditor.searchCleared()}searchQueryWithSelection(){return this._textEditor.searchQueryWithSelection()}revealPreviousSearchResult(e){this._textEditor.revealPreviousSearchResult(e)}revealNextSearchResult(e){this._textEditor.revealNextSearchResult(e)}_togglePrettyPrint(e){var t=!this._prettyPrintButtonNavigationItem.activated;this._textEditor.updateFormattedState(t)}_textEditorFormattingDidChange(e){this._prettyPrintButtonNavigationItem.activated=this._textEditor.formatted}_handleTextEditorMIMETypeChanged(e){this._prettyPrintButtonNavigationItem.enabled=this._textEditor.canBeFormatted()}_numberOfSearchResultsDidChange(e){this.dispatchEventToListeners(WI.ContentView.Event.NumberOfSearchResultsDidChange)}};WI.TextNavigationItem=class extends WI.NavigationItem{constructor(e,t){super(e),console.assert(e),this._element.classList.add("text"),this._element.textContent=t||""}get text(){return this._element.textContent}set text(e){this._element.textContent=e||""}};WI.TextResourceContentView=class extends WI.ResourceContentView{constructor(e){super(e,"text"),e.addEventListener(WI.SourceCode.Event.ContentDidChange,this._sourceCodeContentDidChange,this);var t=WI.UIString("Pretty print"),i=WI.UIString("Original formatting");this._prettyPrintButtonNavigationItem=new WI.ActivateButtonNavigationItem("pretty-print",t,i,"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 13'%3e %3cpath d='M 5 0.5 L 2.5 1 L 2.5 5 L 1.5 6.5 L 2.5 8 L 2.5 12 L 5 12.5' fill='none' stroke='currentColor' stroke-linecap='square'/%3e %3cpath d='M 8 0.5 L 10.5 1 L 10.5 5 L 11.5 6.5 L 10.5 8 L 10.5 12 L 8 12.5' fill='none' stroke='currentColor' stroke-linecap='square'/%3e %3c/svg%3e",13,13),this._prettyPrintButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._togglePrettyPrint,this),this._prettyPrintButtonNavigationItem.enabled=!1,this._prettyPrintButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low;var n=WI.UIString("Show type information"),s=WI.UIString("Hide type information");this._showTypesButtonNavigationItem=new WI.ActivateButtonNavigationItem("show-types",n,s,"data:image/svg+xml,%3c%3fxml version='1.0'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 14'%3e %3crect fill='none' stroke='currentColor' x='0.5' y='0.5' width='12' height='13' rx='2'/%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='square' d='M 6.5 5.5 L 6.5 9.5 M 4.0 4.5 L 9.0 4.5'/%3e %3c/svg%3e",13,14),this._showTypesButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._toggleTypeAnnotations,this),this._showTypesButtonNavigationItem.enabled=!1,this._showTypesButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,WI.settings.showJavaScriptTypeInformation.addEventListener(WI.Setting.Event.Changed,this._showJavaScriptTypeInformationSettingChanged,this);let a=WI.UIString("Fade unexecuted code"),d=WI.UIString("Do not fade unexecuted code");this._codeCoverageButtonNavigationItem=new WI.ActivateButtonNavigationItem("code-coverage",a,d,"data:image/svg+xml,%3c%3fxml version='1.0'%3f%3e %3c!-- Copyright %c2%a9 2016 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 13 14'%3e %3crect fill='none' stroke='currentColor' x='0.5' y='0.5' width='12' height='13' rx='2'/%3e %3cpath fill='none' stroke='currentColor' stroke-width='1' d='M9 5.5s0-1.5-2.5-1.5C3 4 3 10 6.5 10c2.5 0 2.5-1.5 2.5-1.5'/%3e %3c/svg%3e",13,14),this._codeCoverageButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._toggleUnexecutedCodeHighlights,this),this._codeCoverageButtonNavigationItem.enabled=!1,this._codeCoverageButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,WI.settings.enableControlFlowProfiler.addEventListener(WI.Setting.Event.Changed,this._enableControlFlowProfilerSettingChanged,this),this._textEditor=new WI.SourceCodeTextEditor(e),this._textEditor.addEventListener(WI.TextEditor.Event.ExecutionLineNumberDidChange,this._executionLineNumberDidChange,this),this._textEditor.addEventListener(WI.TextEditor.Event.NumberOfSearchResultsDidChange,this._numberOfSearchResultsDidChange,this),this._textEditor.addEventListener(WI.TextEditor.Event.ContentDidChange,this._textEditorContentDidChange,this),this._textEditor.addEventListener(WI.TextEditor.Event.FormattingDidChange,this._textEditorFormattingDidChange,this),this._textEditor.addEventListener(WI.TextEditor.Event.MIMETypeChanged,this._handleTextEditorMIMETypeChanged,this),this._textEditor.addEventListener(WI.SourceCodeTextEditor.Event.ContentWillPopulate,this._contentWillPopulate,this),this._textEditor.addEventListener(WI.SourceCodeTextEditor.Event.ContentDidPopulate,this._contentDidPopulate,this),this._textEditor.readOnly=!this._shouldBeEditable(),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.ProbeSetAdded,this._probeSetsChanged,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.ProbeSetRemoved,this._probeSetsChanged,this)}get navigationItems(){return[this._prettyPrintButtonNavigationItem,this._showTypesButtonNavigationItem,this._codeCoverageButtonNavigationItem]}get managesOwnIssues(){return!0}get textEditor(){return this._textEditor}get supplementalRepresentedObjects(){let e=WI.debuggerManager.probeSets.filter(function(t){return this._resource.contentIdentifier===t.breakpoint.contentIdentifier},this);return isNaN(this._textEditor.executionLineNumber)||e.push(WI.debuggerManager.activeCallFrame),e}revealPosition(e,t,i){this._textEditor.revealPosition(e,t,i)}shown(){super.shown(),this._textEditor.shown()}hidden(){super.hidden(),this._textEditor.hidden()}closed(){super.closed(),this.resource.removeEventListener(null,null,this),WI.debuggerManager.removeEventListener(null,null,this),WI.settings.showJavaScriptTypeInformation.removeEventListener(null,null,this),WI.settings.enableControlFlowProfiler.removeEventListener(null,null,this)}contentAvailable(e,t){}get supportsSave(){return super.supportsSave||this.resource instanceof WI.CSSStyleSheet}get saveData(){return this.resource instanceof WI.CSSStyleSheet?{url:WI.FileUtilities.inspectorURLForFilename("InspectorStyleSheet.css"),content:this._textEditor.string,forceSaveAs:!0}:{url:this.resource.url,content:this._textEditor.string}}get supportsSearch(){return!0}get numberOfSearchResults(){return this._textEditor.numberOfSearchResults}get hasPerformedSearch(){return this._textEditor.currentSearchQuery!==null}set automaticallyRevealFirstSearchResult(e){this._textEditor.automaticallyRevealFirstSearchResult=e}performSearch(e){this._textEditor.performSearch(e)}searchCleared(){this._textEditor.searchCleared()}searchQueryWithSelection(){return this._textEditor.searchQueryWithSelection()}revealPreviousSearchResult(e){this._textEditor.revealPreviousSearchResult(e)}revealNextSearchResult(e){this._textEditor.revealNextSearchResult(e)}_contentWillPopulate(e){this._textEditor.parentView!==this&&(this.removeLoadingIndicator(),this.addSubview(this._textEditor))}_contentDidPopulate(e){this._prettyPrintButtonNavigationItem.enabled=this._textEditor.canBeFormatted(),this._showTypesButtonNavigationItem.enabled=this._textEditor.canShowTypeAnnotations(),this._showTypesButtonNavigationItem.activated=WI.settings.showJavaScriptTypeInformation.value,this._codeCoverageButtonNavigationItem.enabled=this._textEditor.canShowCoverageHints(),this._codeCoverageButtonNavigationItem.activated=WI.settings.enableControlFlowProfiler.value,this._textEditor.string||this.showGenericNoContentMessage()}_togglePrettyPrint(e){var t=!this._prettyPrintButtonNavigationItem.activated;this._textEditor.updateFormattedState(t)}_toggleTypeAnnotations(e){this._showTypesButtonNavigationItem.enabled=!1,this._textEditor.toggleTypeAnnotations().then(()=>{this._showTypesButtonNavigationItem.enabled=!0})}_toggleUnexecutedCodeHighlights(e){this._codeCoverageButtonNavigationItem.enabled=!1,this._textEditor.toggleUnexecutedCodeHighlights().then(()=>{this._codeCoverageButtonNavigationItem.enabled=!0})}_showJavaScriptTypeInformationSettingChanged(e){this._showTypesButtonNavigationItem.activated=WI.settings.showJavaScriptTypeInformation.value}_enableControlFlowProfilerSettingChanged(e){this._codeCoverageButtonNavigationItem.activated=WI.settings.enableControlFlowProfiler.value}_textEditorFormattingDidChange(e){this._prettyPrintButtonNavigationItem.activated=this._textEditor.formatted}_handleTextEditorMIMETypeChanged(e){this._prettyPrintButtonNavigationItem.enabled=this._textEditor.canBeFormatted()}_sourceCodeContentDidChange(e){this._ignoreSourceCodeContentDidChangeEvent||(this._textEditor.string=this.resource.currentRevision.content)}_textEditorContentDidChange(e){this._ignoreSourceCodeContentDidChangeEvent=!0,WI.branchManager.currentBranch.revisionForRepresentedObject(this.resource).content=this._textEditor.string,delete this._ignoreSourceCodeContentDidChangeEvent}_executionLineNumberDidChange(e){this.dispatchEventToListeners(WI.ContentView.Event.SupplementalRepresentedObjectsDidChange)}_numberOfSearchResultsDidChange(e){this.dispatchEventToListeners(WI.ContentView.Event.NumberOfSearchResultsDidChange)}_probeSetsChanged(e){var t=e.data.probeSet.breakpoint;t.sourceCodeLocation.sourceCode===this.resource&&this.dispatchEventToListeners(WI.ContentView.Event.SupplementalRepresentedObjectsDidChange)}_shouldBeEditable(){return this.resource instanceof WI.CSSStyleSheet||this.resource.type===WI.Resource.Type.Stylesheet&&this.resource.syntheticMIMEType==="text/css"||this.resource.urlComponents.scheme==="file"}};{const c="selected";WI.TextToggleButtonNavigationItem=class extends WI.ButtonNavigationItem{constructor(t,i){super(t,i),this._title=i}get title(){return this._title}get activated(){return this.element.classList.contains(c)}set activated(t){this.element.classList.toggle(c,t)}get additionalClassNames(){return["text-toggle","button"]}}}WI.ThreadTreeElement=class extends WI.GeneralTreeElement{constructor(e){super("thread",e.displayName),this._target=e,this._idleTreeElement=new WI.IdleTreeElement}get target(){return this._target}refresh(){this.removeChildren(),this._updateStatus();let e=WI.debuggerManager.dataForTarget(this._target),t=e.callFrames;if(e.pausing||!t.length){this.appendChild(this._idleTreeElement),this.expand();return}let i=WI.debuggerManager.activeCallFrame,n=null;for(let a of t){let d=new WI.CallFrameTreeElement(a);a===i&&(n=d),this.appendChild(d)}n&&(n.select(!0,!0),n.isActiveCallFrame=!0);let s=e.asyncStackTrace;for(;s&&(console.assert(s.callFrames.length,"StackTrace should have non-empty call frames array."),!!s.callFrames.length);){let a;if(s.topCallFrameIsBoundary)a=s.callFrames[0],console.assert(a.nativeCode&&!a.sourceCodeLocation);else{const f=WI.UIString("(async)"),_=!0;a=new WI.CallFrame(null,null,null,f,null,null,_)}const d=!0;this.appendChild(new WI.CallFrameTreeElement(a,d));let p=s.topCallFrameIsBoundary?1:0;for(let f=p;f<s.callFrames.length;++f)this.appendChild(new WI.CallFrameTreeElement(s.callFrames[f]));if(s.truncated){let f=new WI.GeneralTreeElement("truncated-call-frames",WI.UIString("Call Frames Truncated"));f.selectable=!1,this.appendChild(f)}s=s.parentStackTrace}this.expand()}onattach(){super.onattach(),this.refresh(),this.expand()}populateContextMenu(e,t){let i=WI.debuggerManager.dataForTarget(this._target);e.appendItem(WI.UIString("Resume Thread"),()=>{WI.debuggerManager.continueUntilNextRunLoop(this._target)},!i.paused),super.populateContextMenu(e,t)}_updateStatus(){if(this.status=null,!(!this.element||!WI.debuggerManager.dataForTarget(this._target).paused)){if(!this._statusButton){let t=WI.UIString("Resume Thread");this._statusButton=new WI.TreeElementStatusButton(WI.ImageUtilities.useSVGSymbol("data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3cpath d='M 6.5 2.5 L 6.5 12.5 L 14.5 7.5 L 6.5 2.5 Z'/%3e %3crect x='0.5' y='2.5' width='3' height='10'/%3e %3c/svg%3e","resume",t)),this._statusButton.addEventListener(WI.TreeElementStatusButton.Event.Clicked,()=>{WI.debuggerManager.continueUntilNextRunLoop(this._target)}),this._statusButton.element.addEventListener("mousedown",i=>{i.stopPropagation()})}this.status=this._statusButton.element}}};WI.TimelineRecordBar=class extends WI.Object{constructor(e,t,i){super(),this._delegate=e,this._element=document.createElement("div"),this._element.classList.add("timeline-record-bar"),this._element[WI.TimelineRecordBar.ElementReferenceSymbol]=this,this._element.addEventListener("click",this._handleClick.bind(this)),this.renderMode=i,this.records=t}static createCombinedBars(e,t,i,n){if(!e.length)return;for(var s=i.startTime,a=i.currentTime,d=i.endTime,p=[],f=!1,_=null,b=0;b<e.length;++b){var w=e[b];if(!isNaN(w.startTime)&&!(w.endTime<s)){if(w.startTime>a||w.startTime>d)break;w.usesActiveStartTime&&(f=!0),console.assert(w.usesActiveStartTime===f),console.assert(!_||w.type===_),p.push(w),_=w.type}}if(!p.length)return;if(p.length===1){n(p,WI.TimelineRecordBar.RenderMode.Normal);return}function S(K,q){return K.activeStartTime-q.activeStartTime}var E=t*WI.TimelineRecordBar.MinimumWidthPixels,k=t*WI.TimelineRecordBar.MinimumMarginPixels;if(f){for(var R=NaN,M=NaN,L=[],b=0;b<p.length;++b){var w=p[b];!isNaN(R)&&R+Math.max(M-R,E)+k<=w.startTime&&(n(L,WI.TimelineRecordBar.RenderMode.InactiveOnly),L=[],R=NaN,M=NaN),isNaN(R)&&(R=w.startTime),M=Math.max(M||0,w.activeStartTime),L.push(w)}isNaN(R)||n(L,WI.TimelineRecordBar.RenderMode.InactiveOnly),p.sort(S)}for(var V=NaN,H=NaN,O=[],z=f?"activeStartTime":"startTime",b=0;b<p.length;++b){var w=p[b],s=w[z];!isNaN(V)&&(V+Math.max(H-V,E)+k<=s||isNaN(s)&&!isNaN(H))&&(n(O,WI.TimelineRecordBar.RenderMode.ActiveOnly),O=[],V=NaN,H=NaN),!isNaN(s)&&(isNaN(V)&&(V=s),isNaN(w.endTime)||(H=Math.max(H||0,w.endTime)),O.push(w))}isNaN(V)||n(O,WI.TimelineRecordBar.RenderMode.ActiveOnly)}static fromElement(e){return e[WI.TimelineRecordBar.ElementReferenceSymbol]||null}get element(){return this._element}get selected(){return this._element.classList.contains("selected")}set selected(e){this._element.classList.toggle("selected",!!e)}get renderMode(){return this._renderMode}set renderMode(e){this._renderMode=e||WI.TimelineRecordBar.RenderMode.Normal}get records(){return this._records}set records(e){let t,i,n=!1;if(this._records&&this._records.length){let s=this._records[0];t=s.type,i=s.eventType,n=s.usesActiveStartTime}if(e=e||[],this._records=e,this._records.length){let s=this._records[0];s.type!==t&&(this._element.classList.remove(t),this._element.classList.add(s.type)),s.eventType!==i&&(this._element.classList.remove(i),this._element.classList.add(s.eventType)),s.usesActiveStartTime!==n&&this._element.classList.toggle("has-inactive-segment",s.usesActiveStartTime)}else this._element.classList.remove(t,i,"has-inactive-segment")}refresh(e){if(isNaN(e.secondsPerPixel))return;if(console.assert(e.zeroTime),console.assert(e.startTime),console.assert(e.currentTime),console.assert(e.endTime),console.assert(e.secondsPerPixel),!this._records||!this._records.length)return!1;var t=this._records[0],i=t.startTime;if(isNaN(i))return!1;var n=e.startTime,s=e.endTime,a=e.currentTime,d=this._records.reduce(function(L,V){return Math.max(L,V.endTime)},0);if(i>a||d<n||i>s)return!1;var p=isNaN(d)||d>=a;p&&(d=a);var f=s-n;let _=(i-n)/f,b=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?"right":"left";this._updateElementPosition(this._element,_,b);var w=(d-n)/f-_;if(this._updateElementPosition(this._element,w,"width"),!this._activeBarElement&&this._renderMode!==WI.TimelineRecordBar.RenderMode.InactiveOnly&&(this._activeBarElement=document.createElement("div"),this._activeBarElement.classList.add("segment")),!t.usesActiveStartTime)return this._element.classList.toggle("unfinished",p),this._inactiveBarElement&&this._inactiveBarElement.remove(),this._renderMode===WI.TimelineRecordBar.RenderMode.InactiveOnly?(this._activeBarElement&&this._activeBarElement.remove(),!1):(this._activeBarElement.style.removeProperty(WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?"right":"left"),this._activeBarElement.style.removeProperty("width"),this._activeBarElement.parentNode||this._element.appendChild(this._activeBarElement),!0);if(this._renderMode===WI.TimelineRecordBar.RenderMode.ActiveOnly)var S=this._records.reduce(function(L,V){return Math.min(L,V.activeStartTime)},1/0);else var S=this._records.reduce(function(L,V){return Math.max(L,V.activeStartTime)},0);var E=d-i,k=isNaN(S)||S>=a;if(this._element.classList.toggle("unfinished",k),k)S=a;else if(this._renderMode===WI.TimelineRecordBar.RenderMode.Normal){let L=e.secondsPerPixel*WI.TimelineRecordBar.MinimumWidthPixels;S-i<L&&(S=i,this._inactiveBarElement&&this._inactiveBarElement.remove())}let R=S>i;this._element.classList.toggle("has-inactive-segment",R);let M=(S-i)/E;if(R&&this._renderMode!==WI.TimelineRecordBar.RenderMode.ActiveOnly){this._inactiveBarElement||(this._inactiveBarElement=document.createElement("div"),this._inactiveBarElement.classList.add("segment"),this._inactiveBarElement.classList.add("inactive"));let L=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?"left":"right";this._updateElementPosition(this._inactiveBarElement,1-M,L),this._updateElementPosition(this._inactiveBarElement,M,"width"),this._inactiveBarElement.parentNode||this._element.insertBefore(this._inactiveBarElement,this._element.firstChild)}if(!k&&this._renderMode!==WI.TimelineRecordBar.RenderMode.InactiveOnly){let L=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?"right":"left";this._updateElementPosition(this._activeBarElement,M,L),this._updateElementPosition(this._activeBarElement,1-M,"width"),this._activeBarElement.parentNode||this._element.appendChild(this._activeBarElement)}else this._activeBarElement&&this._activeBarElement.remove();return!0}_updateElementPosition(e,t,i){t*=100;let n=Math.round(t*100);Math.round(parseFloat(e.style[i])*100)!==n&&(e.style[i]=n/100+"%")}_handleClick(e){e.__timelineRecordClickEventHandled=!0,this._delegate.timelineRecordBarClicked&&this._delegate.timelineRecordBarClicked(this)}};WI.TimelineRecordBar.ElementReferenceSymbol=Symbol("timeline-record-bar");WI.TimelineRecordBar.MinimumWidthPixels=4;WI.TimelineRecordBar.MinimumMarginPixels=1;WI.TimelineRecordBar.RenderMode={Normal:"timeline-record-bar-normal-render-mode",InactiveOnly:"timeline-record-bar-inactive-only-render-mode",ActiveOnly:"timeline-record-bar-active-only-render-mode"};WI.TimelineRecordFrame=class extends WI.Object{constructor(e,t){super(),this._element=document.createElement("div"),this._element.classList.add("timeline-record-frame"),this._graphDataSource=e,this._record=t||null,this._filtered=!1}get element(){return this._element}get record(){return this._record}set record(e){this._record=e}get selected(){return this._element.classList.contains("selected")}set selected(e){this.selected!==e&&this._element.classList.toggle("selected")}get filtered(){return this._filtered}set filtered(e){this._filtered!==e&&(this._filtered=e,this._element.classList.toggle("filtered"))}refresh(e){if(!this._record)return!1;var t=this._record.frameIndex,i=Math.floor(e.startTime),n=e.endTime;if(t<i||t>n)return!1;this._element.style.width=1/e.timelineOverview.secondsPerPixel+"px";var s=e.endTime-e.startTime;let a=(t-e.startTime)/s,d=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?"right":"left";return this._updateElementPosition(this._element,a,d),this._updateChildElements(e),!0}_calculateFrameDisplayData(e){var t=e.graphHeightSeconds/e.height*WI.TimelineRecordFrame.MinimumHeightPixels,i=[],n=[],s=null;function a(V){if(V.duration<=t){V.remainder=0;return}var H=Math.roundTo(V.duration,t);V.remainder=Math.max(V.duration-H,0)}function d(){a(s),i.push(s),s.duration<t&&n.push({segment:s,index:i.length-1}),s=null}for(var p in WI.RenderingFrameTimelineRecord.TaskType){var f=WI.RenderingFrameTimelineRecord.TaskType[p],_=this._record.durationForTask(f);_!==0&&(s&&_>=t&&d(),s||(s={taskType:null,longestTaskDuration:0,duration:0,remainder:0}),s.duration+=_,_>s.longestTaskDuration&&(s.taskType=f,s.longestTaskDuration=_),s.duration>=t&&d())}s&&d(),i.length===1&&(i[0].duration=Math.max(i[0].duration,t),n=[]),n.sort(function(V,H){return V.segment.duration-H.segment.duration});for(var b of n){var w=b.segment,S=b.index>0?i[b.index-1]:null,E=b.index<i.length-1?i[b.index+1]:null;console.assert(S||E,"Invisible segment should have at least one adjacent visible segment.");var k,R;if(S&&E?(k=S.remainder>E.remainder?[S,E]:[E,S],R=S.remainder+E.remainder):(k=[S||E],R=k[0].remainder),R<t-w.duration){var M;S&&E?M=S.duration>E.duration?S:E:M=S||E,M.duration+=w.duration,a(M);continue}k.forEach(function(V){if(!(w.duration>=t)){var H=Math.min(t-w.duration,V.remainder);w.duration+=H,V.remainder-=H}})}var L=0;return i=i.filter(function(V){return V.duration<t?!1:(V.duration=Math.roundTo(V.duration,t),L+=V.duration,!0)}),{frameDuration:L,segments:i}}_updateChildElements(e){if(this._element.removeChildren(),console.assert(this._record),!!this._record&&e.graphHeightSeconds!==0){var t=document.createElement("div");t.classList.add("frame"),this._element.appendChild(t),this._record.__displayData&&this._record.__displayData.graphHeightSeconds!==e.graphHeightSeconds&&(this._record.__displayData=null),this._record.__displayData||(this._record.__displayData=this._calculateFrameDisplayData(e),this._record.__displayData.graphHeightSeconds=e.graphHeightSeconds);var i=this._record.__displayData.frameDuration/e.graphHeightSeconds;i>=.95?this._element.classList.add("tall"):this._element.classList.remove("tall"),this._updateElementPosition(t,i,"height");for(var n of this._record.__displayData.segments){var s=document.createElement("div");this._updateElementPosition(s,n.duration/this._record.__displayData.frameDuration,"height"),s.classList.add("duration",n.taskType),t.insertBefore(s,t.firstChild)}}}_updateElementPosition(e,t,i){t*=100;let n=Math.round(t*100);Math.round(parseFloat(e.style[i])*100)!==n&&(e.style[i]=n/100+"%")}};WI.TimelineRecordFrame.MinimumHeightPixels=3;WI.TimelineRecordFrame.MaximumWidthPixels=14;WI.TimelineRecordFrame.MinimumWidthPixels=4;WI.TimelineRecordingContentView=class extends WI.ContentView{constructor(e){super(e),this._recording=e,this.element.classList.add("timeline-recording"),this._timelineOverview=new WI.TimelineOverview(this._recording),this._timelineOverview.addEventListener(WI.TimelineOverview.Event.TimeRangeSelectionChanged,this._timeRangeSelectionChanged,this),this._timelineOverview.addEventListener(WI.TimelineOverview.Event.RecordSelected,this._recordSelected,this),this._timelineOverview.addEventListener(WI.TimelineOverview.Event.TimelineSelected,this._timelineSelected,this),this._timelineOverview.addEventListener(WI.TimelineOverview.Event.EditingInstrumentsDidChange,this._editingInstrumentsDidChange,this),this.addSubview(this._timelineOverview);const t=!0,i=!0;this._timelineContentBrowser=new WI.ContentBrowser(null,this,t,i),this._timelineContentBrowser.addEventListener(WI.ContentBrowser.Event.CurrentContentViewDidChange,this._currentContentViewDidChange,this),this._entireRecordingPathComponent=this._createTimelineRangePathComponent(WI.UIString("Entire Recording")),this._timelineSelectionPathComponent=this._createTimelineRangePathComponent(),this._timelineSelectionPathComponent.previousSibling=this._entireRecordingPathComponent,this._selectedTimeRangePathComponent=this._entireRecordingPathComponent,this._filterBarNavigationItem=new WI.FilterBarNavigationItem,this._filterBarNavigationItem.filterBar.addEventListener(WI.FilterBar.Event.FilterDidChange,this._filterDidChange,this),this._timelineContentBrowser.navigationBar.addNavigationItem(this._filterBarNavigationItem),this.addSubview(this._timelineContentBrowser),WI.sharedApp.debuggableType===WI.DebuggableType.Web&&(this._autoStopCheckboxNavigationItem=new WI.CheckboxNavigationItem("auto-stop-recording",WI.UIString("Stop recording once page loads"),WI.settings.timelinesAutoStop.value),this._autoStopCheckboxNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._autoStopCheckboxNavigationItem.addEventListener(WI.CheckboxNavigationItem.Event.CheckedDidChange,this._handleAutoStopCheckboxCheckedDidChange,this),WI.settings.timelinesAutoStop.addEventListener(WI.Setting.Event.Changed,this._handleTimelinesAutoStopSettingChanged,this)),this._exportButtonNavigationItem=new WI.ButtonNavigationItem("export",WI.UIString("Export"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' d='M 7.5 2 v 7.5'/%3e %3cpath fill='none' stroke='currentColor' d='M 4.5 5 l 3 -3 l 3 3'/%3e %3cpolyline fill='none' stroke='currentColor' points='12.5 9 12.5 12.5 2.5 12.5 2.5 9'/%3e %3c/svg%3e",15,15),this._exportButtonNavigationItem.toolTip=WI.UIString("Export (%s)").format(WI.saveKeyboardShortcut.displayName),this._exportButtonNavigationItem.buttonStyle=WI.ButtonNavigationItem.Style.ImageAndText,this._exportButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._exportButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._exportButtonNavigationItemClicked,this),this._exportButtonNavigationItem.enabled=!1,this._importButtonNavigationItem=new WI.ButtonNavigationItem("import",WI.UIString("Import"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' d='M 7.5 8.5 V 1'/%3e %3cpath fill='none' stroke='currentColor' d='M 10.5 5.5 l -3%2c 3 l -3 -3'/%3e %3cpolyline fill='none' stroke='currentColor' points='12.5 9 12.5 12.5 2.5 12.5 2.5 9'/%3e %3c/svg%3e",15,15),this._importButtonNavigationItem.toolTip=WI.UIString("Import"),this._importButtonNavigationItem.buttonStyle=WI.ButtonNavigationItem.Style.ImageAndText,this._importButtonNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._importButtonNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._importButtonNavigationItemClicked,this),this._clearTimelineNavigationItem=new WI.ButtonNavigationItem("clear-timeline",WI.UIString("Clear Timeline (%s)").format(WI.clearKeyboardShortcut.displayName),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 15 15'%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' d='M 3.5 12.5 l -1 -10 h -1 h 11.9 h -1 l -1 10 H 3.5 z'/%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' d='M 5.5 2 L 5.5 0.5 L 9.5 0.5 L 9.5 2'/%3e %3cline fill='none' stroke='currentColor' stroke-linecap='round' x1='5.5' y1='9.2' x2='9.4' y2='5.3'/%3e %3cline fill='none' stroke='currentColor' stroke-linecap='round' x1='5.5' y1='5.2' x2='9.4' y2='9.2'/%3e %3c/svg%3e",15,15),this._clearTimelineNavigationItem.visibilityPriority=WI.NavigationItem.VisibilityPriority.Low,this._clearTimelineNavigationItem.addEventListener(WI.ButtonNavigationItem.Event.Clicked,this._clearTimeline,this),this._overviewTimelineView=new WI.OverviewTimelineView(e),this._overviewTimelineView.secondsPerPixel=this._timelineOverview.secondsPerPixel,this._progressView=new WI.TimelineRecordingProgressView,this._timelineContentBrowser.addSubview(this._progressView),this._timelineViewMap=new Map,this._pathComponentMap=new Map,this._updating=!1,this._currentTime=NaN,this._lastUpdateTimestamp=NaN,this._startTimeNeedsReset=!0,this._renderingFrameTimeline=null,this._recording.addEventListener(WI.TimelineRecording.Event.InstrumentAdded,this._instrumentAdded,this),this._recording.addEventListener(WI.TimelineRecording.Event.InstrumentRemoved,this._instrumentRemoved,this),this._recording.addEventListener(WI.TimelineRecording.Event.Reset,this._recordingReset,this),this._recording.addEventListener(WI.TimelineRecording.Event.Unloaded,this._recordingUnloaded,this),WI.timelineManager.addEventListener(WI.TimelineManager.Event.CapturingStateChanged,this._handleTimelineCapturingStateChanged,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.Paused,this._debuggerPaused,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.Resumed,this._debuggerResumed,this),WI.ContentView.addEventListener(WI.ContentView.Event.SelectionPathComponentsDidChange,this._contentViewSelectionPathComponentDidChange,this),WI.ContentView.addEventListener(WI.ContentView.Event.SupplementalRepresentedObjectsDidChange,this._contentViewSupplementalRepresentedObjectsDidChange,this),WI.TimelineView.addEventListener(WI.TimelineView.Event.RecordWasFiltered,this._handleTimelineViewRecordFiltered,this),WI.TimelineView.addEventListener(WI.TimelineView.Event.RecordWasSelected,this._handleTimelineViewRecordSelected,this),WI.TimelineView.addEventListener(WI.TimelineView.Event.ScannerShow,this._handleTimelineViewScannerShow,this),WI.TimelineView.addEventListener(WI.TimelineView.Event.ScannerHide,this._handleTimelineViewScannerHide,this),WI.TimelineView.addEventListener(WI.TimelineView.Event.NeedsEntireSelectedRange,this._handleTimelineViewNeedsEntireSelectedRange,this),WI.notifications.addEventListener(WI.Notification.VisibilityStateDidChange,this._inspectorVisibilityStateChanged,this);for(let n of this._recording.instruments)this._instrumentAdded(n);if(this.showOverviewTimelineView(),this._recording.imported){let{startTime:n,endTime:s}=this._recording;this._updateTimes(n,s,s)}}showOverviewTimelineView(){this._timelineContentBrowser.showContentView(this._overviewTimelineView)}showTimelineViewForTimeline(e){if(console.assert(e instanceof WI.Timeline,e),console.assert(this._timelineViewMap.has(e),e),!this._timelineViewMap.has(e))return;let t=this._timelineContentBrowser.showContentView(this._timelineViewMap.get(e));t.didInitialLayout||t.updateLayout()}get supportsSplitContentBrowser(){return!1}get selectionPathComponents(){if(!this._timelineContentBrowser.currentContentView)return[];let e=[],t=this._timelineContentBrowser.currentContentView.representedObject;return t instanceof WI.Timeline&&e.push(this._pathComponentMap.get(t)),e.push(this._selectedTimeRangePathComponent),e}get supplementalRepresentedObjects(){return this._timelineContentBrowser.currentContentView?this._timelineContentBrowser.currentContentView.supplementalRepresentedObjects:[]}get navigationItems(){let e=[];return this._autoStopCheckboxNavigationItem&&e.push(this._autoStopCheckboxNavigationItem),e.push(new WI.DividerNavigationItem),e.push(this._importButtonNavigationItem),e.push(this._exportButtonNavigationItem),e.push(new WI.DividerNavigationItem),e.push(this._clearTimelineNavigationItem),e}get handleCopyEvent(){let e=this._timelineContentBrowser.currentContentView;return e&&typeof e.handleCopyEvent=="function"?e.handleCopyEvent.bind(e):null}get supportsSave(){return this._recording.canExport()}get saveData(){return{customSaveHandler:()=>{this._exportTimelineRecording()}}}get currentTimelineView(){return this._timelineContentBrowser.currentContentView}shown(){super.shown(),this._timelineOverview.shown(),this._timelineContentBrowser.shown(),this._clearTimelineNavigationItem.enabled=!this._recording.readonly&&!isNaN(this._recording.startTime),this._exportButtonNavigationItem.enabled=this._recording.canExport(),this._currentContentViewDidChange(),!this._updating&&WI.timelineManager.activeRecording===this._recording&&WI.timelineManager.isCapturing()&&this._startUpdatingCurrentTime(this._currentTime)}hidden(){super.hidden(),this._timelineOverview.hidden(),this._timelineContentBrowser.hidden(),this._updating&&this._stopUpdatingCurrentTime()}closed(){super.closed(),this._timelineContentBrowser.contentViewContainer.closeAllContentViews(),this._recording.removeEventListener(null,null,this),WI.timelineManager.removeEventListener(null,null,this),WI.debuggerManager.removeEventListener(null,null,this),WI.ContentView.removeEventListener(null,null,this)}canGoBack(){return this._timelineContentBrowser.canGoBack()}canGoForward(){return this._timelineContentBrowser.canGoForward()}goBack(){this._timelineContentBrowser.goBack()}goForward(){this._timelineContentBrowser.goForward()}handleClearShortcut(e){this._clearTimeline()}contentBrowserTreeElementForRepresentedObject(e,t){if(!(t instanceof WI.Timeline)&&!(t instanceof WI.TimelineRecording))return null;let i,n;t instanceof WI.Timeline?(i=WI.TimelineTabContentView.iconClassNameForTimelineType(t.type),n=WI.UIString("Details")):(i=WI.TimelineTabContentView.StopwatchIconStyleClass,n=WI.UIString("Overview"));const s=!1;return new WI.GeneralTreeElement(i,n,t,s)}_currentContentViewDidChange(e){let t,i=this.currentTimelineView;if(i&&i.representedObject.type===WI.TimelineRecord.Type.RenderingFrame?t=WI.TimelineOverview.ViewMode.RenderingFrames:t=WI.TimelineOverview.ViewMode.Timelines,this._timelineOverview.viewMode=t,this._updateTimelineOverviewHeight(),this._updateProgressView(),this._updateFilterBar(),i){this._updateTimelineViewTimes(i),this._filterDidChange();let n=null;i.representedObject instanceof WI.Timeline&&(n=i.representedObject),this._timelineOverview.selectedTimeline=n}this.dispatchEventToListeners(WI.ContentView.Event.SelectionPathComponentsDidChange),this.dispatchEventToListeners(WI.ContentView.Event.NavigationItemsDidChange)}_timelinePathComponentSelected(e){let t=e.data.pathComponent.representedObject;this.showTimelineViewForTimeline(t)}_timeRangePathComponentSelected(e){let t=e.data.pathComponent;if(t===this._selectedTimeRangePathComponent)return;let i=this._timelineOverview.timelineRuler;if(t===this._entireRecordingPathComponent)i.selectEntireRange();else{let n=t.representedObject;i.selectionStartTime=i.zeroTime+n.startValue,i.selectionEndTime=i.zeroTime+n.endValue}}_contentViewSelectionPathComponentDidChange(e){if(!this.visible||e.target!==this._timelineContentBrowser.currentContentView||(this._updateFilterBar(),this.dispatchEventToListeners(WI.ContentView.Event.SelectionPathComponentsDidChange),this.currentTimelineView===this._overviewTimelineView))return;let t=null;if(this.currentTimelineView.selectionPathComponents){let i=this.currentTimelineView.selectionPathComponents.find(n=>n.representedObject instanceof WI.TimelineRecord);t=i?i.representedObject:null}this._timelineOverview.selectRecord(e.target.representedObject,t)}_contentViewSupplementalRepresentedObjectsDidChange(e){e.target===this._timelineContentBrowser.currentContentView&&this.dispatchEventToListeners(WI.ContentView.Event.SupplementalRepresentedObjectsDidChange)}_inspectorVisibilityStateChanged(){if(WI.timelineManager.activeRecording!==this._recording)return;if(!WI.visible&&this._updating){this._stopUpdatingCurrentTime();return}if(!WI.visible)return;let{startTime:e,endTime:t}=this.representedObject;if(!WI.timelineManager.isCapturing()){this._updateTimes(e,t,t);return}this._startUpdatingCurrentTime(t)}_update(e){if(WI.tabBrowser.selectedTabContentView instanceof WI.TimelineTabContentView){if(this._waitingToResetCurrentTime){requestAnimationFrame(this._updateCallback);return}var t=this._recording.startTime,i=this._currentTime||t,n=this._recording.endTime,s=(e-this._lastUpdateTimestamp)/1e3||0;if(i+=s,this._updateTimes(t,i,n),!this._updating&&(i>=n||isNaN(n))){this.visible&&(this._lastUpdateTimestamp=NaN);return}this._lastUpdateTimestamp=e,requestAnimationFrame(this._updateCallback)}}_updateTimes(e,t,i){if(this._startTimeNeedsReset&&!isNaN(e)){this._timelineOverview.startTime=e,this._overviewTimelineView.zeroTime=e;for(let n of this._timelineViewMap.values())n.zeroTime=e;this._startTimeNeedsReset=!1}this._timelineOverview.endTime=Math.max(i,t),this._currentTime=t,this._timelineOverview.currentTime=t,this.currentTimelineView&&this._updateTimelineViewTimes(this.currentTimelineView),this._timelineOverview.updateLayoutIfNeeded(),this.currentTimelineView&&this.currentTimelineView.updateLayoutIfNeeded()}_startUpdatingCurrentTime(e){console.assert(!this._updating),!this._updating&&(!WI.visible||(typeof e=="number"?this._currentTime=e:isNaN(this._currentTime)||(console.assert(!this._waitingToResetCurrentTime),this._waitingToResetCurrentTime=!0,this._recording.addEventListener(WI.TimelineRecording.Event.TimesUpdated,this._recordingTimesUpdated,this)),this._updating=!0,this._updateCallback||(this._updateCallback=this._update.bind(this)),requestAnimationFrame(this._updateCallback)))}_stopUpdatingCurrentTime(){console.assert(this._updating),this._updating=!1,this._waitingToResetCurrentTime&&(this._recording.removeEventListener(WI.TimelineRecording.Event.TimesUpdated,this._recordingTimesUpdated,this),this._waitingToResetCurrentTime=!1)}_handleTimelineCapturingStateChanged(e){let{startTime:t,endTime:i}=e.data;switch(this._updateProgressView(),WI.timelineManager.capturingState){case WI.TimelineManager.CapturingState.Active:this._updating||this._startUpdatingCurrentTime(t),this._clearTimelineNavigationItem.enabled=!this._recording.readonly,this._exportButtonNavigationItem.enabled=!1;break;case WI.TimelineManager.CapturingState.Inactive:this._updating&&this._stopUpdatingCurrentTime(),this.currentTimelineView&&this._updateTimelineViewTimes(this.currentTimelineView),this._exportButtonNavigationItem.enabled=this._recording.canExport();break}}_debuggerPaused(e){this._updating&&this._stopUpdatingCurrentTime()}_debuggerResumed(e){this._updating||this._startUpdatingCurrentTime()}_recordingTimesUpdated(e){if(!!this._waitingToResetCurrentTime){for(var t of this._recording.timelines.values()){var i=t.records.lastValue;!i||(this._currentTime=Math.max(this._currentTime,i.startTime))}this._recording.removeEventListener(WI.TimelineRecording.Event.TimesUpdated,this._recordingTimesUpdated,this),this._waitingToResetCurrentTime=!1}}_handleAutoStopCheckboxCheckedDidChange(e){WI.settings.timelinesAutoStop.value=this._autoStopCheckboxNavigationItem.checked}_handleTimelinesAutoStopSettingChanged(e){this._autoStopCheckboxNavigationItem.checked=WI.settings.timelinesAutoStop.value}_exportTimelineRecording(){let e={version:WI.TimelineRecording.SerializationVersion,recording:this._recording.exportData(),overview:this._timelineOverview.exportData()};if(!e.recording||!e.overview){InspectorFrontendHost.beep();return}let t=null,i=WI.networkManager.mainFrame;i&&(t=i.mainResource.urlComponents.host||i.mainResource.displayName);let n=t?`${t}-recording`:this._recording.displayName;WI.FileUtilities.save({url:WI.FileUtilities.inspectorURLForFilename(n+".json"),content:JSON.stringify(e),forceSaveAs:!0})}_exportButtonNavigationItemClicked(e){this._exportTimelineRecording()}_importButtonNavigationItemClicked(e){WI.FileUtilities.importJSON(t=>WI.timelineManager.processJSON(t))}_clearTimeline(e){this._recording.readonly||(WI.timelineManager.activeRecording===this._recording&&WI.timelineManager.isCapturing()&&WI.timelineManager.stopCapturing(),this._recording.reset())}_updateTimelineOverviewHeight(){if(this._timelineOverview.editingInstruments)this._timelineOverview.element.style.height="";else{let t=23+this._timelineOverview.height+"px";this._timelineOverview.element.style.height=t,this._timelineContentBrowser.element.style.top=t}}_instrumentAdded(e){let t=e instanceof WI.Instrument?e:e.data.instrument;console.assert(t instanceof WI.Instrument,t);let i=this._recording.timelineForInstrument(t);console.assert(!this._timelineViewMap.has(i),i),this._timelineViewMap.set(i,WI.ContentView.createFromRepresentedObject(i,{recording:this._recording})),i.type===WI.TimelineRecord.Type.RenderingFrame&&(this._renderingFrameTimeline=i);let n=WI.TimelineTabContentView.displayNameForTimelineType(i.type),s=WI.TimelineTabContentView.iconClassNameForTimelineType(i.type),a=new WI.HierarchicalPathComponent(n,s,i);a.addEventListener(WI.HierarchicalPathComponent.Event.SiblingWasSelected,this._timelinePathComponentSelected,this),this._pathComponentMap.set(i,a),this._timelineCountChanged()}_instrumentRemoved(e){let t=e.data.instrument;console.assert(t instanceof WI.Instrument);let i=this._recording.timelineForInstrument(t);console.assert(this._timelineViewMap.has(i),i);let n=this._timelineViewMap.take(i);this.currentTimelineView===n&&this.showOverviewTimelineView(),i.type===WI.TimelineRecord.Type.RenderingFrame&&(this._renderingFrameTimeline=null),this._pathComponentMap.delete(i),this._timelineCountChanged()}_timelineCountChanged(){var e=null;for(var t of this._pathComponentMap.values())e&&(e.nextSibling=t,t.previousSibling=e),e=t;this._updateTimelineOverviewHeight()}_recordingReset(e){for(let t of this._timelineViewMap.values())t.reset();this._currentTime=NaN,this._updating||(this._startTimeNeedsReset=!0,this._updateTimes(0,0,0)),this._lastUpdateTimestamp=NaN,this._startTimeNeedsReset=!0,this._recording.removeEventListener(WI.TimelineRecording.Event.TimesUpdated,this._recordingTimesUpdated,this),this._waitingToResetCurrentTime=!1,this._timelineOverview.reset(),this._overviewTimelineView.reset(),this._clearTimelineNavigationItem.enabled=!1,this._exportButtonNavigationItem.enabled=!1}_recordingUnloaded(e){console.assert(!this._updating),WI.timelineManager.removeEventListener(null,null,this)}_timeRangeSelectionChanged(e){if(console.assert(this.currentTimelineView),!this.currentTimelineView)return;this._updateTimelineViewTimes(this.currentTimelineView);let t;if(this._timelineOverview.timelineRuler.entireRangeSelected)t=this._entireRecordingPathComponent;else{let i=this._timelineSelectionPathComponent.representedObject;i.startValue=this.currentTimelineView.startTime,i.endValue=this.currentTimelineView.endTime,this.currentTimelineView instanceof WI.RenderingFrameTimelineView||(i.startValue-=this.currentTimelineView.zeroTime,i.endValue-=this.currentTimelineView.zeroTime),this._updateTimeRangePathComponents(),t=this._timelineSelectionPathComponent}this._selectedTimeRangePathComponent!==t&&(this._selectedTimeRangePathComponent=t,this.dispatchEventToListeners(WI.ContentView.Event.SelectionPathComponentsDidChange))}_recordSelected(e){let{record:t}=e.data;this._selectRecordInTimelineView(t)}_timelineSelected(){let e=this._timelineOverview.selectedTimeline;e?this.showTimelineViewForTimeline(e):this.showOverviewTimelineView()}_updateTimeRangePathComponents(){let e=this._timelineSelectionPathComponent.representedObject,t=e.startValue,i=e.endValue;if(isNaN(t)||isNaN(i)){this._entireRecordingPathComponent.nextSibling=null;return}this._entireRecordingPathComponent.nextSibling=this._timelineSelectionPathComponent;let n;if(this._timelineOverview.viewMode===WI.TimelineOverview.ViewMode.Timelines){let a=Number.secondsToString(t,!0),d=Number.secondsToString(i,!0);if(t<1e-4)n=WI.UIString("%s \u2013 %s").format(a,d);else{let f=Number.secondsToString(i-t,!0);n=WI.UIString("%s \u2013 %s (%s)").format(a,d,f)}}else t+=1,t===i?n=WI.UIString("Frame %d").format(t):n=WI.UIString("Frames %d \u2013 %d").format(t,i);this._timelineSelectionPathComponent.displayName=n,this._timelineSelectionPathComponent.title=n}_createTimelineRangePathComponent(e){let t=new WI.TimelineRange(NaN,NaN),i=new WI.HierarchicalPathComponent(e||enDash,"time-icon",t);return i.addEventListener(WI.HierarchicalPathComponent.Event.SiblingWasSelected,this._timeRangePathComponentSelected,this),i}_updateTimelineViewTimes(e){let t=this._timelineOverview.timelineRuler,i=t.entireRangeSelected,n=this._timelineOverview.selectionStartTime+this._timelineOverview.selectionDuration;i&&(e instanceof WI.RenderingFrameTimelineView?n=this._renderingFrameTimeline.records.length:e instanceof WI.HeapAllocationsTimelineView?n=Number.MAX_VALUE:(n=isNaN(this._recording.endTime)?this._recording.currentTime:this._recording.endTime,n+=t.minimumSelectionDuration)),e.startTime=this._timelineOverview.selectionStartTime,e.currentTime=this._currentTime,e.endTime=n}_editingInstrumentsDidChange(e){let t=this._timelineOverview.editingInstruments;this.element.classList.toggle(WI.TimelineOverview.EditInstrumentsStyleClassName,t),this._updateTimelineOverviewHeight()}_filterDidChange(){!this.currentTimelineView||this.currentTimelineView.updateFilter(this._filterBarNavigationItem.filterBar.filters)}_handleTimelineViewRecordFiltered(e){if(e.target!==this.currentTimelineView)return;console.assert(this.currentTimelineView);let t=this.currentTimelineView.representedObject;if(!(t instanceof WI.Timeline))return;let i=e.data.record,n=e.data.filtered;this._timelineOverview.recordWasFiltered(t,i,n)}_handleTimelineViewRecordSelected(e){if(!this.visible)return;let{record:t}=e.data;this._selectRecordInTimelineOverview(t),this._selectRecordInTimelineView(t)}_selectRecordInTimelineOverview(e){let t=this._recording.timelineForRecordType(e.type);!t||this._timelineOverview.selectRecord(t,e)}_selectRecordInTimelineView(e){for(let t of this._timelineViewMap.values()){let i=e&&t.representedObject.type===e.type;i&&t!==this.currentTimelineView&&this.showTimelineViewForTimeline(t.representedObject),(!e||i)&&t.selectRecord(e)}}_handleTimelineViewScannerShow(e){if(!this.visible)return;let{time:t}=e.data;this._timelineOverview.showScanner(t)}_handleTimelineViewScannerHide(e){!this.visible||this._timelineOverview.hideScanner()}_handleTimelineViewNeedsEntireSelectedRange(e){!this.visible||this._timelineOverview.timelineRuler.selectEntireRange()}_updateProgressView(){let e=WI.timelineManager.isCapturing();this._progressView.visible=e&&this.currentTimelineView&&!this.currentTimelineView.showsLiveRecordingData}_updateFilterBar(){this._filterBarNavigationItem.hidden=!this.currentTimelineView||!this.currentTimelineView.showsFilterBar}};WI.TimelineRecordingProgressView=class extends WI.View{constructor(){super(),this.element.classList.add("recording-progress");let e=document.createElement("div");e.classList.add("status"),e.textContent=WI.UIString("Recording Timeline Data"),this.element.append(e);let t=new WI.IndeterminateProgressSpinner;e.append(t.element),this._stopRecordingButtonElement=document.createElement("button"),this._stopRecordingButtonElement.textContent=WI.UIString("Stop Recording"),this._stopRecordingButtonElement.addEventListener("click",()=>WI.timelineManager.stopCapturing()),this.element.append(this._stopRecordingButtonElement)}get visible(){return this._visible}set visible(e){this._visible!==e&&(this._visible=e,this.element.classList.toggle("hidden",!this._visible))}};WI.TimelineRuler=class extends WI.View{constructor(){super(),this.element.classList.add("timeline-ruler"),this._headerElement=document.createElement("div"),this._headerElement.classList.add("header"),this.element.appendChild(this._headerElement),this._markersElement=document.createElement("div"),this._markersElement.classList.add("markers"),this.element.appendChild(this._markersElement),this._zeroTime=0,this._startTime=0,this._endTime=0,this._duration=NaN,this._secondsPerPixel=0,this._selectionStartTime=0,this._selectionEndTime=Number.MAX_VALUE,this._endTimePinned=!1,this._snapInterval=0,this._allowsClippedLabels=!1,this._allowsTimeRangeSelection=!1,this._minimumSelectionDuration=.01,this._formatLabelCallback=null,this._timeRangeSelectionChanged=!1,this._enabled=!0,this._scannerMarker=null,this._markerElementMap=new Map,this._cachedClientWidth=0}get enabled(){return this._enabled}set enabled(e){this._enabled!==e&&(this._enabled=e,this.element.classList.toggle(WI.TreeElementStatusButton.DisabledStyleClassName,!this._enabled))}get allowsClippedLabels(){return this._allowsClippedLabels}set allowsClippedLabels(e){e=!!e,this._allowsClippedLabels!==e&&(this._allowsClippedLabels=e,this.needsLayout())}set formatLabelCallback(e){console.assert(typeof e=="function"||!e,e),e=e||null,this._formatLabelCallback!==e&&(this._formatLabelCallback=e,this.needsLayout())}get allowsTimeRangeSelection(){return this._allowsTimeRangeSelection}set allowsTimeRangeSelection(e){e=!!e,this._allowsTimeRangeSelection!==e&&(this._allowsTimeRangeSelection=e,e?(this._clickEventListener=this._handleClick.bind(this),this._doubleClickEventListener=this._handleDoubleClick.bind(this),this._mouseDownEventListener=this._handleMouseDown.bind(this),this.element.addEventListener("click",this._clickEventListener),this.element.addEventListener("dblclick",this._doubleClickEventListener),this.element.addEventListener("mousedown",this._mouseDownEventListener),this._leftShadedAreaElement=document.createElement("div"),this._leftShadedAreaElement.classList.add("shaded-area"),this._leftShadedAreaElement.classList.add("left"),this._rightShadedAreaElement=document.createElement("div"),this._rightShadedAreaElement.classList.add("shaded-area"),this._rightShadedAreaElement.classList.add("right"),this._leftSelectionHandleElement=document.createElement("div"),this._leftSelectionHandleElement.classList.add("selection-handle"),this._leftSelectionHandleElement.classList.add("left"),this._leftSelectionHandleElement.addEventListener("mousedown",this._handleSelectionHandleMouseDown.bind(this)),this._rightSelectionHandleElement=document.createElement("div"),this._rightSelectionHandleElement.classList.add("selection-handle"),this._rightSelectionHandleElement.classList.add("right"),this._rightSelectionHandleElement.addEventListener("mousedown",this._handleSelectionHandleMouseDown.bind(this)),this._selectionDragElement=document.createElement("div"),this._selectionDragElement.classList.add("selection-drag"),this._needsSelectionLayout()):(this.element.removeEventListener("click",this._clickEventListener),this.element.removeEventListener("dblclick",this._doubleClickEventListener),this.element.removeEventListener("mousedown",this._mouseDownEventListener),this._clickEventListener=null,this._doubleClickEventListener=null,this._mouseDownEventListener=null,this._leftShadedAreaElement.remove(),this._rightShadedAreaElement.remove(),this._leftSelectionHandleElement.remove(),this._rightSelectionHandleElement.remove(),this._selectionDragElement.remove(),delete this._leftShadedAreaElement,delete this._rightShadedAreaElement,delete this._leftSelectionHandleElement,delete this._rightSelectionHandleElement,delete this._selectionDragElement))}get minimumSelectionDuration(){return this._minimumSelectionDuration}set minimumSelectionDuration(e){this._minimumSelectionDuration=e}get zeroTime(){return this._zeroTime}set zeroTime(e){e=e||0,this._zeroTime!==e&&(this.entireRangeSelected&&(this.selectionStartTime=e),this._zeroTime=e,this.needsLayout())}get startTime(){return this._startTime}set startTime(e){e=e||0,this._startTime!==e&&(this._startTime=e,isNaN(this._duration)||(this._endTime=this._startTime+this._duration),this._currentDividers=null,this.needsLayout())}get duration(){return isNaN(this._duration)?this.endTime-this.startTime:this._duration}get endTime(){return!this._endTimePinned&&this.layoutPending&&this._recalculate(),this._endTime}set endTime(e){e=e||0,this._endTime!==e&&(this._endTime=e,this._endTimePinned=!0,this.needsLayout())}get secondsPerPixel(){return this.layoutPending&&this._recalculate(),this._secondsPerPixel}set secondsPerPixel(e){e=e||0,this._secondsPerPixel!==e&&(this._secondsPerPixel=e,this._endTimePinned=!1,this._currentDividers=null,this._currentSliceTime=0,this.needsLayout())}get snapInterval(){return this._snapInterval}set snapInterval(e){this._snapInterval!==e&&(this._snapInterval=e)}get selectionStartTime(){return this._selectionStartTime}set selectionStartTime(e){e=this._snapValue(e)||0,this._selectionStartTime!==e&&(this._selectionStartTime=e,this._timeRangeSelectionChanged=!0,this._needsSelectionLayout())}get selectionEndTime(){return this._selectionEndTime}set selectionEndTime(e){e=this._snapValue(e)||0,this._selectionEndTime!==e&&(this._selectionEndTime=e,this._timeRangeSelectionChanged=!0,this._needsSelectionLayout())}get entireRangeSelected(){return this._selectionStartTime===this._zeroTime&&this._selectionEndTime===Number.MAX_VALUE}selectEntireRange(){this.selectionStartTime=this._zeroTime,this.selectionEndTime=Number.MAX_VALUE}addMarker(e){if(console.assert(e instanceof WI.TimelineMarker),this._markerElementMap.has(e))return;e.addEventListener(WI.TimelineMarker.Event.TimeChanged,this._timelineMarkerTimeChanged,this);let t=e.time-this._startTime,i=document.createElement("div");switch(i.classList.add(e.type,"marker"),e.type){case WI.TimelineMarker.Type.LoadEvent:i.title=WI.UIString("Load \u2014 %s").format(Number.secondsToString(t));break;case WI.TimelineMarker.Type.DOMContentEvent:i.title=WI.UIString("DOM Content Loaded \u2014 %s").format(Number.secondsToString(t));break;case WI.TimelineMarker.Type.TimeStamp:e.details?i.title=WI.UIString("%s \u2014 %s").format(e.details,Number.secondsToString(t)):i.title=WI.UIString("Timestamp \u2014 %s").format(Number.secondsToString(t));break}this._markerElementMap.set(e,i),this._needsMarkerLayout()}clearMarkers(){for(let[e,t]of this._markerElementMap)e.removeEventListener(null,null,this),t.remove();this._markerElementMap.clear(),this._scannerMarker=null}elementForMarker(e){return this._markerElementMap.get(e)||null}showScanner(e){this._scannerMarker||(this._scannerMarker=new WI.TimelineMarker(e,WI.TimelineMarker.Type.Scanner),this.addMarker(this._scannerMarker)),this._scannerMarker.time=e}hideScanner(){this._scannerMarker&&(this._scannerMarker.time=-1)}updateLayoutIfNeeded(e){if(this.layoutPending){super.updateLayoutIfNeeded(e);return}let t=this._recalculate();t<=0||(this._scheduledMarkerLayoutUpdateIdentifier&&this._updateMarkers(t,this.duration),this._scheduledSelectionLayoutUpdateIdentifier&&this._updateSelection(t,this.duration))}needsLayout(e){this.layoutPending||(this._scheduledMarkerLayoutUpdateIdentifier&&(cancelAnimationFrame(this._scheduledMarkerLayoutUpdateIdentifier),this._scheduledMarkerLayoutUpdateIdentifier=void 0),this._scheduledSelectionLayoutUpdateIdentifier&&(cancelAnimationFrame(this._scheduledSelectionLayoutUpdateIdentifier),this._scheduledSelectionLayoutUpdateIdentifier=void 0),super.needsLayout(e))}layout(){let e=this._recalculate();if(e<=0)return;let t=this.duration,i=e/t,n=Math.round(e/WI.TimelineRuler.MinimumDividerSpacing),s;this._endTimePinned||!this._currentSliceTime?(s=t/n,s=Math.pow(10,Math.ceil(Math.log(s)/Math.LN10)),s*i>=5*WI.TimelineRuler.MinimumDividerSpacing&&(s=s/5),s*i>=2*WI.TimelineRuler.MinimumDividerSpacing&&(s=s/2),this._currentSliceTime=s):s=this._currentSliceTime,n=Math.floor(e*this.secondsPerPixel/s);let a=Math.ceil((this._startTime-this._zeroTime)/s)*s+this._zeroTime,d=a+s*n;this._endTimePinned||++n;let p={count:n,firstTime:a,lastTime:d};if(Object.shallowEqual(p,this._currentDividers)){this._updateMarkers(e,t),this._updateSelection(e,t);return}this._currentDividers=p;let f=this._markersElement.querySelectorAll("."+WI.TimelineRuler.DividerElementStyleClassName),_=this._headerElement.firstChild;for(var b=0;b<=n;++b){if(!_){_=document.createElement("div"),_.className=WI.TimelineRuler.DividerElementStyleClassName,this._headerElement.appendChild(_);let R=document.createElement("div");R.className=WI.TimelineRuler.DividerLabelElementStyleClassName,_.appendChild(R)}let w=f[b];w||(w=document.createElement("div"),w.className=WI.TimelineRuler.DividerElementStyleClassName,this._markersElement.appendChild(w));let S=a+s*b,E=(S-this._startTime)/t;if(!this._allowsClippedLabels){if(E<0)continue;if(E>1)break;if(E*e<WI.TimelineRuler.MinimumLeftDividerSpacing)continue}let k=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?"right":"left";this._updatePositionOfElement(_,E,e,k),this._updatePositionOfElement(w,E,e,k),console.assert(_.firstChild.classList.contains(WI.TimelineRuler.DividerLabelElementStyleClassName)),_.firstChild.textContent=isNaN(S)?"":this._formatDividerLabelText(S-this._zeroTime),_=_.nextSibling}for(;_;){let w=_.nextSibling;_.remove(),_=w}for(;b<f.length;++b)f[b].remove();this._updateMarkers(e,t),this._updateSelection(e,t)}sizeDidChange(){this._cachedClientWidth=this.element.clientWidth}_needsMarkerLayout(){this.layoutPending||this._scheduledMarkerLayoutUpdateIdentifier||(this._scheduledMarkerLayoutUpdateIdentifier=requestAnimationFrame(()=>{this._scheduledMarkerLayoutUpdateIdentifier=void 0;let e=this._cachedClientWidth;e<=0||this._updateMarkers(e,this.duration)}))}_needsSelectionLayout(){!this._allowsTimeRangeSelection||this.layoutPending||this._scheduledSelectionLayoutUpdateIdentifier||(this._scheduledSelectionLayoutUpdateIdentifier=requestAnimationFrame(()=>{this._scheduledSelectionLayoutUpdateIdentifier=void 0;let e=this._cachedClientWidth;e<=0||this._updateSelection(e,this.duration)}))}_recalculate(){let e=this._cachedClientWidth;if(e<=0)return 0;let t;return this._endTimePinned?t=this._endTime-this._startTime:t=e*this._secondsPerPixel,this._secondsPerPixel=t/e,this._endTimePinned||(this._endTime=this._startTime+e*this._secondsPerPixel),e}_updatePositionOfElement(e,t,i,n){t*=this._endTimePinned?100:i;let s=Math.round(t*100);Math.round(parseFloat(e.style[n])*100)!==s&&(e.style[n]=s/100+(this._endTimePinned?"%":"px"))}_updateMarkers(e,t){this._scheduledMarkerLayoutUpdateIdentifier&&(cancelAnimationFrame(this._scheduledMarkerLayoutUpdateIdentifier),this._scheduledMarkerLayoutUpdateIdentifier=void 0);for(let[i,n]of this._markerElementMap){if(i.time<0){n.remove();continue}let s=(i.time-this._startTime)/t,a=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?"right":"left";this._updatePositionOfElement(n,s,e,a),n.parentNode||this._markersElement.appendChild(n)}}_updateSelection(e,t){if(this._scheduledSelectionLayoutUpdateIdentifier&&(cancelAnimationFrame(this._scheduledSelectionLayoutUpdateIdentifier),this._scheduledSelectionLayoutUpdateIdentifier=void 0),this.element.classList.toggle("allows-time-range-selection",this._allowsTimeRangeSelection),!this._allowsTimeRangeSelection)return;if(this.element.classList.toggle("selection-hidden",this.entireRangeSelected),this.entireRangeSelected){this._dispatchTimeRangeSelectionChangedEvent();return}let i=this._selectionStartTime<this._startTime||this._selectionStartTime>this._endTime,n=this._selectionEndTime<this._startTime||this._selectionEndTime>this._endTime;this.element.classList.toggle("both-handles-clamped",i&&n);let s=this._formatDividerLabelText(this._selectionStartTime-this._zeroTime),a=this._formatDividerLabelText(this._selectionEndTime-this._zeroTime),d=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?"right":"left",p=Number.constrain((this._selectionStartTime-this._startTime)/t,0,1);this._updatePositionOfElement(this._leftShadedAreaElement,p,e,"width"),this._updatePositionOfElement(this._leftSelectionHandleElement,p,e,d),this._updatePositionOfElement(this._selectionDragElement,p,e,d),this._leftSelectionHandleElement.classList.toggle("clamped",i),this._leftSelectionHandleElement.classList.toggle("hidden",i&&n&&this._selectionStartTime<this._startTime),this._leftSelectionHandleElement.title=s;let f=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?"left":"right",_=1-Number.constrain((this._selectionEndTime-this._startTime)/t,0,1);this._updatePositionOfElement(this._rightShadedAreaElement,_,e,"width"),this._updatePositionOfElement(this._rightSelectionHandleElement,_,e,f),this._updatePositionOfElement(this._selectionDragElement,_,e,f),this._rightSelectionHandleElement.classList.toggle("clamped",n),this._rightSelectionHandleElement.classList.toggle("hidden",i&&n&&this._selectionEndTime>this._endTime),this._rightSelectionHandleElement.title=a,this._selectionDragElement.parentNode||(this.element.appendChild(this._selectionDragElement),this.element.appendChild(this._leftShadedAreaElement),this.element.appendChild(this._leftSelectionHandleElement),this.element.appendChild(this._rightShadedAreaElement),this.element.appendChild(this._rightSelectionHandleElement)),this._dispatchTimeRangeSelectionChangedEvent()}_formatDividerLabelText(e){return this._formatLabelCallback?this._formatLabelCallback(e):Number.secondsToString(e,!0)}_snapValue(e){return!e||!this.snapInterval?e:Math.round(e/this.snapInterval)*this.snapInterval}_dispatchTimeRangeSelectionChangedEvent(){!this._timeRangeSelectionChanged||(this._timeRangeSelectionChanged=!1,this.dispatchEventToListeners(WI.TimelineRuler.Event.TimeRangeSelectionChanged))}_timelineMarkerTimeChanged(){this._needsMarkerLayout()}_shouldIgnoreMicroMovement(e){return this._mousePassedMicroMovementTest?!1:Math.abs(e.pageX-this._mouseStartX)<=4?!0:(this._mousePassedMicroMovementTest=!0,!1)}_handleClick(e){if(!!this._enabled&&!this._mouseMoved)for(let t of document.elementsFromPoint(e.pageX,e.pageY)){if(!t||typeof t.click!="function"||this.element.contains(t))continue;let i=new e.constructor(e.type,e);t.dispatchEvent(i),i.__timelineRecordClickEventHandled&&e.stop();return}}_handleDoubleClick(e){this.entireRangeSelected||this.selectEntireRange()}_handleMouseDown(e){if(!(e.button!==0||e.ctrlKey)){if(this._selectionIsMove=e.target===this._selectionDragElement,this._rulerBoundingClientRect=this.element.getBoundingClientRect(),this._selectionIsMove){this._lastMousePosition=e.pageX;var t=this._selectionDragElement.getBoundingClientRect();this._moveSelectionMaximumLeftOffset=this._rulerBoundingClientRect.left+(e.pageX-t.left),this._moveSelectionMaximumRightOffset=this._rulerBoundingClientRect.right-(t.right-e.pageX)}else WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?this._mouseDownPosition=this._rulerBoundingClientRect.right-e.pageX:this._mouseDownPosition=e.pageX-this._rulerBoundingClientRect.left;this._mouseMoved=!1,this._mousePassedMicroMovementTest=!1,this._mouseStartX=e.pageX,this._mouseMoveEventListener=this._handleMouseMove.bind(this),this._mouseUpEventListener=this._handleMouseUp.bind(this),document.addEventListener("mousemove",this._mouseMoveEventListener),document.addEventListener("mouseup",this._mouseUpEventListener),e.preventDefault(),e.stopPropagation()}}_handleMouseMove(e){if(console.assert(e.button===0),this._shouldIgnoreMicroMovement(e))return;this._mouseMoved=!0;let t=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL,i;if(this._selectionIsMove){i=Math.max(this._moveSelectionMaximumLeftOffset,Math.min(this._moveSelectionMaximumRightOffset,e.pageX));let n=0;t?n=this._lastMousePosition-i:n=i-this._lastMousePosition;let s=n*this.secondsPerPixel,a=this.selectionEndTime-this.selectionStartTime,d=this.selectionStartTime;if(this.selectionStartTime=Math.max(this.startTime,Math.min(this.selectionStartTime+s,this.endTime-a)),this.selectionEndTime=this.selectionStartTime+a,this.snapInterval){let p=this.selectionStartTime-d;if(!p)return;let f=(s-p*this.snapInterval)/this.secondsPerPixel;i-=f}this._lastMousePosition=i}else t?i=this._rulerBoundingClientRect.right-e.pageX:i=e.pageX-this._rulerBoundingClientRect.left,this.selectionStartTime=Math.max(this.startTime,this.startTime+Math.min(i,this._mouseDownPosition)*this.secondsPerPixel),this.selectionEndTime=Math.min(this.startTime+Math.max(i,this._mouseDownPosition)*this.secondsPerPixel,this.endTime),this.element.classList.add(WI.TimelineRuler.ResizingSelectionStyleClassName);this._updateSelection(this._cachedClientWidth,this.duration),e.preventDefault(),e.stopPropagation()}_handleMouseUp(e){if(console.assert(e.button===0),!this._selectionIsMove&&(this.element.classList.remove(WI.TimelineRuler.ResizingSelectionStyleClassName),this.selectionEndTime-this.selectionStartTime<this.minimumSelectionDuration)){let t=0;WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?t=this._rulerBoundingClientRect.right-e.pageX:t=e.pageX-this._rulerBoundingClientRect.left,t>this._mouseDownPosition?(this.selectionEndTime=Math.min(this.selectionStartTime+this.minimumSelectionDuration,this.endTime),this.selectionStartTime=this.selectionEndTime-this.minimumSelectionDuration):(this.selectionStartTime=Math.max(this.startTime,this.selectionEndTime-this.minimumSelectionDuration),this.selectionEndTime=this.selectionStartTime+this.minimumSelectionDuration)}this._dispatchTimeRangeSelectionChangedEvent(),document.removeEventListener("mousemove",this._mouseMoveEventListener),document.removeEventListener("mouseup",this._mouseUpEventListener),delete this._mouseMoveEventListener,delete this._mouseUpEventListener,delete this._mouseDownPosition,delete this._lastMousePosition,delete this._selectionIsMove,delete this._rulerBoundingClientRect,delete this._moveSelectionMaximumLeftOffset,delete this._moveSelectionMaximumRightOffset,e.preventDefault(),e.stopPropagation()}_handleSelectionHandleMouseDown(e){e.button!==0||e.ctrlKey||(this._dragHandleIsStartTime=e.target===this._leftSelectionHandleElement,WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?this._mouseDownPosition=this.element.totalOffsetRight-e.pageX:this._mouseDownPosition=e.pageX-this.element.totalOffsetLeft,this._selectionHandleMouseMoveEventListener=this._handleSelectionHandleMouseMove.bind(this),this._selectionHandleMouseUpEventListener=this._handleSelectionHandleMouseUp.bind(this),document.addEventListener("mousemove",this._selectionHandleMouseMoveEventListener),document.addEventListener("mouseup",this._selectionHandleMouseUpEventListener),this.element.classList.add(WI.TimelineRuler.ResizingSelectionStyleClassName),e.preventDefault(),e.stopPropagation())}_handleSelectionHandleMouseMove(e){console.assert(e.button===0);let t=0;WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?t=this.element.totalOffsetRight-e.pageX:t=e.pageX-this.element.totalOffsetLeft;let i=this.startTime+t*this.secondsPerPixel;if(this.snapInterval&&(i=this._snapValue(i)),e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey)if(this._dragHandleIsStartTime){let n=i-this.selectionStartTime;this.selectionStartTime=Math.max(this.startTime,Math.min(i,this.selectionEndTime-this.minimumSelectionDuration)),this.selectionEndTime=Math.min(Math.max(this.selectionStartTime+this.minimumSelectionDuration,this.selectionEndTime-n),this.endTime)}else{let n=i-this.selectionEndTime;this.selectionEndTime=Math.min(Math.max(this.selectionStartTime+this.minimumSelectionDuration,i),this.endTime),this.selectionStartTime=Math.max(this.startTime,Math.min(this.selectionStartTime-n,this.selectionEndTime-this.minimumSelectionDuration))}else this._dragHandleIsStartTime?this.selectionStartTime=Math.max(this.startTime,Math.min(i,this.selectionEndTime-this.minimumSelectionDuration)):this.selectionEndTime=Math.min(Math.max(this.selectionStartTime+this.minimumSelectionDuration,i),this.endTime);this._updateSelection(this._cachedClientWidth,this.duration),e.preventDefault(),e.stopPropagation()}_handleSelectionHandleMouseUp(e){console.assert(e.button===0),this.element.classList.remove(WI.TimelineRuler.ResizingSelectionStyleClassName),document.removeEventListener("mousemove",this._selectionHandleMouseMoveEventListener),document.removeEventListener("mouseup",this._selectionHandleMouseUpEventListener),delete this._selectionHandleMouseMoveEventListener,delete this._selectionHandleMouseUpEventListener,delete this._dragHandleIsStartTime,delete this._mouseDownPosition,e.preventDefault(),e.stopPropagation()}};WI.TimelineRuler.MinimumLeftDividerSpacing=48;WI.TimelineRuler.MinimumDividerSpacing=64;WI.TimelineRuler.ResizingSelectionStyleClassName="resizing-selection";WI.TimelineRuler.DividerElementStyleClassName="divider";WI.TimelineRuler.DividerLabelElementStyleClassName="label";WI.TimelineRuler.Event={TimeRangeSelectionChanged:"time-ruler-time-range-selection-changed"};WI.TitleView=class extends WI.View{constructor(e){super(),this.element.classList.add("title-view"),this.element.textContent=e}};WI.ToggleButtonNavigationItem=class extends WI.ButtonNavigationItem{constructor(e,t,i,n,s,a,d){super(e,t,n,a,d),this._toggled=!1,this._defaultImage=n,this._alternateImage=s,this._defaultToolTip=t,this._alternateToolTip=i||t}get defaultToolTip(){return this._defaultToolTip}set defaultToolTip(e){this._defaultToolTip=e,this._toggled||(this.tooltip=this._defaultToolTip)}get alternateToolTip(){return this._alternateToolTip}set alternateToolTip(e){this._alternateToolTip=e,this._toggled&&(this.tooltip=this._alternateToolTip)}get defaultImage(){return this._defaultImage}get alternateImage(){return this._alternateImage}set alternateImage(e){this._alternateImage=e,this._toggled&&(this.image=this._alternateImage)}get toggled(){return this._toggled}set toggled(e){e=e||!1,this._toggled!==e&&(this._toggled=e,this._toggled?(this.tooltip=this._alternateToolTip,this.image=this._alternateImage):(this.tooltip=this._defaultToolTip,this.image=this._defaultImage),(this.buttonStyle===WI.ButtonNavigationItem.Style.Text||this.buttonStyle===WI.ButtonNavigationItem.Style.ImageAndText)&&(this.label=this.tooltip))}get additionalClassNames(){return["toggle","button"]}};WI.Toolbar=class extends WI.NavigationBar{constructor(e){super(e,null,"toolbar"),this._controlSectionElement=document.createElement("div"),this._controlSectionElement.className=WI.Toolbar.ControlSectionStyleClassName,this.element.appendChild(this._controlSectionElement),this._leftSectionElement=document.createElement("div"),this._leftSectionElement.className=WI.Toolbar.ItemSectionStyleClassName+" "+WI.Toolbar.LeftItemSectionStyleClassName,this.element.appendChild(this._leftSectionElement),this._centerLeftSectionElement=document.createElement("div"),this._centerLeftSectionElement.className=WI.Toolbar.ItemSectionStyleClassName+" "+WI.Toolbar.CenterLeftItemSectionStyleClassName,this.element.appendChild(this._centerLeftSectionElement),this._centerSectionElement=document.createElement("div"),this._centerSectionElement.className=WI.Toolbar.ItemSectionStyleClassName+" "+WI.Toolbar.CenterItemSectionStyleClassName,this.element.appendChild(this._centerSectionElement),this._centerRightSectionElement=document.createElement("div"),this._centerRightSectionElement.className=WI.Toolbar.ItemSectionStyleClassName+" "+WI.Toolbar.CenterRightItemSectionStyleClassName,this.element.appendChild(this._centerRightSectionElement),this._rightSectionElement=document.createElement("div"),this._rightSectionElement.className=WI.Toolbar.ItemSectionStyleClassName+" "+WI.Toolbar.RightItemSectionStyleClassName,this.element.appendChild(this._rightSectionElement)}addToolbarItem(e,t){var i;switch(t){case WI.Toolbar.Section.Control:i=this._controlSectionElement;break;case WI.Toolbar.Section.Left:i=this._leftSectionElement;break;case WI.Toolbar.Section.CenterLeft:i=this._centerLeftSectionElement;break;default:case WI.Toolbar.Section.Center:i=this._centerSectionElement;break;case WI.Toolbar.Section.CenterRight:i=this._centerRightSectionElement;break;case WI.Toolbar.Section.Right:i=this._rightSectionElement;break}console.assert(i),this.addNavigationItem(e,i)}layout(){if(!this._leftSectionElement||!this._centerSectionElement||!this._rightSectionElement)return;if(WI.sharedApp.debuggableType!==WI.DebuggableType.Web){this.element.classList.add(WI.NavigationBar.CollapsedStyleClassName);return}this.element.classList.remove(WI.NavigationBar.CollapsedStyleClassName);function e(){var t=this._controlSectionElement.realOffsetWidth,i=this._leftSectionElement.realOffsetWidth,n=this._centerLeftSectionElement.realOffsetWidth,s=this._centerSectionElement.realOffsetWidth,a=this._centerRightSectionElement.realOffsetWidth,d=this._rightSectionElement.realOffsetWidth,p=Math.round(this.element.realOffsetWidth);return Math.round(t+i+n+s+a+d)>p}!e.call(this)||this.element.classList.add(WI.NavigationBar.CollapsedStyleClassName)}};WI.Toolbar.StyleClassName="toolbar";WI.Toolbar.ControlSectionStyleClassName="control-section";WI.Toolbar.ItemSectionStyleClassName="item-section";WI.Toolbar.LeftItemSectionStyleClassName="left";WI.Toolbar.CenterLeftItemSectionStyleClassName="center-left";WI.Toolbar.CenterItemSectionStyleClassName="center";WI.Toolbar.CenterRightItemSectionStyleClassName="center-right";WI.Toolbar.RightItemSectionStyleClassName="right";WI.Toolbar.Section={Control:"control",Left:"left",CenterLeft:"center-left",Center:"center",CenterRight:"center-right",Right:"right"};WI.TreeElementStatusButton=class extends WI.Object{constructor(e){super(),console.assert(e),this._element=e,this._element.classList.add("status-button"),this._element.addEventListener("click",this._clicked.bind(this))}get element(){return this._element}get hidden(){return!this._element.classList.contains(WI.TreeElementStatusButton.DisabledStyleClassName)}set hidden(e){this._element.classList.toggle("hidden",e)}get enabled(){return!this._element.classList.contains(WI.TreeElementStatusButton.DisabledStyleClassName)}set enabled(e){e?this._element.classList.remove(WI.TreeElementStatusButton.DisabledStyleClassName):this._element.classList.add(WI.TreeElementStatusButton.DisabledStyleClassName)}_clicked(e){!this.enabled||(e.stopPropagation(),this.dispatchEventToListeners(WI.TreeElementStatusButton.Event.Clicked,e))}};WI.TreeElementStatusButton.DisabledStyleClassName="disabled";WI.TreeElementStatusButton.Event={Clicked:"status-button-clicked"};WI.TypeTokenView=class extends WI.Object{constructor(e,t,i,n,s){console.assert(n===WI.TypeTokenView.TitleType.Variable||n===WI.TypeTokenView.TitleType.ReturnStatement),super();var a=document.createElement("span");a.classList.add("type-token"),t&&a.classList.add("type-token-right-spacing"),i&&a.classList.add("type-token-left-spacing"),this.element=a,this._tokenAnnotator=e,this._typeDescription=null,this._colorClass=null,this._popoverTitle=WI.TypeTokenView.titleForPopover(n,s),this._setUpMouseoverHandlers()}static titleForPopover(e,t){return e===WI.TypeTokenView.TitleType.Variable?WI.UIString("Type information for variable: %s").format(t):t?WI.UIString("Return type for function: %s").format(t):WI.UIString("Return type for anonymous function")}update(e){console.assert(e instanceof WI.TypeDescription),this._typeDescription=e;var t=this._displayTypeName();if(t!==this.element.textContent){this.element.textContent=t;var i=t[t.length-1]==="?"?t.slice(0,t.length-1):t;this._colorClass&&this.element.classList.remove(this._colorClass),this._colorClass=WI.TypeTokenView.ColorClassForType[i]||"type-token-default",this.element.classList.add(this._colorClass)}}_setUpMouseoverHandlers(){var e=null;this.element.addEventListener("mouseover",function(){function t(){e=null;var i=this.element.getBoundingClientRect(),n=new WI.Rect(i.left,i.top,i.width,i.height);this._tokenAnnotator.sourceCodeTextEditor.showPopoverForTypes(this._typeDescription,n,this._popoverTitle)}this._shouldShowPopover()&&(e=setTimeout(t.bind(this),WI.TypeTokenView.DelayHoverTime))}.bind(this)),this.element.addEventListener("mouseout",function(){e&&clearTimeout(e)})}_shouldShowPopover(){return this._typeDescription.valid?!!(this._typeDescription.typeSet.primitiveTypeNames.length>1||this._typeDescription.structures&&this._typeDescription.structures.length):!1}_displayTypeName(){if(!this._typeDescription.valid)return"";var e=this._typeDescription.typeSet;if(this._typeDescription.leastCommonAncestor){if(e.isContainedIn(WI.TypeSet.TypeBit.Object))return this._typeDescription.leastCommonAncestor;if(e.isContainedIn(WI.TypeSet.TypeBit.Object|WI.TypeSet.NullOrUndefinedTypeBits))return this._typeDescription.leastCommonAncestor+"?"}return e.isContainedIn(WI.TypeSet.TypeBit.Function)?"Function":e.isContainedIn(WI.TypeSet.TypeBit.Undefined)?"Undefined":e.isContainedIn(WI.TypeSet.TypeBit.Null)?"Null":e.isContainedIn(WI.TypeSet.TypeBit.Boolean)?"Boolean":e.isContainedIn(WI.TypeSet.TypeBit.Integer)?"Integer":e.isContainedIn(WI.TypeSet.TypeBit.Number|WI.TypeSet.TypeBit.Integer)?"Number":e.isContainedIn(WI.TypeSet.TypeBit.String)?"String":e.isContainedIn(WI.TypeSet.TypeBit.Symbol)?"Symbol":e.isContainedIn(WI.TypeSet.NullOrUndefinedTypeBits)?"(?)":e.isContainedIn(WI.TypeSet.TypeBit.Function|WI.TypeSet.NullOrUndefinedTypeBits)?"Function?":e.isContainedIn(WI.TypeSet.TypeBit.Boolean|WI.TypeSet.NullOrUndefinedTypeBits)?"Boolean?":e.isContainedIn(WI.TypeSet.TypeBit.Integer|WI.TypeSet.NullOrUndefinedTypeBits)?"Integer?":e.isContainedIn(WI.TypeSet.TypeBit.Number|WI.TypeSet.TypeBit.Integer|WI.TypeSet.NullOrUndefinedTypeBits)?"Number?":e.isContainedIn(WI.TypeSet.TypeBit.String|WI.TypeSet.NullOrUndefinedTypeBits)?"String?":e.isContainedIn(WI.TypeSet.TypeBit.Symbol|WI.TypeSet.NullOrUndefinedTypeBits)?"Symbol?":e.isContainedIn(WI.TypeSet.TypeBit.Object|WI.TypeSet.TypeBit.Function|WI.TypeSet.TypeBit.String)?"Object":e.isContainedIn(WI.TypeSet.TypeBit.Object|WI.TypeSet.TypeBit.Function|WI.TypeSet.TypeBit.String|WI.TypeSet.NullOrUndefinedTypeBits)?"Object?":WI.UIString("(many)")}};WI.TypeTokenView.TitleType={Variable:Symbol("title-type-variable"),ReturnStatement:Symbol("title-type-return-statement")};WI.TypeTokenView.ColorClassForType={String:"type-token-string",Symbol:"type-token-symbol",Function:"type-token-function",Number:"type-token-number",Integer:"type-token-number",Undefined:"type-token-empty",Null:"type-token-empty","(?)":"type-token-empty",Boolean:"type-token-boolean","(many)":"type-token-many"};WI.TypeTokenView.DelayHoverTime=350;WI.TypeTreeElement=class extends WI.GeneralTreeElement{constructor(e,t,i){super(null,null,null,t||null),console.assert(!t||t instanceof WI.StructureDescription),this._name=e,this._structureDescription=t||null,this._isPrototype=i,this._populated=!1,this._autoExpandedChildren=!1,this.toggleOnClick=!0,this.selectable=!1,this.tooltipHandledSeparately=!0,this.hasChildren=t;var d=this._isPrototype?WI.UIString("%s Prototype").format(e.replace(/Prototype$/,"")):e,p=document.createElement("span");p.classList.add("type-name"),p.textContent=d,this.mainTitle=p,this.addClassName("type-tree-element"),this._isPrototype&&this.addClassName("prototype")}get name(){return this._name}get isPrototype(){return this._isPrototype}onpopulate(){if(!this._populated){this._populated=!0;var e=[];for(var t of this._structureDescription.fields)t!==""&&e.push({name:t});e.sort(WI.ObjectTreeView.comparePropertyDescriptors);var i=[];for(var t of this._structureDescription.optionalFields)t!==""&&i.push({name:t+"?"});i.sort(WI.ObjectTreeView.comparePropertyDescriptors);for(var n of e)this.appendChild(new WI.TypeTreeElement(n.name,null));for(var n of i)this.appendChild(new WI.TypeTreeElement(n.name,null));if(this._structureDescription.imprecise){var s=WI.ObjectTreeView.createEmptyMessageElement(ellipsis);this.appendChild(new WI.TreeElement(s,null,!1))}if(!this.children.length){var a=WI.ObjectTreeView.createEmptyMessageElement(WI.UIString("No Properties"));this.appendChild(new WI.TreeElement(a,null,!1))}console.assert(this.children.length>0);var d=this._structureDescription.prototypeStructure;d&&this.appendChild(new WI.TypeTreeElement(d.constructorName,d,!0))}}onexpand(){if(!this._autoExpandedChildren){this._autoExpandedChildren=!0;var e=this.children[this.children.length-1];e&&e.hasChildren&&e.isPrototype&&e.name!=="Object"&&e.expand()}}};WI.TypeTreeView=class extends WI.Object{constructor(e){super(),console.assert(e instanceof WI.TypeDescription),this._typeDescription=e,this._element=document.createElement("div"),this._element.className="type-tree",this._outline=new WI.TreeOutline,this._outline.customIndent=!0,this._outline.element.classList.add("type"),this._element.appendChild(this._outline.element),this._populate(),this._outline.children.length===1&&this._outline.children[0].expand()}get typeDescription(){return this._typeDescription}get element(){return this._element}get treeOutline(){return this._outline}_populate(){var e=[];for(var t of this._typeDescription.structures)e.push({name:t.constructorName,structure:t});for(var i of this._typeDescription.typeSet.primitiveTypeNames)e.push({name:i});e.sort(WI.ObjectTreeView.comparePropertyDescriptors);for(var n of e)this._outline.appendChild(new WI.TypeTreeElement(n.name,n.structure,!1));if(this._typeDescription.truncated){var s=WI.ObjectTreeView.createEmptyMessageElement(ellipsis);this._outline.appendChild(new WI.TreeElement(s,null,!1))}if(!this._outline.children.length){var a=WI.ObjectTreeView.createEmptyMessageElement(WI.UIString("No Properties"));this._outline.appendChild(new WI.TreeElement(a,null,!1))}}};WI.URLBreakpointPopover=class extends WI.Popover{constructor(e){super(e),this._breakpoint=null,this._codeMirror=null,this._targetElement=null,this._preferredEdges=null,this.windowResizeHandler=this._presentOverTargetElement.bind(this)}get breakpoint(){return this._breakpoint}show(e,t){this._targetElement=e,this._preferredEdges=t;let i=document.createElement("div");i.classList.add("url-breakpoint-content");let n=document.createElement("div");n.classList.add("label"),n.textContent=WI.UIString("Break on request with URL:");let s=document.createElement("div");s.classList.add("editor-wrapper"),this._typeSelectElement=document.createElement("select");let a=(d,p)=>{let f=this._typeSelectElement.appendChild(document.createElement("option"));f.textContent=d,f.value=p};a(WI.UIString("Containing"),WI.URLBreakpoint.Type.Text),a(WI.UIString("Matching"),WI.URLBreakpoint.Type.RegularExpression),this._typeSelectElement.value=WI.URLBreakpoint.Type.Text,this._typeSelectElement.addEventListener("change",d=>{this._updateEditor(),this._codeMirror.focus()}),s.append(this._typeSelectElement,this._createEditor()),i.append(n,s),this.content=i,this._presentOverTargetElement()}dismiss(){let e=this._typeSelectElement.value,t=this._codeMirror.getValue();e&&t&&(this._breakpoint=new WI.URLBreakpoint(e,t)),super.dismiss()}_createEditor(){let e=document.createElement("div");return e.classList.add("editor"),this._codeMirror=WI.CodeMirrorEditor.create(e,{lineWrapping:!1,matchBrackets:!1,scrollbarStyle:null,value:""}),this._codeMirror.addKeyMap({Enter:()=>{this.dismiss()},Esc:()=>{this.dismiss()}}),this._updateEditor(),e}_updateEditor(){let e,t;this._typeSelectElement.value===WI.URLBreakpoint.Type.Text?(e=WI.UIString("Text"),t="text/plain"):(e=WI.UIString("Regular Expression"),t="text/x-regex"),this._codeMirror.setOption("mode",t),this._codeMirror.setOption("placeholder",e)}_presentOverTargetElement(){if(!this._targetElement)return;let e=WI.Rect.rectFromClientRect(this._targetElement.getBoundingClientRect());this.present(e,this._preferredEdges),setTimeout(()=>{this._codeMirror.refresh(),this._codeMirror.focus(),this.update()},0)}};WI.URLBreakpointTreeElement=class extends WI.GeneralTreeElement{constructor(e,{className:t,title:i}={}){console.assert(e instanceof WI.URLBreakpoint);let n=["breakpoint","url"];t&&n.push(t);let s;i||(i=WI.UIString("URL"),e.type===WI.URLBreakpoint.Type.Text?s=doubleQuotedString(e.url):s="/"+e.url+"/"),super(n,i,s,e),this.status=WI.ImageUtilities.useSVGSymbol("data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2019 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 23 12'%3e %3cpolygon points='0.5 0.5 17.355 0.5 21.904 6 17.355 11.5 0.5 11.5 0.5 0.5'/%3e %3c/svg%3e"),this.status.className=WI.BreakpointTreeElement.StatusImageElementStyleClassName,this.tooltipHandledSeparately=!0}onattach(){super.onattach(),this.representedObject.addEventListener(WI.URLBreakpoint.Event.DisabledStateChanged,this._updateStatus,this),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.BreakpointsEnabledDidChange,this._updateStatus,this),this._boundStatusImageElementClicked=this._statusImageElementClicked.bind(this),this._boundStatusImageElementFocused=this._statusImageElementFocused.bind(this),this._boundStatusImageElementMouseDown=this._statusImageElementMouseDown.bind(this),this.status.addEventListener("click",this._boundStatusImageElementClicked),this.status.addEventListener("focus",this._boundStatusImageElementFocused),this.status.addEventListener("mousedown",this._boundStatusImageElementMouseDown),this._updateStatus()}ondetach(){super.ondetach(),this.representedObject.removeEventListener(null,null,this),WI.debuggerManager.removeEventListener(null,null,this),this.status.removeEventListener("click",this._boundStatusImageElementClicked),this.status.removeEventListener("focus",this._boundStatusImageElementFocused),this.status.removeEventListener("mousedown",this._boundStatusImageElementMouseDown),this._boundStatusImageElementClicked=null,this._boundStatusImageElementFocused=null,this._boundStatusImageElementMouseDown=null}ondelete(){return this.__deletedViaDeleteKeyboardShortcut=!0,WI.domDebuggerManager.removeURLBreakpoint(this.representedObject),!0}onenter(){return this._toggleBreakpoint(),!0}onspace(){return this._toggleBreakpoint(),!0}populateContextMenu(e,t){let i=this.representedObject,n=i.disabled?WI.UIString("Enable Breakpoint"):WI.UIString("Disable Breakpoint");e.appendItem(n,this._toggleBreakpoint.bind(this)),e.appendItem(WI.UIString("Delete Breakpoint"),()=>{WI.domDebuggerManager.removeURLBreakpoint(i)})}_statusImageElementClicked(e){this._toggleBreakpoint()}_statusImageElementFocused(e){e.stopPropagation()}_statusImageElementMouseDown(e){e.stopPropagation()}_toggleBreakpoint(){this.representedObject.disabled=!this.representedObject.disabled}_updateStatus(){!this.status||(this.status.classList.toggle(WI.BreakpointTreeElement.StatusImageDisabledStyleClassName,this.representedObject.disabled),this.status.classList.toggle(WI.BreakpointTreeElement.StatusImageResolvedStyleClassName,WI.debuggerManager.breakpointsEnabled))}};WI.WebSocketContentView=class extends WI.ContentView{constructor(e){console.assert(e instanceof WI.WebSocketResource,e),super(e),this._updateFramesDebouncer=new Debouncer(()=>{this._updateFrames()}),this._resource=e,this._framesRendered=0,this._lastRenderedReadyState=null,this._showTimeColumn=InspectorBackend.domains.Network.hasEventParameter("webSocketWillSendHandshakeRequest","walltime"),this.element.classList.add("web-socket","resource");let t={data:{}};t.data.title=WI.UIString("Data"),t.data.sortable=!1,t.data.width="85%",this._showTimeColumn&&(t.time={title:WI.UIString("Time"),sortable:!0}),this._dataGrid=new WI.DataGrid(t),this._dataGrid.variableHeightRows=!0,this.addSubview(this._dataGrid),this._addRow(WI.UIString("WebSocket Connection Established"),this._resource.walltime),this._dataGrid.updateLayout()}static textForOpcode(e){switch(e){case WI.WebSocketResource.OpCodes.ContinuationFrame:return WI.UIString("Continuation Frame");case WI.WebSocketResource.OpCodes.TextFrame:return WI.UIString("Text Frame");case WI.WebSocketResource.OpCodes.BinaryFrame:return WI.UIString("Binary Frame");case WI.WebSocketResource.OpCodes.ConnectionCloseFrame:return WI.UIString("Connection Close Frame");case WI.WebSocketResource.OpCodes.PingFrame:return WI.UIString("Ping Frame");case WI.WebSocketResource.OpCodes.PongFrame:return WI.UIString("Pong Frame")}}shown(){this._updateFramesDebouncer.force(),this._resource.addEventListener(WI.WebSocketResource.Event.FrameAdded,this._updateFramesSoon,this),this._resource.addEventListener(WI.WebSocketResource.Event.ReadyStateChanged,this._updateFramesSoon,this)}hidden(){this._resource.removeEventListener(WI.WebSocketResource.Event.FrameAdded,this._updateFramesSoon,this),this._resource.removeEventListener(WI.WebSocketResource.Event.ReadyStateChanged,this._updateFramesSoon,this)}_updateFramesSoon(){this._updateFramesDebouncer.delayForFrame()}_updateFrames(){let e=this._dataGrid.isScrolledToLastRow(),t=this._resource.frames.length;for(let i=this._framesRendered;i<t;i++){let n=this._resource.frames[i],{data:s,isOutgoing:a,opcode:d,walltime:p}=n;this._addFrame(s,a,d,p)}this._framesRendered=t,this._lastRenderedReadyState!==this._resource.readyState&&(this._resource.readyState===WI.WebSocketResource.ReadyState.Closed&&this._dataGrid.appendChild(new WI.SpanningDataGridNode(WI.UIString("Connection Closed"))),this._lastRenderedReadyState=this._resource.readyState),e&&(this._scrollToLastRowDebouncer||(this._scrollToLastRowDebouncer=new Debouncer(()=>{this._dataGrid.scrollToLastRow()})),this._scrollToLastRowDebouncer.delayForFrame())}_addFrame(e,t,i,n){let s,a=i===WI.WebSocketResource.OpCodes.TextFrame;a?s=e:s=WI.WebSocketContentView.textForOpcode(i),this._addRow(s,n,{isOutgoing:t,isText:a})}_addRow(e,t,i={}){let n;this._showTimeColumn?n=new WI.WebSocketDataGridNode({...i,data:e,time:t}):n=new WI.WebSocketDataGridNode({...i,data:e}),this._dataGrid.appendChild(n),i.isText?n.element.classList.add("text-frame"):n.element.classList.add("non-text-frame"),i.isOutgoing?n.element.classList.add("outgoing"):n.element.classList.add("incoming")}};WI.WebSocketDataGridNode=class extends WI.DataGridNode{createCellContent(e){if(e==="data"){let t=document.createDocumentFragment();if(this._data.isOutgoing){let i=WI.ImageUtilities.useSVGSymbol("data:image/svg+xml,%3c%3fxml version='1.0'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' width='16' height='16' viewBox='0 0 16 16'%3e %3cpath stroke='currentColor' fill='none' d='M3.5 7.5 L7.5 3.5 l4 4'/%3e %3cpath stroke='currentColor' fill='none' d='M7.5 13 V4'/%3e %3c/svg%3e","icon",WI.UIString("Outgoing message"));t.appendChild(i)}return t.appendChild(document.createTextNode(this._data.data)),t}return e==="time"?this._timeStringFromTimestamp(this._data.time):super.createCellContent(e)}appendContextMenuItems(e){let t=(i,n,s)=>{console.assert(!n);const a=WI.UIString("Selected Frame"),d=!0,p=!0;WI.consoleLogViewController.appendImmediateExecutionWithResult(a,i,d,p)};if(this._data.isText){let i=WI.RemoteObject.fromPrimitiveValue(this._data.data);e.appendItem(WI.UIString("Log Frame Text"),()=>{WI.runtimeManager.saveResult(i,n=>{t(i,!1,n)})});try{JSON.parse(this._data.data),e.appendItem(WI.UIString("Log Frame Value"),()=>{const n={objectGroup:WI.RuntimeManager.ConsoleObjectGroup,generatePreview:!0,saveResult:!0,doNotPauseOnExceptionsAndMuteConsole:!0};let s="("+this._data.data+")";WI.runtimeManager.evaluateInInspectedWindow(s,n,t)})}catch{}e.appendSeparator()}return super.appendContextMenuItems(e)}_timeStringFromTimestamp(e){return new Date(e*1e3).toLocaleTimeString()}};WI.WebSocketResourceTreeElement=class extends WI.ResourceTreeElement{onattach(){super.onattach(),this._updateConnectionStatus(),this.resource.addEventListener(WI.WebSocketResource.Event.ReadyStateChanged,this._updateConnectionStatus,this)}ondetach(){super.ondetach(),this.resource.removeEventListener(WI.WebSocketResource.Event.ReadyStateChanged,this._updateConnectionStatus,this)}populateContextMenu(e,t){e.appendItem(WI.UIString("Log WebSocket"),()=>{WI.RemoteObject.resolveWebSocket(this._resource,WI.RuntimeManager.ConsoleObjectGroup,i=>{if(!i)return;const n=WI.UIString("Selected WebSocket"),s=!0;WI.consoleLogViewController.appendImmediateExecutionWithResult(n,i,s)})}),e.appendSeparator(),super.populateContextMenu(e,t)}_updateConnectionStatus(){switch(this.resource.readyState){case WI.WebSocketResource.ReadyState.Closed:this.status="";break;case WI.WebSocketResource.ReadyState.Connecting:var e=document.createElement("div");e.classList.add("ready-state","connecting"),e.title=WI.UIString("Connecting"),this.status=e;break;case WI.WebSocketResource.ReadyState.Open:var e=document.createElement("div");e.classList.add("ready-state","open"),e.title=WI.UIString("Open"),this.status=e;break}}};WI.WorkerTreeElement=class extends WI.ScriptTreeElement{constructor(e){super(e.mainResource),console.assert(e instanceof WI.Target),console.assert(e.type===WI.Target.Type.Worker||e.type===WI.Target.Type.ServiceWorker),console.assert(e.mainResource instanceof WI.Script),this._target=e,this._target.addEventListener(WI.Target.Event.ResourceAdded,this._resourceAdded,this),this._target.addEventListener(WI.Target.Event.ScriptAdded,this._scriptAdded,this),this._expandedSetting=new WI.Setting("worker-expanded-"+this._target.name.hash,!0),this.registerFolderizeSettings("scripts",null,this._target.resourceCollection.resourceCollectionForType(WI.Resource.Type.Script),WI.ResourceTreeElement),this.registerFolderizeSettings("extra-scripts",null,this._target.extraScriptCollection,WI.ScriptTreeElement);for(let[t,i]of Object.entries(WI.Resource.Type)){if(i===WI.Resource.Type.Script)continue;let n=WI.Resource.displayNameForType(i,!0);this.registerFolderizeSettings(t,n,this._target.resourceCollection.resourceCollectionForType(i),WI.ResourceTreeElement)}this.updateParentStatus(),this._expandedSetting.value&&this.expand()}get target(){return this._target}onexpand(){this._expandedSetting.value=!0}oncollapse(){this.hasChildren&&(this._expandedSetting.value=!1)}onpopulate(){if(this.children.length&&!this.shouldRefreshChildren)return;this.shouldRefreshChildren=!1,this.removeChildren(),this.prepareToPopulate();for(let t of this._target.resourceCollection)this.addChildForRepresentedObject(t);for(let t of this._target.extraScriptCollection)this.addChildForRepresentedObject(t);let e=this._target.mainResource.sourceMaps;for(let t of e)for(let i of t.resources)this.addChildForRepresentedObject(i)}populateContextMenu(e,t){WI.appendContextMenuItemsForSourceCode(e,this.script.resource?this.script.resource:this.script),super.populateContextMenu(e,t)}updateSourceMapResources(){!this.treeOutline||!this.treeOutline.includeSourceMapResourceChildren||(this.updateParentStatus(),this._target.mainResource.sourceMaps.length&&(this.hasChildren=!0,this.shouldRefreshChildren=!0))}onattach(){WI.GeneralTreeElement.prototype.onattach.call(this)}compareChildTreeElements(e,t){let i=e instanceof WI.ResourceTreeElement,n=t instanceof WI.ResourceTreeElement;return i&&n?WI.ResourceTreeElement.compareResourceTreeElements(e,t):!i&&!n?super.compareChildTreeElements(e,t):i?1:-1}_scriptAdded(e){let t=e.data.script;!t.url&&!t.sourceURL||this.addRepresentedObjectToNewChildQueue(t)}_resourceAdded(e){this.addRepresentedObjectToNewChildQueue(e.data.resource)}};WI.Annotator=class extends WI.Object{constructor(e){super(),console.assert(e instanceof WI.SourceCodeTextEditor,e),this._sourceCodeTextEditor=e,this._timeoutIdentifier=null,this._isActive=!1}get sourceCodeTextEditor(){return this._sourceCodeTextEditor}isActive(){return this._isActive}pause(){this._clearTimeoutIfNeeded(),this._isActive=!1}resume(){this._clearTimeoutIfNeeded(),this._isActive=!0,this.insertAnnotations()}refresh(){console.assert(this._isActive),this._isActive&&(this._clearTimeoutIfNeeded(),this.insertAnnotations())}reset(){this._clearTimeoutIfNeeded(),this._isActive=!0,this.clearAnnotations(),this.insertAnnotations()}clear(){this.pause(),this.clearAnnotations()}insertAnnotations(){}clearAnnotations(){}_clearTimeoutIfNeeded(){this._timeoutIdentifier&&(clearTimeout(this._timeoutIdentifier),this._timeoutIdentifier=null)}};WI.CodeMirrorEditingController=class extends WI.Object{constructor(e,t){super(),this._codeMirror=e,this._marker=t,this._delegate=null,this._range=t.range,this._value=this.initialValue,this._keyboardShortcutEsc=new WI.KeyboardShortcut(null,WI.KeyboardShortcut.Key.Escape)}get marker(){return this._marker}get range(){return this._range}get value(){return this._value}set value(e){this.text=e.toString(),this._value=e}get delegate(){return this._delegate}set delegate(e){this._delegate=e}get text(){var e={line:this._range.startLine,ch:this._range.startColumn},t={line:this._range.endLine,ch:this._range.endColumn};return this._codeMirror.getRange(e,t)}set text(e){var t={line:this._range.startLine,ch:this._range.startColumn},i={line:this._range.endLine,ch:this._range.endColumn};this._codeMirror.replaceRange(e,t,i);var n=e.split(`
`),s=this._range.startLine+n.length-1,a=n.length>1?n.lastValue.length:this._range.startColumn+e.length;this._range=new WI.TextRange(this._range.startLine,this._range.startColumn,s,a)}get initialValue(){return this.text}get cssClassName(){return""}get popover(){return this._popover}get popoverPreferredEdges(){return[WI.RectEdge.MIN_X,WI.RectEdge.MIN_Y,WI.RectEdge.MAX_Y,WI.RectEdge.MAX_X]}popoverTargetFrameWithRects(e){return WI.Rect.unionOfRects(e)}presentHoverMenu(){!this.cssClassName||(this._hoverMenu=new WI.HoverMenu(this),this._hoverMenu.element.classList.add(this.cssClassName),this._rects=this._marker.rects,this._hoverMenu.present(this._rects))}dismissHoverMenu(e){!this._hoverMenu||this._hoverMenu.dismiss(e)}popoverWillPresent(e){}popoverDidPresent(e){}popoverDidDismiss(e){}handleKeydownEvent(e){return!this._keyboardShortcutEsc.matchesEvent(e)||!this._popover.visible?!1:(this.value=this._originalValue,this._popover.dismiss(),!0)}hoverMenuButtonWasPressed(e){this._popover=new WI.Popover(this),this.popoverWillPresent(this._popover),this._popover.present(this.popoverTargetFrameWithRects(this._rects).pad(2),this.popoverPreferredEdges),this.popoverDidPresent(this._popover),WI.addWindowKeydownListener(this),e.dismiss(),this._delegate&&typeof this._delegate.editingControllerDidStartEditing=="function"&&this._delegate.editingControllerDidStartEditing(this),this._originalValue=this._value.copy()}didDismissPopover(e){delete this._popover,delete this._originalValue,WI.removeWindowKeydownListener(this),this.popoverDidDismiss(),this._delegate&&typeof this._delegate.editingControllerDidFinishEditing=="function"&&this._delegate.editingControllerDidFinishEditing(this)}};WI.AuditManager=class extends WI.Object{constructor(){super(),this._tests=[],this._results=[],this._runningState=WI.AuditManager.RunningState.Inactive,this._runningTests=[],this._disabledDefaultTestsSetting=new WI.Setting("audit-disabled-default-tests",[]),WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._handleFrameMainResourceDidChange,this)}static synthesizeWarning(e){if(e=WI.UIString("Audit Warning: %s").format(e),window.InspectorTest){console.warn(e);return}let t=new WI.ConsoleMessage(WI.mainTarget,WI.ConsoleMessage.MessageSource.Other,WI.ConsoleMessage.MessageLevel.Warning,e);t.shouldRevealConsole=!0,WI.consoleLogViewController.appendConsoleMessage(t)}static synthesizeError(e){if(e=WI.UIString("Audit Error: %s").format(e),window.InspectorTest){console.error(e);return}let t=new WI.ConsoleMessage(WI.mainTarget,WI.ConsoleMessage.MessageSource.Other,WI.ConsoleMessage.MessageLevel.Error,e);t.shouldRevealConsole=!0,WI.consoleLogViewController.appendConsoleMessage(t)}get tests(){return this._tests}get results(){return this._results}get runningState(){return this._runningState}get editing(){return this._runningState===WI.AuditManager.RunningState.Disabled}set editing(e){if(console.assert(this._runningState===WI.AuditManager.RunningState.Disabled||this._runningState===WI.AuditManager.RunningState.Inactive),this._runningState!==WI.AuditManager.RunningState.Disabled&&this._runningState!==WI.AuditManager.RunningState.Inactive)return;let t=e?WI.AuditManager.RunningState.Disabled:WI.AuditManager.RunningState.Inactive;if(console.assert(t!==this._runningState),t!==this._runningState&&(this._runningState=t,this.dispatchEventToListeners(WI.AuditManager.Event.EditingChanged),!this.editing)){WI.objectStores.audits.clear();let i=[],n=s=>{if(s.disabled&&i.push(s.name),s instanceof WI.AuditTestGroup)for(let a of s.tests)n(a)};for(let s of this._tests)s.__default?n(s):WI.objectStores.audits.putObject(s);this._disabledDefaultTestsSetting.value=i}}async start(e){if(console.assert(this._runningState===WI.AuditManager.RunningState.Inactive),this._runningState!==WI.AuditManager.RunningState.Inactive||(e&&e.length?e=e.filter(n=>typeof n=="object"&&n instanceof WI.AuditTestBase):e=this._tests,console.assert(e.length),!e.length))return null;let t=WI.networkManager.mainFrame.mainResource;this._runningState=WI.AuditManager.RunningState.Active,this._runningTests=e;for(let n of this._runningTests)n.clearResult();this.dispatchEventToListeners(WI.AuditManager.Event.TestScheduled),await Promise.chain(this._runningTests.map(n=>async()=>{if(this._runningState!==WI.AuditManager.RunningState.Active)return;InspectorBackend.domains.Audit&&await AuditAgent.setup();let s=this._topLevelTestForTest(n);console.assert(s||window.InspectorTest,"No matching top-level test found",n),s&&await s.setup(),await n.start(),InspectorBackend.domains.Audit&&await AuditAgent.teardown()}));let i=this._runningTests.map(n=>n.result).filter(n=>!!n);if(this._runningState=WI.AuditManager.RunningState.Inactive,this._runningTests=[],this._addResult(i),t!==WI.networkManager.mainFrame.mainResource)for(let n of this._tests)n.clearResult();return this._results.lastValue===i?i:null}stop(){if(console.assert(this._runningState===WI.AuditManager.RunningState.Active),this._runningState===WI.AuditManager.RunningState.Active){this._runningState=WI.AuditManager.RunningState.Stopping;for(let e of this._runningTests)e.stop()}}async processJSON({json:e,error:t}){if(t){WI.AuditManager.synthesizeError(t);return}if(typeof e!="object"||e===null){WI.AuditManager.synthesizeError(WI.UIString("invalid JSON"));return}if(e.type!==WI.AuditTestCase.TypeIdentifier&&e.type!==WI.AuditTestGroup.TypeIdentifier&&e.type!==WI.AuditTestCaseResult.TypeIdentifier&&e.type!==WI.AuditTestGroupResult.TypeIdentifier){WI.AuditManager.synthesizeError(WI.UIString('unknown %s "%s"').format(WI.unlocalizedString("type"),e.type));return}let i=await WI.AuditTestGroup.fromPayload(e)||await WI.AuditTestCase.fromPayload(e)||await WI.AuditTestGroupResult.fromPayload(e)||await WI.AuditTestCaseResult.fromPayload(e);!i||(i instanceof WI.AuditTestBase?(this._addTest(i),WI.objectStores.audits.putObject(i)):i instanceof WI.AuditTestResultBase&&this._addResult(i),WI.showRepresentedObject(i))}export(e){console.assert(e instanceof WI.AuditTestCase||e instanceof WI.AuditTestGroup||e instanceof WI.AuditTestCaseResult||e instanceof WI.AuditTestGroupResult,e);let t=e.name;e instanceof WI.AuditTestResultBase&&(t=WI.UIString("%s Result").format(t)),WI.FileUtilities.save({url:WI.FileUtilities.inspectorURLForFilename(t+".json"),content:JSON.stringify(e),forceSaveAs:!0})}loadStoredTests(){this._tests.length||(this._addDefaultTests(),WI.objectStores.audits.getAll().then(async e=>{for(let t of e){let i=await WI.AuditTestGroup.fromPayload(t)||await WI.AuditTestCase.fromPayload(t);if(!i)continue;const n=null;WI.objectStores.audits.associateObject(i,n,t),this._addTest(i)}}))}removeTest(e){if(e.__default){if(e.disabled){InspectorFrontendHost.beep();return}e.disabled=!0;let t=this._disabledDefaultTestsSetting.value.slice();t.push(e.name),this._disabledDefaultTestsSetting.value=t;return}this._tests.remove(e),this.dispatchEventToListeners(WI.AuditManager.Event.TestRemoved,{test:e}),WI.objectStores.audits.deleteObject(e)}_addTest(e){this._tests.push(e),this.dispatchEventToListeners(WI.AuditManager.Event.TestAdded,{test:e})}_addResult(e){!e||Array.isArray(e)&&!e.length||(this._results.push(e),this.dispatchEventToListeners(WI.AuditManager.Event.TestCompleted,{result:e,index:this._results.length-1}))}_topLevelTestForTest(e){function t(i){if(i===e)return!0;if(i instanceof WI.AuditTestGroup){for(let n of i.tests)if(t(n))return!0}return!1}for(let i of this._tests)if(t(i))return i;return null}_handleFrameMainResourceDidChange(e){if(!!e.target.isMainFrame())if(this._runningState===WI.AuditManager.RunningState.Active)this.stop();else for(let t of this._tests)t.clearResult()}_addDefaultTests(){const e=function(){return{level:"pass"}},t=function(){return{level:"warn"}},i=function(){return{level:"fail"}},n=function(){return{level:"error"}},s=function(){return{level:"unsupported"}},a=function(){return{level:"pass",domNodes:[document.body]}},d=function(){return{level:"pass",domNodes:Array.from(document.querySelectorAll("[id]")),domAttributes:["id"]}},p=function(){throw Error("this error was thrown from inside the audit test code.")},f=function(){return{level:"pass",a:1,b:[2],c:{key:3}}},_=function(){return{level:"pass",domNodes:WebInspectorAudit.Accessibility.getElementsByComputedRole("link"),domAttributes:["role"]}},b=function(){let De={level:"pass"},Me=WebInspectorAudit.Accessibility.getActiveDescendant(document.body);return Me&&(De.domNodes=[Me]),De},w=function(){return{level:"pass",domNodes:WebInspectorAudit.Accessibility.getChildNodes(document.body)||[]}},S=function(){let De=["alt","aria-atomic","aria-busy","aria-checked","aria-current","aria-disabled","aria-expanded","aria-haspopup","aria-hidden","aria-invalid","aria-label","aria-labelledby","aria-level","aria-live","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-selected","role","title"].filter(Je=>document.body.hasAttribute(Je)),Me=WebInspectorAudit.Accessibility.getComputedProperties(document.body);return{level:"pass",domNodes:[document.body],domAttributes:De,...Me||{}}},E=function(){return{level:"pass",domNodes:WebInspectorAudit.Accessibility.getControlledNodes(document.body)||[]}},k=function(){return{level:"pass",domNodes:WebInspectorAudit.Accessibility.getFlowedNodes(document.body)||[]}},R=function(){let De={level:"pass"},Me=WebInspectorAudit.Accessibility.getMouseEventNode(document.body);return Me&&(De.domNodes=[Me]),De},M=function(){return{level:"pass",domNodes:WebInspectorAudit.Accessibility.getOwnedNodes(document.body)||[]}},L=function(){let De={level:"pass"},Me=WebInspectorAudit.Accessibility.getParentNode(document.body);return Me&&(De.domNodes=[Me]),De},V=function(){return{level:"pass",domNodes:WebInspectorAudit.Accessibility.getSelectedChildNodes(document.body)||[]}},H=function(){let De=Array.from(document.body.attributes).filter(Me=>Me.name.startsWith("on"));return{level:"pass",domNodes:[document.body],domAttributes:De,hasEventListeners:WebInspectorAudit.DOM.hasEventListeners(document.body)}},O=function(){let De=["onclick"].filter(Me=>document.body.hasAttribute(Me));return{level:"pass",domNodes:[document.body],domAttributes:De,hasClickEventListener:WebInspectorAudit.DOM.hasEventListeners(document.body,"click")}},z=function(){return{level:"pass",resources:WebInspectorAudit.Resources.getResources()}},K=function(){let Me=WebInspectorAudit.Resources.getResources().find(Je=>Je.url===window.location.href);return{level:"pass",mainResource:Me,resourceContent:WebInspectorAudit.Resources.getResourceContent(Me.id)}},q=function(){const De={menu:["menuitem","menuitemcheckbox","menuitemradio"],menubar:["menuitem","menuitemcheckbox","menuitemradio"]};let Me=[],Je=new Set;function Ct($e,pe){let ee=$e;if(!ee)return!1;for(ee.parentNode&&Je.add(ee.parentNode);ee;){let Ce=WebInspectorAudit.Accessibility.getComputedProperties(ee);if(ee.nodeType===Node.ELEMENT_NODE&&Ce&&(pe.includes(Ce.role)||ee.hasChildNodes()&&Ct(ee.firstChild,pe)))return!0;ee=ee.nextSibling}return!1}for(let $e in De)for(let pe of WebInspectorAudit.Accessibility.getElementsByComputedRole($e))Je.has(pe)||Ct(pe.firstChild,De[$e])||Me.push(pe);return{level:Me.length?"fail":"pass",domNodes:Me,domAttributes:["role"]}},Y=function(){const De={grid:["row","rowgroup"]};let Me=[],Je=new Set;function Ct($e,pe){let ee=$e;if(!ee)return!1;for(ee.parentNode&&Je.add(ee.parentNode);ee;){let Ce=WebInspectorAudit.Accessibility.getComputedProperties(ee);if(ee.nodeType===Node.ELEMENT_NODE&&Ce&&(pe.includes(Ce.role)||ee.hasChildNodes()&&Ct(ee.firstChild,pe)))return!0;ee=ee.nextSibling}return!1}for(let $e in De)for(let pe of WebInspectorAudit.Accessibility.getElementsByComputedRole($e))Je.has(pe)||Ct(pe.firstChild,De[$e])||Me.push(pe);return{level:Me.length?"fail":"pass",domNodes:Me,domAttributes:["role"]}},se=function(){let De=Array.from(document.querySelectorAll("[aria-labeledby]"));return{level:De.length?"fail":"pass",domNodes:De,domAttributes:["aria-labeledby"]}},ce=function(){let De=[],Me=WebInspectorAudit.Accessibility.getElementsByComputedRole("banner");return Me.length>1&&(De=Me),{level:De.length?"fail":"pass",domNodes:De,domAttributes:["role"]}},le=function(){let Me=WebInspectorAudit.Accessibility.getElementsByComputedRole("link").filter(Je=>!WebInspectorAudit.Accessibility.getComputedProperties(Je).label);return{level:Me.length?"fail":"pass",domNodes:Me,domAttributes:["aria-label","aria-labelledby","title"]}},te=function(){const De={rowgroup:["row"]};let Me=[],Je=new Set;function Ct($e,pe){let ee=$e;if(!ee)return!1;for(ee.parentNode&&Je.add(ee.parentNode);ee;){let Ce=WebInspectorAudit.Accessibility.getComputedProperties(ee);if(ee.nodeType===Node.ELEMENT_NODE&&Ce&&(pe.includes(Ce.role)||ee.hasChildNodes()&&Ct(ee.firstChild,pe)))return!0;ee=ee.nextSibling}return!1}for(let $e in De)for(let pe of WebInspectorAudit.Accessibility.getElementsByComputedRole($e))Je.has(pe)||Ct(pe.firstChild,De[$e])||Me.push(pe);return{level:Me.length?"fail":"pass",domNodes:Me,domAttributes:["role"]}},ve=function(){const De={table:["row","rowgroup"]};let Me=[],Je=new Set;function Ct($e,pe){let ee=$e;if(!ee)return!1;for(ee.parentNode&&Je.add(ee.parentNode);ee;){let Ce=WebInspectorAudit.Accessibility.getComputedProperties(ee);if(ee.nodeType===Node.ELEMENT_NODE&&Ce&&(pe.includes(Ce.role)||ee.hasChildNodes()&&Ct(ee.firstChild,pe)))return!0;ee=ee.nextSibling}return!1}for(let $e in De)for(let pe of WebInspectorAudit.Accessibility.getElementsByComputedRole($e))Je.has(pe)||Ct(pe.firstChild,De[$e])||Me.push(pe);return{level:Me.length?"fail":"pass",domNodes:Me,domAttributes:["role"]}},Pe=function(){const De=["alert","log","status","marquee","timer"];let Me=[],Je=De.reduce((Ct,$e)=>Ct.concat(WebInspectorAudit.Accessibility.getElementsByComputedRole($e)),[]);return Je=Je.concat(Array.from(document.querySelectorAll('[aria-live="polite"], [aria-live="assertive"]'))),Je.length>1&&(Me=Je),{level:Me.length?"warn":"pass",domNodes:Me,domAttributes:["aria-live"]}},Be=function(){const De={listbox:["option"]};let Me=[],Je=new Set;function Ct($e,pe){let ee=$e;if(!ee)return!1;for(ee.parentNode&&Je.add(ee.parentNode);ee;){let Ce=WebInspectorAudit.Accessibility.getComputedProperties(ee);if(ee.nodeType===Node.ELEMENT_NODE&&Ce&&(pe.includes(Ce.role)||ee.hasChildNodes()&&Ct(ee.firstChild,pe)))return!0;ee=ee.nextSibling}return!1}for(let $e in De)for(let pe of WebInspectorAudit.Accessibility.getElementsByComputedRole($e))Je.has(pe)||Ct(pe.firstChild,De[$e])||Me.push(pe);return{level:Me.length?"fail":"pass",domNodes:Me,domAttributes:["role"]}},qe=function(){let Me=WebInspectorAudit.Accessibility.getElementsByComputedRole("img").filter(Je=>!WebInspectorAudit.Accessibility.getComputedProperties(Je).label);return{level:Me.length?"fail":"pass",domNodes:Me,domAttributes:["aria-label","aria-labelledby","title","alt"]}},Ue=function(){let De=Array.from(document.querySelectorAll('[aria-hidden="false"]'));return{level:De.length?"warn":"pass",domNodes:De,domAttributes:["aria-hidden"]}},Ge=function(){const De={tree:["treeitem","group"]};let Me=[],Je=new Set;function Ct($e,pe){let ee=$e;if(!ee)return!1;for(ee.parentNode&&Je.add(ee.parentNode);ee;){let Ce=WebInspectorAudit.Accessibility.getComputedProperties(ee);if(ee.nodeType===Node.ELEMENT_NODE&&Ce&&(pe.includes(Ce.role)||ee.hasChildNodes()&&Ct(ee.firstChild,pe)))return!0;ee=ee.nextSibling}return!1}for(let $e in De)for(let pe of WebInspectorAudit.Accessibility.getElementsByComputedRole($e))Je.has(pe)||Ct(pe.firstChild,De[$e])||Me.push(pe);return{level:Me.length?"fail":"pass",domNodes:Me,domAttributes:["role"]}},it=function(){const De={radiogroup:["radio"]};let Me=[],Je=new Set;function Ct($e,pe){let ee=$e;if(!ee)return!1;for(ee.parentNode&&Je.add(ee.parentNode);ee;){let Ce=WebInspectorAudit.Accessibility.getComputedProperties(ee);if(ee.nodeType===Node.ELEMENT_NODE&&Ce&&(pe.includes(Ce.role)||ee.hasChildNodes()&&Ct(ee.firstChild,pe)))return!0;ee=ee.nextSibling}return!1}for(let $e in De)for(let pe of WebInspectorAudit.Accessibility.getElementsByComputedRole($e))Je.has(pe)||Ct(pe.firstChild,De[$e])||Me.push(pe);return{level:Me.length?"fail":"pass",domNodes:Me,domAttributes:["role"]}},lt=function(){const De={feed:["article"]};let Me=[],Je=new Set;function Ct($e,pe){let ee=$e;if(!ee)return!1;for(ee.parentNode&&Je.add(ee.parentNode);ee;){let Ce=WebInspectorAudit.Accessibility.getComputedProperties(ee);if(ee.nodeType===Node.ELEMENT_NODE&&Ce&&(pe.includes(Ce.role)||ee.hasChildNodes()&&Ct(ee.firstChild,pe)))return!0;ee=ee.nextSibling}return!1}for(let $e in De)for(let pe of WebInspectorAudit.Accessibility.getElementsByComputedRole($e))Je.has(pe)||Ct(pe.firstChild,De[$e])||Me.push(pe);return{level:Me.length?"fail":"pass",domNodes:Me,domAttributes:["role"]}},bt=function(){const De={tablist:["tab"]};let Me=[],Je=new Set;function Ct($e,pe){let ee=$e;if(!ee)return!1;for(ee.parentNode&&Je.add(ee.parentNode);ee;){let Ce=WebInspectorAudit.Accessibility.getComputedProperties(ee);if(ee.nodeType===Node.ELEMENT_NODE&&Ce&&(pe.includes(Ce.role)||ee.hasChildNodes()&&Ct(ee.firstChild,pe)))return!0;ee=ee.nextSibling}return!1}for(let $e in De)for(let pe of WebInspectorAudit.Accessibility.getElementsByComputedRole($e))Je.has(pe)||Ct(pe.firstChild,De[$e])||Me.push(pe);return{level:Me.length?"fail":"pass",domNodes:Me,domAttributes:["role"]}},Yt=function(){let Me=WebInspectorAudit.Accessibility.getElementsByComputedRole("button").filter(Je=>!WebInspectorAudit.Accessibility.getComputedProperties(Je).label);return{level:Me.length?"fail":"pass",domNodes:Me,domAttributes:["aria-label","aria-labelledby","title"]}},ni=function(){const De={row:["cell","gridcell","columnheader","rowheader"]};let Me=[],Je=new Set;function Ct($e,pe){let ee=$e;if(!ee)return!1;for(ee.parentNode&&Je.add(ee.parentNode);ee;){let Ce=WebInspectorAudit.Accessibility.getComputedProperties(ee);if(ee.nodeType===Node.ELEMENT_NODE&&Ce&&(pe.includes(Ce.role)||ee.hasChildNodes()&&Ct(ee.firstChild,pe)))return!0;ee=ee.nextSibling}return!1}for(let $e in De)for(let pe of WebInspectorAudit.Accessibility.getElementsByComputedRole($e))Je.has(pe)||Ct(pe.firstChild,De[$e])||Me.push(pe);return{level:Me.length?"fail":"pass",domNodes:Me,domAttributes:["role"]}},ri=function(){const De={list:["listitem","group"]};let Me=[],Je=new Set;function Ct($e,pe){let ee=$e;if(!ee)return!1;for(ee.parentNode&&Je.add(ee.parentNode);ee;){let Ce=WebInspectorAudit.Accessibility.getComputedProperties(ee);if(ee.nodeType===Node.ELEMENT_NODE&&Ce&&(pe.includes(Ce.role)||ee.hasChildNodes()&&Ct(ee.firstChild,pe)))return!0;ee=ee.nextSibling}return!1}for(let $e in De)for(let pe of WebInspectorAudit.Accessibility.getElementsByComputedRole($e))Je.has(pe)||Ct(pe.firstChild,De[$e])||Me.push(pe);return{level:Me.length?"warn":"pass",domNodes:Me,domAttributes:["role"]}},He=function(){const De={combobox:["textbox","listbox","tree","grid","dialog"]};let Me=[],Je=new Set;function Ct($e,pe){let ee=$e;if(!ee)return!1;for(ee.parentNode&&Je.add(ee.parentNode);ee;){let Ce=WebInspectorAudit.Accessibility.getComputedProperties(ee);if(ee.nodeType===Node.ELEMENT_NODE&&Ce&&(pe.includes(Ce.role)||ee.hasChildNodes()&&Ct(ee.firstChild,pe)))return!0;ee=ee.nextSibling}return!1}for(let $e in De)for(let pe of WebInspectorAudit.Accessibility.getElementsByComputedRole($e))Je.has(pe)||Ct(pe.firstChild,De[$e])||Me.push(pe);return{level:Me.length?"fail":"pass",domNodes:Me,domAttributes:["role"]}},ei=function(){let De=[],Me=WebInspectorAudit.Accessibility.getElementsByComputedRole("main");return Me.length>1&&(De=Me),{level:De.length?"fail":"pass",domNodes:De,domAttributes:["role"]}},ui=function(){let Me=WebInspectorAudit.Accessibility.getElementsByComputedRole("dialog").filter(Je=>!WebInspectorAudit.Accessibility.getComputedProperties(Je).label);return{level:Me.length?"fail":"pass",domNodes:Me,domAttributes:["aria-label","aria-labelledby","title"]}},vi=function(){let De=Array.from(document.querySelectorAll('[aria-hidden]:not([aria-hidden="true"], [aria-hidden="false"])'));return{level:De.length?"fail":"pass",domNodes:De,domAttributes:["aria-hidden"]}};function Xe(De){return De.toString().replace(/\s+/g," ")}const bi=[new WI.AuditTestGroup(WI.UIString("Demo Audit"),[new WI.AuditTestGroup(WI.UIString("Result Levels"),[new WI.AuditTestCase("level-pass",Xe(e),{description:WI.UIString("This is what the result of a passing test with no data looks like.")}),new WI.AuditTestCase("level-warn",Xe(t),{description:WI.UIString("This is what the result of a warning test with no data looks like.")}),new WI.AuditTestCase("level-fail",Xe(i),{description:WI.UIString("This is what the result of a failing test with no data looks like.")}),new WI.AuditTestCase("level-error",Xe(n),{description:WI.UIString("This is what the result of a test that threw an error with no data looks like.")}),new WI.AuditTestCase("level-unsupported",Xe(s),{description:WI.UIString("This is what the result of an unsupported test with no data looks like.")})],{description:WI.UIString("These are all of the different test result levels.")}),new WI.AuditTestGroup(WI.UIString("Result Data"),[new WI.AuditTestCase("data-domNodes",Xe(a),{description:WI.UIString("This is an example of how result DOM nodes are shown. It will pass with the <body> element.")}),new WI.AuditTestCase("data-domAttributes",Xe(d),{description:WI.UIString("This is an example of how result DOM attributes are highlighted on any returned DOM nodes. It will pass with all elements with an id attribute.")}),new WI.AuditTestCase("data-errors",Xe(p),{description:WI.UIString("This is an example of how errors are shown. The error was thrown manually, but execution errors will appear in the same way.")}),new WI.AuditTestCase("data-custom",Xe(f),{description:WI.UIString("This is an example of how custom result data is shown."),supports:3})],{description:WI.UIString("These are all of the different types of data that can be returned with the test result.")}),new WI.AuditTestGroup(WI.UIString("Specially Exposed Data"),[new WI.AuditTestGroup(WI.UIString("Accessibility"),[new WI.AuditTestCase("getElementsByComputedRole",Xe(_),{description:WI.UIString('This test will pass with all DOM nodes that have a computed role of "link".'),supports:1}),new WI.AuditTestCase("getActiveDescendant",Xe(b),{description:WI.UIString('This test will pass with the active descendant ("%s") of the <body> element, if it exists.').format(WI.unlocalizedString("aria-activedescendant")),supports:1}),new WI.AuditTestCase("getChildNodes",Xe(w),{description:WI.UIString("This test will pass with all of the child nodes of the <body> element in the accessibility tree."),supports:1}),new WI.AuditTestCase("getComputedProperties",Xe(S),{description:WI.UIString("This test will pass with a variety of accessibility information about the <body> element."),supports:3}),new WI.AuditTestCase("getControlledNodes",Xe(E),{description:WI.UIString('This test will pass with all nodes controlled ("%s") by the <body> element, if any exist.').format(WI.unlocalizedString("aria-controls")),supports:1}),new WI.AuditTestCase("getFlowedNodes",Xe(k),{description:WI.UIString('This test will pass with all nodes flowed to ("%s") from the <body> element, if any exist.').format(WI.unlocalizedString("aria-flowto")),supports:1}),new WI.AuditTestCase("getMouseEventNode",Xe(R),{description:WI.UIString("This test will pass with the node that would handle mouse events for the <body> element, if applicable."),supports:1}),new WI.AuditTestCase("getOwnedNodes",Xe(M),{description:WI.UIString('This test will pass with all nodes owned ("%s") by the <body> element, if any exist.').format(WI.unlocalizedString("aria-owns")),supports:1}),new WI.AuditTestCase("getParentNode",Xe(L),{description:WI.UIString("This test will pass with the parent node of the <body> element in the accessibility tree."),supports:1}),new WI.AuditTestCase("getSelectedChildNodes",Xe(V),{description:WI.UIString('This test will pass with all child nodes that are selected ("%s") of the <body> element in the accessibility tree.').format(WI.unlocalizedString("aria-selected")),supports:1})],{description:WI.UIString("These tests demonstrate how to use %s to get information about the accessibility tree.").format(WI.unlocalizedString("WebInspectorAudit.Accessibility")),supports:1}),new WI.AuditTestGroup(WI.UIString("DOM"),[new WI.AuditTestCase("hasEventListeners",Xe(H),{description:WI.UIString("This test will pass with data indicating whether the <body> element has any event listeners."),supports:3}),new WI.AuditTestCase("hasEventListeners-click",Xe(O),{description:WI.UIString("This test will pass with data indicating whether the <body> element has any click event listeners."),supports:3})],{description:WI.UIString("These tests demonstrate how to use %s to get information about DOM nodes.").format(WI.unlocalizedString("WebInspectorAudit.DOM")),supports:1}),new WI.AuditTestGroup(WI.UIString("Resources"),[new WI.AuditTestCase("getResources",Xe(z),{description:WI.UIString("This test will pass with some basic information about each resource."),supports:3}),new WI.AuditTestCase("getResourceContent",Xe(K),{description:WI.UIString("This test will pass with the contents of the main resource."),supports:3})],{description:WI.UIString("These tests demonstrate how to use %s to get information about loaded resources.").format(WI.unlocalizedString("WebInspectorAudit.Resources")),supports:2})],{description:WI.UIString("These tests demonstrate how to use %s to access information not normally available to JavaScript.").format(WI.unlocalizedString("WebInspectorAudit")),supports:1})],{description:WI.UIString("These tests serve as a demonstration of the functionality and structure of audits.")}),new WI.AuditTestGroup(WI.UIString("Accessibility"),[new WI.AuditTestCase("testMenuRoleForRequiredChidren",Xe(q),{description:WI.UIString('Ensure that element of role "%s" and "%s" have required owned elements in accordance with WAI-ARIA.').format(WI.unlocalizedString("menu"),WI.unlocalizedString("menubar")),supports:1}),new WI.AuditTestCase("testGridRoleForRequiredChidren",Xe(Y),{description:WI.UIString('Ensure that elements of role "%s" have required owned elements in accordance with WAI-ARIA.').format(WI.unlocalizedString("grid")),supports:1}),new WI.AuditTestCase("testForAriaLabelledBySpelling",Xe(se),{description:WI.UIString('Ensure that "%s" is spelled correctly.').format(WI.unlocalizedString("aria-labelledby")),supports:1}),new WI.AuditTestCase("testForMultipleBanners",Xe(ce),{description:WI.UIString("Ensure that only one banner is used on the page."),supports:1}),new WI.AuditTestCase("testForLinkLabels",Xe(le),{description:WI.UIString("Ensure that links have accessible labels for assistive technology."),supports:1}),new WI.AuditTestCase("testRowGroupRoleForRequiredChidren",Xe(te),{description:WI.UIString('Ensure that element of role "%s" have required owned elements in accordance with WAI-ARIA.').format(WI.unlocalizedString("rowgroup")),supports:1}),new WI.AuditTestCase("testTableRoleForRequiredChidren",Xe(ve),{description:WI.UIString('Ensure that elements of role "%s" have required owned elements in accordance with WAI-ARIA.').format(WI.unlocalizedString("table")),supports:1}),new WI.AuditTestCase("testForMultipleLiveRegions",Xe(Pe),{description:WI.UIString("Ensure that only one live region is used on the page."),supports:1}),new WI.AuditTestCase("testListBoxRoleForRequiredChidren",Xe(Be),{description:WI.UIString('Ensure that elements of role "%s" have required owned elements in accordance with WAI-ARIA.').format(WI.unlocalizedString("listbox")),supports:1}),new WI.AuditTestCase("testImageLabels",Xe(qe),{description:WI.UIString('Ensure that elements of role "%s" have accessible labels for assistive technology.').format(WI.unlocalizedString("img")),supports:1}),new WI.AuditTestCase("testForAriaHiddenFalse",Xe(Ue),{description:WI.UIString('Ensure aria-hidden="%s" is not used.').format(WI.unlocalizedString("false")),supports:1}),new WI.AuditTestCase("testTreeRoleForRequiredChidren",Xe(Ge),{description:WI.UIString('Ensure that element of role "%s" have required owned elements in accordance with WAI-ARIA.').format(WI.unlocalizedString("tree")),supports:1}),new WI.AuditTestCase("testRadioGroupRoleForRequiredChidren",Xe(it),{description:WI.UIString('Ensure that element of role "%s" have required owned elements in accordance with WAI-ARIA.').format(WI.unlocalizedString("radiogroup")),supports:1}),new WI.AuditTestCase("testFeedRoleForRequiredChidren",Xe(lt),{description:WI.UIString('Ensure that elements of role "%s" have required owned elements in accordance with WAI-ARIA.').format(WI.unlocalizedString("feed")),supports:1}),new WI.AuditTestCase("testTabListRoleForRequiredChidren",Xe(bt),{description:WI.UIString('Ensure that element of role "%s" have required owned elements in accordance with WAI-ARIA.').format(WI.unlocalizedString("tablist")),supports:1}),new WI.AuditTestCase("testButtonLabels",Xe(Yt),{description:WI.UIString("Ensure that buttons have accessible labels for assistive technology."),supports:1}),new WI.AuditTestCase("testRowRoleForRequiredChidren",Xe(ni),{description:WI.UIString('Ensure that elements of role "%s" have required owned elements in accordance with WAI-ARIA.').format(WI.unlocalizedString("row")),supports:1}),new WI.AuditTestCase("testListRoleForRequiredChidren",Xe(ri),{description:WI.UIString('Ensure that elements of role "%s" have required owned elements in accordance with WAI-ARIA.').format(WI.unlocalizedString("list")),supports:1}),new WI.AuditTestCase("testComboBoxRoleForRequiredChidren",Xe(He),{description:WI.UIString('Ensure that elements of role "%s" have required owned elements in accordance with WAI-ARIA.').format(WI.unlocalizedString("combobox")),supports:1}),new WI.AuditTestCase("testForMultipleMainContentSections",Xe(ei),{description:WI.UIString("Ensure that only one main content section is used on the page."),supports:1}),new WI.AuditTestCase("testDialogsForLabels",Xe(ui),{description:WI.UIString("Ensure that dialogs have accessible labels for assistive technology."),supports:1}),new WI.AuditTestCase("testForInvalidAriaHiddenValue",Xe(vi),{description:WI.UIString('Ensure that values for "%s" are valid.').format(WI.unlocalizedString("aria-hidden")),supports:1})],{description:WI.UIString("Diagnoses common accessibility problems affecting screen readers and other assistive technology.")})];let st=De=>{if(this._disabledDefaultTestsSetting.value.includes(De.name)&&(De.disabled=!0),De instanceof WI.AuditTestGroup)for(let Me of De.tests)st(Me)};for(let De of bi)st(De),De.__default=!0,this._addTest(De)}};WI.AuditManager.RunningState={Disabled:"disabled",Inactive:"inactive",Active:"active",Stopping:"stopping"};WI.AuditManager.Event={EditingChanged:"audit-manager-editing-changed",TestAdded:"audit-manager-test-added",TestCompleted:"audit-manager-test-completed",TestRemoved:"audit-manager-test-removed",TestScheduled:"audit-manager-test-scheduled"};WI.ApplicationCacheManager=class extends WI.Object{constructor(){super(),WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this),WI.Frame.addEventListener(WI.Frame.Event.ChildFrameWasRemoved,this._childFrameWasRemoved,this),this._online=!0,this.initialize()}initializeTarget(e){e.ApplicationCacheAgent&&(e.ApplicationCacheAgent.enable(),e.ApplicationCacheAgent.getFramesWithManifests(this._framesWithManifestsLoaded.bind(this)))}initialize(){this._applicationCacheObjects={}}get applicationCacheObjects(){var e=[];for(var t in this._applicationCacheObjects)e.push(this._applicationCacheObjects[t]);return e}networkStateUpdated(e){this._online=e,this.dispatchEventToListeners(WI.ApplicationCacheManager.Event.NetworkStateUpdated,{online:this._online})}get online(){return this._online}applicationCacheStatusUpdated(e,t,i){var n=WI.networkManager.frameForIdentifier(e);!n||this._frameManifestUpdated(n,t,i)}requestApplicationCache(e,t){function i(n,s){if(n){t(null);return}t(s)}ApplicationCacheAgent.getApplicationCacheForFrame(e.id,i)}_mainResourceDidChange(e){if(console.assert(e.target instanceof WI.Frame),e.target.isMainFrame()){this.initialize(),this.dispatchEventToListeners(WI.ApplicationCacheManager.Event.Cleared);return}window.ApplicationCacheAgent&&ApplicationCacheAgent.getManifestForFrame(e.target.id,this._manifestForFrameLoaded.bind(this,e.target.id))}_childFrameWasRemoved(e){this._frameManifestRemoved(e.data.childFrame)}_manifestForFrameLoaded(e,t,i){if(!t){var n=WI.networkManager.frameForIdentifier(e);!n||i||this._frameManifestRemoved(n)}}_framesWithManifestsLoaded(e,t){if(!e)for(var i=0;i<t.length;++i){var n=WI.networkManager.frameForIdentifier(t[i].frameId);!n||this._frameManifestUpdated(n,t[i].manifestURL,t[i].status)}}_frameManifestUpdated(e,t,i){if(i===WI.ApplicationCacheManager.Status.Uncached){this._frameManifestRemoved(e);return}if(!!t){var n=this._applicationCacheObjects[e.id];n&&t!==n.manifest.manifestURL&&this._frameManifestRemoved(e);var s=n?n.status:-1,a=n&&i!==s;if(n&&(n.status=i),!this._applicationCacheObjects[e.id]){var d=new WI.ApplicationCacheManifest(t);this._applicationCacheObjects[e.id]=new WI.ApplicationCacheFrame(e,d,i),this.dispatchEventToListeners(WI.ApplicationCacheManager.Event.FrameManifestAdded,{frameManifest:this._applicationCacheObjects[e.id]})}a&&this.dispatchEventToListeners(WI.ApplicationCacheManager.Event.FrameManifestStatusChanged,{frameManifest:this._applicationCacheObjects[e.id]})}}_frameManifestRemoved(e){!this._applicationCacheObjects[e.id]||(delete this._applicationCacheObjects[e.id],this.dispatchEventToListeners(WI.ApplicationCacheManager.Event.FrameManifestRemoved,{frame:e}))}};WI.ApplicationCacheManager.Event={Cleared:"application-cache-manager-cleared",FrameManifestAdded:"application-cache-manager-frame-manifest-added",FrameManifestRemoved:"application-cache-manager-frame-manifest-removed",FrameManifestStatusChanged:"application-cache-manager-frame-manifest-status-changed",NetworkStateUpdated:"application-cache-manager-network-state-updated"};WI.ApplicationCacheManager.Status={Uncached:0,Idle:1,Checking:2,Downloading:3,UpdateReady:4,Obsolete:5};WI.BasicBlockAnnotator=class extends WI.Annotator{constructor(e,t){super(e),this._script=t,this._basicBlockMarkers=new Map}clearAnnotations(){for(var e of this._basicBlockMarkers.keys())this._clearRangeForBasicBlockMarker(e)}insertAnnotations(){!this.isActive()||this._script.requestContent().then(this._annotateBasicBlockExecutionRanges.bind(this))}_calculateBasicBlockPositions(e,t){if(!e||!e.length)return;let i=[],n=[],s=/\r\n?|\n/g,a=s.exec(t);for(;a;)i.push(a.index),n.push(a[0].length),a=s.exec(t);function d(p){let f=i.upperBound(p-1);if(f){let b=f-1;var _=p-i[b]-n[b]}else var _=p;return new WI.SourceCodePosition(f,_)}for(let p of e)p.startPosition=d(p.startOffset),p.endPosition=d(p.endOffset)}_annotateBasicBlockExecutionRanges(){let e=this._script.content;if(console.assert(e,"Missing script content for basic block annotations."),!!e){var t=this._script.id,i=Date.now();this._script.target.RuntimeAgent.getBasicBlocks(t,function(n,s){if(n){console.error("Error in getting basic block locations: "+n);return}if(!this.isActive())return;this._calculateBasicBlockPositions(s,e);let{startPosition:a,endPosition:d}=this.sourceCodeTextEditor.visibleRangePositions();s=s.filter(function(k){return!(k.startPosition.isAfter(d)||k.endPosition.isBefore(a))});for(var p of s){var f=p.startOffset+":"+p.endOffset,_=this._basicBlockMarkers.has(f),b=p.hasExecuted;if(_&&b)this._clearRangeForBasicBlockMarker(f);else if(!_&&!b){var w=this._highlightTextForBasicBlock(p);this._basicBlockMarkers.set(f,w)}}var S=Date.now()-i,E=Number.constrain(30*S,500,5e3);this._timeoutIdentifier=setTimeout(this.insertAnnotations.bind(this),E)}.bind(this))}}_highlightTextForBasicBlock(e){console.assert(e.startOffset<=e.endOffset&&e.startOffset>=0&&e.endOffset>=0,""+e.startOffset+":"+e.endOffset),console.assert(!e.hasExecuted);let t=this.sourceCodeTextEditor.originalPositionToCurrentPosition(e.startPosition),i=this.sourceCodeTextEditor.originalPositionToCurrentPosition(e.endPosition);return this._isTextRangeOnlyClosingBrace(t,i)?null:this.sourceCodeTextEditor.addStyleToTextRange(t,i,WI.BasicBlockAnnotator.HasNotExecutedClassName)}_isTextRangeOnlyClosingBrace(e,t){var i=/^\s*\}$/;return i.test(this.sourceCodeTextEditor.getTextInRange(e,t))}_clearRangeForBasicBlockMarker(e){console.assert(this._basicBlockMarkers.has(e));var t=this._basicBlockMarkers.get(e);t&&t.clear(),this._basicBlockMarkers.delete(e)}};WI.BasicBlockAnnotator.HasNotExecutedClassName="basic-block-has-not-executed";WI.BranchManager=class extends WI.Object{constructor(){super(),WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this),this.initialize()}initialize(){this._originalBranch=new WI.Branch(WI.UIString("Original"),null,!0),this._currentBranch=this._originalBranch.fork(WI.UIString("Working Copy")),this._branches=[this._originalBranch,this._currentBranch]}get branches(){return this._branches}get currentBranch(){return this._currentBranch}set currentBranch(e){console.assert(e instanceof WI.Branch),e instanceof WI.Branch&&(this._currentBranch.revert(),this._currentBranch=e,this._currentBranch.apply())}createBranch(e,t){if(t||(t=this._originalBranch),console.assert(t instanceof WI.Branch),!(t instanceof WI.Branch))return null;var i=t.fork(e);return this._branches.push(i),i}deleteBranch(e){console.assert(e instanceof WI.Branch),e instanceof WI.Branch&&(console.assert(e!==this._originalBranch),e!==this._originalBranch&&(this._branches.remove(e),e===this._currentBranch&&(this._currentBranch=this._originalBranch)))}_mainResourceDidChange(e){console.assert(e.target instanceof WI.Frame),e.target.isMainFrame()&&this.initialize()}};WI.BreakpointLogMessageLexer=class extends WI.Object{constructor(){super(),this._stateFunctions={[WI.BreakpointLogMessageLexer.State.Expression]:this._expression,[WI.BreakpointLogMessageLexer.State.PlainText]:this._plainText,[WI.BreakpointLogMessageLexer.State.PossiblePlaceholder]:this._possiblePlaceholder,[WI.BreakpointLogMessageLexer.State.RegExpOrStringLiteral]:this._regExpOrStringLiteral},this.reset()}tokenize(e){for(this.reset(),this._input=e;this._index<this._input.length;){let t=this._stateFunctions[this._states.lastValue];if(console.assert(t),!t)return this.reset(),null;t.call(this)}return this._finishPlainText(),this._tokens}reset(){this._input="",this._buffer="",this._index=0,this._states=[WI.BreakpointLogMessageLexer.State.PlainText],this._literalStartCharacter="",this._curlyBraceDepth=0,this._tokens=[]}_finishPlainText(){this._appendToken(WI.BreakpointLogMessageLexer.TokenType.PlainText)}_finishExpression(){this._appendToken(WI.BreakpointLogMessageLexer.TokenType.Expression)}_appendToken(e){!this._buffer||(this._tokens.push({type:e,data:this._buffer}),this._buffer="")}_consume(){console.assert(this._index<this._input.length);let e=this._peek();return this._index++,e}_peek(){return this._input[this._index]||null}_expression(){let e=this._consume();if(e==="}"){if(this._curlyBraceDepth===0){this._finishExpression(),console.assert(this._states.lastValue===WI.BreakpointLogMessageLexer.State.Expression),this._states.pop();return}this._curlyBraceDepth--}this._buffer+=e,e==="/"||e==='"'||e==="'"?(this._literalStartCharacter=e,this._states.push(WI.BreakpointLogMessageLexer.State.RegExpOrStringLiteral)):e==="{"&&this._curlyBraceDepth++}_plainText(){let e=this._peek();e==="$"?this._states.push(WI.BreakpointLogMessageLexer.State.PossiblePlaceholder):(this._buffer+=e,this._consume())}_possiblePlaceholder(){let e=this._consume();console.assert(e==="$");let t=this._peek();console.assert(this._states.lastValue===WI.BreakpointLogMessageLexer.State.PossiblePlaceholder),this._states.pop(),t==="{"?(this._finishPlainText(),this._consume(),this._states.push(WI.BreakpointLogMessageLexer.State.Expression)):this._buffer+=e}_regExpOrStringLiteral(){let e=this._consume();if(this._buffer+=e,e==="\\"){this._peek()!==null&&(this._buffer+=this._consume());return}e===this._literalStartCharacter&&(console.assert(this._states.lastValue===WI.BreakpointLogMessageLexer.State.RegExpOrStringLiteral),this._states.pop())}};WI.BreakpointLogMessageLexer.State={Expression:Symbol("expression"),PlainText:Symbol("plain-text"),PossiblePlaceholder:Symbol("possible-placeholder"),RegExpOrStringLiteral:Symbol("regexp-or-string-literal")};WI.BreakpointLogMessageLexer.TokenType={PlainText:"token-type-plain-text",Expression:"token-type-expression"};WI.BreakpointPopoverController=class extends WI.Object{constructor(){super(),this._breakpoint=null,this._popover=null,this._popoverContentElement=null}appendContextMenuItems(e,t,i){console.assert(document.body.contains(i),"Breakpoint popover display element must be in the DOM.");const n=()=>{if(console.assert(!this._popover,"Breakpoint popover already exists."),this._popover)return;this._createPopoverContent(t),this._popover=new WI.Popover(this),this._popover.content=this._popoverContentElement;let f=WI.Rect.rectFromClientRect(i.getBoundingClientRect());f.origin.x-=1,this._popover.present(f.pad(2),[WI.RectEdge.MAX_Y])},s=()=>{WI.debuggerManager.removeBreakpoint(t)},a=()=>{t.disabled=!t.disabled},d=()=>{t.autoContinue=!t.autoContinue},p=()=>{const f={ignoreNetworkTab:!0,ignoreSearchTab:!0};WI.showOriginalOrFormattedSourceCodeLocation(t.sourceCodeLocation,f)};WI.debuggerManager.isBreakpointEditable(t)&&e.appendItem(WI.UIString("Edit Breakpoint\u2026"),n),t.autoContinue&&!t.disabled?(e.appendItem(WI.UIString("Disable Breakpoint"),a),e.appendItem(WI.UIString("Cancel Automatic Continue"),d)):t.disabled?e.appendItem(WI.UIString("Enable Breakpoint"),a):e.appendItem(WI.UIString("Disable Breakpoint"),a),!t.autoContinue&&!t.disabled&&t.actions.length&&e.appendItem(WI.UIString("Set to Automatically Continue"),d),WI.debuggerManager.isBreakpointRemovable(t)&&e.appendItem(WI.UIString("Delete Breakpoint"),s),t._sourceCodeLocation.hasMappedLocation()&&(e.appendSeparator(),e.appendItem(WI.UIString("Reveal in Original Resource"),p))}completionControllerShouldAllowEscapeCompletion(){return!1}_createPopoverContent(e){if(console.assert(!this._popoverContentElement,"Popover content element already exists."),this._popoverContentElement)return;this._breakpoint=e,this._popoverContentElement=document.createElement("div"),this._popoverContentElement.className="edit-breakpoint-popover-content";let t=document.createElement("input");t.type="checkbox",t.checked=!this._breakpoint.disabled,t.addEventListener("change",this._popoverToggleEnabledCheckboxChanged.bind(this));let i=document.createElement("label");i.className="toggle",i.appendChild(t),i.append(this._breakpoint.sourceCodeLocation.displayLocationString());let n=document.createElement("table"),s=n.appendChild(document.createElement("tr")),a=s.appendChild(document.createElement("th")),d=s.appendChild(document.createElement("td")),p=a.appendChild(document.createElement("label"));p.textContent=WI.UIString("Condition");let f=d.appendChild(document.createElement("div"));f.classList.add("edit-breakpoint-popover-condition",WI.SyntaxHighlightedStyleClassName),this._conditionCodeMirror=WI.CodeMirrorEditor.create(f,{extraKeys:{Tab:!1},lineWrapping:!1,mode:"text/javascript",matchBrackets:!0,placeholder:WI.UIString("Conditional expression"),scrollbarStyle:null,value:this._breakpoint.condition||""});let _=this._conditionCodeMirror.getInputField();if(_.id="codemirror-condition-input-field",p.setAttribute("for",_.id),this._conditionCodeMirrorEscapeOrEnterKeyHandler=this._conditionCodeMirrorEscapeOrEnterKey.bind(this),this._conditionCodeMirror.addKeyMap({Esc:this._conditionCodeMirrorEscapeOrEnterKeyHandler,Enter:this._conditionCodeMirrorEscapeOrEnterKeyHandler}),this._conditionCodeMirror.on("change",this._conditionCodeMirrorChanged.bind(this)),this._conditionCodeMirror.on("beforeChange",this._conditionCodeMirrorBeforeChange.bind(this)),new WI.CodeMirrorCompletionController(this._conditionCodeMirror,this).addExtendedCompletionProvider("javascript",WI.javaScriptRuntimeCompletionProvider),setTimeout(()=>{this._conditionCodeMirror.refresh(),this._conditionCodeMirror.focus()},0),InspectorBackend.domains.CSS.getSupportedSystemFontFamilyNames){let z=n.appendChild(document.createElement("tr")),q=z.appendChild(document.createElement("th")).appendChild(document.createElement("label")),Y=z.appendChild(document.createElement("td"));this._ignoreCountInput=Y.appendChild(document.createElement("input")),this._ignoreCountInput.id="edit-breakpoint-popover-ignore",this._ignoreCountInput.type="number",this._ignoreCountInput.min=0,this._ignoreCountInput.value=0,this._ignoreCountInput.addEventListener("change",this._popoverIgnoreInputChanged.bind(this)),q.setAttribute("for",this._ignoreCountInput.id),q.textContent=WI.UIString("Ignore"),this._ignoreCountText=Y.appendChild(document.createElement("span")),this._updateIgnoreCountText()}let w=n.appendChild(document.createElement("tr")),S=w.appendChild(document.createElement("th")),E=this._actionsContainer=w.appendChild(document.createElement("td")),k=S.appendChild(document.createElement("label"));if(k.textContent=WI.UIString("Action"),!this._breakpoint.actions.length)this._popoverActionsCreateAddActionButton();else{this._popoverContentElement.classList.add(WI.BreakpointPopoverController.WidePopoverClassName);for(let z=0;z<this._breakpoint.actions.length;++z){let K=new WI.BreakpointActionView(this._breakpoint.actions[z],this,!0);this._popoverActionsInsertBreakpointActionView(K,z)}}let R=this._popoverOptionsRowElement=n.appendChild(document.createElement("tr"));this._breakpoint.actions.length||R.classList.add(WI.BreakpointPopoverController.HiddenStyleClassName);let M=R.appendChild(document.createElement("th")),L=R.appendChild(document.createElement("td")),V=M.appendChild(document.createElement("label")),H=this._popoverOptionsCheckboxElement=L.appendChild(document.createElement("input")),O=L.appendChild(document.createElement("label"));H.id="edit-breakpoint-popover-auto-continue",H.type="checkbox",H.checked=this._breakpoint.autoContinue,H.addEventListener("change",this._popoverToggleAutoContinueCheckboxChanged.bind(this)),V.textContent=WI.UIString("Options"),O.setAttribute("for",H.id),O.textContent=WI.UIString("Automatically continue after evaluating"),this._popoverContentElement.appendChild(i),this._popoverContentElement.appendChild(n)}_popoverToggleEnabledCheckboxChanged(e){this._breakpoint.disabled=!e.target.checked}_conditionCodeMirrorChanged(e,t){this._breakpoint.condition=(e.getValue()||"").trim()}_conditionCodeMirrorBeforeChange(e,t){if(t.update){let i=t.text.join("").replace(/\n/g,"");t.update(t.from,t.to,[i])}return!0}_conditionCodeMirrorEscapeOrEnterKey(){!this._popover||this._popover.dismiss()}_popoverIgnoreInputChanged(e){let t=0;e.target.value&&(t=parseInt(e.target.value,10),(isNaN(t)||t<0)&&(t=0)),this._ignoreCountInput.value=t,this._breakpoint.ignoreCount=t,this._updateIgnoreCountText()}_popoverToggleAutoContinueCheckboxChanged(e){this._breakpoint.autoContinue=e.target.checked}_popoverActionsCreateAddActionButton(){this._popoverContentElement.classList.remove(WI.BreakpointPopoverController.WidePopoverClassName),this._actionsContainer.removeChildren();let e=this._actionsContainer.appendChild(document.createElement("button"));e.textContent=WI.UIString("Add Action"),e.addEventListener("click",this._popoverActionsAddActionButtonClicked.bind(this))}_popoverActionsAddActionButtonClicked(e){this._popoverContentElement.classList.add(WI.BreakpointPopoverController.WidePopoverClassName),this._actionsContainer.removeChildren();let t=this._breakpoint.createAction(WI.BreakpointAction.Type.Log),i=new WI.BreakpointActionView(t,this);this._popoverActionsInsertBreakpointActionView(i,-1),this._popoverOptionsRowElement.classList.remove(WI.BreakpointPopoverController.HiddenStyleClassName),this._popover.update()}_popoverActionsInsertBreakpointActionView(e,t){if(t===-1)this._actionsContainer.appendChild(e.element);else{let i=this._actionsContainer.children[t+1]||null;this._actionsContainer.insertBefore(e.element,i)}}_updateIgnoreCountText(){this._breakpoint.ignoreCount===1?this._ignoreCountText.textContent=WI.UIString("time before stopping"):this._ignoreCountText.textContent=WI.UIString("times before stopping")}breakpointActionViewAppendActionView(e,t){let i=new WI.BreakpointActionView(t,this),n=0,s=this._actionsContainer.children;for(let a=0;s.length;++a)if(s[a]===e.element){n=a;break}this._popoverActionsInsertBreakpointActionView(i,n),this._popoverOptionsRowElement.classList.remove(WI.BreakpointPopoverController.HiddenStyleClassName),this._popover.update()}breakpointActionViewRemoveActionView(e){e.element.remove(),this._actionsContainer.children.length||(this._popoverActionsCreateAddActionButton(),this._popoverOptionsRowElement.classList.add(WI.BreakpointPopoverController.HiddenStyleClassName),this._popoverOptionsCheckboxElement.checked=!1),this._popover.update()}breakpointActionViewResized(e){this._popover.update()}willDismissPopover(e){console.assert(this._popover===e),this._popoverContentElement=null,this._popoverOptionsRowElement=null,this._popoverOptionsCheckboxElement=null,this._actionsContainer=null,this._popover=null}didDismissPopover(e){let t=this._breakpoint.actions.filter(function(i){return i.type!==WI.BreakpointAction.Type.Evaluate&&i.type!==WI.BreakpointAction.Type.Probe?!1:!(i.data&&i.data.trim())});for(let i of t)this._breakpoint.removeAction(i);this._breakpoint=null}};WI.BreakpointPopoverController.WidePopoverClassName="wide";WI.BreakpointPopoverController.HiddenStyleClassName="hidden";WI.CSSManager=class extends WI.Object{constructor(){super(),WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this),WI.Frame.addEventListener(WI.Frame.Event.ResourceWasAdded,this._resourceAdded,this),WI.Resource.addEventListener(WI.SourceCode.Event.ContentDidChange,this._resourceContentDidChange,this),WI.Resource.addEventListener(WI.Resource.Event.TypeDidChange,this._resourceTypeDidChange,this),WI.DOMNode.addEventListener(WI.DOMNode.Event.AttributeModified,this._nodeAttributesDidChange,this),WI.DOMNode.addEventListener(WI.DOMNode.Event.AttributeRemoved,this._nodeAttributesDidChange,this),WI.DOMNode.addEventListener(WI.DOMNode.Event.EnabledPseudoClassesChanged,this._nodePseudoClassesDidChange,this),this._colorFormatSetting=new WI.Setting("default-color-format",WI.Color.Format.Original),this._styleSheetIdentifierMap=new Map,this._styleSheetFrameURLMap=new Map,this._nodeStylesMap={},this._modifiedStyles=new Map,this._defaultAppearance=null,this._forcedAppearance=null,this._fetchedInitialStyleSheets=InspectorBackend.domains.CSS.hasEvent("styleSheetAdded")}initializeTarget(e){e.CSSAgent&&e.CSSAgent.enable()}static protocolStyleSheetOriginToEnum(e){switch(e){case CSSAgent.StyleSheetOrigin.Regular:return WI.CSSStyleSheet.Type.Author;case CSSAgent.StyleSheetOrigin.User:return WI.CSSStyleSheet.Type.User;case CSSAgent.StyleSheetOrigin.UserAgent:return WI.CSSStyleSheet.Type.UserAgent;case CSSAgent.StyleSheetOrigin.Inspector:return WI.CSSStyleSheet.Type.Inspector;default:return console.assert(!1,"Unknown CSS.StyleSheetOrigin",e),CSSAgent.StyleSheetOrigin.Regular}}static protocolMediaSourceToEnum(e){switch(e){case CSSAgent.CSSMediaSource.MediaRule:return WI.CSSMedia.Type.MediaRule;case CSSAgent.CSSMediaSource.ImportRule:return WI.CSSMedia.Type.ImportRule;case CSSAgent.CSSMediaSource.LinkedSheet:return WI.CSSMedia.Type.LinkedStyleSheet;case CSSAgent.CSSMediaSource.InlineSheet:return WI.CSSMedia.Type.InlineStyleSheet;default:return console.assert(!1,"Unknown CSS.CSSMediaSource",e),WI.CSSMedia.Type.MediaRule}}static displayNameForPseudoId(e){if(!InspectorBackend.domains.CSS.PseudoId)switch(e){case 1:return WI.unlocalizedString("::first-line");case 2:return WI.unlocalizedString("::first-letter");case 3:return WI.unlocalizedString("::marker");case 4:return WI.unlocalizedString("::before");case 5:return WI.unlocalizedString("::after");case 6:return WI.unlocalizedString("::selection");case 7:return WI.unlocalizedString("::scrollbar");case 8:return WI.unlocalizedString("::scrollbar-thumb");case 9:return WI.unlocalizedString("::scrollbar-button");case 10:return WI.unlocalizedString("::scrollbar-track");case 11:return WI.unlocalizedString("::scrollbar-track-piece");case 12:return WI.unlocalizedString("::scrollbar-corner");case 13:return WI.unlocalizedString("::resizer");default:return console.error("Unknown pseudo id",e),""}switch(e){case InspectorBackend.domains.CSS.PseudoId.FirstLine:return WI.unlocalizedString("::first-line");case InspectorBackend.domains.CSS.PseudoId.FirstLetter:return WI.unlocalizedString("::first-letter");case InspectorBackend.domains.CSS.PseudoId.Marker:return WI.unlocalizedString("::marker");case InspectorBackend.domains.CSS.PseudoId.Before:return WI.unlocalizedString("::before");case InspectorBackend.domains.CSS.PseudoId.After:return WI.unlocalizedString("::after");case InspectorBackend.domains.CSS.PseudoId.Selection:return WI.unlocalizedString("::selection");case InspectorBackend.domains.CSS.PseudoId.Scrollbar:return WI.unlocalizedString("::scrollbar");case InspectorBackend.domains.CSS.PseudoId.ScrollbarThumb:return WI.unlocalizedString("::scrollbar-thumb");case InspectorBackend.domains.CSS.PseudoId.ScrollbarButton:return WI.unlocalizedString("::scrollbar-button");case InspectorBackend.domains.CSS.PseudoId.ScrollbarTrack:return WI.unlocalizedString("::scrollbar-track");case InspectorBackend.domains.CSS.PseudoId.ScrollbarTrackPiece:return WI.unlocalizedString("::scrollbar-track-piece");case InspectorBackend.domains.CSS.PseudoId.ScrollbarCorner:return WI.unlocalizedString("::scrollbar-corner");case InspectorBackend.domains.CSS.PseudoId.Resizer:return WI.unlocalizedString("::resizer");default:return console.error("Unknown pseudo id",e),""}}get preferredColorFormat(){return this._colorFormatSetting.value}get styleSheets(){return Array.from(this._styleSheetIdentifierMap.values())}get defaultAppearance(){return this._defaultAppearance}get forcedAppearance(){return this._forcedAppearance}set forcedAppearance(e){if(!this.canForceAppearance())return;let t="";switch(e){case WI.CSSManager.Appearance.Light:t=PageAgent.Appearance.Light;break;case WI.CSSManager.Appearance.Dark:t=PageAgent.Appearance.Dark;break;case null:case void 0:case"":t="";break;default:return}this._forcedAppearance=e||null,PageAgent.setForcedAppearance(t).then(()=>{this.mediaQueryResultChanged(),this.dispatchEventToListeners(WI.CSSManager.Event.ForcedAppearanceDidChange,{appearance:this._forcedAppearance})})}canForceAppearance(){return window.PageAgent&&!!PageAgent.setForcedAppearance&&this._defaultAppearance}canForcePseudoClasses(){return window.CSSAgent&&!!CSSAgent.forcePseudoState}propertyNameHasOtherVendorPrefix(e){if(!e||e.length<4||e.charAt(0)!=="-")return!1;var t=e.match(/^(?:-moz-|-ms-|-o-|-epub-)/);return!!t}propertyValueHasOtherVendorKeyword(e){var t=e.match(/(?:-moz-|-ms-|-o-|-epub-)[-\w]+/);return!!t}canonicalNameForPropertyName(e){if(!e||e.length<8||e.charAt(0)!=="-")return e;var t=e.match(/^(?:-webkit-|-khtml-|-apple-)(.+)/);return t?t[1]:e}fetchStyleSheetsIfNeeded(){this._fetchedInitialStyleSheets||this._fetchInfoForAllStyleSheets(function(){})}styleSheetForIdentifier(e){let t=this._styleSheetIdentifierMap.get(e);return t||(t=new WI.CSSStyleSheet(e),this._styleSheetIdentifierMap.set(e,t),t)}stylesForNode(e){if(e.id in this._nodeStylesMap)return this._nodeStylesMap[e.id];var t=new WI.DOMNodeStyles(e);return this._nodeStylesMap[e.id]=t,t}inspectorStyleSheetsForFrame(e){return this.styleSheets.filter(t=>t.isInspectorStyleSheet()&&t.parentFrame===e)}preferredInspectorStyleSheetForFrame(e,t,i){var n=this.inspectorStyleSheetsForFrame(e);for(let b of n)if(b[WI.CSSManager.PreferredInspectorStyleSheetSymbol]){t(b);return}if(i)return;if(CSSAgent.createStyleSheet){CSSAgent.createStyleSheet(e.id,function(b,w){let E=WI.cssManager.styleSheetForIdentifier(w);E.updateInfo(null,e,E.origin,E.isInlineStyleTag(),E.startLineNumber,E.startColumnNumber),E[WI.CSSManager.PreferredInspectorStyleSheetSymbol]=!0,t(E)});return}let s=appendWebInspectorSourceURL("document"),a=e.pageExecutionContext.id;RuntimeAgent.evaluate.invoke({expression:s,objectGroup:"",includeCommandLineAPI:!1,doNotPauseOnExceptionsAndMuteConsole:!0,contextId:a,returnByValue:!1,generatePreview:!1},d);function d(b,w){if(b){t(null);return}let S=WI.RemoteObject.fromPayload(w);S.pushNodeToFrontend(p.bind(null,S))}function p(b,w){if(b.release(),!w){t(null);return}DOMAgent.querySelector(w,"body",f)}function f(b,w){if(b){console.error(b),t(null);return}let S="";CSSAgent.addRule(w,S,_)}function _(b,w){if(b||!w.ruleId){t(null);return}let S=w.ruleId.styleSheetId,E=WI.cssManager.styleSheetForIdentifier(S);if(!E){t(null);return}E[WI.CSSManager.PreferredInspectorStyleSheetSymbol]=!0,console.assert(E.isInspectorStyleSheet()),console.assert(E.parentFrame===e),t(E)}}mediaTypeChanged(){this.mediaQueryResultChanged()}defaultAppearanceDidChange(e){let t=null;switch(e){case PageAgent.Appearance.Light:t=WI.CSSManager.Appearance.Light;break;case PageAgent.Appearance.Dark:t=WI.CSSManager.Appearance.Dark;break;default:console.error("Unknown default appearance name:",e);break}this._defaultAppearance=t,this.mediaQueryResultChanged(),this.dispatchEventToListeners(WI.CSSManager.Event.DefaultAppearanceDidChange,{appearance:t})}get modifiedStyles(){return Array.from(this._modifiedStyles.values())}addModifiedStyle(e){this._modifiedStyles.set(e.stringId,e)}getModifiedStyle(e){return this._modifiedStyles.get(e.stringId)}removeModifiedStyle(e){this._modifiedStyles.delete(e.stringId)}mediaQueryResultChanged(){for(var e in this._nodeStylesMap)this._nodeStylesMap[e].mediaQueryResultDidChange()}styleSheetChanged(e){var t=this.styleSheetForIdentifier(e);console.assert(t),!t.isInlineStyleAttributeStyleSheet()&&(t.noteContentDidChange(),this._updateResourceContent(t))}styleSheetAdded(e){console.assert(!this._styleSheetIdentifierMap.has(e.styleSheetId),"Attempted to add a CSSStyleSheet but identifier was already in use");let t=this.styleSheetForIdentifier(e.styleSheetId),i=WI.networkManager.frameForIdentifier(e.frameId),n=WI.CSSManager.protocolStyleSheetOriginToEnum(e.origin);t.updateInfo(e.sourceURL,i,n,e.isInline,e.startLine,e.startColumn),this.dispatchEventToListeners(WI.CSSManager.Event.StyleSheetAdded,{styleSheet:t})}styleSheetRemoved(e){let t=this._styleSheetIdentifierMap.get(e);console.assert(t,"Attempted to remove a CSSStyleSheet that was not tracked"),t&&(this._styleSheetIdentifierMap.delete(e),this.dispatchEventToListeners(WI.CSSManager.Event.StyleSheetRemoved,{styleSheet:t}))}_nodePseudoClassesDidChange(e){var t=e.target;for(var i in this._nodeStylesMap){var n=this._nodeStylesMap[i];n.node!==t&&!n.node.isDescendant(t)||n.pseudoClassesDidChange(t)}}_nodeAttributesDidChange(e){var t=e.target;for(var i in this._nodeStylesMap){var n=this._nodeStylesMap[i];n.node!==t&&!n.node.isDescendant(t)||n.attributeDidChange(t,e.data.name)}}_mainResourceDidChange(e){console.assert(e.target instanceof WI.Frame),e.target.isMainFrame()&&(this._fetchedInitialStyleSheets=InspectorBackend.domains.CSS.hasEvent("styleSheetAdded"),this._styleSheetIdentifierMap.clear(),this._styleSheetFrameURLMap.clear(),this._modifiedStyles.clear(),this._nodeStylesMap={})}_resourceAdded(e){console.assert(e.target instanceof WI.Frame);var t=e.data.resource;console.assert(t),t.type===WI.Resource.Type.Stylesheet&&this._clearStyleSheetsForResource(t)}_resourceTypeDidChange(e){console.assert(e.target instanceof WI.Resource);var t=e.target;t.type===WI.Resource.Type.Stylesheet&&this._clearStyleSheetsForResource(t)}_clearStyleSheetsForResource(e){this._styleSheetIdentifierMap.delete(this._frameURLMapKey(e.parentFrame,e.url))}_frameURLMapKey(e,t){return e.id+":"+t}_lookupStyleSheetForResource(e,t){this._lookupStyleSheet(e.parentFrame,e.url,t)}_lookupStyleSheet(e,t,i){console.assert(e instanceof WI.Frame);let n=this._frameURLMapKey(e,t);function s(){i(this._styleSheetFrameURLMap.get(n)||null)}let a=this._styleSheetFrameURLMap.get(n)||null;a?i(a):this._fetchInfoForAllStyleSheets(s.bind(this))}_fetchInfoForAllStyleSheets(e){console.assert(typeof e=="function");function t(i,n){if(this._styleSheetFrameURLMap.clear(),i){e();return}for(let s of n){let a=WI.networkManager.frameForIdentifier(s.frameId),d=WI.CSSManager.protocolStyleSheetOriginToEnum(s.origin),p=s.isInline||!1,f=s.startLine||0,_=s.startColumn||0,b=this.styleSheetForIdentifier(s.styleSheetId);b.updateInfo(s.sourceURL,a,d,p,f,_);let w=this._frameURLMapKey(a,s.sourceURL);this._styleSheetFrameURLMap.set(w,b)}e()}CSSAgent.getAllStyleSheets(t.bind(this))}_resourceContentDidChange(e){var t=e.target;if(t===this._ignoreResourceContentDidChangeEventForResource||t.type!==WI.Resource.Type.Stylesheet||t.syntheticMIMEType!=="text/css")return;function i(){function n(s){t.__pendingChangeTimeout.cancel(),console.assert(s),s&&(t.__ignoreNextUpdateResourceContent=!0,WI.branchManager.currentBranch.revisionForRepresentedObject(s).content=t.content)}this._lookupStyleSheetForResource(t,n.bind(this))}t.__pendingChangeTimeout||(t.__pendingChangeTimeout=new Throttler(i.bind(this),100)),t.__pendingChangeTimeout.fire()}_updateResourceContent(e){console.assert(e);function t(s){e.__pendingChangeTimeout.cancel();let a=s.sourceCode;if(console.assert(a.url),!a.url||!e.isInspectorStyleSheet()&&(a=a.parentFrame.resourceForURL(a.url),!a||a.type!==WI.Resource.Type.Stylesheet))return;if(a.__ignoreNextUpdateResourceContent){a.__ignoreNextUpdateResourceContent=!1;return}this._ignoreResourceContentDidChangeEventForResource=a;let d=WI.branchManager.currentBranch.revisionForRepresentedObject(a);e.isInspectorStyleSheet()?(d.content=a.content,e.dispatchEventToListeners(WI.SourceCode.Event.ContentDidChange)):d.content=s.content,this._ignoreResourceContentDidChangeEventForResource=null}function i(){e.requestContent().then(t.bind(this))}function n(){e.url?i.call(this):this._fetchInfoForAllStyleSheets(i.bind(this))}e.__pendingChangeTimeout||(e.__pendingChangeTimeout=new Throttler(n.bind(this),100)),e.__pendingChangeTimeout.fire()}};WI.CSSManager.Event={StyleSheetAdded:"css-manager-style-sheet-added",StyleSheetRemoved:"css-manager-style-sheet-removed",DefaultAppearanceDidChange:"css-manager-default-appearance-did-change",ForcedAppearanceDidChange:"css-manager-forced-appearance-did-change"};WI.CSSManager.Appearance={Light:Symbol("light"),Dark:Symbol("dark")};WI.CSSManager.PseudoElementNames=["before","after"];WI.CSSManager.ForceablePseudoClasses=["active","focus","hover","visited"];WI.CSSManager.PreferredInspectorStyleSheetSymbol=Symbol("css-manager-preferred-inspector-stylesheet");WI.CallFrameTreeController=class extends WI.Object{constructor(e){console.assert(e instanceof WI.TreeOutline),super(),this._treeOutline=e,this._treeOutline.selectable?this._treeOutline.addEventListener(WI.TreeOutline.Event.SelectionDidChange,this._treeSelectionDidChange,this):this._treeOutline.addEventListener(WI.TreeOutline.Event.ElementClicked,this._treeElementClicked,this)}get treeOutline(){return this._treeOutline}get callFrames(){return this._callFrames}set callFrames(e){if(e=e||[],this._callFrames!==e){this._callFrames=e,this._treeOutline.removeChildren();for(let t of this._callFrames)this._treeOutline.appendChild(new WI.CallFrameTreeElement(t))}}disconnect(){this._treeOutline.removeEventListener(null,null,this)}_treeElementClicked(e){this._showSourceCodeLocation(e.data.treeElement)}_treeSelectionDidChange(e){this._showSourceCodeLocation(this._treeOutline.selectedTreeElement)}_showSourceCodeLocation(e){let t=e.callFrame;!t.sourceCodeLocation||WI.showSourceCodeLocation(t.sourceCodeLocation,{ignoreNetworkTab:!0,ignoreSearchTab:!0})}};WI.CanvasManager=class extends WI.Object{constructor(){super(),this._enabled=!1,this._canvasIdentifierMap=new Map,this._shaderProgramIdentifierMap=new Map,this._savedRecordings=new Set,WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this)}initializeTarget(e){!this._enabled||e.CanvasAgent&&(e.CanvasAgent.enable(),e.CanvasAgent.setRecordingAutoCaptureFrameCount&&WI.settings.canvasRecordingAutoCaptureEnabled.value&&WI.settings.canvasRecordingAutoCaptureFrameCount.value&&e.CanvasAgent.setRecordingAutoCaptureFrameCount(WI.settings.canvasRecordingAutoCaptureFrameCount.value))}static supportsRecordingAutoCapture(){return InspectorBackend.domains.Canvas&&InspectorBackend.domains.Canvas.setRecordingAutoCaptureFrameCount}get savedRecordings(){return this._savedRecordings}get canvases(){return Array.from(this._canvasIdentifierMap.values())}get shaderPrograms(){return Array.from(this._shaderProgramIdentifierMap.values())}async processJSON({filename:e,json:t,error:i}){if(i){WI.Recording.synthesizeError(i);return}if(typeof t!="object"||t===null){WI.Recording.synthesizeError(WI.UIString("invalid JSON"));return}let n=WI.Recording.fromPayload(t);if(!n)return;let s=e.lastIndexOf(".");s!==-1&&(e=e.substring(0,s)),n.createDisplayName(e),this._savedRecordings.add(n),this.dispatchEventToListeners(WI.CanvasManager.Event.RecordingSaved,{recording:n,imported:!0,initiatedByUser:!0})}enable(){console.assert(!this._enabled),this._enabled=!0;for(let e of WI.targets)this.initializeTarget(e)}disable(){console.assert(this._enabled);for(let e of WI.targets)e.CanvasAgent&&e.CanvasAgent.disable();this._canvasIdentifierMap.clear(),this._shaderProgramIdentifierMap.clear(),this._savedRecordings.clear(),this._enabled=!1}setRecordingAutoCaptureFrameCount(e,t){console.assert(!isNaN(t)&&t>=0);for(let i of WI.targets)i.CanvasAgent&&i.CanvasAgent.setRecordingAutoCaptureFrameCount(e?t:0);WI.settings.canvasRecordingAutoCaptureEnabled.value=e&&t,WI.settings.canvasRecordingAutoCaptureFrameCount.value=t}canvasAdded(e){console.assert(!this._canvasIdentifierMap.has(e.canvasId),`Canvas already exists with id ${e.canvasId}.`);let t=WI.Canvas.fromPayload(e);this._canvasIdentifierMap.set(t.identifier,t),this.dispatchEventToListeners(WI.CanvasManager.Event.CanvasAdded,{canvas:t})}canvasRemoved(e){let t=this._canvasIdentifierMap.take(e);console.assert(t),t&&this._removeCanvas(t)}canvasMemoryChanged(e,t){let i=this._canvasIdentifierMap.get(e);console.assert(i),i&&(i.memoryCost=t)}cssCanvasClientNodesChanged(e){let t=this._canvasIdentifierMap.get(e);console.assert(t),t&&t.cssCanvasClientNodesChanged()}recordingStarted(e,t){let i=this._canvasIdentifierMap.get(e);console.assert(i),i&&i.recordingStarted(t)}recordingProgress(e,t,i){let n=this._canvasIdentifierMap.get(e);console.assert(n),n&&n.recordingProgress(t,i)}recordingFinished(e,t){let i=this._canvasIdentifierMap.get(e);console.assert(i),i&&i.recordingFinished(t)}extensionEnabled(e,t){let i=this._canvasIdentifierMap.get(e);console.assert(i),i&&i.enableExtension(t)}programCreated(e,t){let i=this._canvasIdentifierMap.get(e);if(console.assert(i),!i)return;console.assert(!this._shaderProgramIdentifierMap.has(t),`ShaderProgram already exists with id ${t}.`);let n=new WI.ShaderProgram(t,i);this._shaderProgramIdentifierMap.set(n.identifier,n),i.shaderProgramCollection.add(n)}programDeleted(e){let t=this._shaderProgramIdentifierMap.take(e);console.assert(t),t&&t.canvas.shaderProgramCollection.remove(t)}_removeCanvas(e){for(let t of e.shaderProgramCollection)this._shaderProgramIdentifierMap.delete(t.identifier);e.shaderProgramCollection.clear();for(let t of e.recordingCollection)t.source=null,t.createDisplayName(t.displayName),this._savedRecordings.add(t),this.dispatchEventToListeners(WI.CanvasManager.Event.RecordingSaved,{recording:t});this.dispatchEventToListeners(WI.CanvasManager.Event.CanvasRemoved,{canvas:e})}_mainResourceDidChange(e){if(console.assert(e.target instanceof WI.Frame),!!e.target.isMainFrame()){WI.Canvas.resetUniqueDisplayNameNumbers();for(let t of this._canvasIdentifierMap.values())this._removeCanvas(t);this._shaderProgramIdentifierMap.clear(),this._canvasIdentifierMap.clear()}}};WI.CanvasManager.Event={CanvasAdded:"canvas-manager-canvas-was-added",CanvasRemoved:"canvas-manager-canvas-was-removed",RecordingSaved:"canvas-manager-recording-saved"};WI.CodeMirrorColorEditingController=class extends WI.CodeMirrorEditingController{get initialValue(){return WI.Color.fromString(this.text)}get cssClassName(){return"color"}popoverWillPresent(e){this._colorPicker=new WI.ColorPicker,this._colorPicker.addEventListener(WI.ColorPicker.Event.ColorChanged,this._colorPickerColorChanged,this),this._colorPicker.addEventListener(WI.ColorPicker.Event.FormatChanged,t=>e.update()),e.content=this._colorPicker.element}popoverDidPresent(e){this._colorPicker.color=this._value}_colorPickerColorChanged(e){this.value=e.target.color}};WI.CodeMirrorCompletionController=class extends WI.Object{constructor(e,t,i){super(),console.assert(e),this._codeMirror=e,this._stopCharactersRegex=i||null,this._delegate=t||null,this._startOffset=NaN,this._endOffset=NaN,this._lineNumber=NaN,this._prefix="",this._noEndingSemicolon=!1,this._completions=[],this._extendedCompletionProviders={},this._suggestionsView=new WI.CompletionSuggestionsView(this),this._keyMap={Up:this._handleUpKey.bind(this),Down:this._handleDownKey.bind(this),Right:this._handleRightOrEnterKey.bind(this),Esc:this._handleEscapeKey.bind(this),Enter:this._handleRightOrEnterKey.bind(this),Tab:this._handleTabKey.bind(this),"Cmd-A":this._handleHideKey.bind(this),"Cmd-Z":this._handleHideKey.bind(this),"Shift-Cmd-Z":this._handleHideKey.bind(this),"Cmd-Y":this._handleHideKey.bind(this)},this._handleChangeListener=this._handleChange.bind(this),this._handleCursorActivityListener=this._handleCursorActivity.bind(this),this._handleHideActionListener=this._handleHideAction.bind(this),this._codeMirror.addKeyMap(this._keyMap),this._codeMirror.on("change",this._handleChangeListener),this._codeMirror.on("cursorActivity",this._handleCursorActivityListener),this._codeMirror.on("blur",this._handleHideActionListener),this._codeMirror.on("scroll",this._handleHideActionListener),this._updatePromise=null}get delegate(){return this._delegate}addExtendedCompletionProvider(e,t){this._extendedCompletionProviders[e]=t}updateCompletions(e,t){if(!(isNaN(this._startOffset)||isNaN(this._endOffset)||isNaN(this._lineNumber))){if(!e||!e.length){this.hideCompletions();return}this._completions=e,typeof t=="string"&&(this._implicitSuffix=t);var i={line:this._lineNumber,ch:this._startOffset},n={line:this._lineNumber,ch:this._endOffset},s=this._codeMirror.cursorCoords(i),a=this._codeMirror.cursorCoords(n),d=new WI.Rect(s.left,s.top,a.right-s.left,s.bottom-s.top),p=this._currentCompletion?e.indexOf(this._currentCompletion):0;if(p===-1&&(p=0),this._forced||e.length>1||e[p]!==this._prefix)this._suggestionsView.update(e,p),this._suggestionsView.show(d);else if(this._implicitSuffix)this._suggestionsView.hide();else{this.hideCompletions();return}this._applyCompletionHint(e[p]),this._resolveUpdatePromise(WI.CodeMirrorCompletionController.UpdatePromise.CompletionsFound)}}isCompletionChange(e){return this._ignoreChange||e.origin===WI.CodeMirrorCompletionController.CompletionOrigin||e.origin===WI.CodeMirrorCompletionController.DeleteCompletionOrigin}isShowingCompletions(){return this._suggestionsView.visible||this._completionHintMarker&&this._completionHintMarker.find()}isHandlingClickEvent(){return this._suggestionsView.isHandlingClickEvent()}hideCompletions(){this._suggestionsView.hide(),this._removeCompletionHint(),this._startOffset=NaN,this._endOffset=NaN,this._lineNumber=NaN,this._prefix="",this._completions=[],this._implicitSuffix="",this._forced=!1,delete this._currentCompletion,delete this._ignoreNextCursorActivity,this._resolveUpdatePromise(WI.CodeMirrorCompletionController.UpdatePromise.NoCompletionsFound)}close(){this._codeMirror.removeKeyMap(this._keyMap),this._codeMirror.off("change",this._handleChangeListener),this._codeMirror.off("cursorActivity",this._handleCursorActivityListener),this._codeMirror.off("blur",this._handleHideActionListener),this._codeMirror.off("scroll",this._handleHideActionListener)}completeAtCurrentPositionIfNeeded(e){this._resolveUpdatePromise(WI.CodeMirrorCompletionController.UpdatePromise.Canceled);var t=this._updatePromise=new WI.WrappedPromise;return this._completeAtCurrentPosition(e),t.promise}completionSuggestionsSelectedCompletion(e,t){this._applyCompletionHint(t)}completionSuggestionsClickedCompletion(e,t){this._codeMirror.focus(),this._applyCompletionHint(t),this._commitCompletionHint()}set noEndingSemicolon(e){this._noEndingSemicolon=e}_resolveUpdatePromise(e){!this._updatePromise||(this._updatePromise.resolve(e),this._updatePromise=null)}get _currentReplacementText(){return this._currentCompletion+this._implicitSuffix}_hasPendingCompletion(){return!isNaN(this._startOffset)&&!isNaN(this._endOffset)&&!isNaN(this._lineNumber)}_notifyCompletionsHiddenSoon(){function e(){this._completionHintMarker||this._delegate&&typeof this._delegate.completionControllerCompletionsHidden=="function"&&this._delegate.completionControllerCompletionsHidden(this)}this._notifyCompletionsHiddenIfNeededTimeout&&clearTimeout(this._notifyCompletionsHiddenIfNeededTimeout),this._notifyCompletionsHiddenIfNeededTimeout=setTimeout(e.bind(this),WI.CodeMirrorCompletionController.CompletionsHiddenDelay)}_createCompletionHintMarker(e,t){var i=document.createElement("span");i.classList.add(WI.CodeMirrorCompletionController.CompletionHintStyleClassName),i.textContent=t,i.addEventListener("mousedown",n=>{n.preventDefault(),this._commitCompletionHint(),setTimeout(()=>{this._codeMirror.focus()},0)}),this._completionHintMarker=this._codeMirror.setUniqueBookmark(e,{widget:i,insertLeft:!0})}_applyCompletionHint(e){if(console.assert(e),!e)return;function t(){this._currentCompletion=e,this._removeCompletionHint(!0,!0);var i=this._currentReplacementText,n={line:this._lineNumber,ch:this._startOffset},s={line:this._lineNumber,ch:this._endOffset},a=this._codeMirror.getRange(n,s);this._createCompletionHintMarker(s,i.replace(a,""))}this._ignoreChange=!0,this._ignoreNextCursorActivity=!0,this._codeMirror.operation(t.bind(this)),delete this._ignoreChange}_commitCompletionHint(){function e(){this._removeCompletionHint(!0,!0);var t=this._currentReplacementText,i={line:this._lineNumber,ch:this._startOffset},n={line:this._lineNumber,ch:this._endOffset},s={line:this._lineNumber,ch:this._startOffset+t.length},a=this._currentCompletion.charAt(this._currentCompletion.length-1),d=")]}".indexOf(a);d!==-1&&(s.ch-=1+this._implicitSuffix.length),this._codeMirror.replaceRange(t,i,n,WI.CodeMirrorCompletionController.CompletionOrigin),this._codeMirror.setCursor(s),this.hideCompletions()}this._ignoreChange=!0,this._ignoreNextCursorActivity=!0,this._codeMirror.operation(e.bind(this)),delete this._ignoreChange}_removeLastChangeFromHistory(){var e=this._codeMirror.getHistory();console.assert(!e.undone.length),e.undone=[],console.assert(e.done.length),e.done.pop(),this._codeMirror.setHistory(e)}_removeCompletionHint(e,t){if(!this._completionHintMarker)return;this._notifyCompletionsHiddenSoon();function i(s){if(!!s){var a=s.find();return a&&s.clear(),null}}function n(){if(this._completionHintMarker=i(this._completionHintMarker),!t){console.assert(!isNaN(this._startOffset)),console.assert(!isNaN(this._endOffset)),console.assert(!isNaN(this._lineNumber));var s={line:this._lineNumber,ch:this._startOffset},a={line:this._lineNumber,ch:this._endOffset};this._codeMirror.replaceRange(this._prefix,s,a,WI.CodeMirrorCompletionController.DeleteCompletionOrigin),this._removeLastChangeFromHistory()}}if(e){n.call(this);return}this._ignoreChange=!0,this._codeMirror.operation(n.bind(this)),delete this._ignoreChange}_scanStringForExpression(e,t,L,n,s,a,d,f){console.assert(n===-1||n===1);var f=f||this._stopCharactersRegex||WI.CodeMirrorCompletionController.DefaultStopCharactersRegexModeMap[e]||WI.CodeMirrorCompletionController.GenericStopCharactersRegex;function _(K){return f.test(K)}function b(K){return WI.CodeMirrorCompletionController.OpenBracketCharactersRegex.test(K)}function w(K){return WI.CodeMirrorCompletionController.CloseBracketCharactersRegex.test(K)}function S(K){return WI.CodeMirrorCompletionController.MatchingBrackets[K]}var E=Math.min(L,t.length),k=E===t.length||_(t.charAt(E));if(!k&&!s)return null;for(var R=[],M=[],L=E,V=E+n,H=V;n>0?H<t.length:H>=0;H+=n){var O=t.charAt(H);if(_(O)&&!R.length)break;if(w(O))R.push(O),M.push(H);else if(b(O)){if((!d||H!==V)&&(!R.length||S(O)!==R.lastValue))break;M.pop(),R.pop()}L=H+(n>0?1:0)}if(M.length&&(L=M.pop()+1),a&&L>0&&L<t.length&&(L+=n),n>0){var z=E;E=L,L=z}return{string:t.substring(L,E),startOffset:L,endOffset:E}}_completeAtCurrentPosition(e){if(this._codeMirror.somethingSelected()){this.hideCompletions();return}this._removeCompletionHint(!0,!0);var t=this._codeMirror.getCursor(),i=this._codeMirror.getTokenAt(t);if(i.type&&/\b(comment|string)\b/.test(i.type)){this.hideCompletions();return}var n=this._codeMirror.getMode(),s=CodeMirror.innerMode(n,i.state).mode,a=s.alternateName||s.name,d=t.line,p=this._codeMirror.getLine(d),f=this._scanStringForExpression(a,p,t.ch,-1,e);if(!f){this.hideCompletions();return}var _=this._scanStringForExpression(a,p,t.ch,1,!0,!0),b=_.string;this._ignoreNextCursorActivity=!0,this._startOffset=f.startOffset,this._endOffset=f.endOffset,this._lineNumber=d,this._prefix=f.string,this._completions=[],this._implicitSuffix="",this._forced=e;var w=WI.CodeMirrorCompletionController.BaseExpressionStopCharactersRegexModeMap[a];if(w)var S=this._scanStringForExpression(a,p,this._startOffset,-1,!0,!1,!0,w);if(!e&&!f.string&&(!S||!S.string)){this.hideCompletions();return}var E=[];switch(a){case"css":E=this._generateCSSCompletions(i,S?S.string:null,b);break;case"javascript":E=this._generateJavaScriptCompletions(i,S?S.string:null,b);break}var k=this._extendedCompletionProviders[a];if(k){k.completionControllerCompletionsNeeded(this,E,S?S.string:null,this._prefix,b,e);return}this._delegate&&typeof this._delegate.completionControllerCompletionsNeeded=="function"?this._delegate.completionControllerCompletionsNeeded(this,this._prefix,E,S?S.string:null,b,e):this.updateCompletions(E)}_generateCSSCompletions(e,t,i){if(e.state.state==="media"||e.state.state==="top")return[];if(/^[a-z]/i.test(i))return[];var n=e,s=this._lineNumber;let a=()=>!n.start&&(--s,s<0)?null:this._codeMirror.getTokenAt({line:s,ch:n.start?n.start:Number.MAX_VALUE});if(n.state.state==="parens"){for(;n&&n.state.state==="parens"&&n.string!=="(";)n=a();if(n&&(n=a()),!n)return[];let p=n.string;if(!p)return[];let f=WI.CSSKeywordCompletions.forFunction(p).startsWith(this._prefix);return this._delegate&&this._delegate.completionControllerCSSFunctionValuesNeeded&&(f=this._delegate.completionControllerCSSFunctionValuesNeeded(this,p,f)),f}for(;n.state.state==="prop";){let p=a();if(!p)break;n=p}if(e!==n&&n.type&&/\bproperty\b/.test(n.type)){var d=n.string;this._implicitSuffix=" ",i===";"?this._implicitSuffix=this._noEndingSemicolon?"":";":i.startsWith("(")&&(this._implicitSuffix=""),this._implicitSuffix===i&&(this._implicitSuffix="");let p=WI.CSSKeywordCompletions.forProperty(d).startsWith(this._prefix);return i.startsWith("(")&&(p=p.map(f=>f.replace(/\(\)$/,""))),p}return this._implicitSuffix=i!==":"?": ":"",WI.CSSCompletions.cssNameCompletions.startsWith(this._prefix)}_generateJavaScriptCompletions(e,t,i){if(t&&!/[({[]$/.test(t))return[];var n=[],s=this._prefix,a=e.state.localState?e.state.localState:e.state,d=a.lexical.type==="vardef",p=a.lexical.prev?a.lexical.prev.info==="switch":!1,f=a.lexical.prev?a.lexical.prev.type==="}":!1,_=a.lexical.type===")",b=a.lexical.type==="]",w=["break","case","catch","class","const","continue","debugger","default","delete","do","else","extends","false","finally","for","function","if","in","Infinity","instanceof","let","NaN","new","null","of","return","static","super","switch","this","throw","true","try","typeof","undefined","var","void","while","with","yield"],S=["false","Infinity","NaN","null","this","true","undefined","globalThis"],E=w.keySet(),k=S.keySet(),R=S.concat(["class","function"]).keySet(),M=R,L=["case","default"].keySet();function V(O){n=n.concat(O.filter(function(z){return!p&&z in L||f&&!(z in E)||b&&!(z in M)||_&&!(z in R)||d&&!(z in k)?!1:z.startsWith(s)}))}function H(){function O(K){for(var q=K;q;q=q.next)d&&q.name===s||q.name.startsWith(s)&&!n.includes(q.name)&&n.push(q.name)}for(var z=a.context;z;)z.vars&&O(z.vars),z=z.prev;a.localVars&&O(a.localVars),a.globalVars&&O(a.globalVars)}switch(i.substring(0,1)){case"":case" ":H(),V(w);break;case".":case"[":H(),V(["false","Infinity","NaN","this","true"]);break;case"(":H(),V(["catch","else","for","function","if","return","switch","throw","while","with","yield"]);break;case"{":V(["do","else","finally","return","try","yield"]);break;case":":p&&V(["case","default"]);break;case";":H(),V(S),V(["break","continue","debugger","return","void"]);break}return n}_handleUpKey(e){if(!this._hasPendingCompletion())return CodeMirror.Pass;!this.isShowingCompletions()||this._suggestionsView.selectPrevious()}_handleDownKey(e){if(!this._hasPendingCompletion())return CodeMirror.Pass;!this.isShowingCompletions()||this._suggestionsView.selectNext()}_handleRightOrEnterKey(e){if(!this._hasPendingCompletion())return CodeMirror.Pass;!this.isShowingCompletions()||this._commitCompletionHint()}_handleEscapeKey(e){var t=this._delegate&&typeof this._delegate.completionControllerShouldAllowEscapeCompletion=="function";if(this._hasPendingCompletion())this.hideCompletions();else{if(this._codeMirror.getOption("readOnly"))return CodeMirror.Pass;if(!t||this._delegate.completionControllerShouldAllowEscapeCompletion(this))this._completeAtCurrentPosition(!0);else return CodeMirror.Pass}}_handleTabKey(e){if(!this._hasPendingCompletion())return CodeMirror.Pass;if(!!this.isShowingCompletions()&&(console.assert(this._completions.length),!!this._completions.length&&(console.assert(this._currentCompletion),!!this._currentCompletion))){if(this._completions.length===1){this._commitCompletionHint();return}for(var t=this._prefix.length,i=this._completions[0],n=1;n<this._completions.length;++n)for(var s=this._completions[n],a=Math.min(i.length,s.length),d=t;d<a;++d)if(i[d]!==s[d]){i=i.substr(0,d);break}if(i===this._prefix){this._commitCompletionHint();return}this._prefix=i,this._endOffset=this._startOffset+i.length,this._applyCompletionHint(this._currentCompletion)}}_handleChange(e,t){if(!this.isCompletionChange(t)){if(this._ignoreNextCursorActivity=!0,!t.origin||t.origin.charAt(0)!=="+"){this.hideCompletions();return}t.origin==="+delete"&&!this._hasPendingCompletion()||this._completeAtCurrentPosition(!1)}}_handleCursorActivity(e){if(!this._ignoreChange){if(this._ignoreNextCursorActivity){delete this._ignoreNextCursorActivity;return}this.hideCompletions()}}_handleHideKey(e){return this.hideCompletions(),CodeMirror.Pass}_handleHideAction(e){this.isHandlingClickEvent()||this.hideCompletions()}};WI.CodeMirrorCompletionController.UpdatePromise={Canceled:"code-mirror-completion-controller-canceled",CompletionsFound:"code-mirror-completion-controller-completions-found",NoCompletionsFound:"code-mirror-completion-controller-no-completions-found"};WI.CodeMirrorCompletionController.GenericStopCharactersRegex=/[\s=:;,]/;WI.CodeMirrorCompletionController.DefaultStopCharactersRegexModeMap={css:/[\s:;,{}()]/,javascript:/[\s=:;,!+\-*/%&|^~?<>.{}()[\]]/};WI.CodeMirrorCompletionController.BaseExpressionStopCharactersRegexModeMap={javascript:/[\s=:;,!+\-*/%&|^~?<>]/};WI.CodeMirrorCompletionController.OpenBracketCharactersRegex=/[({[]/;WI.CodeMirrorCompletionController.CloseBracketCharactersRegex=/[)}\]]/;WI.CodeMirrorCompletionController.MatchingBrackets={"{":"}","(":")","[":"]","}":"{",")":"(","]":"["};WI.CodeMirrorCompletionController.CompletionHintStyleClassName="completion-hint";WI.CodeMirrorCompletionController.CompletionsHiddenDelay=250;WI.CodeMirrorCompletionController.CompletionTypingDelay=250;WI.CodeMirrorCompletionController.CompletionOrigin="+completion";WI.CodeMirrorCompletionController.DeleteCompletionOrigin="+delete-completion";WI.CodeMirrorBezierEditingController=class extends WI.CodeMirrorEditingController{get initialValue(){return WI.CubicBezier.fromString(this.text)}get cssClassName(){return"cubic-bezier"}popoverWillPresent(e){this._bezierEditor=new WI.BezierEditor,this._bezierEditor.addEventListener(WI.BezierEditor.Event.BezierChanged,this._bezierEditorBezierChanged,this),e.content=this._bezierEditor.element}popoverDidPresent(e){this._bezierEditor.bezier=this.value}popoverDidDismiss(e){this._bezierEditor.removeListeners()}_bezierEditorBezierChanged(e){this.value=e.data.bezier}};WI.CodeMirrorDragToAdjustNumberController=class extends WI.Object{constructor(e){super(),this._codeMirror=e,this._dragToAdjustController=new WI.DragToAdjustController(this)}get enabled(){return this._dragToAdjustController.enabled}set enabled(e){this.enabled!==e&&(this._dragToAdjustController.element=this._codeMirror.getWrapperElement(),this._dragToAdjustController.enabled=e)}dragToAdjustControllerActiveStateChanged(e){e.active||(this._hoveredTokenInfo=null)}dragToAdjustControllerCanBeActivated(e){return!this._codeMirror.getOption("readOnly")}dragToAdjustControllerCanBeAdjusted(e){return this._hoveredTokenInfo&&this._hoveredTokenInfo.containsNumber}dragToAdjustControllerWasAdjustedByAmount(e,t){this._codeMirror.alterNumberInRange(t,this._hoveredTokenInfo.startPosition,this._hoveredTokenInfo.endPosition,!1)}dragToAdjustControllerDidReset(e){this._hoveredTokenInfo=null}dragToAdjustControllerCanAdjustObjectAtPoint(e,t){var i=this._codeMirror.coordsChar({left:t.x,top:t.y}),n=this._codeMirror.getTokenAt(i);if(!n||!n.type||!n.string)return this._hoveredTokenInfo&&e.reset(),!1;if(this._hoveredTokenInfo&&this._hoveredTokenInfo.line===i.line&&this._hoveredTokenInfo.token.start===n.start&&this._hoveredTokenInfo.token.end===n.end)return this._hoveredTokenInfo.token.type.indexOf("number")!==-1;var s=n.type.indexOf("number")!==-1;return this._hoveredTokenInfo={token:n,line:i.line,containsNumber:s,startPosition:{ch:n.start,line:i.line},endPosition:{ch:n.end,line:i.line}},s}};CodeMirror.defineOption("dragToAdjustNumbers",!0,function(c,e,t){c.dragToAdjustNumberController||(c.dragToAdjustNumberController=new WI.CodeMirrorDragToAdjustNumberController(c)),c.dragToAdjustNumberController.enabled=e});WI.CodeMirrorGradientEditingController=class extends WI.CodeMirrorEditingController{get initialValue(){return WI.Gradient.fromString(this.text)}get cssClassName(){return"gradient"}get popoverPreferredEdges(){return[WI.RectEdge.MIN_X,WI.RectEdge.MAX_Y,WI.RectEdge.MAX_X]}popoverTargetFrameWithRects(e){return e[0]}popoverWillPresent(e){function t(i){e.update()}this._gradientEditor=new WI.GradientEditor,this._gradientEditor.addEventListener(WI.GradientEditor.Event.GradientChanged,this._gradientEditorGradientChanged,this),this._gradientEditor.addEventListener(WI.GradientEditor.Event.ColorPickerToggled,t,this),e.content=this._gradientEditor.element}popoverDidPresent(e){this._gradientEditor.gradient=this.value}_gradientEditorGradientChanged(e){this.value=e.data.gradient}};WI.CodeMirrorSpringEditingController=class extends WI.CodeMirrorEditingController{get initialValue(){return WI.Spring.fromString(this.text)}get cssClassName(){return"spring"}popoverWillPresent(e){this._springEditor=new WI.SpringEditor,this._springEditor.addEventListener(WI.SpringEditor.Event.SpringChanged,this._springEditorSpringChanged,this),e.content=this._springEditor.element}popoverDidPresent(e){this._springEditor.spring=this.value}popoverDidDismiss(e){this._springEditor.removeListeners()}_springEditorSpringChanged(e){this.value=e.data.spring}};WI.CodeMirrorTokenTrackingController=class extends WI.Object{constructor(e,t){super(),console.assert(e),this._codeMirror=e,this._delegate=t||null,this._mode=WI.CodeMirrorTokenTrackingController.Mode.None,this._mouseOverDelayDuration=0,this._mouseOutReleaseDelayDuration=0,this._classNameForHighlightedRange=null,this._enabled=!1,this._tracking=!1,this._previousTokenInfo=null,this._hoveredMarker=null,this._ignoreNextMouseMove=!1;const i=this._hidePopover.bind(this);this._codeMirror.addKeyMap({"Cmd-Enter":this._handleCommandEnterKey.bind(this),Esc:i}),this._codeMirror.on("cursorActivity",i)}get delegate(){return this._delegate}set delegate(e){this._delegate=e}get enabled(){return this._enabled}set enabled(e){if(this._enabled!==e){this._enabled=e;var t=this._codeMirror.getWrapperElement();e?(t.addEventListener("mouseenter",this),t.addEventListener("mouseleave",this),this._updateHoveredTokenInfo({left:WI.mouseCoords.x,top:WI.mouseCoords.y}),this._startTracking()):(t.removeEventListener("mouseenter",this),t.removeEventListener("mouseleave",this),this._stopTracking())}}get mode(){return this._mode}set mode(e){var t=this._mode;this._mode=e||WI.CodeMirrorTokenTrackingController.Mode.None,t!==this._mode&&this._tracking&&this._previousTokenInfo&&this._processNewHoveredToken(this._previousTokenInfo)}get mouseOverDelayDuration(){return this._mouseOverDelayDuration}set mouseOverDelayDuration(e){console.assert(e>=0),this._mouseOverDelayDuration=Math.max(e,0)}get mouseOutReleaseDelayDuration(){return this._mouseOutReleaseDelayDuration}set mouseOutReleaseDelayDuration(e){console.assert(e>=0),this._mouseOutReleaseDelayDuration=Math.max(e,0)}get classNameForHighlightedRange(){return this._classNameForHighlightedRange}set classNameForHighlightedRange(e){this._classNameForHighlightedRange=e||null}get candidate(){return this._candidate}get hoveredMarker(){return this._hoveredMarker}set hoveredMarker(e){this._hoveredMarker=e}highlightLastHoveredRange(){this._candidate&&this.highlightRange(this._candidate.hoveredTokenRange)}highlightRange(e){if(this._codeMirrorMarkedText&&this._codeMirrorMarkedText.className===this._classNameForHighlightedRange){var t=this._codeMirrorMarkedText.find();if(!t||WI.compareCodeMirrorPositions(t.from,e.start)===0&&WI.compareCodeMirrorPositions(t.to,e.end)===0)return}this.removeHighlightedRange();var i=this._classNameForHighlightedRange||"";this._codeMirrorMarkedText=this._codeMirror.markText(e.start,e.end,{className:i}),window.addEventListener("mousemove",this,!0)}removeHighlightedRange(){!this._codeMirrorMarkedText||(this._codeMirrorMarkedText.clear(),this._codeMirrorMarkedText=null,window.removeEventListener("mousemove",this,!0))}_startTracking(){if(!this._tracking){this._tracking=!0,this._ignoreNextMouseMove=!1;var e=this._codeMirror.getWrapperElement();e.addEventListener("mousemove",this,!0),e.addEventListener("mouseout",this,!1),e.addEventListener("mousedown",this,!1),e.addEventListener("mouseup",this,!1),e.addEventListener("mousewheel",this,!1),window.addEventListener("blur",this,!0)}}_stopTracking(){if(!!this._tracking){this._tracking=!1,this._candidate=null;var e=this._codeMirror.getWrapperElement();e.removeEventListener("mousemove",this,!0),e.removeEventListener("mouseout",this,!1),e.removeEventListener("mousedown",this,!1),e.removeEventListener("mouseup",this,!1),e.removeEventListener("mousewheel",this,!1),window.removeEventListener("blur",this,!0),window.removeEventListener("mousemove",this,!0),this._resetTrackingStates()}}handleEvent(e){switch(e.type){case"mouseenter":this._mouseEntered(e);break;case"mouseleave":this._mouseLeft(e);break;case"mousemove":e.currentTarget===window?this._mouseMovedWithMarkedText(e):this._mouseMovedOverEditor(e);break;case"mouseout":e.currentTarget.contains(e.relatedTarget)||this._mouseMovedOutOfEditor(e);break;case"mousedown":this._mouseButtonWasPressedOverEditor(e);break;case"mouseup":this._mouseButtonWasReleasedOverEditor(e);break;case"mousewheel":this._ignoreNextMouseMove=!0;break;case"blur":this._windowLostFocus(e);break}}_handleCommandEnterKey(e){const t=this._getTokenInfoForPosition(e.getCursor("head"));t.triggeredBy=WI.CodeMirrorTokenTrackingController.TriggeredBy.Keyboard,this._processNewHoveredToken(t)}_hidePopover(){if(!this._candidate)return CodeMirror.Pass;this._delegate&&typeof this._delegate.tokenTrackingControllerHighlightedRangeReleased=="function"&&this._delegate.tokenTrackingControllerHighlightedRangeReleased(this,!0)}_mouseEntered(e){this._tracking||this._startTracking()}_mouseLeft(e){this._stopTracking()}_mouseMovedWithMarkedText(e){if(!(this._candidate&&this._candidate.triggeredBy===WI.CodeMirrorTokenTrackingController.TriggeredBy.Keyboard)){var t=!e.target.classList.contains(this._classNameForHighlightedRange);if(t&&this._delegate&&typeof this._delegate.tokenTrackingControllerCanReleaseHighlightedRange=="function"&&(t=this._delegate.tokenTrackingControllerCanReleaseHighlightedRange(this,e.target)),t){this._markedTextMouseoutTimer||(this._markedTextMouseoutTimer=setTimeout(this._markedTextIsNoLongerHovered.bind(this),this._mouseOutReleaseDelayDuration));return}this._markedTextMouseoutTimer&&clearTimeout(this._markedTextMouseoutTimer),this._markedTextMouseoutTimer=0}}_markedTextIsNoLongerHovered(){this._delegate&&typeof this._delegate.tokenTrackingControllerHighlightedRangeReleased=="function"&&this._delegate.tokenTrackingControllerHighlightedRangeReleased(this),this._markedTextMouseoutTimer=0}_mouseMovedOverEditor(e){if(this._ignoreNextMouseMove){this._ignoreNextMouseMove=!1;return}this._updateHoveredTokenInfo({left:e.pageX,top:e.pageY})}_updateHoveredTokenInfo(e){var t=this._codeMirror.coordsChar(e),i=this._codeMirror.getTokenAt(t);if(!i||!i.type||!i.string){this._hoveredMarker&&this._delegate&&typeof this._delegate.tokenTrackingControllerMouseOutOfHoveredMarker=="function"&&(this._codeMirror.findMarksAt(t).includes(this._hoveredMarker.codeMirrorTextMarker)||this._delegate.tokenTrackingControllerMouseOutOfHoveredMarker(this,this._hoveredMarker)),this._resetTrackingStates();return}if(!(this._previousTokenInfo&&this._previousTokenInfo.position.line===t.line&&this._previousTokenInfo.token.start===i.start&&this._previousTokenInfo.token.end===i.end)){var n=this._previousTokenInfo=this._getTokenInfoForPosition(t);if(/\bmeta\b/.test(i.type)){let s=Object.shallowCopy(t);s.ch=n.token.end+1;let a=this._codeMirror.getTokenAt(s);a&&a.type&&!/\bmeta\b/.test(a.type)&&(console.assert(n.token.end===a.start),n.token.type=a.type,n.token.string=n.token.string+a.string,n.token.end=a.end)}else{let s=Object.shallowCopy(t);s.ch=n.token.start-1;let a=this._codeMirror.getTokenAt(s);a&&a.type&&/\bmeta\b/.test(a.type)&&(console.assert(n.token.start===a.end),n.token.string=a.string+n.token.string,n.token.start=a.start)}this._tokenHoverTimer&&clearTimeout(this._tokenHoverTimer),this._tokenHoverTimer=0,this._codeMirrorMarkedText||!this._mouseOverDelayDuration?this._processNewHoveredToken(n):this._tokenHoverTimer=setTimeout(this._processNewHoveredToken.bind(this,n),this._mouseOverDelayDuration)}}_getTokenInfoForPosition(e){var t=this._codeMirror.getTokenAt(e),i=CodeMirror.innerMode(this._codeMirror.getMode(),t.state),n=i.mode.alternateName||i.mode.name;return{token:t,position:e,innerMode:i,modeName:n}}_mouseMovedOutOfEditor(e){this._tokenHoverTimer&&clearTimeout(this._tokenHoverTimer),this._tokenHoverTimer=0,this._previousTokenInfo=null,this._selectionMayBeInProgress=!1}_mouseButtonWasPressedOverEditor(e){this._selectionMayBeInProgress=!0}_mouseButtonWasReleasedOverEditor(e){if(this._selectionMayBeInProgress=!1,this._mouseMovedOverEditor(e),this._codeMirrorMarkedText&&this._previousTokenInfo){for(var t=this._codeMirror.coordsChar({left:e.pageX,top:e.pageY}),i=this._codeMirror.findMarksAt(t),n=0;n<i.length;++n)if(i[n]===this._codeMirrorMarkedText){this._delegate&&typeof this._delegate.tokenTrackingControllerHighlightedRangeWasClicked=="function"&&this._delegate.tokenTrackingControllerHighlightedRangeWasClicked(this);break}}}_windowLostFocus(e){this._resetTrackingStates()}_processNewHoveredToken(e){if(console.assert(e),!this._selectionMayBeInProgress){switch(this._candidate=null,this._mode){case WI.CodeMirrorTokenTrackingController.Mode.NonSymbolTokens:this._candidate=this._processNonSymbolToken(e);break;case WI.CodeMirrorTokenTrackingController.Mode.JavaScriptExpression:case WI.CodeMirrorTokenTrackingController.Mode.JavaScriptTypeInformation:this._candidate=this._processJavaScriptExpression(e);break;case WI.CodeMirrorTokenTrackingController.Mode.MarkedTokens:this._candidate=this._processMarkedToken(e);break}!this._candidate||(this._candidate.triggeredBy=e.triggeredBy,this._markedTextMouseoutTimer&&clearTimeout(this._markedTextMouseoutTimer),this._markedTextMouseoutTimer=0,this._delegate&&typeof this._delegate.tokenTrackingControllerNewHighlightCandidate=="function"&&this._delegate.tokenTrackingControllerNewHighlightCandidate(this,this._candidate))}}_processNonSymbolToken(e){var t=e.token.type;if(!t)return null;var i={line:e.position.line,ch:e.token.start},n={line:e.position.line,ch:e.token.end};return{hoveredToken:e.token,hoveredTokenRange:{start:i,end:n}}}_processJavaScriptExpression(e){if(e.modeName!=="javascript")return null;var t={line:e.position.line,ch:e.token.start},i={line:e.position.line,ch:e.token.end};function n(k,R){return k.line>=R.start.line&&k.ch>=R.start.ch&&k.line<=R.end.line&&k.ch<=R.end.ch}if(this._codeMirror.somethingSelected()){var s={start:this._codeMirror.getCursor("start"),end:this._codeMirror.getCursor("end")};if(n(t,s)||n(i,s))return{hoveredToken:e.token,hoveredTokenRange:s,expression:this._codeMirror.getSelection(),expressionRange:s}}var a=e.token.type,d=a.indexOf("property")!==-1,p=a.indexOf("keyword")!==-1;if(!d&&!p&&a.indexOf("variable")===-1&&a.indexOf("def")===-1)return null;let f=e.innerMode.state;if(d&&f.lexical&&f.lexical.type==="}"){let k=!1,R=e.innerMode.mode,M={line:e.position.line,ch:e.token.end};if(WI.walkTokens(this._codeMirror,R,M,function(L,V){return L||V==="("?!1:V===","||V==="}"?(k=!0,!1):!0}),!k)return null}if(p&&e.token.string!=="this")return null;for(var _=e.token.string,b={line:e.position.line,ch:e.token.start};;){var w=this._codeMirror.getTokenAt(b);if(!w)break;var S=!w.type&&w.string===".",E=w.type&&w.type.includes("m-javascript");if(!S&&!E||E&&(w.type.includes("operator")||w.type.includes("string-2")))break;_=w.string+_,b.ch=w.start}return{hoveredToken:e.token,hoveredTokenRange:{start:t,end:i},expression:_,expressionRange:{start:b,end:i}}}_processMarkedToken(e){return this._processNonSymbolToken(e)}_resetTrackingStates(){this._tokenHoverTimer&&clearTimeout(this._tokenHoverTimer),this._tokenHoverTimer=0,this._selectionMayBeInProgress=!1,this._previousTokenInfo=null,this.removeHighlightedRange()}};WI.CodeMirrorTokenTrackingController.JumpToSymbolHighlightStyleClassName="jump-to-symbol-highlight";WI.CodeMirrorTokenTrackingController.Mode={None:"none",NonSymbolTokens:"non-symbol-tokens",JavaScriptExpression:"javascript-expression",JavaScriptTypeInformation:"javascript-type-information",MarkedTokens:"marked-tokens"};WI.CodeMirrorTokenTrackingController.TriggeredBy={Keyboard:"keyboard",Hover:"hover"};WI.CodeMirrorTextKillController=class extends WI.Object{constructor(e){super(),console.assert(e),this._codeMirror=e,this._expectingChangeEventForKill=!1,this._nextKillStartsNewSequence=!0,this._shouldPrependToKillRing=!1,this._handleTextChangeListener=this._handleTextChange.bind(this),this._handleEditorBlurListener=this._handleEditorBlur.bind(this),this._handleSelectionOrCaretChangeListener=this._handleSelectionOrCaretChange.bind(this),this._codeMirror.addKeyMap({"Ctrl-K":this._handleTextKillCommand.bind(this,"killLine",!1),"Alt-D":this._handleTextKillCommand.bind(this,"delWordAfter",!1),"Alt-Delete":this._handleTextKillCommand.bind(this,"delGroupAfter",!1),"Cmd-Backspace":this._handleTextKillCommand.bind(this,"delWrappedLineLeft",!0),"Cmd-Delete":this._handleTextKillCommand.bind(this,"delWrappedLineRight",!1),"Alt-Backspace":this._handleTextKillCommand.bind(this,"delGroupBefore",!0),"Ctrl-Alt-Backspace":this._handleTextKillCommand.bind(this,"delGroupAfter",!1)})}_handleTextKillCommand(e,t,i){this._codeMirror.getOption("readOnly")||(this._shouldPrependToKillRing=t,this._expectingChangeEventForKill||this._codeMirror.on("changes",this._handleTextChangeListener),this._expectingChangeEventForKill=!0,this._codeMirror.execCommand(e))}_handleTextChange(e,t){if(this._codeMirror.off("changes",this._handleTextChangeListener),!this._expectingChangeEventForKill)return;this._expectingChangeEventForKill=!1,console.assert(t.length===1);let i=t[0];if(i.origin!=="+delete")return;let n;i.to.line===i.from.line+1&&i.removed.length===2?i.removed[0].length&&!i.removed[1].length?n=i.removed[0]+`
`:n=`
`:(console.assert(i.removed.length===1),n=i.removed[0]),InspectorFrontendHost.killText(n,this._shouldPrependToKillRing,this._nextKillStartsNewSequence),this._nextKillStartsNewSequence=!1,this._codeMirror.on("blur",this._handleEditorBlurListener),this._codeMirror.on("cursorActivity",this._handleSelectionOrCaretChangeListener)}_handleEditorBlur(e){this._nextKillStartsNewSequence=!0,this._codeMirror.off("blur",this._handleEditorBlurListener),this._codeMirror.off("cursorActivity",this._handleSelectionOrCaretChangeListener)}_handleSelectionOrCaretChange(e){this._expectingChangeEventForKill||(this._nextKillStartsNewSequence=!0,this._codeMirror.off("blur",this._handleEditorBlurListener),this._codeMirror.off("cursorActivity",this._handleSelectionOrCaretChangeListener))}};WI.ConsoleManager=class extends WI.Object{constructor(){super(),this._issues=[],this._clearMessagesRequested=!1,this._isNewPageOrReload=!1,this._remoteObjectsToRelease=null,WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this),this._customLoggingChannels=[],this._loggingChannelSources=[]}static supportsLogChannels(){return!!ConsoleAgent.getLoggingChannels}static issueMatchSourceCode(e,t){return t instanceof WI.SourceMapResource?e.sourceCodeLocation&&e.sourceCodeLocation.displaySourceCode===t:t instanceof WI.Resource?e.url===t.url&&(!e.sourceCodeLocation||e.sourceCodeLocation.sourceCode===t):t instanceof WI.Script?e.sourceCodeLocation&&e.sourceCodeLocation.sourceCode===t:!1}get customLoggingChannels(){return this._customLoggingChannels}get logChannelSources(){return this._loggingChannelSources}issuesForSourceCode(e){for(var t=[],i=0;i<this._issues.length;++i){var n=this._issues[i];WI.ConsoleManager.issueMatchSourceCode(n,e)&&t.push(n)}return t}releaseRemoteObjectWithConsoleClear(e){this._remoteObjectsToRelease||(this._remoteObjectsToRelease=new Set),this._remoteObjectsToRelease.add(e)}messageWasAdded(e,t,i,n,s,a,d,p,f,_,b,w){_&&(_=_.map(E=>WI.RemoteObject.fromPayload(E,e)));let S=new WI.ConsoleMessage(e,t,i,n,s,a,d,p,f,_,b,null);if(this.dispatchEventToListeners(WI.ConsoleManager.Event.MessageAdded,{message:S}),S.level==="warning"||S.level==="error"){let E=new WI.IssueMessage(S);this._issues.push(E),this.dispatchEventToListeners(WI.ConsoleManager.Event.IssueAdded,{issue:E})}}messagesCleared(){if(this._remoteObjectsToRelease){for(let e of this._remoteObjectsToRelease)e.release();this._remoteObjectsToRelease=null}WI.ConsoleCommandResultMessage.clearMaximumSavedResultIndex(),this._clearMessagesRequested?(this._clearMessagesRequested=!1,this._issues=[],this.dispatchEventToListeners(WI.ConsoleManager.Event.Cleared)):setTimeout(this._delayedMessagesCleared.bind(this),0)}_delayedMessagesCleared(){this._isNewPageOrReload&&(this._isNewPageOrReload=!1,!WI.settings.clearLogOnNavigate.value)||(this._issues=[],this.dispatchEventToListeners(WI.ConsoleManager.Event.Cleared))}messageRepeatCountUpdated(e){this.dispatchEventToListeners(WI.ConsoleManager.Event.PreviousMessageRepeatCountUpdated,{count:e})}requestClearMessages(){this._clearMessagesRequested=!0;for(let e of WI.targets)e.ConsoleAgent.clearMessages()}initializeLogChannels(e){console.assert(e.ConsoleAgent),WI.ConsoleManager.supportsLogChannels()&&(this._loggingChannelSources.length||(this._loggingChannelSources=[WI.ConsoleMessage.MessageSource.Media,WI.ConsoleMessage.MessageSource.WebRTC,WI.ConsoleMessage.MessageSource.MediaSource],e.ConsoleAgent.getLoggingChannels((t,i)=>{t||(console.assert(i.every(n=>this._loggingChannelSources.includes(n.source))),this._customLoggingChannels=i.map(WI.LoggingChannel.fromPayload))})))}_mainResourceDidChange(e){if(console.assert(e.target instanceof WI.Frame),!e.target.isMainFrame())return;this._isNewPageOrReload=!0;let t=Date.now(),i=e.data.oldMainResource&&e.data.oldMainResource.url===e.target.mainResource.url;this.dispatchEventToListeners(WI.ConsoleManager.Event.SessionStarted,{timestamp:t,wasReloaded:i}),WI.ConsoleCommandResultMessage.clearMaximumSavedResultIndex()}};WI.ConsoleManager.Event={SessionStarted:"console-manager-session-was-started",Cleared:"console-manager-cleared",MessageAdded:"console-manager-message-added",IssueAdded:"console-manager-issue-added",PreviousMessageRepeatCountUpdated:"console-manager-previous-message-repeat-count-updated"};WI.DOMDebuggerManager=class extends WI.Object{constructor(){super(),this._domBreakpointURLMap=new Multimap,this._domBreakpointFrameIdentifierMap=new Map,this._eventBreakpoints=[],this._urlBreakpoints=[],this._allRequestsBreakpointEnabledSetting=new WI.Setting("break-on-all-requests",!1),this._allRequestsBreakpoint=new WI.URLBreakpoint(WI.URLBreakpoint.Type.Text,"",{disabled:!this._allRequestsBreakpointEnabledSetting.value}),WI.DOMBreakpoint.addEventListener(WI.DOMBreakpoint.Event.DisabledStateChanged,this._handleDOMBreakpointDisabledStateChanged,this),WI.EventBreakpoint.addEventListener(WI.EventBreakpoint.Event.DisabledStateChanged,this._handleEventBreakpointDisabledStateChanged,this),WI.URLBreakpoint.addEventListener(WI.URLBreakpoint.Event.DisabledStateChanged,this._handleURLBreakpointDisabledStateChanged,this),WI.domManager.addEventListener(WI.DOMManager.Event.NodeRemoved,this._nodeRemoved,this),WI.domManager.addEventListener(WI.DOMManager.Event.NodeInserted,this._nodeInserted,this),WI.networkManager.addEventListener(WI.NetworkManager.Event.MainFrameDidChange,this._mainFrameDidChange,this),WI.Frame.addEventListener(WI.Frame.Event.ChildFrameWasRemoved,this._childFrameWasRemoved,this),WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this);let e=async(t,i,n,s)=>{for(let d of n){let p=WI.Setting.migrateValue(d);if(p)for(let f of p)await i.putObject(t.deserialize(f))}let a=await i.getAll();this._restoringBreakpoints=!0;for(let d of a){let p=t.deserialize(d);const f=null;i.associateObject(p,f,d),s(p)}this._restoringBreakpoints=!1};this.supported&&(e(WI.DOMBreakpoint,WI.objectStores.domBreakpoints,["dom-breakpoints"],t=>{this.addDOMBreakpoint(t)}),e(WI.EventBreakpoint,WI.objectStores.eventBreakpoints,["event-breakpoints"],t=>{this.addEventBreakpoint(t)}),e(WI.URLBreakpoint,WI.objectStores.urlBreakpoints,["xhr-breakpoints","url-breakpoints"],t=>{this.addURLBreakpoint(t)}))}initializeTarget(e){if(e.DOMDebuggerAgent){e===WI.assumingMainTarget()&&e.mainResource&&this._speculativelyResolveDOMBreakpointsForURL(e.mainResource.url);for(let t of this._eventBreakpoints)t.disabled||this._updateEventBreakpoint(t,e);for(let t of this._urlBreakpoints)t.disabled||this._updateURLBreakpoint(t,e);this._allRequestsBreakpoint.disabled||this._updateURLBreakpoint(this._allRequestsBreakpoint,e)}}static supportsEventBreakpoints(){return InspectorBackend.domains.DOMDebugger.setEventBreakpoint&&InspectorBackend.domains.DOMDebugger.removeEventBreakpoint}static supportsURLBreakpoints(){return InspectorBackend.domains.DOMDebugger.setURLBreakpoint&&InspectorBackend.domains.DOMDebugger.removeURLBreakpoint}get supported(){return!!InspectorBackend.domains.DOMDebugger}get allRequestsBreakpoint(){return this._allRequestsBreakpoint}get domBreakpoints(){let e=WI.networkManager.mainFrame;if(!e)return[];let t=[],i=[e];for(;i.length;){let n=i.shift(),s=this._domBreakpointFrameIdentifierMap.get(n.id);s&&(t=t.concat(Array.from(s.values()))),i.push(...n.childFrameCollection)}return t}get eventBreakpoints(){return this._eventBreakpoints}get urlBreakpoints(){return this._urlBreakpoints}isBreakpointSpecial(e){return e===this._allRequestsBreakpoint}domBreakpointsForNode(e){if(console.assert(e instanceof WI.DOMNode),!e||!e.frame)return[];let t=this._domBreakpointFrameIdentifierMap.get(e.frame.id);if(!t)return[];let i=t.get(e.id);return i?Array.from(i):[]}domBreakpointsInSubtree(e){console.assert(e instanceof WI.DOMNode);let t=[];if(e.children){let i=Array.from(e.children);for(;i.length;){let n=i.pop();n.children&&(i=i.concat(n.children)),t=t.concat(this.domBreakpointsForNode(n))}}return t}addDOMBreakpoint(e){if(console.assert(e instanceof WI.DOMBreakpoint),!(!e||!e.url)){if(this.isBreakpointSpecial(e)){this.dispatchEventToListeners(WI.DOMDebuggerManager.Event.DOMBreakpointAdded,{breakpoint:e});return}this._domBreakpointURLMap.add(e.url,e),e.domNodeIdentifier&&this._resolveDOMBreakpoint(e,e.domNodeIdentifier),this.dispatchEventToListeners(WI.DOMDebuggerManager.Event.DOMBreakpointAdded,{breakpoint:e}),this._restoringBreakpoints||WI.objectStores.domBreakpoints.putObject(e)}}removeDOMBreakpoint(e){if(console.assert(e instanceof WI.DOMBreakpoint),!!e){if(this.isBreakpointSpecial(e)){e.disabled=!0,this.dispatchEventToListeners(WI.DOMDebuggerManager.Event.DOMBreakpointRemoved,{breakpoint:e});return}this._detachDOMBreakpoint(e),this._domBreakpointURLMap.delete(e.url),e.disabled||WI.assumingMainTarget().DOMDebuggerAgent.removeDOMBreakpoint(e.domNodeIdentifier,e.type),this.dispatchEventToListeners(WI.DOMDebuggerManager.Event.DOMBreakpointRemoved,{breakpoint:e}),e.domNodeIdentifier=null,this._restoringBreakpoints||WI.objectStores.domBreakpoints.deleteObject(e)}}removeDOMBreakpointsForNode(e){this.domBreakpointsForNode(e).forEach(this.removeDOMBreakpoint,this)}eventBreakpointForTypeAndEventName(e,t){return this._eventBreakpoints.find(i=>i.type===e&&i.eventName===t)||null}addEventBreakpoint(e){if(console.assert(e instanceof WI.EventBreakpoint),!!e){if(this.isBreakpointSpecial(e)){this.dispatchEventToListeners(WI.DOMDebuggerManager.Event.EventBreakpointAdded,{breakpoint:e});return}if(!this.eventBreakpointForTypeAndEventName(e.type,e.eventName)){if(this._eventBreakpoints.push(e),this.dispatchEventToListeners(WI.DOMDebuggerManager.Event.EventBreakpointAdded,{breakpoint:e}),!e.disabled)for(let t of WI.targets)t.DOMDebuggerAgent&&this._updateEventBreakpoint(e,t);this._restoringBreakpoints||WI.objectStores.eventBreakpoints.putObject(e)}}}removeEventBreakpoint(e){if(console.assert(e instanceof WI.EventBreakpoint),!!e){if(this.isBreakpointSpecial(e)){e.disabled=!0,this.dispatchEventToListeners(WI.DOMDebuggerManager.Event.EventBreakpointRemoved,{breakpoint:e});return}if(!!this._eventBreakpoints.includes(e)&&(this._eventBreakpoints.remove(e),this._restoringBreakpoints||WI.objectStores.eventBreakpoints.deleteObject(e),this.dispatchEventToListeners(WI.DOMDebuggerManager.Event.EventBreakpointRemoved,{breakpoint:e}),!e.disabled)){for(let t of WI.targets)if(t.DOMDebuggerAgent){if(!WI.DOMDebuggerManager.supportsEventBreakpoints()){console.assert(e.type===WI.EventBreakpoint.Type.Listener),t.DOMDebuggerAgent.removeEventListenerBreakpoint(e.eventName);continue}t.DOMDebuggerAgent.removeEventBreakpoint(e.type,e.eventName)}}}}urlBreakpointForURL(e){return this._urlBreakpoints.find(t=>t.url===e)||null}addURLBreakpoint(e){if(console.assert(e instanceof WI.URLBreakpoint),!!e){if(this.isBreakpointSpecial(e)){this.dispatchEventToListeners(WI.DOMDebuggerManager.Event.URLBreakpointAdded,{breakpoint:e});return}if(console.assert(!this._urlBreakpoints.includes(e),"Already added URL breakpoint.",e),!this._urlBreakpoints.includes(e)&&!this._urlBreakpoints.some(t=>t.type===e.type&&t.url===e.url)){if(this._urlBreakpoints.push(e),this.dispatchEventToListeners(WI.DOMDebuggerManager.Event.URLBreakpointAdded,{breakpoint:e}),!e.disabled)for(let t of WI.targets)t.DOMDebuggerAgent&&this._updateURLBreakpoint(e,t);this._restoringBreakpoints||WI.objectStores.urlBreakpoints.putObject(e)}}}removeURLBreakpoint(e){if(console.assert(e instanceof WI.URLBreakpoint),!!e){if(this.isBreakpointSpecial(e)){e.disabled=!0,this.dispatchEventToListeners(WI.DOMDebuggerManager.Event.URLBreakpointRemoved,{breakpoint:e});return}if(!!this._urlBreakpoints.includes(e)&&(this._urlBreakpoints.remove(e,!0),this._restoringBreakpoints||WI.objectStores.urlBreakpoints.deleteObject(e),this.dispatchEventToListeners(WI.DOMDebuggerManager.Event.URLBreakpointRemoved,{breakpoint:e}),!e.disabled))for(let t of WI.targets)t.DOMDebuggerAgent&&(WI.DOMDebuggerManager.supportsURLBreakpoints()?t.DOMDebuggerAgent.removeURLBreakpoint(e.url):t.DOMDebuggerAgent.removeXHRBreakpoint(e.url))}}_detachDOMBreakpoint(e){let t=e.domNodeIdentifier,i=WI.domManager.nodeForId(t);if(console.assert(i,"Missing DOM node for breakpoint.",e),!i||!i.frame)return;let n=i.frame.id,s=this._domBreakpointFrameIdentifierMap.get(n);console.assert(s,"Missing DOM breakpoints for node parent frame.",i),s&&(s.delete(t,e),s.size||this._domBreakpointFrameIdentifierMap.delete(n))}_detachBreakpointsForFrame(e){let t=this._domBreakpointFrameIdentifierMap.get(e.id);if(!!t){this._domBreakpointFrameIdentifierMap.delete(e.id);for(let i of t.values())i.domNodeIdentifier=null}}_speculativelyResolveDOMBreakpointsForURL(e){let t=this._domBreakpointURLMap.get(e);if(!!t)for(let i of t)i.domNodeIdentifier||WI.domManager.pushNodeByPathToFrontend(i.path,n=>{if(i.domNodeIdentifier){console.assert(i.domNodeIdentifier===n);return}n&&this._resolveDOMBreakpoint(i,n)})}_resolveDOMBreakpoint(e,t){let i=WI.domManager.nodeForId(t);if(console.assert(i,"Missing DOM node for nodeIdentifier.",t),!i||!i.frame)return;let n=i.frame.id,s=this._domBreakpointFrameIdentifierMap.get(n);if(s||(s=new Multimap,this._domBreakpointFrameIdentifierMap.set(n,s)),s.add(t,e),e.domNodeIdentifier=t,!e.disabled){let a=WI.assumingMainTarget();a&&a.DOMDebuggerAgent&&this._updateDOMBreakpoint(e,a)}}_updateDOMBreakpoint(e,t){console.assert(t.DOMDebuggerAgent),e.domNodeIdentifier&&(e.disabled?t.DOMDebuggerAgent.removeDOMBreakpoint(e.domNodeIdentifier,e.type):(!this._restoringBreakpoints&&!WI.debuggerManager.breakpointsDisabledTemporarily&&(WI.debuggerManager.breakpointsEnabled=!0),t.DOMDebuggerAgent.setDOMBreakpoint(e.domNodeIdentifier,e.type)))}_updateEventBreakpoint(e,t){if(console.assert(t.DOMDebuggerAgent),!WI.DOMDebuggerManager.supportsEventBreakpoints()){console.assert(e.type===WI.EventBreakpoint.Type.Listener),e.disabled?t.DOMDebuggerAgent.removeEventListenerBreakpoint(e.eventName):(!this._restoringBreakpoints&&!WI.debuggerManager.breakpointsDisabledTemporarily&&(WI.debuggerManager.breakpointsEnabled=!0),t.DOMDebuggerAgent.setEventListenerBreakpoint(e.eventName));return}e.disabled?t.DOMDebuggerAgent.removeEventBreakpoint(e.type,e.eventName):(!this._restoringBreakpoints&&!WI.debuggerManager.breakpointsDisabledTemporarily&&(WI.debuggerManager.breakpointsEnabled=!0),t.DOMDebuggerAgent.setEventBreakpoint(e.type,e.eventName))}_updateURLBreakpoint(e,t){if(console.assert(t.DOMDebuggerAgent),!WI.DOMDebuggerManager.supportsURLBreakpoints()){if(e.disabled)t.DOMDebuggerAgent.removeXHRBreakpoint(e.url);else{!this._restoringBreakpoints&&!WI.debuggerManager.breakpointsDisabledTemporarily&&(WI.debuggerManager.breakpointsEnabled=!0);let i=e.type===WI.URLBreakpoint.Type.RegularExpression;t.DOMDebuggerAgent.setXHRBreakpoint(e.url,i)}return}if(e.disabled)t.DOMDebuggerAgent.removeURLBreakpoint(e.url);else{!this._restoringBreakpoints&&!WI.debuggerManager.breakpointsDisabledTemporarily&&(WI.debuggerManager.breakpointsEnabled=!0);let i=e.type===WI.URLBreakpoint.Type.RegularExpression;t.DOMDebuggerAgent.setURLBreakpoint(e.url,i)}}_handleDOMBreakpointDisabledStateChanged(e){let t=e.target,i=WI.assumingMainTarget();i&&i.DOMDebuggerAgent&&this._updateDOMBreakpoint(t,i),this._restoringBreakpoints||WI.objectStores.domBreakpoints.putObject(t)}_handleEventBreakpointDisabledStateChanged(e){let t=e.target;if(!t.eventListener){for(let i of WI.targets)i.DOMDebuggerAgent&&this._updateEventBreakpoint(t,i);this._restoringBreakpoints||WI.objectStores.eventBreakpoints.putObject(t)}}_handleURLBreakpointDisabledStateChanged(e){let t=e.target;t===this._allRequestsBreakpoint&&(this._allRequestsBreakpointEnabledSetting.value=!t.disabled);for(let i of WI.targets)i.DOMDebuggerAgent&&this._updateURLBreakpoint(t,i);this._restoringBreakpoints||WI.objectStores.urlBreakpoints.putObject(t)}_childFrameWasRemoved(e){let t=e.data.childFrame;this._detachBreakpointsForFrame(t)}_mainFrameDidChange(e){this._speculativelyResolveDOMBreakpointsForURL(WI.networkManager.mainFrame.url)}_mainResourceDidChange(e){let t=e.target;if(t.isMainFrame()){for(let i of this._domBreakpointURLMap.values())i.domNodeIdentifier=null;this._domBreakpointFrameIdentifierMap.clear()}else this._detachBreakpointsForFrame(t);this._speculativelyResolveDOMBreakpointsForURL(t.url)}_nodeInserted(e){let t=e.data.node;if(t.nodeType()!==Node.ELEMENT_NODE||!t.frame)return;let i=t.frame.url,n=this._domBreakpointURLMap.get(i);if(!!n)for(let s of n)s.domNodeIdentifier||s.path===t.path()&&this._resolveDOMBreakpoint(s,t.id)}_nodeRemoved(e){let t=e.data.node;if(t.nodeType()!==Node.ELEMENT_NODE||!t.frame)return;let i=this._domBreakpointFrameIdentifierMap.get(t.frame.id);if(!i)return;let n=i.get(t.id);if(!!n){i.delete(t.id),i.size||this._domBreakpointFrameIdentifierMap.delete(t.frame.id);for(let s of n)s.domNodeIdentifier=null}}};WI.DOMDebuggerManager.Event={DOMBreakpointAdded:"dom-debugger-manager-dom-breakpoint-added",DOMBreakpointRemoved:"dom-debugger-manager-dom-breakpoint-removed",EventBreakpointAdded:"dom-debugger-manager-event-breakpoint-added",EventBreakpointRemoved:"dom-debugger-manager-event-breakpoint-removed",URLBreakpointAdded:"dom-debugger-manager-url-breakpoint-added",URLBreakpointRemoved:"dom-debugger-manager-url-breakpoint-removed"};WI.DOMManager=class extends WI.Object{constructor(){super(),this._idToDOMNode={},this._document=null,this._attributeLoadNodeIds={},this._restoreSelectedNodeIsAllowed=!0,this._loadNodeAttributesTimeout=0,this._inspectedNode=null,this._breakpointsForEventListeners=new Map,this._hasRequestedDocument=!1,this._pendingDocumentRequestCallbacks=null,WI.EventBreakpoint.addEventListener(WI.EventBreakpoint.Event.DisabledStateChanged,this._handleEventBreakpointDisabledStateChanged,this),WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this)}initializeTarget(e){e.DOMAgent&&setTimeout(()=>{this.ensureDocument()})}transitionPageTarget(){this._documentUpdated()}get inspectedNode(){return this._inspectedNode}get eventListenerBreakpoints(){return Array.from(this._breakpointsForEventListeners.values())}requestDocument(e){if(this._document){e(this._document);return}this._pendingDocumentRequestCallbacks?this._pendingDocumentRequestCallbacks.push(e):this._pendingDocumentRequestCallbacks=[e],!this._hasRequestedDocument&&(!WI.pageTarget||!WI.pageTarget.DOMAgent||(this._hasRequestedDocument=!0,WI.pageTarget.DOMAgent.getDocument((t,i)=>{t||this._setDocument(i);for(let n of this._pendingDocumentRequestCallbacks)n(this._document);this._pendingDocumentRequestCallbacks=null})))}ensureDocument(){this.requestDocument(function(){})}pushNodeToFrontend(e,t){this._dispatchWhenDocumentAvailable(DOMAgent.requestNode.bind(DOMAgent,e),t)}pushNodeByPathToFrontend(e,t){this._dispatchWhenDocumentAvailable(DOMAgent.pushNodeByPathToFrontend.bind(DOMAgent,e),t)}didAddEventListener(e){let t=this._idToDOMNode[e];!t||t.dispatchEventToListeners(WI.DOMNode.Event.EventListenersChanged)}willRemoveEventListener(e){let t=this._idToDOMNode[e];!t||t.dispatchEventToListeners(WI.DOMNode.Event.EventListenersChanged)}didFireEvent(e,t,i,n){let s=this._idToDOMNode[e];!s||s.didFireEvent(t,i,n)}powerEfficientPlaybackStateChanged(e,t,i){let n=this._idToDOMNode[e];!n||n.powerEfficientPlaybackStateChanged(t,i)}_wrapClientCallback(e){return e?function(t,i){t&&console.error("Error during DOMAgent operation: "+t),e(t?null:i)}:null}_dispatchWhenDocumentAvailable(e,t){var i=this._wrapClientCallback(t);function n(){this._document?e(i):i&&i("No document")}this.requestDocument(n.bind(this))}_attributeModified(e,t,i){var n=this._idToDOMNode[e];!n||(n._setAttribute(t,i),this.dispatchEventToListeners(WI.DOMManager.Event.AttributeModified,{node:n,name:t}),n.dispatchEventToListeners(WI.DOMNode.Event.AttributeModified,{name:t}))}_attributeRemoved(e,t){var i=this._idToDOMNode[e];!i||(i._removeAttribute(t),this.dispatchEventToListeners(WI.DOMManager.Event.AttributeRemoved,{node:i,name:t}),i.dispatchEventToListeners(WI.DOMNode.Event.AttributeRemoved,{name:t}))}_inlineStyleInvalidated(e){for(var t of e)this._attributeLoadNodeIds[t]=!0;this._loadNodeAttributesTimeout||(this._loadNodeAttributesTimeout=setTimeout(this._loadNodeAttributes.bind(this),0))}_loadNodeAttributes(){function e(n,s,a){if(s){console.error("Error during DOMAgent operation: "+s);return}var d=this._idToDOMNode[n];d&&(d._setAttributesPayload(a),this.dispatchEventToListeners(WI.DOMManager.Event.AttributeModified,{node:d,name:"style"}),d.dispatchEventToListeners(WI.DOMNode.Event.AttributeModified,{name:"style"}))}this._loadNodeAttributesTimeout=0;for(var t in this._attributeLoadNodeIds){var i=parseInt(t);DOMAgent.getAttributes(i,e.bind(this,i))}this._attributeLoadNodeIds={}}_characterDataModified(e,t){var i=this._idToDOMNode[e];i._nodeValue=t,this.dispatchEventToListeners(WI.DOMManager.Event.CharacterDataModified,{node:i})}nodeForId(e){return this._idToDOMNode[e]}_documentUpdated(){this._setDocument(null)}_setDocument(e){this._idToDOMNode={};for(let i of this._breakpointsForEventListeners.values())WI.domDebuggerManager.dispatchEventToListeners(WI.DOMDebuggerManager.Event.EventBreakpointRemoved,{breakpoint:i});this._breakpointsForEventListeners.clear();let t=null;e&&"nodeId"in e&&(t=new WI.DOMNode(this,null,!1,e)),this._document!==t&&(this._document=t,this._document||(this._hasRequestedDocument=!1),this.dispatchEventToListeners(WI.DOMManager.Event.DocumentUpdated,{document:this._document}))}_setDetachedRoot(e){new WI.DOMNode(this,null,!1,e)}_setChildNodes(e,t){if(!e&&t.length){this._setDetachedRoot(t[0]);return}var i=this._idToDOMNode[e];i._setChildrenPayload(t)}_childNodeCountUpdated(e,t){var i=this._idToDOMNode[e];i.childNodeCount=t,this.dispatchEventToListeners(WI.DOMManager.Event.ChildNodeCountUpdated,i)}_childNodeInserted(e,t,i){var n=this._idToDOMNode[e],s=this._idToDOMNode[t],a=n._insertChild(s,i);this._idToDOMNode[a.id]=a,this.dispatchEventToListeners(WI.DOMManager.Event.NodeInserted,{node:a,parent:n})}_childNodeRemoved(e,t){var i=this._idToDOMNode[e],n=this._idToDOMNode[t];i._removeChild(n),this._unbind(n),this.dispatchEventToListeners(WI.DOMManager.Event.NodeRemoved,{node:n,parent:i})}_customElementStateChanged(e,t){const i=this._idToDOMNode[e];i._customElementState=t,this.dispatchEventToListeners(WI.DOMManager.Event.CustomElementStateChanged,{node:i})}_pseudoElementAdded(e,t){var i=this._idToDOMNode[e];if(!!i){var n=new WI.DOMNode(this,i.ownerDocument,!1,t);n.parentNode=i,this._idToDOMNode[n.id]=n,console.assert(!i.pseudoElements().get(n.pseudoType())),i.pseudoElements().set(n.pseudoType(),n),this.dispatchEventToListeners(WI.DOMManager.Event.NodeInserted,{node:n,parent:i})}}_pseudoElementRemoved(e,t){var i=this._idToDOMNode[t];if(!!i){var n=i.parentNode;console.assert(n),console.assert(n.id===e),n&&(n._removeChild(i),this._unbind(i),this.dispatchEventToListeners(WI.DOMManager.Event.NodeRemoved,{node:i,parent:n}))}}_unbind(e){delete this._idToDOMNode[e.id];for(let i=0;e.children&&i<e.children.length;++i)this._unbind(e.children[i]);let t=e.templateContent();t&&this._unbind(t);for(let i of e.pseudoElements().values())this._unbind(i)}get restoreSelectedNodeIsAllowed(){return this._restoreSelectedNodeIsAllowed}inspectElement(e){var t=this._idToDOMNode[e];!t||!t.ownerDocument||(this.dispatchEventToListeners(WI.DOMManager.Event.DOMNodeWasInspected,{node:t}),this._inspectModeEnabled=!1,this.dispatchEventToListeners(WI.DOMManager.Event.InspectModeStateChanged))}inspectNodeObject(e){this._restoreSelectedNodeIsAllowed=!1;function t(i){if(e.release(),console.assert(i),!i)return;this.inspectElement(i);let n=this.nodeForId(i);WI.RemoteObject.resolveNode(n,WI.RuntimeManager.ConsoleObjectGroup).then(s=>{WI.consoleLogViewController.appendImmediateExecutionWithResult(WI.UIString("Selected Element"),s,!0,!1)})}e.pushNodeToFrontend(t.bind(this))}querySelector(e,t,i){let n=e instanceof WI.DOMNode?e.id:e;if(console.assert(typeof n=="number"),typeof i=="function")DOMAgent.querySelector(n,t,this._wrapClientCallback(i));else return DOMAgent.querySelector(n,t).then(({nodeId:s})=>s)}querySelectorAll(e,t,i){let n=e instanceof WI.DOMNode?e.id:e;if(console.assert(typeof n=="number"),typeof i=="function")DOMAgent.querySelectorAll(n,t,this._wrapClientCallback(i));else return DOMAgent.querySelectorAll(n,t).then(({nodeIds:s})=>s)}highlightDOMNode(e,t){this._hideDOMNodeHighlightTimeout&&(clearTimeout(this._hideDOMNodeHighlightTimeout),this._hideDOMNodeHighlightTimeout=void 0),this._highlightedDOMNodeId=e,e?DOMAgent.highlightNode.invoke({nodeId:e,highlightConfig:this._buildHighlightConfig(t)}):DOMAgent.hideHighlight()}highlightDOMNodeList(e,t){!DOMAgent.highlightNodeList||(this._hideDOMNodeHighlightTimeout&&(clearTimeout(this._hideDOMNodeHighlightTimeout),this._hideDOMNodeHighlightTimeout=void 0),DOMAgent.highlightNodeList(e,this._buildHighlightConfig(t)))}highlightSelector(e,t,i){!DOMAgent.highlightSelector||(this._hideDOMNodeHighlightTimeout&&(clearTimeout(this._hideDOMNodeHighlightTimeout),this._hideDOMNodeHighlightTimeout=void 0),DOMAgent.highlightSelector(this._buildHighlightConfig(i),e,t))}highlightRect(e,t){DOMAgent.highlightRect.invoke({x:e.x,y:e.y,width:e.width,height:e.height,color:{r:111,g:168,b:220,a:.66},outlineColor:{r:255,g:229,b:153,a:.66},usePageCoordinates:t})}hideDOMNodeHighlight(){this.highlightDOMNode(0)}highlightDOMNodeForTwoSeconds(e){this.highlightDOMNode(e),this._hideDOMNodeHighlightTimeout=setTimeout(this.hideDOMNodeHighlight.bind(this),2e3)}get inspectModeEnabled(){return this._inspectModeEnabled}set inspectModeEnabled(e){if(e===this._inspectModeEnabled)return;let t={enabled:e,highlightConfig:this._buildHighlightConfig(),showRulers:WI.settings.showRulersDuringElementSelection.value};DOMAgent.setInspectModeEnabled.invoke(t,i=>{this._inspectModeEnabled=i?!1:e,this.dispatchEventToListeners(WI.DOMManager.Event.InspectModeStateChanged)})}setInspectedNode(e){if(console.assert(e instanceof WI.DOMNode),e===this._inspectedNode)return;let t=i=>{console.assert(!i,i),!i&&(this._inspectedNode=e,this.dispatchEventToListeners(WI.DOMManager.Event.InspectedNodeChanged))};if(!DOMAgent.setInspectedNode){ConsoleAgent.addInspectedNode(e.id,t);return}DOMAgent.setInspectedNode(e.id,t)}getSupportedEventNames(e){return DOMAgent.getSupportedEventNames?(this._getSupportedEventNamesPromise||(this._getSupportedEventNamesPromise=DOMAgent.getSupportedEventNames().then(({eventNames:t})=>new Set(t))),this._getSupportedEventNamesPromise):Promise.resolve(new Set)}setEventListenerDisabled(e,t){DOMAgent.setEventListenerDisabled(e.eventListenerId,t,i=>{i&&console.error(i)})}setBreakpointForEventListener(e){let t=this._breakpointsForEventListeners.get(e.eventListenerId);if(t){console.assert(t.disabled),t.disabled=!1;return}t=new WI.EventBreakpoint(WI.EventBreakpoint.Type.Listener,e.type,{eventListener:e}),console.assert(!t.disabled),this._breakpointsForEventListeners.set(e.eventListenerId,t);for(let i of WI.targets)i.DOMAgent&&this._updateEventBreakpoint(t,i);WI.domDebuggerManager.dispatchEventToListeners(WI.DOMDebuggerManager.Event.EventBreakpointAdded,{breakpoint:t})}removeBreakpointForEventListener(e){let t=this._breakpointsForEventListeners.take(e.eventListenerId);console.assert(t);for(let i of WI.targets)i.DOMAgent&&i.DOMAgent.removeBreakpointForEventListener(e.eventListenerId);WI.domDebuggerManager.dispatchEventToListeners(WI.DOMDebuggerManager.Event.EventBreakpointRemoved,{breakpoint:t})}removeEventListenerBreakpointsForNode(e){for(let t of Array.from(this._breakpointsForEventListeners.values())){let i=t.eventListener;i.nodeId===e.id&&this.removeBreakpointForEventListener(i)}}breakpointForEventListenerId(e){return this._breakpointsForEventListeners.get(e)||null}_buildHighlightConfig(e="all"){let t={showInfo:e==="all"};return(e==="all"||e==="content")&&(t.contentColor={r:111,g:168,b:220,a:.66}),(e==="all"||e==="padding")&&(t.paddingColor={r:147,g:196,b:125,a:.66}),(e==="all"||e==="border")&&(t.borderColor={r:255,g:229,b:153,a:.66}),(e==="all"||e==="margin")&&(t.marginColor={r:246,g:178,b:107,a:.66}),t}_updateEventBreakpoint(e,t){let i=e.eventListener;console.assert(i),e.disabled?t.DOMAgent.removeBreakpointForEventListener(i.eventListenerId):(WI.debuggerManager.breakpointsDisabledTemporarily||(WI.debuggerManager.breakpointsEnabled=!0),t.DOMAgent.setBreakpointForEventListener(i.eventListenerId))}_handleEventBreakpointDisabledStateChanged(e){let t=e.target;if(!!t.eventListener)for(let i of WI.targets)i.DOMAgent&&this._updateEventBreakpoint(t,i)}_mainResourceDidChange(e){!e.target.isMainFrame()||(this._restoreSelectedNodeIsAllowed=!0,this.ensureDocument())}};WI.DOMManager.Event={AttributeModified:"dom-manager-attribute-modified",AttributeRemoved:"dom-manager-attribute-removed",CharacterDataModified:"dom-manager-character-data-modified",NodeInserted:"dom-manager-node-inserted",NodeRemoved:"dom-manager-node-removed",CustomElementStateChanged:"dom-manager-custom-element-state-changed",DocumentUpdated:"dom-manager-document-updated",ChildNodeCountUpdated:"dom-manager-child-node-count-updated",DOMNodeWasInspected:"dom-manager-dom-node-was-inspected",InspectModeStateChanged:"dom-manager-inspect-mode-state-changed",InspectedNodeChanged:"dom-manager-inspected-node-changed"};WI.DOMStorageManager=class extends WI.Object{constructor(){super(),WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this),WI.Frame.addEventListener(WI.Frame.Event.SecurityOriginDidChange,this._securityOriginDidChange,this),this.initialize()}initializeTarget(e){e.DOMStorageAgent&&e.DOMStorageAgent.enable()}initialize(){this._domStorageObjects=[],this._cookieStorageObjects={}}get domStorageObjects(){return this._domStorageObjects}get cookieStorageObjects(){var e=[];for(var t in this._cookieStorageObjects)e.push(this._cookieStorageObjects[t]);return e}domStorageWasAdded(e,t,i){var n=new WI.DOMStorageObject(e,t,i);this._domStorageObjects.push(n),this.dispatchEventToListeners(WI.DOMStorageManager.Event.DOMStorageObjectWasAdded,{domStorage:n})}itemsCleared(e){let t=this._domStorageForIdentifier(e);t&&t.itemsCleared(e)}itemRemoved(e,t){let i=this._domStorageForIdentifier(e);i&&i.itemRemoved(t)}itemAdded(e,t,i){let n=this._domStorageForIdentifier(e);n&&n.itemAdded(t,i)}itemUpdated(e,t,i,n){let s=this._domStorageForIdentifier(e);s&&s.itemUpdated(t,i,n)}inspectDOMStorage(e){var t=this._domStorageForIdentifier(e);console.assert(t),t&&this.dispatchEventToListeners(WI.DOMStorageManager.Event.DOMStorageObjectWasInspected,{domStorage:t})}_domStorageForIdentifier(e){for(var t of this._domStorageObjects)if(Object.shallowEqual(t.id,e))return t;return null}_mainResourceDidChange(e){console.assert(e.target instanceof WI.Frame),e.target.isMainFrame()&&(this.initialize(),this.dispatchEventToListeners(WI.DOMStorageManager.Event.Cleared),this._addDOMStorageIfNeeded(e.target));var t=parseURL(e.target.url).host;!t||this._cookieStorageObjects[t]||(this._cookieStorageObjects[t]=new WI.CookieStorageObject(t),this.dispatchEventToListeners(WI.DOMStorageManager.Event.CookieStorageObjectWasAdded,{cookieStorage:this._cookieStorageObjects[t]}))}_addDOMStorageIfNeeded(e){if(!!window.DOMStorageAgent&&!(!e.securityOrigin||e.securityOrigin==="://")){var t={securityOrigin:e.securityOrigin,isLocalStorage:!0};this._domStorageForIdentifier(t)||this.domStorageWasAdded(t,e.mainResource.urlComponents.host,!0);var i={securityOrigin:e.securityOrigin,isLocalStorage:!1};this._domStorageForIdentifier(i)||this.domStorageWasAdded(i,e.mainResource.urlComponents.host,!1)}}_securityOriginDidChange(e){console.assert(e.target instanceof WI.Frame),this._addDOMStorageIfNeeded(e.target)}};WI.DOMStorageManager.Event={CookieStorageObjectWasAdded:"dom-storage-manager-cookie-storage-object-was-added",DOMStorageObjectWasAdded:"dom-storage-manager-dom-storage-object-was-added",DOMStorageObjectWasInspected:"dom-storage-manager-dom-storage-object-was-inspected",Cleared:"dom-storage-manager-cleared"};WI.DatabaseManager=class extends WI.Object{constructor(){super(),WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this),this.initialize()}initializeTarget(e){e.DatabaseAgent&&e.DatabaseAgent.enable()}initialize(){this._databaseObjects=[]}get databases(){return this._databaseObjects}databaseWasAdded(e,t,i,n){var s=new WI.DatabaseObject(e,t,i,n);this._databaseObjects.push(s),this.dispatchEventToListeners(WI.DatabaseManager.Event.DatabaseWasAdded,{database:s})}inspectDatabase(e){var t=this._databaseForIdentifier(e);console.assert(t),t&&this.dispatchEventToListeners(WI.DatabaseManager.Event.DatabaseWasInspected,{database:t})}_mainResourceDidChange(e){console.assert(e.target instanceof WI.Frame),e.target.isMainFrame()&&(this.initialize(),this.dispatchEventToListeners(WI.DatabaseManager.Event.Cleared))}_databaseForIdentifier(e){for(var t=0;t<this._databaseObjects.length;++t)if(this._databaseObjects[t].id===e)return this._databaseObjects[t];return null}};WI.DatabaseManager.Event={DatabaseWasAdded:"database-manager-database-was-added",DatabaseWasInspected:"database-manager-database-was-inspected",Cleared:"database-manager-cleared"};WI.DebuggerManager=class extends WI.Object{constructor(){super(),WI.notifications.addEventListener(WI.Notification.DebugUIEnabledDidChange,this._debugUIEnabledDidChange,this),WI.Breakpoint.addEventListener(WI.Breakpoint.Event.DisplayLocationDidChange,this._breakpointDisplayLocationDidChange,this),WI.Breakpoint.addEventListener(WI.Breakpoint.Event.DisabledStateDidChange,this._breakpointDisabledStateDidChange,this),WI.Breakpoint.addEventListener(WI.Breakpoint.Event.ConditionDidChange,this._breakpointEditablePropertyDidChange,this),WI.Breakpoint.addEventListener(WI.Breakpoint.Event.IgnoreCountDidChange,this._breakpointEditablePropertyDidChange,this),WI.Breakpoint.addEventListener(WI.Breakpoint.Event.AutoContinueDidChange,this._breakpointEditablePropertyDidChange,this),WI.Breakpoint.addEventListener(WI.Breakpoint.Event.ActionsDidChange,this._handleBreakpointActionsDidChange,this),WI.timelineManager.addEventListener(WI.TimelineManager.Event.CapturingStateChanged,this._handleTimelineCapturingStateChanged,this),WI.auditManager.addEventListener(WI.AuditManager.Event.TestScheduled,this._handleAuditManagerTestScheduled,this),WI.auditManager.addEventListener(WI.AuditManager.Event.TestCompleted,this._handleAuditManagerTestCompleted,this),WI.targetManager.addEventListener(WI.TargetManager.Event.TargetRemoved,this._targetRemoved,this),WI.settings.pauseForInternalScripts.addEventListener(WI.Setting.Event.Changed,this._pauseForInternalScriptsDidChange,this),WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this),this._breakpointsEnabledSetting=new WI.Setting("breakpoints-enabled",!0),this._allExceptionsBreakpointEnabledSetting=new WI.Setting("break-on-all-exceptions",!1),this._uncaughtExceptionsBreakpointEnabledSetting=new WI.Setting("break-on-uncaught-exceptions",!1),this._assertionFailuresBreakpointEnabledSetting=new WI.Setting("break-on-assertion-failures",!1),this._asyncStackTraceDepthSetting=new WI.Setting("async-stack-trace-depth",200);let e=new WI.SourceCodeLocation(null,1/0,1/0);this._allExceptionsBreakpoint=new WI.Breakpoint(e,{disabled:!this._allExceptionsBreakpointEnabledSetting.value}),this._allExceptionsBreakpoint.resolved=!0,this._uncaughtExceptionsBreakpoint=new WI.Breakpoint(e,{disabled:!this._uncaughtExceptionsBreakpointEnabledSetting.value}),this._uncaughtExceptionsBreakpoint.resolved=!0,this._assertionFailuresBreakpoint=new WI.Breakpoint(e,{disabled:!this._assertionFailuresBreakpointEnabledSetting.value}),this._assertionFailuresBreakpoint.resolved=!0,this._breakpoints=[],this._breakpointContentIdentifierMap=new Multimap,this._breakpointScriptIdentifierMap=new Multimap,this._breakpointIdMap=new Map,this._breakOnExceptionsState="none",this._updateBreakOnExceptionsState(),this._nextBreakpointActionIdentifier=1,this._activeCallFrame=null,this._internalWebKitScripts=[],this._targetDebuggerDataMap=new Map,this._knownProbeIdentifiersForBreakpoint=new Map,this._probesByIdentifier=new Map,this._probeSetsByBreakpoint=new Map,this._temporarilyDisabledBreakpointsRestoreSetting=new WI.Setting("temporarily-disabled-breakpoints-restore",null),this._temporarilyDisabledBreakpointsRestoreSetting.value!==null&&(this._breakpointsEnabledSetting.value=this._temporarilyDisabledBreakpointsRestoreSetting.value,this._temporarilyDisabledBreakpointsRestoreSetting.value=null),this._temporarilyDisableBreakpointsRequestCount=0,this._ignoreBreakpointDisplayLocationDidChangeEvent=!1,(async()=>{let t=WI.Setting.migrateValue("breakpoints");if(t)for(let n of t)await WI.objectStores.breakpoints.putObject(WI.Breakpoint.fromJSON(n));let i=await WI.objectStores.breakpoints.getAll();this._restoringBreakpoints=!0;for(let n of i){let s=WI.Breakpoint.fromJSON(n);const a=null;WI.objectStores.breakpoints.associateObject(s,a,n),this.addBreakpoint(s)}this._restoringBreakpoints=!1})()}initializeTarget(e){let t=this.dataForTarget(e);e.DebuggerAgent.enable(),e.DebuggerAgent.setBreakpointsActive(this._breakpointsEnabledSetting.value),e.DebuggerAgent.setPauseOnExceptions(this._breakOnExceptionsState),e.DebuggerAgent.setPauseOnAssertions&&e.DebuggerAgent.setPauseOnAssertions(this._assertionFailuresBreakpointEnabledSetting.value),e.DebuggerAgent.setAsyncStackTraceDepth&&e.DebuggerAgent.setAsyncStackTraceDepth(this._asyncStackTraceDepthSetting.value),e.DebuggerAgent.setPauseForInternalScripts&&e.DebuggerAgent.setPauseForInternalScripts(WI.settings.pauseForInternalScripts.value),this.paused&&t.pauseIfNeeded(),this._restoringBreakpoints=!0;for(let i of this._breakpoints)i.disabled||!i.contentIdentifier||this._setBreakpoint(i,e);this._restoringBreakpoints=!1}get paused(){for(let[e,t]of this._targetDebuggerDataMap)if(t.paused)return!0;return!1}get activeCallFrame(){return this._activeCallFrame}set activeCallFrame(e){e!==this._activeCallFrame&&(this._activeCallFrame=e||null,this.dispatchEventToListeners(WI.DebuggerManager.Event.ActiveCallFrameDidChange))}dataForTarget(e){let t=this._targetDebuggerDataMap.get(e);return t||(t=new WI.DebuggerData(e),this._targetDebuggerDataMap.set(e,t),t)}get allExceptionsBreakpoint(){return this._allExceptionsBreakpoint}get uncaughtExceptionsBreakpoint(){return this._uncaughtExceptionsBreakpoint}get assertionFailuresBreakpoint(){return this._assertionFailuresBreakpoint}get breakpoints(){return this._breakpoints}breakpointForIdentifier(e){return this._breakpointIdMap.get(e)||null}breakpointsForSourceCode(e){if(console.assert(e instanceof WI.Resource||e instanceof WI.Script),e instanceof WI.SourceMapResource)return Array.from(this.breakpointsForSourceCode(e.sourceMap.originalSourceCode)).filter(i=>i.sourceCodeLocation.displaySourceCode===e);let t=this._breakpointContentIdentifierMap.get(e.contentIdentifier);if(t)return this._associateBreakpointsWithSourceCode(t,e),t;if(e instanceof WI.Script){let i=this._breakpointScriptIdentifierMap.get(e.id);if(i)return this._associateBreakpointsWithSourceCode(i,e),i}return[]}breakpointForSourceCodeLocation(e){console.assert(e instanceof WI.SourceCodeLocation);for(let t of this.breakpointsForSourceCode(e.sourceCode))if(t.sourceCodeLocation.isEqual(e))return t;return null}isBreakpointRemovable(e){return e!==this._allExceptionsBreakpoint&&e!==this._uncaughtExceptionsBreakpoint}isBreakpointSpecial(e){return!this.isBreakpointRemovable(e)||e===this._assertionFailuresBreakpoint}isBreakpointEditable(e){return!this.isBreakpointSpecial(e)}get breakpointsEnabled(){return this._breakpointsEnabledSetting.value}set breakpointsEnabled(e){if(this._breakpointsEnabledSetting.value!==e&&(console.assert(!(e&&this.breakpointsDisabledTemporarily),"Should not enable breakpoints when we are temporarily disabling breakpoints."),!(e&&this.breakpointsDisabledTemporarily))){this._breakpointsEnabledSetting.value=e,this._updateBreakOnExceptionsState();for(let t of WI.targets)t.DebuggerAgent.setBreakpointsActive(e),t.DebuggerAgent.setPauseOnExceptions(this._breakOnExceptionsState);this.dispatchEventToListeners(WI.DebuggerManager.Event.BreakpointsEnabledDidChange)}}get breakpointsDisabledTemporarily(){return this._temporarilyDisabledBreakpointsRestoreSetting.value!==null}scriptForIdentifier(e,t){return console.assert(t instanceof WI.Target),this.dataForTarget(t).scriptForIdentifier(e)}scriptsForURL(e,t){return console.assert(t instanceof WI.Target),this.dataForTarget(t).scriptsForURL(e)}get searchableScripts(){return this.knownNonResourceScripts.filter(e=>!!e.contentIdentifier)}get knownNonResourceScripts(){let e=[];for(let[t,i]of this._targetDebuggerDataMap)for(let n of i.scripts)n.resource||isWebInspectorConsoleEvaluationScript(n.sourceURL)||!WI.isDebugUIEnabled()&&isWebKitInternalScript(n.sourceURL)||e.push(n);return e}get asyncStackTraceDepth(){return this._asyncStackTraceDepthSetting.value}set asyncStackTraceDepth(e){if(this._asyncStackTraceDepthSetting.value!==e){this._asyncStackTraceDepthSetting.value=e;for(let t of WI.targets)t.DebuggerAgent.setAsyncStackTraceDepth(this._asyncStackTraceDepthSetting.value)}}get probeSets(){return[...this._probeSetsByBreakpoint.values()]}probeForIdentifier(e){return this._probesByIdentifier.get(e)}pause(){if(this.paused)return Promise.resolve();this.dispatchEventToListeners(WI.DebuggerManager.Event.WaitingToPause);let e=new WI.EventListener(this,!0),t=new Promise(function(n,s){e.connect(WI.debuggerManager,WI.DebuggerManager.Event.Paused,n)}),i=[];for(let[n,s]of this._targetDebuggerDataMap)i.push(s.pauseIfNeeded());return Promise.all([t,...i])}resume(){if(!this.paused)return Promise.resolve();let e=new WI.EventListener(this,!0),t=new Promise(function(n,s){e.connect(WI.debuggerManager,WI.DebuggerManager.Event.Resumed,n)}),i=[];for(let[n,s]of this._targetDebuggerDataMap)i.push(s.resumeIfNeeded());return Promise.all([t,...i])}stepOver(){if(!this.paused)return Promise.reject(new Error("Cannot step over because debugger is not paused."));let e=new WI.EventListener(this,!0),t=new Promise(function(n,s){e.connect(WI.debuggerManager,WI.DebuggerManager.Event.ActiveCallFrameDidChange,n)}),i=this._activeCallFrame.target.DebuggerAgent.stepOver().catch(function(n){throw e.disconnect(),console.error("DebuggerManager.stepOver failed: ",n),n});return Promise.all([t,i])}stepInto(){if(!this.paused)return Promise.reject(new Error("Cannot step into because debugger is not paused."));let e=new WI.EventListener(this,!0),t=new Promise(function(n,s){e.connect(WI.debuggerManager,WI.DebuggerManager.Event.ActiveCallFrameDidChange,n)}),i=this._activeCallFrame.target.DebuggerAgent.stepInto().catch(function(n){throw e.disconnect(),console.error("DebuggerManager.stepInto failed: ",n),n});return Promise.all([t,i])}stepOut(){if(!this.paused)return Promise.reject(new Error("Cannot step out because debugger is not paused."));let e=new WI.EventListener(this,!0),t=new Promise(function(n,s){e.connect(WI.debuggerManager,WI.DebuggerManager.Event.ActiveCallFrameDidChange,n)}),i=this._activeCallFrame.target.DebuggerAgent.stepOut().catch(function(n){throw e.disconnect(),console.error("DebuggerManager.stepOut failed: ",n),n});return Promise.all([t,i])}continueUntilNextRunLoop(e){return this.dataForTarget(e).continueUntilNextRunLoop()}continueToLocation(e,t,i){return e.target.DebuggerAgent.continueToLocation({scriptId:e.id,lineNumber:t,columnNumber:i})}addBreakpoint(e){if(console.assert(e instanceof WI.Breakpoint),!!e){if(this.isBreakpointSpecial(e)){this.dispatchEventToListeners(WI.DebuggerManager.Event.BreakpointAdded,{breakpoint:e});return}e.contentIdentifier&&this._breakpointContentIdentifierMap.add(e.contentIdentifier,e),e.scriptIdentifier&&this._breakpointScriptIdentifierMap.add(e.scriptIdentifier,e),this._breakpoints.push(e),e.disabled||this._setBreakpoint(e,void 0),this._restoringBreakpoints||WI.objectStores.breakpoints.putObject(e),this._addProbesForBreakpoint(e),this.dispatchEventToListeners(WI.DebuggerManager.Event.BreakpointAdded,{breakpoint:e})}}removeBreakpoint(e){if(console.assert(e instanceof WI.Breakpoint),!!e&&(console.assert(this.isBreakpointRemovable(e)),!!this.isBreakpointRemovable(e))){if(this.isBreakpointSpecial(e)){e.disabled=!0,this.dispatchEventToListeners(WI.DebuggerManager.Event.BreakpointRemoved,{breakpoint:e});return}this._breakpoints.remove(e),e.identifier&&this._removeBreakpoint(e),e.contentIdentifier&&this._breakpointContentIdentifierMap.delete(e.contentIdentifier,e),e.scriptIdentifier&&this._breakpointScriptIdentifierMap.delete(e.scriptIdentifier,e),e.disabled=!0,e.clearActions(),this._restoringBreakpoints||WI.objectStores.breakpoints.deleteObject(e),this._removeProbesForBreakpoint(e),this.dispatchEventToListeners(WI.DebuggerManager.Event.BreakpointRemoved,{breakpoint:e})}}nextBreakpointActionIdentifier(){return this._nextBreakpointActionIdentifier++}breakpointResolved(e,t,i){let n=this._breakpointIdMap.get(t);if(console.assert(n),!!n){if(console.assert(n.identifier===t),!n.sourceCodeLocation.sourceCode){let s=this._sourceCodeLocationFromPayload(e,i);n.sourceCodeLocation.sourceCode=s.sourceCode}n.resolved=!0}}reset(){let e=this.paused;WI.Script.resetUniqueDisplayNameNumbers(),this._internalWebKitScripts=[],this._targetDebuggerDataMap.clear(),this._ignoreBreakpointDisplayLocationDidChangeEvent=!0;for(let t of this._breakpoints)t.resolved=!1,t.sourceCodeLocation.sourceCode&&(t.sourceCodeLocation.sourceCode=null);this._ignoreBreakpointDisplayLocationDidChangeEvent=!1,this.dispatchEventToListeners(WI.DebuggerManager.Event.ScriptsCleared),e&&this.dispatchEventToListeners(WI.DebuggerManager.Event.Resumed)}debuggerDidPause(e,t,i,n,s){this._delayedResumeTimeout&&(clearTimeout(this._delayedResumeTimeout),this._delayedResumeTimeout=void 0);let a=this.paused,d=this._targetDebuggerDataMap.get(e),p=[],f=this._pauseReasonFromPayload(i),_=n||null;for(var b=0;b<t.length;++b){var w=t[b],S=this._sourceCodeLocationFromPayload(e,w.location);if(!S||!S.sourceCode||!WI.isDebugUIEnabled()&&isWebKitInternalScript(S.sourceCode.sourceURL))continue;let M=this._scopeChainFromPayload(e,w.scopeChain),L=WI.CallFrame.fromDebuggerPayload(e,w,M,S);p.push(L)}let E=p[0];if(!E){a?e.DebuggerAgent.continueUntilNextRunLoop():e.DebuggerAgent.resume(),this._didResumeInternal(e);return}let k=WI.StackTrace.fromPayload(e,s);d.updateForPause(p,f,_,k);for(let[M,L]of this._targetDebuggerDataMap)L.pauseIfNeeded();let R=this._activeCallFrame&&this._activeCallFrame.target===e;R?this._activeCallFrame=E:a||(this._activeCallFrame=E,R=!0),a||this.dispatchEventToListeners(WI.DebuggerManager.Event.Paused),this.dispatchEventToListeners(WI.DebuggerManager.Event.CallFramesDidChange,{target:e}),R&&this.dispatchEventToListeners(WI.DebuggerManager.Event.ActiveCallFrameDidChange)}debuggerDidResume(e){if(!e.DebuggerAgent.setPauseOnAssertions){this._delayedResumeTimeout=setTimeout(this._didResumeInternal.bind(this,e),50);return}this._didResumeInternal(e)}playBreakpointActionSound(e){InspectorFrontendHost.beep()}scriptDidParse(e,t,i,n,s,a,d,p,f,_,b){let w=this.dataForTarget(e),S=w.scriptForIdentifier(t);if(S){console.assert(S.url===(i||null)),console.assert(S.range.startLine===n),console.assert(S.range.startColumn===s),console.assert(S.range.endLine===a),console.assert(S.range.endColumn===d);return}if(!WI.isDebugUIEnabled()&&isWebKitInternalScript(_))return;let E=new WI.TextRange(n,s,a,d),k=p?WI.Script.SourceType.Module:WI.Script.SourceType.Program,R=new WI.Script(e,t,E,i,k,f,_,b);w.addScript(R),WI.sharedApp.debuggableType===WI.DebuggableType.ServiceWorker?e.mainResource instanceof WI.LocalScript&&R.url===e.name&&(e.mainResource=R):!e.mainResource&&e!==WI.mainTarget&&R.url===e.name&&(e.mainResource=R,R.resource&&e.resourceCollection.remove(R.resource)),!(isWebKitInternalScript(R.sourceURL)&&(this._internalWebKitScripts.push(R),!WI.isDebugUIEnabled()))&&(isWebInspectorConsoleEvaluationScript(R.sourceURL)||(this.dispatchEventToListeners(WI.DebuggerManager.Event.ScriptAdded,{script:R}),(e!==WI.mainTarget||WI.sharedApp.debuggableType===WI.DebuggableType.ServiceWorker)&&!R.isMainResource()&&!R.resource&&e.addScript(R)))}scriptDidFail(e,t,i){const n=WI.Script.SourceType.Program;let s=new WI.LocalScript(e,t,n,i);if(s.resource)return;this.dataForTarget(e).addScript(s),e.addScript(s),this.dispatchEventToListeners(WI.DebuggerManager.Event.ScriptAdded,{script:s})}didSampleProbe(e,t){console.assert(this._probesByIdentifier.has(t.probeId),"Unknown probe identifier specified for sample: ",t);let i=this._probesByIdentifier.get(t.probeId),n=WI.timelineManager.computeElapsedTime(t.timestamp),s=WI.RemoteObject.fromPayload(t.payload,e);i.addSample(new WI.ProbeSample(t.sampleId,t.batchId,n,s))}_sourceCodeLocationFromPayload(e,t){let n=this.dataForTarget(e).scriptForIdentifier(t.scriptId);return n?n.createSourceCodeLocation(t.lineNumber,t.columnNumber):null}_scopeChainFromPayload(e,t){let i=[];for(let n=0;n<t.length;++n)i.push(this._scopeChainNodeFromPayload(e,t[n]));return i}_scopeChainNodeFromPayload(e,t){var i=null;switch(t.type){case DebuggerAgent.ScopeType.Global:i=WI.ScopeChainNode.Type.Global;break;case DebuggerAgent.ScopeType.With:i=WI.ScopeChainNode.Type.With;break;case DebuggerAgent.ScopeType.Closure:i=WI.ScopeChainNode.Type.Closure;break;case DebuggerAgent.ScopeType.Catch:i=WI.ScopeChainNode.Type.Catch;break;case DebuggerAgent.ScopeType.FunctionName:i=WI.ScopeChainNode.Type.FunctionName;break;case DebuggerAgent.ScopeType.NestedLexical:i=WI.ScopeChainNode.Type.Block;break;case DebuggerAgent.ScopeType.GlobalLexicalEnvironment:i=WI.ScopeChainNode.Type.GlobalLexicalEnvironment;break;case DebuggerAgent.ScopeType.Local:i=WI.ScopeChainNode.Type.Closure;break;default:console.error("Unknown type: "+t.type)}let n=WI.RemoteObject.fromPayload(t.object,e);return new WI.ScopeChainNode(i,[n],t.name,t.location,t.empty)}_pauseReasonFromPayload(e){switch(e){case DebuggerAgent.PausedReason.AnimationFrame:return WI.DebuggerManager.PauseReason.AnimationFrame;case DebuggerAgent.PausedReason.Assert:return WI.DebuggerManager.PauseReason.Assertion;case DebuggerAgent.PausedReason.Breakpoint:return WI.DebuggerManager.PauseReason.Breakpoint;case DebuggerAgent.PausedReason.CSPViolation:return WI.DebuggerManager.PauseReason.CSPViolation;case DebuggerAgent.PausedReason.DOM:return WI.DebuggerManager.PauseReason.DOM;case DebuggerAgent.PausedReason.DebuggerStatement:return WI.DebuggerManager.PauseReason.DebuggerStatement;case DebuggerAgent.PausedReason.EventListener:return WI.DebuggerManager.PauseReason.EventListener;case DebuggerAgent.PausedReason.Exception:return WI.DebuggerManager.PauseReason.Exception;case DebuggerAgent.PausedReason.Fetch:return WI.DebuggerManager.PauseReason.Fetch;case DebuggerAgent.PausedReason.PauseOnNextStatement:return WI.DebuggerManager.PauseReason.PauseOnNextStatement;case DebuggerAgent.PausedReason.Timer:return WI.DebuggerManager.PauseReason.Timer;case DebuggerAgent.PausedReason.XHR:return WI.DebuggerManager.PauseReason.XHR;default:return WI.DebuggerManager.PauseReason.Other}}_debuggerBreakpointActionType(e){switch(e){case WI.BreakpointAction.Type.Log:return DebuggerAgent.BreakpointActionType.Log;case WI.BreakpointAction.Type.Evaluate:return DebuggerAgent.BreakpointActionType.Evaluate;case WI.BreakpointAction.Type.Sound:return DebuggerAgent.BreakpointActionType.Sound;case WI.BreakpointAction.Type.Probe:return DebuggerAgent.BreakpointActionType.Probe;default:return console.assert(!1),DebuggerAgent.BreakpointActionType.Log}}_debuggerBreakpointOptions(e){let t=e.actions;return t=t.map(i=>i.toProtocol()),t=t.filter(i=>{if(i.type!==WI.BreakpointAction.Type.Log||!/\$\{.*?\}/.test(i.data))return!0;let s=new WI.BreakpointLogMessageLexer().tokenize(i.data);if(!s)return!1;let a=s.reduce((d,p)=>p.type===WI.BreakpointLogMessageLexer.TokenType.PlainText?d+p.data.escapeCharacters("`\\"):p.type===WI.BreakpointLogMessageLexer.TokenType.Expression?d+"${"+p.data+"}":d,"");return i.data="console.log(`"+a+"`)",i.type=WI.BreakpointAction.Type.Evaluate,!0}),{condition:e.condition,ignoreCount:e.ignoreCount,autoContinue:e.autoContinue,actions:t}}_setBreakpoint(e,t){if(console.assert(!e.disabled),e.disabled)return;!this._restoringBreakpoints&&!this.breakpointsDisabledTemporarily&&(this.breakpointsEnabled=!0);function i(s,a,d,p){if(a){WI.reportInternalError(a);return}this._breakpointIdMap.set(d,e),e.identifier=d,p instanceof Array||(p=[p]);for(let f of p)this.breakpointResolved(s,d,f)}t||(e.resolved=!1);let n=this._debuggerBreakpointOptions(e);for(let s of n.actions)s.type=this._debuggerBreakpointActionType(s.type);if(e.contentIdentifier){let s=t?[t]:WI.targets;for(let a of s)a.DebuggerAgent.setBreakpointByUrl.invoke({lineNumber:e.sourceCodeLocation.lineNumber,url:e.contentIdentifier,urlRegex:void 0,columnNumber:e.sourceCodeLocation.columnNumber,options:n},i.bind(this,a),a.DebuggerAgent)}else if(e.scriptIdentifier){let s=e.target;s.DebuggerAgent.setBreakpoint.invoke({location:{scriptId:e.scriptIdentifier,lineNumber:e.sourceCodeLocation.lineNumber,columnNumber:e.sourceCodeLocation.columnNumber},options:n},i.bind(this,s),s.DebuggerAgent)}else WI.reportInternalError("Unknown source for breakpoint.")}_removeBreakpoint(e,t){if(!e.identifier)return;function i(n){n&&console.error(n),this._breakpointIdMap.delete(e.identifier),e.identifier=null,typeof t=="function"&&t()}if(e.contentIdentifier)for(let n of WI.targets)n.DebuggerAgent.removeBreakpoint(e.identifier,i.bind(this));else e.scriptIdentifier&&e.target.DebuggerAgent.removeBreakpoint(e.identifier,i.bind(this))}_breakpointDisplayLocationDidChange(e){if(this._ignoreBreakpointDisplayLocationDidChangeEvent)return;let t=e.target;!t.identifier||t.disabled||this._removeBreakpoint(t,()=>{this._restoringBreakpoints=!0,this._setBreakpoint(t),this._restoringBreakpoints=!1,this.dispatchEventToListeners(WI.DebuggerManager.Event.BreakpointMoved,{breakpoint:t})})}_breakpointDisabledStateDidChange(e){let t=e.target;if(t===this._allExceptionsBreakpoint){!t.disabled&&!this.breakpointsDisabledTemporarily&&(this.breakpointsEnabled=!0),this._allExceptionsBreakpointEnabledSetting.value=!t.disabled,this._updateBreakOnExceptionsState();for(let i of WI.targets)i.DebuggerAgent.setPauseOnExceptions(this._breakOnExceptionsState);return}if(t===this._uncaughtExceptionsBreakpoint){!t.disabled&&!this.breakpointsDisabledTemporarily&&(this.breakpointsEnabled=!0),this._uncaughtExceptionsBreakpointEnabledSetting.value=!t.disabled,this._updateBreakOnExceptionsState();for(let i of WI.targets)i.DebuggerAgent.setPauseOnExceptions(this._breakOnExceptionsState);return}if(t===this._assertionFailuresBreakpoint){!t.disabled&&!this.breakpointsDisabledTemporarily&&(this.breakpointsEnabled=!0),this._assertionFailuresBreakpointEnabledSetting.value=!t.disabled;for(let i of WI.targets)i.DebuggerAgent.setPauseOnAssertions(this._assertionFailuresBreakpointEnabledSetting.value);return}this._restoringBreakpoints||WI.objectStores.breakpoints.putObject(t),t.disabled?this._removeBreakpoint(t):this._setBreakpoint(t)}_breakpointEditablePropertyDidChange(e){let t=e.target;this._restoringBreakpoints||WI.objectStores.breakpoints.putObject(t),!t.disabled&&(console.assert(this.isBreakpointEditable(t)),this.isBreakpointEditable(t)&&this._removeBreakpoint(t,()=>{this._restoringBreakpoints=!0,this._setBreakpoint(t),this._restoringBreakpoints=!1}))}_handleBreakpointActionsDidChange(e){this._breakpointEditablePropertyDidChange(e),this._updateProbesForBreakpoint(e.target)}_startDisablingBreakpointsTemporarily(){++this._temporarilyDisableBreakpointsRequestCount>1||(console.assert(!this.breakpointsDisabledTemporarily,"Already temporarily disabling breakpoints."),!this.breakpointsDisabledTemporarily&&(this._temporarilyDisabledBreakpointsRestoreSetting.value=this._breakpointsEnabledSetting.value,this.breakpointsEnabled=!1))}_stopDisablingBreakpointsTemporarily(){if(this._temporarilyDisableBreakpointsRequestCount=Math.max(0,this._temporarilyDisableBreakpointsRequestCount-1),this._temporarilyDisableBreakpointsRequestCount>0||(console.assert(this.breakpointsDisabledTemporarily,"Was not temporarily disabling breakpoints."),!this.breakpointsDisabledTemporarily))return;let e=this._temporarilyDisabledBreakpointsRestoreSetting.value;this._temporarilyDisabledBreakpointsRestoreSetting.value=null,this.breakpointsEnabled=e}_handleTimelineCapturingStateChanged(e){switch(WI.timelineManager.capturingState){case WI.TimelineManager.CapturingState.Starting:this._startDisablingBreakpointsTemporarily(),this.paused&&this.resume();break;case WI.TimelineManager.CapturingState.Inactive:this._stopDisablingBreakpointsTemporarily();break}}_handleAuditManagerTestScheduled(e){this._startDisablingBreakpointsTemporarily(),this.paused&&this.resume()}_handleAuditManagerTestCompleted(e){this._stopDisablingBreakpointsTemporarily()}_targetRemoved(e){let t=this.paused;this._targetDebuggerDataMap.delete(e.data.target),!this.paused&&t&&this.dispatchEventToListeners(WI.DebuggerManager.Event.Resumed)}_pauseForInternalScriptsDidChange(e){for(let t of WI.targets)t.DebuggerAgent.setPauseForInternalScripts&&t.DebuggerAgent.setPauseForInternalScripts(WI.settings.pauseForInternalScripts.value)}_mainResourceDidChange(e){!e.target.isMainFrame()||this._didResumeInternal(WI.mainTarget)}_didResumeInternal(e){if(!this.paused)return;this._delayedResumeTimeout&&(clearTimeout(this._delayedResumeTimeout),this._delayedResumeTimeout=void 0);let t=!1;this._activeCallFrame&&this._activeCallFrame.target===e&&(this._activeCallFrame=null,t=!0),this.dataForTarget(e).updateForResume(),this.paused||this.dispatchEventToListeners(WI.DebuggerManager.Event.Resumed),this.dispatchEventToListeners(WI.DebuggerManager.Event.CallFramesDidChange,{target:e}),t&&this.dispatchEventToListeners(WI.DebuggerManager.Event.ActiveCallFrameDidChange)}_updateBreakOnExceptionsState(){let e="none";switch(this._breakpointsEnabledSetting.value&&(this._allExceptionsBreakpoint.disabled?this._uncaughtExceptionsBreakpoint.disabled||(e="uncaught"):e="all"),this._breakOnExceptionsState=e,e){case"all":this._uncaughtExceptionsBreakpoint.resolved=!1;break;case"uncaught":case"none":this._uncaughtExceptionsBreakpoint.resolved=!0;break}}_associateBreakpointsWithSourceCode(e,t){this._ignoreBreakpointDisplayLocationDidChangeEvent=!0;for(let i of e)i.sourceCodeLocation.sourceCode||(i.sourceCodeLocation.sourceCode=t),console.assert(i.sourceCodeLocation.sourceCode===t||i.sourceCodeLocation.sourceCode.contentIdentifier===t.contentIdentifier);this._ignoreBreakpointDisplayLocationDidChangeEvent=!1}_addProbesForBreakpoint(e){this._knownProbeIdentifiersForBreakpoint.has(e)||(this._knownProbeIdentifiersForBreakpoint.set(e,new Set),this._updateProbesForBreakpoint(e))}_removeProbesForBreakpoint(e){console.assert(this._knownProbeIdentifiersForBreakpoint.has(e)),this._updateProbesForBreakpoint(e),this._knownProbeIdentifiersForBreakpoint.delete(e)}_updateProbesForBreakpoint(e){let t=this._knownProbeIdentifiersForBreakpoint.get(e);if(!t){this._addProbesForBreakpoint(e);return}let i=new Set;for(let n of e.probeActions){let s=n.id;if(console.assert(s,"Probe added without breakpoint action identifier: ",e),i.add(s),!t.has(s)){t.add(s);let d=this._probeSetForBreakpoint(e),p=new WI.Probe(s,e,n.data);this._probesByIdentifier.set(s,p),d.addProbe(p);break}let a=this._probesByIdentifier.get(s);console.assert(a,"Probe known but couldn't be found by identifier: ",s),a.expression=n.data}for(let n of t){if(i.has(n))break;let s=this._probeSetForBreakpoint(e),a=this._probesByIdentifier.get(n);this._probesByIdentifier.delete(n),t.delete(n),s.removeProbe(a),s.probes.length||(this._probeSetsByBreakpoint.delete(s.breakpoint),s.willRemove(),this.dispatchEventToListeners(WI.DebuggerManager.Event.ProbeSetRemoved,{probeSet:s}))}}_probeSetForBreakpoint(e){let t=this._probeSetsByBreakpoint.get(e);return t||(t=new WI.ProbeSet(e),this._probeSetsByBreakpoint.set(e,t),this.dispatchEventToListeners(WI.DebuggerManager.Event.ProbeSetAdded,{probeSet:t})),t}_debugUIEnabledDidChange(){let e=WI.isDebugUIEnabled()?WI.DebuggerManager.Event.ScriptAdded:WI.DebuggerManager.Event.ScriptRemoved;for(let t of this._internalWebKitScripts)this.dispatchEventToListeners(e,{script:t})}};WI.DebuggerManager.Event={BreakpointAdded:"debugger-manager-breakpoint-added",BreakpointRemoved:"debugger-manager-breakpoint-removed",BreakpointMoved:"debugger-manager-breakpoint-moved",WaitingToPause:"debugger-manager-waiting-to-pause",Paused:"debugger-manager-paused",Resumed:"debugger-manager-resumed",CallFramesDidChange:"debugger-manager-call-frames-did-change",ActiveCallFrameDidChange:"debugger-manager-active-call-frame-did-change",ScriptAdded:"debugger-manager-script-added",ScriptRemoved:"debugger-manager-script-removed",ScriptsCleared:"debugger-manager-scripts-cleared",BreakpointsEnabledDidChange:"debugger-manager-breakpoints-enabled-did-change",ProbeSetAdded:"debugger-manager-probe-set-added",ProbeSetRemoved:"debugger-manager-probe-set-removed"};WI.DebuggerManager.PauseReason={AnimationFrame:"animation-frame",Assertion:"assertion",Breakpoint:"breakpoint",CSPViolation:"CSP-violation",DebuggerStatement:"debugger-statement",DOM:"DOM",EventListener:"event-listener",Exception:"exception",Fetch:"fetch",PauseOnNextStatement:"pause-on-next-statement",Timer:"timer",XHR:"xhr",Other:"other"};WI.DragToAdjustController=class{constructor(e){this._delegate=e,this._element=null,this._active=!1,this._enabled=!1,this._dragging=!1,this._tracksMouseClickAndDrag=!1}get element(){return this._element}set element(e){this._element=e}get enabled(){return this._enabled}set enabled(e){this._enabled!==e&&(e?(this._element.addEventListener("mouseenter",this),this._element.addEventListener("mouseleave",this)):(this._element.removeEventListener("mouseenter",this),this._element.removeEventListener("mouseleave",this)))}get active(){return this._active}set active(e){!this._element||this._active!==e&&(e?(WI.notifications.addEventListener(WI.Notification.GlobalModifierKeysDidChange,this._modifiersDidChange,this),this._element.addEventListener("mousemove",this)):(WI.notifications.removeEventListener(WI.Notification.GlobalModifierKeysDidChange,this._modifiersDidChange,this),this._element.removeEventListener("mousemove",this),this._setTracksMouseClickAndDrag(!1)),this._active=e,this._delegate&&typeof this._delegate.dragToAdjustControllerActiveStateChanged=="function"&&this._delegate.dragToAdjustControllerActiveStateChanged(this))}reset(){this._setTracksMouseClickAndDrag(!1),this._element.classList.remove(WI.DragToAdjustController.StyleClassName),this._delegate&&typeof this._delegate.dragToAdjustControllerDidReset=="function"&&this._delegate.dragToAdjustControllerDidReset(this)}handleEvent(e){switch(e.type){case"mouseenter":this._dragging||(this._delegate&&typeof this._delegate.dragToAdjustControllerCanBeActivated=="function"?this.active=this._delegate.dragToAdjustControllerCanBeActivated(this):this.active=!0);break;case"mouseleave":this._dragging||(this.active=!1);break;case"mousemove":this._dragging?this._mouseWasDragged(e):this._mouseMoved(e);break;case"mousedown":this._mouseWasPressed(e);break;case"mouseup":this._mouseWasReleased(e);break;case"contextmenu":e.preventDefault();break}}_setDragging(e){this._dragging!==e&&(console.assert(window.event),e?WI.elementDragStart(this._element,this,this,window.event,"col-resize",window):WI.elementDragEnd(window.event),this._dragging=e)}_setTracksMouseClickAndDrag(e){this._tracksMouseClickAndDrag!==e&&(e?(this._element.classList.add(WI.DragToAdjustController.StyleClassName),window.addEventListener("mousedown",this,!0),window.addEventListener("contextmenu",this,!0)):(this._element.classList.remove(WI.DragToAdjustController.StyleClassName),window.removeEventListener("mousedown",this,!0),window.removeEventListener("contextmenu",this,!0),this._setDragging(!1)),this._tracksMouseClickAndDrag=e)}_modifiersDidChange(e){var t=WI.modifierKeys.altKey;t&&this._delegate&&typeof this._delegate.dragToAdjustControllerCanBeAdjusted=="function"&&(t=this._delegate.dragToAdjustControllerCanBeAdjusted(this)),this._setTracksMouseClickAndDrag(t)}_mouseMoved(e){var t=e.altKey;t&&this._delegate&&typeof this._delegate.dragToAdjustControllerCanAdjustObjectAtPoint=="function"&&(t=this._delegate.dragToAdjustControllerCanAdjustObjectAtPoint(this,WI.Point.fromEvent(e))),this._setTracksMouseClickAndDrag(t)}_mouseWasPressed(e){this._lastX=e.screenX,this._setDragging(!0),e.preventDefault(),e.stopPropagation()}_mouseWasDragged(e){var t=e.screenX,i=t-this._lastX;Math.abs(i)<1||(this._lastX=t,e.ctrlKey?i/=10:e.shiftKey&&(i*=10),this._delegate&&typeof this._delegate.dragToAdjustControllerWasAdjustedByAmount=="function"&&this._delegate.dragToAdjustControllerWasAdjustedByAmount(this,i),e.preventDefault(),e.stopPropagation())}_mouseWasReleased(e){this._setDragging(!1),e.preventDefault(),e.stopPropagation(),this.reset()}};WI.DragToAdjustController.StyleClassName="drag-to-adjust";WI.Formatter=class{constructor(e,t){console.assert(e),console.assert(t),this._codeMirror=e,this._builder=t,this._lastToken=null,this._lastContent=""}format(e,t){if(console.assert(this._builder.originalContent===null),this._builder.originalContent===null){var i=this._codeMirror.getMode(),n=this._codeMirror.getRange(e,t),s=CodeMirror.copyState(i,this._codeMirror.getTokenAt(e).state);this._builder.setOriginalContent(n);for(var a=0,d=n.split(`
`),p=0;p<d.length;++p){for(var f=d[p],_=!0,b=!0,w=new CodeMirror.StringStream(f);!w.eol();){var S=CodeMirror.innerMode(i,s),E=i.token(w,s),k=E===null&&/^\s*$/.test(w.current());this._handleToken(S.mode,E,s,w,a+w.start,k,_,b),w.start=w.pos,_=!1,b&&!k&&(b=!1)}b&&this._handleEmptyLine(),a+=f.length+1,this._handleLineEnding(a-1)}this._builder.finish()}}_handleToken(e,t,i,n,s,a,d,p){var f=n.current();if(d&&this._builder.appendNewline(),a){this._builder.appendSpace();return}var _=t&&/\bcomment\b/.test(t);e.modifyStateForTokenPre&&e.modifyStateForTokenPre(this._lastToken,this._lastContent,t,i,f,_),this._builder.lastTokenWasWhitespace&&e.removeLastWhitespace(this._lastToken,this._lastContent,t,i,f,_)&&this._builder.removeLastWhitespace(),this._builder.lastTokenWasNewline&&e.removeLastNewline(this._lastToken,this._lastContent,t,i,f,_,p)&&this._builder.removeLastNewline(),!this._builder.lastTokenWasWhitespace&&e.shouldHaveSpaceAfterLastToken(this._lastToken,this._lastContent,t,i,f,_)&&this._builder.appendSpace(),!this._builder.lastTokenWasWhitespace&&e.shouldHaveSpaceBeforeToken(this._lastToken,this._lastContent,t,i,f,_)&&this._builder.appendSpace();for(var b=e.dedentsBeforeToken(this._lastToken,this._lastContent,t,i,f,_);b-- >0;)this._builder.dedent();e.newlineBeforeToken(this._lastToken,this._lastContent,t,i,f,_)&&this._builder.appendNewline(),e.indentBeforeToken(this._lastToken,this._lastContent,t,i,f,_)&&this._builder.indent(),this._builder.appendToken(f,s),e.modifyStateForTokenPost&&e.modifyStateForTokenPost(this._lastToken,this._lastContent,t,i,f,_),!_&&e.indentAfterToken(this._lastToken,this._lastContent,t,i,f,_)&&this._builder.indent();var w=e.newlinesAfterToken(this._lastToken,this._lastContent,t,i,f,_);w&&this._builder.appendMultipleNewlines(w),this._lastToken=t,this._lastContent=f}_handleEmptyLine(){this._builder.lastTokenWasNewline&&this._builder.lastNewlineAppendWasMultiple||this._builder.appendNewline(!0)}_handleLineEnding(e){this._builder.addOriginalLineEnding(e)}};WI.FormatterSourceMap=class extends WI.Object{constructor(e,t,i){super(),this._originalLineEndings=e,this._formattedLineEndings=t,this._mapping=i}static fromSourceMapData({originalLineEndings:e,formattedLineEndings:t,mapping:i}){return new WI.FormatterSourceMap(e,t,i)}originalToFormatted(e,t){var i=this._locationToPosition(this._originalLineEndings,e||0,t||0);return this.originalPositionToFormatted(i)}originalPositionToFormatted(e){var t=this._convertPosition(this._mapping.original,this._mapping.formatted,e);return this._positionToLocation(this._formattedLineEndings,t)}formattedToOriginal(e,t){var i=this.formattedToOriginalOffset(e,t);return this._positionToLocation(this._originalLineEndings,i)}formattedToOriginalOffset(e,t){var i=this._locationToPosition(this._formattedLineEndings,e||0,t||0),n=this._convertPosition(this._mapping.formatted,this._mapping.original,i);return n}_locationToPosition(e,t,i){var n=t?e[t-1]+1:0;return n+i}_positionToLocation(e,t){var i=e.upperBound(t-1);if(i)var n=t-e[i-1]-1;else var n=t;return{lineNumber:i,columnNumber:n}}_convertPosition(e,t,i){var n=e.upperBound(i)-1,s=t[n]+i-e[n];return n<t.length-1&&s>t[n+1]&&(s=t[n+1]),s}};WI.HARBuilder=class cn{static async buildArchive(e){let t=[];for(let n of e)console.assert(n.finished),t.push(new Promise((s,a)=>{n.requestContent().then(d=>s(d),()=>s(null))}));let i=await Promise.all(t);return console.assert(i.length===e.length),{log:{version:"1.2",creator:cn.creator(),pages:cn.pages(),entries:e.map((n,s)=>cn.entry(n,i[s]))}}}static creator(){return{name:"WebKit Web Inspector",version:WI.Platform.version.build||"1.0"}}static pages(){return[{startedDateTime:cn.date(WI.networkManager.mainFrame.mainResource.requestSentDate),id:"page_0",title:WI.networkManager.mainFrame.url||"",pageTimings:cn.pageTimings()}]}static pageTimings(){let e={},t=WI.networkManager.mainFrame.domContentReadyEventTimestamp;isNaN(t)||(e.onContentLoad=t*1e3);let i=WI.networkManager.mainFrame.loadEventTimestamp;return isNaN(i)||(e.onLoad=i*1e3),e}static entry(e,t){let i={pageref:"page_0",startedDateTime:cn.date(e.requestSentDate),time:0,request:cn.request(e),response:cn.response(e,t),cache:cn.cache(e),timings:cn.timings(e)};return e.timingData.startTime&&e.timingData.responseEnd&&(i.time=(e.timingData.responseEnd-e.timingData.startTime)*1e3),e.remoteAddress&&(i.serverIPAddress=cn.ipAddress(e.remoteAddress),i.serverIPAddress&&(i._serverPort=cn.port(e.remoteAddress))),e.connectionIdentifier&&(i.connection=""+e.connectionIdentifier),e.responseSource!==WI.Resource.ResponseSource.Unknown&&(i._fetchType=cn.fetchType(e.responseSource)),e.priority!==WI.Resource.NetworkPriority.Unknown&&(i._priority=cn.priority(e.priority)),i}static request(e){let t={method:e.requestMethod||"",url:e.url||"",httpVersion:WI.Resource.displayNameForProtocol(e.protocol)||"",cookies:cn.cookies(e.requestCookies,null),headers:cn.headers(e.requestHeaders),queryString:e.queryStringParameters||[],headersSize:isNaN(e.requestHeadersTransferSize)?-1:e.requestHeadersTransferSize,bodySize:isNaN(e.requestBodyTransferSize)?-1:e.requestBodyTransferSize};return e.requestData&&(t.postData=cn.postData(e)),t}static response(e,t){let i={status:e.statusCode||0,statusText:e.statusText||"",httpVersion:WI.Resource.displayNameForProtocol(e.protocol)||"",cookies:cn.cookies(e.responseCookies,e.requestSentDate),headers:cn.headers(e.responseHeaders),content:cn.content(e,t),redirectURL:e.responseHeaders.valueForCaseInsensitiveKey("Location")||"",headersSize:isNaN(e.responseHeadersTransferSize)?-1:e.responseHeadersTransferSize,bodySize:isNaN(e.responseBodyTransferSize)?-1:e.responseBodyTransferSize};return isNaN(e.networkTotalTransferSize)||(i._transferSize=e.networkTotalTransferSize),e.failureReasonText&&(i._error=e.failureReasonText),i}static cookies(e,t){let i=[];for(let n of e){let s={name:n.name,value:n.value};n.type===WI.Cookie.Type.Response&&(n.path&&(s.path=n.path),n.domain&&(s.domain=n.domain),s.expires=cn.date(n.expirationDate(t)),s.httpOnly=n.httpOnly,s.secure=n.secure,n.sameSite!==WI.Cookie.SameSiteType.None&&(s.sameSite=n.sameSite)),i.push(s)}return i}static headers(e){let t=[];for(let i in e)t.push({name:i,value:e[i]});return t}static content(e,t){let i=isNaN(e.networkEncodedSize)?e.estimatedNetworkEncodedSize:e.networkEncodedSize,n=isNaN(e.networkDecodedSize)?e.size:e.networkDecodedSize;isNaN(n)&&(n=0),isNaN(i)&&(i=0);let s={size:n,compression:n-i,mimeType:e.mimeType||"x-unknown"};return t&&(t.rawContent&&(s.text=t.rawContent),t.rawBase64Encoded&&(s.encoding="base64")),s}static postData(e){return{mimeType:e.requestDataContentType||"",text:e.requestData,params:e.requestFormParameters||[]}}static cache(e){return{}}static timings(e){let t={blocked:-1,dns:-1,connect:-1,ssl:-1,send:0,wait:0,receive:0};if(e.timingData.startTime&&e.timingData.responseEnd){let{startTime:i,domainLookupStart:n,domainLookupEnd:s,connectStart:a,connectEnd:d,secureConnectionStart:p,requestStart:f,responseStart:_,responseEnd:b}=e.timingData;t.blocked=((n||a||f)-i)*1e3,n&&(t.dns=((s||a||f)-n)*1e3),a&&(t.connect=((d||f)-a)*1e3),p&&(t.ssl=((d||f)-p)*1e3),t.send=s||d?(f-(d||s))*1e3:0,t.wait=(_-f)*1e3,t.receive=(b-_)*1e3}return t}static ipAddress(e){return e?e.replace(/:\d+$/,""):""}static port(e){if(!e)return;let t=e.lastIndexOf(":");if(!t)return;let i=e.substr(t+1),n=parseInt(i);if(!isNaN(n))return n}static date(e){return e?e.toISOString():""}static fetchType(e){switch(e){case WI.Resource.ResponseSource.Network:return"Network Load";case WI.Resource.ResponseSource.MemoryCache:return"Memory Cache";case WI.Resource.ResponseSource.DiskCache:return"Disk Cache";case WI.Resource.ResponseSource.ServiceWorker:return"Service Worker"}console.assert()}static priority(e){switch(e){case WI.Resource.NetworkPriority.Low:return"low";case WI.Resource.NetworkPriority.Medium:return"medium";case WI.Resource.NetworkPriority.High:return"high"}console.assert()}static dateFromHARDate(e){return Date.parse(e)}static protocolFromHARProtocol(e){switch(e){case"HTTP/2":return"h2";case"HTTP/1.0":return"http/1.0";case"HTTP/1.1":return"http/1.1";case"SPDY/2":return"spdy/2";case"SPDY/3":return"spdy/3";case"SPDY/3.1":return"spdy/3.1"}return e&&console.warn("Unknown HAR protocol value",e),null}static responseSourceFromHARFetchType(e){switch(e){case"Network Load":return WI.Resource.ResponseSource.Network;case"Memory Cache":return WI.Resource.ResponseSource.MemoryCache;case"Disk Cache":return WI.Resource.ResponseSource.DiskCache}return e&&console.warn("Unknown HAR _fetchType value",e),WI.Resource.ResponseSource.Other}static networkPriorityFromHARPriority(e){switch(e){case"low":return WI.Resource.NetworkPriority.Low;case"medium":return WI.Resource.NetworkPriority.Medium;case"high":return WI.Resource.NetworkPriority.High}return e&&console.warn("Unknown HAR priority value",e),WI.Resource.NetworkPriority.Unknown}};WI.HeapManager=class extends WI.Object{initializeTarget(e){e.HeapAgent&&e.HeapAgent.enable()}garbageCollected(e,t){if(e!==WI.mainTarget)return;let i=WI.GarbageCollection.fromPayload(t);this.dispatchEventToListeners(WI.HeapManager.Event.GarbageCollected,{collection:i})}};WI.HeapManager.Event={GarbageCollected:"heap-manager-garbage-collected"};WI.IndexedDBManager=class extends WI.Object{constructor(){super(),WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this),WI.Frame.addEventListener(WI.Frame.Event.SecurityOriginDidChange,this._securityOriginDidChange,this),this.initialize()}initializeTarget(e){e.IndexedDBAgent&&e.IndexedDBAgent.enable()}initialize(){this._indexedDatabases=[]}get indexedDatabases(){return this._indexedDatabases}requestIndexedDatabaseData(e,t,i,n,s){console.assert(window.IndexedDBAgent),console.assert(e),console.assert(s);function a(p,f,_){if(p){s(null,!1);return}var b=[];for(var w of f){var S={};S.primaryKey=WI.RemoteObject.fromPayload(w.primaryKey),S.key=WI.RemoteObject.fromPayload(w.key),S.value=WI.RemoteObject.fromPayload(w.value),b.push(S)}s(b,_)}var d={securityOrigin:e.parentDatabase.securityOrigin,databaseName:e.parentDatabase.name,objectStoreName:e.name,indexName:t&&t.name||"",skipCount:i||0,pageSize:n||100};IndexedDBAgent.requestData.invoke(d,a)}clearObjectStore(e){let t=e.parentDatabase.securityOrigin,i=e.parentDatabase.name,n=e.name;IndexedDBAgent.clearObjectStore(t,i,n)}_mainResourceDidChange(e){console.assert(e.target instanceof WI.Frame),e.target.isMainFrame()&&(this.initialize(),this.dispatchEventToListeners(WI.IndexedDBManager.Event.Cleared),this._addIndexedDBDatabasesIfNeeded(e.target))}_addIndexedDBDatabasesIfNeeded(e){if(!window.IndexedDBAgent)return;var t=e.securityOrigin;if(!t||t==="://")return;function i(p,f){if(!(p||!f))for(var _ of f)IndexedDBAgent.requestDatabase(t,_,n.bind(this))}function n(p,f){if(!(p||!f)){var _=f.objectStores.map(a),b=new WI.IndexedDatabase(f.name,t,f.version,_);this._indexedDatabases.push(b),this.dispatchEventToListeners(WI.IndexedDBManager.Event.IndexedDatabaseWasAdded,{indexedDatabase:b})}}function s(p){switch(p.type){case IndexedDBAgent.KeyPathType.Null:return null;case IndexedDBAgent.KeyPathType.String:return p.string;case IndexedDBAgent.KeyPathType.Array:return p.array;default:return console.error("Unknown KeyPath type:",p.type),null}}function a(p){var f=s(p.keyPath),_=p.indexes.map(d);return new WI.IndexedDatabaseObjectStore(p.name,f,p.autoIncrement,_)}function d(p){var f=s(p.keyPath);return new WI.IndexedDatabaseObjectStoreIndex(p.name,f,p.unique,p.multiEntry)}IndexedDBAgent.requestDatabaseNames(t,i.bind(this))}_securityOriginDidChange(e){console.assert(e.target instanceof WI.Frame),this._addIndexedDBDatabasesIfNeeded(e.target)}};WI.IndexedDBManager.Event={IndexedDatabaseWasAdded:"indexed-db-manager-indexed-database-was-added",Cleared:"indexed-db-manager-cleared"};WI.JavaScriptLogViewController=class extends WI.Object{constructor(e,t,i,n,s){super(),console.assert(i instanceof WI.ConsolePrompt),console.assert(s),this._element=e,this._scrollElement=t,this._promptHistorySetting=new WI.Setting(s,null),this._prompt=i,this._prompt.delegate=this,this._prompt.history=this._promptHistorySetting.value,this.delegate=n,this._cleared=!0,this._previousMessageView=null,this._lastCommitted="",this._repeatCountWasInterrupted=!1,this._sessions=[],this._currentSessionOrGroup=null,this.messagesAlternateClearKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.Control,"L",this.requestClearMessages.bind(this),this._element),this._messagesFindNextKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl,"G",this._handleFindNextShortcut.bind(this),this._element),this._messagesFindPreviousKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl|WI.KeyboardShortcut.Modifier.Shift,"G",this._handleFindPreviousShortcut.bind(this),this._element),this._promptAlternateClearKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.Control,"L",this.requestClearMessages.bind(this),this._prompt.element),this._promptFindNextKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl,"G",this._handleFindNextShortcut.bind(this),this._prompt.element),this._promptFindPreviousKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl|WI.KeyboardShortcut.Modifier.Shift,"G",this._handleFindPreviousShortcut.bind(this),this._prompt.element),this._pendingMessagesForSessionOrGroup=new Map,this._scheduledRenderIdentifier=0,this.startNewSession()}clear(){this._cleared=!0;const e=!0;this.startNewSession(e,{newSessionReason:WI.ConsoleSession.NewSessionReason.ConsoleCleared})}startNewSession(e=!1,t={}){if(e&&(this._pendingMessagesForSessionOrGroup.clear(),this._sessions.length)){for(let s of this._sessions)s.element.remove();this._sessions=[],this._currentSessionOrGroup=null}this._sessions.length||(t.timestamp=Date.now());let i=this._sessions.lastValue;i&&!i.hasMessages()&&!this._pendingMessagesForSessionOrGroup.has(i)&&(this._sessions.pop(),i.element.remove());let n=new WI.ConsoleSession(t);this._previousMessageView=null,this._lastCommitted="",this._repeatCountWasInterrupted=!1,this._sessions.push(n),this._currentSessionOrGroup=n,this._element.appendChild(n.element),n.element.scrollIntoView()}appendImmediateExecutionWithResult(e,t,i,n){console.assert(t instanceof WI.RemoteObject);var s=new WI.ConsoleCommandView(e,i?"special-user-log":null);this._appendConsoleMessageView(s,!0);function a(d){let p=new WI.ConsoleCommandResultMessage(t.target,t,!1,d,n),f=new WI.ConsoleMessageView(p);this._appendConsoleMessageView(f,!0)}WI.runtimeManager.saveResult(t,a.bind(this))}appendConsoleMessage(e){var t=new WI.ConsoleMessageView(e);return this._appendConsoleMessageView(t),t}updatePreviousMessageRepeatCount(e){if(console.assert(this._previousMessageView),!this._previousMessageView)return!1;var t=this._previousMessageView[WI.JavaScriptLogViewController.IgnoredRepeatCount]||0,i=this._previousMessageView.repeatCount;if(!this._repeatCountWasInterrupted)return this._previousMessageView.repeatCount=e-t,!0;var n=this._previousMessageView.message,s=new WI.ConsoleMessageView(n);return s[WI.JavaScriptLogViewController.IgnoredRepeatCount]=t+i,s.repeatCount=1,this._appendConsoleMessageView(s),!0}isScrolledToBottom(){return this._scrollToBottomTimeout||this._scrollElement.isScrolledToBottom()}scrollToBottom(){if(this._scrollToBottomTimeout)return;function e(){this._scrollToBottomTimeout=null,this._scrollElement.scrollTop=this._scrollElement.scrollHeight}this._scrollToBottomTimeout=setTimeout(e.bind(this),0)}requestClearMessages(){WI.consoleManager.requestClearMessages()}consolePromptHistoryDidChange(e){this._promptHistorySetting.value=this._prompt.history}consolePromptShouldCommitText(e,t,i,n){if(!i){n(!0);return}function s(a,d,p,f){n(d!==RuntimeAgent.SyntaxErrorType.Recoverable)}WI.runtimeManager.activeExecutionContext.target.RuntimeAgent.parse(t,s.bind(this))}consolePromptTextCommitted(e,t){if(console.assert(t),this._lastCommitted!==t){let s=new WI.ConsoleCommandView(t);this._appendConsoleMessageView(s,!0),this._lastCommitted=t}function i(s,a,d){if(!s||this._cleared)return;let p=!0,f=new WI.ConsoleCommandResultMessage(s.target,s,a,d,p),_=new WI.ConsoleMessageView(f);this._appendConsoleMessageView(_,!0)}let n={objectGroup:WI.RuntimeManager.ConsoleObjectGroup,includeCommandLineAPI:!0,doNotPauseOnExceptionsAndMuteConsole:!1,returnByValue:!1,generatePreview:!0,saveResult:!0,emulateUserGesture:WI.settings.emulateInUserGesture.value,sourceURLAppender:appendWebInspectorConsoleEvaluationSourceURL};WI.runtimeManager.evaluateInInspectedWindow(t,n,i.bind(this))}_handleFindNextShortcut(){this.delegate.highlightNextSearchMatch()}_handleFindPreviousShortcut(){this.delegate.highlightPreviousSearchMatch()}_appendConsoleMessageView(e,t){let i=this._pendingMessagesForSessionOrGroup.get(this._currentSessionOrGroup);i||(i=[],this._pendingMessagesForSessionOrGroup.set(this._currentSessionOrGroup,i)),i.push(e),this._cleared=!1,this._repeatCountWasInterrupted=t||!1,t||(this._previousMessageView=e),e.message&&e.message.source!==WI.ConsoleMessage.MessageSource.JS&&(this._lastCommitted=""),WI.consoleContentView.visible&&this.renderPendingMessagesSoon(),!WI.isShowingConsoleTab()&&e.message&&e.message.shouldRevealConsole&&WI.showSplitConsole()}renderPendingMessages(){if(this._scheduledRenderIdentifier&&(cancelAnimationFrame(this._scheduledRenderIdentifier),this._scheduledRenderIdentifier=0),!this._pendingMessagesForSessionOrGroup.size)return;let e=this.isScrolledToBottom(),t=this._currentSessionOrGroup,i=null;const n=100;let s=0;for(let[a,d]of this._pendingMessagesForSessionOrGroup){this._currentSessionOrGroup=a;let p=d.splice(0,n-s);for(let f of p)f.render(),this._didRenderConsoleMessageView(f);if(i=p.lastValue,d.length||this._pendingMessagesForSessionOrGroup.delete(a),s+=p.length,s>=n)break}this._currentSessionOrGroup=t,(e||i instanceof WI.ConsoleCommandView||i.message.type===WI.ConsoleMessage.MessageType.Result||i.message.type===WI.ConsoleMessage.MessageType.Image)&&this.scrollToBottom(),WI.quickConsole.needsLayout(),this._pendingMessagesForSessionOrGroup.size&&this.renderPendingMessagesSoon()}renderPendingMessagesSoon(){this._scheduledRenderIdentifier||(this._scheduledRenderIdentifier=requestAnimationFrame(()=>this.renderPendingMessages()))}_didRenderConsoleMessageView(e){var t=e instanceof WI.ConsoleCommandView?null:e.message.type;if(t===WI.ConsoleMessage.MessageType.EndGroup){var i=this._currentSessionOrGroup.parentGroup;i&&(this._currentSessionOrGroup=i)}else if(t===WI.ConsoleMessage.MessageType.StartGroup||t===WI.ConsoleMessage.MessageType.StartGroupCollapsed){var n=new WI.ConsoleGroup(this._currentSessionOrGroup),s=n.render(e);this._currentSessionOrGroup.append(s),this._currentSessionOrGroup=n}else this._currentSessionOrGroup.addMessageView(e);this.delegate&&typeof this.delegate.didAppendConsoleMessageView=="function"&&this.delegate.didAppendConsoleMessageView(e)}};WI.JavaScriptLogViewController.CachedPropertiesDuration=3e4;WI.JavaScriptLogViewController.IgnoredRepeatCount=Symbol("ignored-repeat-count");Object.defineProperty(WI,"javaScriptRuntimeCompletionProvider",{get:function(){return WI.JavaScriptRuntimeCompletionProvider._instance||(WI.JavaScriptRuntimeCompletionProvider._instance=new WI.JavaScriptRuntimeCompletionProvider),WI.JavaScriptRuntimeCompletionProvider._instance}});WI.JavaScriptRuntimeCompletionProvider=class extends WI.Object{constructor(){super(),console.assert(!WI.JavaScriptRuntimeCompletionProvider._instance),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.ActiveCallFrameDidChange,this._clearLastProperties,this)}completionControllerCompletionsNeeded(e,t,i,n,s,a){if(!a&&!n&&!/[.[]$/.test(i)){e.updateCompletions(null);return}/[({]$/.test(i)&&(i="");var d=i.length-1,p=i[d]===".",f=i[d]==="[";if(p||f){if(i=i.substring(0,d),!i&&p){e.updateCompletions(t);return}if(!a&&!n&&p&&i.indexOf(".")===-1&&parseInt(i,10)==i){e.updateCompletions(null);return}!i&&f&&(f=!1)}if(this._lastBase===i&&this._lastPropertyNames){k.call(this,this._lastPropertyNames);return}this._lastBase=i,this._lastPropertyNames=null;var _=WI.debuggerManager.activeCallFrame;if(!i&&_&&!this._alwaysEvaluateInWindowContext)_.collectScopeChainVariableNames(k.bind(this));else{let R={objectGroup:"completion",includeCommandLineAPI:!0,doNotPauseOnExceptionsAndMuteConsole:!0,returnByValue:!1,generatePreview:!1,saveResult:!1};WI.runtimeManager.evaluateInInspectedWindow(i,R,w.bind(this))}function b(R){this._clearLastPropertiesTimeout&&clearTimeout(this._clearLastPropertiesTimeout),this._clearLastPropertiesTimeout=setTimeout(this._clearLastProperties.bind(this),WI.JavaScriptLogViewController.CachedPropertiesDuration),this._lastPropertyNames=R||{}}function w(R,M){if(M||!R||R.type==="undefined"||R.type==="object"&&R.subtype==="null"){WI.runtimeManager.activeExecutionContext.target.RuntimeAgent.releaseObjectGroup("completion"),b.call(this,{}),e.updateCompletions(t);return}function L(H){for(var O=this,z,K={},q=O;q;q=q.__proto__)try{if(q===O&&q.length)z=q.length;else for(var Y=Object.getOwnPropertyNames(q),se=0;se<Y.length;++se)K[Y[se]]=!0}catch{}return z&&(K.length=z),K}function V(H){var O;H==="string"?O=new String(""):H==="number"?O=new Number(0):H==="boolean"?O=new Boolean(!1):H==="symbol"?O=Symbol():O=this;for(var z={},K=O;K;K=K.__proto__)try{for(var q=Object.getOwnPropertyNames(K),Y=0;Y<q.length;++Y)z[q[Y]]=!0}catch{}return z}if(R.subtype==="array")R.callFunctionJSON(L,void 0,E.bind(this));else if(R.type==="object"||R.type==="function")R.callFunctionJSON(V,void 0,k.bind(this));else if(R.type==="string"||R.type==="number"||R.type==="boolean"||R.type==="symbol"){let H={objectGroup:"completion",includeCommandLineAPI:!1,doNotPauseOnExceptionsAndMuteConsole:!0,returnByValue:!0,generatePreview:!1,saveResult:!1};WI.runtimeManager.evaluateInInspectedWindow("("+V+')("'+R.type+'")',H,S.bind(this))}else console.error("Unknown result type: "+R.type)}function S(R,M,L){k.call(this,L&&!M?L.value:null)}function E(R){if(R&&typeof R.length=="number")for(var M=Math.min(R.length,1e3),L=0;L<M;++L)R[L]=!0;k.call(this,R)}function k(R){if(R=R||{},b.call(this,R),WI.runtimeManager.activeExecutionContext.target.RuntimeAgent.releaseObjectGroup("completion"),!i){let q=WI.JavaScriptRuntimeCompletionProvider._commandLineAPI.slice(0);if(WI.debuggerManager.paused){let Y=WI.debuggerManager.dataForTarget(WI.runtimeManager.activeExecutionContext.target);Y.pauseReason===WI.DebuggerManager.PauseReason.EventListener?q.push("$event"):Y.pauseReason===WI.DebuggerManager.PauseReason.Exception&&q.push("$exception")}for(let Y of q)R[Y]=!0;for(var M=1;M<=WI.ConsoleCommandResultMessage.maximumSavedResultIndex;++M)R["$"+M]=!0}R=Object.keys(R);var L="";if(f){var V=n[0]==="'"?"'":'"';s!=="]"&&s!==V&&(L="]")}for(var H=t,O=H.keySet(),M=0;M<R.length;++M){var z=R[M];p&&!/^[a-zA-Z_$][a-zA-Z0-9_$]*$/.test(z)||(f&&parseInt(z)!=z&&(z=V+z.escapeCharacters(V+"\\")+(s!==V?V:"")),!(!z.startsWith(n)||z in O)&&(H.push(z),O[z]=!0))}function K(q,Y){let se=q-Y;if(!isNaN(se))return se;let ce=q.startsWith("__")&&q.endsWith("__"),le=Y.startsWith("__")&&Y.endsWith("__");return ce&&!le?1:!ce&&le?-1:q.extendedLocaleCompare(Y)}H.sort(K),e.updateCompletions(H,L)}}_clearLastProperties(){this._clearLastPropertiesTimeout&&(clearTimeout(this._clearLastPropertiesTimeout),delete this._clearLastPropertiesTimeout),this._lastPropertyNames=null}};WI.JavaScriptRuntimeCompletionProvider._commandLineAPI=["$","$$","$0","$_","$x","clear","copy","dir","dirxml","getEventListeners","inspect","keys","monitorEvents","profile","profileEnd","queryObjects","screenshot","table","unmonitorEvents","values"];WI.LayerTreeManager=class extends WI.Object{initializeTarget(e){e.LayerTreeAgent&&e.LayerTreeAgent.enable()}get supported(){return!!window.LayerTreeAgent}layerTreeMutations(e,t){if(console.assert(this.supported),isEmptyObject(e))return{preserved:[],additions:t,removals:[]};let i=new Set,n=new Set,s=[],a=[];for(let p of e)i.add(p.layerId);for(let p of t)n.add(p.layerId),i.has(p.layerId)?s.push(p):a.push(p);let d=e.filter(p=>!n.has(p.layerId));return{preserved:s,additions:a,removals:d}}layersForNode(e,t){console.assert(this.supported),LayerTreeAgent.layersForNode(e.id,(i,n)=>{t(i?[]:n.map(WI.Layer.fromPayload))})}reasonsForCompositingLayer(e,t){console.assert(this.supported),LayerTreeAgent.reasonsForCompositingLayer(e.layerId,function(i,n){t(i?0:n)})}layerTreeDidChange(){this.dispatchEventToListeners(WI.LayerTreeManager.Event.LayerTreeDidChange)}};WI.LayerTreeManager.Event={LayerTreeDidChange:"layer-tree-did-change"};WI.MemoryManager=class extends WI.Object{initializeTarget(e){e.MemoryAgent&&e.MemoryAgent.enable()}memoryPressure(e,t){let i=WI.MemoryPressureEvent.fromPayload(e,t);this.dispatchEventToListeners(WI.MemoryManager.Event.MemoryPressure,{memoryPressureEvent:i})}};WI.MemoryManager.Event={MemoryPressure:"memory-manager-memory-pressure"};WI.NetworkManager=class extends WI.Object{constructor(){super(),this._frameIdentifierMap=new Map,this._mainFrame=null,this._resourceRequestIdentifierMap=new Map,this._orphanedResources=new Map,this._webSocketIdentifierToURL=new Map,this._waitingForMainFrameResourceTreePayload=!0,this._transitioningPageTarget=!1,this._sourceMapURLMap=new Map,this._downloadingSourceMaps=new Set,this._localResourcesMap=new Map,WI.notifications.addEventListener(WI.Notification.ExtraDomainsActivated,this._extraDomainsActivated,this),WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._handleFrameMainResourceDidChange,this)}static supportsShowCertificate(){return InspectorFrontendHost.supportsShowCertificate&&window.NetworkAgent&&NetworkAgent.getSerializedCertificate}static synthesizeImportError(e){if(e=WI.UIString("HAR Import Error: %s").format(e),window.InspectorTest){console.error(e);return}let t=new WI.ConsoleMessage(WI.mainTarget,WI.ConsoleMessage.MessageSource.Other,WI.ConsoleMessage.MessageLevel.Error,e);t.shouldRevealConsole=!0,WI.consoleLogViewController.appendConsoleMessage(t)}initializeTarget(e){e.PageAgent&&(e.PageAgent.enable(),e.PageAgent.getResourceTree(this._processMainFrameResourceTreePayload.bind(this))),e.ServiceWorkerAgent&&e.ServiceWorkerAgent.getInitializationInfo(this._processServiceWorkerConfiguration.bind(this)),e.NetworkAgent&&(e.NetworkAgent.enable(),e.NetworkAgent.setResourceCachingDisabled&&e.NetworkAgent.setResourceCachingDisabled(WI.settings.resourceCachingDisabled.value)),e.type===WI.Target.Type.Worker&&this.adoptOrphanedResourcesForTarget(e)}transitionPageTarget(){this._transitioningPageTarget=!0,this._waitingForMainFrameResourceTreePayload=!0}get mainFrame(){return this._mainFrame}get frames(){return[...this._frameIdentifierMap.values()]}frameForIdentifier(e){return this._frameIdentifierMap.get(e)||null}resourceForRequestIdentifier(e){return this._resourceRequestIdentifierMap.get(e)||null}downloadSourceMap(e,t,i){if(!WI.settings.sourceMapsEnabled.value)return;if(WI.networkManager.mainFrame&&(t=absoluteURL(t,WI.networkManager.mainFrame.url)),e.startsWith("data:")){this._loadAndParseSourceMap(e,t,i);return}if(e=absoluteURL(e,t),!e||(console.assert(i.url),!i.url)||this._sourceMapURLMap.has(e)||this._downloadingSourceMaps.has(e))return;let n=()=>{this._loadAndParseSourceMap(e,t,i)};if(!WI.networkManager.mainFrame){setTimeout(n,0);return}n()}frameDidNavigate(e){if(!this._waitingForMainFrameResourceTreePayload){var t=!1,i=this.frameForIdentifier(e.id);if(!i){let a={loaderIdentifier:e.loaderId},d={name:e.name,securityOrigin:e.securityOrigin};if(i=this._addNewResourceToFrameOrTarget(e.url,e.id,a,d).parentFrame,t=!0,console.assert(i),!i)return}if(e.loaderId===i.provisionalLoaderIdentifier)i.commitProvisionalLoad(e.securityOrigin);else{let a=null;i.mainResource.url!==e.url||i.loaderIdentifier!==e.loaderId?a=new WI.Resource(e.url,{mimeType:e.mimeType,loaderIdentifier:e.loaderId}):a=i.mainResource,i.initialize(e.name,e.securityOrigin,e.loaderId,a)}var n=this._mainFrame;if(e.parentId){var s=this.frameForIdentifier(e.parentId);console.assert(s),i===this._mainFrame&&(this._mainFrame=null),i.parentFrame!==s&&s.addChildFrame(i)}else i.parentFrame&&i.parentFrame.removeChildFrame(i),this._mainFrame=i;this._mainFrame!==n&&this._mainFrameDidChange(n),t&&i.mainResource.markAsFinished()}}frameDidDetach(e){if(!this._waitingForMainFrameResourceTreePayload){var t=this.frameForIdentifier(e);if(!!t){t.parentFrame&&t.parentFrame.removeChildFrame(t),this._frameIdentifierMap.delete(t.id);var i=this._mainFrame;t===this._mainFrame&&(this._mainFrame=null),t.clearExecutionContexts(),this.dispatchEventToListeners(WI.NetworkManager.Event.FrameWasRemoved,{frame:t}),this._mainFrame!==i&&this._mainFrameDidChange(i)}}}resourceRequestWillBeSent(e,t,i,n,s,a,d,p,f,_){if(this._waitingForMainFrameResourceTreePayload)return;var b=d,w=WI.timelineManager.computeElapsedTime(d);let S=this._resourceRequestIdentifierMap.get(e);if(S){console.assert(S.parentFrame.id===t),console.assert(S.loaderIdentifier===i),console.assert(!_),S.updateForRedirectResponse(n,a,w,p);return}S=this._addNewResourceToFrameOrTarget(n.url,t,{type:s,loaderIdentifier:i,targetId:_,requestIdentifier:e,requestMethod:n.method,requestHeaders:n.headers,requestData:n.postData,requestSentTimestamp:w,requestSentWalltime:p,initiatorCallFrames:this._initiatorCallFramesFromPayload(f),initiatorSourceCodeLocation:this._initiatorSourceCodeLocationFromPayload(f),initiatorNode:this._initiatorNodeFromPayload(f),originalRequestWillBeSentTimestamp:b}),this._resourceRequestIdentifierMap.set(e,S)}webSocketCreated(e,t){this._webSocketIdentifierToURL.set(e,t)}webSocketWillSendHandshakeRequest(e,t,i,n){let s=this._webSocketIdentifierToURL.get(e);if(console.assert(s),!s)return;InspectorBackend.domains.Network.hasEventParameter("webSocketWillSendHandshakeRequest","walltime")||(n=arguments[2],i=NaN);let a=new WI.WebSocketResource(s,{loaderIdentifier:WI.networkManager.mainFrame.id,requestIdentifier:e,requestHeaders:n.headers,timestamp:t,walltime:i,requestSentTimestamp:WI.timelineManager.computeElapsedTime(t)});this.frameForIdentifier(WI.networkManager.mainFrame.id).addResource(a),this._resourceRequestIdentifierMap.set(e,a)}webSocketHandshakeResponseReceived(e,t,i){let n=this._resourceRequestIdentifierMap.get(e);if(console.assert(n),!n)return;n.readyState=WI.WebSocketResource.ReadyState.Open;let s=WI.timelineManager.computeElapsedTime(t),a=i.timing||null;n.updateForResponse(n.url,n.mimeType,n.type,i.headers,i.status,i.statusText,s,a),n.markAsFinished(s)}webSocketFrameReceived(e,t,i){this._webSocketFrameReceivedOrSent(e,t,i)}webSocketFrameSent(e,t,i){this._webSocketFrameReceivedOrSent(e,t,i)}webSocketClosed(e,t){let i=this._resourceRequestIdentifierMap.get(e);if(console.assert(i),!i)return;i.readyState=WI.WebSocketResource.ReadyState.Closed;let n=WI.timelineManager.computeElapsedTime(t);i.markAsFinished(n),this._webSocketIdentifierToURL.delete(e),this._resourceRequestIdentifierMap.delete(e)}_webSocketFrameReceivedOrSent(e,t,i){let n=this._resourceRequestIdentifierMap.get(e);if(console.assert(n),!n)return;let s=!!i.mask,{payloadData:a,payloadLength:d,opcode:p}=i,f=WI.timelineManager.computeElapsedTime(t);n.addFrame(a,d,s,p,t,f)}markResourceRequestAsServedFromMemoryCache(e){if(this._waitingForMainFrameResourceTreePayload)return;let t=this._resourceRequestIdentifierMap.get(e);!t||t.legacyMarkServedFromMemoryCache()}resourceRequestWasServedFromMemoryCache(e,t,i,n,s,a){if(this._waitingForMainFrameResourceTreePayload)return;console.assert(!this._resourceRequestIdentifierMap.has(e));let d=WI.timelineManager.computeElapsedTime(s),p=n.response;const f=NetworkAgent.ResponseSource.MemoryCache;let _=this._addNewResourceToFrameOrTarget(n.url,t,{type:n.type,loaderIdentifier:i,requestIdentifier:e,requestMethod:"GET",requestSentTimestamp:d,initiatorCallFrames:this._initiatorCallFramesFromPayload(a),initiatorSourceCodeLocation:this._initiatorSourceCodeLocationFromPayload(a),initiatorNode:this._initiatorNodeFromPayload(a)});_.updateForResponse(n.url,p.mimeType,n.type,p.headers,p.status,p.statusText,d,p.timing,f,p.security),_.increaseSize(n.bodySize,d),_.increaseTransferSize(n.bodySize),_.setCachedResponseBodySize(n.bodySize),_.markAsFinished(d),console.assert(_.cached,"This resource should be classified as cached since it was served from the MemoryCache",_),n.sourceMapURL&&this.downloadSourceMap(n.sourceMapURL,_.url,_)}resourceRequestDidReceiveResponse(e,t,i,n,s,a){if(this._waitingForMainFrameResourceTreePayload)return;var d=WI.timelineManager.computeElapsedTime(a);let p=this._resourceRequestIdentifierMap.get(e);if(!p){var f=this.frameForIdentifier(t);f&&(p=f.resourceForURL(s.url)),p&&(this._resourceRequestIdentifierMap.set(e,p),p.revertMarkAsFinished())}p||(p=this._addNewResourceToFrameOrTarget(s.url,t,{type:n,loaderIdentifier:i,requestIdentifier:e,requestHeaders:s.requestHeaders,requestSentTimestamp:d}),this._resourceRequestIdentifierMap.set(e,p)),s.fromDiskCache&&p.legacyMarkServedFromDiskCache(),p.updateForResponse(s.url,s.mimeType,n,s.headers,s.status,s.statusText,d,s.timing,s.source,s.security)}resourceRequestDidReceiveData(e,t,i,n){if(this._waitingForMainFrameResourceTreePayload)return;let s=this._resourceRequestIdentifierMap.get(e);var a=WI.timelineManager.computeElapsedTime(n);!s||(s.increaseSize(t,a),i!==-1&&s.increaseTransferSize(i))}resourceRequestDidFinishLoading(e,t,i,n){if(this._waitingForMainFrameResourceTreePayload)return;let s=this._resourceRequestIdentifierMap.get(e);if(console.assert(s),!s)return;n&&s.updateWithMetrics(n);let a=WI.timelineManager.computeElapsedTime(t);s.markAsFinished(a),i&&this.downloadSourceMap(i,s.url,s),this._resourceRequestIdentifierMap.delete(e)}resourceRequestDidFailLoading(e,t,i,n){if(this._waitingForMainFrameResourceTreePayload)return;let s=this._resourceRequestIdentifierMap.get(e);if(console.assert(s),!s)return;let a=WI.timelineManager.computeElapsedTime(i);s.markAsFailed(t,a,n),s.parentFrame&&s===s.parentFrame.provisionalMainResource&&s.parentFrame.clearProvisionalLoad(),this._resourceRequestIdentifierMap.delete(e)}executionContextCreated(e){let t=this.frameForIdentifier(e.frameId);if(console.assert(t),!t)return;let i=e.name||t.mainResource.displayName,n=t.mainResource.target,s=new WI.ExecutionContext(n,e.id,i,e.isPageContext,t);t.addExecutionContext(s)}localResourceForURL(e){return this._localResourcesMap.get(e)}resourceForURL(e){return this._mainFrame?this._mainFrame.mainResource.url===e?this._mainFrame.mainResource:this._mainFrame.resourceForURL(e,!0):null}adoptOrphanedResourcesForTarget(e){let t=this._orphanedResources.take(e.identifier);if(!!t)for(let i of t)e.adoptResource(i)}processHAR({json:e,error:t}){if(t)return WI.NetworkManager.synthesizeImportError(t),null;if(typeof e!="object"||e===null)return WI.NetworkManager.synthesizeImportError(WI.UIString("invalid JSON")),null;if(typeof e.log!="object"||typeof e.log.version!="string")return WI.NetworkManager.synthesizeImportError(WI.UIString("invalid HAR")),null;if(e.log.version!=="1.2")return WI.NetworkManager.synthesizeImportError(WI.UIString("unsupported HAR version")),null;if(!Array.isArray(e.log.entries)||!Array.isArray(e.log.pages)||!e.log.pages[0]||!e.log.pages[0].startedDateTime)return WI.NetworkManager.synthesizeImportError(WI.UIString("invalid HAR")),null;let i=WI.HARBuilder.dateFromHARDate(e.log.pages[0].startedDateTime)/1e3;if(isNaN(i))return WI.NetworkManager.synthesizeImportError(WI.UIString("invalid HAR")),null;let n=[];for(let s of e.log.entries){let a=WI.LocalResource.fromHAREntry(s,i);this._localResourcesMap.set(a.url,a),n.push(a)}return n}_addNewResourceToFrameOrTarget(e,t,i={},n={}){console.assert(!this._waitingForMainFrameResourceTreePayload);let s=null;if(!t&&i.targetId)return console.assert(WI.sharedApp.debuggableType===WI.DebuggableType.ServiceWorker),console.assert(i.targetId===WI.mainTarget.identifier),s=new WI.Resource(e,i),s.target.addResource(s),s;let a=this.frameForIdentifier(t);return a?i.type==="Document"&&a.mainResource.url===e&&a.loaderIdentifier===i.loaderIdentifier?s=a.mainResource:i.type==="Document"&&a.provisionalMainResource&&a.provisionalMainResource.url===e&&a.provisionalLoaderIdentifier===i.loaderIdentifier?s=a.provisionalMainResource:(s=new WI.Resource(e,i),s.target===WI.pageTarget?this._addResourceToFrame(a,s):s.target?s.target.addResource(s):this._addOrphanedResource(s,i.targetId)):(console.assert(WI.sharedApp.debuggableType!==WI.DebuggableType.ServiceWorker),console.assert(!i.targetId),s=new WI.Resource(e,i),a=new WI.Frame(t,n.name,n.securityOrigin,i.loaderIdentifier,s),this._frameIdentifierMap.set(a.id,a),this._mainFrame||(this._mainFrame=a,this._mainFrameDidChange(null)),this._dispatchFrameWasAddedEvent(a)),console.assert(s),s}_addResourceToFrame(e,t){if(console.assert(!this._waitingForMainFrameResourceTreePayload),!this._waitingForMainFrameResourceTreePayload){if(console.assert(e),console.assert(t),t.loaderIdentifier!==e.loaderIdentifier&&!e.provisionalLoaderIdentifier){e.startProvisionalLoad(t);return}console.assert(t.loaderIdentifier===e.loaderIdentifier||t.loaderIdentifier===e.provisionalLoaderIdentifier),e.addResource(t)}}_addResourceToTarget(e,t){console.assert(e!==WI.pageTarget),console.assert(t),e.addResource(t)}_initiatorCallFramesFromPayload(e){if(!e)return null;let t=e.stackTrace;return t?t.map(i=>WI.CallFrame.fromPayload(WI.assumingMainTarget(),i)):null}_initiatorSourceCodeLocationFromPayload(e){if(!e)return null;var t=null,i=NaN,n=0;if(e.stackTrace&&e.stackTrace.length)for(var s=e.stackTrace,a=0;a<s.length;++a){var d=s[a];if(!(!d.url||d.url==="[native code]")){t=d.url,i=d.lineNumber-1,n=d.columnNumber;break}}else e.url&&(t=e.url,i=e.lineNumber-1);if(!t||isNaN(i)||i<0)return null;var p=WI.networkManager.resourceForURL(t);return p||(p=WI.debuggerManager.scriptsForURL(t,WI.mainTarget)[0]),p?p.createSourceCodeLocation(i,n):null}_initiatorNodeFromPayload(e){return WI.domManager.nodeForId(e.nodeId)}_processServiceWorkerConfiguration(e,t){if(console.assert(this._waitingForMainFrameResourceTreePayload),this._waitingForMainFrameResourceTreePayload=!1,e){console.error(JSON.stringify(e));return}console.assert(t.targetId.startsWith("serviceworker:")),WI.mainTarget.identifier=t.targetId,WI.mainTarget.name=t.url;const i=WI.Script.SourceType.Program;let n=new WI.LocalScript(WI.mainTarget,t.url,i,t.content);WI.mainTarget.mainResource=n,InspectorBackend.runAfterPendingDispatches(()=>{WI.mainTarget.mainResource===n&&(WI.debuggerManager.dataForTarget(WI.mainTarget).addScript(n),WI.debuggerManager.dispatchEventToListeners(WI.DebuggerManager.Event.ScriptAdded,{script:n}))})}_processMainFrameResourceTreePayload(e,t){if(console.assert(this._waitingForMainFrameResourceTreePayload),this._waitingForMainFrameResourceTreePayload=!1,e){console.error(JSON.stringify(e));return}console.assert(t),console.assert(t.frame),this._resourceRequestIdentifierMap=new Map,this._frameIdentifierMap=new Map;var i=this._mainFrame;this._mainFrame=this._addFrameTreeFromFrameResourceTreePayload(t,!0),this._mainFrame!==i&&this._mainFrameDidChange(i),this._transitioningPageTarget&&(this._transitioningPageTarget=!1,this._mainFrame._dispatchMainResourceDidChangeEvent(i.mainResource))}_createFrame(e){let t=new WI.Resource(e.url||"about:blank",{mimeType:e.mimeType,loaderIdentifier:e.loaderId});var i=new WI.Frame(e.id,e.name,e.securityOrigin,e.loaderId,t);return this._frameIdentifierMap.set(i.id,i),t.markAsFinished(),i}_createResource(e,t){let i=new WI.Resource(e.url,{mimeType:e.mimeType,type:e.type,loaderIdentifier:t.loaderId,targetId:e.targetId});return e.sourceMapURL&&this.downloadSourceMap(e.sourceMapURL,i.url,i),i}_addFrameTreeFromFrameResourceTreePayload(e,t){var i=this._createFrame(e.frame);t&&i.markAsMainFrame();for(var n=0;e.childFrames&&n<e.childFrames.length;++n)i.addChildFrame(this._addFrameTreeFromFrameResourceTreePayload(e.childFrames[n],!1));for(var n=0;e.resources&&n<e.resources.length;++n){var s=e.resources[n];if(!(s.type==="Document"&&s.url===e.frame.url)){var a=this._createResource(s,e);a.target===WI.pageTarget?i.addResource(a):a.target?a.target.addResource(a):this._addOrphanedResource(a,s.targetId),s.failed||s.canceled?a.markAsFailed(s.canceled):a.markAsFinished()}}return this._dispatchFrameWasAddedEvent(i),i}_addOrphanedResource(e,t){let i=this._orphanedResources.get(t);i||(i=[],this._orphanedResources.set(t,i)),i.push(e)}_dispatchFrameWasAddedEvent(e){this.dispatchEventToListeners(WI.NetworkManager.Event.FrameWasAdded,{frame:e})}_mainFrameDidChange(e){e&&e.unmarkAsMainFrame(),this._mainFrame&&this._mainFrame.markAsMainFrame(),this.dispatchEventToListeners(WI.NetworkManager.Event.MainFrameDidChange,{oldMainFrame:e})}_loadAndParseSourceMap(e,t,i){this._downloadingSourceMaps.add(e);let n=(a,d,p,f)=>{if(a||f>=400){this._sourceMapLoadAndParseFailed(e);return}if(d.slice(0,3)===")]}"){let _=d.indexOf(`
`);if(_===-1){this._sourceMapLoadAndParseFailed(e);return}d=d.substring(_)}try{let _=JSON.parse(d),b=e.startsWith("data:")?i.url:e,w=new WI.SourceMap(b,_,i);this._sourceMapLoadAndParseSucceeded(e,w)}catch{this._sourceMapLoadAndParseFailed(e)}};if(e.startsWith("data:")){let{mimeType:a,base64:d,data:p}=parseDataURL(e),f=d?atob(p):p;n(null,f,a,0);return}if(!window.NetworkAgent){this._sourceMapLoadAndParseFailed(e);return}let s=null;i instanceof WI.Resource&&i.parentFrame&&(s=i.parentFrame.id),s||(s=WI.networkManager.mainFrame?WI.networkManager.mainFrame.id:""),NetworkAgent.loadResource(s,e,n)}_sourceMapLoadAndParseFailed(e){this._downloadingSourceMaps.delete(e)}_sourceMapLoadAndParseSucceeded(e,t){if(!!this._downloadingSourceMaps.has(e)){this._downloadingSourceMaps.delete(e),this._sourceMapURLMap.set(e,t);for(let i of t.sources())t.addResource(new WI.SourceMapResource(i,t));if(t.originalSourceCode.addSourceMap(t),!(t.originalSourceCode instanceof WI.Resource)){console.assert(t.originalSourceCode instanceof WI.Script);let i=t.originalSourceCode.resource;i&&i.addSourceMap(t)}}}_extraDomainsActivated(e){e.data.domains.includes("Page")&&window.PageAgent&&PageAgent.getResourceTree(this._processMainFrameResourceTreePayload.bind(this))}_handleFrameMainResourceDidChange(e){!e.target.isMainFrame()||(this._sourceMapURLMap.clear(),this._downloadingSourceMaps.clear())}};WI.NetworkManager.Event={FrameWasAdded:"network-manager-frame-was-added",FrameWasRemoved:"network-manager-frame-was-removed",MainFrameDidChange:"network-manager-main-frame-did-change"};WI.ResourceQueryController=class extends WI.Object{constructor(){super(),this._resourceDataMap=new Map}addResource(e){this._resourceDataMap.set(e,{})}removeResource(e){this._resourceDataMap.delete(e)}reset(){this._resourceDataMap.clear()}executeQuery(e){if(!e||!this._resourceDataMap.size)return[];e=e.removeWhitespace().toLowerCase();let t=null;if(e.includes(":")){let[n,s,a]=e.split(":");e=n,s=s?parseInt(s,10)-1:0,a=a?parseInt(a,10)-1:0,t={lineNumber:s,columnNumber:a}}let i=[];for(let[n,s]of this._resourceDataMap){if(!s.searchString){let d=n.displayName;s.searchString=d.toLowerCase(),s.specialCharacterIndices=this._findSpecialCharacterIndices(d)}let a=this._findQueryMatches(e,s.searchString,s.specialCharacterIndices);a.length&&i.push(new WI.ResourceQueryResult(n,a,t))}return i.sort((n,s)=>n.rank===s.rank?n.resource.displayName.extendedLocaleCompare(s.resource.displayName):s.rank-n.rank)}_findQueryMatches(e,t,i){if(e.length>t.length)return[];let n=[],s=0,a=0,d=0,p=new Array(e.length).fill(1/0),f=WI.ResourceQueryMatch.Type.Special;function _(S){n.push(new WI.ResourceQueryMatch(f,S,s)),a=S+1,s++}function b(){if(d>=i.length)return!1;let S=d;for(;d<i.length;){let E=i[d++];if(!(E<a)&&e[s]===t[E])return _(E),!0}return d=S,!1}function w(){for(;n.length;){s--;let S=n.pop();if(S.type===WI.ResourceQueryMatch.Type.Special)return p[S.queryIndex]=S.index,a=n.lastValue?n.lastValue.index+1:0,!0}return!1}for(;s<e.length&&a<=t.length;)if(f===WI.ResourceQueryMatch.Type.Special&&!b()&&(f=WI.ResourceQueryMatch.Type.Normal),f===WI.ResourceQueryMatch.Type.Normal){let S=t.indexOf(e[s],a);if(S>=0&&S<p[s])_(S),f=WI.ResourceQueryMatch.Type.Special;else if(!w())return[]}return s<e.length?[]:n}_findSpecialCharacterIndices(e){if(!e.length)return[];const t="_.-";let i=[0];for(let n=1;n<e.length;++n){let s=e[n],a=!1;if(t.includes(s))a=!0;else{let d=e[n-1];(t.includes(d)||s.isUpperCase()&&d.isLowerCase())&&(a=!0)}a&&i.push(n)}return i}};WI.RuntimeManager=class extends WI.Object{constructor(){super(),this._activeExecutionContext=null,WI.Frame.addEventListener(WI.Frame.Event.ExecutionContextsCleared,this._frameExecutionContextsCleared,this)}static supportsAwaitPromise(){return!!InspectorBackend.domains.Runtime.awaitPromise}initializeTarget(e){e.RuntimeAgent.enable(),e.RuntimeAgent.enableTypeProfiler&&WI.settings.showJavaScriptTypeInformation.value&&e.RuntimeAgent.enableTypeProfiler(),e.RuntimeAgent.enableControlFlowProfiler&&WI.settings.enableControlFlowProfiler.value&&e.RuntimeAgent.enableControlFlowProfiler()}get activeExecutionContext(){return this._activeExecutionContext}set activeExecutionContext(e){this._activeExecutionContext!==e&&(this._activeExecutionContext=e,this.dispatchEventToListeners(WI.RuntimeManager.Event.ActiveExecutionContextChanged))}evaluateInInspectedWindow(e,t,i){if(!this._activeExecutionContext){i(null,!1);return}let{objectGroup:n,includeCommandLineAPI:s,doNotPauseOnExceptionsAndMuteConsole:a,returnByValue:d,generatePreview:p,saveResult:f,emulateUserGesture:_,sourceURLAppender:b}=t;s=s||!1,a=a||!1,d=d||!1,p=p||!1,f=f||!1,_=_||!1,b=b||appendWebInspectorSourceURL,console.assert(n,"RuntimeManager.evaluateInInspectedWindow should always be called with an objectGroup"),console.assert(typeof b=="function"),e?/^\s*\{/.test(e)&&/\}\s*$/.test(e)?e="("+e+")":/\bawait\b/.test(e)&&(e=this._tryApplyAwaitConvenience(e)):e="this",e=b(e);let w=this._activeExecutionContext.target,S=this._activeExecutionContext.id;WI.debuggerManager.activeCallFrame&&(w=WI.debuggerManager.activeCallFrame.target,S=w.executionContext.id);function E(k,R,M,L){if(this.dispatchEventToListeners(WI.RuntimeManager.Event.DidEvaluate,{objectGroup:n}),k){console.error(k),i(null,!1);return}d?i(null,M,M?null:R,L):i(WI.RemoteObject.fromPayload(R,w),M,L)}if(WI.debuggerManager.activeCallFrame){w.DebuggerAgent.evaluateOnCallFrame.invoke({callFrameId:WI.debuggerManager.activeCallFrame.id,expression:e,objectGroup:n,includeCommandLineAPI:s,doNotPauseOnExceptionsAndMuteConsole:a,returnByValue:d,generatePreview:p,saveResult:f},E.bind(this),w.DebuggerAgent);return}w.RuntimeAgent.evaluate.invoke({expression:e,objectGroup:n,includeCommandLineAPI:s,doNotPauseOnExceptionsAndMuteConsole:a,contextId:S,returnByValue:d,generatePreview:p,saveResult:f,emulateUserGesture:_},E.bind(this),w.RuntimeAgent)}saveResult(e,t){console.assert(e instanceof WI.RemoteObject);let i=this._activeExecutionContext.target,n=this._activeExecutionContext.id;if(!i.RuntimeAgent.saveResult){t(void 0);return}function s(a,d){t(d)}e.objectId?i.RuntimeAgent.saveResult(e.asCallArgument(),s):i.RuntimeAgent.saveResult(e.asCallArgument(),n,s)}getPropertiesForRemoteObject(e,t){this._activeExecutionContext.target.RuntimeAgent.getProperties(e,function(i,n){if(i){t(i);return}let s=new Map;for(let a of n)s.set(a.name,a);t(null,s)})}_frameExecutionContextsCleared(e){(e.data.contexts||[]).some(n=>n.id===this._activeExecutionContext.id)&&(this.activeExecutionContext=WI.mainTarget.executionContext)}_tryApplyAwaitConvenience(e){let t;try{return esprima.parse(e),e}catch{}try{t=esprima.parse("(async function(){"+e+"})")}catch{return e}console.assert(t.type==="Program"),console.assert(t.body.length===1),console.assert(t.body[0].type==="ExpressionStatement"),console.assert(t.body[0].expression.type==="FunctionExpression"),console.assert(t.body[0].expression.async),console.assert(t.body[0].expression.body.type==="BlockStatement");let i=t.body[0].expression.body;if(i.body.length!==1)return e;let n,s=!1,a="var",d,p=i.body[0];if(p.type==="ExpressionStatement"&&p.expression.type==="AwaitExpression")s=!0;else if(p.type==="ExpressionStatement"&&p.expression.type==="AssignmentExpression"&&p.expression.right.type==="AwaitExpression"&&p.expression.left.type==="Identifier")n=p.expression.left.name,d=e.substring(e.indexOf("await"));else if(p.type==="VariableDeclaration"&&p.declarations.length===1&&p.declarations[0].init.type==="AwaitExpression"&&p.declarations[0].id.type==="Identifier")n=p.declarations[0].id.name,a=p.kind,d=e.substring(e.indexOf("await"));else return e;return s?`
(async function() {
    try {
        let result = ${e};
        console.info("%o", result);
    } catch (e) {
        console.error(e);
    }
})();
undefined`:`${a} ${n};
(async function() {
    try {
        ${n} = ${d};
        console.info("%o", ${n});
    } catch (e) {
        console.error(e);
    }
})();
undefined;`}};WI.RuntimeManager.ConsoleObjectGroup="console";WI.RuntimeManager.TopLevelExecutionContextIdentifier=void 0;WI.RuntimeManager.Event={DidEvaluate:Symbol("runtime-manager-did-evaluate"),DefaultExecutionContextChanged:Symbol("runtime-manager-default-execution-context-changed"),ActiveExecutionContextChanged:Symbol("runtime-manager-active-execution-context-changed")};WI.TargetManager=class extends WI.Object{constructor(){super(),this._targets=new Map,this._cachedTargetsList=null,this._seenPageTarget=!1,this._transitionTimeoutIdentifier=void 0}get targets(){return this._cachedTargetsList||(this._cachedTargetsList=Array.from(this._targets.values()).filter(e=>!(e instanceof WI.MultiplexingBackendTarget))),this._cachedTargetsList}get allTargets(){return Array.from(this._targets.values())}targetForIdentifier(e){if(!e)return null;for(let t of this._targets.values())if(t.identifier===e)return t;return null}targetCreated(e){this._targets.size===0&&this.createMultiplexingBackendTarget(e);let t=new InspectorBackend.TargetConnection(e.targetId),i=this._createTarget(e,t);this._checkAndHandlePageTargetTransition(i),i.initialize(),this.addTarget(i)}targetDestroyed(e){let t=this._targets.get(e);this._checkAndHandlePageTargetTermination(t),this.removeTarget(t)}dispatchMessageFromTarget(e,t){let i=this._targets.get(e);console.assert(i),i&&i.connection.dispatch(t)}addTarget(e){console.assert(e),console.assert(!this._targets.has(e.identifier)),this._cachedTargetsList=null,this._targets.set(e.identifier,e),this.dispatchEventToListeners(WI.TargetManager.Event.TargetAdded,{target:e})}removeTarget(e){console.assert(e),console.assert(e!==WI.mainTarget),this._cachedTargetsList=null,this._targets.delete(e.identifier),this.dispatchEventToListeners(WI.TargetManager.Event.TargetRemoved,{target:e})}createMultiplexingBackendTarget(e){let t=new WI.MultiplexingBackendTarget;t.initialize(),WI.initializeBackendTarget(t),this._targets.set(t.identifier,t)}createDirectBackendTarget(){let e=new WI.DirectBackendTarget;e.initialize(),WI.initializeBackendTarget(e),WI.sharedApp.debuggableType===WI.DebuggableType.Web&&WI.initializePageTarget(e),this.addTarget(e)}_createTarget(e,t){let{targetId:i,type:n}=e;switch(n){case TargetAgent.TargetInfoType.JavaScript:return new WI.JavaScriptContextTarget(i,WI.UIString("JavaScript Context"),t);case TargetAgent.TargetInfoType.Page:return new WI.PageTarget(i,WI.UIString("Page"),t);case TargetAgent.TargetInfoType.Worker:return new WI.WorkerTarget(i,WI.UIString("Worker"),t);case TargetAgent.TargetInfoType.ServiceWorker:return new WI.WorkerTarget(i,WI.UIString("ServiceWorker"),t)}throw"Unknown Target type: "+n}_checkAndHandlePageTargetTransition(e){if(e.type===WI.Target.Type.Page){if(!WI.pageTarget&&!this._seenPageTarget){this._seenPageTarget=!0,WI.initializePageTarget(e);return}WI.transitionPageTarget(e)}}_checkAndHandlePageTargetTermination(e){if(e.type!==WI.Target.Type.Page)return;console.assert(e===WI.pageTarget),console.assert(this._seenPageTarget),WI.terminatePageTarget(e);const t=2e3;clearTimeout(this._transitionTimeoutIdentifier),this._transitionTimeoutIdentifier=setTimeout(()=>{if(this._transitionTimeoutIdentifier=void 0,!WI.pageTarget){if(WI.isEngineeringBuild)throw new Error("Error: No new pageTarget some time after last page target was terminated. Failed transition?");WI.close()}},t)}};WI.TargetManager.Event={TargetAdded:Symbol("target-manager-target-added"),TargetRemoved:Symbol("target-manager-target-removed")};WI.TimelineManager=class mn extends WI.Object{constructor(){super(),WI.Frame.addEventListener(WI.Frame.Event.ProvisionalLoadStarted,this._provisionalLoadStarted,this),WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,this._mainResourceDidChange,this),this._enabledTimelineTypesSetting=new WI.Setting("enabled-instrument-types",WI.TimelineManager.defaultTimelineTypes()),this._capturingState=mn.CapturingState.Inactive,this._capturingInstrumentCount=0,this._capturingStartTime=NaN,this._capturingEndTime=NaN,this._initiatedByBackendStart=!1,this._initiatedByBackendStop=!1,this._isCapturingPageReload=!1,this._autoCaptureOnPageLoad=!1,this._mainResourceForAutoCapturing=null,this._shouldSetAutoCapturingMainResource=!1,this._transitioningPageTarget=!1,this._webTimelineScriptRecordsExpectingScriptProfilerEvents=null,this._scriptProfilerRecords=null,this._boundStopCapturing=this.stopCapturing.bind(this),this._stopCapturingTimeout=void 0,this._deadTimeTimeout=void 0,this._lastDeadTimeTickle=0,this.reset()}initializeTarget(e){e.TimelineAgent&&(this._updateAutoCaptureInstruments([e]),e.TimelineAgent.setAutoCaptureEnabled&&e.TimelineAgent.setAutoCaptureEnabled(this._autoCaptureOnPageLoad))}transitionPageTarget(){this._transitioningPageTarget=!0}static defaultTimelineTypes(){if(WI.sharedApp.debuggableType===WI.DebuggableType.JavaScript){let t=[WI.TimelineRecord.Type.Script];return WI.HeapAllocationsInstrument.supported()&&t.push(WI.TimelineRecord.Type.HeapAllocations),t}if(WI.sharedApp.debuggableType===WI.DebuggableType.ServiceWorker){let t=[WI.TimelineRecord.Type.Script];return WI.HeapAllocationsInstrument.supported()&&t.push(WI.TimelineRecord.Type.HeapAllocations),t}let e=[WI.TimelineRecord.Type.Network,WI.TimelineRecord.Type.Layout,WI.TimelineRecord.Type.Script];return WI.CPUInstrument.supported()&&e.push(WI.TimelineRecord.Type.CPU),WI.FPSInstrument.supported()&&e.push(WI.TimelineRecord.Type.RenderingFrame),e}static availableTimelineTypes(){let e=WI.TimelineManager.defaultTimelineTypes();if(WI.sharedApp.debuggableType===WI.DebuggableType.JavaScript||WI.sharedApp.debuggableType===WI.DebuggableType.ServiceWorker)return e;if(WI.MemoryInstrument.supported()&&e.push(WI.TimelineRecord.Type.Memory),WI.HeapAllocationsInstrument.supported()&&e.push(WI.TimelineRecord.Type.HeapAllocations),WI.MediaInstrument.supported()){let t=e.indexOf(WI.TimelineRecord.Type.Layout)+1;e.insertAtIndex(WI.TimelineRecord.Type.Media,t||e.length)}return e}static synthesizeImportError(e){if(e=WI.UIString("Timeline Recording Import Error: %s").format(e),window.InspectorTest){console.error(e);return}let t=new WI.ConsoleMessage(WI.mainTarget,WI.ConsoleMessage.MessageSource.Other,WI.ConsoleMessage.MessageLevel.Error,e);t.shouldRevealConsole=!0,WI.consoleLogViewController.appendConsoleMessage(t)}get capturingState(){return this._capturingState}reset(){this.isCapturing()&&this.stopCapturing(),this._recordings=[],this._activeRecording=null,this._nextRecordingIdentifier=1,this._loadNewRecording()}get activeRecording(){return console.assert(this._activeRecording||!this.isCapturing()),this._activeRecording}get recordings(){return this._recordings.slice()}get autoCaptureOnPageLoad(){return this._autoCaptureOnPageLoad}set autoCaptureOnPageLoad(e){if(e=!!e,this._autoCaptureOnPageLoad!==e){this._autoCaptureOnPageLoad=e;for(let t of WI.targets)t.TimelineAgent&&t.TimelineAgent.setAutoCaptureEnabled(this._autoCaptureOnPageLoad)}}get enabledTimelineTypes(){let e=WI.TimelineManager.availableTimelineTypes();return this._enabledTimelineTypesSetting.value.filter(t=>e.includes(t))}set enabledTimelineTypes(e){this._enabledTimelineTypesSetting.value=e||[],this._updateAutoCaptureInstruments(WI.targets)}isCapturing(){return this._capturingState!==mn.CapturingState.Inactive}isCapturingPageReload(){return this._isCapturingPageReload}willAutoStop(){return!!this._stopCapturingTimeout}relaxAutoStop(){this._stopCapturingTimeout&&(clearTimeout(this._stopCapturingTimeout),this._stopCapturingTimeout=void 0),this._deadTimeTimeout&&(clearTimeout(this._deadTimeTimeout),this._deadTimeTimeout=void 0)}startCapturing(e){console.assert(this._capturingState===mn.CapturingState.Stopping||this._capturingState===mn.CapturingState.Inactive,"TimelineManager is already capturing."),!(this._capturingState!==mn.CapturingState.Stopping&&this._capturingState!==mn.CapturingState.Inactive)&&((!this._activeRecording||e)&&this._loadNewRecording(),this._updateCapturingState(mn.CapturingState.Starting),this._capturingStartTime=NaN,this._activeRecording.start(this._initiatedByBackendStart))}stopCapturing(){console.assert(this._capturingState===mn.CapturingState.Starting||this._capturingState===mn.CapturingState.Active,"TimelineManager is not capturing."),!(this._capturingState!==mn.CapturingState.Starting&&this._capturingState!==mn.CapturingState.Active)&&(this._updateCapturingState(mn.CapturingState.Stopping),this._capturingEndTime=NaN,this._activeRecording.stop(this._initiatedByBackendStop))}async processJSON({filename:e,json:t,error:i}){if(i){WI.TimelineManager.synthesizeImportError(i);return}if(typeof t!="object"||t===null){WI.TimelineManager.synthesizeImportError(WI.UIString("invalid JSON"));return}if(!t.recording||typeof t.recording!="object"||!t.overview||typeof t.overview!="object"||typeof t.version!="number"){WI.TimelineManager.synthesizeImportError(WI.UIString("invalid JSON"));return}if(t.version!==WI.TimelineRecording.SerializationVersion){WI.NetworkManager.synthesizeImportError(WI.UIString("unsupported version"));return}let n=t.recording,s=t.overview,a=this._nextRecordingIdentifier++,d=WI.TimelineRecording.import(a,n,e);this._recordings.push(d),this.dispatchEventToListeners(WI.TimelineManager.Event.RecordingCreated,{recording:d}),this.isCapturing()&&this.stopCapturing();let p=this._activeRecording;p&&p.unloaded(!0),this._activeRecording=d,this.dispatchEventToListeners(WI.TimelineManager.Event.RecordingLoaded,{oldRecording:p}),this.dispatchEventToListeners(WI.TimelineManager.Event.RecordingImported,{overviewData:s})}computeElapsedTime(e){return this._activeRecording?this._activeRecording.computeElapsedTime(e):0}scriptProfilerIsTracking(){return this._scriptProfilerRecords!==null}capturingStarted(e){this._capturingState===mn.CapturingState.Inactive&&(this._initiatedByBackendStart=!0,this._activeRecording.addScriptInstrumentForProgrammaticCapture(),this.startCapturing()),isNaN(e)||((isNaN(this._capturingStartTime)||e<this._capturingStartTime)&&(this._capturingStartTime=e),this._activeRecording.initializeTimeBoundsIfNecessary(e)),this._capturingInstrumentCount++,console.assert(this._capturingInstrumentCount),!(this._capturingInstrumentCount>1)&&this._capturingState!==mn.CapturingState.Active&&(this._lastDeadTimeTickle=0,this._webTimelineScriptRecordsExpectingScriptProfilerEvents=[],this._activeRecording.capturingStarted(this._capturingStartTime),WI.settings.timelinesAutoStop.addEventListener(WI.Setting.Event.Changed,this._handleTimelinesAutoStopSettingChanged,this),WI.Frame.addEventListener(WI.Frame.Event.ResourceWasAdded,this._resourceWasAdded,this),WI.Target.addEventListener(WI.Target.Event.ResourceAdded,this._resourceWasAdded,this),WI.heapManager.addEventListener(WI.HeapManager.Event.GarbageCollected,this._garbageCollected,this),WI.memoryManager.addEventListener(WI.MemoryManager.Event.MemoryPressure,this._memoryPressure,this),WI.DOMNode.addEventListener(WI.DOMNode.Event.DidFireEvent,this._handleDOMNodeDidFireEvent,this),WI.DOMNode.addEventListener(WI.DOMNode.Event.PowerEfficientPlaybackStateChanged,this._handleDOMNodePowerEfficientPlaybackStateChanged,this),this._updateCapturingState(mn.CapturingState.Active,{startTime:this._capturingStartTime}))}capturingStopped(e){this._capturingState===mn.CapturingState.Active&&(this._initiatedByBackendStop=!0,this.stopCapturing()),isNaN(e)||(isNaN(this._capturingEndTime)||e>this._capturingEndTime)&&(this._capturingEndTime=e),this._capturingInstrumentCount--,console.assert(this._capturingInstrumentCount>=0),!this._capturingInstrumentCount&&this._capturingState!==mn.CapturingState.Inactive&&(WI.DOMNode.removeEventListener(null,null,this),WI.memoryManager.removeEventListener(null,null,this),WI.heapManager.removeEventListener(null,null,this),WI.Target.removeEventListener(WI.Target.Event.ResourceAdded,this._resourceWasAdded,this),WI.Frame.removeEventListener(WI.Frame.Event.ResourceWasAdded,this._resourceWasAdded,this),WI.settings.timelinesAutoStop.removeEventListener(null,null,this),this._activeRecording.capturingStopped(this._capturingEndTime),this.relaxAutoStop(),this._isCapturingPageReload=!1,this._shouldSetAutoCapturingMainResource=!1,this._mainResourceForAutoCapturing=null,this._initiatedByBackendStart=!1,this._initiatedByBackendStop=!1,this._updateCapturingState(mn.CapturingState.Inactive,{endTime:this._capturingEndTime}))}autoCaptureStarted(){let e=this._capturingState===mn.CapturingState.Starting;this.isCapturing()&&this.stopCapturing(),this._initiatedByBackendStart=!0,e||this.startCapturing(!0),this._shouldSetAutoCapturingMainResource=!0}eventRecorded(e){if(console.assert(this.isCapturing()),!!this.isCapturing()){for(var t=[],i=[{array:[e],parent:null,parentRecord:null,index:0}];i.length;){var n=i.lastValue,s=n.array;if(n.index<s.length){var e=s[n.index],a=this._processEvent(e,n.parent);a&&(a.parent=n.parentRecord,t.push(a),n.parentRecord&&n.parentRecord.children.push(a)),e.children&&e.children.length&&i.push({array:e.children,parent:e,parentRecord:a||n.parentRecord,index:0}),++n.index}else i.pop()}for(var a of t){if(a.type===WI.TimelineRecord.Type.RenderingFrame){if(!a.children.length)continue;a.setupFrameIndex()}this._addRecord(a)}}}pageDOMContentLoadedEventFired(e){console.assert(this._activeRecording),console.assert(isNaN(WI.networkManager.mainFrame.domContentReadyEventTimestamp));let t=this._activeRecording.computeElapsedTime(e);WI.networkManager.mainFrame.markDOMContentReadyEvent(t);let i=new WI.TimelineMarker(t,WI.TimelineMarker.Type.DOMContentEvent);this._activeRecording.addEventMarker(i)}pageLoadEventFired(e){console.assert(this._activeRecording),console.assert(isNaN(WI.networkManager.mainFrame.loadEventTimestamp));let t=this._activeRecording.computeElapsedTime(e);WI.networkManager.mainFrame.markLoadEvent(t);let i=new WI.TimelineMarker(t,WI.TimelineMarker.Type.LoadEvent);this._activeRecording.addEventMarker(i),this._stopAutoRecordingSoon()}cpuProfilerTrackingStarted(e){this.capturingStarted(e)}cpuProfilerTrackingUpdated(e){console.assert(this.isCapturing()),this.isCapturing()&&this._addRecord(new WI.CPUTimelineRecord(e))}cpuProfilerTrackingCompleted(e){this.capturingStopped(e)}memoryTrackingStarted(e){this.capturingStarted(e)}memoryTrackingUpdated(e){console.assert(this.isCapturing()),this.isCapturing()&&this._addRecord(new WI.MemoryTimelineRecord(e.timestamp,e.categories))}memoryTrackingCompleted(e){this.capturingStopped(e)}heapTrackingStarted(e,t){this.capturingStarted(e),this._addRecord(new WI.HeapAllocationsTimelineRecord(e,t))}heapTrackingCompleted(e,t){this._addRecord(new WI.HeapAllocationsTimelineRecord(e,t)),this.capturingStopped()}heapSnapshotAdded(e,t){this._addRecord(new WI.HeapAllocationsTimelineRecord(e,t))}_updateCapturingState(e,t={}){this._capturingState!==e&&(this._capturingState=e,this.dispatchEventToListeners(mn.Event.CapturingStateChanged,t))}_processRecord(e,t){console.assert(this.isCapturing());var i=this._activeRecording.computeElapsedTime(e.startTime),n=this._activeRecording.computeElapsedTime(e.endTime),s=this._callFramesFromPayload(e.stackTrace),a=null;if(s){for(var d=0;d<s.length;++d)if(!s[d].nativeCode){a=s[d];break}}var p=a&&a.sourceCodeLocation;switch(e.type){case TimelineAgent.EventType.ScheduleStyleRecalculation:return console.assert(isNaN(n)),new WI.LayoutTimelineRecord(WI.LayoutTimelineRecord.EventType.InvalidateStyles,i,i,s,p);case TimelineAgent.EventType.RecalculateStyles:return new WI.LayoutTimelineRecord(WI.LayoutTimelineRecord.EventType.RecalculateStyles,i,n,s,p);case TimelineAgent.EventType.InvalidateLayout:return console.assert(isNaN(n)),new WI.LayoutTimelineRecord(WI.LayoutTimelineRecord.EventType.InvalidateLayout,i,i,s,p);case TimelineAgent.EventType.Layout:var f=p?WI.LayoutTimelineRecord.EventType.ForcedLayout:WI.LayoutTimelineRecord.EventType.Layout,_=new WI.Quad(e.data.root);return new WI.LayoutTimelineRecord(f,i,n,s,p,_);case TimelineAgent.EventType.Paint:var _=new WI.Quad(e.data.clip);return new WI.LayoutTimelineRecord(WI.LayoutTimelineRecord.EventType.Paint,i,n,s,p,_);case TimelineAgent.EventType.Composite:return new WI.LayoutTimelineRecord(WI.LayoutTimelineRecord.EventType.Composite,i,n,s,p);case TimelineAgent.EventType.RenderingFrame:return!e.children||!e.children.length?null:new WI.RenderingFrameTimelineRecord(i,n);case TimelineAgent.EventType.EvaluateScript:if(!p){var b=WI.networkManager.mainFrame,w=b.url===e.data.url?b.mainResource:b.resourceForURL(e.data.url,!0);if(w){let R=e.data.lineNumber-1,M="columnNumber"in e.data?e.data.columnNumber-1:0;p=w.createSourceCodeLocation(R,M)}}var S=e.data.profile,E;switch(t&&t.type){case TimelineAgent.EventType.TimerFire:E=new WI.ScriptTimelineRecord(WI.ScriptTimelineRecord.EventType.TimerFired,i,n,s,p,t.data.timerId,S);break;case TimelineAgent.EventType.ObserverCallback:E=new WI.ScriptTimelineRecord(WI.ScriptTimelineRecord.EventType.ObserverCallback,i,n,s,p,t.data.type,S);break;case TimelineAgent.EventType.FireAnimationFrame:E=new WI.ScriptTimelineRecord(WI.ScriptTimelineRecord.EventType.AnimationFrameFired,i,n,s,p,t.data.id,S);break;default:E=new WI.ScriptTimelineRecord(WI.ScriptTimelineRecord.EventType.ScriptEvaluated,i,n,s,p,null,S);break}return this._webTimelineScriptRecordsExpectingScriptProfilerEvents.push(E),E;case TimelineAgent.EventType.ConsoleProfile:var S=e.data.profile;return console.assert(S||TimelineAgent.setInstruments),new WI.ScriptTimelineRecord(WI.ScriptTimelineRecord.EventType.ConsoleProfileRecorded,i,n,s,p,e.data.title,S);case TimelineAgent.EventType.TimerFire:case TimelineAgent.EventType.EventDispatch:case TimelineAgent.EventType.FireAnimationFrame:case TimelineAgent.EventType.ObserverCallback:break;case TimelineAgent.EventType.FunctionCall:if(!t){console.warn("Unexpectedly received a FunctionCall timeline record without a parent record");break}if(!p){var b=WI.networkManager.mainFrame,w=b.url===e.data.scriptName?b.mainResource:b.resourceForURL(e.data.scriptName,!0);if(w){let L=e.data.scriptLine-1,V="scriptColumn"in e.data?e.data.scriptColumn-1:0;p=w.createSourceCodeLocation(L,V)}}var S=e.data.profile,E;switch(t.type){case TimelineAgent.EventType.TimerFire:E=new WI.ScriptTimelineRecord(WI.ScriptTimelineRecord.EventType.TimerFired,i,n,s,p,t.data.timerId,S);break;case TimelineAgent.EventType.EventDispatch:E=new WI.ScriptTimelineRecord(WI.ScriptTimelineRecord.EventType.EventDispatched,i,n,s,p,t.data.type,S,t.data);break;case TimelineAgent.EventType.ObserverCallback:E=new WI.ScriptTimelineRecord(WI.ScriptTimelineRecord.EventType.ObserverCallback,i,n,s,p,t.data.type,S);break;case TimelineAgent.EventType.FireAnimationFrame:E=new WI.ScriptTimelineRecord(WI.ScriptTimelineRecord.EventType.AnimationFrameFired,i,n,s,p,t.data.id,S);break;case TimelineAgent.EventType.FunctionCall:E=new WI.ScriptTimelineRecord(WI.ScriptTimelineRecord.EventType.ScriptEvaluated,i,n,s,p,t.data.id,S);break;case TimelineAgent.EventType.RenderingFrame:E=new WI.ScriptTimelineRecord(WI.ScriptTimelineRecord.EventType.ScriptEvaluated,i,n,s,p,t.data.id,S);break;default:console.assert(!1,"Missed FunctionCall embedded inside of: "+t.type);break}if(E)return this._webTimelineScriptRecordsExpectingScriptProfilerEvents.push(E),E;break;case TimelineAgent.EventType.ProbeSample:return p=WI.debuggerManager.probeForIdentifier(e.data.probeId).breakpoint.sourceCodeLocation,new WI.ScriptTimelineRecord(WI.ScriptTimelineRecord.EventType.ProbeSampleRecorded,i,i,s,p,e.data.probeId);case TimelineAgent.EventType.TimerInstall:console.assert(isNaN(n));var k={timerId:e.data.timerId,timeout:e.data.timeout,repeating:!e.data.singleShot};return new WI.ScriptTimelineRecord(WI.ScriptTimelineRecord.EventType.TimerInstalled,i,i,s,p,k);case TimelineAgent.EventType.TimerRemove:return console.assert(isNaN(n)),new WI.ScriptTimelineRecord(WI.ScriptTimelineRecord.EventType.TimerRemoved,i,i,s,p,e.data.timerId);case TimelineAgent.EventType.RequestAnimationFrame:return console.assert(isNaN(n)),new WI.ScriptTimelineRecord(WI.ScriptTimelineRecord.EventType.AnimationFrameRequested,i,i,s,p,e.data.id);case TimelineAgent.EventType.CancelAnimationFrame:return console.assert(isNaN(n)),new WI.ScriptTimelineRecord(WI.ScriptTimelineRecord.EventType.AnimationFrameCanceled,i,i,s,p,e.data.id);default:console.error("Missing handling of Timeline Event Type: "+e.type)}return null}_processEvent(e,t){switch(console.assert(this.isCapturing()),e.type){case TimelineAgent.EventType.TimeStamp:var i=this._activeRecording.computeElapsedTime(e.startTime),n=new WI.TimelineMarker(i,WI.TimelineMarker.Type.TimeStamp,e.data.message);this._activeRecording.addEventMarker(n);break;case TimelineAgent.EventType.Time:case TimelineAgent.EventType.TimeEnd:break;default:return this._processRecord(e,t)}return null}_loadNewRecording(){if(this._activeRecording&&this._activeRecording.isEmpty())return;let e=this.enabledTimelineTypes.map(s=>WI.Instrument.createForTimelineType(s)),t=this._nextRecordingIdentifier++,i=new WI.TimelineRecording(t,WI.UIString("Timeline Recording %d").format(t),e);this._recordings.push(i),this.dispatchEventToListeners(WI.TimelineManager.Event.RecordingCreated,{recording:i}),this.isCapturing()&&this.stopCapturing();var n=this._activeRecording;n&&n.unloaded(),this._activeRecording=i,this._mainResourceForAutoCapturing&&WI.TimelineRecording.isLegacy&&(console.assert(this._mainResourceForAutoCapturing.originalRequestWillBeSentTimestamp),this._activeRecording.setLegacyBaseTimestamp(this._mainResourceForAutoCapturing.originalRequestWillBeSentTimestamp),this._mainResourceForAutoCapturing._requestSentTimestamp=0),this.dispatchEventToListeners(WI.TimelineManager.Event.RecordingLoaded,{oldRecording:n})}_callFramesFromPayload(e){return e?e.map(t=>WI.CallFrame.fromPayload(WI.assumingMainTarget(),t)):null}_addRecord(e){this._activeRecording.addRecord(e),WI.networkManager.mainFrame&&isNaN(WI.networkManager.mainFrame.loadEventTimestamp)&&this._resetAutoRecordingDeadTimeTimeout()}_attemptAutoCapturingForFrame(e){if(!this._autoCaptureOnPageLoad||!e.isMainFrame()||!InspectorBackend.domains.Timeline)return!1;if(!InspectorBackend.domains.Timeline.setAutoCaptureEnabled)return this._legacyAttemptStartAutoCapturingForFrame(e);if(!this._shouldSetAutoCapturingMainResource)return!1;console.assert(this.isCapturing(),"We saw autoCaptureStarted so we should already be capturing");let t=e.provisionalMainResource||e.mainResource;if(t===this._mainResourceForAutoCapturing)return!1;let i=e.mainResource||null;return this._isCapturingPageReload=i!==null&&i.url===t.url,this._mainResourceForAutoCapturing=t,this._addRecord(new WI.ResourceTimelineRecord(t)),this._resetAutoRecordingMaxTimeTimeout(),this._shouldSetAutoCapturingMainResource=!1,!0}_legacyAttemptStartAutoCapturingForFrame(e){if(this.isCapturing()&&!this._mainResourceForAutoCapturing)return!1;let t=e.provisionalMainResource||e.mainResource;if(t===this._mainResourceForAutoCapturing)return!1;let i=e.mainResource||null;return this._isCapturingPageReload=i!==null&&i.url===t.url,this.isCapturing()&&this.stopCapturing(),this._mainResourceForAutoCapturing=t,this._loadNewRecording(),this.startCapturing(),this._addRecord(new WI.ResourceTimelineRecord(t)),this._resetAutoRecordingMaxTimeTimeout(),!0}_stopAutoRecordingSoon(){!WI.settings.timelinesAutoStop.value||!this.isCapturing()||!this._mainResourceForAutoCapturing||(this._stopCapturingTimeout&&clearTimeout(this._stopCapturingTimeout),this._stopCapturingTimeout=setTimeout(this._boundStopCapturing,WI.TimelineManager.MaximumAutoRecordDurationAfterLoadEvent))}_resetAutoRecordingMaxTimeTimeout(){!WI.settings.timelinesAutoStop.value||(this._stopCapturingTimeout&&clearTimeout(this._stopCapturingTimeout),this._stopCapturingTimeout=setTimeout(this._boundStopCapturing,WI.TimelineManager.MaximumAutoRecordDuration))}_resetAutoRecordingDeadTimeTimeout(){if(!WI.settings.timelinesAutoStop.value||!this.isCapturing()||!this._mainResourceForAutoCapturing)return;let e=Date.now();e<=this._lastDeadTimeTickle||(this._lastDeadTimeTickle=e+10,this._deadTimeTimeout&&clearTimeout(this._deadTimeTimeout),this._deadTimeTimeout=setTimeout(this._boundStopCapturing,WI.TimelineManager.DeadTimeRequiredToStopAutoRecordingEarly))}_provisionalLoadStarted(e){this._attemptAutoCapturingForFrame(e.target)}_mainResourceDidChange(e){if(!WI.networkManager.mainFrame)return;let t=e.target;if(this._transitioningPageTarget){this._transitioningPageTarget=!1,this._autoCaptureOnPageLoad&&this._legacyAttemptStartAutoCapturingForFrame(t);return}if(this._attemptAutoCapturingForFrame(t)||!this.isCapturing())return;let i=t.mainResource;i!==this._mainResourceForAutoCapturing&&this._addRecord(new WI.ResourceTimelineRecord(i))}_resourceWasAdded(e){!WI.networkManager.mainFrame||this._addRecord(new WI.ResourceTimelineRecord(e.data.resource))}_garbageCollected(e){let{collection:t}=e.data;this._addRecord(new WI.ScriptTimelineRecord(WI.ScriptTimelineRecord.EventType.GarbageCollected,t.startTime,t.endTime,null,null,t))}_memoryPressure(e){this._activeRecording.addMemoryPressureEvent(e.data.memoryPressureEvent)}_handleTimelinesAutoStopSettingChanged(e){WI.settings.timelinesAutoStop.value?(this._mainResourceForAutoCapturing&&!isNaN(this._mainResourceForAutoCapturing.parentFrame.loadEventTimestamp)?this._stopAutoRecordingSoon():this._resetAutoRecordingMaxTimeTimeout(),this._resetAutoRecordingDeadTimeTimeout()):this.relaxAutoStop()}_scriptProfilerTypeToScriptTimelineRecordType(e){switch(e){case ScriptProfilerAgent.EventType.API:return WI.ScriptTimelineRecord.EventType.APIScriptEvaluated;case ScriptProfilerAgent.EventType.Microtask:return WI.ScriptTimelineRecord.EventType.MicrotaskDispatched;case ScriptProfilerAgent.EventType.Other:return WI.ScriptTimelineRecord.EventType.ScriptEvaluated}}scriptProfilerTrackingStarted(e){this._scriptProfilerRecords=[],this.capturingStarted(e)}scriptProfilerTrackingUpdated(e){let{startTime:t,endTime:i,type:n}=e,s=this._scriptProfilerTypeToScriptTimelineRecordType(n),a=new WI.ScriptTimelineRecord(s,t,i,null,null,null,null);a.__scriptProfilerType=n,this._scriptProfilerRecords.push(a),n!==ScriptProfilerAgent.EventType.Other&&this._addRecord(a)}scriptProfilerTrackingCompleted(e,t){if(console.assert(!this._webTimelineScriptRecordsExpectingScriptProfilerEvents||this._scriptProfilerRecords.length>=this._webTimelineScriptRecordsExpectingScriptProfilerEvents.length),t){let{stackTraces:n}=t,s=this._activeRecording.topDownCallingContextTree,a=0,d=n.length,p=new Array(d),f=0;const _=1/1e3;for(let b=0;b<this._scriptProfilerRecords.length;++b){let w=this._scriptProfilerRecords[b];for(;a<d&&n[a].timestamp<w.startTime;)p[f++]=_,a++;let S=0;for(;a<d&&n[a].timestamp<w.endTime;)a++,S++;if(S){let E=(w.endTime-w.startTime)/S;p.fill(E,f,f+S),f+=S}}a<d&&p.fill(_,f),this._activeRecording.initializeCallingContextTrees(n,p);for(let b=0;b<this._scriptProfilerRecords.length;++b){let w=this._scriptProfilerRecords[b];w.profilePayload=s.toCPUProfilePayload(w.startTime,w.endTime)}}WI.sharedApp.debuggableType!==WI.DebuggableType.JavaScript&&(this._scriptProfilerRecords=this._scriptProfilerRecords.filter(n=>n.__scriptProfilerType===ScriptProfilerAgent.EventType.Other),this._mergeScriptProfileRecords()),this._scriptProfilerRecords=null,this._activeRecording.timelineForRecordType(WI.TimelineRecord.Type.Script).refresh(),this.capturingStopped(e)}_mergeScriptProfileRecords(){let e=function(d){return d.shift()||null},t=e.bind(null,this._webTimelineScriptRecordsExpectingScriptProfilerEvents),i=e.bind(null,this._scriptProfilerRecords),n=function(d,p){return d.startTime<=p.startTime&&d.endTime>=p.endTime},s=t(),a=i();for(;s&&a;){if(s.parent instanceof WI.ScriptTimelineRecord){console.assert(n(s.parent,s),"Timeline Record incorrectly wrapping another Timeline Record"),s=t();continue}if(n(s,a)){for(s.profilePayload=a.profilePayload,a=i();a&&n(s,a);)this._addRecord(a),a=i();s=t();continue}if(a.startTime>s.endTime){console.warn("Unexpected case of a Timeline record not containing a ScriptProfiler event and profile data"),s=t();continue}console.warn("Unexpected case of a ScriptProfiler event not being contained by a Timeline record"),this._addRecord(a),a=i()}}_updateAutoCaptureInstruments(e){let t=this.enabledTimelineTypes;for(let i of e){if(!i.TimelineAgent||!i.TimelineAgent.setInstruments)continue;let n=new Set;for(let s of t)switch(s){case WI.TimelineRecord.Type.Script:n.add(i.TimelineAgent.Instrument.ScriptProfiler);break;case WI.TimelineRecord.Type.HeapAllocations:n.add(i.TimelineAgent.Instrument.Heap);break;case WI.TimelineRecord.Type.Network:case WI.TimelineRecord.Type.RenderingFrame:case WI.TimelineRecord.Type.Layout:case WI.TimelineRecord.Type.Media:n.add(i.TimelineAgent.Instrument.Timeline);break;case WI.TimelineRecord.Type.CPU:n.add(i.TimelineAgent.Instrument.CPU);break;case WI.TimelineRecord.Type.Memory:n.add(i.TimelineAgent.Instrument.Memory);break}i.TimelineAgent.setInstruments(Array.from(n))}}_handleDOMNodeDidFireEvent(e){let{domEvent:t}=e.data;this._addRecord(new WI.MediaTimelineRecord(WI.MediaTimelineRecord.EventType.DOMEvent,t.timestamp,{domNode:e.target,domEvent:t}))}_handleDOMNodePowerEfficientPlaybackStateChanged(e){let{timestamp:t,isPowerEfficient:i}=e.data;this._addRecord(new WI.MediaTimelineRecord(WI.MediaTimelineRecord.EventType.PowerEfficientPlaybackStateChanged,t,{domNode:e.target,isPowerEfficient:i}))}};WI.TimelineManager.CapturingState={Inactive:"inactive",Starting:"starting",Active:"active",Stopping:"stopping"};WI.TimelineManager.Event={CapturingStateChanged:"timeline-manager-capturing-started",RecordingCreated:"timeline-manager-recording-created",RecordingLoaded:"timeline-manager-recording-loaded",RecordingImported:"timeline-manager-recording-imported"};WI.TimelineManager.MaximumAutoRecordDuration=9e4;WI.TimelineManager.MaximumAutoRecordDurationAfterLoadEvent=1e4;WI.TimelineManager.DeadTimeRequiredToStopAutoRecordingEarly=2e3;WI.TypeTokenAnnotator=class extends WI.Annotator{constructor(e,t){super(e),this._script=t,this._typeTokenNodes=[],this._typeTokenBookmarks=[]}insertAnnotations(){if(!this.isActive())return;var e=this._script.scriptSyntaxTree;if(!e){this._script.requestScriptSyntaxTree(a=>{a&&this.insertAnnotations()});return}if(!e.parsedSuccessfully)return;let{startPosition:t,endPosition:i}=this.sourceCodeTextEditor.visibleRangePositions(),n=Date.now(),s=e.filterByRange(t,i);e.updateTypes(s,a=>{if(!this.isActive())return;a.forEach(this._insertTypeToken,this);let d=Date.now()-n,p=Number.constrain(8*d,500,2e3);this._timeoutIdentifier=setTimeout(()=>{this._timeoutIdentifier=null,this.insertAnnotations()},p)})}clearAnnotations(){this._clearTypeTokens()}_insertTypeToken(e){if(e.type===WI.ScriptSyntaxTree.NodeType.Identifier){!e.attachments.__typeToken&&e.attachments.types&&e.attachments.types.valid&&this._insertToken(e,!1,WI.TypeTokenView.TitleType.Variable,e.name),e.attachments.__typeToken&&e.attachments.__typeToken.update(e.attachments.types);return}console.assert(e.type===WI.ScriptSyntaxTree.NodeType.FunctionDeclaration||e.type===WI.ScriptSyntaxTree.NodeType.FunctionExpression||e.type===WI.ScriptSyntaxTree.NodeType.ArrowFunctionExpression);var t=e.attachments.returnTypes;if(!(!t||!t.valid)){var i=this._script._scriptSyntaxTree;if(!e.attachments.__typeToken&&(i.containsNonEmptyReturnStatement(e.body)||!t.typeSet.isContainedIn(WI.TypeSet.TypeBit.Undefined))){var n=e.id?e.id.name:null;this._insertToken(e,!0,WI.TypeTokenView.TitleType.ReturnStatement,n)}e.attachments.__typeToken&&e.attachments.__typeToken.update(e.attachments.returnTypes)}}_insertToken(e,t,i,n){let s=this.sourceCodeTextEditor.originalPositionToCurrentPosition(e.startPosition),a=this.sourceCodeTextEditor.currentPositionToCurrentOffset(s),d=this.sourceCodeTextEditor.string;t&&(a=this._translateToOffsetAfterFunctionParameterList(e,a,d),s=this.sourceCodeTextEditor.currentOffsetToCurrentPosition(a));var p=/\s/,f=a!==0&&!p.test(d[a-1]),_=!p.test(d[a]),b=new WI.TypeTokenView(this,_,f,i,n),w=this.sourceCodeTextEditor.setInlineWidget(s,b.element);e.attachments.__typeToken=b,this._typeTokenNodes.push(e),this._typeTokenBookmarks.push(w)}_translateToOffsetAfterFunctionParameterList(e,t,i){var n=!1,s=!1,a=!1;const d=e.type===WI.ScriptSyntaxTree.NodeType.ArrowFunctionExpression;function p(f){return f===`
`||f==="\r"||f==="\u2028"||f==="\u2029"}for(;(!d&&i[t]!==")"||d&&i[t]!==">"||a)&&t<i.length;){if(s&&p(i[t]))s=!1,a=!1;else if(n&&i[t]==="*"&&i[t+1]==="/")n=!1,a=!1,t++;else if(!a&&i[t]==="/"){if(t++,i[t]==="*")n=!0;else if(i[t]==="/")s=!0;else throw new Error("Bad parsing. Couldn't parse comment preamble.");a=!0}t++}return t+1}_clearTypeTokens(){this._typeTokenNodes.forEach(function(e){e.attachments.__typeToken=null}),this._typeTokenBookmarks.forEach(function(e){e.clear()}),this._typeTokenNodes=[],this._typeTokenBookmarks=[]}};WI.WorkerManager=class extends WI.Object{constructor(){super(),this._connections=new Map}initializeTarget(e){e.WorkerAgent&&e.WorkerAgent.enable()}workerCreated(e,t){let i=new InspectorBackend.WorkerConnection(e),n=new WI.WorkerTarget(e,t,i);n.initialize(),WI.targetManager.addTarget(n),this._connections.set(e,i),WorkerAgent.initialized(e).catch(function(){})}workerTerminated(e){let t=this._connections.take(e);WI.targetManager.removeTarget(t.target)}dispatchMessageFromWorker(e,t){let i=this._connections.get(e);console.assert(i),i&&i.dispatch(t)}};FormatterContentBuilder=class{constructor(e){this._originalContent=null,this._formattedContent=[],this._formattedContentLength=0,this._startOfLine=!0,this._currentLine=null,this.lastTokenWasNewline=!1,this.lastTokenWasWhitespace=!1,this.lastNewlineAppendWasMultiple=!1,this._indent=0,this._indentString=e,this._indentCache=["",this._indentString],this._mapping={original:[0],formatted:[0]},this._originalLineEndings=[],this._formattedLineEndings=[],this._originalOffset=0,this._formattedOffset=0,this._lastOriginalPosition=0,this._lastFormattedPosition=0}get originalContent(){return this._originalContent}get formattedContent(){let e=this._formattedContent.join("");return console.assert(e.length===this._formattedContentLength),e}get sourceMapData(){return{mapping:this._mapping,originalLineEndings:this._originalLineEndings,formattedLineEndings:this._formattedLineEndings}}get lastToken(){return this._formattedContent.lastValue}get currentLine(){return this._currentLine||(this._currentLine=this._formattedContent.slice(this._formattedContent.lastIndexOf(`
`)+1).join("")),this._currentLine}setOriginalContent(e){console.assert(!this._originalContent),this._originalContent=e}setOriginalLineEndings(e){console.assert(!this._originalLineEndings.length),this._originalLineEndings=e}appendToken(e,t){this._startOfLine&&this._appendIndent(),this._addMappingIfNeeded(t),this._append(e),this._startOfLine=!1,this.lastTokenWasNewline=!1,this.lastTokenWasWhitespace=!1}appendSpace(){this._startOfLine||(this._append(" "),this.lastTokenWasNewline=!1,this.lastTokenWasWhitespace=!0)}appendNewline(e){(!this.lastTokenWasNewline&&!this._startOfLine||e)&&(this.lastTokenWasWhitespace&&this._popFormattedContent(),this._append(`
`),this._addFormattedLineEnding(),this._startOfLine=!0,this.lastTokenWasNewline=!0,this.lastTokenWasWhitespace=!1,this.lastNewlineAppendWasMultiple=!1)}appendMultipleNewlines(e){console.assert(e>0);let t=e>1;for(;e-- >0;)this.appendNewline(!0);t&&(this.lastNewlineAppendWasMultiple=!0)}removeLastNewline(){console.assert(this.lastTokenWasNewline),console.assert(this.lastToken===`
`),this.lastTokenWasNewline&&(this._popFormattedContent(),this._formattedLineEndings.pop(),this._startOfLine=!1,this.lastTokenWasNewline=this.lastToken===`
`,this.lastTokenWasWhitespace=this.lastToken===" ")}removeLastWhitespace(){console.assert(this.lastTokenWasWhitespace),console.assert(this.lastToken===" "),this.lastTokenWasWhitespace&&(this._popFormattedContent(),this.lastTokenWasNewline=this.lastToken===`
`,this.lastTokenWasWhitespace=this.lastToken===" ")}indent(){++this._indent}dedent(){--this._indent,console.assert(this._indent>=0),this._indent<0&&(this._indent=0)}addOriginalLineEnding(e){this._originalLineEndings.push(e)}finish(){this.appendNewline()}_popFormattedContent(){let e=this._formattedContent.pop();this._formattedContentLength-=e.length,this._currentLine=null}_append(e){this._formattedContent.push(e),this._formattedContentLength+=e.length,this._currentLine=null}_appendIndent(){if(this._indent<this._indentCache.length){this._append(this._indentCache[this._indent]);return}let e=20,t=Math.min(this._indent,e);for(let n=this._indentCache.length;n<=t;++n)this._indentCache[n]=this._indentCache[n-1]+this._indentString;let i=this._indent;do i>=e?this._append(this._indentCache[e]):this._append(this._indentCache[i]),i-=e;while(i>0)}_addMappingIfNeeded(e){e-this._lastOriginalPosition!==this._formattedContentLength-this._lastFormattedPosition&&(this._mapping.original.push(this._originalOffset+e),this._mapping.formatted.push(this._formattedOffset+this._formattedContentLength),this._lastOriginalPosition=e,this._lastFormattedPosition=this._formattedContentLength)}_addFormattedLineEnding(){console.assert(this._formattedContent.lastValue===`
`),this._formattedLineEndings.push(this._formattedContentLength-1)}};WI.ContentViewCookieType={ApplicationCache:"application-cache",CookieStorage:"cookie-storage",Database:"database",DatabaseTable:"database-table",DOMStorage:"dom-storage",Resource:"resource",Timelines:"timelines"};WI.SelectedSidebarPanelCookieKey="selected-sidebar-panel";WI.TypeIdentifierCookieKey="represented-object-type";WI.StateRestorationType={Load:"state-restoration-load",Navigation:"state-restoration-navigation",Delayed:"state-restoration-delayed"};WI.LayoutDirection={System:"system",LTR:"ltr",RTL:"rtl"};WI.loaded=function(){InspectorBackend.registerTargetDispatcher&&InspectorBackend.registerTargetDispatcher(new WI.TargetObserver),InspectorBackend.registerInspectorDispatcher&&InspectorBackend.registerInspectorDispatcher(new WI.InspectorObserver),InspectorBackend.registerPageDispatcher&&InspectorBackend.registerPageDispatcher(new WI.PageObserver),InspectorBackend.registerConsoleDispatcher&&InspectorBackend.registerConsoleDispatcher(new WI.ConsoleObserver),InspectorBackend.registerNetworkDispatcher&&InspectorBackend.registerNetworkDispatcher(new WI.NetworkObserver),InspectorBackend.registerDOMDispatcher&&InspectorBackend.registerDOMDispatcher(new WI.DOMObserver),InspectorBackend.registerDebuggerDispatcher&&InspectorBackend.registerDebuggerDispatcher(new WI.DebuggerObserver),InspectorBackend.registerHeapDispatcher&&InspectorBackend.registerHeapDispatcher(new WI.HeapObserver),InspectorBackend.registerMemoryDispatcher&&InspectorBackend.registerMemoryDispatcher(new WI.MemoryObserver),InspectorBackend.registerDatabaseDispatcher&&InspectorBackend.registerDatabaseDispatcher(new WI.DatabaseObserver),InspectorBackend.registerDOMStorageDispatcher&&InspectorBackend.registerDOMStorageDispatcher(new WI.DOMStorageObserver),InspectorBackend.registerApplicationCacheDispatcher&&InspectorBackend.registerApplicationCacheDispatcher(new WI.ApplicationCacheObserver),InspectorBackend.registerCPUProfilerDispatcher&&InspectorBackend.registerCPUProfilerDispatcher(new WI.CPUProfilerObserver),InspectorBackend.registerScriptProfilerDispatcher&&InspectorBackend.registerScriptProfilerDispatcher(new WI.ScriptProfilerObserver),InspectorBackend.registerTimelineDispatcher&&InspectorBackend.registerTimelineDispatcher(new WI.TimelineObserver),InspectorBackend.registerCSSDispatcher&&InspectorBackend.registerCSSDispatcher(new WI.CSSObserver),InspectorBackend.registerLayerTreeDispatcher&&InspectorBackend.registerLayerTreeDispatcher(new WI.LayerTreeObserver),InspectorBackend.registerRuntimeDispatcher&&InspectorBackend.registerRuntimeDispatcher(new WI.RuntimeObserver),InspectorBackend.registerWorkerDispatcher&&InspectorBackend.registerWorkerDispatcher(new WI.WorkerObserver),InspectorBackend.registerCanvasDispatcher&&InspectorBackend.registerCanvasDispatcher(new WI.CanvasObserver),WI.Frame.addEventListener(WI.Frame.Event.ProvisionalLoadStarted,WI._provisionalLoadStarted),WI.KeyboardShortcut.Key.Space._displayName=WI.UIString("Space"),WI.managers=[WI.targetManager=new WI.TargetManager,WI.branchManager=new WI.BranchManager,WI.networkManager=new WI.NetworkManager,WI.domStorageManager=new WI.DOMStorageManager,WI.databaseManager=new WI.DatabaseManager,WI.indexedDBManager=new WI.IndexedDBManager,WI.domManager=new WI.DOMManager,WI.cssManager=new WI.CSSManager,WI.consoleManager=new WI.ConsoleManager,WI.runtimeManager=new WI.RuntimeManager,WI.heapManager=new WI.HeapManager,WI.memoryManager=new WI.MemoryManager,WI.applicationCacheManager=new WI.ApplicationCacheManager,WI.timelineManager=new WI.TimelineManager,WI.auditManager=new WI.AuditManager,WI.debuggerManager=new WI.DebuggerManager,WI.layerTreeManager=new WI.LayerTreeManager,WI.workerManager=new WI.WorkerManager,WI.domDebuggerManager=new WI.DOMDebuggerManager,WI.canvasManager=new WI.CanvasManager],WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.Paused,WI._debuggerDidPause),WI.debuggerManager.addEventListener(WI.DebuggerManager.Event.Resumed,WI._debuggerDidResume),WI.domManager.addEventListener(WI.DOMManager.Event.InspectModeStateChanged,WI._inspectModeStateChanged),WI.domManager.addEventListener(WI.DOMManager.Event.DOMNodeWasInspected,WI._domNodeWasInspected),WI.domStorageManager.addEventListener(WI.DOMStorageManager.Event.DOMStorageObjectWasInspected,WI._domStorageWasInspected),WI.databaseManager.addEventListener(WI.DatabaseManager.Event.DatabaseWasInspected,WI._databaseWasInspected),WI.networkManager.addEventListener(WI.NetworkManager.Event.MainFrameDidChange,WI._mainFrameDidChange),WI.networkManager.addEventListener(WI.NetworkManager.Event.FrameWasAdded,WI._frameWasAdded),WI.Frame.addEventListener(WI.Frame.Event.MainResourceDidChange,WI._mainResourceDidChange),document.addEventListener("DOMContentLoaded",WI.contentLoaded),WI._showingSplitConsoleSetting=new WI.Setting("showing-split-console",!1),WI._openTabsSetting=new WI.Setting("open-tab-types",[WI.ElementsTabContentView.Type,WI.NetworkTabContentView.Type,WI.DebuggerTabContentView.Type,WI.ResourcesTabContentView.Type,WI.TimelineTabContentView.Type,WI.StorageTabContentView.Type,WI.CanvasTabContentView.Type,WI.AuditTabContentView.Type,WI.ConsoleTabContentView.Type]),WI._selectedTabIndexSetting=new WI.Setting("selected-tab-index",0),WI.printStylesEnabled=!1,WI.setZoomFactor(WI.settings.zoomFactor.value),WI.mouseCoords={x:0,y:0},WI.modifierKeys={altKey:!1,metaKey:!1,shiftKey:!1},WI.visible=!1,WI._windowKeydownListeners=[],WI._targetsAvailablePromise=new WI.WrappedPromise,WI._overridenDeviceUserAgent=null,WI._overridenDeviceSettings=new Map,WI.backendTarget=null,WI.pageTarget=null,window.TargetAgent?TargetAgent.exists(c=>{c&&WI.targetManager.createDirectBackendTarget()}):WI.targetManager.createDirectBackendTarget()};WI.initializeBackendTarget=function(c){console.assert(!WI.mainTarget),WI.backendTarget=c,WI.resetMainExecutionContext(),WI._targetsAvailablePromise.resolve()};WI.initializePageTarget=function(c){console.assert(WI.sharedApp.debuggableType===WI.DebuggableType.Web),console.assert(c.type===WI.Target.Type.Page||c instanceof WI.DirectBackendTarget),WI.pageTarget=c,WI.redirectGlobalAgentsToConnection(WI.pageTarget.connection),WI.resetMainExecutionContext()};WI.transitionPageTarget=function(c){console.assert(!WI.pageTarget),console.assert(WI.sharedApp.debuggableType===WI.DebuggableType.Web),console.assert(c.type===WI.Target.Type.Page),WI.pageTarget=c,WI.redirectGlobalAgentsToConnection(WI.pageTarget.connection),WI.resetMainExecutionContext(),WI.notifications.dispatchEventToListeners(WI.Notification.TransitionPageTarget),WI.domManager.transitionPageTarget(),WI.networkManager.transitionPageTarget(),WI.timelineManager.transitionPageTarget()};WI.terminatePageTarget=function(c){console.assert(WI.pageTarget),console.assert(WI.pageTarget===c),console.assert(WI.sharedApp.debuggableType===WI.DebuggableType.Web);let e=WI.targets.filter(t=>t.type===WI.Target.Type.Worker);for(let t of e)WI.workerManager.workerTerminated(t.identifier);WI.pageTarget=null,WI.redirectGlobalAgentsToConnection(WI.backendConnection)};WI.resetMainExecutionContext=function(){WI.mainTarget instanceof WI.MultiplexingBackendTarget||WI.mainTarget.executionContext&&(WI.runtimeManager.activeExecutionContext=WI.mainTarget.executionContext,WI.quickConsole&&WI.quickConsole.initializeMainExecutionContextPathComponent())};WI.redirectGlobalAgentsToConnection=function(c){for(let[e,t]of Object.entries(InspectorBackend._agents))e!=="Target"&&(t.connection=c)};WI.contentLoaded=function(){if(window.__uncaughtExceptions)return;document.addEventListener("beforecopy",WI._beforecopy),document.addEventListener("copy",WI._copy),document.addEventListener("paste",WI._paste),document.addEventListener("click",WI._mouseWasClicked),document.addEventListener("dragover",WI._handleDragOver),document.addEventListener("drop",WI._handleDrop),document.addEventListener("focus",WI._focusChanged,!0),window.addEventListener("focus",WI._windowFocused),window.addEventListener("blur",WI._windowBlurred),window.addEventListener("resize",WI._windowResized),window.addEventListener("keydown",WI._windowKeyDown),window.addEventListener("keyup",WI._windowKeyUp),window.addEventListener("mousedown",WI._mouseDown,!0),window.addEventListener("mousemove",WI._mouseMoved,!0),window.addEventListener("pagehide",WI._pageHidden),window.addEventListener("contextmenu",WI._contextMenuRequested),document.body.classList.add(WI.Platform.name+"-platform"),WI.Platform.isNightlyBuild&&document.body.classList.add("nightly-build"),WI.Platform.name==="mac"&&document.body.classList.add(WI.Platform.version.name),document.body.classList.add(WI.sharedApp.debuggableType),document.body.setAttribute("dir",WI.resolvedLayoutDirection()),WI.settings.showJavaScriptTypeInformation.addEventListener(WI.Setting.Event.Changed,WI._showJavaScriptTypeInformationSettingChanged),WI.settings.enableControlFlowProfiler.addEventListener(WI.Setting.Event.Changed,WI._enableControlFlowProfilerSettingChanged),WI.settings.resourceCachingDisabled.addEventListener(WI.Setting.Event.Changed,WI._resourceCachingDisabledSettingChanged);function c(){document.body.style.tabSize=WI.settings.tabSize.value}WI.settings.tabSize.addEventListener(WI.Setting.Event.Changed,c),c();function e(){document.body.classList.toggle("show-invalid-characters",WI.settings.showInvalidCharacters.value)}WI.settings.showInvalidCharacters.addEventListener(WI.Setting.Event.Changed,e),e();function t(){document.body.classList.toggle("show-whitespace-characters",WI.settings.showWhitespaceCharacters.value)}WI.settings.showWhitespaceCharacters.addEventListener(WI.Setting.Event.Changed,t),t(),WI.settingsTabContentView=new WI.SettingsTabContentView,WI._settingsKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl,WI.KeyboardShortcut.Key.Comma,WI._showSettingsTab),WI.toolbar=new WI.Toolbar(document.getElementById("toolbar")),WI.settings.experimentalEnableNewTabBar.value?WI.tabBar=new WI.TabBar(document.getElementById("tab-bar")):(WI.tabBar=new WI.LegacyTabBar(document.getElementById("tab-bar")),WI.tabBar.addEventListener(WI.TabBar.Event.OpenDefaultTab,WI._openDefaultTab)),WI._contentElement=document.getElementById("content"),WI._contentElement.setAttribute("role","main"),WI._contentElement.setAttribute("aria-label",WI.UIString("Content")),WI.clearKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl,"K",WI._clear),WI.populateFindKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl,"E",WI._populateFind),WI.populateFindKeyboardShortcut.implicitlyPreventsDefault=!1,WI.findNextKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl,"G",WI._findNext),WI.findPreviousKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.Shift|WI.KeyboardShortcut.Modifier.CommandOrControl,"G",WI._findPrevious),WI.consoleDrawer=new WI.ConsoleDrawer(document.getElementById("console-drawer")),WI.consoleDrawer.addEventListener(WI.ConsoleDrawer.Event.CollapsedStateChanged,WI._consoleDrawerCollapsedStateDidChange),WI.consoleDrawer.addEventListener(WI.ConsoleDrawer.Event.Resized,WI._consoleDrawerDidResize),WI.quickConsole=new WI.QuickConsole(document.getElementById("quick-console")),WI._consoleRepresentedObject=new WI.LogObject,WI.consoleContentView=WI.consoleDrawer.contentViewForRepresentedObject(WI._consoleRepresentedObject),WI.consoleLogViewController=WI.consoleContentView.logViewController,WI.breakpointPopoverController=new WI.BreakpointPopoverController,WI.navigationSidebar=new WI.Sidebar(document.getElementById("navigation-sidebar"),WI.Sidebar.Sides.Left),WI.navigationSidebar.addEventListener(WI.Sidebar.Event.WidthDidChange,WI._sidebarWidthDidChange),WI.detailsSidebar=new WI.Sidebar(document.getElementById("details-sidebar"),WI.Sidebar.Sides.Right,null,null,WI.UIString("Details"),!0),WI.detailsSidebar.addEventListener(WI.Sidebar.Event.WidthDidChange,WI._sidebarWidthDidChange),WI.searchKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl|WI.KeyboardShortcut.Modifier.Shift,"F",WI._focusSearchField),WI._findKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl,"F",WI._find),WI.saveKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl,"S",WI._save),WI._saveAsKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.Shift|WI.KeyboardShortcut.Modifier.CommandOrControl,"S",WI._saveAs),WI.openResourceKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl|WI.KeyboardShortcut.Modifier.Shift,"O",WI._showOpenResourceDialog),new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl,"P",WI._showOpenResourceDialog),WI.navigationSidebarKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl|WI.KeyboardShortcut.Modifier.Shift,"0",WI.toggleNavigationSidebar),WI.detailsSidebarKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl|WI.KeyboardShortcut.Modifier.Option,"0",WI.toggleDetailsSidebar);let i=WI._increaseZoom,n=WI._decreaseZoom;WI._increaseZoomKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl,WI.KeyboardShortcut.Key.Plus,i),WI._decreaseZoomKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl,WI.KeyboardShortcut.Key.Minus,n),WI._increaseZoomKeyboardShortcut2=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl|WI.KeyboardShortcut.Modifier.Shift,WI.KeyboardShortcut.Key.Plus,i),WI._decreaseZoomKeyboardShortcut2=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl|WI.KeyboardShortcut.Modifier.Shift,WI.KeyboardShortcut.Key.Minus,n),WI._resetZoomKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl,"0",WI._resetZoom),WI._showTabAtIndexKeyboardShortcuts=[1,2,3,4,5,6,7,8,9].map(E=>new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl|WI.KeyboardShortcut.Modifier.Option,`${E}`,k=>{WI._showTabAtIndex(E)})),WI._openNewTabKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl|WI.KeyboardShortcut.Modifier.Option,"T",WI.showNewTabTab),WI.tabBrowser=new WI.TabBrowser(document.getElementById("tab-browser"),WI.tabBar,WI.navigationSidebar,WI.detailsSidebar),WI.tabBrowser.addEventListener(WI.TabBrowser.Event.SelectedTabContentViewDidChange,WI._tabBrowserSelectedTabContentViewDidChange),WI._reloadPageKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl,"R",WI._reloadPage),WI._reloadPageFromOriginKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl|WI.KeyboardShortcut.Modifier.Option,"R",WI._reloadPageFromOrigin),WI._reloadPageKeyboardShortcut.implicitlyPreventsDefault=WI._reloadPageFromOriginKeyboardShortcut.implicitlyPreventsDefault=!1,WI._consoleTabKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.Option|WI.KeyboardShortcut.Modifier.CommandOrControl,"C",WI._showConsoleTab),WI._quickConsoleKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.Control,WI.KeyboardShortcut.Key.Apostrophe,WI._focusConsolePrompt),WI._inspectModeKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl|WI.KeyboardShortcut.Modifier.Shift,"C",WI._toggleInspectMode),WI._undoKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl,"Z",WI._undoKeyboardShortcut),WI._redoKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl|WI.KeyboardShortcut.Modifier.Shift,"Z",WI._redoKeyboardShortcut),WI._undoKeyboardShortcut.implicitlyPreventsDefault=WI._redoKeyboardShortcut.implicitlyPreventsDefault=!1,WI.toggleBreakpointsKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl,"Y",WI.debuggerToggleBreakpoints),WI.pauseOrResumeKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.Control|WI.KeyboardShortcut.Modifier.CommandOrControl,"Y",WI.debuggerPauseResumeToggle),WI.stepOverKeyboardShortcut=new WI.KeyboardShortcut(null,WI.KeyboardShortcut.Key.F6,WI.debuggerStepOver),WI.stepIntoKeyboardShortcut=new WI.KeyboardShortcut(null,WI.KeyboardShortcut.Key.F7,WI.debuggerStepInto),WI.stepOutKeyboardShortcut=new WI.KeyboardShortcut(null,WI.KeyboardShortcut.Key.F8,WI.debuggerStepOut),WI.pauseOrResumeAlternateKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl,WI.KeyboardShortcut.Key.Backslash,WI.debuggerPauseResumeToggle),WI.stepOverAlternateKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl,WI.KeyboardShortcut.Key.SingleQuote,WI.debuggerStepOver),WI.stepIntoAlternateKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl,WI.KeyboardShortcut.Key.Semicolon,WI.debuggerStepInto),WI.stepOutAlternateKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.Shift|WI.KeyboardShortcut.Modifier.CommandOrControl,WI.KeyboardShortcut.Key.Semicolon,WI.debuggerStepOut),WI._closeToolbarButton=new WI.ControlToolbarItem("dock-close",WI.UIString("Close"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2014 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 14'%3e %3cpath fill='none' stroke='currentColor' stroke-linecap='square' d='M 4.5 4.5 L 11.5 11.5 M 4.5 11.5 L 11.5 4.5'/%3e %3c/svg%3e",16,14),WI._closeToolbarButton.addEventListener(WI.ButtonNavigationItem.Event.Clicked,WI.close),WI._undockToolbarButton=new WI.ButtonToolbarItem("undock",WI.UIString("Detach into separate window"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect fill='none' stroke='currentColor' x='4.5' y='5.5' width='11' height='9'/%3e %3cpath fill='none' stroke='currentColor' d='M 3 10.5 L 0.5 10.5 L 0.5 1.5 L 11.5 1.5 L 11.5 4'/%3e %3c/svg%3e"),WI._undockToolbarButton.element.classList.add(WI.Popover.IgnoreAutoDismissClassName),WI._undockToolbarButton.addEventListener(WI.ButtonNavigationItem.Event.Clicked,WI._undock);let s=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2017 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect fill='none' stroke='currentColor' x='0.5' y='1.5' width='15' height='13'/%3e %3cpath fill='none' stroke='currentColor' d='M 6.5 2 L 6.5 14 L 6.5 2 Z'/%3e %3c/svg%3e":"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect fill='none' stroke='currentColor' x='0.5' y='1.5' width='15' height='13'/%3e %3cpath fill='none' stroke='currentColor' d='M 9.5 2 L 9.5 14 L 9.5 2 Z'/%3e %3c/svg%3e";WI._dockToSideToolbarButton=new WI.ButtonToolbarItem("dock-right",WI.UIString("Dock to side of window"),s),WI._dockToSideToolbarButton.element.classList.add(WI.Popover.IgnoreAutoDismissClassName);let a=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?WI._dockLeft:WI._dockRight;WI._dockToSideToolbarButton.addEventListener(WI.ButtonNavigationItem.Event.Clicked,a),WI._dockBottomToolbarButton=new WI.ButtonToolbarItem("dock-bottom",WI.UIString("Dock to bottom of window"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect fill='none' stroke='currentColor' x='0.5' y='1.5' width='15' height='13'/%3e %3cpath fill='none' stroke='currentColor' d='M 1 9.5 L 15 9.5 L 1 9.5 Z'/%3e %3c/svg%3e"),WI._dockBottomToolbarButton.element.classList.add(WI.Popover.IgnoreAutoDismissClassName),WI._dockBottomToolbarButton.addEventListener(WI.ButtonNavigationItem.Event.Clicked,WI._dockBottom),WI._togglePreviousDockConfigurationKeyboardShortcut=new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.CommandOrControl|WI.KeyboardShortcut.Modifier.Shift,"D",WI._togglePreviousDockConfiguration);let d;WI.sharedApp.debuggableType===WI.DebuggableType.JavaScript?d=WI.UIString("Restart (%s)").format(WI._reloadPageKeyboardShortcut.displayName):d=WI.UIString(`Reload page (%s)
Reload page ignoring cache (%s)`).format(WI._reloadPageKeyboardShortcut.displayName,WI._reloadPageFromOriginKeyboardShortcut.displayName),WI._reloadToolbarButton=new WI.ButtonToolbarItem("reload",d,"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='none' stroke='currentColor' d='M 7.5 15 C 4.18629134 15 1.5 12.3137087 1.5 9 C 1.5 5.85466795 3.9202346 3.27461231 7 3.02053689 L 8 3 M 13.5 9 C 13.5 12.3137087 10.8137087 15 7.5 15'/%3e %3cpath fill='currentColor' d='M 7 0 L 7 6.5 L 12.5 3.5 L 7 0 Z'/%3e %3c/svg%3e"),WI._reloadToolbarButton.addEventListener(WI.ButtonNavigationItem.Event.Clicked,WI._reloadToolbarButtonClicked),WI._downloadToolbarButton=new WI.ButtonToolbarItem("download",WI.UIString("Download Web Archive"),"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3cpath fill='none' stroke='currentColor' d='M 8.5 15 C 12.3659934 15 15.5 11.8659934 15.5 8 C 15.5 4.13400656 12.3659934 1 8.5 1 C 4.63400656 1 1.5 4.13400656 1.5 8 C 1.5 11.8659934 4.63400656 15 8.5 15 Z'/%3e %3cpath fill='none' stroke='currentColor' d='M 8.5 1.5 L 8.5 11'/%3e %3cpath fill='none' stroke='currentColor' d='M 5 8 L 8.5 11.5 L 12 8'/%3e %3c/svg%3e"),WI._downloadToolbarButton.addEventListener(WI.ButtonNavigationItem.Event.Clicked,WI._downloadWebArchive);let p=WI.UIString("Start element selection (%s)").format(WI._inspectModeKeyboardShortcut.displayName),f=WI.UIString("Stop element selection (%s)").format(WI._inspectModeKeyboardShortcut.displayName);if(WI._inspectModeToolbarButton=new WI.ActivateButtonToolbarItem("inspect",p,f,"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3ccircle fill='none' stroke='currentColor' cx='8' cy='8' r='6'/%3e %3cpath fill='none' stroke='currentColor' d='M 8 0 L 8 6.5'/%3e %3cpath fill='none' stroke='currentColor' d='M 0 8 L 6.5 8'/%3e %3cpath fill='none' stroke='currentColor' d='M 8 9.5 L 8 16'/%3e %3cpath fill='none' stroke='currentColor' d='M 9.5 8 L 16 8'/%3e %3c/svg%3e"),WI._inspectModeToolbarButton.addEventListener(WI.ButtonNavigationItem.Event.Clicked,WI._toggleInspectMode),InspectorFrontendHost.isRemote&&WI.sharedApp.debuggableType===WI.DebuggableType.Web&&InspectorBackend.domains.Page&&InspectorBackend.domains.Page.overrideUserAgent&&InspectorBackend.domains.Page.overrideSetting){const E=WI.UIString("Device Settings");WI._deviceSettingsToolbarButton=new WI.ActivateButtonToolbarItem("device-settings",E,E,"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2019 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect fill='currentColor' fill-opacity='0.25' stroke='currentColor' stroke-width='1' x='3.75' y='2' width='8.5' height='12' rx='0.5' ry='0.5'/%3e %3c/svg%3e"),WI._deviceSettingsToolbarButton.addEventListener(WI.ButtonNavigationItem.Event.Clicked,WI._handleDeviceSettingsToolbarButtonClicked),WI._deviceSettingsPopover=null}WI._updateReloadToolbarButton(),WI._updateDownloadToolbarButton(),WI._updateInspectModeToolbarButton(),WI._dashboards={default:new WI.DefaultDashboard,debugger:new WI.DebuggerDashboard},WI._dashboardContainer=new WI.DashboardContainerView,WI._dashboardContainer.showDashboardViewForRepresentedObject(WI._dashboards.default),WI.toolbar.addToolbarItem(WI._closeToolbarButton,WI.Toolbar.Section.Control),WI.toolbar.addToolbarItem(WI._undockToolbarButton,WI.Toolbar.Section.Left),WI.toolbar.addToolbarItem(WI._dockToSideToolbarButton,WI.Toolbar.Section.Left),WI.toolbar.addToolbarItem(WI._dockBottomToolbarButton,WI.Toolbar.Section.Left),WI.toolbar.addToolbarItem(WI._reloadToolbarButton,WI.Toolbar.Section.CenterLeft),WI.toolbar.addToolbarItem(WI._downloadToolbarButton,WI.Toolbar.Section.CenterLeft),WI.toolbar.addToolbarItem(WI._dashboardContainer.toolbarItem,WI.Toolbar.Section.Center),WI.toolbar.addToolbarItem(WI._inspectModeToolbarButton,WI.Toolbar.Section.CenterRight),WI._deviceSettingsToolbarButton&&WI.toolbar.addToolbarItem(WI._deviceSettingsToolbarButton,WI.Toolbar.Section.CenterRight),WI._searchTabContentView=new WI.SearchTabContentView,WI.settings.experimentalEnableNewTabBar.value?(WI.tabBrowser.addTabForContentView(WI._searchTabContentView,{suppressAnimations:!0}),WI.tabBar.addTabBarItem(WI.settingsTabContentView.tabBarItem,{suppressAnimations:!0})):(WI._searchToolbarItem=new WI.SearchBar("inspector-search",WI.UIString("Search"),!1),WI._searchToolbarItem.addEventListener(WI.SearchBar.Event.TextChanged,WI._searchTextDidChange),WI.toolbar.addToolbarItem(WI._searchToolbarItem,WI.Toolbar.Section.Right));let _=document.getElementById("docked-resizer");_.classList.add(WI.Popover.IgnoreAutoDismissClassName),_.addEventListener("mousedown",WI._dockedResizerMouseDown),WI._dockingAvailable=!1,WI._updateDockNavigationItems(),WI._setupViewHierarchy();let b=[WI.ElementsTabContentView,WI.NetworkTabContentView,WI.SourcesTabContentView,WI.DebuggerTabContentView,WI.ResourcesTabContentView,WI.TimelineTabContentView,WI.StorageTabContentView,WI.CanvasTabContentView,WI.LayersTabContentView,WI.AuditTabContentView,WI.ConsoleTabContentView,WI.SearchTabContentView,WI.NewTabContentView,WI.SettingsTabContentView];WI._knownTabClassesByType=new Map;for(let E of b)WI._knownTabClassesByType.set(E.Type,E);WI._pendingOpenTabs=[];let w=WI._openTabsSetting.value,S=new Set;for(let E=0;E<w.length;++E){let k=w[E];if(S.has(k))continue;if(S.add(k),!WI.isTabTypeAllowed(k)){WI._pendingOpenTabs.push({tabType:k,index:E});continue}if(!WI.isNewTabWithTypeAllowed(k))continue;let R=WI._createTabContentViewForType(k);!R||WI.tabBrowser.addTabForContentView(R,{suppressAnimations:!0})}WI._restoreCookieForOpenTabs(WI.StateRestorationType.Load),WI.tabBar.selectedTabBarItem=WI._selectedTabIndexSetting.value,WI.tabBar.selectedTabBarItem||(WI.tabBar.selectedTabBarItem=0),WI.tabBar.normalTabCount||WI.showNewTabTab({suppressAnimations:!0}),WI.tabBar.addEventListener(WI.TabBar.Event.TabBarItemAdded,WI._rememberOpenTabs),WI.tabBar.addEventListener(WI.TabBar.Event.TabBarItemRemoved,WI._rememberOpenTabs),WI.tabBar.addEventListener(WI.TabBar.Event.TabBarItemsReordered,WI._rememberOpenTabs),WI.whenTargetsAvailable().then(()=>{InspectorFrontendAPI.loadCompleted()}),WI._updateSheetRect(),InspectorFrontendHost.loaded(),WI._showingSplitConsoleSetting.value&&WI.showSplitConsole(),window.__frontendCompletedLoad=!0,WI.runBootstrapOperations&&WI.runBootstrapOperations()};WI.performOneTimeFrontendInitializationsUsingTarget=function(c){!WI.__didPerformConsoleInitialization&&c.ConsoleAgent&&(WI.__didPerformConsoleInitialization=!0,WI.consoleManager.initializeLogChannels(c)),!WI.__didPerformCSSInitialization&&c.CSSAgent&&(WI.__didPerformCSSInitialization=!0,WI.CSSCompletions.initializeCSSCompletions(c))};WI.initializeTarget=function(c){if(c.PageAgent){if(c.PageAgent.overrideUserAgent&&WI._overridenDeviceUserAgent&&c.PageAgent.overrideUserAgent(WI._overridenDeviceUserAgent),c.PageAgent.overrideSetting)for(let[e,t]of WI._overridenDeviceSettings)c.PageAgent.overrideSetting(e,t);c.PageAgent.setShowRulers&&WI.settings.showRulers.value&&c.PageAgent.setShowRulers(!0),c.PageAgent.setShowPaintRects&&WI.settings.showPaintRects.value&&c.PageAgent.setShowPaintRects(!0)}};WI.targetsAvailable=function(){return WI._targetsAvailablePromise.settled};WI.whenTargetsAvailable=function(){return WI._targetsAvailablePromise.promise};WI.isTabTypeAllowed=function(c){let e=WI._knownTabClassesByType.get(c);return e?e.isTabAllowed():!1};WI.knownTabClasses=function(){return new Set(WI._knownTabClassesByType.values())};WI._showOpenResourceDialog=function(){WI._openResourceDialog||(WI._openResourceDialog=new WI.OpenResourceDialog(WI)),!WI._openResourceDialog.visible&&WI._openResourceDialog.present(WI._contentElement)};WI._createTabContentViewForType=function(c){let e=WI._knownTabClassesByType.get(c);return e?(console.assert(WI.TabContentView.isPrototypeOf(e)),new e):(console.error("Unknown tab type",c),null)};WI._rememberOpenTabs=function(){let c=new Set,e=[];for(let t of WI.tabBar.tabBarItems){let i=t.representedObject;i instanceof WI.TabContentView&&(!i.constructor.shouldSaveTab()||(console.assert(i.type,"Tab type can't be null, undefined, or empty string",i.type,i),e.push(i.type),c.add(i.type)))}for(let{tabType:t,index:i}of WI._pendingOpenTabs)c.has(t)||(e.insertAtIndex(t,i),c.add(t));WI._openTabsSetting.value=e};WI._openDefaultTab=function(c){WI.showNewTabTab({suppressAnimations:!0})};WI._showSettingsTab=function(c){c.keyIdentifier==="U+002C"&&WI.tabBrowser.showTabForContentView(WI.settingsTabContentView)};WI._tryToRestorePendingTabs=function(){let c=[];for(let{tabType:e,index:t}of WI._pendingOpenTabs){if(!WI.isTabTypeAllowed(e)){c.push({tabType:e,index:t});continue}let i=WI._createTabContentViewForType(e);!i||(WI.tabBrowser.addTabForContentView(i,{suppressAnimations:!0,insertionIndex:t}),i.restoreStateFromCookie(WI.StateRestorationType.Load))}WI._pendingOpenTabs=c,WI.settings.experimentalEnableNewTabBar.value||WI.tabBar.updateNewTabTabBarItemState()};WI.showNewTabTab=function(c){if(!WI.isNewTabWithTypeAllowed(WI.NewTabContentView.Type))return;let e=WI.tabBrowser.bestTabContentViewForClass(WI.NewTabContentView);e||(e=new WI.NewTabContentView),WI.tabBrowser.showTabForContentView(e,c)};WI.isNewTabWithTypeAllowed=function(c){let e=WI._knownTabClassesByType.get(c);if(!e||!e.isTabAllowed())return!1;for(let t of WI.tabBar.tabBarItems){let i=t.representedObject;if(i instanceof WI.TabContentView&&i.constructor===e)return!1}return e===WI.NewTabContentView?Array.from(WI.knownTabClasses()).filter(s=>!s.tabInfo().isEphemeral).some(s=>WI.isNewTabWithTypeAllowed(s.Type)):!0};WI.createNewTabWithType=function(c,e={}){console.assert(WI.isNewTabWithTypeAllowed(c));let{referencedView:t,shouldReplaceTab:i,shouldShowNewTab:n}=e;console.assert(!t||t instanceof WI.TabContentView,t),console.assert(!i||t,"Must provide a reference view to replace a tab.");let s=WI._createTabContentViewForType(c);const a=!0;WI.tabBrowser.addTabForContentView(s,{suppressAnimations:a,insertionIndex:t?WI.tabBar.tabBarItems.indexOf(t.tabBarItem):void 0}),i&&WI.tabBrowser.closeTabForContentView(t,{suppressAnimations:a}),n&&WI.tabBrowser.showTabForContentView(s)};WI.activateExtraDomains=function(c){WI.notifications.dispatchEventToListeners(WI.Notification.ExtraDomainsActivated,{domains:c}),WI.mainTarget&&(!WI.pageTarget&&WI.mainTarget.DOMAgent&&(WI.pageTarget=WI.mainTarget),WI.mainTarget.CSSAgent&&WI.CSSCompletions.initializeCSSCompletions(WI.assumingMainTarget()),WI.mainTarget.DOMAgent&&WI.domManager.ensureDocument(),WI.mainTarget.PageAgent&&WI.networkManager.initializeTarget(WI.mainTarget)),WI._updateReloadToolbarButton(),WI._updateDownloadToolbarButton(),WI._updateInspectModeToolbarButton(),WI._tryToRestorePendingTabs()};WI.updateWindowTitle=function(){var c=WI.networkManager.mainFrame;if(!!c){var e=c.mainResource.urlComponents,t;try{t=decodeURIComponent(e.lastPathComponent||"")}catch{t=e.lastPathComponent}if(e.host&&t)var i=WI.displayNameForHost(e.host)+" \u2014 "+t;else if(e.host)var i=WI.displayNameForHost(e.host);else if(t)var i=t;else var i=c.url;InspectorFrontendHost.inspectedURLChanged(i)}};WI.updateDockingAvailability=function(c){WI._dockingAvailable=c,WI._updateDockNavigationItems()};WI.updateDockedState=function(c){WI._dockConfiguration!==c&&(WI._previousDockConfiguration=WI._dockConfiguration,WI._previousDockConfiguration||(c===WI.DockConfiguration.Right||c===WI.DockConfiguration.Left?WI._previousDockConfiguration=WI.DockConfiguration.Bottom:WI._previousDockConfiguration=WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL?WI.DockConfiguration.Left:WI.DockConfiguration.Right),WI._dockConfiguration=c,WI.docked=c!==WI.DockConfiguration.Undocked,WI._ignoreToolbarModeDidChangeEvents=!0,c===WI.DockConfiguration.Bottom?(document.body.classList.add("docked",WI.DockConfiguration.Bottom),document.body.classList.remove("window-inactive",WI.DockConfiguration.Right,WI.DockConfiguration.Left)):c===WI.DockConfiguration.Right?(document.body.classList.add("docked",WI.DockConfiguration.Right),document.body.classList.remove("window-inactive",WI.DockConfiguration.Bottom,WI.DockConfiguration.Left)):c===WI.DockConfiguration.Left?(document.body.classList.add("docked",WI.DockConfiguration.Left),document.body.classList.remove("window-inactive",WI.DockConfiguration.Bottom,WI.DockConfiguration.Right)):document.body.classList.remove("docked",WI.DockConfiguration.Right,WI.DockConfiguration.Left,WI.DockConfiguration.Bottom),WI._ignoreToolbarModeDidChangeEvents=!1,WI._updateDockNavigationItems(),!WI.dockedConfigurationSupportsSplitContentBrowser()&&!WI.doesCurrentTabSupportSplitContentBrowser()&&WI.hideSplitConsole())};WI.updateVisibilityState=function(c){WI.visible=c,WI.notifications.dispatchEventToListeners(WI.Notification.VisibilityStateDidChange)};WI.handlePossibleLinkClick=function(c,e,t={}){let i=c.target.closest("a");return!i||!i.href||WI.isBeingEdited(i)?!1:(c.preventDefault(),c.stopPropagation(),WI.openURL(i.href,e,{...t,lineNumber:i.lineNumber,ignoreSearchTab:!WI.isShowingSearchTab()}),!0)};WI.openURL=function(c,e,t={}){if(console.assert(c),!c)return;if(console.assert(typeof t.lineNumber>"u"||typeof t.lineNumber=="number","lineNumber should be a number."),(t.alwaysOpenExternally===void 0||t.alwaysOpenExternally===null)&&(t.alwaysOpenExternally=window.event?window.event.metaKey:!1),t.alwaysOpenExternally){InspectorFrontendHost.openInNewTab(c);return}let i=!1;e||(e=WI.networkManager.mainFrame,i=!0);let n,s=removeURLFragment(c);if(e?n=e.url===s?e.mainResource:e.resourceForURL(s,i):WI.sharedApp.debuggableType===WI.DebuggableType.ServiceWorker&&(n=WI.mainTarget.resourceCollection.resourceForURL(removeURLFragment(c))),n){let a=new WI.SourceCodePosition(t.lineNumber,0);WI.showSourceCode(n,{...t,positionToReveal:a});return}InspectorFrontendHost.openInNewTab(c)};WI.close=function(){WI._isClosing||(WI._isClosing=!0,InspectorFrontendHost.closeWindow())};WI.isConsoleFocused=function(){return WI.quickConsole.prompt.focused};WI.isShowingSplitConsole=function(){return!WI.consoleDrawer.collapsed};WI.dockedConfigurationSupportsSplitContentBrowser=function(){return WI._dockConfiguration!==WI.DockConfiguration.Bottom};WI.doesCurrentTabSupportSplitContentBrowser=function(){var c=WI.tabBrowser.selectedTabContentView;return!c||c.supportsSplitContentBrowser};WI.toggleSplitConsole=function(){if(!WI.doesCurrentTabSupportSplitContentBrowser()){WI.showConsoleTab();return}WI.isShowingSplitConsole()?WI.hideSplitConsole():WI.showSplitConsole()};WI.showSplitConsole=function(){if(!WI.doesCurrentTabSupportSplitContentBrowser()){WI.showConsoleTab();return}WI.consoleDrawer.collapsed=!1,WI.consoleDrawer.currentContentView!==WI.consoleContentView&&WI.consoleDrawer.showContentView(WI.consoleContentView)};WI.hideSplitConsole=function(){!WI.isShowingSplitConsole()||(WI.consoleDrawer.collapsed=!0)};WI.showConsoleTab=function(c){c=c||WI.LogContentView.Scopes.All,WI.hideSplitConsole(),WI.consoleContentView.scopeBar.item(c).selected=!0,WI.showRepresentedObject(WI._consoleRepresentedObject),console.assert(WI.isShowingConsoleTab())};WI.isShowingConsoleTab=function(){return WI.tabBrowser.selectedTabContentView instanceof WI.ConsoleTabContentView};WI.showElementsTab=function(){var c=WI.tabBrowser.bestTabContentViewForClass(WI.ElementsTabContentView);c||(c=new WI.ElementsTabContentView),WI.tabBrowser.showTabForContentView(c)};WI.isShowingElementsTab=function(){return WI.tabBrowser.selectedTabContentView instanceof WI.ElementsTabContentView};WI.showSourcesTab=function(c={}){let e=WI.tabBrowser.bestTabContentViewForClass(WI.SourcesTabContentView);e||(e=new WI.SourcesTabContentView),c.breakpointToSelect instanceof WI.Breakpoint&&e.revealAndSelectBreakpoint(c.breakpointToSelect),c.showScopeChainSidebar&&e.showScopeChainDetailsSidebarPanel(),WI.tabBrowser.showTabForContentView(e)};WI.isShowingSourcesTab=function(){return WI.tabBrowser.selectedTabContentView instanceof WI.SourcesTabContentView};WI.showDebuggerTab=function(c){var e=WI.tabBrowser.bestTabContentViewForClass(WI.DebuggerTabContentView);e||(e=new WI.DebuggerTabContentView),c.breakpointToSelect instanceof WI.Breakpoint&&e.revealAndSelectBreakpoint(c.breakpointToSelect),c.showScopeChainSidebar&&e.showScopeChainDetailsSidebarPanel(),WI.tabBrowser.showTabForContentView(e)};WI.isShowingDebuggerTab=function(){return WI.tabBrowser.selectedTabContentView instanceof WI.DebuggerTabContentView};WI.showResourcesTab=function(){var c=WI.tabBrowser.bestTabContentViewForClass(WI.ResourcesTabContentView);c||(c=new WI.ResourcesTabContentView),WI.tabBrowser.showTabForContentView(c)};WI.isShowingResourcesTab=function(){return WI.tabBrowser.selectedTabContentView instanceof WI.ResourcesTabContentView};WI.showStorageTab=function(){var c=WI.tabBrowser.bestTabContentViewForClass(WI.StorageTabContentView);c||(c=new WI.StorageTabContentView),WI.tabBrowser.showTabForContentView(c)};WI.showNetworkTab=function(){let c=WI.tabBrowser.bestTabContentViewForClass(WI.NetworkTabContentView);c||(c=new WI.NetworkTabContentView),WI.tabBrowser.showTabForContentView(c)};WI.isShowingNetworkTab=function(){return WI.tabBrowser.selectedTabContentView instanceof WI.NetworkTabContentView};WI.isShowingSearchTab=function(){return WI.tabBrowser.selectedTabContentView instanceof WI.SearchTabContentView};WI.showTimelineTab=function(){var c=WI.tabBrowser.bestTabContentViewForClass(WI.TimelineTabContentView);c||(c=new WI.TimelineTabContentView),WI.tabBrowser.showTabForContentView(c)};WI.showLayersTab=function(c={}){let e=WI.tabBrowser.bestTabContentViewForClass(WI.LayersTabContentView);e||(e=new WI.LayersTabContentView),c.nodeToSelect&&e.selectLayerForNode(c.nodeToSelect),WI.tabBrowser.showTabForContentView(e)};WI.isShowingLayersTab=function(){return WI.tabBrowser.selectedTabContentView instanceof WI.LayersTabContentView};WI.indentString=function(){return WI.settings.indentWithTabs.value?"	":" ".repeat(WI.settings.indentUnit.value)};WI.restoreFocusFromElement=function(c){c&&c.contains(WI.currentFocusElement)&&WI.previousFocusElement.focus()};WI.toggleNavigationSidebar=function(c){if(!WI.navigationSidebar.collapsed||!WI.navigationSidebar.sidebarPanels.length){WI.navigationSidebar.collapsed=!0;return}WI.navigationSidebar.selectedSidebarPanel||(WI.navigationSidebar.selectedSidebarPanel=WI.navigationSidebar.sidebarPanels[0]),WI.navigationSidebar.collapsed=!1};WI.toggleDetailsSidebar=function(c){if(!WI.detailsSidebar.collapsed||!WI.detailsSidebar.sidebarPanels.length){WI.detailsSidebar.collapsed=!0;return}WI.detailsSidebar.selectedSidebarPanel||(WI.detailsSidebar.selectedSidebarPanel=WI.detailsSidebar.sidebarPanels[0]),WI.detailsSidebar.collapsed=!1};WI.getMaximumSidebarWidth=function(c){console.assert(c instanceof WI.Sidebar);const e=100;let t=window.innerWidth-e,i=WI.tabBrowser.selectedTabContentView;if(console.assert(i),!i)return t;let n=null;return c===WI.navigationSidebar?n=i.detailsSidebarPanels.length?WI.detailsSidebar:null:n=i.navigationSidebarPanel?WI.navigationSidebar:null,n&&(t-=n.width),t};WI.tabContentViewClassForRepresentedObject=function(c){if(c instanceof WI.DOMTree)return WI.ElementsTabContentView;if(c instanceof WI.TimelineRecording)return WI.TimelineTabContentView;if(c===WI._consoleRepresentedObject)return WI.ConsoleTabContentView;if(WI.settings.experimentalEnableSourcesTab.value){if(c instanceof WI.Frame||c instanceof WI.FrameCollection||c instanceof WI.Resource||c instanceof WI.ResourceCollection||c instanceof WI.Script||c instanceof WI.ScriptCollection||c instanceof WI.CSSStyleSheet||c instanceof WI.CSSStyleSheetCollection)return WI.SourcesTabContentView}else{if(WI.debuggerManager.paused&&(c instanceof WI.Script||c instanceof WI.Resource&&(c.type===WI.Resource.Type.Document||c.type===WI.Resource.Type.Script)))return WI.DebuggerTabContentView;if(c instanceof WI.Frame||c instanceof WI.FrameCollection||c instanceof WI.Resource||c instanceof WI.ResourceCollection||c instanceof WI.Script||c instanceof WI.ScriptCollection||c instanceof WI.CSSStyleSheet||c instanceof WI.CSSStyleSheetCollection)return WI.ResourcesTabContentView}return c instanceof WI.DOMStorageObject||c instanceof WI.CookieStorageObject||c instanceof WI.DatabaseTableObject||c instanceof WI.DatabaseObject||c instanceof WI.ApplicationCacheFrame||c instanceof WI.IndexedDatabaseObjectStore||c instanceof WI.IndexedDatabase||c instanceof WI.IndexedDatabaseObjectStoreIndex?WI.StorageTabContentView:c instanceof WI.AuditTestCase||c instanceof WI.AuditTestGroup||c instanceof WI.AuditTestCaseResult||c instanceof WI.AuditTestGroupResult?WI.AuditTabContentView:c instanceof WI.CanvasCollection||c instanceof WI.Recording?WI.CanvasTabContentView:null};WI.tabContentViewForRepresentedObject=function(c,e={}){let t=WI.tabBrowser.bestTabContentViewForRepresentedObject(c,e);if(t)return t;var i=WI.tabContentViewClassForRepresentedObject(c);return i?(t=new i,WI.tabBrowser.addTabForContentView(t),t):(console.error("Unknown representedObject, couldn't create TabContentView.",c),null)};WI.showRepresentedObject=function(c,e,t={}){let i=WI.tabContentViewForRepresentedObject(c,t);console.assert(i),i&&(WI.tabBrowser.showTabForContentView(i,t),i.showRepresentedObject(c,e))};WI.showMainFrameDOMTree=function(c,e={}){console.assert(WI.networkManager.mainFrame),WI.networkManager.mainFrame&&WI.showRepresentedObject(WI.networkManager.mainFrame.domTree,{nodeToSelect:c},e)};WI.showSourceCodeForFrame=function(c,e={}){var t=WI.networkManager.frameForIdentifier(c);if(!t){WI._frameIdentifierToShowSourceCodeWhenAvailable=c;return}WI._frameIdentifierToShowSourceCodeWhenAvailable=void 0,WI.showRepresentedObject(t,null,e)};WI.showSourceCode=function(c,e={}){const t=e.positionToReveal;console.assert(!t||t instanceof WI.SourceCodePosition,t);var i=c;i instanceof WI.Script&&(i=i.resource||i);var n=t?{lineNumber:t.lineNumber,columnNumber:t.columnNumber}:{};WI.showRepresentedObject(i,n,e)};WI.showSourceCodeLocation=function(c,e={}){WI.showSourceCode(c.displaySourceCode,{...e,positionToReveal:c.displayPosition()})};WI.showOriginalUnformattedSourceCodeLocation=function(c,e={}){WI.showSourceCode(c.sourceCode,{...e,positionToReveal:c.position(),forceUnformatted:!0})};WI.showOriginalOrFormattedSourceCodeLocation=function(c,e={}){WI.showSourceCode(c.sourceCode,{...e,positionToReveal:c.formattedPosition()})};WI.showOriginalOrFormattedSourceCodeTextRange=function(c,e={}){var t=c.formattedTextRange;WI.showSourceCode(c.sourceCode,{...e,positionToReveal:t.startPosition(),textRangeToSelect:t})};WI.showResourceRequest=function(c,e={}){WI.showRepresentedObject(c,{[WI.ResourceClusterContentView.ContentViewIdentifierCookieKey]:WI.ResourceClusterContentView.RequestIdentifier},e)};WI.debuggerToggleBreakpoints=function(c){WI.debuggerManager.breakpointsEnabled=!WI.debuggerManager.breakpointsEnabled};WI.debuggerPauseResumeToggle=function(c){WI.debuggerManager.paused?WI.debuggerManager.resume():WI.debuggerManager.pause()};WI.debuggerStepOver=function(c){WI.debuggerManager.stepOver()};WI.debuggerStepInto=function(c){WI.debuggerManager.stepInto()};WI.debuggerStepOut=function(c){WI.debuggerManager.stepOut()};WI._searchTextDidChange=function(c){var e=WI.tabBrowser.bestTabContentViewForClass(WI.SearchTabContentView);e||(e=new WI.SearchTabContentView);var t=WI._searchToolbarItem.text;WI._searchToolbarItem.text="",WI.tabBrowser.showTabForContentView(e),e.performSearch(t)};WI._focusSearchField=function(c){if(WI.settings.experimentalEnableNewTabBar.value&&WI.tabBrowser.showTabForContentView(WI._searchTabContentView),WI.tabBrowser.selectedTabContentView instanceof WI.SearchTabContentView){WI.tabBrowser.selectedTabContentView.focusSearchField();return}WI._searchToolbarItem&&WI._searchToolbarItem.focus()};WI._focusChanged=function(c){if(WI.isEventTargetAnEditableField(c)){let n=null;if(c.target instanceof HTMLInputElement||c.target instanceof HTMLTextAreaElement)n=c.target;else{let s=WI.enclosingCodeMirror(c.target);if(s){let a=s.getWrapperElement();a&&a!==WI.currentFocusElement&&(n=a)}}if(n&&(WI.previousFocusElement=WI.currentFocusElement,WI.currentFocusElement=n),!WI.isBeingEdited(c.target))return}var e=window.getSelection();if(!!e.isCollapsed){var t=c.target;if(t!==WI.currentFocusElement&&(WI.previousFocusElement=WI.currentFocusElement,WI.currentFocusElement=t),!t.isInsertionCaretInside()){var i=t.ownerDocument.createRange();i.setStart(t,0),i.setEnd(t,0),e.removeAllRanges(),e.addRange(i)}}};WI._mouseWasClicked=function(c){WI.handlePossibleLinkClick(c)};WI._handleDragOver=function(c){if(c.defaultPrevented||WI.isEventTargetAnEditableField(c))return;let e=WI.tabBrowser.selectedTabContentView;(!e||!e.handleFileDrop||!c.dataTransfer.types.includes("Files"))&&(c.dataTransfer.dropEffect="none"),c.preventDefault()};WI._handleDrop=function(c){if(c.defaultPrevented||WI.isEventTargetAnEditableField(c))return;let e=WI.tabBrowser.selectedTabContentView;e&&e.handleFileDrop&&c.dataTransfer.files&&(c.preventDefault(),e.handleFileDrop(c.dataTransfer.files).then(()=>{c.dataTransfer.clearData()}))};WI._debuggerDidPause=function(c){WI.settings.experimentalEnableSourcesTab.value?WI.showSourcesTab({showScopeChainSidebar:WI.settings.showScopeChainOnPause.value}):WI.showDebuggerTab({showScopeChainSidebar:WI.settings.showScopeChainOnPause.value}),WI._dashboardContainer.showDashboardViewForRepresentedObject(WI._dashboards.debugger),InspectorFrontendHost.bringToFront()};WI._debuggerDidResume=function(c){WI._dashboardContainer.closeDashboardViewForRepresentedObject(WI._dashboards.debugger)};WI._frameWasAdded=function(c){if(!WI._frameIdentifierToShowSourceCodeWhenAvailable)return;var e=c.data.frame;if(e.id!==WI._frameIdentifierToShowSourceCodeWhenAvailable)return;function t(){const i={ignoreNetworkTab:!0,ignoreSearchTab:!0};WI.showSourceCodeForFrame(e.id,i)}setTimeout(t)};WI._mainFrameDidChange=function(c){WI._updateDownloadToolbarButton(),WI.updateWindowTitle()};WI._mainResourceDidChange=function(c){!c.target.isMainFrame()||(setTimeout(()=>{WI._restoreCookieForOpenTabs(WI.StateRestorationType.Navigation)}),WI._updateDownloadToolbarButton(),WI.updateWindowTitle())};WI._provisionalLoadStarted=function(c){!c.target.isMainFrame()||WI._saveCookieForOpenTabs()};WI._restoreCookieForOpenTabs=function(c){for(var e of WI.tabBar.tabBarItems){var t=e.representedObject;t instanceof WI.TabContentView&&t.restoreStateFromCookie(c)}};WI._saveCookieForOpenTabs=function(){for(var c of WI.tabBar.tabBarItems){var e=c.representedObject;e instanceof WI.TabContentView&&e.saveStateToCookie()}};WI._windowFocused=function(c){c.target.document.nodeType===Node.DOCUMENT_NODE&&document.body.classList.remove(WI.docked?"window-docked-inactive":"window-inactive")};WI._windowBlurred=function(c){c.target.document.nodeType===Node.DOCUMENT_NODE&&document.body.classList.add(WI.docked?"window-docked-inactive":"window-inactive")};WI._windowResized=function(c){WI.toolbar.updateLayout(WI.View.LayoutReason.Resize),WI.tabBar.updateLayout(WI.View.LayoutReason.Resize),WI._tabBrowserSizeDidChange(),WI._updateSheetRect()};WI._updateSheetRect=function(){let c=document.getElementById("main").getBoundingClientRect();InspectorFrontendHost.setSheetRect(c.x,c.y,c.width,c.height)};WI._updateModifierKeys=function(c){let e={altKey:c.altKey,metaKey:c.metaKey,ctrlKey:c.ctrlKey,shiftKey:c.shiftKey},t=!Object.shallowEqual(WI.modifierKeys,e);WI.modifierKeys=e,document.body.classList.toggle("alt-key-pressed",WI.modifierKeys.altKey),document.body.classList.toggle("ctrl-key-pressed",WI.modifierKeys.ctrlKey),document.body.classList.toggle("meta-key-pressed",WI.modifierKeys.metaKey),document.body.classList.toggle("shift-key-pressed",WI.modifierKeys.shiftKey),t&&WI.notifications.dispatchEventToListeners(WI.Notification.GlobalModifierKeysDidChange,c)};WI._windowKeyDown=function(c){WI._updateModifierKeys(c)};WI._windowKeyUp=function(c){WI._updateModifierKeys(c)};WI._mouseDown=function(c){if(WI.toolbar.element.contains(c.target)&&WI._toolbarMouseDown(c),c.button===2){const e=new MouseEvent("contextmenu",{view:window,bubbles:!0,cancelable:!0,screenX:c.pageX,screenY:c.pageY,clientX:c.pageX,clientY:c.pageY,...c});c.target.dispatchEvent(e)}};WI._mouseMoved=function(c){WI._updateModifierKeys(c),WI.mouseCoords={x:c.pageX,y:c.pageY}};WI._pageHidden=function(c){WI._saveCookieForOpenTabs()};WI._contextMenuRequested=function(c){let e;if(WI.isDebugUIEnabled()){e=WI.ContextMenu.createFromEvent(c),e.appendSeparator(),e.appendItem(WI.unlocalizedString("Reload Web Inspector"),()=>{InspectorFrontendHost.reopen()});let t=e.appendSubMenuItem(WI.unlocalizedString("Protocol Debugging"),null,!1),i=InspectorBackend.activeTracer instanceof WI.CapturingProtocolTracer;t.appendCheckboxItem(WI.unlocalizedString("Capture Trace"),()=>{i?InspectorBackend.activeTracer=null:InspectorBackend.activeTracer=new WI.CapturingProtocolTracer},i),t.appendSeparator(),t.appendItem(WI.unlocalizedString("Export Trace\u2026"),()=>{WI.FileUtilities.save(InspectorBackend.activeTracer.trace.saveData,!0)},!i)}else e=WI.ContextMenu.createFromEvent(c,!0);e&&e.show()};WI.isDebugUIEnabled=function(){return WI.showDebugUISetting&&WI.showDebugUISetting.value};WI._undock=function(c){InspectorFrontendHost.requestSetDockSide(WI.DockConfiguration.Undocked)};WI._dockBottom=function(c){InspectorFrontendHost.requestSetDockSide(WI.DockConfiguration.Bottom)};WI._dockRight=function(c){InspectorFrontendHost.requestSetDockSide(WI.DockConfiguration.Right)};WI._dockLeft=function(c){InspectorFrontendHost.requestSetDockSide(WI.DockConfiguration.Left)};WI._togglePreviousDockConfiguration=function(c){InspectorFrontendHost.requestSetDockSide(WI._previousDockConfiguration)};WI._updateDockNavigationItems=function(){WI._dockingAvailable||WI.docked?(WI._closeToolbarButton.hidden=!WI.docked,WI._undockToolbarButton.hidden=WI._dockConfiguration===WI.DockConfiguration.Undocked,WI._dockBottomToolbarButton.hidden=WI._dockConfiguration===WI.DockConfiguration.Bottom,WI._dockToSideToolbarButton.hidden=WI._dockConfiguration===WI.DockConfiguration.Right||WI._dockConfiguration===WI.DockConfiguration.Left):(WI._closeToolbarButton.hidden=!0,WI._undockToolbarButton.hidden=!0,WI._dockBottomToolbarButton.hidden=!0,WI._dockToSideToolbarButton.hidden=!0)};WI._tabBrowserSizeDidChange=function(){WI.tabBrowser.updateLayout(WI.View.LayoutReason.Resize),WI.consoleDrawer.updateLayout(WI.View.LayoutReason.Resize),WI.quickConsole.updateLayout(WI.View.LayoutReason.Resize)};WI._consoleDrawerCollapsedStateDidChange=function(c){WI._showingSplitConsoleSetting.value=WI.isShowingSplitConsole(),WI._consoleDrawerDidResize()};WI._consoleDrawerDidResize=function(c){WI.tabBrowser.updateLayout(WI.View.LayoutReason.Resize)};WI._sidebarWidthDidChange=function(c){WI._tabBrowserSizeDidChange()};WI._setupViewHierarchy=function(){let c=WI.View.rootView();c.addSubview(WI.toolbar),c.addSubview(WI.tabBar),c.addSubview(WI.navigationSidebar),c.addSubview(WI.tabBrowser),c.addSubview(WI.consoleDrawer),c.addSubview(WI.quickConsole),c.addSubview(WI.detailsSidebar)};WI._tabBrowserSelectedTabContentViewDidChange=function(c){if(WI.tabBar.selectedTabBarItem&&WI.tabBar.selectedTabBarItem.representedObject.constructor.shouldSaveTab()&&(WI._selectedTabIndexSetting.value=WI.tabBar.tabBarItems.indexOf(WI.tabBar.selectedTabBarItem)),WI.doesCurrentTabSupportSplitContentBrowser()){WI._shouldRevealSpitConsoleIfSupported&&(WI._shouldRevealSpitConsoleIfSupported=!1,WI.showSplitConsole());return}WI._shouldRevealSpitConsoleIfSupported=WI.isShowingSplitConsole(),WI.hideSplitConsole()};WI._toolbarMouseDown=function(c){c.ctrlKey||WI._dockConfiguration===WI.DockConfiguration.Right||WI._dockConfiguration===WI.DockConfiguration.Left||(WI.docked?WI._dockedResizerMouseDown(c):WI._moveWindowMouseDown(c))};WI._dockedResizerMouseDown=function(c){if(c.button!==0||c.ctrlKey||!WI.docked||c.target.id!=="docked-resizer"&&!c.target.classList.contains("toolbar")&&!c.target.classList.contains("flexible-space")&&!c.target.classList.contains("item-section"))return;c[WI.Popover.EventPreventDismissSymbol]=!0;let e=WI._dockConfiguration===WI.DockConfiguration.Bottom?"innerHeight":"innerWidth",t=WI._dockConfiguration===WI.DockConfiguration.Bottom?"screenY":"screenX",i=WI._dockConfiguration===WI.DockConfiguration.Bottom?"clientY":"clientX";var n=c.target,s=c[i],a=c[t];function d(f){if(f.button!==0)return;var _=f[t],b=_-a,w=f[i];if(a=_,WI._dockConfiguration===WI.DockConfiguration.Left){if(b>0&&w<s||b<0&&w>window[e])return;b*=-1}else if(b>0&&w<s||b<0&&w>s)return;let S=Math.max(0,window[e]-b);S*=WI.getZoomFactor(),WI._dockConfiguration===WI.DockConfiguration.Bottom?InspectorFrontendHost.setAttachedWindowHeight(S):InspectorFrontendHost.setAttachedWindowWidth(S)}function p(f){f.button===0&&WI.elementDragEnd(f)}WI.elementDragStart(n,d,p,c,WI._dockConfiguration===WI.DockConfiguration.Bottom?"row-resize":"col-resize")};WI._moveWindowMouseDown=function(c){if(console.assert(!WI.docked),c.button!==0||c.ctrlKey||!c.target.classList.contains("toolbar")&&!c.target.classList.contains("flexible-space")&&!c.target.classList.contains("item-section"))return;if(c[WI.Popover.EventPreventDismissSymbol]=!0,WI.Platform.name==="mac"){InspectorFrontendHost.startWindowDrag(),c.preventDefault();return}var e=c.screenX,t=c.screenY;function i(s){if(s.button===0){var a=s.screenX-e,d=s.screenY-t;InspectorFrontendHost.moveWindowBy(a,d),e=s.screenX,t=s.screenY}}function n(s){s.button===0&&WI.elementDragEnd(s)}WI.elementDragStart(c.target,i,n,c,"default")};WI._domStorageWasInspected=function(c){WI.showStorageTab(),WI.showRepresentedObject(c.data.domStorage,null,{ignoreSearchTab:!0})};WI._databaseWasInspected=function(c){WI.showStorageTab(),WI.showRepresentedObject(c.data.database,null,{ignoreSearchTab:!0})};WI._domNodeWasInspected=function(c){WI.domManager.highlightDOMNodeForTwoSeconds(c.data.node.id),InspectorFrontendHost.bringToFront(),WI.showElementsTab(),WI.showMainFrameDOMTree(c.data.node,{ignoreSearchTab:!0})};WI._inspectModeStateChanged=function(c){WI._inspectModeToolbarButton.activated=WI.domManager.inspectModeEnabled};WI._toggleInspectMode=function(c){WI.domManager.inspectModeEnabled=!WI.domManager.inspectModeEnabled};WI._handleDeviceSettingsToolbarButtonClicked=function(c){if(WI._deviceSettingsPopover){WI._deviceSettingsPopover.dismiss(),WI._deviceSettingsPopover=null;return}function e(){WI._deviceSettingsToolbarButton.activated=WI._overridenDeviceUserAgent||WI._overridenDeviceSettings.size>0}function t(M,L){M!==WI._overridenDeviceUserAgent&&(!L&&(!M||M==="default")?PageAgent.overrideUserAgent(V=>{if(V){console.error(V);return}WI._overridenDeviceUserAgent=null,e(),PageAgent.reload()}):PageAgent.overrideUserAgent(M,V=>{if(V){console.error(V);return}WI._overridenDeviceUserAgent=M,e(),PageAgent.reload()}))}function i(M,L,V){WI._overridenDeviceSettings.has(M)?PageAgent.overrideSetting(M,H=>{if(H){console.error(H);return}WI._overridenDeviceSettings.delete(M),V(!1),e()}):PageAgent.overrideSetting(M,L,H=>{if(H){console.error(H);return}WI._overridenDeviceSettings.set(M,L),V(!0),e()})}function n(M,L,V,H){if(!V)return;let O=M.appendChild(document.createElement("label")),z=O.appendChild(document.createElement("input"));z.type="checkbox",z.checked=WI._overridenDeviceSettings.has(V),z.addEventListener("change",K=>{i(V,H,q=>{z.checked=q})}),O.append(L)}function s(){return WI.Rect.rectFromClientRect(WI._deviceSettingsToolbarButton.element.getBoundingClientRect())}const a=[WI.RectEdge.MAX_Y,WI.RectEdge.MIN_X,WI.RectEdge.MAX_X];WI._deviceSettingsPopover=new WI.Popover(WI),WI._deviceSettingsPopover.windowResizeHandler=function(M){WI._deviceSettingsPopover.present(s(),a)};let d=document.createElement("table");d.classList.add("device-settings-content");let p=d.appendChild(document.createElement("tr")),f=p.appendChild(document.createElement("td"));f.textContent=WI.UIString("User Agent:");let _=p.appendChild(document.createElement("td"));_.classList.add("user-agent");let b=_.appendChild(document.createElement("select")),w=null;const S=[[{name:WI.UIString("Default"),value:"default"}],[{name:"Safari 13.0",value:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0 Safari/605.1.15"}],[{name:`Safari ${emDash} iOS 12.1.3 ${emDash} iPhone`,value:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_1_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0 Mobile/15E148 Safari/604.1"},{name:`Safari ${emDash} iOS 12.1.3 ${emDash} iPod touch`,value:"Mozilla/5.0 (iPod; CPU iPhone OS 12_1_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0 Mobile/15E148 Safari/604.1"},{name:`Safari ${emDash} iOS 12.1.3 ${emDash} iPad`,value:"Mozilla/5.0 (iPad; CPU iPhone OS 12_1_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0 Mobile/15E148 Safari/604.1"}],[{name:"Microsoft Edge",value:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 Edge/16.16299"}],[{name:`Google Chrome ${emDash} macOS`,value:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36"},{name:`Google Chrome ${emDash} Windows`,value:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36"}],[{name:`Firefox ${emDash} macOS`,value:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:63.0) Gecko/20100101 Firefox/63.0"},{name:`Firefox ${emDash} Windows`,value:"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:63.0) Gecko/20100101 Firefox/63.0"}],[{name:WI.UIString("Other\u2026"),value:"other"}]];let E=null;for(let M of S){for(let{name:L,value:V}of M){let H=b.appendChild(document.createElement("option"));H.value=V,H.textContent=L,V===WI._overridenDeviceUserAgent&&(E=H)}M!==S.lastValue&&b.appendChild(document.createElement("hr"))}function k(){w||(w=_.appendChild(document.createElement("input")),w.value=w.placeholder=WI._overridenDeviceUserAgent||navigator.userAgent,w.addEventListener("click",M=>{M.preventDefault()}),w.addEventListener("change",M=>{t(w.value,!0)}),WI._deviceSettingsPopover.update())}E?b.value=E.value:WI._overridenDeviceUserAgent&&(b.value="other",k()),b.addEventListener("change",()=>{let M=b.value;M==="other"?(k(),w.select()):(w&&(w.remove(),w=null,WI._deviceSettingsPopover.update()),t(M))});const R=[{name:WI.UIString("Disable:"),columns:[[{name:WI.UIString("Images"),setting:PageAgent.Setting.ImagesEnabled,value:!1},{name:WI.UIString("Styles"),setting:PageAgent.Setting.AuthorAndUserStylesEnabled,value:!1},{name:WI.UIString("JavaScript"),setting:PageAgent.Setting.ScriptEnabled,value:!1}],[{name:WI.UIString("Site-specific Hacks"),setting:PageAgent.Setting.NeedsSiteSpecificQuirks,value:!1},{name:WI.UIString("Cross-Origin Restrictions"),setting:PageAgent.Setting.WebSecurityEnabled,value:!1}]]},{name:WI.UIString("%s:").format(WI.unlocalizedString("WebRTC")),columns:[[{name:WI.UIString("Allow Media Capture on Insecure Sites"),setting:PageAgent.Setting.MediaCaptureRequiresSecureConnection,value:!1},{name:WI.UIString("Disable ICE Candidate Restrictions"),setting:PageAgent.Setting.ICECandidateFilteringEnabled,value:!1},{name:WI.UIString("Use Mock Capture Devices"),setting:PageAgent.Setting.MockCaptureDevicesEnabled,value:!0}]]}];for(let M of R){if(!M.columns.some(z=>z.some(K=>K.setting)))continue;let L=d.appendChild(document.createElement("tr")),V=L.appendChild(document.createElement("td"));V.textContent=M.name;let O=L.appendChild(document.createElement("td")).appendChild(document.createElement("div"));O.classList.add("container");for(let z of M.columns){let K=O.appendChild(document.createElement("div"));K.classList.add("column");for(let q of z)n(K,q.name,q.setting,q.value)}}WI._deviceSettingsPopover.presentNewContentWithFrame(d,s(),a)};WI._downloadWebArchive=function(c){WI.archiveMainFrame()};WI._reloadInspectedInspector=function(){const c={};WI.runtimeManager.evaluateInInspectedWindow("InspectorFrontendHost.reopen()",c,function(){})};WI._reloadPage=function(c){if(!!window.PageAgent){if(c.preventDefault(),InspectorFrontendHost.inspectionLevel()>1){WI._reloadInspectedInspector();return}PageAgent.reload()}};WI._reloadPageFromOrigin=function(c){if(!!window.PageAgent){if(c.preventDefault(),InspectorFrontendHost.inspectionLevel()>1){WI._reloadInspectedInspector();return}PageAgent.reload.invoke({ignoreCache:!0})}};WI._reloadToolbarButtonClicked=function(c){if(InspectorFrontendHost.inspectionLevel()>1){WI._reloadInspectedInspector();return}PageAgent.reload.invoke({ignoreCache:WI.modifierKeys.shiftKey})};WI._updateReloadToolbarButton=function(){if(!window.PageAgent){WI._reloadToolbarButton.hidden=!0;return}WI._reloadToolbarButton.hidden=!1};WI._updateDownloadToolbarButton=function(){if(!window.PageAgent||WI.sharedApp.debuggableType!==WI.DebuggableType.Web){WI._downloadToolbarButton.hidden=!0;return}if(WI._downloadingPage){WI._downloadToolbarButton.enabled=!1;return}WI._downloadToolbarButton.enabled=WI.canArchiveMainFrame()};WI._updateInspectModeToolbarButton=function(){if(!window.DOMAgent||!DOMAgent.setInspectModeEnabled){WI._inspectModeToolbarButton.hidden=!0;return}WI._inspectModeToolbarButton.hidden=!1};WI._toggleInspectMode=function(c){WI.domManager.inspectModeEnabled=!WI.domManager.inspectModeEnabled};WI._showConsoleTab=function(c){WI.showConsoleTab()};WI._focusConsolePrompt=function(c){WI.quickConsole.prompt.focus()};WI._focusedContentBrowser=function(){if(WI.currentFocusElement){let c=WI.currentFocusElement.closest(".content-browser");if(c&&c.__view&&c.__view instanceof WI.ContentBrowser)return c.__view}if(WI.tabBrowser.element.contains(WI.currentFocusElement)||document.activeElement===document.body){let c=WI.tabBrowser.selectedTabContentView;return c.contentBrowser?c.contentBrowser:null}return WI.consoleDrawer.element.contains(WI.currentFocusElement)||WI.isShowingSplitConsole()&&WI.quickConsole.element.contains(WI.currentFocusElement)?WI.consoleDrawer:null};WI._focusedContentView=function(){if(WI.tabBrowser.element.contains(WI.currentFocusElement)||document.activeElement===document.body){var c=WI.tabBrowser.selectedTabContentView;return c.contentBrowser?c.contentBrowser.currentContentView:c}return WI.consoleDrawer.element.contains(WI.currentFocusElement)||WI.isShowingSplitConsole()&&WI.quickConsole.element.contains(WI.currentFocusElement)?WI.consoleDrawer.currentContentView:null};WI._focusedOrVisibleContentBrowser=function(){let c=WI._focusedContentBrowser();if(c)return c;var e=WI.tabBrowser.selectedTabContentView;return e.contentBrowser?e.contentBrowser:null};WI.focusedOrVisibleContentView=function(){let c=WI._focusedContentView();if(c)return c;var e=WI.tabBrowser.selectedTabContentView;return e.contentBrowser?e.contentBrowser.currentContentView:e};WI._beforecopy=function(c){var e=window.getSelection();if(e.isCollapsed&&!WI.isEventTargetAnEditableField(c)){var t=WI.currentFocusElement&&WI.currentFocusElement.copyHandler;if(t&&typeof t.handleBeforeCopyEvent=="function"&&(t.handleBeforeCopyEvent(c),c.defaultPrevented))return;var i=WI._focusedContentView();if(i&&typeof i.handleCopyEvent=="function"){c.preventDefault();return}return}e.isCollapsed||c.preventDefault()};WI._find=function(c){let e=WI._focusedOrVisibleContentBrowser();!e||e.showFindBanner()};WI._save=function(c){var e=WI.focusedOrVisibleContentView();!e||!e.supportsSave||WI.FileUtilities.save(e.saveData)};WI._saveAs=function(c){var e=WI.focusedOrVisibleContentView();!e||!e.supportsSave||WI.FileUtilities.save(e.saveData,!0)};WI._clear=function(c){let e=WI.focusedOrVisibleContentView();if(!e||typeof e.handleClearShortcut!="function"){WI.consoleManager.requestClearMessages();return}e.handleClearShortcut(c)};WI._populateFind=function(c){let e=WI._focusedContentView();if(!e)return;if(e.supportsCustomFindBanner){e.handlePopulateFindShortcut();return}let t=WI._focusedOrVisibleContentBrowser();!t||t.handlePopulateFindShortcut()};WI._findNext=function(c){let e=WI._focusedContentView();if(!e)return;if(e.supportsCustomFindBanner){e.handleFindNextShortcut();return}let t=WI._focusedOrVisibleContentBrowser();!t||t.handleFindNextShortcut()};WI._findPrevious=function(c){let e=WI._focusedContentView();if(!e)return;if(e.supportsCustomFindBanner){e.handleFindPreviousShortcut();return}let t=WI._focusedOrVisibleContentBrowser();!t||t.handleFindPreviousShortcut()};WI._copy=function(c){var e=window.getSelection();if(e.isCollapsed&&!WI.isEventTargetAnEditableField(c)){var t=WI.currentFocusElement&&WI.currentFocusElement.copyHandler;if(t&&typeof t.handleCopyEvent=="function"&&(t.handleCopyEvent(c),c.defaultPrevented))return;var i=WI._focusedContentView();if(i&&typeof i.handleCopyEvent=="function"){i.handleCopyEvent(c);return}let s=WI.tabBrowser.selectedTabContentView;if(s&&typeof s.handleCopyEvent=="function"){s.handleCopyEvent(c);return}return}if(!e.isCollapsed){var n=e.toString().removeWordBreakCharacters();c.clipboardData.setData("text/plain",n),c.preventDefault()}};WI._paste=function(c){if(c.defaultPrevented||!window.getSelection().isCollapsed||WI.isEventTargetAnEditableField(c))return;let t=WI.currentFocusElement&&WI.currentFocusElement.pasteHandler;if(t&&t.handlePasteEvent&&(t.handlePasteEvent(c),c.defaultPrevented))return;let i=WI._focusedContentView();if(i&&i.handlePasteEvent){i.handlePasteEvent(c);return}let n=WI.tabBrowser.selectedTabContentView;if(n&&n.handlePasteEvent){n.handlePasteEvent(c);return}};WI._increaseZoom=function(c){let i=WI.getZoomFactor();if(i+1e-4>=2.4){InspectorFrontendHost.beep();return}WI.setZoomFactor(Math.min(2.4,i+.2))};WI._decreaseZoom=function(c){let i=WI.getZoomFactor();if(i-1e-4<=.6){InspectorFrontendHost.beep();return}WI.setZoomFactor(Math.max(.6,i-.2))};WI._resetZoom=function(c){WI.setZoomFactor(1)};WI.getZoomFactor=function(){return WI.settings.zoomFactor.value};WI.setZoomFactor=function(c){InspectorFrontendHost.setZoomFactor(c),WI.settings.zoomFactor.value=InspectorFrontendHost.zoomFactor()};WI.resolvedLayoutDirection=function(){let c=WI.settings.layoutDirection.value;return c===WI.LayoutDirection.System&&(c=InspectorFrontendHost.userInterfaceLayoutDirection()),c};WI.setLayoutDirection=function(c){Object.values(WI.LayoutDirection).includes(c)||WI.reportInternalError("Unknown layout direction requested: "+c),c!==WI.settings.layoutDirection.value&&(WI.settings.layoutDirection.value=c,WI.resolvedLayoutDirection()===WI.LayoutDirection.RTL&&WI._dockConfiguration===WI.DockConfiguration.Right&&WI._dockLeft(),WI.resolvedLayoutDirection()===WI.LayoutDirection.LTR&&WI._dockConfiguration===WI.DockConfiguration.Left&&WI._dockRight(),InspectorFrontendHost.reopen())};WI._showTabAtIndex=function(c){c<=WI.tabBar.tabBarItems.length&&(WI.tabBar.selectedTabBarItem=c-1)};WI._showJavaScriptTypeInformationSettingChanged=function(c){if(WI.settings.showJavaScriptTypeInformation.value)for(let e of WI.targets)e.RuntimeAgent.enableTypeProfiler();else for(let e of WI.targets)e.RuntimeAgent.disableTypeProfiler()};WI._enableControlFlowProfilerSettingChanged=function(c){if(WI.settings.enableControlFlowProfiler.value)for(let e of WI.targets)e.RuntimeAgent.enableControlFlowProfiler();else for(let e of WI.targets)e.RuntimeAgent.disableControlFlowProfiler()};WI._resourceCachingDisabledSettingChanged=function(c){NetworkAgent.setResourceCachingDisabled(WI.settings.resourceCachingDisabled.value)};WI.elementDragStart=function(c,e,t,i,n,s){if((WI._elementDraggingEventListener||WI._elementEndDraggingEventListener)&&WI.elementDragEnd(i),c){WI._elementDraggingGlassPane&&WI._elementDraggingGlassPane.remove();var a=document.createElement("div");a.style.cssText="position:absolute;top:0;bottom:0;left:0;right:0;opacity:0;z-index:1",a.id="glass-pane-for-drag",c.ownerDocument.body.appendChild(a),WI._elementDraggingGlassPane=a}WI._elementDraggingEventListener=e,WI._elementEndDraggingEventListener=t;var d=i.target.ownerDocument;WI._elementDraggingEventTarget=s||d,WI._elementDraggingEventTarget.addEventListener("mousemove",e,!0),WI._elementDraggingEventTarget.addEventListener("mouseup",t,!0),d.body.style.cursor=n,i.preventDefault()};WI.elementDragEnd=function(c){WI._elementDraggingEventTarget.removeEventListener("mousemove",WI._elementDraggingEventListener,!0),WI._elementDraggingEventTarget.removeEventListener("mouseup",WI._elementEndDraggingEventListener,!0),c.target.ownerDocument.body.style.removeProperty("cursor"),WI._elementDraggingGlassPane&&WI._elementDraggingGlassPane.remove(),delete WI._elementDraggingGlassPane,delete WI._elementDraggingEventTarget,delete WI._elementDraggingEventListener,delete WI._elementEndDraggingEventListener,c.preventDefault()};WI.createMessageTextView=function(c,e){let t=document.createElement("div");t.className="message-text-view",e&&t.classList.add("error");let i=t.appendChild(document.createElement("div"));return i.className="message",i.textContent=c,t};WI.createNavigationItemHelp=function(c,e){console.assert(typeof c=="string"),console.assert(e instanceof WI.NavigationItem);function t(s,a){return s.append(a),s}let i=document.createElement("div");i.className="navigation-item-help",i.__navigationItem=e;let n=document.createElement("div");return n.className="navigation-bar",n.appendChild(e.element),String.format(c,[n],String.standardFormatters,i,t),i};WI.createGoToArrowButton=function(){var c=document.createElement("button");return c.addEventListener("mousedown",e=>{e.stopPropagation()},!0),c.className="go-to-arrow",c.tabIndex=-1,c};WI.createSourceCodeLocationLink=function(c,e={}){if(console.assert(c),!c)return null;var t=document.createElement("a");return t.className="go-to-link",WI.linkifyElement(t,c,e),c.populateLiveDisplayLocationTooltip(t),e.useGoToArrowButton?t.appendChild(WI.createGoToArrowButton()):c.populateLiveDisplayLocationString(t,"textContent",e.columnStyle,e.nameStyle,e.prefix),e.dontFloat&&t.classList.add("dont-float"),t};WI.linkifyLocation=function(c,e,t={}){var i=WI.sourceCodeForURL(c);if(i)return WI.linkifySourceCode(i,e,t);var n=document.createElement("a");return n.href=c,n.lineNumber=e.lineNumber,t.className&&(n.className=t.className),n.append(WI.displayNameForURL(c)+":"+e.lineNumber),n};WI.linkifySourceCode=function(c,e,t={}){let i=c.createSourceCodeLocation(e.lineNumber,e.columnNumber),n=WI.createSourceCodeLocationLink(i,{...t,dontFloat:!0});return t.className&&n.classList.add(t.className),n};WI.linkifyElement=function(c,e,t={}){console.assert(e);function i(n){n.stopPropagation(),n.preventDefault(),n.metaKey?WI.showOriginalUnformattedSourceCodeLocation(e,t):WI.showSourceCodeLocation(e,t)}c.addEventListener("click",i),c.addEventListener("contextmenu",n=>{let s=WI.ContextMenu.createFromEvent(n);WI.appendContextMenuItemsForSourceCode(s,e)})};WI.sourceCodeForURL=function(c){var e=WI.networkManager.resourceForURL(c);return e||(e=WI.debuggerManager.scriptsForURL(c,WI.assumingMainTarget())[0],e&&(e=e.resource||e)),e||null};WI.linkifyURLAsNode=function(c,e,t){let i=document.createElement("a");return i.href=c,i.className=t||"",i.textContent=e||c,i.style.maxWidth="100%",i};WI.linkifyStringAsFragmentWithCustomLinkifier=function(c,e){for(var t=document.createDocumentFragment(),i=/(?:[a-zA-Z][a-zA-Z0-9+.-]{2,}:\/\/|www\.)[\w$\-_+*'=\|\/\\(){}[\]%@&#~,:;.!?]{2,}[\w$\-_+*=\|\/\\({%@&#~]/,n=/:(\d+)(:(\d+))?$/;c;){var s=i.exec(c);if(!s)break;s=s[0];var a=c.indexOf(s),d=c.substring(0,a);if(t.append(d),s.startsWith("data:")||s.startsWith("javascript:")||s.startsWith("mailto:")){t.append(s),c=c.substring(a+s.length,c.length);continue}var p=s,f=s.startsWith("www.")?"http://"+s:s,_=n.exec(f);_&&(f=f.substring(0,f.length-_[0].length));var b;_&&(b=parseInt(_[1])-1);var w=e(p,f,b);t.appendChild(w),c=c.substring(a+s.length,c.length)}return c&&t.append(c),t};WI.linkifyStringAsFragment=function(c){function e(t,i,n){var s=WI.linkifyURLAsNode(i,t,void 0);return n!==void 0&&(s.lineNumber=n),s}return WI.linkifyStringAsFragmentWithCustomLinkifier(c,e)};WI.createResourceLink=function(c,e){function t(n){n.stopPropagation(),n.preventDefault(),WI.showRepresentedObject(c)}let i=document.createElement("a");return i.classList.add("resource-link",e),i.title=c.url,i.textContent=(c.urlComponents.lastPathComponent||c.url).insertWordBreakCharacters(),i.addEventListener("click",t),i};WI._undoKeyboardShortcut=function(c){!WI.isEditingAnyField()&&!WI.isEventTargetAnEditableField(c)&&(WI.undo(),c.preventDefault())};WI._redoKeyboardShortcut=function(c){!WI.isEditingAnyField()&&!WI.isEventTargetAnEditableField(c)&&(WI.redo(),c.preventDefault())};WI.undo=function(){DOMAgent.undo()};WI.redo=function(){DOMAgent.redo()};WI.highlightRangesWithStyleClass=function(c,e,t,i){i=i||[];var n=[],s=c.textContent,a=c.ownerDocument,d=a.evaluate(".//text()",c,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),p=d.snapshotLength;if(p===0)return n;for(var f=[],_=0,b=0;b<p;++b){var w={};w.offset=_,w.length=d.snapshotItem(b).textContent.length,_=w.offset+w.length,f.push(w)}for(var S=0,b=0;b<e.length;++b){for(var E=e[b].offset,k=E+e[b].length;S<p&&f[S].offset+f[S].length<=E;)S++;for(var R=S;R<p&&f[R].offset+f[R].length<k;)R++;if(R===p)break;var M=a.createElement("span");M.className=t,M.textContent=s.substring(E,k);var L=d.snapshotItem(R),V=L.textContent;if(L.textContent=V.substring(k-f[R].offset),i.push({node:L,type:"changed",oldText:V,newText:L.textContent}),S===R){L.parentElement.insertBefore(M,L),i.push({node:M,type:"added",nextSibling:L,parent:L.parentElement}),n.push(M);var H=a.createTextNode(V.substring(0,E-f[S].offset));L.parentElement.insertBefore(H,M),i.push({node:H,type:"added",nextSibling:M,parent:L.parentElement})}else{var O=d.snapshotItem(S),z=O.textContent,K=O.nextSibling;O.parentElement.insertBefore(M,K),i.push({node:M,type:"added",nextSibling:K,parent:O.parentElement}),n.push(M),O.textContent=z.substring(0,E-f[S].offset),i.push({node:O,type:"changed",oldText:z,newText:O.textContent});for(var q=S+1;q<R;q++){var Y=d.snapshotItem(q),se=Y.textContent;Y.textContent="",i.push({node:Y,type:"changed",oldText:se,newText:Y.textContent})}}S=R,f[S].offset=k,f[S].length=L.textContent.length}return n};WI.revertDOMChanges=function(c){for(var e=c.length-1;e>=0;--e){var t=c[e];switch(t.type){case"added":t.node.remove();break;case"changed":t.node.textContent=t.oldText;break}}};WI.archiveMainFrame=function(){WI._downloadingPage=!0,WI._updateDownloadToolbarButton(),PageAgent.archive((c,e)=>{if(WI._downloadingPage=!1,WI._updateDownloadToolbarButton(),c)return;let t=WI.networkManager.mainFrame,i=t.mainResource.urlComponents.host||t.mainResource.displayName||"Archive",n=WI.FileUtilities.inspectorURLForFilename(i+".webarchive");InspectorFrontendHost.save(n,e,!0,!0)})};WI.canArchiveMainFrame=function(){return WI.sharedApp.debuggableType!==WI.DebuggableType.Web||!WI.networkManager.mainFrame||!WI.networkManager.mainFrame.mainResource?!1:WI.Resource.typeFromMIMEType(WI.networkManager.mainFrame.mainResource.mimeType)===WI.Resource.Type.Document};WI.addWindowKeydownListener=function(c){typeof c.handleKeydownEvent=="function"&&(WI._windowKeydownListeners.push(c),WI._updateWindowKeydownListener())};WI.removeWindowKeydownListener=function(c){WI._windowKeydownListeners.remove(c),WI._updateWindowKeydownListener()};WI._updateWindowKeydownListener=function(){WI._windowKeydownListeners.length===1?window.addEventListener("keydown",WI._sharedWindowKeydownListener,!0):WI._windowKeydownListeners.length||window.removeEventListener("keydown",WI._sharedWindowKeydownListener,!0)};WI._sharedWindowKeydownListener=function(c){for(var e=WI._windowKeydownListeners.length-1;e>=0;--e)if(WI._windowKeydownListeners[e].handleKeydownEvent(c)){c.stopImmediatePropagation(),c.preventDefault();break}};WI.reportInternalError=function(c,e={}){let t=c instanceof Error?c:new Error(c);t.details=e,WI.isDebugUIEnabled()?(console.assert(!1,"An internal exception was thrown.",t),handleInternalException(t)):console.error(t)};Object.defineProperty(WI,"mainTarget",{get(){return WI.pageTarget||WI.backendTarget}});Object.defineProperty(WI,"targets",{get(){return WI.targetManager.targets}});WI.assumingMainTarget=function(){return WI.mainTarget};WI.reset=async function(){await WI.ObjectStore.reset(),WI.Setting.reset(),InspectorFrontendHost.reset()};WI.isEngineeringBuild=!1;WI.dialogWasDismissedWithRepresentedObject=function(c,e){!e||WI.showRepresentedObject(e,c.cookie,{ignoreSearchTab:!0,ignoreNetworkTab:!0})};WI.didDismissPopover=function(c){c===WI._deviceSettingsPopover&&(WI._deviceSettingsPopover=null)};WI.DockConfiguration={Right:"right",Left:"left",Bottom:"bottom",Undocked:"undocked"};WI.NotImplementedError=class extends Error{constructor(e="This method is not implemented."){super(e)}static subclassMustOverride(){return new WI.NotImplementedError("This method must be overridden by a subclass.")}};WI.AppControllerBase=class{constructor(){this._initialized=!1}get hasExtraDomains(){throw WI.NotImplementedError.subclassMustOverride()}get debuggableType(){throw WI.NotImplementedError.subclassMustOverride()}initialize(){if(this._initialized)throw new Error("App controller is already initialized.");this._initialized=!0,WI.loaded()}};WI.AppController=class _p extends WI.AppControllerBase{constructor(){super(),this._hasExtraDomains=!1,this._debuggableType=_p.debuggableTypeFromHost()}static debuggableTypeFromHost(){let e=InspectorFrontendHost.debuggableType();switch(e){case"javascript":return WI.DebuggableType.JavaScript;case"service-worker":return WI.DebuggableType.ServiceWorker;case"web":return WI.DebuggableType.Web;default:return console.assert(!1,"Unexpected debuggable type",e),WI.DebuggableType.JavaScript}}get hasExtraDomains(){return this._hasExtraDomains}get debuggableType(){return this._debuggableType}activateExtraDomains(e){if(this._hasExtraDomains)throw new Error("Extra domains have already been activated, cannot activate again.");this._hasExtraDomains=!0,console.assert(WI.mainTarget instanceof WI.DirectBackendTarget),console.assert(WI.mainTarget.type===WI.Target.Type.JSContext),console.assert(WI.sharedApp.debuggableType===WI.DebuggableType.JavaScript),console.assert(WI.targets.length===1);for(let t of e){let i=InspectorBackend.activateDomain(t);i.enable&&i.enable();for(let n of WI.targets)n.activateExtraDomain(t)}WI.activateExtraDomains(e)}};WI.isEngineeringBuild=!0;WI.runBootstrapOperations=function(){WI.showDebugUISetting=new WI.Setting("show-debug-ui",!1),new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.Option|WI.KeyboardShortcut.Modifier.Shift|WI.KeyboardShortcut.Modifier.CommandOrControl,"D",()=>{WI.showDebugUISetting.value=!WI.showDebugUISetting.value}),new WI.KeyboardShortcut(WI.KeyboardShortcut.Modifier.Option|WI.KeyboardShortcut.Modifier.Shift|WI.KeyboardShortcut.Modifier.CommandOrControl,"R",()=>{InspectorFrontendHost.reopen()});let c=!1;const e={Off:"off",Filtering:"filtering",Everything:"everything"},t=WI.unlocalizedString(`Enable dump inspector messages to console.
Shift-click to dump all inspector messages with no filtering.`),i=WI.unlocalizedString("Disable dump inspector messages to console");let n=new WI.ActivateButtonToolbarItem("dump-messages",t,i,"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e %3c!-- Copyright %c2%a9 2015 Apple Inc. All rights reserved. --%3e %3csvg xmlns='http://www.w3.org/2000/svg' id='root' version='1.1' viewBox='0 0 16 16'%3e %3crect fill='none' stroke='currentColor' x='0.5' y='0.5' width='15' height='15' rx='2'/%3e %3cpath fill='none' stroke='currentColor' d='M 4 4 L 8 8 L 4 12'/%3e %3cpath fill='none' stroke='currentColor' d='M 8 4.5 L 12 4.5'/%3e %3cpath fill='none' stroke='currentColor' d='M 10 8 L 12 8'/%3e %3cpath fill='none' stroke='currentColor' d='M 8 11.5 L 12 11.5'/%3e %3c/svg%3e");function s(){return InspectorBackend.dumpInspectorProtocolMessages?InspectorBackend.filterMultiplexingBackendInspectorProtocolMessages?e.Filtering:e.Everything:e.Off}function a(b){switch(c=!0,b){case e.Off:InspectorBackend.dumpInspectorProtocolMessages=!1,InspectorBackend.filterMultiplexingBackendInspectorProtocolMessages=!1,n.activated=!1,n.element.style.removeProperty("color");break;case e.Filtering:InspectorBackend.dumpInspectorProtocolMessages=!0,InspectorBackend.filterMultiplexingBackendInspectorProtocolMessages=!0,n.activated=!0,n.element.style.removeProperty("color");break;case e.Everything:InspectorBackend.dumpInspectorProtocolMessages=!0,InspectorBackend.filterMultiplexingBackendInspectorProtocolMessages=!1,n.activated=!0,n.element.style.color="rgb(164, 41, 154)";break}c=!1}WI.toolbar.addToolbarItem(n,WI.Toolbar.Section.CenterRight),n.addEventListener(WI.ButtonNavigationItem.Event.Clicked,()=>{let b;switch(s()){case e.Off:b=WI.modifierKeys.shiftKey?e.Everything:e.Filtering;break;case e.Filtering:b=WI.modifierKeys.shiftKey?e.Everything:e.Off;break;case e.Everything:b=e.Off;break}a(b)}),WI.settings.autoLogProtocolMessages.addEventListener(WI.Setting.Event.Changed,()=>{c||a(s())}),a(s());let d=InspectorFrontendHost.inspectionLevel();const p=WI.unlocalizedString("Open Web Inspector [%d]").format(d+1);let f=new WI.ButtonToolbarItem("inspect-inspector",p);WI.toolbar.addToolbarItem(f,WI.Toolbar.Section.CenterRight),f.element.textContent=d+1,f.addEventListener(WI.ButtonNavigationItem.Event.Clicked,()=>{InspectorFrontendHost.inspectInspector()});function _(){n.hidden=!WI.showDebugUISetting.value,f.hidden=!WI.showDebugUISetting.value}WI.showDebugUISetting.addEventListener(WI.Setting.Event.Changed,()=>{_(),WI.notifications.dispatchEventToListeners(WI.Notification.DebugUIEnabledDidChange)}),_()};WI.CapturingProtocolTracer=class extends WI.ProtocolTracer{constructor(){super(),this._trace=new WI.ProtocolTrace}get trace(){return this._trace}logFrontendException(e,t,i){this._processEntry({type:"exception",message:this._stringifyMessage(t),exception:i})}logFrontendRequest(e,t){this._processEntry({type:"request",message:this._stringifyMessage(t)})}logDidHandleResponse(e,t,i=null){let n={type:"response",message:this._stringifyMessage(t)};i&&(n.timings=Object.shallowCopy(i)),this._processEntry(n)}logDidHandleEvent(e,t,i=null){let n={type:"event",message:this._stringifyMessage(t)};i&&(n.timings=Object.shallowCopy(i)),this._processEntry(n)}_stringifyMessage(e){try{return JSON.stringify(e)}catch(t){return console.error("couldn't stringify object:",e,t),{}}}_processEntry(e){this._trace.addEntry(e)}};WI.ProtocolTrace=class{constructor(){this._entries=[]}addEntry(e){this._entries.push(e)}get saveData(){let e=new Date,t=e.getFullYear(),i=e.getMonth()+1,n=e.getDate(),s=e.getHours(),a=e.getMinutes(),d=e.getSeconds(),p=WI.unlocalizedString(`Protocol Trace at ${t}-${i}-${n} ${s}.${a}.${d}.json`);return{url:WI.FileUtilities.inspectorURLForFilename(p),content:JSON.stringify(this._entries)}}};WI.DebugContentView=class extends WI.ContentView{constructor(e){super(new String(e)),this._string=e,this.element.classList.add("debug"),this.element.textContent=e}shown(){super.shown(),console.debug(`shown: ${this._string}`)}hidden(){console.debug(`hidden: ${this._string}`),super.hidden()}closed(){console.debug(`closed: ${this._string}`),super.closed()}};
